/******/ (function(modules) { // webpackBootstrap
/******/ 	// The module cache
/******/ 	var installedModules = {};
/******/
/******/ 	// The require function
/******/ 	function __webpack_require__(moduleId) {
/******/
/******/ 		// Check if module is in cache
/******/ 		if(installedModules[moduleId]) {
/******/ 			return installedModules[moduleId].exports;
/******/ 		}
/******/ 		// Create a new module (and put it into the cache)
/******/ 		var module = installedModules[moduleId] = {
/******/ 			i: moduleId,
/******/ 			l: false,
/******/ 			exports: {}
/******/ 		};
/******/
/******/ 		// Execute the module function
/******/ 		modules[moduleId].call(module.exports, module, module.exports, __webpack_require__);
/******/
/******/ 		// Flag the module as loaded
/******/ 		module.l = true;
/******/
/******/ 		// Return the exports of the module
/******/ 		return module.exports;
/******/ 	}
/******/
/******/
/******/ 	// expose the modules object (__webpack_modules__)
/******/ 	__webpack_require__.m = modules;
/******/
/******/ 	// expose the module cache
/******/ 	__webpack_require__.c = installedModules;
/******/
/******/ 	// define getter function for harmony exports
/******/ 	__webpack_require__.d = function(exports, name, getter) {
/******/ 		if(!__webpack_require__.o(exports, name)) {
/******/ 			Object.defineProperty(exports, name, { enumerable: true, get: getter });
/******/ 		}
/******/ 	};
/******/
/******/ 	// define __esModule on exports
/******/ 	__webpack_require__.r = function(exports) {
/******/ 		if(typeof Symbol !== 'undefined' && Symbol.toStringTag) {
/******/ 			Object.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });
/******/ 		}
/******/ 		Object.defineProperty(exports, '__esModule', { value: true });
/******/ 	};
/******/
/******/ 	// create a fake namespace object
/******/ 	// mode & 1: value is a module id, require it
/******/ 	// mode & 2: merge all properties of value into the ns
/******/ 	// mode & 4: return value when already ns object
/******/ 	// mode & 8|1: behave like require
/******/ 	__webpack_require__.t = function(value, mode) {
/******/ 		if(mode & 1) value = __webpack_require__(value);
/******/ 		if(mode & 8) return value;
/******/ 		if((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;
/******/ 		var ns = Object.create(null);
/******/ 		__webpack_require__.r(ns);
/******/ 		Object.defineProperty(ns, 'default', { enumerable: true, value: value });
/******/ 		if(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));
/******/ 		return ns;
/******/ 	};
/******/
/******/ 	// getDefaultExport function for compatibility with non-harmony modules
/******/ 	__webpack_require__.n = function(module) {
/******/ 		var getter = module && module.__esModule ?
/******/ 			function getDefault() { return module['default']; } :
/******/ 			function getModuleExports() { return module; };
/******/ 		__webpack_require__.d(getter, 'a', getter);
/******/ 		return getter;
/******/ 	};
/******/
/******/ 	// Object.prototype.hasOwnProperty.call
/******/ 	__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };
/******/
/******/ 	// __webpack_public_path__
/******/ 	__webpack_require__.p = "";
/******/
/******/
/******/ 	// Load entry module and return exports
/******/ 	return __webpack_require__(__webpack_require__.s = "./index.js");
/******/ })
/************************************************************************/
/******/ ({

/***/ "./index.js":
/*!******************!*\
  !*** ./index.js ***!
  \******************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var _src_hilo3d_test__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! ./src/hilo3d-test */ \"./src/hilo3d-test.js\");\n/* harmony import */ var _src_hilo_test__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./src/hilo-test */ \"./src/hilo-test.js\");\n/* harmony import */ var _src_sein_test__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./src/sein-test */ \"./src/sein-test.js\");\n\n\n\n\n//# sourceURL=webpack:///./index.js?");

/***/ }),

/***/ "./node_modules/_hilo3d@1.15.15@hilo3d/build/Hilo3d.js":
/*!*************************************************************!*\
  !*** ./node_modules/_hilo3d@1.15.15@hilo3d/build/Hilo3d.js ***!
  \*************************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("/*!\n * Hilo3d 1.15.15\n * Copyright (c) 2017-present Alibaba Group Holding Ltd.\n * @license MIT\n */\nwindow.Hilo3d=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=113)}([function(t,e,n){\n/*!\n@fileoverview gl-matrix - High performance matrix and vector operations\n@author Brandon Jones\n@author Colin MacKenzie IV\n@version 2.7.0\n\nCopyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n\"undefined\"!=typeof self&&self,t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=10)}([function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.setMatrixArrayType=function(t){e.ARRAY_TYPE=t},e.toRadian=function(t){return t*i},e.equals=function(t,e){return Math.abs(t-e)<=r*Math.max(1,Math.abs(t),Math.abs(e))};var r=e.EPSILON=1e-6;e.ARRAY_TYPE=\"undefined\"!=typeof Float32Array?Float32Array:Array,e.RANDOM=Math.random;var i=Math.PI/180},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.fromValues=function(t,e,n,i){var a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.multiply=s,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t[3]=Math.min(e[3],n[3]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t[3]=Math.max(e[3],n[3]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t},e.distance=u,e.squaredDistance=c,e.length=h,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t},e.normalize=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n*n+r*r+i*i+a*a;return s>0&&(s=1/Math.sqrt(s),t[0]=n*s,t[1]=r*s,t[2]=i*s,t[3]=a*s),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]},e.lerp=function(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=e[3];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=s+r*(n[2]-s),t[3]=o+r*(n[3]-o),t},e.random=function(t,e){var n,i,a,s,o,u;e=e||1;do{o=(n=2*r.RANDOM()-1)*n+(i=2*r.RANDOM()-1)*i}while(o>=1);do{u=(a=2*r.RANDOM()-1)*a+(s=2*r.RANDOM()-1)*s}while(u>=1);var c=Math.sqrt((1-o)/u);return t[0]=e*n,t[1]=e*i,t[2]=e*a*c,t[3]=e*s*c,t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3];return t[0]=n[0]*r+n[4]*i+n[8]*a+n[12]*s,t[1]=n[1]*r+n[5]*i+n[9]*a+n[13]*s,t[2]=n[2]*r+n[6]*i+n[10]*a+n[14]*s,t[3]=n[3]*r+n[7]*i+n[11]*a+n[15]*s,t},e.transformQuat=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[0],o=n[1],u=n[2],c=n[3],h=c*r+o*a-u*i,f=c*i+u*r-s*a,l=c*a+s*i-o*r,d=-s*r-o*i-u*a;return t[0]=h*c+d*-s+f*-u-l*-o,t[1]=f*c+d*-o+l*-s-h*-u,t[2]=l*c+d*-u+h*-o-f*-s,t[3]=e[3],t},e.str=function(t){return\"vec4(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(s-h)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}function s(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t[3]=e[3]*n[3],t}function o(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t[3]=e[3]/n[3],t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return Math.sqrt(n*n+r*r+i*i+a*a)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2],a=e[3]-t[3];return n*n+r*r+i*i+a*a}function h(t){var e=t[0],n=t[1],r=t[2],i=t[3];return Math.sqrt(e*e+n*n+r*r+i*i)}function f(t){var e=t[0],n=t[1],r=t[2],i=t[3];return e*e+n*n+r*r+i*i}e.sub=a,e.mul=s,e.div=o,e.dist=u,e.sqrDist=c,e.len=h,e.sqrLen=f,e.forEach=function(){var t=i();return function(e,n,r,i,a,s){var o,u=void 0;for(n||(n=4),r||(r=0),o=i?Math.min(i*n+r,e.length):e.length,u=r;u<o;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],t[3]=e[u+3],a(t,t,s),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2],e[u+3]=t[3];return e}}()},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.forEach=e.sqrLen=e.len=e.sqrDist=e.dist=e.div=e.mul=e.sub=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.length=a,e.fromValues=s,e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},e.set=function(t,e,n,r){return t[0]=e,t[1]=n,t[2]=r,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t},e.subtract=o,e.multiply=u,e.divide=c,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t[2]=Math.min(e[2],n[2]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t[2]=Math.max(e[2],n[2]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t},e.distance=h,e.squaredDistance=f,e.squaredLength=l,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t},e.normalize=d,e.dot=m,e.cross=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[0],o=n[1],u=n[2];return t[0]=i*u-a*o,t[1]=a*s-r*u,t[2]=r*o-i*s,t},e.lerp=function(t,e,n,r){var i=e[0],a=e[1],s=e[2];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t[2]=s+r*(n[2]-s),t},e.hermite=function(t,e,n,r,i,a){var s=a*a,o=s*(2*a-3)+1,u=s*(a-2)+a,c=s*(a-1),h=s*(3-2*a);return t[0]=e[0]*o+n[0]*u+r[0]*c+i[0]*h,t[1]=e[1]*o+n[1]*u+r[1]*c+i[1]*h,t[2]=e[2]*o+n[2]*u+r[2]*c+i[2]*h,t},e.bezier=function(t,e,n,r,i,a){var s=1-a,o=s*s,u=a*a,c=o*s,h=3*a*o,f=3*u*s,l=u*a;return t[0]=e[0]*c+n[0]*h+r[0]*f+i[0]*l,t[1]=e[1]*c+n[1]*h+r[1]*f+i[1]*l,t[2]=e[2]*c+n[2]*h+r[2]*f+i[2]*l,t},e.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI,i=2*r.RANDOM()-1,a=Math.sqrt(1-i*i)*e;return t[0]=Math.cos(n)*a,t[1]=Math.sin(n)*a,t[2]=i*e,t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[3]*r+n[7]*i+n[11]*a+n[15];return s=s||1,t[0]=(n[0]*r+n[4]*i+n[8]*a+n[12])/s,t[1]=(n[1]*r+n[5]*i+n[9]*a+n[13])/s,t[2]=(n[2]*r+n[6]*i+n[10]*a+n[14])/s,t},e.transformMat3=function(t,e,n){var r=e[0],i=e[1],a=e[2];return t[0]=r*n[0]+i*n[3]+a*n[6],t[1]=r*n[1]+i*n[4]+a*n[7],t[2]=r*n[2]+i*n[5]+a*n[8],t},e.transformQuat=function(t,e,n){var r=n[0],i=n[1],a=n[2],s=n[3],o=e[0],u=e[1],c=e[2],h=i*c-a*u,f=a*o-r*c,l=r*u-i*o,d=i*l-a*f,m=a*h-r*l,_=r*f-i*h,p=2*s;return h*=p,f*=p,l*=p,d*=2,m*=2,_*=2,t[0]=o+h+d,t[1]=u+f+m,t[2]=c+l+_,t},e.rotateX=function(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0],a[1]=i[1]*Math.cos(r)-i[2]*Math.sin(r),a[2]=i[1]*Math.sin(r)+i[2]*Math.cos(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.rotateY=function(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[2]*Math.sin(r)+i[0]*Math.cos(r),a[1]=i[1],a[2]=i[2]*Math.cos(r)-i[0]*Math.sin(r),t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.rotateZ=function(t,e,n,r){var i=[],a=[];return i[0]=e[0]-n[0],i[1]=e[1]-n[1],i[2]=e[2]-n[2],a[0]=i[0]*Math.cos(r)-i[1]*Math.sin(r),a[1]=i[0]*Math.sin(r)+i[1]*Math.cos(r),a[2]=i[2],t[0]=a[0]+n[0],t[1]=a[1]+n[1],t[2]=a[2]+n[2],t},e.angle=function(t,e){var n=s(t[0],t[1],t[2]),r=s(e[0],e[1],e[2]);d(n,n),d(r,r);var i=m(n,r);return i>1?0:i<-1?Math.PI:Math.acos(i)},e.str=function(t){return\"vec3(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\")\"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=e[0],o=e[1],u=e[2];return Math.abs(n-s)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-o)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(o))&&Math.abs(a-u)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(u))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(3);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t}function a(t){var e=t[0],n=t[1],r=t[2];return Math.sqrt(e*e+n*n+r*r)}function s(t,e,n){var i=new r.ARRAY_TYPE(3);return i[0]=t,i[1]=e,i[2]=n,i}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}function u(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t[2]=e[2]*n[2],t}function c(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t[2]=e[2]/n[2],t}function h(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(n*n+r*r+i*i)}function f(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}function l(t){var e=t[0],n=t[1],r=t[2];return e*e+n*n+r*r}function d(t,e){var n=e[0],r=e[1],i=e[2],a=n*n+r*r+i*i;return a>0&&(a=1/Math.sqrt(a),t[0]=e[0]*a,t[1]=e[1]*a,t[2]=e[2]*a),t}function m(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}e.sub=o,e.mul=u,e.div=c,e.dist=h,e.sqrDist=f,e.len=a,e.sqrLen=l,e.forEach=function(){var t=i();return function(e,n,r,i,a,s){var o,u=void 0;for(n||(n=3),r||(r=0),o=i?Math.min(i*n+r,e.length):e.length,u=r;u<o;u+=n)t[0]=e[u],t[1]=e[u+1],t[2]=e[u+2],a(t,t,s),e[u]=t[0],e[u+1]=t[1],e[u+2]=t[2];return e}}()},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.setAxes=e.sqlerp=e.rotationTo=e.equals=e.exactEquals=e.normalize=e.sqrLen=e.squaredLength=e.len=e.length=e.lerp=e.dot=e.scale=e.mul=e.add=e.set=e.copy=e.fromValues=e.clone=void 0,e.create=u,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t},e.setAxisAngle=c,e.getAxisAngle=function(t,e){var n=2*Math.acos(e[3]),i=Math.sin(n/2);return i>r.EPSILON?(t[0]=e[0]/i,t[1]=e[1]/i,t[2]=e[2]/i):(t[0]=1,t[1]=0,t[2]=0),n},e.multiply=h,e.rotateX=function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+s*o,t[1]=i*u+a*o,t[2]=a*u-i*o,t[3]=s*u-r*o,t},e.rotateY=function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u-a*o,t[1]=i*u+s*o,t[2]=a*u+r*o,t[3]=s*u-i*o,t},e.rotateZ=function(t,e,n){n*=.5;var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+i*o,t[1]=i*u-r*o,t[2]=a*u+s*o,t[3]=s*u-a*o,t},e.calculateW=function(t,e){var n=e[0],r=e[1],i=e[2];return t[0]=n,t[1]=r,t[2]=i,t[3]=Math.sqrt(Math.abs(1-n*n-r*r-i*i)),t},e.slerp=f,e.random=function(t){var e=r.RANDOM(),n=r.RANDOM(),i=r.RANDOM(),a=Math.sqrt(1-e),s=Math.sqrt(e);return t[0]=a*Math.sin(2*Math.PI*n),t[1]=a*Math.cos(2*Math.PI*n),t[2]=s*Math.sin(2*Math.PI*i),t[3]=s*Math.cos(2*Math.PI*i),t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n*n+r*r+i*i+a*a,o=s?1/s:0;return t[0]=-n*o,t[1]=-r*o,t[2]=-i*o,t[3]=a*o,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t},e.fromMat3=l,e.fromEuler=function(t,e,n,r){var i=.5*Math.PI/180;e*=i,n*=i,r*=i;var a=Math.sin(e),s=Math.cos(e),o=Math.sin(n),u=Math.cos(n),c=Math.sin(r),h=Math.cos(r);return t[0]=a*u*h-s*o*c,t[1]=s*o*h+a*u*c,t[2]=s*u*c-a*o*h,t[3]=s*u*h+a*o*c,t},e.str=function(t){return\"quat(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"};var r=o(n(0)),i=o(n(5)),a=o(n(2)),s=o(n(1));function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function u(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0),t[3]=1,t}function c(t,e,n){n*=.5;var r=Math.sin(n);return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=Math.cos(n),t}function h(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+s*o+i*c-a*u,t[1]=i*h+s*u+a*o-r*c,t[2]=a*h+s*c+r*u-i*o,t[3]=s*h-r*o-i*u-a*c,t}function f(t,e,n,i){var a=e[0],s=e[1],o=e[2],u=e[3],c=n[0],h=n[1],f=n[2],l=n[3],d=void 0,m=void 0,_=void 0,p=void 0,g=void 0;return(m=a*c+s*h+o*f+u*l)<0&&(m=-m,c=-c,h=-h,f=-f,l=-l),1-m>r.EPSILON?(d=Math.acos(m),_=Math.sin(d),p=Math.sin((1-i)*d)/_,g=Math.sin(i*d)/_):(p=1-i,g=i),t[0]=p*a+g*c,t[1]=p*s+g*h,t[2]=p*o+g*f,t[3]=p*u+g*l,t}function l(t,e){var n=e[0]+e[4]+e[8],r=void 0;if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{var i=0;e[4]>e[0]&&(i=1),e[8]>e[3*i+i]&&(i=2);var a=(i+1)%3,s=(i+2)%3;r=Math.sqrt(e[3*i+i]-e[3*a+a]-e[3*s+s]+1),t[i]=.5*r,r=.5/r,t[3]=(e[3*a+s]-e[3*s+a])*r,t[a]=(e[3*a+i]+e[3*i+a])*r,t[s]=(e[3*s+i]+e[3*i+s])*r}return t}e.clone=s.clone,e.fromValues=s.fromValues,e.copy=s.copy,e.set=s.set,e.add=s.add,e.mul=h,e.scale=s.scale,e.dot=s.dot,e.lerp=s.lerp;var d=e.length=s.length,m=(e.len=d,e.squaredLength=s.squaredLength),_=(e.sqrLen=m,e.normalize=s.normalize);e.exactEquals=s.exactEquals,e.equals=s.equals,e.rotationTo=function(){var t=a.create(),e=a.fromValues(1,0,0),n=a.fromValues(0,1,0);return function(r,i,s){var o=a.dot(i,s);return o<-.999999?(a.cross(t,e,i),a.len(t)<1e-6&&a.cross(t,n,i),a.normalize(t,t),c(r,t,Math.PI),r):o>.999999?(r[0]=0,r[1]=0,r[2]=0,r[3]=1,r):(a.cross(t,i,s),r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=1+o,_(r,r))}}(),e.sqlerp=function(){var t=u(),e=u();return function(n,r,i,a,s,o){return f(t,r,s,o),f(e,i,a,o),f(n,t,e,2*o*(1-o)),n}}(),e.setAxes=function(){var t=i.create();return function(e,n,r,i){return t[0]=r[0],t[3]=r[1],t[6]=r[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-n[0],t[5]=-n[1],t[8]=-n[2],_(e,l(e,t))}}()},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(16);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=0,t[12]=0,t[13]=0,t[14]=0),t[0]=1,t[5]=1,t[10]=1,t[15]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.fromValues=function(t,e,n,i,a,s,o,u,c,h,f,l,d,m,_,p){var g=new r.ARRAY_TYPE(16);return g[0]=t,g[1]=e,g[2]=n,g[3]=i,g[4]=a,g[5]=s,g[6]=o,g[7]=u,g[8]=c,g[9]=h,g[10]=f,g[11]=l,g[12]=d,g[13]=m,g[14]=_,g[15]=p,g},e.set=function(t,e,n,r,i,a,s,o,u,c,h,f,l,d,m,_,p){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t[8]=c,t[9]=h,t[10]=f,t[11]=l,t[12]=d,t[13]=m,t[14]=_,t[15]=p,t},e.identity=i,e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[3],a=e[6],s=e[7],o=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=n,t[6]=e[9],t[7]=e[13],t[8]=r,t[9]=a,t[11]=e[14],t[12]=i,t[13]=s,t[14]=o}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],p=e[14],g=e[15],v=n*o-r*s,E=n*u-i*s,T=n*c-a*s,M=r*u-i*o,A=r*c-a*o,L=i*c-a*u,O=h*_-f*m,I=h*p-l*m,S=h*g-d*m,R=f*p-l*_,y=f*g-d*_,x=l*g-d*p,N=v*x-E*y+T*R+M*S-A*I+L*O;return N?(N=1/N,t[0]=(o*x-u*y+c*R)*N,t[1]=(i*y-r*x-a*R)*N,t[2]=(_*L-p*A+g*M)*N,t[3]=(l*A-f*L-d*M)*N,t[4]=(u*S-s*x-c*I)*N,t[5]=(n*x-i*S+a*I)*N,t[6]=(p*T-m*L-g*E)*N,t[7]=(h*L-l*T+d*E)*N,t[8]=(s*y-o*S+c*O)*N,t[9]=(r*S-n*y-a*O)*N,t[10]=(m*A-_*T+g*v)*N,t[11]=(f*T-h*A-d*v)*N,t[12]=(o*I-s*R-u*O)*N,t[13]=(n*R-r*I+i*O)*N,t[14]=(_*E-m*M-p*v)*N,t[15]=(h*M-f*E+l*v)*N,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],p=e[14],g=e[15];return t[0]=o*(l*g-d*p)-f*(u*g-c*p)+_*(u*d-c*l),t[1]=-(r*(l*g-d*p)-f*(i*g-a*p)+_*(i*d-a*l)),t[2]=r*(u*g-c*p)-o*(i*g-a*p)+_*(i*c-a*u),t[3]=-(r*(u*d-c*l)-o*(i*d-a*l)+f*(i*c-a*u)),t[4]=-(s*(l*g-d*p)-h*(u*g-c*p)+m*(u*d-c*l)),t[5]=n*(l*g-d*p)-h*(i*g-a*p)+m*(i*d-a*l),t[6]=-(n*(u*g-c*p)-s*(i*g-a*p)+m*(i*c-a*u)),t[7]=n*(u*d-c*l)-s*(i*d-a*l)+h*(i*c-a*u),t[8]=s*(f*g-d*_)-h*(o*g-c*_)+m*(o*d-c*f),t[9]=-(n*(f*g-d*_)-h*(r*g-a*_)+m*(r*d-a*f)),t[10]=n*(o*g-c*_)-s*(r*g-a*_)+m*(r*c-a*o),t[11]=-(n*(o*d-c*f)-s*(r*d-a*f)+h*(r*c-a*o)),t[12]=-(s*(f*p-l*_)-h*(o*p-u*_)+m*(o*l-u*f)),t[13]=n*(f*p-l*_)-h*(r*p-i*_)+m*(r*l-i*f),t[14]=-(n*(o*p-u*_)-s*(r*p-i*_)+m*(r*u-i*o)),t[15]=n*(o*l-u*f)-s*(r*l-i*f)+h*(r*u-i*o),t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],c=t[8],h=t[9],f=t[10],l=t[11],d=t[12],m=t[13],_=t[14],p=t[15];return(e*s-n*a)*(f*p-l*_)-(e*o-r*a)*(h*p-l*m)+(e*u-i*a)*(h*_-f*m)+(n*o-r*s)*(c*p-l*d)-(n*u-i*s)*(c*_-f*d)+(r*u-i*o)*(c*m-h*d)},e.multiply=a,e.translate=function(t,e,n){var r=n[0],i=n[1],a=n[2],s=void 0,o=void 0,u=void 0,c=void 0,h=void 0,f=void 0,l=void 0,d=void 0,m=void 0,_=void 0,p=void 0,g=void 0;return e===t?(t[12]=e[0]*r+e[4]*i+e[8]*a+e[12],t[13]=e[1]*r+e[5]*i+e[9]*a+e[13],t[14]=e[2]*r+e[6]*i+e[10]*a+e[14],t[15]=e[3]*r+e[7]*i+e[11]*a+e[15]):(s=e[0],o=e[1],u=e[2],c=e[3],h=e[4],f=e[5],l=e[6],d=e[7],m=e[8],_=e[9],p=e[10],g=e[11],t[0]=s,t[1]=o,t[2]=u,t[3]=c,t[4]=h,t[5]=f,t[6]=l,t[7]=d,t[8]=m,t[9]=_,t[10]=p,t[11]=g,t[12]=s*r+h*i+m*a+e[12],t[13]=o*r+f*i+_*a+e[13],t[14]=u*r+l*i+p*a+e[14],t[15]=c*r+d*i+g*a+e[15]),t},e.scale=function(t,e,n){var r=n[0],i=n[1],a=n[2];return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*a,t[9]=e[9]*a,t[10]=e[10]*a,t[11]=e[11]*a,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},e.rotate=function(t,e,n,i){var a,s,o,u,c,h,f,l,d,m,_,p,g,v,E,T,M,A,L,O,I,S,R,y,x=i[0],N=i[1],b=i[2],C=Math.sqrt(x*x+N*N+b*b);return C<r.EPSILON?null:(x*=C=1/C,N*=C,b*=C,a=Math.sin(n),o=1-(s=Math.cos(n)),u=e[0],c=e[1],h=e[2],f=e[3],l=e[4],d=e[5],m=e[6],_=e[7],p=e[8],g=e[9],v=e[10],E=e[11],T=x*x*o+s,M=N*x*o+b*a,A=b*x*o-N*a,L=x*N*o-b*a,O=N*N*o+s,I=b*N*o+x*a,S=x*b*o+N*a,R=N*b*o-x*a,y=b*b*o+s,t[0]=u*T+l*M+p*A,t[1]=c*T+d*M+g*A,t[2]=h*T+m*M+v*A,t[3]=f*T+_*M+E*A,t[4]=u*L+l*O+p*I,t[5]=c*L+d*O+g*I,t[6]=h*L+m*O+v*I,t[7]=f*L+_*O+E*I,t[8]=u*S+l*R+p*y,t[9]=c*S+d*R+g*y,t[10]=h*S+m*R+v*y,t[11]=f*S+_*R+E*y,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)},e.rotateX=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[4],s=e[5],o=e[6],u=e[7],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=a*i+c*r,t[5]=s*i+h*r,t[6]=o*i+f*r,t[7]=u*i+l*r,t[8]=c*i-a*r,t[9]=h*i-s*r,t[10]=f*i-o*r,t[11]=l*i-u*r,t},e.rotateY=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],s=e[1],o=e[2],u=e[3],c=e[8],h=e[9],f=e[10],l=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i-c*r,t[1]=s*i-h*r,t[2]=o*i-f*r,t[3]=u*i-l*r,t[8]=a*r+c*i,t[9]=s*r+h*i,t[10]=o*r+f*i,t[11]=u*r+l*i,t},e.rotateZ=function(t,e,n){var r=Math.sin(n),i=Math.cos(n),a=e[0],s=e[1],o=e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=a*i+c*r,t[1]=s*i+h*r,t[2]=o*i+f*r,t[3]=u*i+l*r,t[4]=c*i-a*r,t[5]=h*i-s*r,t[6]=f*i-o*r,t[7]=l*i-u*r,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotation=function(t,e,n){var i,a,s,o=n[0],u=n[1],c=n[2],h=Math.sqrt(o*o+u*u+c*c);return h<r.EPSILON?null:(o*=h=1/h,u*=h,c*=h,i=Math.sin(e),s=1-(a=Math.cos(e)),t[0]=o*o*s+a,t[1]=u*o*s+c*i,t[2]=c*o*s-u*i,t[3]=0,t[4]=o*u*s-c*i,t[5]=u*u*s+a,t[6]=c*u*s+o*i,t[7]=0,t[8]=o*c*s+u*i,t[9]=u*c*s-o*i,t[10]=c*c*s+a,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)},e.fromXRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=r,t[6]=n,t[7]=0,t[8]=0,t[9]=-n,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromYRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=0,t[2]=-n,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=n,t[9]=0,t[10]=r,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromZRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=0,t[4]=-n,t[5]=r,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.fromRotationTranslation=s,e.fromQuat2=function(t,e){var n=new r.ARRAY_TYPE(3),i=-e[0],a=-e[1],o=-e[2],u=e[3],c=e[4],h=e[5],f=e[6],l=e[7],d=i*i+a*a+o*o+u*u;return d>0?(n[0]=2*(c*u+l*i+h*o-f*a)/d,n[1]=2*(h*u+l*a+f*i-c*o)/d,n[2]=2*(f*u+l*o+c*a-h*i)/d):(n[0]=2*(c*u+l*i+h*o-f*a),n[1]=2*(h*u+l*a+f*i-c*o),n[2]=2*(f*u+l*o+c*a-h*i)),s(t,e,n),t},e.getTranslation=function(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t},e.getScaling=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[4],s=e[5],o=e[6],u=e[8],c=e[9],h=e[10];return t[0]=Math.sqrt(n*n+r*r+i*i),t[1]=Math.sqrt(a*a+s*s+o*o),t[2]=Math.sqrt(u*u+c*c+h*h),t},e.getRotation=function(t,e){var n=e[0]+e[5]+e[10],r=0;return n>0?(r=2*Math.sqrt(n+1),t[3]=.25*r,t[0]=(e[6]-e[9])/r,t[1]=(e[8]-e[2])/r,t[2]=(e[1]-e[4])/r):e[0]>e[5]&&e[0]>e[10]?(r=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/r,t[0]=.25*r,t[1]=(e[1]+e[4])/r,t[2]=(e[8]+e[2])/r):e[5]>e[10]?(r=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/r,t[0]=(e[1]+e[4])/r,t[1]=.25*r,t[2]=(e[6]+e[9])/r):(r=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/r,t[0]=(e[8]+e[2])/r,t[1]=(e[6]+e[9])/r,t[2]=.25*r),t},e.fromRotationTranslationScale=function(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=e[3],u=i+i,c=a+a,h=s+s,f=i*u,l=i*c,d=i*h,m=a*c,_=a*h,p=s*h,g=o*u,v=o*c,E=o*h,T=r[0],M=r[1],A=r[2];return t[0]=(1-(m+p))*T,t[1]=(l+E)*T,t[2]=(d-v)*T,t[3]=0,t[4]=(l-E)*M,t[5]=(1-(f+p))*M,t[6]=(_+g)*M,t[7]=0,t[8]=(d+v)*A,t[9]=(_-g)*A,t[10]=(1-(f+m))*A,t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t},e.fromRotationTranslationScaleOrigin=function(t,e,n,r,i){var a=e[0],s=e[1],o=e[2],u=e[3],c=a+a,h=s+s,f=o+o,l=a*c,d=a*h,m=a*f,_=s*h,p=s*f,g=o*f,v=u*c,E=u*h,T=u*f,M=r[0],A=r[1],L=r[2],O=i[0],I=i[1],S=i[2],R=(1-(_+g))*M,y=(d+T)*M,x=(m-E)*M,N=(d-T)*A,b=(1-(l+g))*A,C=(p+v)*A,P=(m+E)*L,w=(p-v)*L,H=(1-(l+_))*L;return t[0]=R,t[1]=y,t[2]=x,t[3]=0,t[4]=N,t[5]=b,t[6]=C,t[7]=0,t[8]=P,t[9]=w,t[10]=H,t[11]=0,t[12]=n[0]+O-(R*O+N*I+P*S),t[13]=n[1]+I-(y*O+b*I+w*S),t[14]=n[2]+S-(x*O+C*I+H*S),t[15]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n+n,o=r+r,u=i+i,c=n*s,h=r*s,f=r*o,l=i*s,d=i*o,m=i*u,_=a*s,p=a*o,g=a*u;return t[0]=1-f-m,t[1]=h+g,t[2]=l-p,t[3]=0,t[4]=h-g,t[5]=1-c-m,t[6]=d+_,t[7]=0,t[8]=l+p,t[9]=d-_,t[10]=1-c-f,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},e.frustum=function(t,e,n,r,i,a,s){var o=1/(n-e),u=1/(i-r),c=1/(a-s);return t[0]=2*a*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*a*u,t[6]=0,t[7]=0,t[8]=(n+e)*o,t[9]=(i+r)*u,t[10]=(s+a)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*a*2*c,t[15]=0,t},e.perspective=function(t,e,n,r,i){var a=1/Math.tan(e/2),s=void 0;return t[0]=a/n,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=a,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[11]=-1,t[12]=0,t[13]=0,t[15]=0,null!=i&&i!==1/0?(s=1/(r-i),t[10]=(i+r)*s,t[14]=2*i*r*s):(t[10]=-1,t[14]=-2*r),t},e.perspectiveFromFieldOfView=function(t,e,n,r){var i=Math.tan(e.upDegrees*Math.PI/180),a=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),o=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+o),c=2/(i+a);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-o)*u*.5,t[9]=(i-a)*c*.5,t[10]=r/(n-r),t[11]=-1,t[12]=0,t[13]=0,t[14]=r*n/(n-r),t[15]=0,t},e.ortho=function(t,e,n,r,i,a,s){var o=1/(e-n),u=1/(r-i),c=1/(a-s);return t[0]=-2*o,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+n)*o,t[13]=(i+r)*u,t[14]=(s+a)*c,t[15]=1,t},e.lookAt=function(t,e,n,a){var s=void 0,o=void 0,u=void 0,c=void 0,h=void 0,f=void 0,l=void 0,d=void 0,m=void 0,_=void 0,p=e[0],g=e[1],v=e[2],E=a[0],T=a[1],M=a[2],A=n[0],L=n[1],O=n[2];return Math.abs(p-A)<r.EPSILON&&Math.abs(g-L)<r.EPSILON&&Math.abs(v-O)<r.EPSILON?i(t):(l=p-A,d=g-L,m=v-O,s=T*(m*=_=1/Math.sqrt(l*l+d*d+m*m))-M*(d*=_),o=M*(l*=_)-E*m,u=E*d-T*l,(_=Math.sqrt(s*s+o*o+u*u))?(s*=_=1/_,o*=_,u*=_):(s=0,o=0,u=0),c=d*u-m*o,h=m*s-l*u,f=l*o-d*s,(_=Math.sqrt(c*c+h*h+f*f))?(c*=_=1/_,h*=_,f*=_):(c=0,h=0,f=0),t[0]=s,t[1]=c,t[2]=l,t[3]=0,t[4]=o,t[5]=h,t[6]=d,t[7]=0,t[8]=u,t[9]=f,t[10]=m,t[11]=0,t[12]=-(s*p+o*g+u*v),t[13]=-(c*p+h*g+f*v),t[14]=-(l*p+d*g+m*v),t[15]=1,t)},e.targetTo=function(t,e,n,r){var i=e[0],a=e[1],s=e[2],o=r[0],u=r[1],c=r[2],h=i-n[0],f=a-n[1],l=s-n[2],d=h*h+f*f+l*l;d>0&&(h*=d=1/Math.sqrt(d),f*=d,l*=d);var m=u*l-c*f,_=c*h-o*l,p=o*f-u*h;return(d=m*m+_*_+p*p)>0&&(m*=d=1/Math.sqrt(d),_*=d,p*=d),t[0]=m,t[1]=_,t[2]=p,t[3]=0,t[4]=f*p-l*_,t[5]=l*m-h*p,t[6]=h*_-f*m,t[7]=0,t[8]=h,t[9]=f,t[10]=l,t[11]=0,t[12]=i,t[13]=a,t[14]=s,t[15]=1,t},e.str=function(t){return\"mat4(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\", \"+t[8]+\", \"+t[9]+\", \"+t[10]+\", \"+t[11]+\", \"+t[12]+\", \"+t[13]+\", \"+t[14]+\", \"+t[15]+\")\"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t[9]=e[9]+n[9],t[10]=e[10]+n[10],t[11]=e[11]+n[11],t[12]=e[12]+n[12],t[13]=e[13]+n[13],t[14]=e[14]+n[14],t[15]=e[15]+n[15],t},e.subtract=o,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t[9]=e[9]*n,t[10]=e[10]*n,t[11]=e[11]*n,t[12]=e[12]*n,t[13]=e[13]*n,t[14]=e[14]*n,t[15]=e[15]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t[9]=e[9]+n[9]*r,t[10]=e[10]+n[10]*r,t[11]=e[11]+n[11]*r,t[12]=e[12]+n[12]*r,t[13]=e[13]+n[13]*r,t[14]=e[14]+n[14]*r,t[15]=e[15]+n[15]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=t[8],l=t[9],d=t[10],m=t[11],_=t[12],p=t[13],g=t[14],v=t[15],E=e[0],T=e[1],M=e[2],A=e[3],L=e[4],O=e[5],I=e[6],S=e[7],R=e[8],y=e[9],x=e[10],N=e[11],b=e[12],C=e[13],P=e[14],w=e[15];return Math.abs(n-E)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(E))&&Math.abs(i-T)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(T))&&Math.abs(a-M)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(M))&&Math.abs(s-A)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(A))&&Math.abs(o-L)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(L))&&Math.abs(u-O)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(O))&&Math.abs(c-I)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(I))&&Math.abs(h-S)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(S))&&Math.abs(f-R)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(R))&&Math.abs(l-y)<=r.EPSILON*Math.max(1,Math.abs(l),Math.abs(y))&&Math.abs(d-x)<=r.EPSILON*Math.max(1,Math.abs(d),Math.abs(x))&&Math.abs(m-N)<=r.EPSILON*Math.max(1,Math.abs(m),Math.abs(N))&&Math.abs(_-b)<=r.EPSILON*Math.max(1,Math.abs(_),Math.abs(b))&&Math.abs(p-C)<=r.EPSILON*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(g-P)<=r.EPSILON*Math.max(1,Math.abs(g),Math.abs(P))&&Math.abs(v-w)<=r.EPSILON*Math.max(1,Math.abs(v),Math.abs(w))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function a(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=e[9],d=e[10],m=e[11],_=e[12],p=e[13],g=e[14],v=e[15],E=n[0],T=n[1],M=n[2],A=n[3];return t[0]=E*r+T*o+M*f+A*_,t[1]=E*i+T*u+M*l+A*p,t[2]=E*a+T*c+M*d+A*g,t[3]=E*s+T*h+M*m+A*v,E=n[4],T=n[5],M=n[6],A=n[7],t[4]=E*r+T*o+M*f+A*_,t[5]=E*i+T*u+M*l+A*p,t[6]=E*a+T*c+M*d+A*g,t[7]=E*s+T*h+M*m+A*v,E=n[8],T=n[9],M=n[10],A=n[11],t[8]=E*r+T*o+M*f+A*_,t[9]=E*i+T*u+M*l+A*p,t[10]=E*a+T*c+M*d+A*g,t[11]=E*s+T*h+M*m+A*v,E=n[12],T=n[13],M=n[14],A=n[15],t[12]=E*r+T*o+M*f+A*_,t[13]=E*i+T*u+M*l+A*p,t[14]=E*a+T*c+M*d+A*g,t[15]=E*s+T*h+M*m+A*v,t}function s(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=r+r,u=i+i,c=a+a,h=r*o,f=r*u,l=r*c,d=i*u,m=i*c,_=a*c,p=s*o,g=s*u,v=s*c;return t[0]=1-(d+_),t[1]=f+v,t[2]=l-g,t[3]=0,t[4]=f-v,t[5]=1-(h+_),t[6]=m+p,t[7]=0,t[8]=l+g,t[9]=m-p,t[10]=1-(h+d),t[11]=0,t[12]=n[0],t[13]=n[1],t[14]=n[2],t[15]=1,t}function o(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t[9]=e[9]-n[9],t[10]=e[10]-n[10],t[11]=e[11]-n[11],t[12]=e[12]-n[12],t[13]=e[13]-n[13],t[14]=e[14]-n[14],t[15]=e[15]-n[15],t}e.mul=a,e.sub=o},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(9);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[3]=0,t[5]=0,t[6]=0,t[7]=0),t[0]=1,t[4]=1,t[8]=1,t},e.fromMat4=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},e.clone=function(t){var e=new r.ARRAY_TYPE(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromValues=function(t,e,n,i,a,s,o,u,c){var h=new r.ARRAY_TYPE(9);return h[0]=t,h[1]=e,h[2]=n,h[3]=i,h[4]=a,h[5]=s,h[6]=o,h[7]=u,h[8]=c,h},e.set=function(t,e,n,r,i,a,s,o,u,c){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t[8]=c,t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.transpose=function(t,e){if(t===e){var n=e[1],r=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=n,t[5]=e[7],t[6]=r,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8],f=h*s-o*c,l=-h*a+o*u,d=c*a-s*u,m=n*f+r*l+i*d;return m?(m=1/m,t[0]=f*m,t[1]=(-h*r+i*c)*m,t[2]=(o*r-i*s)*m,t[3]=l*m,t[4]=(h*n-i*u)*m,t[5]=(-o*n+i*a)*m,t[6]=d*m,t[7]=(-c*n+r*u)*m,t[8]=(s*n-r*a)*m,t):null},e.adjoint=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8];return t[0]=s*h-o*c,t[1]=i*c-r*h,t[2]=r*o-i*s,t[3]=o*u-a*h,t[4]=n*h-i*u,t[5]=i*a-n*o,t[6]=a*c-s*u,t[7]=r*u-n*c,t[8]=n*s-r*a,t},e.determinant=function(t){var e=t[0],n=t[1],r=t[2],i=t[3],a=t[4],s=t[5],o=t[6],u=t[7],c=t[8];return e*(c*a-s*u)+n*(-c*i+s*o)+r*(u*i-a*o)},e.multiply=i,e.translate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=n[0],d=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=o,t[5]=u,t[6]=l*r+d*s+c,t[7]=l*i+d*o+h,t[8]=l*a+d*u+f,t},e.rotate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=Math.sin(n),d=Math.cos(n);return t[0]=d*r+l*s,t[1]=d*i+l*o,t[2]=d*a+l*u,t[3]=d*s-l*r,t[4]=d*o-l*i,t[5]=d*u-l*a,t[6]=c,t[7]=h,t[8]=f,t},e.scale=function(t,e,n){var r=n[0],i=n[1];return t[0]=r*e[0],t[1]=r*e[1],t[2]=r*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=0,t[3]=-n,t[4]=r,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t},e.fromMat2d=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t},e.fromQuat=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n+n,o=r+r,u=i+i,c=n*s,h=r*s,f=r*o,l=i*s,d=i*o,m=i*u,_=a*s,p=a*o,g=a*u;return t[0]=1-f-m,t[3]=h-g,t[6]=l+p,t[1]=h+g,t[4]=1-c-m,t[7]=d-_,t[2]=l-p,t[5]=d+_,t[8]=1-c-f,t},e.normalFromMat4=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=e[6],c=e[7],h=e[8],f=e[9],l=e[10],d=e[11],m=e[12],_=e[13],p=e[14],g=e[15],v=n*o-r*s,E=n*u-i*s,T=n*c-a*s,M=r*u-i*o,A=r*c-a*o,L=i*c-a*u,O=h*_-f*m,I=h*p-l*m,S=h*g-d*m,R=f*p-l*_,y=f*g-d*_,x=l*g-d*p,N=v*x-E*y+T*R+M*S-A*I+L*O;return N?(N=1/N,t[0]=(o*x-u*y+c*R)*N,t[1]=(u*S-s*x-c*I)*N,t[2]=(s*y-o*S+c*O)*N,t[3]=(i*y-r*x-a*R)*N,t[4]=(n*x-i*S+a*I)*N,t[5]=(r*S-n*y-a*O)*N,t[6]=(_*L-p*A+g*M)*N,t[7]=(p*T-m*L-g*E)*N,t[8]=(m*A-_*T+g*v)*N,t):null},e.projection=function(t,e,n){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/n,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t},e.str=function(t){return\"mat3(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\", \"+t[8]+\")\"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t[8]=e[8]+n[8],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t[8]=e[8]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t[6]=e[6]+n[6]*r,t[7]=e[7]+n[7]*r,t[8]=e[8]+n[8]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=t[8],l=e[0],d=e[1],m=e[2],_=e[3],p=e[4],g=e[5],v=e[6],E=e[7],T=e[8];return Math.abs(n-l)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(l))&&Math.abs(i-d)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(d))&&Math.abs(a-m)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(m))&&Math.abs(s-_)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(_))&&Math.abs(o-p)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(u-g)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(g))&&Math.abs(c-v)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(v))&&Math.abs(h-E)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(E))&&Math.abs(f-T)<=r.EPSILON*Math.max(1,Math.abs(f),Math.abs(T))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=e[6],h=e[7],f=e[8],l=n[0],d=n[1],m=n[2],_=n[3],p=n[4],g=n[5],v=n[6],E=n[7],T=n[8];return t[0]=l*r+d*s+m*c,t[1]=l*i+d*o+m*h,t[2]=l*a+d*u+m*f,t[3]=_*r+p*s+g*c,t[4]=_*i+p*o+g*h,t[5]=_*a+p*u+g*f,t[6]=v*r+E*s+T*c,t[7]=v*i+E*o+T*h,t[8]=v*a+E*u+T*f,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t[6]=e[6]-n[6],t[7]=e[7]-n[7],t[8]=e[8]-n[8],t}e.mul=i,e.sub=a},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.forEach=e.sqrLen=e.sqrDist=e.dist=e.div=e.mul=e.sub=e.len=void 0,e.create=i,e.clone=function(t){var e=new r.ARRAY_TYPE(2);return e[0]=t[0],e[1]=t[1],e},e.fromValues=function(t,e){var n=new r.ARRAY_TYPE(2);return n[0]=t,n[1]=e,n},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t},e.set=function(t,e,n){return t[0]=e,t[1]=n,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t},e.subtract=a,e.multiply=s,e.divide=o,e.ceil=function(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t},e.floor=function(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t},e.min=function(t,e,n){return t[0]=Math.min(e[0],n[0]),t[1]=Math.min(e[1],n[1]),t},e.max=function(t,e,n){return t[0]=Math.max(e[0],n[0]),t[1]=Math.max(e[1],n[1]),t},e.round=function(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t},e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t},e.scaleAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t},e.distance=u,e.squaredDistance=c,e.length=h,e.squaredLength=f,e.negate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t},e.inverse=function(t,e){return t[0]=1/e[0],t[1]=1/e[1],t},e.normalize=function(t,e){var n=e[0],r=e[1],i=n*n+r*r;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]},e.cross=function(t,e,n){var r=e[0]*n[1]-e[1]*n[0];return t[0]=t[1]=0,t[2]=r,t},e.lerp=function(t,e,n,r){var i=e[0],a=e[1];return t[0]=i+r*(n[0]-i),t[1]=a+r*(n[1]-a),t},e.random=function(t,e){e=e||1;var n=2*r.RANDOM()*Math.PI;return t[0]=Math.cos(n)*e,t[1]=Math.sin(n)*e,t},e.transformMat2=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i,t[1]=n[1]*r+n[3]*i,t},e.transformMat2d=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[2]*i+n[4],t[1]=n[1]*r+n[3]*i+n[5],t},e.transformMat3=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[3]*i+n[6],t[1]=n[1]*r+n[4]*i+n[7],t},e.transformMat4=function(t,e,n){var r=e[0],i=e[1];return t[0]=n[0]*r+n[4]*i+n[12],t[1]=n[1]*r+n[5]*i+n[13],t},e.rotate=function(t,e,n,r){var i=e[0]-n[0],a=e[1]-n[1],s=Math.sin(r),o=Math.cos(r);return t[0]=i*o-a*s+n[0],t[1]=i*s+a*o+n[1],t},e.angle=function(t,e){var n=t[0],r=t[1],i=e[0],a=e[1],s=n*n+r*r;s>0&&(s=1/Math.sqrt(s));var o=i*i+a*a;o>0&&(o=1/Math.sqrt(o));var u=(n*i+r*a)*s*o;return u>1?0:u<-1?Math.PI:Math.acos(u)},e.str=function(t){return\"vec2(\"+t[0]+\", \"+t[1]+\")\"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]},e.equals=function(t,e){var n=t[0],i=t[1],a=e[0],s=e[1];return Math.abs(n-a)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-s)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(s))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(){var t=new r.ARRAY_TYPE(2);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0),t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t}function s(t,e,n){return t[0]=e[0]*n[0],t[1]=e[1]*n[1],t}function o(t,e,n){return t[0]=e[0]/n[0],t[1]=e[1]/n[1],t}function u(t,e){var n=e[0]-t[0],r=e[1]-t[1];return Math.sqrt(n*n+r*r)}function c(t,e){var n=e[0]-t[0],r=e[1]-t[1];return n*n+r*r}function h(t){var e=t[0],n=t[1];return Math.sqrt(e*e+n*n)}function f(t){var e=t[0],n=t[1];return e*e+n*n}e.len=h,e.sub=a,e.mul=s,e.div=o,e.dist=u,e.sqrDist=c,e.sqrLen=f,e.forEach=function(){var t=i();return function(e,n,r,i,a,s){var o,u=void 0;for(n||(n=2),r||(r=0),o=i?Math.min(i*n+r,e.length):e.length,u=r;u<o;u+=n)t[0]=e[u],t[1]=e[u+1],a(t,t,s),e[u]=t[0],e[u+1]=t[1];return e}}()},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.sqrLen=e.squaredLength=e.len=e.length=e.dot=e.mul=e.setReal=e.getReal=void 0,e.create=function(){var t=new r.ARRAY_TYPE(8);return r.ARRAY_TYPE!=Float32Array&&(t[0]=0,t[1]=0,t[2]=0,t[4]=0,t[5]=0,t[6]=0,t[7]=0),t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e},e.fromValues=function(t,e,n,i,a,s,o,u){var c=new r.ARRAY_TYPE(8);return c[0]=t,c[1]=e,c[2]=n,c[3]=i,c[4]=a,c[5]=s,c[6]=o,c[7]=u,c},e.fromRotationTranslationValues=function(t,e,n,i,a,s,o){var u=new r.ARRAY_TYPE(8);u[0]=t,u[1]=e,u[2]=n,u[3]=i;var c=.5*a,h=.5*s,f=.5*o;return u[4]=c*i+h*n-f*e,u[5]=h*i+f*t-c*n,u[6]=f*i+c*e-h*t,u[7]=-c*t-h*e-f*n,u},e.fromRotationTranslation=o,e.fromTranslation=function(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t},e.fromRotation=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.fromMat4=function(t,e){var n=i.create();a.getRotation(n,e);var s=new r.ARRAY_TYPE(3);return a.getTranslation(s,e),o(t,n,s),t},e.copy=u,e.identity=function(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t},e.set=function(t,e,n,r,i,a,s,o,u){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t[6]=o,t[7]=u,t},e.getDual=function(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t},e.setDual=function(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t},e.getTranslation=function(t,e){var n=e[4],r=e[5],i=e[6],a=e[7],s=-e[0],o=-e[1],u=-e[2],c=e[3];return t[0]=2*(n*c+a*s+r*u-i*o),t[1]=2*(r*c+a*o+i*s-n*u),t[2]=2*(i*c+a*u+n*o-r*s),t},e.translate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=.5*n[0],u=.5*n[1],c=.5*n[2],h=e[4],f=e[5],l=e[6],d=e[7];return t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=s*o+i*c-a*u+h,t[5]=s*u+a*o-r*c+f,t[6]=s*c+r*u-i*o+l,t[7]=-r*o-i*u-a*c+d,t},e.rotateX=function(t,e,n){var r=-e[0],a=-e[1],s=-e[2],o=e[3],u=e[4],c=e[5],h=e[6],f=e[7],l=u*o+f*r+c*s-h*a,d=c*o+f*a+h*r-u*s,m=h*o+f*s+u*a-c*r,_=f*o-u*r-c*a-h*s;return i.rotateX(t,e,n),r=t[0],a=t[1],s=t[2],o=t[3],t[4]=l*o+_*r+d*s-m*a,t[5]=d*o+_*a+m*r-l*s,t[6]=m*o+_*s+l*a-d*r,t[7]=_*o-l*r-d*a-m*s,t},e.rotateY=function(t,e,n){var r=-e[0],a=-e[1],s=-e[2],o=e[3],u=e[4],c=e[5],h=e[6],f=e[7],l=u*o+f*r+c*s-h*a,d=c*o+f*a+h*r-u*s,m=h*o+f*s+u*a-c*r,_=f*o-u*r-c*a-h*s;return i.rotateY(t,e,n),r=t[0],a=t[1],s=t[2],o=t[3],t[4]=l*o+_*r+d*s-m*a,t[5]=d*o+_*a+m*r-l*s,t[6]=m*o+_*s+l*a-d*r,t[7]=_*o-l*r-d*a-m*s,t},e.rotateZ=function(t,e,n){var r=-e[0],a=-e[1],s=-e[2],o=e[3],u=e[4],c=e[5],h=e[6],f=e[7],l=u*o+f*r+c*s-h*a,d=c*o+f*a+h*r-u*s,m=h*o+f*s+u*a-c*r,_=f*o-u*r-c*a-h*s;return i.rotateZ(t,e,n),r=t[0],a=t[1],s=t[2],o=t[3],t[4]=l*o+_*r+d*s-m*a,t[5]=d*o+_*a+m*r-l*s,t[6]=m*o+_*s+l*a-d*r,t[7]=_*o-l*r-d*a-m*s,t},e.rotateByQuatAppend=function(t,e,n){var r=n[0],i=n[1],a=n[2],s=n[3],o=e[0],u=e[1],c=e[2],h=e[3];return t[0]=o*s+h*r+u*a-c*i,t[1]=u*s+h*i+c*r-o*a,t[2]=c*s+h*a+o*i-u*r,t[3]=h*s-o*r-u*i-c*a,o=e[4],u=e[5],c=e[6],h=e[7],t[4]=o*s+h*r+u*a-c*i,t[5]=u*s+h*i+c*r-o*a,t[6]=c*s+h*a+o*i-u*r,t[7]=h*s-o*r-u*i-c*a,t},e.rotateByQuatPrepend=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*h+s*o+i*c-a*u,t[1]=i*h+s*u+a*o-r*c,t[2]=a*h+s*c+r*u-i*o,t[3]=s*h-r*o-i*u-a*c,o=n[4],u=n[5],c=n[6],h=n[7],t[4]=r*h+s*o+i*c-a*u,t[5]=i*h+s*u+a*o-r*c,t[6]=a*h+s*c+r*u-i*o,t[7]=s*h-r*o-i*u-a*c,t},e.rotateAroundAxis=function(t,e,n,i){if(Math.abs(i)<r.EPSILON)return u(t,e);var a=Math.sqrt(n[0]*n[0]+n[1]*n[1]+n[2]*n[2]);i*=.5;var s=Math.sin(i),o=s*n[0]/a,c=s*n[1]/a,h=s*n[2]/a,f=Math.cos(i),l=e[0],d=e[1],m=e[2],_=e[3];t[0]=l*f+_*o+d*h-m*c,t[1]=d*f+_*c+m*o-l*h,t[2]=m*f+_*h+l*c-d*o,t[3]=_*f-l*o-d*c-m*h;var p=e[4],g=e[5],v=e[6],E=e[7];return t[4]=p*f+E*o+g*h-v*c,t[5]=g*f+E*c+v*o-p*h,t[6]=v*f+E*h+p*c-g*o,t[7]=E*f-p*o-g*c-v*h,t},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t[6]=e[6]+n[6],t[7]=e[7]+n[7],t},e.multiply=c,e.scale=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t[6]=e[6]*n,t[7]=e[7]*n,t},e.lerp=function(t,e,n,r){var i=1-r;return h(e,n)<0&&(r=-r),t[0]=e[0]*i+n[0]*r,t[1]=e[1]*i+n[1]*r,t[2]=e[2]*i+n[2]*r,t[3]=e[3]*i+n[3]*r,t[4]=e[4]*i+n[4]*r,t[5]=e[5]*i+n[5]*r,t[6]=e[6]*i+n[6]*r,t[7]=e[7]*i+n[7]*r,t},e.invert=function(t,e){var n=l(e);return t[0]=-e[0]/n,t[1]=-e[1]/n,t[2]=-e[2]/n,t[3]=e[3]/n,t[4]=-e[4]/n,t[5]=-e[5]/n,t[6]=-e[6]/n,t[7]=e[7]/n,t},e.conjugate=function(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t},e.normalize=function(t,e){var n=l(e);if(n>0){n=Math.sqrt(n);var r=e[0]/n,i=e[1]/n,a=e[2]/n,s=e[3]/n,o=e[4],u=e[5],c=e[6],h=e[7],f=r*o+i*u+a*c+s*h;t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=(o-r*f)/n,t[5]=(u-i*f)/n,t[6]=(c-a*f)/n,t[7]=(h-s*f)/n}return t},e.str=function(t){return\"quat2(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\", \"+t[6]+\", \"+t[7]+\")\"},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],u=t[5],c=t[6],h=t[7],f=e[0],l=e[1],d=e[2],m=e[3],_=e[4],p=e[5],g=e[6],v=e[7];return Math.abs(n-f)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(f))&&Math.abs(i-l)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(a-d)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(s-m)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(m))&&Math.abs(o-_)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(u-p)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(p))&&Math.abs(c-g)<=r.EPSILON*Math.max(1,Math.abs(c),Math.abs(g))&&Math.abs(h-v)<=r.EPSILON*Math.max(1,Math.abs(h),Math.abs(v))};var r=s(n(0)),i=s(n(3)),a=s(n(4));function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function o(t,e,n){var r=.5*n[0],i=.5*n[1],a=.5*n[2],s=e[0],o=e[1],u=e[2],c=e[3];return t[0]=s,t[1]=o,t[2]=u,t[3]=c,t[4]=r*c+i*u-a*o,t[5]=i*c+a*s-r*u,t[6]=a*c+r*o-i*s,t[7]=-r*s-i*o-a*u,t}function u(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function c(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[4],u=n[5],c=n[6],h=n[7],f=e[4],l=e[5],d=e[6],m=e[7],_=n[0],p=n[1],g=n[2],v=n[3];return t[0]=r*v+s*_+i*g-a*p,t[1]=i*v+s*p+a*_-r*g,t[2]=a*v+s*g+r*p-i*_,t[3]=s*v-r*_-i*p-a*g,t[4]=r*h+s*o+i*c-a*u+f*v+m*_+l*g-d*p,t[5]=i*h+s*u+a*o-r*c+l*v+m*p+d*_-f*g,t[6]=a*h+s*c+r*u-i*o+d*v+m*g+f*p-l*_,t[7]=s*h-r*o-i*u-a*c+m*v-f*_-l*p-d*g,t}e.getReal=i.copy,e.setReal=i.copy,e.mul=c;var h=e.dot=i.dot,f=e.length=i.length,l=(e.len=f,e.squaredLength=i.squaredLength);e.sqrLen=l},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(6);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0,t[4]=0,t[5]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t},e.fromValues=function(t,e,n,i,a,s){var o=new r.ARRAY_TYPE(6);return o[0]=t,o[1]=e,o[2]=n,o[3]=i,o[4]=a,o[5]=s,o},e.set=function(t,e,n,r,i,a,s){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t[4]=a,t[5]=s,t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=e[4],o=e[5],u=n*a-r*i;return u?(u=1/u,t[0]=a*u,t[1]=-r*u,t[2]=-i*u,t[3]=n*u,t[4]=(i*o-a*s)*u,t[5]=(r*s-n*o)*u,t):null},e.determinant=function(t){return t[0]*t[3]-t[1]*t[2]},e.multiply=i,e.rotate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=Math.sin(n),h=Math.cos(n);return t[0]=r*h+a*c,t[1]=i*h+s*c,t[2]=r*-c+a*h,t[3]=i*-c+s*h,t[4]=o,t[5]=u,t},e.scale=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r*c,t[1]=i*c,t[2]=a*h,t[3]=s*h,t[4]=o,t[5]=u,t},e.translate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=n[0],h=n[1];return t[0]=r,t[1]=i,t[2]=a,t[3]=s,t[4]=r*c+a*h+o,t[5]=i*c+s*h+u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t[4]=0,t[5]=0,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t},e.fromTranslation=function(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t},e.str=function(t){return\"mat2d(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\", \"+t[4]+\", \"+t[5]+\")\"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t[4]=e[4]+n[4],t[5]=e[5]+n[5],t},e.subtract=a,e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*n,t[5]=e[5]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t[4]=e[4]+n[4]*r,t[5]=e[5]+n[5]*r,t},e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=t[4],u=t[5],c=e[0],h=e[1],f=e[2],l=e[3],d=e[4],m=e[5];return Math.abs(n-c)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-h)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(a-f)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(f))&&Math.abs(s-l)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(l))&&Math.abs(o-d)<=r.EPSILON*Math.max(1,Math.abs(o),Math.abs(d))&&Math.abs(u-m)<=r.EPSILON*Math.max(1,Math.abs(u),Math.abs(m))};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=e[4],u=e[5],c=n[0],h=n[1],f=n[2],l=n[3],d=n[4],m=n[5];return t[0]=r*c+a*h,t[1]=i*c+s*h,t[2]=r*f+a*l,t[3]=i*f+s*l,t[4]=r*d+a*m+o,t[5]=i*d+s*m+u,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t[4]=e[4]-n[4],t[5]=e[5]-n[5],t}e.mul=i,e.sub=a},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.sub=e.mul=void 0,e.create=function(){var t=new r.ARRAY_TYPE(4);return r.ARRAY_TYPE!=Float32Array&&(t[1]=0,t[2]=0),t[0]=1,t[3]=1,t},e.clone=function(t){var e=new r.ARRAY_TYPE(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e},e.copy=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},e.identity=function(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t},e.fromValues=function(t,e,n,i){var a=new r.ARRAY_TYPE(4);return a[0]=t,a[1]=e,a[2]=n,a[3]=i,a},e.set=function(t,e,n,r,i){return t[0]=e,t[1]=n,t[2]=r,t[3]=i,t},e.transpose=function(t,e){if(t===e){var n=e[1];t[1]=e[2],t[2]=n}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t},e.invert=function(t,e){var n=e[0],r=e[1],i=e[2],a=e[3],s=n*a-i*r;return s?(s=1/s,t[0]=a*s,t[1]=-r*s,t[2]=-i*s,t[3]=n*s,t):null},e.adjoint=function(t,e){var n=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=n,t},e.determinant=function(t){return t[0]*t[3]-t[2]*t[1]},e.multiply=i,e.rotate=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=Math.sin(n),u=Math.cos(n);return t[0]=r*u+a*o,t[1]=i*u+s*o,t[2]=r*-o+a*u,t[3]=i*-o+s*u,t},e.scale=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],u=n[1];return t[0]=r*o,t[1]=i*o,t[2]=a*u,t[3]=s*u,t},e.fromRotation=function(t,e){var n=Math.sin(e),r=Math.cos(e);return t[0]=r,t[1]=n,t[2]=-n,t[3]=r,t},e.fromScaling=function(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t},e.str=function(t){return\"mat2(\"+t[0]+\", \"+t[1]+\", \"+t[2]+\", \"+t[3]+\")\"},e.frob=function(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))},e.LDU=function(t,e,n,r){return t[2]=r[2]/r[0],n[0]=r[0],n[1]=r[1],n[3]=r[3]-t[2]*n[1],[t,e,n]},e.add=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t[3]=e[3]+n[3],t},e.subtract=a,e.exactEquals=function(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]},e.equals=function(t,e){var n=t[0],i=t[1],a=t[2],s=t[3],o=e[0],u=e[1],c=e[2],h=e[3];return Math.abs(n-o)<=r.EPSILON*Math.max(1,Math.abs(n),Math.abs(o))&&Math.abs(i-u)<=r.EPSILON*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(a-c)<=r.EPSILON*Math.max(1,Math.abs(a),Math.abs(c))&&Math.abs(s-h)<=r.EPSILON*Math.max(1,Math.abs(s),Math.abs(h))},e.multiplyScalar=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t},e.multiplyScalarAndAdd=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t[3]=e[3]+n[3]*r,t};var r=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}(n(0));function i(t,e,n){var r=e[0],i=e[1],a=e[2],s=e[3],o=n[0],u=n[1],c=n[2],h=n[3];return t[0]=r*o+a*u,t[1]=i*o+s*u,t[2]=r*c+a*h,t[3]=i*c+s*h,t}function a(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t[3]=e[3]-n[3],t}e.mul=i,e.sub=a},function(t,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0}),e.vec4=e.vec3=e.vec2=e.quat2=e.quat=e.mat4=e.mat3=e.mat2d=e.mat2=e.glMatrix=void 0;var r=d(n(0)),i=d(n(9)),a=d(n(8)),s=d(n(5)),o=d(n(4)),u=d(n(3)),c=d(n(7)),h=d(n(6)),f=d(n(2)),l=d(n(1));function d(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}e.glMatrix=r,e.mat2=i,e.mat2d=a,e.mat3=s,e.mat4=o,e.quat=u,e.quat2=c,e.vec2=h,e.vec3=f,e.vec4=l}])},function(t,e,n){\"use strict\";var r=function(){var t,e;try{t=Object.defineProperty,e=Object.defineProperties,t({},\"$\",{value:0})}catch(n){\"__defineGetter__\"in Object&&(t=function(t,e,n){return\"value\"in n&&(t[e]=n.value),\"get\"in n&&t.__defineGetter__(e,n.get),\"set\"in n&&t.__defineSetter__(e,n.set),t},e=function(e,n){for(var r in n)n.hasOwnProperty(r)&&t(e,r,n[r]);return e})}var n=function(t){for(var n=1,r=arguments.length;n<r;n++){var i=arguments[n],a=void 0;for(var s in i){var o=i[s];!o||\"object\"!=typeof o||void 0===o.value&&\"function\"!=typeof o.get&&\"function\"!=typeof o.set?t[s]=o:(a=a||{})[s]=o}a&&e(t,a)}return t},r=function(){if(Object.__proto__)return function(t){return{__proto__:t}};var t=function(){};return function(e){return t.prototype=e,new t}}(),i={Extends:function(t){var e=this.prototype,i=r(t.prototype);n(this,t),n(i,e),i.constructor=this,this.prototype=i,this.superclass=t.prototype},Mixes:function(t){t instanceof Array||(t=[t]);for(var e,r=this.prototype;e=t.shift();)n(r,e.prototype||e)},Statics:function(t){n(this,t)}},a=function(t){var e,r,a={};for(r in t)e=t[r],i.hasOwnProperty(r)?i[r].call(this,e):a[r]=e;n(this.prototype,a)};return{create:function(t){var e=(t=t||{}).hasOwnProperty(\"constructor\")?t.constructor:function(){};return a.call(e,t),e},mix:n}}();e.a=r},function(t,e,n){\"use strict\";var r={};n.r(r),n.d(r,\"ACTIVE_ATTRIBUTES\",(function(){return s})),n.d(r,\"ACTIVE_ATTRIBUTE_MAX_LENGTH\",(function(){return o})),n.d(r,\"ACTIVE_TEXTURE\",(function(){return u})),n.d(r,\"ACTIVE_UNIFORMS\",(function(){return c})),n.d(r,\"ACTIVE_UNIFORM_MAX_LENGTH\",(function(){return h})),n.d(r,\"ALIASED_LINE_WIDTH_RANGE\",(function(){return f})),n.d(r,\"ALIASED_POINT_SIZE_RANGE\",(function(){return l})),n.d(r,\"ALPHA\",(function(){return d})),n.d(r,\"ALPHA_BITS\",(function(){return m})),n.d(r,\"ALWAYS\",(function(){return _})),n.d(r,\"ARRAY_BUFFER\",(function(){return p})),n.d(r,\"ARRAY_BUFFER_BINDING\",(function(){return g})),n.d(r,\"ATTACHED_SHADERS\",(function(){return v})),n.d(r,\"BACK\",(function(){return E})),n.d(r,\"BLEND\",(function(){return T})),n.d(r,\"BLEND_COLOR\",(function(){return M})),n.d(r,\"BLEND_DST_ALPHA\",(function(){return A})),n.d(r,\"BLEND_DST_RGB\",(function(){return L})),n.d(r,\"BLEND_EQUATION\",(function(){return O})),n.d(r,\"BLEND_EQUATION_ALPHA\",(function(){return I})),n.d(r,\"BLEND_EQUATION_RGB\",(function(){return S})),n.d(r,\"BLEND_SRC_ALPHA\",(function(){return R})),n.d(r,\"BLEND_SRC_RGB\",(function(){return y})),n.d(r,\"BLUE_BITS\",(function(){return x})),n.d(r,\"BOOL\",(function(){return N})),n.d(r,\"BOOL_VEC2\",(function(){return b})),n.d(r,\"BOOL_VEC3\",(function(){return C})),n.d(r,\"BOOL_VEC4\",(function(){return P})),n.d(r,\"BROWSER_DEFAULT_WEBGL\",(function(){return w})),n.d(r,\"BUFFER_SIZE\",(function(){return H})),n.d(r,\"BUFFER_USAGE\",(function(){return D})),n.d(r,\"BYTE\",(function(){return F})),n.d(r,\"CCW\",(function(){return U})),n.d(r,\"CLAMP_TO_EDGE\",(function(){return G})),n.d(r,\"COLOR_ATTACHMENT0\",(function(){return B})),n.d(r,\"COLOR_BUFFER_BIT\",(function(){return V})),n.d(r,\"COLOR_CLEAR_VALUE\",(function(){return X})),n.d(r,\"COLOR_WRITEMASK\",(function(){return j})),n.d(r,\"COMPILE_STATUS\",(function(){return k})),n.d(r,\"COMPRESSED_TEXTURE_FORMATS\",(function(){return z})),n.d(r,\"CONSTANT_ALPHA\",(function(){return Y})),n.d(r,\"CONSTANT_COLOR\",(function(){return W})),n.d(r,\"CONTEXT_LOST_WEBGL\",(function(){return q})),n.d(r,\"CULL_FACE\",(function(){return Z})),n.d(r,\"CULL_FACE_MODE\",(function(){return K})),n.d(r,\"CURRENT_PROGRAM\",(function(){return Q})),n.d(r,\"CURRENT_VERTEX_ATTRIB\",(function(){return J})),n.d(r,\"CW\",(function(){return $})),n.d(r,\"DECR\",(function(){return tt})),n.d(r,\"DECR_WRAP\",(function(){return et})),n.d(r,\"DELETE_STATUS\",(function(){return nt})),n.d(r,\"DEPTH_ATTACHMENT\",(function(){return rt})),n.d(r,\"DEPTH_BITS\",(function(){return it})),n.d(r,\"DEPTH_BUFFER_BIT\",(function(){return at})),n.d(r,\"DEPTH_CLEAR_VALUE\",(function(){return st})),n.d(r,\"DEPTH_COMPONENT\",(function(){return ot})),n.d(r,\"DEPTH_COMPONENT16\",(function(){return ut})),n.d(r,\"DEPTH_FUNC\",(function(){return ct})),n.d(r,\"DEPTH_RANGE\",(function(){return ht})),n.d(r,\"DEPTH_STENCIL\",(function(){return ft})),n.d(r,\"DEPTH_STENCIL_ATTACHMENT\",(function(){return lt})),n.d(r,\"DEPTH_TEST\",(function(){return dt})),n.d(r,\"DEPTH_WRITEMASK\",(function(){return mt})),n.d(r,\"DITHER\",(function(){return _t})),n.d(r,\"DONT_CARE\",(function(){return pt})),n.d(r,\"DST_ALPHA\",(function(){return gt})),n.d(r,\"DST_COLOR\",(function(){return vt})),n.d(r,\"DYNAMIC_DRAW\",(function(){return Et})),n.d(r,\"ELEMENT_ARRAY_BUFFER\",(function(){return Tt})),n.d(r,\"ELEMENT_ARRAY_BUFFER_BINDING\",(function(){return Mt})),n.d(r,\"EQUAL\",(function(){return At})),n.d(r,\"FASTEST\",(function(){return Lt})),n.d(r,\"FLOAT\",(function(){return Ot})),n.d(r,\"FLOAT_MAT2\",(function(){return It})),n.d(r,\"FLOAT_MAT3\",(function(){return St})),n.d(r,\"FLOAT_MAT4\",(function(){return Rt})),n.d(r,\"FLOAT_VEC2\",(function(){return yt})),n.d(r,\"FLOAT_VEC3\",(function(){return xt})),n.d(r,\"FLOAT_VEC4\",(function(){return Nt})),n.d(r,\"FRAGMENT_SHADER\",(function(){return bt})),n.d(r,\"FRAMEBUFFER\",(function(){return Ct})),n.d(r,\"FRAMEBUFFER_ATTACHMENT_OBJECT_NAME\",(function(){return Pt})),n.d(r,\"FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE\",(function(){return wt})),n.d(r,\"FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE\",(function(){return Ht})),n.d(r,\"FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL\",(function(){return Dt})),n.d(r,\"FRAMEBUFFER_BINDING\",(function(){return Ft})),n.d(r,\"FRAMEBUFFER_COMPLETE\",(function(){return Ut})),n.d(r,\"FRAMEBUFFER_INCOMPLETE_ATTACHMENT\",(function(){return Gt})),n.d(r,\"FRAMEBUFFER_INCOMPLETE_DIMENSIONS\",(function(){return Bt})),n.d(r,\"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT\",(function(){return Vt})),n.d(r,\"FRAMEBUFFER_UNSUPPORTED\",(function(){return Xt})),n.d(r,\"FRONT\",(function(){return jt})),n.d(r,\"FRONT_AND_BACK\",(function(){return kt})),n.d(r,\"FRONT_FACE\",(function(){return zt})),n.d(r,\"FUNC_ADD\",(function(){return Yt})),n.d(r,\"FUNC_REVERSE_SUBTRACT\",(function(){return Wt})),n.d(r,\"FUNC_SUBTRACT\",(function(){return qt})),n.d(r,\"GENERATE_MIPMAP_HINT\",(function(){return Zt})),n.d(r,\"GEQUAL\",(function(){return Kt})),n.d(r,\"GREATER\",(function(){return Qt})),n.d(r,\"GREEN_BITS\",(function(){return Jt})),n.d(r,\"HIGH_FLOAT\",(function(){return $t})),n.d(r,\"HIGH_INT\",(function(){return te})),n.d(r,\"INCR\",(function(){return ee})),n.d(r,\"INCR_WRAP\",(function(){return ne})),n.d(r,\"INFO_LOG_LENGTH\",(function(){return re})),n.d(r,\"INT\",(function(){return ie})),n.d(r,\"INT_VEC2\",(function(){return ae})),n.d(r,\"INT_VEC3\",(function(){return se})),n.d(r,\"INT_VEC4\",(function(){return oe})),n.d(r,\"INVALID_ENUM\",(function(){return ue})),n.d(r,\"INVALID_FRAMEBUFFER_OPERATION\",(function(){return ce})),n.d(r,\"INVALID_OPERATION\",(function(){return he})),n.d(r,\"INVALID_VALUE\",(function(){return fe})),n.d(r,\"INVERT\",(function(){return le})),n.d(r,\"KEEP\",(function(){return de})),n.d(r,\"LEQUAL\",(function(){return me})),n.d(r,\"LESS\",(function(){return _e})),n.d(r,\"LINEAR\",(function(){return pe})),n.d(r,\"LINEAR_MIPMAP_LINEAR\",(function(){return ge})),n.d(r,\"LINEAR_MIPMAP_NEAREST\",(function(){return ve})),n.d(r,\"LINES\",(function(){return Ee})),n.d(r,\"LINE_LOOP\",(function(){return Te})),n.d(r,\"LINE_STRIP\",(function(){return Me})),n.d(r,\"LINE_WIDTH\",(function(){return Ae})),n.d(r,\"LINK_STATUS\",(function(){return Le})),n.d(r,\"LOW_FLOAT\",(function(){return Oe})),n.d(r,\"LOW_INT\",(function(){return Ie})),n.d(r,\"LUMINANCE\",(function(){return Se})),n.d(r,\"LUMINANCE_ALPHA\",(function(){return Re})),n.d(r,\"MAX_COMBINED_TEXTURE_IMAGE_UNITS\",(function(){return ye})),n.d(r,\"MAX_CUBE_MAP_TEXTURE_SIZE\",(function(){return xe})),n.d(r,\"MAX_FRAGMENT_UNIFORM_VECTORS\",(function(){return Ne})),n.d(r,\"MAX_RENDERBUFFER_SIZE\",(function(){return be})),n.d(r,\"MAX_TEXTURE_IMAGE_UNITS\",(function(){return Ce})),n.d(r,\"MAX_TEXTURE_SIZE\",(function(){return Pe})),n.d(r,\"MAX_VARYING_VECTORS\",(function(){return we})),n.d(r,\"MAX_VERTEX_ATTRIBS\",(function(){return He})),n.d(r,\"MAX_VERTEX_TEXTURE_IMAGE_UNITS\",(function(){return De})),n.d(r,\"MAX_VERTEX_UNIFORM_VECTORS\",(function(){return Fe})),n.d(r,\"MAX_VIEWPORT_DIMS\",(function(){return Ue})),n.d(r,\"MEDIUM_FLOAT\",(function(){return Ge})),n.d(r,\"MEDIUM_INT\",(function(){return Be})),n.d(r,\"MIRRORED_REPEAT\",(function(){return Ve})),n.d(r,\"NEAREST\",(function(){return Xe})),n.d(r,\"NEAREST_MIPMAP_LINEAR\",(function(){return je})),n.d(r,\"NEAREST_MIPMAP_NEAREST\",(function(){return ke})),n.d(r,\"NEVER\",(function(){return ze})),n.d(r,\"NICEST\",(function(){return Ye})),n.d(r,\"NONE\",(function(){return We})),n.d(r,\"NOTEQUAL\",(function(){return qe})),n.d(r,\"NO_ERROR\",(function(){return Ze})),n.d(r,\"NUM_COMPRESSED_TEXTURE_FORMATS\",(function(){return Ke})),n.d(r,\"ONE\",(function(){return Qe})),n.d(r,\"ONE_MINUS_CONSTANT_ALPHA\",(function(){return Je})),n.d(r,\"ONE_MINUS_CONSTANT_COLOR\",(function(){return $e})),n.d(r,\"ONE_MINUS_DST_ALPHA\",(function(){return tn})),n.d(r,\"ONE_MINUS_DST_COLOR\",(function(){return en})),n.d(r,\"ONE_MINUS_SRC_ALPHA\",(function(){return nn})),n.d(r,\"ONE_MINUS_SRC_COLOR\",(function(){return rn})),n.d(r,\"OUT_OF_MEMORY\",(function(){return an})),n.d(r,\"PACK_ALIGNMENT\",(function(){return sn})),n.d(r,\"POINTS\",(function(){return on})),n.d(r,\"POLYGON_OFFSET_FACTOR\",(function(){return un})),n.d(r,\"POLYGON_OFFSET_FILL\",(function(){return cn})),n.d(r,\"POLYGON_OFFSET_UNITS\",(function(){return hn})),n.d(r,\"RED_BITS\",(function(){return fn})),n.d(r,\"RENDERBUFFER\",(function(){return ln})),n.d(r,\"RENDERBUFFER_ALPHA_SIZE\",(function(){return dn})),n.d(r,\"RENDERBUFFER_BINDING\",(function(){return mn})),n.d(r,\"RENDERBUFFER_BLUE_SIZE\",(function(){return _n})),n.d(r,\"RENDERBUFFER_DEPTH_SIZE\",(function(){return pn})),n.d(r,\"RENDERBUFFER_GREEN_SIZE\",(function(){return gn})),n.d(r,\"RENDERBUFFER_HEIGHT\",(function(){return vn})),n.d(r,\"RENDERBUFFER_INTERNAL_FORMAT\",(function(){return En})),n.d(r,\"RENDERBUFFER_RED_SIZE\",(function(){return Tn})),n.d(r,\"RENDERBUFFER_STENCIL_SIZE\",(function(){return Mn})),n.d(r,\"RENDERBUFFER_WIDTH\",(function(){return An})),n.d(r,\"RENDERER\",(function(){return Ln})),n.d(r,\"REPEAT\",(function(){return On})),n.d(r,\"REPLACE\",(function(){return In})),n.d(r,\"RGB\",(function(){return Sn})),n.d(r,\"RGB5_A1\",(function(){return Rn})),n.d(r,\"RGB565\",(function(){return yn})),n.d(r,\"RGBA\",(function(){return xn})),n.d(r,\"RGBA4\",(function(){return Nn})),n.d(r,\"SAMPLER_2D\",(function(){return bn})),n.d(r,\"SAMPLER_CUBE\",(function(){return Cn})),n.d(r,\"SAMPLES\",(function(){return Pn})),n.d(r,\"SAMPLE_ALPHA_TO_COVERAGE\",(function(){return wn})),n.d(r,\"SAMPLE_BUFFERS\",(function(){return Hn})),n.d(r,\"SAMPLE_COVERAGE\",(function(){return Dn})),n.d(r,\"SAMPLE_COVERAGE_INVERT\",(function(){return Fn})),n.d(r,\"SAMPLE_COVERAGE_VALUE\",(function(){return Un})),n.d(r,\"SCISSOR_BOX\",(function(){return Gn})),n.d(r,\"SCISSOR_TEST\",(function(){return Bn})),n.d(r,\"SHADER_COMPILER\",(function(){return Vn})),n.d(r,\"SHADER_SOURCE_LENGTH\",(function(){return Xn})),n.d(r,\"SHADER_TYPE\",(function(){return jn})),n.d(r,\"SHADING_LANGUAGE_VERSION\",(function(){return kn})),n.d(r,\"SHORT\",(function(){return zn})),n.d(r,\"SRC_ALPHA\",(function(){return Yn})),n.d(r,\"SRC_ALPHA_SATURATE\",(function(){return Wn})),n.d(r,\"SRC_COLOR\",(function(){return qn})),n.d(r,\"STATIC_DRAW\",(function(){return Zn})),n.d(r,\"STENCIL_ATTACHMENT\",(function(){return Kn})),n.d(r,\"STENCIL_BACK_FAIL\",(function(){return Qn})),n.d(r,\"STENCIL_BACK_FUNC\",(function(){return Jn})),n.d(r,\"STENCIL_BACK_PASS_DEPTH_FAIL\",(function(){return $n})),n.d(r,\"STENCIL_BACK_PASS_DEPTH_PASS\",(function(){return tr})),n.d(r,\"STENCIL_BACK_REF\",(function(){return er})),n.d(r,\"STENCIL_BACK_VALUE_MASK\",(function(){return nr})),n.d(r,\"STENCIL_BACK_WRITEMASK\",(function(){return rr})),n.d(r,\"STENCIL_BITS\",(function(){return ir})),n.d(r,\"STENCIL_BUFFER_BIT\",(function(){return ar})),n.d(r,\"STENCIL_CLEAR_VALUE\",(function(){return sr})),n.d(r,\"STENCIL_FAIL\",(function(){return or})),n.d(r,\"STENCIL_FUNC\",(function(){return ur})),n.d(r,\"STENCIL_INDEX\",(function(){return cr})),n.d(r,\"STENCIL_INDEX8\",(function(){return hr})),n.d(r,\"STENCIL_PASS_DEPTH_FAIL\",(function(){return fr})),n.d(r,\"STENCIL_PASS_DEPTH_PASS\",(function(){return lr})),n.d(r,\"STENCIL_REF\",(function(){return dr})),n.d(r,\"STENCIL_TEST\",(function(){return mr})),n.d(r,\"STENCIL_VALUE_MASK\",(function(){return _r})),n.d(r,\"STENCIL_WRITEMASK\",(function(){return pr})),n.d(r,\"STREAM_DRAW\",(function(){return gr})),n.d(r,\"SUBPIXEL_BITS\",(function(){return vr})),n.d(r,\"TEXTURE\",(function(){return Er})),n.d(r,\"TEXTURE0\",(function(){return Tr})),n.d(r,\"TEXTURE1\",(function(){return Mr})),n.d(r,\"TEXTURE2\",(function(){return Ar})),n.d(r,\"TEXTURE3\",(function(){return Lr})),n.d(r,\"TEXTURE4\",(function(){return Or})),n.d(r,\"TEXTURE5\",(function(){return Ir})),n.d(r,\"TEXTURE6\",(function(){return Sr})),n.d(r,\"TEXTURE7\",(function(){return Rr})),n.d(r,\"TEXTURE8\",(function(){return yr})),n.d(r,\"TEXTURE9\",(function(){return xr})),n.d(r,\"TEXTURE10\",(function(){return Nr})),n.d(r,\"TEXTURE11\",(function(){return br})),n.d(r,\"TEXTURE12\",(function(){return Cr})),n.d(r,\"TEXTURE13\",(function(){return Pr})),n.d(r,\"TEXTURE14\",(function(){return wr})),n.d(r,\"TEXTURE15\",(function(){return Hr})),n.d(r,\"TEXTURE16\",(function(){return Dr})),n.d(r,\"TEXTURE17\",(function(){return Fr})),n.d(r,\"TEXTURE18\",(function(){return Ur})),n.d(r,\"TEXTURE19\",(function(){return Gr})),n.d(r,\"TEXTURE20\",(function(){return Br})),n.d(r,\"TEXTURE21\",(function(){return Vr})),n.d(r,\"TEXTURE22\",(function(){return Xr})),n.d(r,\"TEXTURE23\",(function(){return jr})),n.d(r,\"TEXTURE24\",(function(){return kr})),n.d(r,\"TEXTURE25\",(function(){return zr})),n.d(r,\"TEXTURE26\",(function(){return Yr})),n.d(r,\"TEXTURE27\",(function(){return Wr})),n.d(r,\"TEXTURE28\",(function(){return qr})),n.d(r,\"TEXTURE29\",(function(){return Zr})),n.d(r,\"TEXTURE30\",(function(){return Kr})),n.d(r,\"TEXTURE31\",(function(){return Qr})),n.d(r,\"TEXTURE_2D\",(function(){return Jr})),n.d(r,\"TEXTURE_BINDING_2D\",(function(){return $r})),n.d(r,\"TEXTURE_BINDING_CUBE_MAP\",(function(){return ti})),n.d(r,\"TEXTURE_CUBE_MAP\",(function(){return ei})),n.d(r,\"TEXTURE_CUBE_MAP_NEGATIVE_X\",(function(){return ni})),n.d(r,\"TEXTURE_CUBE_MAP_NEGATIVE_Y\",(function(){return ri})),n.d(r,\"TEXTURE_CUBE_MAP_NEGATIVE_Z\",(function(){return ii})),n.d(r,\"TEXTURE_CUBE_MAP_POSITIVE_X\",(function(){return ai})),n.d(r,\"TEXTURE_CUBE_MAP_POSITIVE_Y\",(function(){return si})),n.d(r,\"TEXTURE_CUBE_MAP_POSITIVE_Z\",(function(){return oi})),n.d(r,\"TEXTURE_MAG_FILTER\",(function(){return ui})),n.d(r,\"TEXTURE_MIN_FILTER\",(function(){return ci})),n.d(r,\"TEXTURE_WRAP_S\",(function(){return hi})),n.d(r,\"TEXTURE_WRAP_T\",(function(){return fi})),n.d(r,\"TRIANGLES\",(function(){return li})),n.d(r,\"TRIANGLE_FAN\",(function(){return di})),n.d(r,\"TRIANGLE_STRIP\",(function(){return mi})),n.d(r,\"UNPACK_ALIGNMENT\",(function(){return _i})),n.d(r,\"UNPACK_COLORSPACE_CONVERSION_WEBGL\",(function(){return pi})),n.d(r,\"UNPACK_FLIP_Y_WEBGL\",(function(){return gi})),n.d(r,\"UNPACK_PREMULTIPLY_ALPHA_WEBGL\",(function(){return vi})),n.d(r,\"UNSIGNED_BYTE\",(function(){return Ei})),n.d(r,\"UNSIGNED_INT\",(function(){return Ti})),n.d(r,\"UNSIGNED_SHORT\",(function(){return Mi})),n.d(r,\"UNSIGNED_SHORT_4_4_4_4\",(function(){return Ai})),n.d(r,\"UNSIGNED_SHORT_5_5_5_1\",(function(){return Li})),n.d(r,\"UNSIGNED_SHORT_5_6_5\",(function(){return Oi})),n.d(r,\"VALIDATE_STATUS\",(function(){return Ii})),n.d(r,\"VENDOR\",(function(){return Si})),n.d(r,\"VERSION\",(function(){return Ri})),n.d(r,\"VERTEX_ATTRIB_ARRAY_BUFFER_BINDING\",(function(){return yi})),n.d(r,\"VERTEX_ATTRIB_ARRAY_ENABLED\",(function(){return xi})),n.d(r,\"VERTEX_ATTRIB_ARRAY_NORMALIZED\",(function(){return Ni})),n.d(r,\"VERTEX_ATTRIB_ARRAY_POINTER\",(function(){return bi})),n.d(r,\"VERTEX_ATTRIB_ARRAY_SIZE\",(function(){return Ci})),n.d(r,\"VERTEX_ATTRIB_ARRAY_STRIDE\",(function(){return Pi})),n.d(r,\"VERTEX_ATTRIB_ARRAY_TYPE\",(function(){return wi})),n.d(r,\"VERTEX_SHADER\",(function(){return Hi})),n.d(r,\"VIEWPORT\",(function(){return Di})),n.d(r,\"ZERO\",(function(){return Fi}));var i={};n.r(i),n.d(i,\"VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE\",(function(){return Ui})),n.d(i,\"UNMASKED_VENDOR_WEBGL\",(function(){return Gi})),n.d(i,\"UNMASKED_RENDERER_WEBGL\",(function(){return Bi})),n.d(i,\"MAX_TEXTURE_MAX_ANISOTROPY_EXT\",(function(){return Vi})),n.d(i,\"TEXTURE_MAX_ANISOTROPY_EXT\",(function(){return Xi})),n.d(i,\"COMPRESSED_RGB_S3TC_DXT1_EXT\",(function(){return ji})),n.d(i,\"COMPRESSED_RGBA_S3TC_DXT1_EXT\",(function(){return ki})),n.d(i,\"COMPRESSED_RGBA_S3TC_DXT3_EXT\",(function(){return zi})),n.d(i,\"COMPRESSED_RGBA_S3TC_DXT5_EXT\",(function(){return Yi})),n.d(i,\"COMPRESSED_R11_EAC\",(function(){return Wi})),n.d(i,\"COMPRESSED_SIGNED_R11_EAC\",(function(){return qi})),n.d(i,\"COMPRESSED_RG11_EAC\",(function(){return Zi})),n.d(i,\"COMPRESSED_SIGNED_RG11_EAC\",(function(){return Ki})),n.d(i,\"COMPRESSED_RGB8_ETC2\",(function(){return Qi})),n.d(i,\"COMPRESSED_RGBA8_ETC2_EAC\",(function(){return Ji})),n.d(i,\"COMPRESSED_SRGB8_ETC2\",(function(){return $i})),n.d(i,\"COMPRESSED_SRGB8_ALPHA8_ETC2_EAC\",(function(){return ta})),n.d(i,\"COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2\",(function(){return ea})),n.d(i,\"COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2\",(function(){return na})),n.d(i,\"COMPRESSED_RGB_PVRTC_4BPPV1_IMG\",(function(){return ra})),n.d(i,\"COMPRESSED_RGBA_PVRTC_4BPPV1_IMG\",(function(){return ia})),n.d(i,\"COMPRESSED_RGB_PVRTC_2BPPV1_IMG\",(function(){return aa})),n.d(i,\"COMPRESSED_RGBA_PVRTC_2BPPV1_IMG\",(function(){return sa})),n.d(i,\"COMPRESSED_RGB_ETC1_WEBGL\",(function(){return oa})),n.d(i,\"COMPRESSED_RGB_ATC_WEBGL\",(function(){return ua})),n.d(i,\"COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL\",(function(){return ca})),n.d(i,\"COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL\",(function(){return ha})),n.d(i,\"UNSIGNED_INT_24_8_WEBGL\",(function(){return fa})),n.d(i,\"HALF_FLOAT_OES\",(function(){return la})),n.d(i,\"RGBA32F_EXT\",(function(){return da})),n.d(i,\"RGB32F_EXT\",(function(){return ma})),n.d(i,\"FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT\",(function(){return _a})),n.d(i,\"UNSIGNED_NORMALIZED_EXT\",(function(){return pa})),n.d(i,\"MIN_EXT\",(function(){return ga})),n.d(i,\"MAX_EXT\",(function(){return va})),n.d(i,\"SRGB_EXT\",(function(){return Ea})),n.d(i,\"SRGB_ALPHA_EXT\",(function(){return Ta})),n.d(i,\"SRGB8_ALPHA8_EXT\",(function(){return Ma})),n.d(i,\"FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT\",(function(){return Aa})),n.d(i,\"FRAGMENT_SHADER_DERIVATIVE_HINT_OES\",(function(){return La})),n.d(i,\"COLOR_ATTACHMENT0_WEBGL\",(function(){return Oa})),n.d(i,\"COLOR_ATTACHMENT1_WEBGL\",(function(){return Ia})),n.d(i,\"COLOR_ATTACHMENT2_WEBGL\",(function(){return Sa})),n.d(i,\"COLOR_ATTACHMENT3_WEBGL\",(function(){return Ra})),n.d(i,\"COLOR_ATTACHMENT4_WEBGL\",(function(){return ya})),n.d(i,\"COLOR_ATTACHMENT5_WEBGL\",(function(){return xa})),n.d(i,\"COLOR_ATTACHMENT6_WEBGL\",(function(){return Na})),n.d(i,\"COLOR_ATTACHMENT7_WEBGL\",(function(){return ba})),n.d(i,\"COLOR_ATTACHMENT8_WEBGL\",(function(){return Ca})),n.d(i,\"COLOR_ATTACHMENT9_WEBGL\",(function(){return Pa})),n.d(i,\"COLOR_ATTACHMENT10_WEBGL\",(function(){return wa})),n.d(i,\"COLOR_ATTACHMENT11_WEBGL\",(function(){return Ha})),n.d(i,\"COLOR_ATTACHMENT12_WEBGL\",(function(){return Da})),n.d(i,\"COLOR_ATTACHMENT13_WEBGL\",(function(){return Fa})),n.d(i,\"COLOR_ATTACHMENT14_WEBGL\",(function(){return Ua})),n.d(i,\"COLOR_ATTACHMENT15_WEBGL\",(function(){return Ga})),n.d(i,\"DRAW_BUFFER0_WEBGL\",(function(){return Ba})),n.d(i,\"DRAW_BUFFER1_WEBGL\",(function(){return Va})),n.d(i,\"DRAW_BUFFER2_WEBGL\",(function(){return Xa})),n.d(i,\"DRAW_BUFFER3_WEBGL\",(function(){return ja})),n.d(i,\"DRAW_BUFFER4_WEBGL\",(function(){return ka})),n.d(i,\"DRAW_BUFFER5_WEBGL\",(function(){return za})),n.d(i,\"DRAW_BUFFER6_WEBGL\",(function(){return Ya})),n.d(i,\"DRAW_BUFFER7_WEBGL\",(function(){return Wa})),n.d(i,\"DRAW_BUFFER8_WEBGL\",(function(){return qa})),n.d(i,\"DRAW_BUFFER9_WEBGL\",(function(){return Za})),n.d(i,\"DRAW_BUFFER10_WEBGL\",(function(){return Ka})),n.d(i,\"DRAW_BUFFER11_WEBGL\",(function(){return Qa})),n.d(i,\"DRAW_BUFFER12_WEBGL\",(function(){return Ja})),n.d(i,\"DRAW_BUFFER13_WEBGL\",(function(){return $a})),n.d(i,\"DRAW_BUFFER14_WEBGL\",(function(){return ts})),n.d(i,\"DRAW_BUFFER15_WEBGL\",(function(){return es})),n.d(i,\"MAX_COLOR_ATTACHMENTS_WEBGL\",(function(){return ns})),n.d(i,\"MAX_DRAW_BUFFERS_WEBGL\",(function(){return rs})),n.d(i,\"VERTEX_ARRAY_BINDING_OES\",(function(){return is})),n.d(i,\"QUERY_COUNTER_BITS_EXT\",(function(){return as})),n.d(i,\"CURRENT_QUERY_EXT\",(function(){return ss})),n.d(i,\"QUERY_RESULT_EXT\",(function(){return os})),n.d(i,\"QUERY_RESULT_AVAILABLE_EXT\",(function(){return us})),n.d(i,\"TIME_ELAPSED_EXT\",(function(){return cs})),n.d(i,\"TIMESTAMP_EXT\",(function(){return hs})),n.d(i,\"GPU_DISJOINT_EXT\",(function(){return fs}));var a={};n.r(a),n.d(a,\"POSITION\",(function(){return ls})),n.d(a,\"NORMAL\",(function(){return ds})),n.d(a,\"DEPTH\",(function(){return ms})),n.d(a,\"DISTANCE\",(function(){return _s}));var s=35721,o=35722,u=34016,c=35718,h=35719,f=33902,l=33901,d=6406,m=3413,_=519,p=34962,g=34964,v=35717,E=1029,T=3042,M=32773,A=32970,L=32968,O=32777,I=34877,S=32777,R=32971,y=32969,x=3412,N=35670,b=35671,C=35672,P=35673,w=37444,H=34660,D=34661,F=5120,U=2305,G=33071,B=36064,V=16384,X=3106,j=3107,k=35713,z=34467,Y=32771,W=32769,q=37442,Z=2884,K=2885,Q=35725,J=34342,$=2304,tt=7683,et=34056,nt=35712,rt=36096,it=3414,at=256,st=2931,ot=6402,ut=33189,ct=2932,ht=2928,ft=34041,lt=33306,dt=2929,mt=2930,_t=3024,pt=4352,gt=772,vt=774,Et=35048,Tt=34963,Mt=34965,At=514,Lt=4353,Ot=5126,It=35674,St=35675,Rt=35676,yt=35664,xt=35665,Nt=35666,bt=35632,Ct=36160,Pt=36049,wt=36048,Ht=36051,Dt=36050,Ft=36006,Ut=36053,Gt=36054,Bt=36057,Vt=36055,Xt=36061,jt=1028,kt=1032,zt=2886,Yt=32774,Wt=32779,qt=32778,Zt=33170,Kt=518,Qt=516,Jt=3411,$t=36338,te=36341,ee=7682,ne=34055,re=35716,ie=5124,ae=35667,se=35668,oe=35669,ue=1280,ce=1286,he=1282,fe=1281,le=5386,de=7680,me=515,_e=513,pe=9729,ge=9987,ve=9985,Ee=1,Te=2,Me=3,Ae=2849,Le=35714,Oe=36336,Ie=36339,Se=6409,Re=6410,ye=35661,xe=34076,Ne=36349,be=34024,Ce=34930,Pe=3379,we=36348,He=34921,De=35660,Fe=36347,Ue=3386,Ge=36337,Be=36340,Ve=33648,Xe=9728,je=9986,ke=9984,ze=512,Ye=4354,We=0,qe=517,Ze=0,Ke=34466,Qe=1,Je=32772,$e=32770,tn=773,en=775,nn=771,rn=769,an=1285,sn=3333,on=0,un=32824,cn=32823,hn=10752,fn=3410,ln=36161,dn=36179,mn=36007,_n=36178,pn=36180,gn=36177,vn=36163,En=36164,Tn=36176,Mn=36181,An=36162,Ln=7937,On=10497,In=7681,Sn=6407,Rn=32855,yn=36194,xn=6408,Nn=32854,bn=35678,Cn=35680,Pn=32937,wn=32926,Hn=32936,Dn=32928,Fn=32939,Un=32938,Gn=3088,Bn=3089,Vn=36346,Xn=35720,jn=35663,kn=35724,zn=5122,Yn=770,Wn=776,qn=768,Zn=35044,Kn=36128,Qn=34817,Jn=34816,$n=34818,tr=34819,er=36003,nr=36004,rr=36005,ir=3415,ar=1024,sr=2961,or=2964,ur=2962,cr=6401,hr=36168,fr=2965,lr=2966,dr=2967,mr=2960,_r=2963,pr=2968,gr=35040,vr=3408,Er=5890,Tr=33984,Mr=33985,Ar=33986,Lr=33987,Or=33988,Ir=33989,Sr=33990,Rr=33991,yr=33992,xr=33993,Nr=33994,br=33995,Cr=33996,Pr=33997,wr=33998,Hr=33999,Dr=34e3,Fr=34001,Ur=34002,Gr=34003,Br=34004,Vr=34005,Xr=34006,jr=34007,kr=34008,zr=34009,Yr=34010,Wr=34011,qr=34012,Zr=34013,Kr=34014,Qr=34015,Jr=3553,$r=32873,ti=34068,ei=34067,ni=34070,ri=34072,ii=34074,ai=34069,si=34071,oi=34073,ui=10240,ci=10241,hi=10242,fi=10243,li=4,di=6,mi=5,_i=3317,pi=37443,gi=37440,vi=37441,Ei=5121,Ti=5125,Mi=5123,Ai=32819,Li=32820,Oi=33635,Ii=35715,Si=7936,Ri=7938,yi=34975,xi=34338,Ni=34922,bi=34373,Ci=34339,Pi=34340,wi=34341,Hi=35633,Di=2978,Fi=0,Ui=35070,Gi=37445,Bi=37446,Vi=34047,Xi=34046,ji=33776,ki=33777,zi=33778,Yi=33779,Wi=37488,qi=37489,Zi=37490,Ki=37491,Qi=37492,Ji=37493,$i=37494,ta=37495,ea=37496,na=37497,ra=35840,ia=35842,aa=35841,sa=35843,oa=36196,ua=35986,ca=35986,ha=34798,fa=34042,la=36193,da=34836,ma=34837,_a=33297,pa=35863,ga=32775,va=32776,Ea=35904,Ta=35906,Ma=35907,Aa=33296,La=35723,Oa=36064,Ia=36065,Sa=36066,Ra=36067,ya=36068,xa=36069,Na=36070,ba=36071,Ca=36072,Pa=36073,wa=36074,Ha=36075,Da=36076,Fa=36077,Ua=36078,Ga=36079,Ba=34853,Va=34854,Xa=34855,ja=34856,ka=34857,za=34858,Ya=34859,Wa=34860,qa=34861,Za=34862,Ka=34863,Qa=34864,Ja=34865,$a=34866,ts=34867,es=34868,ns=36063,rs=34852,is=34229,as=34916,ss=34917,os=34918,us=34919,cs=35007,hs=36392,fs=36795,ls=\"POSITION\",ds=\"NORMAL\",ms=\"DEPTH\",_s=\"DISTANCE\",ps={webgl:r,webglExtensions:i,Hilo:a};Object.assign(ps,r,i,a);e.a=ps},function(t,e,n){\"use strict\";var r={},i={_cache:r,level:7,LEVEL_NONE:0,LEVEL_LOG:1,LEVEL_WARN:2,LEVEL_ERROR:4,log:function(){var t=this.console;return 1&this.level&&t.log.apply(t,arguments),this},warn:function(){var t=this.console;return 2&this.level&&t.warn.apply(t,arguments),this},error:function(){var t=this.console;return 4&this.level&&t.error.apply(t,arguments),this},logOnce:function(t){return r[\"log_\"+t]||(r[\"log_\"+t]=!0,this.log.apply(this,Array.prototype.slice.call(arguments,1))),this},warnOnce:function(t){return r[\"warn_\"+t]||(r[\"warn_\"+t]=!0,this.warn.apply(this,Array.prototype.slice.call(arguments,1))),this},errorOnce:function(t){return r[\"error_\"+t]||(r[\"error_\"+t]=!0,this.error.apply(this,Array.prototype.slice.call(arguments,1))),this},_console:console,get console(){return this._console},set console(t){this._console=t}};e.a=i},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"each\",(function(){return p})),n.d(e,\"getRelativePath\",(function(){return d})),n.d(e,\"convertUint8ArrayToString\",(function(){return m})),n.d(e,\"getExtension\",(function(){return _})),n.d(e,\"getIndexFromSortedArray\",(function(){return g})),n.d(e,\"insertToSortedArray\",(function(){return v})),n.d(e,\"padLeft\",(function(){return E})),n.d(e,\"getTypedArrayClass\",(function(){return L})),n.d(e,\"copyArrayData\",(function(){return O})),n.d(e,\"isStrOrNumber\",(function(){return I})),n.d(e,\"getTypedArrayGLType\",(function(){return T})),n.d(e,\"getBlobUrl\",(function(){return y})),n.d(e,\"isBlobUrl\",(function(){return S})),n.d(e,\"revokeBlobUrl\",(function(){return R})),n.d(e,\"isArrayLike\",(function(){return x})),n.d(e,\"getElementRect\",(function(){return N})),n.d(e,\"serialRun\",(function(){return b})),n.d(e,\"hasOwnProperty\",(function(){return C}));var r=n(3),i=n(2);function a(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var s,o=i.a.BYTE,u=i.a.UNSIGNED_BYTE,c=i.a.SHORT,h=i.a.UNSIGNED_SHORT,f=i.a.UNSIGNED_INT,l=i.a.FLOAT;function d(t,e){if(/^(?:http|blob|data:|\\/)/.test(e))return e;var n;for(t=t.replace(/\\/[^/]*?$/,\"\").split(\"/\"),e=e.split(\"/\"),n=0;n<e.length;n++){var r=e[n];if(\"..\"===r)t.pop();else if(\".\"!==r)break}return t.join(\"/\")+\"/\"+e.slice(n).join(\"/\")}function m(t,e){if(window.TextDecoder)return s||(s=new TextDecoder(\"utf-8\")),t instanceof Uint8Array||(t=new Uint8Array(t)),s.decode(t);for(var n=\"\",r=0;r<t.length;r++)n+=String.fromCharCode(t[r]);return e&&(n=decodeURIComponent(escape(n))),n}function _(t){var e=String(t).match(/\\/?[^/]+\\.(\\w+)(\\?\\S+)?$/i);return e&&e[1].toLowerCase()||null}function p(t,e){t&&(Array.isArray(t)?t.forEach(e):Object.keys(t).forEach((function(n){e(t[n],n)})))}function g(t,e,n){if(!t||!t.length)return[0,0];for(var r=0,i=t.length-1;r<=i;){var a=r+i>>1,s=n(t[a],e);if(0===s)return[a,a];s<0?r=a+1:i=a-1}return r>i?[i,r]:[r,i]}function v(t,e,n){var r=g(t,e,n);t.splice(r[1],0,e)}function E(t,e,n){return e<=t.length?t:new Array(e-t.length+1).join(n||\"0\")+t}function T(t){return t instanceof Float32Array?l:t instanceof Int8Array?o:t instanceof Uint8Array?u:t instanceof Int16Array?c:t instanceof Uint16Array?h:t instanceof Uint32Array?f:l}var M,A,L=(a(M={},o,Int8Array),a(M,u,Uint8Array),a(M,c,Int16Array),a(M,h,Uint16Array),a(M,f,Uint32Array),a(M,l,Float32Array),A=M,function(t){return A[t]||Float32Array});function O(t,e,n,r,i){if(t&&e){e.isGeometryData&&(e=e.data);for(var a=0;a<i;a++)t[n+a]=e[r+a]}}function I(t){return\"string\"==typeof t||\"number\"==typeof t}function S(t){return/^blob:/.test(t)}function R(t){window.URL&&URL.revokeObjectURL(t)}function y(t,e){if(e instanceof ArrayBuffer&&(e=new Uint8Array(e)),window.Blob&&window.URL)try{var n=new Blob([e],{type:t});return window.URL.createObjectURL(n)}catch(e){r.a.warn(\"new Blob error\",t)}return\"data:\".concat(t,\";base64,\").concat(btoa(m(e)))}function x(t){return Array.isArray(t)||t.BYTES_PER_ELEMENT||t.length}function N(t){var e,n=document.documentElement;try{e=t.getBoundingClientRect()}catch(n){e={top:t.offsetTop,left:t.offsetLeft,right:t.offsetLeft+t.offsetWidth,bottom:t.offsetTop+t.offsetHeight}}var r=(window.pageXOffset||n.scrollLeft)-(n.clientLeft||0)||0,i=(window.pageYOffset||n.scrollTop)-(n.clientTop||0)||0,a=window.getComputedStyle?getComputedStyle(t):t.currentStyle,s=parseInt,o=s(a.paddingLeft)+s(a.borderLeftWidth)||0,u=s(a.paddingTop)+s(a.borderTopWidth)||0,c=s(a.paddingRight)+s(a.borderRightWidth)||0,h=s(a.paddingBottom)+s(a.borderBottomWidth)||0,f=e.top||0,l=e.left||0;return{left:l+r+o,top:f+i+u,width:(e.right||0)-c-l-o,height:(e.bottom||0)-h-f-u}}function b(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=arguments.length>1?arguments[1]:void 0;return Array.isArray(t)||(t=Object.values(t)),t.reduce((function(t,n,r){return t.then((function(){return e(n,r)}))}),Promise.resolve())}function C(t,e){return Object.prototype.hasOwnProperty.call(t,e)}},function(t,e,n){\"use strict\";var r=n(0),i=n(1).a.create({className:\"Vector3\",isVector3:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=r.vec3.fromValues(t,e,n)},copy:function(t){return r.vec3.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],this},set:function(t,e,n){return r.vec3.set(this.elements,t,e,n),this},add:function(t,e){return e||(e=t,t=this),r.vec3.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),r.vec3.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),r.vec3.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),r.vec3.divide(this.elements,t.elements,e.elements),this},ceil:function(){return r.vec3.ceil(this.elements,this.elements),this},floor:function(){return r.vec3.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),r.vec3.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),r.vec3.max(this.elements,t.elements,e.elements),this},round:function(){return r.vec3.round(this.elements,this.elements),this},scale:function(t){return r.vec3.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),r.vec3.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),r.vec3.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),r.vec3.squaredDistance(t.elements,e.elements)},length:function(){return r.vec3.length(this.elements)},squaredLength:function(){return r.vec3.squaredLength(this.elements)},negate:function(){return r.vec3.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),r.vec3.inverse(this.elements,t.elements),this},normalize:function(){return r.vec3.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),r.vec3.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),r.vec3.cross(this.elements,t.elements,e.elements),this},lerp:function(t,e){return r.vec3.lerp(this.elements,this.elements,t.elements,e),this},hermite:function(t,e,n,i,a){return r.vec3.hermite(this.elements,t.elements,e.elements,n.elements,i.elements,a),this},bezier:function(t,e,n,i,a){return r.vec3.bezier(this.elements,t.elements,e.elements,n.elements,i.elements,a),this},random:function(t){return r.vec3.random(this.elements,t),this},transformMat3:function(t){return r.vec3.transformMat3(this.elements,this.elements,t.elements),this},transformMat4:function(t){return r.vec3.transformMat4(this.elements,this.elements,t.elements),this},transformDirection:function(t){var e=this.elements,n=t.elements,r=e[0],i=e[1],a=e[2];return e[0]=r*n[0]+i*n[4]+a*n[8],e[1]=r*n[1]+i*n[5]+a*n[9],e[2]=r*n[2]+i*n[6]+a*n[10],this},transformQuat:function(t){return r.vec3.transformQuat(this.elements,this.elements,t.elements),this},rotateX:function(t,e){return r.vec3.rotateX(this.elements,this.elements,t.elements,e),this},rotateY:function(t,e){return r.vec3.rotateY(this.elements,this.elements,t.elements,e),this},rotateZ:function(t,e){return r.vec3.rotateZ(this.elements,this.elements,t.elements,e),this},exactEquals:function(t,e){return e||(e=t,t=this),r.vec3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),r.vec3.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.sqrDist=i.prototype.squaredDistance,i.prototype.len=i.prototype.length,i.prototype.sqrLen=i.prototype.squaredLength,e.a=i},function(t,e,n){\"use strict\";var r,i={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:(r=0,function(t){var e=++r;return t?e=t+\"_\"+e:e+=\"\",e}),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},degToRad:function(t){return t*this.DEG2RAD},radToDeg:function(t){return t*this.RAD2DEG},isPowerOfTwo:function(t){return 0==(t&t-1)&&0!==t},nearestPowerOfTwo:function(t){return Math.pow(2,Math.round(Math.log(t)/Math.LN2))},nextPowerOfTwo:function(t){return t--,t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,t|=t>>16,++t}};e.a=i},function(t,e,n){\"use strict\";var r,i=n(0),a=n(1),s=n(5),o=n(10),u=new s.a,c=new s.a,h=a.a.create({className:\"Matrix4\",isMatrix4:!0,constructor:function(){this.elements=i.mat4.create()},copy:function(t){return i.mat4.copy(this.elements,t.elements),this},clone:function(){var t=new this.constructor;return i.mat4.copy(t.elements,this.elements),t},toArray:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)t[e+r]=n[r];return t},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)n[r]=t[e+r];return this},set:function(t,e,n,r,a,s,o,u,c,h,f,l,d,m,_,p){return i.mat4.set(this.elements,t,e,n,r,a,s,o,u,c,h,f,l,d,m,_,p),this},identity:function(){return i.mat4.identity(this.elements),this},transpose:function(){return i.mat4.transpose(this.elements,this.elements),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return i.mat4.invert(this.elements,t.elements),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return i.mat4.adjoint(this.elements,t.elements),this},determinant:function(){return i.mat4.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),i.mat4.multiply(this.elements,t.elements,e.elements),this},premultiply:function(t){return this.multiply(t,this),this},translate:function(t){return i.mat4.translate(this.elements,this.elements,t.elements),this},scale:function(t){return i.mat4.scale(this.elements,this.elements,t.elements),this},rotate:function(t,e){return i.mat4.rotate(this.elements,this.elements,t,e.elements),this},rotateX:function(t){return i.mat4.rotateX(this.elements,this.elements,t),this},rotateY:function(t){return i.mat4.rotateY(this.elements,this.elements,t),this},rotateZ:function(t){return i.mat4.rotateZ(this.elements,this.elements,t),this},fromTranslation:function(t){return i.mat4.fromTranslation(this.elements,t.elements),this},fromScaling:function(t){return i.mat4.fromScaling(this.elements,t.elements),this},fromRotation:function(t,e){return i.mat4.fromRotation(this.elements,t,e.elements),this},fromXRotation:function(t){return i.mat4.fromXRotation(this.elements,t),this},fromYRotation:function(t){return i.mat4.fromYRotation(this.elements,t),this},fromZRotation:function(t){return i.mat4.fromZRotation(this.elements,t),this},fromRotationTranslation:function(t,e){return i.mat4.fromRotationTranslation(this.elements,t.elements,e.elements),this},getTranslation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.a;return i.mat4.getTranslation(t.elements,this.elements),t},getScaling:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new s.a;return i.mat4.getScaling(t.elements,this.elements),t},getRotation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.a;return i.mat4.getRotation(t.elements,this.elements),t},fromRotationTranslationScale:function(t,e,n){return i.mat4.fromRotationTranslationScale(this.elements,t.elements,e.elements,n.elements),this},fromRotationTranslationScaleOrigin:function(t,e,n,r){return i.mat4.fromRotationTranslationScaleOrigin(this.elements,t.elements,e.elements,n.elements,r.elements),this},fromQuat:function(t){return i.mat4.fromQuat(this.elements,t.elements),this},frustum:function(t,e,n,r,a,s){return i.mat4.frustum(this.elements,t,e,n,r,a,s),this},perspective:function(t,e,n,r){return i.mat4.perspective(this.elements,t,e,n,r),this},perspectiveFromFieldOfView:function(t,e,n){return i.mat4.perspectiveFromFieldOfView(this.elements,t,e,n),this},ortho:function(t,e,n,r,a,s){return i.mat4.ortho(this.elements,t,e,n,r,a,s),this},lookAt:function(t,e,n){return t.isVector3||(t=u.set(t.x,t.y,t.z)),e.isVector3||(e=c.set(e.x,e.y,e.z)),i.mat4.lookAt(this.elements,t.elements,e.elements,n.elements),this},targetTo:function(t,e,n){t.isVector3||(t=u.set(t.x,t.y,t.z)),e.isVector3||(e=c.set(e.x,e.y,e.z)),t=t.elements,e=e.elements,n=n.elements;var r=this.elements,i=t[0],a=t[1],s=t[2],o=n[0],h=n[1],f=n[2],l=i-e[0],d=a-e[1],m=s-e[2],_=l*l+d*d+m*m;_>0?(l*=_=1/Math.sqrt(_),d*=_,m*=_):m=1;var p=h*m-f*d,g=f*l-o*m,v=o*d-h*l;return(_=p*p+g*g+v*v)>0?(p*=_=1/Math.sqrt(_),g*=_,v*=_):(_=(p=h*m-f*d)*p+(g=f*l-(o+=1e-7)*m)*g+(v=o*d-h*l)*v,p*=_=1/Math.sqrt(_),g*=_,v*=_),r[0]=p,r[1]=g,r[2]=v,r[3]=0,r[4]=d*v-m*g,r[5]=m*p-l*v,r[6]=l*g-d*p,r[7]=0,r[8]=l,r[9]=d,r[10]=m,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,this},frob:function(){return i.mat4.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),i.mat4.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),i.mat4.subtract(this.elements,t.elements,e.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),i.mat4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),i.mat4.equals(t.elements,e.elements)},compose:function(t,e,n,r){return r?this.fromRotationTranslationScaleOrigin(t,e,n,r):this.fromRotationTranslationScale(t,e,n),this},decompose:function(t,e,n,i){return this.getScaling(n),this.getTranslation(e),r||(r=new h),this.determinant()<0&&(n.x*=-1),r.copy(this),u.inverse(n),r.scale(u),t.fromMat4(r),i&&i.set(0,0,0),this}});h.prototype.sub=h.prototype.subtract,h.prototype.mul=h.prototype.multiply,e.a=h},function(t,e,n){\"use strict\";var r=n(1),i=n(12),a=n(4),s=r.a.create({Extends:i.a,className:\"Color\",isColor:!0,r:{get:function(){return this.x},set:function(t){this.x=t}},g:{get:function(){return this.y},set:function(t){this.y=t}},b:{get:function(){return this.z},set:function(t){this.z=t}},a:{get:function(){return this.w},set:function(t){this.w=t}},constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;s.superclass.constructor.call(this,t,e,n,r)},toRGBArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t},fromUintArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.elements[0]=t[e]/255,this.elements[1]=t[e+1]/255,this.elements[2]=t[e+2]/255,this.elements[3]=t[e+3]/255,this},fromHEX:function(t){return\"number\"==typeof t?t=Object(a.padLeft)(t.toString(16),6):(\"#\"===t[0]&&(t=t.slice(1)),3===t.length&&(t=t.replace(/(\\w)/g,\"$1$1\"))),this.elements[0]=parseInt(t.slice(0,2),16)/255,this.elements[1]=parseInt(t.slice(2,4),16)/255,this.elements[2]=parseInt(t.slice(4,6),16)/255,this},toHEX:function(){for(var t=\"\",e=0;e<3;e++)t+=Object(a.padLeft)(Math.floor(255*this.elements[e]).toString(16),2);return t}});e.a=s},function(t,e,n){\"use strict\";var r=n(34),i=n.n(r);e.a=i.a},function(t,e,n){\"use strict\";var r=n(0),i=n(11),a=n(1),s=n(9),o=new i.a,u=a.a.create({Mixes:s.a,className:\"Quaternion\",isQuaternion:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;this.elements=r.quat.fromValues(t,e,n,i)},copy:function(t,e){return r.quat.copy(this.elements,t.elements),e||this.fire(\"update\"),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2],t[3])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2?arguments[2]:void 0,r=this.elements;return r[0]=t[e],r[1]=t[e+1],r[2]=t[e+2],r[3]=t[e+3],n||this.fire(\"update\"),this},set:function(t,e,n,i,a){return r.quat.set(this.elements,t,e,n,i),a||this.fire(\"update\"),this},identity:function(t){return r.quat.identity(this.elements),t||this.fire(\"update\"),this},rotationTo:function(t,e,n){return r.quat.rotationTo(this.elements,t.elements,e.elements),n||this.fire(\"update\"),this},setAxes:function(t,e,n,i){return r.quat.setAxes(this.elements,t.elements,e.elements,n.elements),i||this.fire(\"update\"),this},setAxisAngle:function(t,e,n){return r.quat.setAxisAngle(this.elements,t.elements,e),n||this.fire(\"update\"),this},getAxisAngle:function(t){return r.quat.getAxisAngle(t.elements,this.elements)},add:function(t,e){return r.quat.add(this.elements,this.elements,t.elements),e||this.fire(\"update\"),this},multiply:function(t,e){return r.quat.multiply(this.elements,this.elements,t.elements),e||this.fire(\"update\"),this},premultiply:function(t,e){return r.quat.multiply(this.elements,t.elements,this.elements),e||this.fire(\"update\"),this},scale:function(t,e){return r.quat.scale(this.elements,this.elements,t),e||this.fire(\"update\"),this},rotateX:function(t,e){return r.quat.rotateX(this.elements,this.elements,t),e||this.fire(\"update\"),this},rotateY:function(t,e){return r.quat.rotateY(this.elements,this.elements,t),e||this.fire(\"update\"),this},rotateZ:function(t,e){return r.quat.rotateZ(this.elements,this.elements,t),e||this.fire(\"update\"),this},calculateW:function(t){return r.quat.calculateW(this.elements,this.elements),t||this.fire(\"update\"),this},dot:function(t){return r.quat.dot(this.elements,t.elements)},lerp:function(t,e,n){return r.quat.lerp(this.elements,this.elements,t.elements,e),n||this.fire(\"update\"),this},slerp:function(t,e,n){return r.quat.slerp(this.elements,this.elements,t.elements,e),n||this.fire(\"update\"),this},sqlerp:function(t,e,n,i,a,s){return r.quat.sqlerp(this.elements,t.elements,e.elements,n.elements,i.elements,a),s||this.fire(\"update\"),this},invert:function(t){return r.quat.invert(this.elements,this.elements),t||this.fire(\"update\"),this},conjugate:function(t){return r.quat.conjugate(this.elements,this.elements),t||this.fire(\"update\"),this},length:function(){return r.quat.length(this.elements)},squaredLength:function(){return r.quat.squaredLength(this.elements)},normalize:function(t){return r.quat.normalize(this.elements,this.elements),t||this.fire(\"update\"),this},fromMat3:function(t,e){return r.quat.fromMat3(this.elements,t.elements),e||this.fire(\"update\"),this},fromMat4:function(t,e){return o.fromMat4(t),this.fromMat3(o,e),this},exactEquals:function(t){return r.quat.exactEquals(this.elements,t.elements)},equals:function(t){return r.quat.equals(this.elements,t.elements)},fromEuler:function(t,e){var n=.5*t.x,r=.5*t.y,i=.5*t.z,a=t.order||\"ZYX\",s=Math.sin(n),o=Math.cos(n),u=Math.sin(r),c=Math.cos(r),h=Math.sin(i),f=Math.cos(i),l=this.elements;return\"XYZ\"===a?(l[0]=s*c*f+o*u*h,l[1]=o*u*f-s*c*h,l[2]=o*c*h+s*u*f,l[3]=o*c*f-s*u*h):\"YXZ\"===a?(l[0]=s*c*f+o*u*h,l[1]=o*u*f-s*c*h,l[2]=o*c*h-s*u*f,l[3]=o*c*f+s*u*h):\"ZXY\"===a?(l[0]=s*c*f-o*u*h,l[1]=o*u*f+s*c*h,l[2]=o*c*h+s*u*f,l[3]=o*c*f-s*u*h):\"ZYX\"===a?(l[0]=s*c*f-o*u*h,l[1]=o*u*f+s*c*h,l[2]=o*c*h-s*u*f,l[3]=o*c*f+s*u*h):\"YZX\"===a?(l[0]=s*c*f+o*u*h,l[1]=o*u*f+s*c*h,l[2]=o*c*h-s*u*f,l[3]=o*c*f-s*u*h):\"XZY\"===a&&(l[0]=s*c*f-o*u*h,l[1]=o*u*f-s*c*h,l[2]=o*c*h+s*u*f,l[3]=o*c*f+s*u*h),e||this.fire(\"update\"),this},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.fire(\"update\")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.fire(\"update\")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.fire(\"update\")}},w:{get:function(){return this.elements[3]},set:function(t){this.elements[3]=t,this.fire(\"update\")}}});u.prototype.mul=u.prototype.multiply,u.prototype.len=u.prototype.length,u.prototype.sqrLen=u.prototype.squaredLength,e.a=u},function(t,e,n){\"use strict\";var r=n(0),i=n(1).a.create({className:\"Matrix3\",isMatrix3:!0,constructor:function(){this.elements=r.mat3.create()},copy:function(t){return r.mat3.copy(this.elements,t.elements),this},clone:function(){var t=new this.constructor;return r.mat3.copy(t.elements,this.elements),t},toArray:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<9;r++)t[e+r]=n[r];return t},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<9;r++)n[r]=t[e+r];return this},set:function(t,e,n,i,a,s,o,u,c){return r.mat3.set(this.elements,t,e,n,i,a,s,o,u,c),this},identity:function(){return r.mat3.identity(this.elements),this},transpose:function(){return r.mat3.transpose(this.elements,this.elements),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return r.mat3.invert(this.elements,t.elements),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return r.mat3.adjoint(this.elements,t.elements),this},determinant:function(){return r.mat3.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),r.mat3.multiply(this.elements,t.elements,e.elements),this},premultiply:function(t){return this.multiply(t,this),this},translate:function(t){return r.mat3.translate(this.elements,this.elements,t.elements),this},rotate:function(t){return r.mat3.rotate(this.elements,this.elements,t),this},scale:function(t){return r.mat3.scale(this.elements,this.elements,t.elements),this},fromTranslation:function(t){return r.mat3.fromTranslation(this.elements,t.elements),this},fromRotation:function(t){return r.mat3.fromRotation(this.elements,t),this},fromScaling:function(t){return r.mat3.fromScaling(this.elements,t.elements),this},fromQuat:function(t){return r.mat3.fromQuat(this.elements,t.elements),this},normalFromMat4:function(t){return r.mat3.normalFromMat4(this.elements,t.elements),this},fromMat4:function(t){return r.mat3.fromMat4(this.elements,t.elements),this},frob:function(){return r.mat3.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),r.mat3.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),r.mat3.subtract(this.elements,t.elements,e.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),r.mat3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),r.mat3.equals(t.elements,e.elements)},fromRotationTranslationScale:function(t,e,n,r,i){var a=Math.cos(t),s=Math.sin(t);return this.set(r*a,-i*s,0,r*s,i*a,0,e,n,1),this}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,e.a=i},function(t,e,n){\"use strict\";var r=n(0),i=n(1).a.create({className:\"Vector4\",isVector4:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0;this.elements=r.vec4.fromValues(t,e,n,i)},copy:function(t){return r.vec4.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2],t[3])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t[3+e]=n[3],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],n[3]=t[e+3],this},set:function(t,e,n,i){return r.vec4.set(this.elements,t,e,n,i),this},add:function(t,e){return e||(e=t,t=this),r.vec4.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),r.vec4.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),r.vec4.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),r.vec4.divide(this.elements,t.elements,e.elements),this},ceil:function(){return r.vec4.ceil(this.elements,this.elements),this},floor:function(){return r.vec4.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),r.vec4.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),r.vec4.max(this.elements,t.elements,e.elements),this},round:function(){return r.vec4.round(this.elements,this.elements),this},scale:function(t){return r.vec4.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),r.vec4.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),r.vec4.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),r.vec4.squaredDistance(t.elements,e.elements)},length:function(){return r.vec4.length(this.elements)},squaredLength:function(){return r.vec4.squaredLength(this.elements)},negate:function(){return r.vec4.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),r.vec4.inverse(this.elements,t.elements),this},normalize:function(){return r.vec4.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),r.vec4.dot(t.elements,e.elements)},lerp:function(t,e){return r.vec4.lerp(this.elements,this.elements,t.elements,e),this},random:function(t){return t=t||1,this.elements[0]=Math.random(),this.elements[1]=Math.random(),this.elements[2]=Math.random(),this.elements[3]=Math.random(),this.normalize(),this.scale(t),this},transformMat4:function(t){return r.vec4.transformMat4(this.elements,this.elements,t.elements),this},transformQuat:function(t){return r.vec4.transformQuat(this.elements,this.elements,t.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),r.vec4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),r.vec4.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t}},w:{get:function(){return this.elements[3]},set:function(t){this.elements[3]=t}}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.sqrDist=i.prototype.squaredDistance,i.prototype.len=i.prototype.length,i.prototype.sqrLen=i.prototype.squaredLength,e.a=i},function(t,e,n){\"use strict\";var r=n(1),i=n(6),a=n(7),s=n(3),o=new a.a,u=i.a.DEG2RAD,c=i.a.RAD2DEG,h=r.a.create({className:\"Euler\",isEuler:!0,order:\"ZYX\",constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=new Float32Array([t,e,n]),this.updateDegrees()},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){return this.elements[0]=t.x,this.elements[1]=t.y,this.elements[2]=t.z,this.order=t.order,this.updateDegrees(),this},set:function(t,e,n){return this.elements[0]=t,this.elements[1]=e,this.elements[2]=n,this.updateDegrees(),this},setDegree:function(t,e,n){return this._degX=t,this._degY=e,this._degZ=n,this.updateRadians(),this},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return this.elements[0]=t[e],this.elements[1]=t[e+1],this.elements[2]=t[e+2],this.updateDegrees(),this},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t[e]=this.elements[0],t[e+1]=this.elements[1],t[e+2]=this.elements[2],t},fromMat4:function(t,e){var n=t.elements,r=n[0],a=n[1],o=n[2],u=n[4],c=n[5],h=n[6],f=n[8],l=n[9],d=n[10];e=e||this.order,this.order=e;var m=i.a.clamp;return\"XYZ\"===e?(this.elements[1]=Math.asin(m(f,-1,1)),Math.abs(f)<.99999?(this.elements[0]=Math.atan2(-l,d),this.elements[2]=Math.atan2(-u,r)):(this.elements[0]=Math.atan2(h,c),this.elements[2]=0)):\"YXZ\"===e?(this.elements[0]=Math.asin(-m(l,-1,1)),Math.abs(l)<.99999?(this.elements[1]=Math.atan2(f,d),this.elements[2]=Math.atan2(a,c)):(this.elements[1]=Math.atan2(-o,r),this.elements[2]=0)):\"ZXY\"===e?(this.elements[0]=Math.asin(m(h,-1,1)),Math.abs(h)<.99999?(this.elements[1]=Math.atan2(-o,d),this.elements[2]=Math.atan2(-u,c)):(this.elements[1]=0,this.elements[2]=Math.atan2(a,r))):\"ZYX\"===e?(this.elements[1]=Math.asin(-m(o,-1,1)),Math.abs(o)<.99999?(this.elements[0]=Math.atan2(h,d),this.elements[2]=Math.atan2(a,r)):(this.elements[0]=0,this.elements[2]=Math.atan2(-u,c))):\"YZX\"===e?(this.elements[2]=Math.asin(m(a,-1,1)),Math.abs(a)<.99999?(this.elements[0]=Math.atan2(-l,c),this.elements[1]=Math.atan2(-o,r)):(this.elements[0]=0,this.elements[1]=Math.atan2(f,d))):\"XZY\"===e?(this.elements[2]=Math.asin(-m(u,-1,1)),Math.abs(u)<.99999?(this.elements[0]=Math.atan2(h,c),this.elements[1]=Math.atan2(f,r)):(this.elements[0]=Math.atan2(-l,d),this.elements[1]=0)):s.a.warn(\"Euler fromMat4() unsupported order: \"+e),this.updateDegrees(),this},fromQuat:function(t,e){return o.fromQuat(t),this.fromMat4(o,e)},updateDegrees:function(){return this._degX=this.elements[0]*c,this._degY=this.elements[1]*c,this._degZ=this.elements[2]*c,this},updateRadians:function(){return this.elements[0]=this._degX*u,this.elements[1]=this._degY*u,this.elements[2]=this._degZ*u,this},degX:{get:function(){return this._degX},set:function(t){this._degX=t,this.elements[0]=t*u}},degY:{get:function(){return this._degY},set:function(t){this._degY=t,this.elements[1]=t*u}},degZ:{get:function(){return this._degZ},set:function(t){this._degZ=t,this.elements[2]=t*u}},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this._degX=t*c}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this._degY=t*c}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this._degZ=t*c}}});e.a=h},function(t,e,n){\"use strict\";var r=n(0),i=n(1).a.create({className:\"Vector2\",isVector2:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.elements=r.vec2.fromValues(t,e)},copy:function(t){return r.vec2.copy(this.elements,t.elements),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],this},set:function(t,e){return r.vec2.set(this.elements,t,e),this},add:function(t,e){return e||(e=t,t=this),r.vec2.add(this.elements,t.elements,e.elements),this},subtract:function(t,e){return e||(e=t,t=this),r.vec2.subtract(this.elements,t.elements,e.elements),this},multiply:function(t,e){return e||(e=t,t=this),r.vec2.multiply(this.elements,t.elements,e.elements),this},divide:function(t,e){return e||(e=t,t=this),r.vec2.divide(this.elements,t.elements,e.elements),this},ceil:function(){return r.vec2.ceil(this.elements,this.elements),this},floor:function(){return r.vec2.floor(this.elements,this.elements),this},min:function(t,e){return e||(e=t,t=this),r.vec2.min(this.elements,t.elements,e.elements),this},max:function(t,e){return e||(e=t,t=this),r.vec2.max(this.elements,t.elements,e.elements),this},round:function(){return r.vec2.round(this.elements,this.elements),this},scale:function(t){return r.vec2.scale(this.elements,this.elements,t),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),r.vec2.scaleAndAdd(this.elements,e.elements,n.elements,t),this},distance:function(t,e){return e||(e=t,t=this),r.vec2.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),r.vec2.squaredDistance(t.elements,e.elements)},length:function(){return r.vec2.length(this.elements)},squaredLength:function(){return r.vec2.squaredLength(this.elements)},negate:function(){return r.vec2.negate(this.elements,this.elements),this},inverse:function(t){return t||(t=this),r.vec2.inverse(this.elements,t.elements),this},normalize:function(){return r.vec2.normalize(this.elements,this.elements),this},dot:function(t,e){return e||(e=t,t=this),r.vec2.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),r.vec2.cross(this.elements,t.elements,e.elements),this},lerp:function(t,e){return r.vec2.lerp(this.elements,this.elements,t.elements,e),this},random:function(t){return r.vec2.random(this.elements,t),this},transformMat3:function(t){return r.vec2.transformMat3(this.elements,this.elements,t.elements),this},transformMat4:function(t){return r.vec2.transformMat4(this.elements,this.elements,t.elements),this},exactEquals:function(t,e){return e||(e=t,t=this),r.vec2.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),r.vec2.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t}}});i.prototype.sub=i.prototype.subtract,i.prototype.mul=i.prototype.multiply,i.prototype.div=i.prototype.divide,i.prototype.dist=i.prototype.distance,i.prototype.sqrDist=i.prototype.squaredDistance,i.prototype.len=i.prototype.length,i.prototype.sqrLen=i.prototype.squaredLength,e.a=i},function(t,e){t.exports=function(t){var e={};function n(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,n),i.l=!0,i.exports}return n.m=t,n.c=e,n.d=function(t,e,r){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},n.r=function(t){\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(t,\"__esModule\",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&\"object\"==typeof t&&t&&t.__esModule)return t;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,\"default\",{enumerable:!0,value:t}),2&e&&\"string\"!=typeof t)for(var i in t)n.d(r,i,function(e){return t[e]}.bind(null,i));return r},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,\"a\",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p=\"\",n(n.s=2)}([function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function i(t,e,n){return e&&r(t.prototype,e),n&&r(t,n),t}var a=n(1),s={POSITION:\"POSITION\",NORMAL:\"NORMAL\",COLOR:\"COLOR\",COLOR_0:\"COLOR\",COLOR_1:\"COLOR_1\",TEXCOORD:\"TEXCOORD\",TEXCOORD_0:\"TEXCOORD\",TEXCOORD_1:\"TEXCOORD_1\",TEXCOORD_2:\"TEXCOORD_2\",TANGENT:\"TANGENT\",JOINT:\"JOINT\",JOINTS_0:\"JOINT\",WEIGHT:\"WEIGHT\",WEIGHTS_0:\"WEIGHT\"},o=[\"POSITION\",\"NORMAL\",\"COLOR\",\"TEXCOORD\",\"TANGENT\",\"JOINT\",\"WEIGHT\",\"OTHER\",\"TEXCOORD_1\",\"TEXCOORD_2\",\"COLOR_1\"],u={POSITION:0,NORMAL:1,COLOR:2,TEXCOORD:3,TANGENT:4,JOINT:5,WEIGHT:6,OTHER:7,TEXCOORD_1:8,TEXCOORD_2:9,COLOR_1:10},c={POSITION:\"vertices\",NORMAL:\"normals\",COLOR:\"colors\",TEXCOORD:\"uvs\",TEXCOORD_1:\"uvs1\",TEXCOORD_2:\"uvs2\",TANGENT:\"tangents\",JOINT:\"skinIndices\",WEIGHT:\"skinWeights\"},h={vertices:\"POSITION\",_normals:\"NORMAL\",colors:\"COLOR\",uvs:\"TEXCOORD\",uvs1:\"TEXCOORD_1\",uvs2:\"TEXCOORD_2\",_tangents:\"TANGENT\",skinIndices:\"JOINT\",skinWeights:\"WEIGHT\"},f={POSITION:3,NORMAL:3,COLOR:3,COLOR_1:3,TEXCOORD:2,TEXCOORD_1:2,TEXCOORD_2:2,TANGENT:4,JOINT:4,WEIGHT:4},l=function(){function t(e){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4;!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.indices=e,this.mode=n,this.attrs=[],this.attrIndexMap={}}return i(t,null,[{key:\"cp\",value:function(t){return t}},{key:\"minus\",value:function(t,e){return t-e}},{key:\"plus\",value:function(t,e){return t+e}},{key:\"pp\",value:function(t,e,n,r){return r-e-n+t}},{key:\"depp\",value:function(t,e,n,r){return e+n-t+r}},{key:\"ATTR\",get:function(){return s}},{key:\"ATTR_NAME_ID\",get:function(){return u}}]),i(t,[{key:\"getAttrLength\",value:function(){return this.attrs[0].data.length/this.attrs[0].itemCount}},{key:\"attrIdToName\",value:function(t){return o[t]||\"OTHER\"}},{key:\"addAttr\",value:function(t,e,n){s[t]?(this.attrIndexMap[t]=this.attrs.length,n||(n=f[t])):n||(n=1),this.attrs.push({name:t,itemCount:n,data:e})}},{key:\"getAttr\",value:function(t){if(this.attrIndexMap[t])return this.attrs[this.attrIndexMap[t]];for(var e=this.attrs.length-1;e>=0;e--){var n=this.attrs[e];if(n.name===t)return n}}},{key:\"cal\",value:function(t,e,n){for(var r=arguments.length,i=new Array(r>3?r-3:0),a=3;a<r;a++)i[a-3]=arguments[a];this.attrs.forEach((function(r,a){for(var s=r.data,o=t.attrs[a].data,u=e*r.itemCount,c=r.itemCount-1;c>=0;c--)o[u+c]=n.apply(null,i.map((function(t){return s[t*r.itemCount+c]})))}))}},{key:\"quantize\",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this.attrs.forEach((function(e){if(\"JOINT\"!==e.name&&0!=t[e.name]){var n=a.encode(e.data,t[e.name]||12);e.quantizationBit=n.quantizationBit,e.min=n.min,e.max=n.max,e.data=n.data}}))}},{key:\"dequantize\",value:function(){this.attrs.forEach((function(t){t.quantizationBit&&(t.data=a.decode(t.data,t.quantizationBit,t.min,t.max))}))}},{key:\"convertTypedArray\",value:function(){!this.indices||this.indices instanceof Array||(this.indices=Array.from(this.indices)),this.attrs.forEach((function(t){t.data instanceof Array||t.data instanceof Float32Array||(t.data=Array.from(t.data))}))}},{key:\"clearEBAttrs\",value:function(){delete this.clers,delete this.holes,delete this.handles}},{key:\"convertToTypedArray\",value:function(){this.indices instanceof Array&&(this.getAttrLength()>65535?this.indices=new Uint32Array(this.indices):this.indices=new Uint16Array(this.indices)),this.attrs.forEach((function(t){t.data instanceof Array&&(t.data=new Float32Array(t.data))}))}},{key:\"prepareToWorkerSend\",value:function(){return this.clearEBAttrs(),this.convertToTypedArray(),this.getAllBuffers()}},{key:\"clone\",value:function(){var e=new t(Array.from(this.indices),this.mode);return Object.assign(e.attrIndexMap,this.attrIndexMap),e.attrs=this.attrs.map((function(t){var e=Object.assign({},t);return e.data=Array.from(e.data),e})),e}},{key:\"cloneStruct\",value:function(){var e=new t;return e.mode=this.mode,this.indices&&(e.indices=[]),Object.assign(e.attrIndexMap,this.attrIndexMap),e.attrs=this.attrs.map((function(t){var e=Object.assign({},t);return e.data=[],e})),e}},{key:\"toHilo3dGeometry\",value:function(t,e){var n=e||new t.Geometry;return this.indices&&(this.indices.BYTES_PER_ELEMENT?n.indices=new t.GeometryData(this.indices,1):this.getAttrLength()>65535?n.indices=new t.GeometryData(new Uint32Array(this.indices),1):n.indices=new t.GeometryData(new Uint16Array(this.indices),1)),this.attrs.forEach((function(e){var r=c[e.name];r&&(e.data.BYTES_PER_ELEMENT?n[r]=new t.GeometryData(e.data,e.itemCount):n[r]=new t.GeometryData(new Float32Array(e.data),e.itemCount))})),n}},{key:\"getAllBuffers\",value:function(){var t=[];return this.indices.BYTES_PER_ELEMENT&&t.push(this.indices.buffer),this.attrs.forEach((function(e){e.data&&e.data.BYTES_PER_ELEMENT&&t.push(e.data.buffer)})),t}}],[{key:\"fromGLTFPrimitive\",value:function(e){var n=new t(e.indices,e.mode),r=e.attributes,i=0;for(var a in r.POSITION&&(i=r.POSITION.length/3),r)if(s[a]){var o=f[s[a]];i&&(o=r[a].length/i),n.addAttr(s[a],r[a],o)}else console.warn(\"Dont support attribute\",a);return n}},{key:\"fromHilo3dGeometry\",value:function(e){var n=new t(e.indices.data,e.mode);for(var r in h)e[r]&&n.addAttr(h[r],e[r].data,e[r].size);return n}}]),t}();t.exports=l},function(t,e){var n={};function r(t){return n[t]||(n[t]=Math.pow(2,t)-1),n[t]}t.exports={cal:function(t,e,n,i){var a=r(i),s=n-e;return Math.round((t-e)/s*a)},encode:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=t.length,i=r(e),a=1/0,s=-1/0,o=0;o<n;o++)a=Math.min(a,t[o]),s=Math.max(s,t[o]);var u=s-a||1,c=[];for(o=0;o<n;o++)c[o]=Math.round((t[o]-a)/u*i);return{min:a,max:s,quantizationBit:e,data:c}},encodeWithMinAndMax:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:8,s=t.length,o=r(a),u=i-n||1,c=0;c<s;c++)e[c]=Math.round((t[c]-n)/u*o);return e},decode:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:8,n=arguments.length>2?arguments[2]:void 0,i=arguments.length>3?arguments[3]:void 0,a=t.length,s=r(e),o=i-n,u=new Float32Array(a),c=0;c<a;c++)u[c]=n+o*(t[c]/s);return u},normalize:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,r=t.length,i=0;i<r;i+=n){for(var a=0,s=0;s<n;s++)a+=t[i+s]*t[i+s];for(a=Math.sqrt(a),s=0;s<n;s++)e[i+s]=t[i+s]/a}return e}}},function(t,e,n){t.exports=n(3)},function(t,e,n){var r=n(4);r.Geometry=n(0),t.exports=r},function(t,e,n){var r=n(0),i=n(5),a=n(7),s=n(8),o=n(9),u=[i],c=[a];function h(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return t instanceof Uint8Array&&(e=t.byteOffset,t=t.buffer),function(t){return new u[t.type](t).decompress()}(function(t,e){var n=new Uint8Array(t,e,4);if(65!==n[0]||77!==n[1]||67!==n[2])throw new Error(\"The file is not AMC format!\");var r=c[n[3]].read(t,e+4);return r.geometry.type=n[3],r.geometry}(t,e))}var f,l=null,d=null;function m(t,e){return!l&&o()?(l=new s({wasmURL:t,memPages:e}),d=l.init()):d||Promise.resolve()}function _(t,e,n){if(l||m(e,n),!l||!l.isReady)return h(t);try{return l.decompress(t)}catch(e){return console.warn(\"wasm decompress error\",e),h(t)}}var p=null;function g(t){return t=t||\"https://g.alicdn.com/hilo/amc/0.1.27/worker.js\",p||(!1===f||\"undefined\"==typeof Worker?Promise.reject(\"dont support web worker\"):p=/^(?:http|blob|data:|\\/\\/)/.test(t)?new Promise((function(e,n){var r=new XMLHttpRequest;r.addEventListener(\"load\",(function(){if(\"undefined\"==typeof URL||\"undefined\"==typeof Blob)f=new Worker(\"data:application/javascript, \".concat(this.responseText));else{var t=URL.createObjectURL(new Blob([this.responseText]));f=new Worker(t)}f.onerror=function(t){console.log(\"web worker error\",t),f=!1,n(t)},e(f)})),r.addEventListener(\"error\",(function(t){return n(t)})),r.open(\"get\",t,!0),r.send()})):new Promise((function(e,n){(f=new Worker(t)).onerror=function(t){console.log(\"web worker init error\",t),f=!1,n(t)},e(f)})))}var v=0;function E(t,e,n,i){return e=e&&o(),t=new Uint8Array(t),g(i).then((function(i){return new Promise((function(a,s){var o=v++,u=function(e){if(e.data.id===o)if(i.removeEventListener(\"message\",u),u=null,e.data.data){var n=e.data.data;n.constructor=r,n.__proto__=r.prototype,a(n)}else a(h(t))};i.addEventListener(\"message\",u),i.postMessage({id:o,data:t,useWASM:e,wasmURL:n},[t.buffer])}))})).catch((function(r){return e?_(t,n):h(t)}))}t.exports={initWASM:m,initWorker:g,decompress:function(t,e,n){var r=o();return!r||t.byteLength>1048576?E(t,r,e,n):r?Promise.resolve(_(t,e)):Promise.resolve(h(t))},decompressWithJS:h,decompressWithWASM:_,decompressWithWorker:E,destory:function(){f&&(f.terminate(),f=null,p=null),l&&(l=null,d=null)}}},function(t,e,n){function r(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}function i(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var a=n(0),o=(n(1),n(6)),u=o.map,c=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.geometry=e,this.faceCount=e.clers.length,this.clers=e.clers,this.holes=e.holes,this.handles=e.handles,this.createHandleMap(this.handles),this.vertexCount=e.getAttrLength(),this.noParallelogramPrediction=!!e.noParallelogramPrediction}var e,n;return e=t,(n=[{key:\"nextCorner\",value:function(t){return t<0?-1:t+(t%3==2?-2:1)}},{key:\"prevCorner\",value:function(t){return t<0?-1:t+(t%3?-1:2)}},{key:\"createHandleMap\",value:function(t){var e=this.handlesMap={};if(t)for(var n=t.length-1;n>=0;n-=2)e[t[n]]=t[n-1]}},{key:\"mapBoundary\",value:function(t){for(var e=this.indices,n=t.length,r=this.currentVertex,i=this.currentVertex-n+1,a=n-1;a>=0;a--)e[this.nextCorner(t[a])]=r,r=i,e[this.prevCorner(t[a])]=i++;this.currentVertex-=n}},{key:\"mapHoleBoundary\",value:function(t){for(var e=this.indices,n=t.length,r=this.currentVertex-n+1,i=r,a=n-1;a>=0;a--)e[this.nextCorner(t[a])]=r++,e[this.prevCorner(t[a])]=a?r:i;this.currentVertex-=n}},{key:\"fixNegativeIndex\",value:function(t){for(var e=t,n=this.indices;n[t]<0;){if(e===-n[-n[t]]||n[t]===n[-n[t]]){console.warn(\"dead loop bug!!\"),n[s]=0;break}n[t]=n[-n[t]]}}},{key:\"fixIndicesAndReadVertice\",value:function(){for(var t,e=this.indices,n=this.handlesMap,r=this.clers,i=r.length,a=-1,s=[],u=0,c=0;u<i;u++,c+=3)-1===a?(this.fixNegativeIndex(c+1),this.fixNegativeIndex(c+2)):(e[c+1]=e[this.prevCorner(a)],e[c+2]=e[this.nextCorner(a)]),this.fixNegativeIndex(c),-1===a?(this.readVertex(e[c+2]),this.readVertex(e[c+1]),this.readVertex(e[c])):this.readVertex(e[c],a),a=c+1,(t=r[u])!==o.S||n[u]?t===o.E||t===o.F?a=s.pop():t===o.R&&(a=c+2):s.push(c+2),t===o.F&&(a=-1,delete this.lastReadVertexIndex),this._onDecompressFace(u,t)}},{key:\"readVertex\",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;if(!this.readedVertexMap[t]&&(this.readedVertexMap[t]=1,!this.noParallelogramPrediction)){var n=this.indices,r=this.geometry;-1===e?void 0!==this.lastReadVertexIndex&&r.cal(r,t,a.plus,this.lastReadVertexIndex,t):r.cal(r,t,a.depp,n[e],n[this.prevCorner(e)],n[this.nextCorner(e)],t),this.lastReadVertexIndex=t}}},{key:\"markCorner\",value:function(t,e){var n=this.indices;void 0===n[this.nextCorner(t)]&&(n[this.nextCorner(t)]=-this.prevCorner(e[0])),void 0===n[this.prevCorner(t)]&&(n[this.prevCorner(t)]=-this.nextCorner(e[e.length-1]))}},{key:\"onFaceC\",value:function(t){var e=this.indices,n=3*this.currentFace,r=this.currentVertex--;e[n]=r;var i=t.pop();return e[this.nextCorner(i)]=r,e[this.prevCorner(i)]=-this.nextCorner(t[t.length-1]),i=t.shift(),e[this.prevCorner(i)]=r,e[this.nextCorner(i)]=-this.prevCorner(t[0]),t.push(n),t}},{key:\"onFaceL\",value:function(t){var e=3*this.currentFace;return this.markCorner(t.pop(),t),t.unshift(e+2),t.push(e),t}},{key:\"onFaceF\",value:function(t,e){return t&&this.mapBoundary(t),this.onFaceE(null,e)}},{key:\"onFaceE\",value:function(t,e){var n=3*this.currentFace;return t&&e.push(t),[n+2,n+1,n]}},{key:\"onFaceR\",value:function(t){var e=3*this.currentFace;return this.markCorner(t.pop(),t),t.push(e+1,e),t}},{key:\"onHandleEnd\",value:function(t,e,n){var r=this.indices,i=3*this.currentFace,a=this.handlesMap[this.currentFace],s=e.splice(0,t);return e.shift(),n.push(s),r[this.nextCorner(a)]=-(i+1),r[this.prevCorner(a)]=-this.nextCorner(s[s.length-1]),r[i]=-this.prevCorner(s[0]),e.push(i),e}},{key:\"onHandleStart\",value:function(t,e){for(var n,i=this.indices,a=3*this.currentFace,s=this.handlesMap[this.currentFace],o=e.length-1;o>=0;o--){var u=e[o].indexOf(s);if(u>=0){var c,h=(n=e.splice(o,1)[0]).splice(0,u);n.shift(),(c=n).push.apply(c,r(h));break}}return i[this.nextCorner(s)]=-(a+1),i[this.prevCorner(s)]=-this.nextCorner(n[n.length-1]),i[a]=-this.prevCorner(t[0]),(t=n.concat(t)).push(a),t}},{key:\"onFaceS\",value:function(t,e,n){var r=this.handlesMap,i=this.indices,a=3*this.currentFace;if(r[this.currentFace]){this.markCorner(t.pop(),t);var s=t.indexOf(r[this.currentFace]);t=s>=0?this.onHandleEnd(s,t,n):this.onHandleStart(t,n)}else{var o=t.pop();this.markCorner(o,t),i[a]=-this.nextCorner(o);var u=e.pop();this.markCorner(u.pop(),u),(t=u.concat(t)).push(a)}return t}},{key:\"onFaceM\",value:function(t,e,n){var r=this.indices,i=3*this.currentFace,a=t.splice(0,this.holes[this.currentHole--]);this.mapHoleBoundary(a);var s=r[this.prevCorner(a[0])];r[i]=s;var o=t.pop();return r[this.prevCorner(o)]=-this.nextCorner(t[t.length-1]),r[this.nextCorner(o)]=s,o=t.shift(),r[this.prevCorner(o)]=s,r[this.nextCorner(o)]=-this.prevCorner(t[0]),t.push(i),t}},{key:\"decompress\",value:function(){this.readedVertexMap=new Uint8Array(this.vertexCount);var t=this.faceCount,e=this.indices=new Array(3*t);this.currentFace=t-1,this.currentVertex=this.vertexCount-1,this.currentHole=this.holes.length-1;for(var n,r=this.clers,i=[],a=[];this.currentFace>=0;){var s=\"onFace\"+u[r[this.currentFace]];this[s]?n=this[s](n,i,a):console.warn(\"has no \".concat(s)),this.currentFace--}return this.mapBoundary(n),this.fixIndicesAndReadVertice(this.indices),this.geometry.indices=e,this.geometry.dequantize(),this.geometry}},{key:\"_onDecompressFace\",value:function(t,e){this.onDecompressFace&&this.onDecompressFace(t,e)}}])&&i(e.prototype,n),t}();t.exports=c},function(t,e){var n={C:0,R:1,L:2,S:3,E:4,M:5,F:6},r=[];for(var i in n)r[n[i]]=i;n.map=r,t.exports=n},function(t,e,n){var r=n(0);function i(t,e,n,r){return new t(e.slice(n,n+r*t.BYTES_PER_ELEMENT))}t.exports={read:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=new DataView(t),a=new r,s=function(t,e){var n={};return n.version=t.getUint8(e++),n.faceCount=t.getUint32(e,!0),e+=4,n.vertexCount=t.getUint32(e,!0),e+=4,n.attrCount=t.getUint8(e++),n.noParallelogramPrediction=t.getUint8(e++),n.holesCount=t.getUint16(e,!0),e+=2,n.handlesCount=t.getUint16(e,!0),e+=2,n.headerBytes=15,n}(n,e);return e+=s.headerBytes,a.mode=\"CLERS\",e=function(t,e,n,r){for(var a=0;a<r.attrCount;a++){var s={},o=e.getUint16(n,!0);n+=2,s.name=t.attrIdToName(o),s.itemCount=e.getUint8(n++),s.quantizationBit=e.getUint8(n++),s.min=e.getFloat32(n,!0),n+=4,s.max=e.getFloat32(n,!0),n+=4,s.data=i(Int16Array,e.buffer,n,s.itemCount*r.vertexCount),n+=s.itemCount*r.vertexCount*2,t.attrs.push(s)}return n}(a,n,e=function(t,e,n,r){return t.clers=new Uint8Array(e.buffer,n,r.faceCount),n+r.faceCount}(a,n,e=function(t,e,n,r){return r.handlesCount?(t.handles=i(Uint32Array,e.buffer,n,2*r.handlesCount),n+8*r.handlesCount):(t.handles=[],n)}(a,n,e=function(t,e,n,r){return r.holesCount?(t.holes=i(Uint16Array,e.buffer,n,r.holesCount),n+2*r.holesCount):(t.holes=[],n)}(a,n,e,s),s),s),s),{header:s,geometry:a,offset:e}}}},function(t,e,n){function r(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,\"value\"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}var i=n(0),a=function(){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};!function(t,e){if(!(t instanceof e))throw new TypeError(\"Cannot call a class as a function\")}(this,t),this.wasmURL=e.wasmURL||\"https://ossgw.alicdn.com/tmall-c3/tmx/70b8d82ccf33e97a124e54c2d6a3e0c7.wasm\",this.memPages=e.memPages||256,this.memPages<256&&(this.memPages=256),this.isReady=!1}var e,n;return e=t,(n=[{key:\"initASMJS\",value:function(){this.isReady=!0,this.dv=new DataView(HEAP8.buffer),this.heap8=HEAP8,this.ins={exports:{__Z7AMCinitj:Module.__Z7AMCinitj,__Z12AMDecompressv:Module.__Z12AMDecompressv}}}},{key:\"init\",value:function(){var t=this,e=this.memory=new WebAssembly.Memory({initial:this.memPages});this.dv=new DataView(e.buffer);var n=this.heap8=new Uint8Array(e.buffer),r={global:{NaN:5,Infinity:6},env:{memoryBase:0,memory:e,_malloc:function(){return 2097152},_memset:function(t,e,r){return n.fill(e,t,t+r),t},_printf:function(t,e){for(var r=t;n[r];)r++;var i=String.fromCharCode.apply(String,function(t){return function(t){if(Array.isArray(t)){for(var e=0,n=new Array(t.length);e<t.length;e++)n[e]=t[e];return n}}(t)||function(t){if(Symbol.iterator in Object(t)||\"[object Arguments]\"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError(\"Invalid attempt to spread non-iterable instance\")}()}(n.slice(t,r))),a=0;i=i.replace(/%([duf])/g,(function(t,n){return\"d\"===n||\"u\"===n?dv.getInt32(e+4*a++,!0):\"f\"===n?dv.getFloat32(e+4*a++,!0):void 0})),console.log(i)}}};return fetch(this.wasmURL).then((function(t){return t.arrayBuffer()})).then((function(t){return WebAssembly.instantiate(t,r)})).then((function(e){t.module=e,t.ins=e.instance,t.isReady=!0})).catch((function(t){return console.log(\"wasm load error, use js ver\")}))}},{key:\"getDataAddr\",value:function(t){return this.ins.exports.__Z7AMCinitj(t)}},{key:\"decompress\",value:function(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=this.dv,n=this.heap8,r=this.getDataAddr(t.length);n.set(t,r);var a=this.ins.exports.__Z12AMDecompressv();if(a<=0)throw console.error(\"decompression error code: \"+a),new Error(\"decompression error code: \"+a);for(var s=e.getUint32(a,!0),o=e.getUint32(a+4,!0),u=e.getUint32(a+8,!0),c=e.getUint32(a+12,!0),h=[],f=0;f<c;f++){var l=a+16+12*f;h.push([e.getUint32(l,!0),e.getUint32(l+4,!0),e.getUint32(l+8,!0)])}var d=new Uint32Array(e.buffer,o,3*s);d=u>65536?new Uint32Array(d):new Uint16Array(d);var m=new i(d);return h.forEach((function(t){var n=function(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")}()}(t,3),r=n[0],i=n[1],a=n[2],s=new Float32Array(e.buffer.slice(a,a+u*i*4));m.addAttr(m.attrIdToName(r),s,i)})),m}}])&&r(e.prototype,n),t}();t.exports=a},function(t,e){var n;t.exports=function(){return void 0===n&&(n=function(){if(\"undefined\"==typeof WebAssembly||\"undefined\"==typeof fetch||function(){if(!/iPad|iPhone|iPod/i.test(navigator.userAgent))return!1;if(/OS (\\d+)_(\\d+)_?(\\d+)?/i.test(navigator.userAgent)){var t=Number(RegExp.$1),e=Number(RegExp.$2);if(11===t&&e>=3||t>11)return!1}return!0}())return!1;try{var t=new Uint8Array([0,97,115,109,1,0,0,0,1,6,1,96,1,127,1,127,3,2,1,0,5,3,1,0,1,7,8,1,4,116,101,115,116,0,0,10,16,1,14,0,32,0,65,1,54,2,0,32,0,40,2,0,11]),e=new WebAssembly.Module(t);return 0!==new WebAssembly.Instance(e,{}).exports.test(4)}catch(t){return console.log(\"err while check WebAssembly\",t),!1}}()),n}}])},function(t,e,n){\"use strict\";var r=n(35),i=n.n(r),a=n(1),s=n(5),o=a.a.create({className:\"Ray\",isRay:!0,origin:{get:function(){return this._origin},set:function(t){this._origin=t,this._ray.origin=t.elements}},direction:{get:function(){return this._direction},set:function(t){this._direction=t,this._ray.direction=t.elements}},constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};this._ray=new i.a,this.origin=t.origin||new s.a(0,0,0),this.direction=t.direction||new s.a(0,0,-1)},set:function(t,e){return this.origin=t,this.direction=e,this},copy:function(t){this.origin.copy(t.origin),this.direction.copy(t.direction)},clone:function(){return new this.constructor({origin:this.origin.clone(),direction:this.direction.clone()})},fromCamera:function(t,e,n,r,i){t.isPerspectiveCamera?(t.worldMatrix.getTranslation(this.origin),this.direction.set(e,n,0),this.direction.copy(t.unprojectVector(this.direction,r,i)),this.direction.sub(this.origin).normalize()):t.isOrthographicCamera&&(this.origin.set(e,n,(t.near+t.far)/(t.near-t.far)),this.origin.copy(t.unprojectVector(this.origin,r,i)),this.direction.set(0,0,-1).transformDirection(t.worldMatrix).normalize())},transformMat4:function(t){this.origin.transformMat4(t),this.direction.transformDirection(t).normalize()},sortPoints:function(t,e){var n=this;e?t.sort((function(t,r){return n.squaredDistance(t[e])-n.squaredDistance(r[e])})):t.sort((function(t,e){return n.squaredDistance(t)-n.squaredDistance(e)}))},squaredDistance:function(t){return this.origin.squaredDistance(t)},distance:function(t){return this.origin.distance(t)},intersectsSphere:function(t,e){var n=this._ray.intersectsSphere(t,e);return this._getRes(n)},intersectsPlane:function(t,e){var n=this._ray.intersectsPlane(t,e);return this._getRes(n)},intersectsTriangle:function(t){var e=this._ray.intersectsTriangle(t);return this._getRes(e)},intersectsBox:function(t){var e=this._ray.intersectsBox(t);return this._getRes(e)},intersectsTriangleCell:function(t,e){var n=this._ray.intersectsTriangleCell(t,e);return this._getRes(n)},_getRes:function(t){return t?new s.a(t[0],t[1],t[2]):null}});e.a=o},function(t,e,n){\"use strict\";var r=n(0),i=n(1),a=n(9),s=n(5),o=i.a.create({Mixes:a.a,Extends:s.a,className:\"Vector3Notifier\",isVector3Notifier:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.elements=r.vec3.fromValues(t,e,n)},copy:function(t){return r.vec3.copy(this.elements,t.elements),this.fire(\"update\"),this},clone:function(){var t=this.elements;return new this.constructor(t[0],t[1],t[2])},toArray:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return t[0+e]=n[0],t[1+e]=n[1],t[2+e]=n[2],t},fromArray:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements;return n[0]=t[e+0],n[1]=t[e+1],n[2]=t[e+2],this.fire(\"update\"),this},set:function(t,e,n){return r.vec3.set(this.elements,t,e,n),this.fire(\"update\"),this},add:function(t,e){return e||(e=t,t=this),r.vec3.add(this.elements,t.elements,e.elements),this.fire(\"update\"),this},subtract:function(t,e){return e||(e=t,t=this),r.vec3.subtract(this.elements,t.elements,e.elements),this.fire(\"update\"),this},multiply:function(t,e){return e||(e=t,t=this),r.vec3.multiply(this.elements,t.elements,e.elements),this.fire(\"update\"),this},divide:function(t,e){return e||(e=t,t=this),r.vec3.divide(this.elements,t.elements,e.elements),this.fire(\"update\"),this},ceil:function(){return r.vec3.ceil(this.elements,this.elements),this.fire(\"update\"),this},floor:function(){return r.vec3.floor(this.elements,this.elements),this.fire(\"update\"),this},min:function(t,e){return e||(e=t,t=this),r.vec3.min(this.elements,t.elements,e.elements),this.fire(\"update\"),this},max:function(t,e){return e||(e=t,t=this),r.vec3.max(this.elements,t.elements,e.elements),this.fire(\"update\"),this},round:function(){return r.vec3.round(this.elements,this.elements),this.fire(\"update\"),this},scale:function(t){return r.vec3.scale(this.elements,this.elements,t),this.fire(\"update\"),this},scaleAndAdd:function(t,e,n){return n||(n=e,e=this),r.vec3.scaleAndAdd(this.elements,e.elements,n.elements,t),this.fire(\"update\"),this},distance:function(t,e){return e||(e=t,t=this),r.vec3.distance(t.elements,e.elements)},squaredDistance:function(t,e){return e||(e=t,t=this),r.vec3.squaredDistance(t.elements,e.elements)},length:function(){return r.vec3.length(this.elements)},squaredLength:function(){return r.vec3.squaredLength(this.elements)},negate:function(){return r.vec3.negate(this.elements,this.elements),this.fire(\"update\"),this},inverse:function(t){return t||(t=this),r.vec3.inverse(this.elements,t.elements),this.fire(\"update\"),this},normalize:function(){return r.vec3.normalize(this.elements,this.elements),this.fire(\"update\"),this},dot:function(t,e){return e||(e=t,t=this),r.vec3.dot(t.elements,e.elements)},cross:function(t,e){return e||(e=t,t=this),r.vec3.cross(this.elements,t.elements,e.elements),this.fire(\"update\"),this},lerp:function(t,e){return r.vec3.lerp(this.elements,this.elements,t.elements,e),this.fire(\"update\"),this},hermite:function(t,e,n,i,a){return r.vec3.hermite(this.elements,t.elements,e.elements,n.elements,i.elements,a),this.fire(\"update\"),this},bezier:function(t,e,n,i,a){return r.vec3.bezier(this.elements,t.elements,e.elements,n.elements,i.elements,a),this.fire(\"update\"),this},random:function(t){return r.vec3.random(this.elements,t),this.fire(\"update\"),this},transformMat3:function(t){return r.vec3.transformMat3(this.elements,this.elements,t.elements),this.fire(\"update\"),this},transformMat4:function(t){return r.vec3.transformMat4(this.elements,this.elements,t.elements),this.fire(\"update\"),this},transformDirection:function(t){var e=this.elements,n=t.elements,r=e[0],i=e[1],a=e[2];return e[0]=r*n[0]+i*n[4]+a*n[8],e[1]=r*n[1]+i*n[5]+a*n[9],e[2]=r*n[2]+i*n[6]+a*n[10],this.fire(\"update\"),this},transformQuat:function(t){return r.vec3.transformQuat(this.elements,this.elements,t.elements),this.fire(\"update\"),this},rotateX:function(t,e){return r.vec3.rotateX(this.elements,this.elements,t.elements,e),this.fire(\"update\"),this},rotateY:function(t,e){return r.vec3.rotateY(this.elements,this.elements,t.elements,e),this.fire(\"update\"),this},rotateZ:function(t,e){return r.vec3.rotateZ(this.elements,this.elements,t.elements,e),this.fire(\"update\"),this},exactEquals:function(t,e){return e||(e=t,t=this),r.vec3.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),r.vec3.equals(t.elements,e.elements)},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this.fire(\"update\")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this.fire(\"update\")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this.fire(\"update\")}}});e.a=o},function(t,e){t.exports=\"#define GLSLIFY 1\\n#define HILO_FRONT_SIDE 1028\\n#define HILO_BACK_SIDE 1029\\n#define HILO_FRONT_AND_BACK_SIDE 1032\\n#define HILO_PI 3.141592653589793\\n#define HILO_INVERSE_PI 0.3183098861837907\"},function(t,e,n){\"use strict\";var r=n(1),i=n(5),a=r.a.create({className:\"Plane\",isPlane:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new i.a,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;this.normal=t,this.distance=e},copy:function(t){return this.normal.copy(t.normal),this.distance=t.distance,this},clone:function(){return new this.constructor(this.normal.clone(),this.distance)},set:function(t,e,n,r){return this.normal.set(t,e,n),this.distance=r,this},normalize:function(){var t=1/this.normal.length();return this.normal.scale(t),this.distance*=t,this},distanceToPoint:function(t){return this.normal.dot(t)+this.distance},projectPoint:function(t){return(new i.a).copy(this.normal).scale(-this.distanceToPoint(t)).add(t)}});e.a=a},function(t,e,n){\"use strict\";var r=n(1),i=n(5),a=new i.a,s=r.a.create({className:\"Sphere\",isSphere:!0,radius:0,constructor:function(t){Object.assign(this,t),this.center||(this.center=new i.a(0,0,0))},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},fromPoints:function(t){for(var e=this.center,n=0,r=0;r<t.length;r+=3){var i=t[r]-e.x,a=t[r+1]-e.y,s=t[r+2]-e.z;n=Math.max(i*i+a*a+s*s,n)}return this.radius=Math.sqrt(n),this},fromGeometryData:function(t){var e=this.center,n=0;return t.traverse((function(t){var r=t.x-e.x,i=t.y-e.y,a=t.z-e.z;n=Math.max(r*r+i*i+a*a,n)})),this.radius=Math.sqrt(n),this},transformMat4:function(t){this.center.transformMat4(t);var e=t.getScaling(a);return this.radius*=Math.max(e.x,e.y,e.z),this}});e.a=s},function(t,e,n){\"use strict\";var r,i=n(0),a=n(1),s=n(9),o=n(5),u=n(7),c=n(10),h=new o.a,f=new o.a,l=a.a.create({Mixes:s.a,Extends:u.a,className:\"Matrix4Notifier\",isMatrix4Notifier:!0,constructor:function(){this.elements=i.mat4.create()},copy:function(t){return i.mat4.copy(this.elements,t.elements),this.fire(\"update\"),this},fromArray:function(t){for(var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=this.elements,r=0;r<16;r++)n[r]=t[e+r];return this.fire(\"update\"),this},set:function(t,e,n,r,a,s,o,u,c,h,f,l,d,m,_,p){return i.mat4.set(this.elements,t,e,n,r,a,s,o,u,c,h,f,l,d,m,_,p),this.fire(\"update\"),this},identity:function(){return i.mat4.identity(this.elements),this.fire(\"update\"),this},transpose:function(){return i.mat4.transpose(this.elements,this.elements),this.fire(\"update\"),this},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return i.mat4.invert(this.elements,t.elements),this.fire(\"update\"),this},adjoint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this;return i.mat4.adjoint(this.elements,t.elements),this.fire(\"update\"),this},determinant:function(){return i.mat4.determinant(this.elements)},multiply:function(t,e){return e||(e=t,t=this),i.mat4.multiply(this.elements,t.elements,e.elements),this.fire(\"update\"),this},premultiply:function(t){return this.multiply(t,this),this.fire(\"update\"),this},translate:function(t){return i.mat4.translate(this.elements,this.elements,t.elements),this.fire(\"update\"),this},scale:function(t){return i.mat4.scale(this.elements,this.elements,t.elements),this.fire(\"update\"),this},rotate:function(t,e){return i.mat4.rotate(this.elements,this.elements,t,e.elements),this.fire(\"update\"),this},rotateX:function(t){return i.mat4.rotateX(this.elements,this.elements,t),this.fire(\"update\"),this},rotateY:function(t){return i.mat4.rotateY(this.elements,this.elements,t),this.fire(\"update\"),this},rotateZ:function(t){return i.mat4.rotateZ(this.elements,this.elements,t),this.fire(\"update\"),this},fromTranslation:function(t){return i.mat4.fromTranslation(this.elements,t.elements),this.fire(\"update\"),this},fromScaling:function(t){return i.mat4.fromScaling(this.elements,t.elements),this.fire(\"update\"),this},fromRotation:function(t,e){return i.mat4.fromRotation(this.elements,t,e.elements),this.fire(\"update\"),this},fromXRotation:function(t){return i.mat4.fromXRotation(this.elements,t),this.fire(\"update\"),this},fromYRotation:function(t){return i.mat4.fromYRotation(this.elements,t),this.fire(\"update\"),this},fromZRotation:function(t){return i.mat4.fromZRotation(this.elements,t),this.fire(\"update\"),this},fromRotationTranslation:function(t,e){return i.mat4.fromRotationTranslation(this.elements,t.elements,e.elements),this.fire(\"update\"),this},getTranslation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.a;return i.mat4.getTranslation(t.elements,this.elements),t},getScaling:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new o.a;return i.mat4.getScaling(t.elements,this.elements),t},getRotation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new c.a;return i.mat4.getRotation(t.elements,this.elements),t},fromRotationTranslationScale:function(t,e,n){return i.mat4.fromRotationTranslationScale(this.elements,t.elements,e.elements,n.elements),this.fire(\"update\"),this},fromRotationTranslationScaleOrigin:function(t,e,n,r,a){return i.mat4.fromRotationTranslationScaleOrigin(this.elements,t.elements,e.elements,n.elements,r.elements),a||this.fire(\"update\"),this},fromQuat:function(t){return i.mat4.fromQuat(this.elements,t.elements),this.fire(\"update\"),this},frustum:function(t,e,n,r,a,s){return i.mat4.frustum(this.elements,t,e,n,r,a,s),this.fire(\"update\"),this},perspective:function(t,e,n,r){return i.mat4.perspective(this.elements,t,e,n,r),this.fire(\"update\"),this},perspectiveFromFieldOfView:function(t,e,n){return i.mat4.perspectiveFromFieldOfView(this.elements,t,e,n),this.fire(\"update\"),this},ortho:function(t,e,n,r,a,s){return i.mat4.ortho(this.elements,t,e,n,r,a,s),this.fire(\"update\"),this},lookAt:function(t,e,n){return t.isVector3||(t=h.set(t.x,t.y,t.z)),e.isVector3||(e=f.set(e.x,e.y,e.z)),i.mat4.lookAt(this.elements,t.elements,e.elements,n.elements),this.fire(\"update\"),this},targetTo:function(t,e,n){t.isVector3||(t=h.set(t.x,t.y,t.z)),e.isVector3||(e=f.set(e.x,e.y,e.z)),t=t.elements,e=e.elements,n=n.elements;var r=this.elements,i=t[0],a=t[1],s=t[2],o=n[0],u=n[1],c=n[2],l=i-e[0],d=a-e[1],m=s-e[2],_=l*l+d*d+m*m;_>0?(l*=_=1/Math.sqrt(_),d*=_,m*=_):m=1;var p=u*m-c*d,g=c*l-o*m,v=o*d-u*l;return(_=p*p+g*g+v*v)>0?(p*=_=1/Math.sqrt(_),g*=_,v*=_):(_=(p=u*m-c*d)*p+(g=c*l-(o+=1e-7)*m)*g+(v=o*d-u*l)*v,p*=_=1/Math.sqrt(_),g*=_,v*=_),r[0]=p,r[1]=g,r[2]=v,r[3]=0,r[4]=d*v-m*g,r[5]=m*p-l*v,r[6]=l*g-d*p,r[7]=0,r[8]=l,r[9]=d,r[10]=m,r[11]=0,r[12]=i,r[13]=a,r[14]=s,r[15]=1,this.fire(\"update\"),this},frob:function(){return i.mat4.frob(this.elements)},add:function(t,e){return e||(e=t,t=this),i.mat4.add(this.elements,t.elements,e.elements),this.fire(\"update\"),this},subtract:function(t,e){return e||(e=t,t=this),i.mat4.subtract(this.elements,t.elements,e.elements),this.fire(\"update\"),this},exactEquals:function(t,e){return e||(e=t,t=this),i.mat4.exactEquals(t.elements,e.elements)},equals:function(t,e){return e||(e=t,t=this),i.mat4.equals(t.elements,e.elements)},compose:function(t,e,n,r){return r?this.fromRotationTranslationScaleOrigin(t,e,n,r):this.fromRotationTranslationScale(t,e,n),this},decompose:function(t,e,n,i){return this.getScaling(n),this.getTranslation(e),r||(r=new u.a),this.determinant()<0&&(n.x*=-1),r.copy(this),h.inverse(n),r.scale(h),t.fromMat4(r),i&&i.set(0,0,0),this}});e.a=l},function(t,e,n){\"use strict\";var r=n(1),i=n(9),a=n(6),s=n(13),o=a.a.DEG2RAD,u=a.a.RAD2DEG,c=r.a.create({Mixes:i.a,Extends:s.a,className:\"EulerNotifier\",isEulerNotifier:!0,constructor:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;s.a.call(this,t,e,n)},updateDegrees:function(){return c.superclass.updateDegrees.call(this),this.fire(\"update\"),this},updateRadians:function(){return c.superclass.updateRadians.call(this),this.fire(\"update\"),this},degX:{get:function(){return this._degX},set:function(t){this._degX=t,this.elements[0]=t*o,this.fire(\"update\")}},degY:{get:function(){return this._degY},set:function(t){this._degY=t,this.elements[1]=t*o,this.fire(\"update\")}},degZ:{get:function(){return this._degZ},set:function(t){this._degZ=t,this.elements[2]=t*o,this.fire(\"update\")}},x:{get:function(){return this.elements[0]},set:function(t){this.elements[0]=t,this._degX=t*u,this.fire(\"update\")}},y:{get:function(){return this.elements[1]},set:function(t){this.elements[1]=t,this._degY=t*u,this.fire(\"update\")}},z:{get:function(){return this.elements[2]},set:function(t){this.elements[2]=t,this._degZ=t*u,this.fire(\"update\")}}});e.a=c},function(t,e,n){\"use strict\";var r=n(1),i=n(19),a=r.a.create({className:\"Frustum\",isFrustum:!0,constructor:function(){this.planes=[];for(var t=6;t--;)this.planes.push(new i.a)},copy:function(t){var e=t.planes;return this.planes.forEach((function(t,n){t.copy(e[n])})),this},clone:function(){var t=new this.constructor;return t.copy(this),t},fromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],a=n[2],s=n[3],o=n[4],u=n[5],c=n[6],h=n[7],f=n[8],l=n[9],d=n[10],m=n[11],_=n[12],p=n[13],g=n[14],v=n[15];return e[0].set(s-r,h-o,m-f,v-_).normalize(),e[1].set(s+r,h+o,m+f,v+_).normalize(),e[2].set(s+i,h+u,m+l,v+p).normalize(),e[3].set(s-i,h-u,m-l,v-p).normalize(),e[4].set(s-a,h-c,m-d,v-g).normalize(),e[5].set(s+a,h+c,m+d,v+g).normalize(),this},intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0}});e.a=a},function(t,e){t.exports=\"#ifdef HILO_USE_SHADER_TEXTURE_LOD\\n    #extension GL_EXT_shader_texture_lod: enable\\n#endif\\n\\n#ifdef HILO_USE_EXT_FRAG_DEPTH\\n    #extension GL_EXT_frag_depth: enable\\n#define GLSLIFY 1\\n#endif\"},function(t,e){t.exports=\"#ifdef GL_ES\\nprecision HILO_MAX_FRAGMENT_PRECISION float;\\n#define GLSLIFY 1\\n#endif\"},function(t,e){t.exports=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"Color\",(function(){return r.a})),n.d(e,\"Euler\",(function(){return i.a})),n.d(e,\"EulerNotifier\",(function(){return a.a})),n.d(e,\"Frustum\",(function(){return s.a})),n.d(e,\"math\",(function(){return o.a})),n.d(e,\"Matrix3\",(function(){return u.a})),n.d(e,\"Matrix4\",(function(){return c.a})),n.d(e,\"Matrix4Notifier\",(function(){return h.a})),n.d(e,\"Plane\",(function(){return f.a})),n.d(e,\"Quaternion\",(function(){return l.a})),n.d(e,\"Ray\",(function(){return d.a})),n.d(e,\"Sphere\",(function(){return m.a})),n.d(e,\"SphericalHarmonics3\",(function(){return E})),n.d(e,\"Vector2\",(function(){return T.a})),n.d(e,\"Vector3\",(function(){return p.a})),n.d(e,\"Vector3Notifier\",(function(){return M.a})),n.d(e,\"Vector4\",(function(){return A.a}));var r=n(8),i=n(13),a=n(22),s=n(23),o=n(6),u=n(11),c=n(7),h=n(21),f=n(19),l=n(10),d=n(16),m=n(20),_=n(1),p=n(5),g=new Float32Array(27),v=_.a.create({className:\"SphericalHarmonics3\",isSphericalHarmonics3:!0,Statics:{SH3_SCALE:[Math.sqrt(1/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(3/(4*Math.PI)),-Math.sqrt(3/(4*Math.PI)),Math.sqrt(15/(4*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(5/(16*Math.PI)),-Math.sqrt(15/(4*Math.PI)),Math.sqrt(15/(16*Math.PI))]},constructor:function(){this.coefficients=[];for(var t=0;t<9;t++)this.coefficients.push(new p.a)},scale:function(t){return this.coefficients.forEach((function(e){e.scale(t)})),this},fromArray:function(t){return 9===t.length?this.coefficients.forEach((function(e,n){e.fromArray(t[n])})):27===t.length&&this.coefficients.forEach((function(e,n){e.fromArray(t,3*n)})),this},scaleForRender:function(){var t=v.SH3_SCALE;return this.coefficients.forEach((function(e,n){e.scale(t[n])})),this.scale(1/Math.PI),this},toArray:function(){return this.coefficients.forEach((function(t,e){t.toArray(g,3*e)})),g},clone:function(){var t=new this.constructor;return t.copy(this),t},copy:function(t){var e=t.coefficients;return this.coefficients.forEach((function(t,n){t.copy(e[n])})),this}}),E=v,T=n(14),M=n(17),A=n(12)},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\\n    uniform float u_logDepth;\\n    varying float v_fragDepth;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\\n    gl_FragDepthEXT = log2( v_fragDepth ) * u_logDepth * 0.5;\\n#endif\"},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]-n[0],t[1]=e[1]-n[1],t[2]=e[2]-n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]+n[0],t[1]=e[1]+n[1],t[2]=e[2]+n[2],t}},function(t,e){t.exports=function(t,e,n){return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t}},function(t,e){t.exports=function(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}},function(t,e,n){var r={_listeners:null,on:function(t,e,n){for(var r=this._listeners=this._listeners||{},i=r[t]=r[t]||[],a=0,s=i.length;a<s;a++){if(i[a].listener===e)return}return i.push({listener:e,once:n}),this},off:function(t,e){if(0==arguments.length)return this._listeners=null,this;var n=this._listeners&&this._listeners[t];if(n){if(1==arguments.length)return delete this._listeners[t],this;for(var r=0,i=n.length;r<i;r++){var a=n[r];if(a.listener===e){n.splice(r,1),0===n.length&&delete this._listeners[t];break}}}return this},fire:function(t,e){var n,r;\"string\"==typeof t?r=t:(n=t,r=t.type);var a=this._listeners;if(!a)return!1;var s=a[r];if(s){var o=s.slice(0);if((n=n||new i(r,this,e))._stopped)return!1;for(var u=0;u<o.length;u++){var c=o[u];if(c.listener.call(this,n),c.once){var h=s.indexOf(c);h>-1&&s.splice(h,1)}}return 0==s.length&&delete a[r],!0}return!1}},i=n(37).create({constructor:function(t,e,n){this.type=t,this.target=e,this.detail=n,this.timeStamp=+new Date},type:null,target:null,detail:null,timeStamp:0,stopImmediatePropagation:function(){this._stopped=!0}}),a=window.Event;if(a){var s=a.prototype,o=s.stopImmediatePropagation;s.stopImmediatePropagation=function(){o&&o.call(this),this._stopped=!0}}t.exports=r},function(t,e,n){var r=n(91),i=n(93),a=n(94),s=n(97),o=n(33),u=[[0,0,0],[0,0,0],[0,0,0]],c=[0,0,0];function h(t,e){this.origin=t||[0,0,0],this.direction=e||[0,0,-1]}t.exports=h,h.prototype.set=function(t,e){this.origin=t,this.direction=e},h.prototype.copy=function(t){o(this.origin,t.origin),o(this.direction,t.direction)},h.prototype.clone=function(){var t=new h;return t.copy(this),t},h.prototype.intersectsSphere=function(t,e){return a(c,this.origin,this.direction,t,e)},h.prototype.intersectsPlane=function(t,e){return i(c,this.origin,this.direction,t,e)},h.prototype.intersectsTriangle=function(t){return r(c,this.origin,this.direction,t)},h.prototype.intersectsBox=function(t){return s(c,this.origin,this.direction,t)},h.prototype.intersectsTriangleCell=function(t,e){var n=t[0],r=t[1],i=t[2];return u[0]=e[n],u[1]=e[r],u[2]=e[i],this.intersectsTriangle(u)}},function(t,e){var n;n=function(){return this}();try{n=n||new Function(\"return this\")()}catch(t){\"object\"==typeof window&&(n=window)}t.exports=n},function(t,e){var n=function(){var t,e,n=function(t){var e,n,i={};for(e in t)n=t[e],r.hasOwnProperty(e)?r[e].call(this,n):i[e]=n;a(this.prototype,i)},r={Extends:function(t){var e=this.prototype,n=i(t.prototype);a(this,t),a(n,e),n.constructor=this,this.prototype=n,this.superclass=t.prototype},Mixes:function(t){t instanceof Array||(t=[t]);for(var e,n=this.prototype;e=t.shift();)a(n,e.prototype||e)},Statics:function(t){a(this,t)}},i=function(){if(Object.__proto__)return function(t){return{__proto__:t}};var t=function(){};return function(e){return t.prototype=e,new t}}(),a=function(t){for(var n=1,r=arguments.length;n<r;n++){var i,a=arguments[n];for(var s in a){var o=a[s];!o||\"object\"!=typeof o||void 0===o.value&&\"function\"!=typeof o.get&&\"function\"!=typeof o.set?t[s]=o:(i=i||{})[s]=o}i&&e(t,i)}return t};try{t=Object.defineProperty,e=Object.defineProperties,t({},\"$\",{value:0})}catch(n){\"__defineGetter__\"in Object&&(t=function(t,e,n){return\"value\"in n&&(t[e]=n.value),\"get\"in n&&t.__defineGetter__(e,n.get),\"set\"in n&&t.__defineSetter__(e,n.set),t},e=function(e,n){for(var r in n)n.hasOwnProperty(r)&&t(e,r,n[r]);return e})}return{create:function(t){var e=(t=t||{}).hasOwnProperty(\"constructor\")?t.constructor:function(){};return n.call(e,t),e},mix:a}}();t.exports=n},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\n    varying vec4 v_color;\\n#endif\\n\\n#ifdef HILO_USE_HDR\\n    uniform float u_exposure;\\n#endif\\n\\n#ifdef HILO_GAMMA_CORRECTION\\n    uniform float u_gammaFactor;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\n    varying vec2 v_texcoord0;\\n#endif\\n\\n#ifdef HILO_HAS_TEXCOORD1\\n    varying vec2 v_texcoord1;\\n#endif\\n\\n#if defined(HILO_HAS_TEXCOORD0) || defined(HILO_HAS_TEXCOORD1)\\n    #if defined(HILO_HAS_TEXCOORD0) && defined(HILO_HAS_TEXCOORD1)\\n        #define HILO_SAMPLER_2D hiloSampler2D\\n        // https://www.khronos.org/opengl/wiki/Data_Type_(GLSL)#Opaque_types\\n        #define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  hiloTexture2D(HILO_SAMPLER_2D.texture, HILO_SAMPLER_2D.uv)\\n        struct hiloSampler2D{\\n            sampler2D texture;\\n            int uv; \\n        };\\n        \\n        vec4 hiloTexture2D(sampler2D texture, int uv){\\n            if(uv == 0){\\n                return texture2D(texture, v_texcoord0);\\n            }\\n            else{\\n                return texture2D(texture, v_texcoord1);\\n            }\\n        }\\n    #else\\n        #ifdef HILO_HAS_TEXCOORD1\\n            #define HILO_V_TEXCOORD v_texcoord1\\n        #else\\n            #define HILO_V_TEXCOORD v_texcoord0\\n        #endif\\n        #define HILO_SAMPLER_2D sampler2D\\n        #define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  texture2D(HILO_SAMPLER_2D, HILO_V_TEXCOORD)\\n    #endif\\n#endif\\n\\n\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\n    varying vec3 v_position;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\n    varying vec3 v_normal;\\n    #if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\\n        varying mat3 v_TBN;\\n        #ifdef HILO_NORMAL_MAP\\n            uniform HILO_SAMPLER_2D u_normalMap;\\n            \\n            #ifdef HILO_NORMAL_MAP_SCALE\\n            uniform float u_normalMapScale;\\n            #endif\\n        #endif\\n\\n        #ifdef HILO_CLEARCOAT_NORMAL_MAP\\n            uniform HILO_SAMPLER_2D u_clearcoatNormalMap;\\n        #endif\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\\n    varying vec3 v_fragPos;\\n#endif\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_DIRECTIONAL_LIGHTS\\n    uniform vec3 u_directionalLightsColor[HILO_DIRECTIONAL_LIGHTS];\\n    uniform vec3 u_directionalLightsInfo[HILO_DIRECTIONAL_LIGHTS];\\n    #ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\n        uniform sampler2D u_directionalLightsShadowMap[HILO_DIRECTIONAL_LIGHTS_SMC];\\n        uniform vec2 u_directionalLightsShadowMapSize[HILO_DIRECTIONAL_LIGHTS_SMC];\\n        uniform mat4 u_directionalLightSpaceMatrix[HILO_DIRECTIONAL_LIGHTS_SMC];\\n        uniform vec2 u_directionalLightsShadowBias[HILO_DIRECTIONAL_LIGHTS_SMC];\\n    #endif\\n#endif\\n\\n#ifdef HILO_SPOT_LIGHTS\\n    uniform vec3 u_spotLightsPos[HILO_SPOT_LIGHTS];\\n    uniform vec3 u_spotLightsDir[HILO_SPOT_LIGHTS];\\n    uniform vec3 u_spotLightsColor[HILO_SPOT_LIGHTS];\\n    uniform vec2 u_spotLightsCutoffs[HILO_SPOT_LIGHTS];\\n    uniform vec3 u_spotLightsInfo[HILO_SPOT_LIGHTS];\\n    uniform float u_spotLightsRange[HILO_SPOT_LIGHTS];\\n    #ifdef HILO_SPOT_LIGHTS_SMC\\n        uniform sampler2D u_spotLightsShadowMap[HILO_SPOT_LIGHTS_SMC];\\n        uniform vec2 u_spotLightsShadowMapSize[HILO_SPOT_LIGHTS_SMC];\\n        uniform mat4 u_spotLightSpaceMatrix[HILO_SPOT_LIGHTS_SMC];\\n        uniform vec2 u_spotLightsShadowBias[HILO_SPOT_LIGHTS_SMC];\\n    #endif\\n#endif\\n\\n#ifdef HILO_POINT_LIGHTS\\n    uniform vec3 u_pointLightsPos[HILO_POINT_LIGHTS];\\n    uniform vec3 u_pointLightsColor[HILO_POINT_LIGHTS];\\n    uniform vec3 u_pointLightsInfo[HILO_POINT_LIGHTS];\\n    uniform float u_pointLightsRange[HILO_POINT_LIGHTS];\\n    #ifdef HILO_POINT_LIGHTS_SMC\\n        uniform samplerCube u_pointLightsShadowMap[HILO_POINT_LIGHTS_SMC];\\n        uniform mat4 u_pointLightSpaceMatrix[HILO_POINT_LIGHTS_SMC];\\n        uniform vec2 u_pointLightsShadowBias[HILO_POINT_LIGHTS_SMC];\\n        uniform vec2 u_pointLightCamera[HILO_POINT_LIGHTS_SMC];\\n    #endif\\n#endif\\n\\n#ifdef HILO_AREA_LIGHTS\\n    uniform vec3 u_areaLightsPos[HILO_AREA_LIGHTS];\\n    uniform vec3 u_areaLightsColor[HILO_AREA_LIGHTS];\\n    uniform vec3 u_areaLightsWidth[HILO_AREA_LIGHTS];\\n    uniform vec3 u_areaLightsHeight[HILO_AREA_LIGHTS];\\n    uniform sampler2D u_areaLightsLtcTexture1;\\n    uniform sampler2D u_areaLightsLtcTexture2;\\n\\n    \"+n(109)+\"\\n#endif\\n\\n#ifdef HILO_AMBIENT_LIGHTS\\n    uniform vec3 u_ambientLightsColor;\\n#endif\\n\\n\"+n(61)+\"\\n\"+n(62)+\"\\n\"+n(63)+\"\\n\"+n(64)+\"\\n\"+n(65)},function(t,e){t.exports=\"#define GLSLIFY 1\\nvec4 textureEnvMap(sampler2D texture, vec3 position){\\n    return texture2D(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI));\\n}\\n\\nvec4 textureEnvMap(samplerCube texture, vec3 position){\\n    return textureCube(texture, position);\\n}\\n\\nvec4 textureEnvMapIncludeMipmapsLod(sampler2D texture, vec3 position, float lod){\\n    lod = floor(lod);\\n    vec2 uv = vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI);\\n\\n    float scale = pow(2.0, lod);\\n\\n    return texture2D(texture, vec2(uv.x / scale, (uv.y / scale / 2.0) + 1.0 - 1.0/pow(2.0, lod)));\\n}\\n\\n#ifdef HILO_USE_SHADER_TEXTURE_LOD\\n    vec4 textureEnvMapLod(sampler2D texture, vec3 position, float lod){\\n        return texture2DLodEXT(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI), lod);\\n    }\\n\\n    vec4 textureEnvMapLod(samplerCube texture, vec3 position, float lod){\\n        return textureCubeLodEXT(texture, position, lod);\\n    }\\n#endif\\n\\n\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_TRANSPARENCY_MAP\\n    uniform HILO_SAMPLER_2D u_transparency;\\n#else\\n    uniform float u_transparency;\\n#endif\\n\\n#ifdef HILO_ALPHA_CUTOFF\\n    uniform float u_alphaCutoff;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_FOG\\n    varying float v_dist;\\n    uniform vec4 u_fogColor;\\n    \\n    #ifdef HILO_FOG_LINEAR\\n        uniform vec2 u_fogInfo;\\n    #else\\n        uniform float u_fogInfo;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_NORMAL_MAP\\n    vec3 normal = HILO_TEXTURE_2D(u_normalMap).rgb * 2.0 - 1.0;\\n    #ifdef HILO_NORMAL_MAP_SCALE\\n        normal.xy *= u_normalMapScale;\\n    #endif\\n    normal = normalize(v_TBN * normal);\\n#elif defined(HILO_HAS_NORMAL)\\n    vec3 normal = normalize(v_normal);\\n#else\\n    vec3 normal = vec3(0, 0, 1);\\n#endif\\n\\n#ifdef HILO_HAS_CLEARCOAT\\n    #ifdef HILO_CLEARCOAT_NORMAL_MAP\\n        vec3 clearcoatNormal = HILO_TEXTURE_2D(u_clearcoatNormalMap).rgb * 2.0 - 1.0;\\n        clearcoatNormal = normalize(v_TBN * clearcoatNormal);\\n    #elif defined(HILO_HAS_NORMAL)\\n        vec3 clearcoatNormal = normalize(v_normal);\\n    #else\\n        vec3 clearcoatNormal = vec3(0, 0, 1);\\n    #endif\\n#endif\\n\\n#if HILO_SIDE == HILO_BACK_SIDE\\n    normal = -normal;\\n    #ifdef HILO_HAS_CLEARCOAT\\n        clearcoatNormal = -clearcoatNormal;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_LIGHT\\n    #if HILO_SIDE == HILO_FRONT_AND_BACK_SIDE\\n        normal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat transparency = 1.0;\\n#ifdef HILO_TRANSPARENCY_MAP\\n    transparency = HILO_TEXTURE_2D(u_transparency).r;\\n#else\\n    transparency = u_transparency;\\n#endif\\ncolor.a *= transparency;\\n#ifdef HILO_ALPHA_CUTOFF\\n    if (color.a < u_alphaCutoff) {\\n        discard;\\n    } else {\\n        color.a = 1.0;\\n    }\\n#endif\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_IGNORE_TRANSPARENT\\ncolor.a = 1.0;\\n#endif\\n\\n#ifdef HILO_USE_HDR\\n    color.rgb = vec3(1.0) - exp(-color.rgb * u_exposure);\\n#endif\\n\\n#ifdef HILO_GAMMA_CORRECTION\\n    color.rgb = pow(color.rgb, vec3(1.0 / u_gammaFactor));\\n#endif\\n\\n\"+n(70)+\"\\n\\n#ifdef HILO_PREMULTIPLY_ALPHA\\n    color.rgb *= color.a;\\n#endif\\n\\ngl_FragColor = color;\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n\"},function(t,e){t.exports=\"#ifdef GL_ES\\nprecision HILO_MAX_VERTEX_PRECISION float;\\n#define GLSLIFY 1\\n#endif\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(24)+\"\\n\"+n(18)+\"\\n\"+n(25)+\"\\n\\n\"+n(38)+\"\\n\"+n(39)+\"\\n\"+n(40)+\"\\n\"+n(41)+\"\\n\"+n(59)+\"\\n\"+n(42)+\"\\n\"+n(66)+\"\\n\"+n(44)+\"\\n\"+n(45)+\"\\n\"+n(28)+\"\\n\\nvoid main(void) {\\n    vec4 diffuse = vec4(0., 0., 0., 1.);\\n    vec4 color = vec4(0., 0., 0., 1.);\\n\\n    \"+n(46)+\"\\n    \"+n(47)+\"\\n    \"+n(68)+\"\\n    \"+n(69)+\"\\n    \"+n(48)+\"\\n    \"+n(49)+\"\\n    \"+n(29)+\"\\n}\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(50)+\"\\n\"+n(18)+\"\\n\"+n(51)+\"\\n\\nattribute vec3 a_position;\\nuniform mat4 u_modelViewProjectionMatrix;\\n\\n\"+n(71)+\"\\n\"+n(72)+\"\\n\"+n(73)+\"\\n\"+n(74)+\"\\n\"+n(75)+\"\\n\"+n(76)+\"\\n\"+n(77)+\"\\n\"+n(78)+\"\\nvoid main(void) {\\n    vec4 pos = vec4(a_position, 1.0);\\n    #ifdef HILO_HAS_TEXCOORD0\\n        vec2 uv = a_texcoord0;\\n    #endif\\n    #ifdef HILO_HAS_TEXCOORD1\\n        vec2 uv1 = a_texcoord1;\\n    #endif\\n    #ifdef HILO_HAS_NORMAL\\n        vec3 normal = a_normal;\\n    #endif\\n\\n    #if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\\n        vec4 tangent = a_tangent;\\n    #endif\\n\\n    \"+n(79)+\"\\n    \"+n(80)+\"\\n    \"+n(81)+\"\\n    \"+n(82)+\"\\n    \"+n(83)+\"\\n    \"+n(84)+\"\\n    \"+n(85)+\"\\n\\n    gl_Position = u_modelViewProjectionMatrix * pos;\\n\\n    \"+n(86)+\"\\n}\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(24)+\"\\n\"+n(18)+\"\\n\"+n(25)+\"\\n\\n#if defined(HILO_VERTEX_TYPE_POSITION)\\n    varying vec3 v_fragPos;\\n#elif defined(HILO_VERTEX_TYPE_NORMAL)\\n    varying vec3 v_normal;\\n#elif defined(HILO_VERTEX_TYPE_DEPTH)\\n    uniform float u_cameraFar;\\n    uniform float u_cameraNear;\\n    uniform float u_cameraType;\\n#elif defined(HILO_VERTEX_TYPE_DISTANCE)\\n    \"+n(87)+\"\\n\\n    uniform float u_cameraFar;\\n    uniform float u_cameraNear;\\n    varying vec3 v_fragPos;\\n#endif\\n\\nvec4 transformDataToColor(vec3 data){\\n    #ifdef HILO_WRITE_ORIGIN_DATA\\n        return vec4(data, 1.0);\\n    #else\\n        return vec4(data * 0.5 + 0.5, 1.0);\\n    #endif\\n}\\n\\n\"+n(28)+\"\\n\\nvoid main(void) {\\n    #if defined(HILO_VERTEX_TYPE_POSITION)\\n        gl_FragColor = transformDataToColor(v_fragPos);\\n    #elif defined(HILO_VERTEX_TYPE_NORMAL)\\n        gl_FragColor = transformDataToColor(v_normal);\\n    #elif defined(HILO_VERTEX_TYPE_DEPTH)\\n        float z;\\n        #ifdef HILO_WRITE_ORIGIN_DATA\\n            z = gl_FragCoord.z;\\n        #else\\n            // OrthographicCamera\\n            if(u_cameraType < 1.0){\\n                z = gl_FragCoord.z;\\n            }\\n            // PerspectiveCamera\\n            else{\\n                z = gl_FragCoord.z * 2.0 - 1.0;\\n                z = (2.0 * u_cameraNear * u_cameraFar) / (u_cameraFar + u_cameraNear - z * (u_cameraFar - u_cameraNear));\\n            }\\n        #endif\\n        gl_FragColor = vec4(z, z, z, 1.0);\\n    #elif defined(HILO_VERTEX_TYPE_DISTANCE)\\n        float distance = length(v_fragPos);\\n        #ifdef HILO_WRITE_ORIGIN_DATA\\n            gl_FragColor = vec4(distance, distance, distance, 1.0);\\n        #else\\n            gl_FragColor = packFloat((distance - u_cameraNear)/(u_cameraFar - u_cameraNear));\\n        #endif\\n    #endif\\n    \"+n(29)+\"\\n}\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(24)+\"\\n\"+n(18)+\"\\n\"+n(25)+\"\\n\\n\"+n(38)+\"\\n\"+n(39)+\"\\n\"+n(40)+\"\\n\"+n(41)+\"\\n\"+n(88)+\"\\n\"+n(42)+\"\\n\"+n(44)+\"\\n\"+n(45)+\"\\n\"+n(28)+\"\\n\\nvoid main(void) {\\n    vec4 color = vec4(0., 0., 0., 1.);\\n\\n    \"+n(46)+\"\\n    \"+n(47)+\"\\n    \"+n(90)+\"\\n    \"+n(49)+\"\\n    \"+n(29)+\"\\n}\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(24)+\"\\n\"+n(18)+\"\\n\"+n(25)+\"\\n\\nvarying vec2 v_texcoord0;\\nuniform sampler2D u_diffuse;\\n\\nvoid main(void) {  \\n    gl_FragColor = texture2D(u_diffuse, v_texcoord0);\\n}\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(50)+\"\\n\"+n(18)+\"\\n\"+n(51)+\"\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texcoord0;\\nvarying vec2 v_texcoord0;\\n\\n\\nvoid main(void) {\\n    vec4 pos = vec4(a_position, 0.0, 1.0);\\n    gl_Position = pos;\\n    v_texcoord0 = a_texcoord0;\\n}\"},function(t,e,n){var r=n(37),i=function(){function t(){return+new Date}return r.create({constructor:function(t,e,n,r){var i=this;for(var a in i.target=t,i._startTime=0,i._seekTime=0,i._pausedTime=0,i._pausedStartTime=0,i._reverseFlag=1,i._repeatCount=0,3==arguments.length&&(r=n,n=e,e=null),r)i[a]=r[a];i._fromProps=e,i._toProps=n,!r.duration&&r.time&&(i.duration=r.time||0,i.time=0)},target:null,duration:1e3,delay:0,paused:!1,loop:!1,reverse:!1,repeat:0,repeatDelay:0,ease:null,time:0,isStart:!1,isComplete:!1,onStart:null,onUpdate:null,onComplete:null,setProps:function(t,e){var n=this.target,r=t||e,i=this._fromProps={},a=this._toProps={};for(var s in t=t||n,e=e||n,r)a[s]=e[s]||0,n[s]=i[s]=t[s]||0;return this},start:function(){var e=this;return e._startTime=t()+e.delay,e._seekTime=0,e._pausedTime=0,e._reverseFlag=1,e._repeatCount=0,e.paused=!1,e.isStart=!1,e.isComplete=!1,i.add(e),e},stop:function(){return i.remove(this),this},pause:function(){return this.paused=!0,this._pausedStartTime=t(),this},resume:function(){var e=this;return e.paused=!1,e._pausedStartTime&&(e._pausedTime+=t()-e._pausedStartTime),e._pausedStartTime=0,e},seek:function(e,n){var r=this,a=t();return r._startTime=a,r._seekTime=e,r._pausedTime=0,void 0!==n&&(r.paused=n),r._update(a,!0),i.add(r),r},link:function(t){var e,n,r=t.delay,a=this._startTime;return\"string\"==typeof r&&(e=0==r.indexOf(\"+\"),n=0==r.indexOf(\"-\"),r=e||n?Number(r.substr(1))*(e?1:-1):Number(r)),t.delay=r,t._startTime=e||n?a+this.duration+r:a+r,this._next=t,i.remove(t),t},_render:function(t){var e,n=this.target,r=this._fromProps;for(e in r)n[e]=r[e]+(this._toProps[e]-r[e])*t},_update:function(e,n){var r=this;if(!r.paused||n){if(r.isComplete)return!0;var a=e-r._startTime-r._pausedTime+r._seekTime;if(!(a<0)){var s,o=a/r.duration;o=o<=0?0:o>=1?1:o;var u=r.ease?r.ease(o):o;r.reverse&&r.isStart&&(r._reverseFlag<0&&(o=1-o,u=1-u),o<1e-7&&(r.repeat>0&&r._repeatCount++>=r.repeat||0==r.repeat&&!r.loop?r.isComplete=!0:(r._startTime=t(),r._pausedTime=0,r._reverseFlag*=-1))),r.isStart||(r.setProps(r._fromProps,r._toProps),r.isStart=!0,r.onStart&&r.onStart.call(r,r)),r.time=a,r._render(u),(s=r.onUpdate)&&s.call(r,u,r),o>=1&&(r.reverse?(r._startTime=t(),r._pausedTime=0,r._reverseFlag*=-1):r.loop||r.repeat>0&&r._repeatCount++<r.repeat?(r._startTime=t()+r.repeatDelay,r._pausedTime=0):r.isComplete=!0);var c=r._next;if(c&&c.time<=0){var h=c._startTime;h>0&&h<=e?(c._render(o),c.time=a,i.add(c)):r.isComplete&&(h<0||h>e)&&c.start()}return r.isComplete?((s=r.onComplete)&&s.call(r,r),!0):void 0}}},Statics:{_tweens:[],tick:function(){var e,n,r=i._tweens,a=r.length;for(n=0;n<a;n++)(e=r[n])&&e._update(t())&&(r.splice(n,1),n--);return i},add:function(t){var e=i._tweens;return-1==e.indexOf(t)&&e.push(t),i},remove:function(t){var e,n;if(t instanceof Array){for(e=0,n=t.length;e<n;e++)i.remove(t[e]);return i}var r=i._tweens;if(t instanceof i)(e=r.indexOf(t))>-1&&r.splice(e,1);else for(e=0;e<r.length;e++)r[e].target===t&&(r.splice(e,1),e--);return i},removeAll:function(){return i._tweens.length=0,i},fromTo:function(t,e,n,r){r=r||{};var a=t instanceof Array;t=a?t:[t];var s,o,u=r.stagger,c=[];for(o=0;o<t.length;o++)s=new i(t[o],e,n,r),u&&(s.delay=(r.delay||0)+(o*u||0)),s.start(),c.push(s);return a?c:s},to:function(t,e,n){return i.fromTo(t,null,e,n)},from:function(t,e,n){return i.fromTo(t,e,null,n)}}})}();t.exports=i},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_DIFFUSE_MAP)\\n    uniform HILO_SAMPLER_2D u_diffuse;\\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\\n    uniform samplerCube u_diffuse;\\n#else\\n    uniform vec4 u_diffuse;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat transpose(float m) {\\n  return m;\\n}\\n\\nmat2 transpose(mat2 m) {\\n  return mat2(m[0][0], m[1][0],\\n              m[0][1], m[1][1]);\\n}\\n\\nmat3 transpose(mat3 m) {\\n  return mat3(m[0][0], m[1][0], m[2][0],\\n              m[0][1], m[1][1], m[2][1],\\n              m[0][2], m[1][2], m[2][2]);\\n}\\n\\nmat4 transpose(mat4 m) {\\n  return mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\n              m[0][1], m[1][1], m[2][1], m[3][1],\\n              m[0][2], m[1][2], m[2][2], m[3][2],\\n              m[0][3], m[1][3], m[2][3], m[3][3]);\\n}\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat getDiffuse(vec3 normal, vec3 lightDir){\\n    return max(dot(normal, lightDir), 0.0);\\n}\\n\\n\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat getSpecular(vec3 cameraPos, vec3 fragPos, vec3 lightDir, vec3 normal, float shininess){\\n    vec3 viewDir = normalize(cameraPos - fragPos);\\n    #ifdef LIGHT_TYPE_PHONG\\n        return pow(max(dot(viewDir, reflect(-lightDir, normal), 0.0), shininess);\\n    #else\\n        return pow(max(dot(normal, normalize(lightDir + viewDir)), 0.0), shininess);\\n    #endif\\n}\\n\\n\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat getLightAttenuation(vec3 distanceVec, vec3 info, float range){\\n    float distance = length(distanceVec);\\n    float attenuation = 1.0;\\n    #ifdef HILO_USE_PHYSICS_LIGHT\\n        attenuation = max(1.0 / (distance * distance), 0.001);\\n        if (range > 0.0) {\\n            attenuation *= max(min(1.0 - pow( distance / range, 4.0 ), 1.0), 0.0);\\n        }\\n    #else\\n        attenuation = 1.0/(info.x + info.y * distance + info.z * distance * distance);\\n    #endif\\n\\n    return attenuation;\\n}\\n\\n\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nfloat unpackFloat(vec4 rgbaDepth) {\\n    const vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\\n    float depth = dot(rgbaDepth, bitShift);\\n    return depth;\\n}\\n\\n\"},function(t,e){t.exports=\"#define GLSLIFY 1\\nbool isOutOfRange(vec2 pos) {\\n    if (pos.x < 0.0 || pos.x > 1.0 || pos.y < 0.0 || pos.y > 1.0) {\\n        return true;\\n    }\\n    return false;\\n}\\n\\nfloat getShadow(sampler2D shadowMap, vec2 shadowMapSize, float bias, vec3 fragPos, mat4 lightSpaceMatrix) {\\n    vec4 fragPosLightSpace = lightSpaceMatrix * vec4(fragPos, 1.0);\\n    vec3 projCoords = fragPosLightSpace.xyz / fragPosLightSpace.w;\\n    projCoords = projCoords * 0.5 + 0.5;\\n    if (isOutOfRange(projCoords.xy)) {\\n        return 1.0;\\n    }\\n    float currentDepth = projCoords.z;\\n    float shadow = 0.0;\\n    vec2 texelSize = 1.0 / shadowMapSize;\\n    for (int x = -1; x <= 1; ++x) {\\n        for (int y = -1; y <= 1; ++y) {\\n            vec2 pos = projCoords.xy + vec2(x, y) * texelSize;\\n            if (isOutOfRange(pos)) {\\n                shadow += 1.0;\\n            } else {\\n                float pcfDepth = texture2D(shadowMap, pos).r;\\n                shadow += currentDepth - bias > pcfDepth ? 1.0 : 0.0;\\n            }\\n        }\\n    }\\n    return 1.0 - shadow / 9.0;\\n}\\n\\nfloat getShadow(samplerCube shadowMap, float bias, vec3 lightPos, vec3 position, vec2 camera, mat4 lightSpaceMatrix) {\\n    vec4 distanceVec = lightSpaceMatrix * vec4(position, 1.0) - lightSpaceMatrix * vec4(lightPos, 1.0);\\n    float currentDistance = length(distanceVec);\\n    vec3 direction = normalize(distanceVec).xyz;\\n\\n    float shadow = 0.0;\\n    const float samples = 2.0;\\n    const float offset = 0.01;\\n    const float step = offset / (samples * 0.5);\\n    for(float x = -offset; x < offset; x +=step)\\n    {\\n        for(float y = -offset; y < offset; y +=step)\\n        {\\n            for(float z = -offset; z < offset; z +=step)\\n            {\\n                float closestDistance = camera[0] + (camera[1] - camera[0]) * unpackFloat(textureCube(shadowMap, direction + vec3(x, y, z)));\\n                if (closestDistance == camera[0]) {\\n                    continue;\\n                }\\n                else if(currentDistance - bias > closestDistance)\\n                    shadow += 1.0;\\n            }\\n        }\\n    }\\n    shadow /= (samples * samples * samples);\\n\\n    return 1.0 - shadow;\\n}\\n\\n\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(43)+\"\\n\"+n(67)+\"\\n\\n#ifdef HILO_HAS_LIGHT\\n    #ifdef HILO_HAS_SPECULAR\\n        uniform float u_shininess;\\n        #ifdef HILO_SPECULAR_MAP\\n            uniform HILO_SAMPLER_2D u_specular;\\n        #else\\n            uniform vec4 u_specular;\\n        #endif\\n    #endif\\n    #ifdef HILO_EMISSION_MAP\\n        uniform HILO_SAMPLER_2D u_emission;\\n    #else\\n        uniform vec4 u_emission;\\n    #endif\\n    #ifdef HILO_AMBIENT_MAP\\n        uniform HILO_SAMPLER_2D u_ambient;\\n    #endif\\n    #ifdef HILO_SPECULAR_ENV_MAP\\n        #ifdef HILO_SPECULAR_ENV_MAP_CUBE\\n            uniform samplerCube u_specularEnvMap;\\n        #else\\n            uniform sampler2D u_specularEnvMap;\\n        #endif\\n        uniform mat4 u_specularEnvMatrix;\\n        uniform float u_reflectivity;\\n        uniform float u_refractRatio;\\n        uniform float u_refractivity;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_FIX_MAX_BUG\\n    float hilo_max(float a, float b){\\n        if (a > b) {\\n            return a;\\n        }\\n        return b;\\n    }\\n    #define HILO_MAX(a, b) hilo_max(a, b);\\n#else\\n    #define HILO_MAX(a, b) max(a, b);\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_DIFFUSE_MAP)\\n    diffuse = HILO_TEXTURE_2D(u_diffuse);\\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\\n    diffuse = textureCube(u_diffuse, v_position);\\n#elif defined(HILO_HAS_COLOR)\\n    diffuse = v_color;\\n#else\\n    diffuse = u_diffuse;\\n#endif\\ncolor.a = diffuse.a;\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_LIGHT\\n    vec3 lightDiffuse = vec3(0, 0, 0);\\n    vec3 lightAmbient = vec3(0, 0, 0);\\n    vec3 viewPos = vec3(0, 0, 0);\\n\\n    #ifdef HILO_AMBIENT_MAP\\n        lightAmbient = HILO_TEXTURE_2D(u_ambient).rgb;\\n    #else\\n        lightAmbient = diffuse.rgb;\\n    #endif\\n\\n    #ifdef HILO_HAS_SPECULAR\\n        vec3 lightSpecular = vec3(0, 0, 0);\\n        #ifdef HILO_SPECULAR_MAP\\n            vec4 specular = HILO_TEXTURE_2D(u_specular);\\n        #else\\n            vec4 specular = u_specular;\\n        #endif\\n    #endif\\n    \\n    #ifdef HILO_EMISSION_MAP\\n        vec4 emission = HILO_TEXTURE_2D(u_emission);\\n    #else\\n        vec4 emission = u_emission;\\n    #endif\\n\\n    #ifdef HILO_DIRECTIONAL_LIGHTS\\n        for(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\\n            vec3 lightDir = -u_directionalLightsInfo[i];\\n\\n            float shadow = 1.0;\\n            #ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\n                if (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_directionalLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\\n                }\\n            #endif\\n\\n            float diff = getDiffuse(normal, lightDir);\\n            lightDiffuse += diff * u_directionalLightsColor[i] * shadow;\\n\\n            #ifdef HILO_HAS_SPECULAR\\n                float spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\n                lightSpecular += spec * u_directionalLightsColor[i] * shadow;\\n            #endif\\n        }\\n    #endif\\n\\n    #ifdef HILO_SPOT_LIGHTS\\n        for(int i = 0; i < HILO_SPOT_LIGHTS; i++){\\n            vec3 lightDir = -u_spotLightsDir[i];\\n            vec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\\n\\n            float shadow = 1.0;\\n            #ifdef HILO_SPOT_LIGHTS_SMC\\n                if (i < HILO_SPOT_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_spotLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\\n                }\\n            #endif\\n            \\n            float diff = getDiffuse(normal, normalize(distanceVec));\\n            float theta = dot(normalize(distanceVec), lightDir);\\n            float epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\\n            float intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\\n            float attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\\n\\n            lightDiffuse += intensity * attenuation * shadow * diff * u_spotLightsColor[i];\\n\\n            #ifdef HILO_HAS_SPECULAR\\n                float spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\n                lightSpecular += intensity * attenuation * shadow * spec * u_spotLightsColor[i];\\n            #endif\\n        }\\n    #endif\\n\\n    #ifdef HILO_POINT_LIGHTS\\n        for(int i = 0;i < HILO_POINT_LIGHTS;i++){\\n            vec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\\n            vec3 lightDir = normalize(distanceVec);\\n\\n            float shadow = 1.0;\\n            #ifdef HILO_POINT_LIGHTS_SMC\\n                if (i < HILO_POINT_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\\n                }\\n            #endif\\n            \\n            float diff = getDiffuse(normal, lightDir);\\n            float attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\\n            lightDiffuse += diff * attenuation * u_pointLightsColor[i] * shadow;\\n\\n            #ifdef HILO_HAS_SPECULAR\\n                float spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\n                lightSpecular += spec * attenuation * u_pointLightsColor[i] * shadow;\\n            #endif\\n        }\\n    #endif\\n\\n    #ifdef HILO_AREA_LIGHTS\\n        #ifndef HILO_HAS_SPECULAR\\n            vec4 specular = vec4(0.0, 0.0, 0.0, 0.0);\\n        #endif\\n        vec3 viewDir = normalize(vec3(0, 0, 0) - v_fragPos);\\n        for(int i = 0; i < HILO_AREA_LIGHTS; i++){\\n            color.rgb += getAreaLight(diffuse.rgb, specular.rgb, sqrt(2.0/(u_shininess+2.0)), normal, viewDir, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\\n        }\\n    #endif\\n\\n    #ifdef HILO_AMBIENT_LIGHTS\\n        color.rgb += u_ambientLightsColor * lightAmbient;\\n    #endif\\n\\n    #if defined(HILO_SPECULAR_ENV_MAP) && defined(HILO_HAS_SPECULAR)\\n        vec3 I = normalize(v_fragPos - viewPos);\\n        if (u_reflectivity > 0.0) {\\n            vec3 R = reflect(I, normal);\\n            R = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\\n            lightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_reflectivity;\\n        }\\n        if (u_refractivity > 0.0) {\\n            vec3 R = refract(I, normal, u_refractRatio);\\n            R = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\\n            lightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_refractivity;\\n        }\\n    #endif\\n\\n    color.rgb += lightDiffuse * diffuse.rgb;\\n    #ifdef HILO_HAS_SPECULAR\\n        color.rgb += lightSpecular * specular.rgb;\\n    #endif\\n\\n    color.rgb += emission.rgb;\\n#else\\n    color = diffuse;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_FOG\\n    float fogFactor = 1.0;\\n\\n    #ifdef HILO_FOG_LINEAR\\n        fogFactor = (u_fogInfo.y - v_dist)/(u_fogInfo.y - u_fogInfo.x);\\n    #elif defined(HILO_FOG_EXP)\\n        fogFactor = exp(-abs(u_fogInfo * v_dist));\\n    #elif defined(HILO_FOG_EXP2)\\n        fogFactor = exp(-(u_fogInfo * v_dist) * (u_fogInfo * v_dist)); \\n    #endif\\n    \\n    fogFactor = clamp(fogFactor, 0.0, 1.0);\\n    color = mix(u_fogColor, color, fogFactor);\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_QUANTIZED\\n    #ifdef HILO_POSITION_QUANTIZED\\n        uniform mat4 u_positionDecodeMat;\\n    #endif\\n    #ifdef HILO_NORMAL_QUANTIZED\\n        uniform mat4 u_normalDecodeMat;\\n    #endif\\n    #ifdef HILO_UV_QUANTIZED\\n        uniform mat3 u_uvDecodeMat;\\n    #endif\\n    #ifdef HILO_UV1_QUANTIZED\\n        uniform mat3 u_uv1DecodeMat;\\n    #endif\\n\\n    vec2 unQuantize(vec2 data, mat3 decodeMat) {\\n        vec3 result = vec3(data, 1.0);\\n        result = decodeMat * result;\\n        return result.xy;\\n    }\\n\\n    vec3 unQuantize(vec3 data, mat4 decodeMat) {\\n        vec4 result = vec4(data, 1.0);\\n        result = decodeMat * result;\\n        return result.xyz;\\n    }\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_JOINT_COUNT\\n    attribute vec4 a_skinIndices;\\n    attribute vec4 a_skinWeights;\\n    #ifdef HILO_JOINT_MAT_MAP\\n        uniform sampler2D u_jointMatTexture;\\n        uniform vec2 u_jointMatTextureSize;\\n        mat4 getJointMat(float index) {\\n            index *= 4.0;\\n            float x = float(mod(index, u_jointMatTextureSize.x));\\n            float y = float(floor(index / u_jointMatTextureSize.x));\\n            float dx = 1.0 / float(u_jointMatTextureSize.x);\\n            float dy = 1.0 / float(u_jointMatTextureSize.y);\\n            y = dy * (y + 0.5);\\n            vec4 v1 = texture2D(u_jointMatTexture, vec2(dx * (x + 0.5), y));\\n            vec4 v2 = texture2D(u_jointMatTexture, vec2(dx * (x + 1.5), y));\\n            vec4 v3 = texture2D(u_jointMatTexture, vec2(dx * (x + 2.5), y));\\n            vec4 v4 = texture2D(u_jointMatTexture, vec2(dx * (x + 3.5), y));\\n            mat4 mat = mat4(v1, v2, v3, v4);\\n            return mat;\\n        }\\n\\n        mat4 getJointMat(vec4 weights, vec4 indices) {\\n            mat4 mat = weights.x * getJointMat(indices.x);\\n            mat += weights.y * getJointMat(indices.y);\\n            mat += weights.z * getJointMat(indices.z);\\n            mat += weights.w * getJointMat(indices.w);\\n            return mat;\\n        }\\n    #else\\n        uniform mat4 u_jointMat[HILO_JOINT_COUNT];\\n       \\n        mat4 getJointMat(vec4 weights, vec4 indices) {\\n            mat4 mat = weights.x * u_jointMat[int(indices.x)];\\n            mat += weights.y * u_jointMat[int(indices.y)];\\n            mat += weights.z * u_jointMat[int(indices.z)];\\n            mat += weights.w * u_jointMat[int(indices.w)];\\n            return mat;\\n        }\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\n    attribute vec2 a_texcoord0;\\n    varying vec2 v_texcoord0;\\n    #ifdef HILO_UV_MATRIX\\n        uniform mat3 u_uvMatrix;\\n    #endif\\n#endif\\n\\n#ifdef HILO_HAS_TEXCOORD1\\n    attribute vec2 a_texcoord1;\\n    varying vec2 v_texcoord1;\\n    #ifdef HILO_UV_MATRIX1\\n        uniform mat3 u_uvMatrix1;\\n    #endif\\n#endif\\n\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\n    varying vec3 v_position;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\n    attribute vec3 a_normal;\\n    uniform mat3 u_normalMatrix;\\n    varying vec3 v_normal;\\n\\n    #if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\\n        attribute vec4 a_tangent;\\n        varying mat3 v_TBN;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\\n    uniform mat4 u_modelViewMatrix;\\n    #ifdef HILO_HAS_FOG\\n        varying float v_dist;\\n    #endif\\n\\n    #if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS) \\n        varying vec3 v_fragPos;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_MORPH_TARGET_COUNT\\n    uniform float u_morphWeights[HILO_MORPH_TARGET_COUNT];\\n\\n    #if HILO_MORPH_TARGET_COUNT > 0\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition0;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal0;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent0;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 1\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition1;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal1;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent1;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 2\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition2;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal2;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent2;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 3\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition3;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal3;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent3;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 4\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition4;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal4;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent4;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 5\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition5;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal5;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent5;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 6\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition6;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal6;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent6;\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 7\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            attribute vec3 a_morphPosition7;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            attribute vec3 a_morphNormal7;\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            attribute vec3 a_morphTangent7;\\n        #endif\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\n    #if HILO_COLOR_SIZE == 3\\n        attribute vec3 a_color;\\n    #elif HILO_COLOR_SIZE == 4\\n        attribute vec4 a_color;\\n    #endif\\n    varying vec4 v_color;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_USE_LOG_DEPTH\\n    #ifdef HILO_USE_EXT_FRAG_DEPTH\\n        varying float v_fragDepth;\\n    #else\\n        uniform float u_logDepth;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\n    #if HILO_COLOR_SIZE == 3\\n        v_color = vec4(a_color, 1.0);\\n    #elif HILO_COLOR_SIZE == 4\\n        v_color = a_color;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_QUANTIZED\\n    #ifdef HILO_POSITION_QUANTIZED\\n        pos.xyz = unQuantize(pos.xyz, u_positionDecodeMat);\\n    #endif\\n    #if defined(HILO_HAS_TEXCOORD0) && defined(HILO_UV_QUANTIZED)\\n        uv = unQuantize(uv, u_uvDecodeMat);\\n    #endif\\n    #if defined(HILO_HAS_TEXCOORD1) && defined(HILO_UV1_QUANTIZED)\\n        uv1 = unQuantize(uv1, u_uv1DecodeMat);\\n    #endif\\n    #if defined(HILO_HAS_NORMAL) && defined(HILO_NORMAL_QUANTIZED)\\n        normal = unQuantize(normal, u_normalDecodeMat);\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_MORPH_TARGET_COUNT\\n    #if HILO_MORPH_TARGET_COUNT > 0\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition0 * u_morphWeights[0];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal0 * u_morphWeights[0];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent0 * u_morphWeights[0];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 1\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition1 * u_morphWeights[1];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal1 * u_morphWeights[1];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent1 * u_morphWeights[1];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 2\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition2 * u_morphWeights[2];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal2 * u_morphWeights[2];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent2 * u_morphWeights[2];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 3\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition3 * u_morphWeights[3];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal3 * u_morphWeights[3];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent3 * u_morphWeights[3];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 4\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition4 * u_morphWeights[4];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal4 * u_morphWeights[4];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent4 * u_morphWeights[4];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 5\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition5 * u_morphWeights[5];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal5 * u_morphWeights[5];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent5 * u_morphWeights[5];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 6\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition6 * u_morphWeights[6];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal6 * u_morphWeights[6];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent6 * u_morphWeights[6];\\n        #endif\\n    #endif\\n\\n    #if HILO_MORPH_TARGET_COUNT > 7\\n        #ifdef HILO_MORPH_HAS_POSITION\\n            pos.xyz += a_morphPosition7 * u_morphWeights[7];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\n            normal += a_morphNormal7 * u_morphWeights[7];\\n        #endif\\n        #if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\n            tangent.xyz += a_morphTangent7 * u_morphWeights[7];\\n        #endif\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_JOINT_COUNT\\n    mat4 skinMat = getJointMat(a_skinWeights, a_skinIndices);\\n    pos = skinMat * pos;\\n\\n    #ifdef HILO_HAS_NORMAL\\n        normal = mat3(skinMat) * normal;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\n    #ifdef HILO_UV_MATRIX\\n        v_texcoord0 = (u_uvMatrix * vec3(uv, 1.0)).xy;\\n    #else\\n        v_texcoord0 = uv;\\n    #endif\\n#endif\\n#ifdef HILO_HAS_TEXCOORD1\\n    #ifdef HILO_UV_MATRIX1\\n        v_texcoord1 = (u_uvMatrix1 * vec3(uv1, 1.0)).xy;\\n    #else\\n        v_texcoord1 = uv1;\\n    #endif\\n#endif\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\n    v_position = pos.xyz;\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\n    #if defined(HILO_NORMAL_MAP) || defined(HILO_CLEARCOAT_NORMAL_MAP)\\n        vec3 T = normalize(u_normalMatrix * tangent.xyz);\\n        vec3 N = normalize(u_normalMatrix * normal);\\n        T = normalize(T - dot(T, N) * N);\\n        vec3 B = cross(N, T) * tangent.w;\\n        v_TBN = mat3(T, B, N);\\n    #endif\\n    v_normal = normalize(u_normalMatrix * normal);\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\\n    vec3 fragPos = (u_modelViewMatrix * pos).xyz;\\n\\n    #if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\\n        v_fragPos = fragPos;\\n    #endif\\n\\n    #ifdef HILO_HAS_FOG\\n        v_dist = length(fragPos);\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n#ifdef HILO_USE_LOG_DEPTH\\n    #ifdef HILO_USE_EXT_FRAG_DEPTH\\n        v_fragDepth = 1.0 + gl_Position.w;\\n    #else\\n        gl_Position.z = log2( max( 1e-6, gl_Position.w + 1.0 ) ) * u_logDepth - 1.0;\\n        gl_Position.z *= gl_Position.w;\\n    #endif\\n#endif\"},function(t,e){t.exports=\"#define GLSLIFY 1\\n// https://github.com/playcanvas/engine/blob/master/src/graphics/program-lib/chunks/packDepth.frag\\n// Packing a float in GLSL with multiplication and mod\\n// http://blog.gradientstudios.com/2012/08/23/shadow-map-improvement\\nvec4 packFloat(float depth) {\\n    const vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\\n    const vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\\n\\n    // combination of mod and multiplication and division works better\\n    vec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\\n    res -= res.xxyz * bit_mask;\\n    return res;\\n}\\n\\n\\n\\n\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n\"+n(43)+\"\\n\"+n(89)+\"\\n\"+n(67)+'\\n\\nuniform vec4 u_baseColor;\\n#ifdef HILO_BASE_COLOR_MAP\\n    uniform HILO_SAMPLER_2D u_baseColorMap;\\n#endif\\n\\n#ifdef HILO_NEED_WORLD_NORMAL\\n    uniform mat3 u_viewInverseNormalMatrix;\\n#endif\\n\\n#ifdef HILO_HAS_LIGHT\\n    uniform float u_metallic;\\n    #ifdef HILO_METALLIC_MAP\\n        uniform HILO_SAMPLER_2D u_metallicMap;\\n    #endif\\n        uniform float u_roughness;\\n    #ifdef HILO_ROUGHNESS_MAP\\n        uniform HILO_SAMPLER_2D u_roughnessMap;\\n    #endif\\n    #ifdef HILO_METALLIC_ROUGHNESS_MAP\\n        uniform HILO_SAMPLER_2D u_metallicRoughnessMap;\\n    #endif\\n    #ifdef HILO_OCCLUSION_MAP\\n        uniform HILO_SAMPLER_2D u_occlusionMap;\\n    #endif\\n\\n    #ifdef HILO_OCCLUSION_STRENGTH\\n        uniform float u_occlusionStrength;\\n    #endif\\n\\n    #ifdef HILO_DIFFUSE_ENV_MAP\\n        #ifdef HILO_DIFFUSE_ENV_MAP_CUBE\\n            uniform samplerCube u_diffuseEnvMap;\\n        #else\\n            uniform sampler2D u_diffuseEnvMap;\\n        #endif\\n        uniform float u_diffuseEnvIntensity;\\n    #elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\n        uniform vec3 u_diffuseEnvSphereHarmonics3[9];\\n        uniform float u_diffuseEnvIntensity;\\n    #endif\\n    #ifdef HILO_SPECULAR_ENV_MAP\\n        uniform sampler2D u_brdfLUT;\\n        #ifdef HILO_SPECULAR_ENV_MAP_CUBE\\n            uniform samplerCube u_specularEnvMap;\\n        #else\\n            uniform sampler2D u_specularEnvMap;\\n        #endif\\n        uniform float u_specularEnvIntensity;\\n\\n        uniform float u_specularEnvMapMipCount;\\n    #endif\\n\\n    #ifdef HILO_EMISSION_MAP\\n        uniform HILO_SAMPLER_2D u_emission;\\n    #endif\\n\\n    #ifdef HILO_PBR_SPECULAR_GLOSSINESS\\n        uniform vec4 u_specular;\\n        uniform float u_glossiness;\\n        #ifdef HILO_SPECULAR_GLOSSINESS_MAP\\n            uniform HILO_SAMPLER_2D u_specularGlossinessMap;\\n        #endif\\n    #endif\\n\\n    #ifdef HILO_LIGHT_MAP\\n        uniform HILO_SAMPLER_2D u_lightMap;\\n    #endif\\n\\n    #ifdef HILO_HAS_CLEARCOAT\\n        uniform float u_clearcoatFactor;\\n        #ifdef HILO_CLEARCOAT_MAP\\n            uniform HILO_SAMPLER_2D u_clearcoatMap;\\n        #endif\\n\\n        uniform float u_clearcoatRoughnessFactor;\\n        #ifdef HILO_CLEARCOAT_ROUGHNESS_MAP\\n            uniform HILO_SAMPLER_2D u_clearcoatRoughnessMap;\\n        #endif\\n    #endif\\n\\n\\n    // PBR Based on https://github.com/KhronosGroup/glTF-WebGL-PBR\\n\\n    // Basic Lambertian diffuse\\n    // Implementation from Lambert\\'s Photometria https://archive.org/details/lambertsphotome00lambgoog\\n    // See also [1], Equation 1\\n    vec3 diffuse(vec3 diffuseColor) {\\n        return diffuseColor * HILO_INVERSE_PI;\\n    }\\n\\n    // The following equation models the Fresnel reflectance term of the spec equation (aka F())\\n    // Implementation of fresnel from [4], Equation 15\\n    vec3 specularReflection(vec3 reflectance0, vec3 reflectance90, float VdotH) {\\n        return reflectance0 + (reflectance90 - reflectance0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\\n    }\\n\\n    // This calculates the specular geometric attenuation (aka G()),\\n    // where rougher material will reflect less light back to the viewer.\\n    // This implementation is based on [1] Equation 4, and we adopt their modifications to\\n    // alphaRoughness as input as originally proposed in [2].\\n    float geometricOcclusion(float NdotL, float NdotV, float alphaRoughness) {\\n        float r = alphaRoughness * alphaRoughness;\\n\\n        float attenuationL = 2.0 * NdotL / (NdotL + sqrt(r + (1.0 - r) * (NdotL * NdotL)));\\n        float attenuationV = 2.0 * NdotV / (NdotV + sqrt(r + (1.0 - r) * (NdotV * NdotV)));\\n        return attenuationL * attenuationV;\\n    }\\n\\n    // The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\\n    // Implementation from \"Average Irregularity Representation of a Roughened Surface for Ray Reflection\" by T. S. Trowbridge, and K. P. Reitz\\n    // Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\\n    float microfacetDistribution(float alphaRoughness, float NdotH) {\\n        float roughnessSq = alphaRoughness * alphaRoughness;\\n        float f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\\n        return roughnessSq * HILO_INVERSE_PI / (f * f);\\n    }\\n\\n    vec3 computeDiffuseSHLight(vec3 normal, in vec3 sh[9]) {\\n        return sh[0] +\\n            sh[1] * (normal.y) +\\n            sh[2] * (normal.z) +\\n            sh[3] * (normal.x) +\\n            sh[4] * (normal.y * normal.x) +\\n            sh[5] * (normal.y * normal.z) +\\n            sh[6] * ((3.0 * normal.z * normal.z) - 1.0) +\\n            sh[7] * (normal.z * normal.x) +\\n            sh[8] * (normal.x * normal.x - (normal.y * normal.y));\\n    }\\n\\n    // https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Vendor/EXT_lights_image_based/README.md#rgbd\\n    vec3 decodeRGBD(in vec4 color){\\n        return color.rgb / color.a;\\n    }\\n\\n    vec3 getIBLClearCoatContribution(in vec3 N, in vec3 V, vec3 diffuseColor, vec3 specularColor, float ao, float NdotV, float perceptualRoughness) {\\n        vec3 color = vec3(.0, .0, .0);\\n        #ifdef HILO_SPECULAR_ENV_MAP\\n            vec3 R = -normalize(reflect(V, N));\\n            vec3 brdf = texture2D(u_brdfLUT, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\\n            #ifdef HILO_IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS\\n                float lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\n                vec4 specularEnvMap = textureEnvMapIncludeMipmapsLod(u_specularEnvMap, R, lod);\\n            #elif HILO_USE_SHADER_TEXTURE_LOD\\n                float lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\n                vec4 specularEnvMap = textureEnvMapLod(u_specularEnvMap, R, lod);\\n            #else\\n                vec4 specularEnvMap = textureEnvMap(u_specularEnvMap, R);\\n            #endif\\n\\n            vec3 specularLight = decodeRGBD(specularEnvMap);\\n\\n            #ifdef HILO_GAMMA_CORRECTION\\n                specularLight = sRGBToLinear(specularLight);\\n            #endif\\n            color.rgb += specularLight * (specularColor * brdf.x + brdf.y) * u_specularEnvIntensity;\\n        #endif\\n        return color;\\n    }\\n\\n    vec3 getIBLContribution(in vec3 N, in vec3 V, vec3 diffuseColor, vec3 specularColor, float ao, float NdotV, float perceptualRoughness) {\\n        vec3 color = vec3(.0, .0, .0);\\n        #ifdef HILO_NEED_WORLD_NORMAL\\n        N = u_viewInverseNormalMatrix * N;\\n        V = u_viewInverseNormalMatrix * V;\\n        #endif\\n        #if defined(HILO_DIFFUSE_ENV_MAP) || defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\n            #ifdef HILO_DIFFUSE_ENV_MAP\\n                #ifdef HILO_GAMMA_CORRECTION\\n                    vec3 diffuseLight = sRGBToLinear(textureEnvMap(u_diffuseEnvMap, N)).rgb;\\n                #else\\n                    vec3 diffuseLight = textureEnvMap(u_diffuseEnvMap, N).rgb;\\n                #endif\\n            #elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\n                vec3 diffuseLight = computeDiffuseSHLight(N, u_diffuseEnvSphereHarmonics3);\\n            #endif\\n            color.rgb += diffuseLight * diffuseColor * ao * u_diffuseEnvIntensity;\\n        #endif\\n\\n        #ifdef HILO_SPECULAR_ENV_MAP\\n            vec3 R = -normalize(reflect(V, N));\\n            vec3 brdf = texture2D(u_brdfLUT, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\\n            #ifdef HILO_IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS\\n                float lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\n                vec4 specularEnvMap = textureEnvMapIncludeMipmapsLod(u_specularEnvMap, R, lod);\\n            #elif HILO_USE_SHADER_TEXTURE_LOD\\n                float lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\n                vec4 specularEnvMap = textureEnvMapLod(u_specularEnvMap, R, lod);\\n            #else\\n                vec4 specularEnvMap = textureEnvMap(u_specularEnvMap, R);\\n            #endif\\n\\n            vec3 specularLight = decodeRGBD(specularEnvMap);\\n\\n            #ifdef HILO_GAMMA_CORRECTION\\n                specularLight = sRGBToLinear(specularLight);\\n            #endif\\n            color.rgb += specularLight * (specularColor * brdf.x + brdf.y) * u_specularEnvIntensity;\\n        #endif\\n        return color;\\n    }\\n\\n    vec3 calculateLo(vec3 N, vec3 V, vec3 L, vec3 reflectance0, vec3 reflectance90, float alphaRoughness, vec3 diffuseColor, float NdotV) {\\n        vec3 H = normalize(L + V);\\n        float NdotL = clamp(dot(N, L), 0.001, 1.0);\\n        float NdotH = clamp(dot(N, H), 0.0, 1.0);\\n        float LdotH = clamp(dot(L, H), 0.0, 1.0);\\n        float VdotH = clamp(dot(V, H), 0.0, 1.0);\\n        // Calculate the shading terms for the microfacet specular shading model\\n        vec3 F = specularReflection(reflectance0, reflectance90, VdotH);\\n        float G = geometricOcclusion(NdotL, NdotV, alphaRoughness);\\n        float D = microfacetDistribution(alphaRoughness, NdotH);\\n\\n        vec3 diffuseContrib;\\n\\n        #ifdef HILO_LIGHT_MAP\\n            diffuseContrib = vec3(0.0);\\n        #else\\n            diffuseContrib = (1.0 - F) * diffuse(diffuseColor);\\n        #endif\\n        vec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\\n        // Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\\n        return NdotL * (diffuseContrib + specContrib);\\n    }\\n\\n    #ifdef HILO_HAS_CLEARCOAT\\n        float calculateClearcoatBRDF(vec3 N, vec3 V, vec3 L, float clearcoatAlphaRoughness, float NdotV) {\\n            vec3 H = normalize(L + V);\\n            float NdotL = clamp(dot(N, L), 0.001, 1.0);\\n            float NdotH = clamp(dot(N, H), 0.0, 1.0);\\n            float VdotH = clamp(dot(V, H), 0.0, 1.0);\\n\\n            float G = geometricOcclusion(NdotL, NdotV, clearcoatAlphaRoughness);\\n            float D = microfacetDistribution(clearcoatAlphaRoughness, NdotH);\\n\\n            float clearcoatLayer = G * D / (4.0 * NdotV);\\n\\n            return clearcoatLayer;\\n        }\\n    #endif\\n#endif'},function(t,e){t.exports=\"#define GLSLIFY 1\\nvec4 sRGBToLinear( in vec4 value ) {\\n    return vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\n\\nvec3 sRGBToLinear( in vec3 value ) {\\n    return vec3( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ));\\n}\\n\\n\"},function(t,e,n){t.exports=\"#define GLSLIFY 1\\nvec4 baseColor = u_baseColor;\\n\\n#ifdef HILO_BASE_COLOR_MAP\\n    #ifdef HILO_GAMMA_CORRECTION\\n        baseColor *= sRGBToLinear(HILO_TEXTURE_2D(u_baseColorMap));\\n    #else\\n        baseColor *= HILO_TEXTURE_2D(u_baseColorMap);\\n    #endif\\n#endif\\n\\n#if defined(HILO_HAS_COLOR)\\n    baseColor *= v_color;\\n#endif\\n\\ncolor.a = baseColor.a;\\n\\n\"+n(48)+\"\\n\\n#ifdef HILO_HAS_LIGHT\\n    vec3 viewPos = vec3(0, 0, 0);\\n    vec3 N = normal;\\n    vec3 V = normalize(viewPos - v_fragPos);\\n\\n    #ifdef HILO_OCCLUSION_MAP\\n        float ao  = HILO_TEXTURE_2D(u_occlusionMap).r;\\n    #else\\n        float ao = 1.0;\\n    #endif\\n\\n    #ifdef HILO_PBR_SPECULAR_GLOSSINESS\\n        vec3 specular = u_specular.rgb;\\n        float glossiness = u_glossiness;\\n        #ifdef HILO_SPECULAR_GLOSSINESS_MAP\\n            vec4 specularGlossiness = sRGBToLinear(HILO_TEXTURE_2D(u_specularGlossinessMap));\\n            specular = specularGlossiness.rgb * specular;\\n            glossiness = specularGlossiness.a * glossiness;\\n        #endif\\n        float roughness = 1.0 - glossiness;\\n        float metallic = 0.0;\\n        vec3 diffuseColor = baseColor.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\\n        vec3 specularColor = specular;\\n    #else\\n        float metallic = u_metallic;\\n        float roughness = u_roughness;\\n        #ifdef HILO_METALLIC_MAP\\n            metallic = HILO_TEXTURE_2D(u_metallicMap).r * u_metallic;\\n        #endif\\n        #ifdef HILO_ROUGHNESS_MAP\\n            roughness  = HILO_TEXTURE_2D(u_roughnessMap).r * u_roughness;\\n        #endif\\n        #ifdef HILO_METALLIC_ROUGHNESS_MAP\\n            vec4 metallicRoughnessMap = HILO_TEXTURE_2D(u_metallicRoughnessMap);\\n            #ifdef HILO_IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP\\n                ao = metallicRoughnessMap.r;\\n            #endif\\n            roughness = metallicRoughnessMap.g * u_roughness;\\n            metallic = metallicRoughnessMap.b * u_metallic;\\n        #endif\\n        roughness = clamp(roughness, 0.04, 1.0);\\n        metallic = clamp(metallic, 0.0, 1.0);\\n        vec3 f0 = vec3(0.04);\\n        vec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\\n        diffuseColor *= 1.0 - metallic;\\n        vec3 specularColor = mix(f0, baseColor.rgb, metallic);\\n    #endif\\n\\n    #ifdef HILO_OCCLUSION_STRENGTH\\n        ao = mix(1.0, ao, u_occlusionStrength);\\n    #endif\\n\\n    float reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\\n    // For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\\n    // For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\\n    float reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\\n    vec3 specularEnvironmentR0 = specularColor.rgb;\\n    vec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\\n\\n    float NdotV = clamp(abs(dot(N, V)), 0.001, 1.0);\\n    float alphaRoughness = roughness * roughness;\\n\\n    #ifdef HILO_HAS_CLEARCOAT\\n        float clearcoatFactor = u_clearcoatFactor;\\n        #ifdef HILO_CLEARCOAT_MAP\\n            clearcoatFactor *= HILO_TEXTURE_2D(u_clearcoatMap).r;\\n        #endif\\n        float clearcoatRoughnessFactor = u_clearcoatRoughnessFactor;\\n        #ifdef HILO_CLEARCOAT_ROUGHNESS_MAP\\n            clearcoatRoughnessFactor *= HILO_TEXTURE_2D(u_clearcoatRoughnessMap).g;\\n        #endif\\n\\n        float clearcoatAlphaRoughnessFactor = clearcoatRoughnessFactor * clearcoatRoughnessFactor;\\n        vec3 NC = clearcoatNormal;\\n        float NCdotV = clamp(abs(dot(NC, V)), 0.001, 1.0);\\n        float clearCoatFresnel = 0.04 + (1.0 - 0.04) * pow((1.0 - abs(NCdotV)),5.0);\\n        vec3 clearCoatLayer = vec3(0.0);\\n    #endif\\n\\n    #ifdef HILO_DIRECTIONAL_LIGHTS\\n        for(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\\n            vec3 lightDir = normalize(-u_directionalLightsInfo[i]);\\n            vec3 radiance = u_directionalLightsColor[i];\\n            float shadow = 1.0;\\n            #ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\n                if (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_directionalLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\\n                }\\n            #endif\\n            #ifdef HILO_HAS_CLEARCOAT\\n                clearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\\n            #endif\\n            color.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n        }\\n    #endif\\n\\n    #ifdef HILO_SPOT_LIGHTS\\n        for(int i = 0; i < HILO_SPOT_LIGHTS; i++){\\n            vec3 lightDir = normalize(-u_spotLightsDir[i]);\\n            vec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\\n\\n            float theta = dot(normalize(distanceVec), lightDir);\\n            float epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\\n            float intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\\n            float attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\\n            vec3 radiance = intensity * attenuation * u_spotLightsColor[i];\\n\\n            float shadow = 1.0;\\n            #ifdef HILO_SPOT_LIGHTS_SMC\\n                if (i < HILO_SPOT_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_spotLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\\n                }\\n            #endif\\n            #ifdef HILO_HAS_CLEARCOAT\\n                clearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\\n            #endif\\n            color.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n        }\\n    #endif\\n\\n    #ifdef HILO_POINT_LIGHTS\\n        for(int i = 0; i < HILO_POINT_LIGHTS; i++){\\n            vec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\\n            vec3 lightDir = normalize(distanceVec);\\n\\n            float shadow = 1.0;\\n            #ifdef HILO_POINT_LIGHTS_SMC\\n                if (i < HILO_POINT_LIGHTS_SMC) {\\n                    float bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\\n                    shadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\\n                }\\n            #endif\\n\\n            float attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\\n            vec3 radiance = attenuation * u_pointLightsColor[i];\\n\\n            #ifdef HILO_HAS_CLEARCOAT\\n                clearCoatLayer += shadow * radiance * calculateClearcoatBRDF(NC, V, lightDir, clearcoatAlphaRoughnessFactor, NCdotV);\\n            #endif\\n            color.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n        }\\n    #endif\\n\\n    #ifdef HILO_AREA_LIGHTS\\n        for(int i = 0; i < HILO_AREA_LIGHTS; i++){\\n            color.rgb += getAreaLight(diffuseColor, specularColor, roughness, N, V, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\\n        }\\n    #endif\\n\\n    #ifdef HILO_LIGHT_MAP\\n        vec4 lightMapColor = HILO_TEXTURE_2D(u_lightMap);\\n        // https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_lights_image_based#rgbd\\n        color.rgb += baseColor.rgb * decodeRGBD(lightMapColor);\\n    #endif\\n\\n    // IBL\\n    #ifdef HILO_HAS_CLEARCOAT\\n        clearCoatLayer += getIBLClearCoatContribution(NC, V, diffuseColor, vec3(.04), ao, NCdotV, clearcoatRoughnessFactor)/clearCoatFresnel;\\n    #endif\\n    color.rgb += getIBLContribution(N, V, diffuseColor, specularColor, ao, NdotV, roughness);\\n\\n    #if defined(HILO_AMBIENT_LIGHTS) && (defined(HILO_IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER) || (!defined(HILO_DIFFUSE_ENV_MAP) && !defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)))\\n        color.rgb += u_ambientLightsColor * baseColor.rgb * ao;\\n    #endif\\n\\n    #ifdef HILO_EMISSION_MAP\\n        #ifdef HILO_GAMMA_CORRECTION\\n            color.rgb += sRGBToLinear(HILO_TEXTURE_2D(u_emission)).rgb;\\n        #else\\n            color.rgb += HILO_TEXTURE_2D(u_emission).rgb;\\n        #endif\\n    #endif\\n\\n    #ifdef HILO_HAS_CLEARCOAT\\n        float t = clearcoatFactor * clearCoatFresnel;\\n        color.rgb = color.rgb * (1.0 - t) + clearCoatLayer * t;\\n    #endif\\n#else\\n    color = baseColor;\\n#endif\"},function(t,e,n){var r=n(92),i=n(26),a=n(30),s=[0,0,0],o=[0,0,0],u=[0,0,0],c=[0,0,0],h=[0,0,0];t.exports=function(t,e,n,f){a(s,f[1],f[0]),a(o,f[2],f[0]),r(c,n,o);var l=i(s,c);if(l<1e-6)return null;a(u,e,f[0]);var d=i(u,c);if(d<0||d>l)return null;r(h,u,s);var m=i(n,h);if(m<0||d+m>l)return null;var _=i(o,h)/l;return t[0]=e[0]+_*n[0],t[1]=e[1]+_*n[1],t[2]=e[2]+_*n[2],t}},function(t,e){t.exports=function(t,e,n){var r=e[0],i=e[1],a=e[2],s=n[0],o=n[1],u=n[2];return t[0]=i*u-a*o,t[1]=a*s-r*u,t[2]=r*o-i*s,t}},function(t,e,n){var r=n(26),i=n(31),a=n(32),s=n(33);t.exports=function(t,e,n,u,c){var h=r(n,u);if(0!==h){var f=-(r(e,u)+c)/h;return f<0?null:(a(o,n,f),i(t,e,o))}return r(u,e)+c===0?s(t,e):null};var o=[0,0,0]},function(t,e,n){var r=n(95),i=n(26),a=n(30),s=n(96),o=n(32),u=n(31),c=[0,0,0];t.exports=function(t,e,n,h,f){a(c,h,e);var l=i(n,c);if(l<0)return null;s(c,e,n,l);var d=r(h,c),m=f*f;if(d>m)return null;return o(t,n,l-Math.sqrt(m-d)),u(t,t,e)}},function(t,e){t.exports=function(t,e){var n=e[0]-t[0],r=e[1]-t[1],i=e[2]-t[2];return n*n+r*r+i*i}},function(t,e){t.exports=function(t,e,n,r){return t[0]=e[0]+n[0]*r,t[1]=e[1]+n[1]*r,t[2]=e[2]+n[2]*r,t}},function(t,e){function n(t,e,n){for(var r=t.length,i=-1/0,a=1/0,s=0;s<r;s++){var o=(n[0][s]-t[s])/e[s],u=(n[1][s]-t[s])/e[s];if(o>u){var c=o;o=u,u=c}if(u<i||o>a)return 1/0;o>i&&(i=o),u<a&&(a=u)}return i>a?1/0:i}t.exports=function(t,e,r,i){var a=n(e,r,i);if(a===1/0)t=null;else{t=t||[];for(var s=0;s<e.length;s++)t[s]=e[s]+r[s]*a}return t},t.exports.distance=n},function(t,e,n){\"use strict\";\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;function s(t){if(null==t)throw new TypeError(\"Object.assign cannot be called with null or undefined\");return Object(t)}t.exports=function(){try{if(!Object.assign)return!1;var t=new String(\"abc\");if(t[5]=\"de\",\"5\"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e[\"_\"+String.fromCharCode(n)]=n;if(\"0123456789\"!==Object.getOwnPropertyNames(e).map((function(t){return e[t]})).join(\"\"))return!1;var r={};return\"abcdefghijklmnopqrst\".split(\"\").forEach((function(t){r[t]=t})),\"abcdefghijklmnopqrst\"===Object.keys(Object.assign({},r)).join(\"\")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,o,u=s(t),c=1;c<arguments.length;c++){for(var h in n=Object(arguments[c]))i.call(n,h)&&(u[h]=n[h]);if(r){o=r(n);for(var f=0;f<o.length;f++)a.call(n,o[f])&&(u[o[f]]=n[o[f]])}}return u}},function(t,e,n){\"use strict\";var r,i,a,s;Object.keys||(Object.keys=(r=Object.prototype.hasOwnProperty,i=!{toString:null}.propertyIsEnumerable(\"toString\"),s=(a=[\"toString\",\"toLocaleString\",\"valueOf\",\"hasOwnProperty\",\"isPrototypeOf\",\"propertyIsEnumerable\",\"constructor\"]).length,function(t){if(\"object\"!=typeof t&&(\"function\"!=typeof t||null===t))throw new TypeError(\"Object.keys called on non-object\");var e,n,o=[];for(e in t)r.call(t,e)&&o.push(e);if(i)for(n=0;n<s;n++)r.call(t,a[n])&&o.push(a[n]);return o}))},function(t,e,n){\"use strict\";t.exports=function(t){return Object.keys(t).map((function(e){return t[e]}))}},function(t,e,n){\"use strict\";t.exports=\"function\"==typeof Promise?Promise:n(105)},function(t,e){var n=function(){function t(t,e,n,r,i){return t=t||{},e&&(t.EaseIn=e),n&&(t.EaseOut=n),r&&(t.EaseInOut=r),i&&(t.EaseNone=i),t}var e=t(null,null,null,null,(function(t){return t})),n=t(null,(function(t){return t*t}),(function(t){return-t*(t-2)}),(function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)})),r=t(null,(function(t){return t*t*t}),(function(t){return--t*t*t+1}),(function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)})),i=t(null,(function(t){return t*t*t*t}),(function(t){return-(--t*t*t*t-1)}),(function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)})),a=t(null,(function(t){return t*t*t*t*t}),(function(t){return(t-=1)*t*t*t*t+1}),(function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)})),s=Math,o=s.PI,u=.5*o,c=s.sin,h=s.cos,f=s.pow,l=s.sqrt,d=t(null,(function(t){return 1-h(t*u)}),(function(t){return c(t*u)}),(function(t){return-.5*(h(o*t)-1)})),m=t(null,(function(t){return 0==t?0:f(2,10*(t-1))}),(function(t){return 1==t?1:1-f(2,-10*t)}),(function(t){return 0==t||1==t?t:(t*=2)<1?.5*f(2,10*(t-1)):.5*(2-f(2,-10*(t-1)))})),_=t(null,(function(t){return-(l(1-t*t)-1)}),(function(t){return l(1- --t*t)}),(function(t){return(t/=.5)<1?-.5*(l(1-t*t)-1):.5*(l(1-(t-=2)*t)+1)})),p=t({a:1,p:.4,s:.1,config:function(t,e){p.a=t,p.p=e,p.s=e/(2*o)*Math.asin(1/t)||0}},(function(t){return-p.a*f(2,10*(t-=1))*c((t-p.s)*(2*o)/p.p)}),(function(t){return p.a*f(2,-10*t)*c((t-p.s)*(2*o)/p.p)+1}),(function(t){return(t*=2)<1?p.a*f(2,10*(t-=1))*c((t-p.s)*(2*o)/p.p)*-.5:p.a*f(2,-10*(t-=1))*c((t-p.s)*(2*o)/p.p)*.5+1})),g=t({o:1.70158,s:2.59491,config:function(t){g.o=t,g.s=1.525*t}},(function(t){return t*t*((g.o+1)*t-g.o)}),(function(t){return(t-=1)*t*((g.o+1)*t+g.o)+1}),(function(t){return(t*=2)<1?t*t*((g.s+1)*t-g.s)*.5:.5*((t-=2)*t*((g.s+1)*t+g.s)+2)})),v=t(null,(function(t){return 1-v.EaseOut(1-t)}),(function(t){return(t/=1)<.36364?7.5625*t*t:t<.72727?7.5625*(t-=.54545)*t+.75:t<.90909?7.5625*(t-=.81818)*t+.9375:7.5625*(t-=.95455)*t+.984375}),(function(t){return t<.5?.5*v.EaseIn(2*t):.5*v.EaseOut(2*t-1)+.5}));return{Linear:e,Quad:n,Cubic:r,Quart:i,Quint:a,Sine:d,Expo:m,Circ:_,Elastic:p,Back:g,Bounce:v}}();t.exports=n},function(t,e){t.exports=function(t){t instanceof ArrayBuffer&&(t=new Uint8Array(t));var e=0,n=t.length;function r(){var r=\"\";do{var i=t[e];if(10==i){++e;break}r+=String.fromCharCode(i)}while(++e<n);return r}for(var i=0,a=0,s=1,o=!1,u=0;u<20;u++){var c,h=r();if(c=h.match(\"#\\\\?RADIANCE\"));else if(c=h.match(\"FORMAT=32-bit_rle_rgbe\"))o=!0;else if(c=h.match(\"EXPOSURE=\\\\s*([0-9]*[.][0-9]*)\"))s=Number(c[1]);else if(c=h.match(\"#.*\"));else if(c=h.match(\"-Y ([0-9]+) \\\\+X ([0-9]+)\")){a=Number(c[1]),i=Number(c[2]);break}}if(!o)throw new Error(\"File is not run length encoded!\");var f=new Uint8Array(i*a*4);!function(t,e,n,r,i,a){var s,o,u,c=new Array(4),h=null,f=new Array(2),l=t.length;function d(e){var n=0;do{e[n++]=t[r]}while(++r<l&&n<e.length);return n}function m(e,n,i){var a=0;do{e[n+a++]=t[r]}while(++r<l&&a<i);return a}function _(t,e,n,r){var i=4*r,a=m(e,n,i);if(a<i)throw new Error(\"Error reading raw pixels: got \"+a+\" bytes, expected \"+i)}for(;a>0;){if(d(c)<c.length)throw new Error(\"Error reading bytes: expected \"+c.length);if(2!=c[0]||2!=c[1]||0!=(128&c[2]))return e[n++]=c[0],e[n++]=c[1],e[n++]=c[2],e[n++]=c[3],void _(0,e,n,i*a-1);if(((255&c[2])<<8|255&c[3])!=i)throw new Error(\"Wrong scanline width \"+((255&c[2])<<8|255&c[3])+\", expected \"+i);null==h&&(h=new Array(4*i)),s=0;for(var p=0;p<4;p++)for(o=(p+1)*i;s<o;){if(d(f)<f.length)throw new Error(\"Error reading 2-byte buffer\");if((255&f[0])>128){if(0==(u=(255&f[0])-128)||u>o-s)throw new Error(\"Bad scanline data\");for(;u-- >0;)h[s++]=f[1]}else{if(0==(u=255&f[0])||u>o-s)throw new Error(\"Bad scanline data\");if(h[s++]=f[1],--u>0){if(m(h,s,u)<u)throw new Error(\"Error reading non-run data\");s+=u}}}for(p=0;p<i;p++)e[n+0]=h[p],e[n+1]=h[p+i],e[n+2]=h[p+2*i],e[n+3]=h[p+3*i],n+=4;a--}}(t,f,0,e,i,a);for(var l=new Float32Array(i*a*4),d=0;d<f.length;d+=4){var m=f[d+0]/255,_=f[d+1]/255,p=f[d+2]/255,g=f[d+3],v=Math.pow(2,g-128);m*=v,_*=v,p*=v;var E=d;l[E+0]=m,l[E+1]=_,l[E+2]=p,l[E+3]=1}return{shape:[i,a],exposure:s,gamma:1,data:l}}},function(t,e,n){\"use strict\";n.r(e);var r=n(98),i=n.n(r),a=n(99),s=n.n(a),o=n(100),u=n.n(o),c=n(101),h=n.n(c);Object.assign||(Object.assign=i.a),Object.keys||(Object.keys=s.a),Object.values||(Object.values=u.a),\"undefined\"==typeof Promise&&(window.Promise=h.a),[Int8Array,Uint8Array,Int16Array,Uint16Array,Uint32Array,Float32Array].forEach((function(t){t.prototype.slice||Object.defineProperty(t.prototype,\"slice\",{value:function(e,n){return new t(Array.prototype.slice.call(this,e,n))}})}))},function(t,e,n){\"use strict\";(function(e,n){var r,i=function(){},a=void 0!==e&&void 0!==e.process&&\"function\"==typeof e.process.emit,s=void 0===n?setTimeout:n,o=[];function u(){for(var t=0;t<o.length;t++)o[t][0](o[t][1]);o=[],r=!1}function c(t,e){o.push([t,e]),r||(r=!0,s(u,0))}function h(t){var e=t.owner,n=e._state,r=e._data,i=t[n],a=t.then;if(\"function\"==typeof i){n=\"fulfilled\";try{r=i(r)}catch(t){m(a,t)}}f(a,r)||(\"fulfilled\"===n&&l(a,r),\"rejected\"===n&&m(a,r))}function f(t,e){var n;try{if(t===e)throw new TypeError(\"A promises callback cannot return that same promise.\");if(e&&(\"function\"==typeof e||\"object\"==typeof e)){var r=e.then;if(\"function\"==typeof r)return r.call(e,(function(r){n||(n=!0,e===r?d(t,r):l(t,r))}),(function(e){n||(n=!0,m(t,e))})),!0}}catch(e){return n||m(t,e),!0}return!1}function l(t,e){t!==e&&f(t,e)||d(t,e)}function d(t,e){\"pending\"===t._state&&(t._state=\"settled\",t._data=e,c(p,t))}function m(t,e){\"pending\"===t._state&&(t._state=\"settled\",t._data=e,c(g,t))}function _(t){t._then=t._then.forEach(h)}function p(t){t._state=\"fulfilled\",_(t)}function g(t){t._state=\"rejected\",_(t),!t._handled&&a&&e.process.emit(\"unhandledRejection\",t._data,t)}function v(t){e.process.emit(\"rejectionHandled\",t)}function E(t){if(\"function\"!=typeof t)throw new TypeError(\"Promise resolver \"+t+\" is not a function\");if(this instanceof E==!1)throw new TypeError(\"Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.\");this._then=[],function(t,e){function n(t){m(e,t)}try{t((function(t){l(e,t)}),n)}catch(t){n(t)}}(t,this)}E.prototype={constructor:E,_state:\"pending\",_then:null,_data:void 0,_handled:!1,then:function(t,e){var n={owner:this,then:new this.constructor(i),fulfilled:t,rejected:e};return!e&&!t||this._handled||(this._handled=!0,\"rejected\"===this._state&&a&&c(v,this)),\"fulfilled\"===this._state||\"rejected\"===this._state?c(h,n):this._then.push(n),n.then},catch:function(t){return this.then(null,t)}},E.all=function(t){if(!Array.isArray(t))throw new TypeError(\"You must pass an array to Promise.all().\");return new E((function(e,n){var r=[],i=0;function a(t){return i++,function(n){r[t]=n,--i||e(r)}}for(var s,o=0;o<t.length;o++)(s=t[o])&&\"function\"==typeof s.then?s.then(a(o),n):r[o]=s;i||e(r)}))},E.race=function(t){if(!Array.isArray(t))throw new TypeError(\"You must pass an array to Promise.race().\");return new E((function(e,n){for(var r,i=0;i<t.length;i++)(r=t[i])&&\"function\"==typeof r.then?r.then(e,n):e(r)}))},E.resolve=function(t){return t&&\"object\"==typeof t&&t.constructor===E?t:new E((function(e){e(t)}))},E.reject=function(t){return new E((function(e,n){n(t)}))},t.exports=E}).call(this,n(36),n(106).setImmediate)},function(t,e,n){(function(t){var r=void 0!==t&&t||\"undefined\"!=typeof self&&self||window,i=Function.prototype.apply;function a(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new a(i.call(setTimeout,r,arguments),clearTimeout)},e.setInterval=function(){return new a(i.call(setInterval,r,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},a.prototype.unref=a.prototype.ref=function(){},a.prototype.close=function(){this._clearFn.call(r,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout((function(){t._onTimeout&&t._onTimeout()}),e))},n(107),e.setImmediate=\"undefined\"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate=\"undefined\"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(36))},function(t,e,n){(function(t,e){!function(t,n){\"use strict\";if(!t.setImmediate){var r,i,a,s,o,u=1,c={},h=!1,f=t.document,l=Object.getPrototypeOf&&Object.getPrototypeOf(t);l=l&&l.setTimeout?l:t,\"[object process]\"==={}.toString.call(t.process)?r=function(t){e.nextTick((function(){m(t)}))}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage(\"\",\"*\"),t.onmessage=n,e}}()?t.MessageChannel?((a=new MessageChannel).port1.onmessage=function(t){m(t.data)},r=function(t){a.port2.postMessage(t)}):f&&\"onreadystatechange\"in f.createElement(\"script\")?(i=f.documentElement,r=function(t){var e=f.createElement(\"script\");e.onreadystatechange=function(){m(t),e.onreadystatechange=null,i.removeChild(e),e=null},i.appendChild(e)}):r=function(t){setTimeout(m,0,t)}:(s=\"setImmediate$\"+Math.random()+\"$\",o=function(e){e.source===t&&\"string\"==typeof e.data&&0===e.data.indexOf(s)&&m(+e.data.slice(s.length))},t.addEventListener?t.addEventListener(\"message\",o,!1):t.attachEvent(\"onmessage\",o),r=function(e){t.postMessage(s+e,\"*\")}),l.setImmediate=function(t){\"function\"!=typeof t&&(t=new Function(\"\"+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var i={callback:t,args:e};return c[u]=i,r(u),u++},l.clearImmediate=d}function d(t){delete c[t]}function m(t){if(h)setTimeout(m,0,t);else{var e=c[t];if(e){h=!0;try{!function(t){var e=t.callback,n=t.args;switch(n.length){case 0:e();break;case 1:e(n[0]);break;case 2:e(n[0],n[1]);break;case 3:e(n[0],n[1],n[2]);break;default:e.apply(void 0,n)}}(e)}finally{d(t),h=!1}}}}}(\"undefined\"==typeof self?void 0===t?this:t:self)}).call(this,n(36),n(108))},function(t,e){var n,r,i=t.exports={};function a(){throw new Error(\"setTimeout has not been defined\")}function s(){throw new Error(\"clearTimeout has not been defined\")}function o(t){if(n===setTimeout)return setTimeout(t,0);if((n===a||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n=\"function\"==typeof setTimeout?setTimeout:a}catch(t){n=a}try{r=\"function\"==typeof clearTimeout?clearTimeout:s}catch(t){r=s}}();var u,c=[],h=!1,f=-1;function l(){h&&u&&(h=!1,u.length?c=u.concat(c):f=-1,c.length&&d())}function d(){if(!h){var t=o(l);h=!0;for(var e=c.length;e;){for(u=c,c=[];++f<e;)u&&u[f].run();f=-1,e=c.length}u=null,h=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(t)}}function m(t,e){this.fun=t,this.array=e}function _(){}i.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];c.push(new m(t,e)),1!==c.length||h||o(d)},m.prototype.run=function(){this.fun.apply(null,this.array)},i.title=\"browser\",i.browser=!0,i.env={},i.argv=[],i.version=\"\",i.versions={},i.on=_,i.addListener=_,i.once=_,i.off=_,i.removeListener=_,i.removeAllListeners=_,i.emit=_,i.prependListener=_,i.prependOnceListener=_,i.listeners=function(t){return[]},i.binding=function(t){throw new Error(\"process.binding is not supported\")},i.cwd=function(){return\"/\"},i.chdir=function(t){throw new Error(\"process.chdir is not supported\")},i.umask=function(){return 0}},function(t,e,n){t.exports=\"#define GLSLIFY 1\\n// modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl#L26\\n\\n\"+n(60)+\"\\n\\nvec2 LTC_Uv(const in vec3 N, const in vec3 V, const in float roughness) {\\n    const float LUT_SIZE = 64.0;\\n    const float LUT_SCALE = (LUT_SIZE - 1.0) / LUT_SIZE;\\n    const float LUT_BIAS = 0.5 / LUT_SIZE;\\n    float dotNV = clamp(dot(N, V), 0.0, 1.0);\\n    vec2 uv = vec2(roughness, sqrt(1.0 - dotNV));\\n    uv = (uv * LUT_SCALE) + LUT_BIAS;\\n    return uv;\\n}\\n\\nfloat LTC_ClippedSphereFormFactor(const in vec3 f) {\\n    float l = length(f);\\n    return max(((l * l) + f.z) / (l + 1.0), 0.0);\\n}\\n\\nvec3 LTC_EdgeVectorFormFactor(const in vec3 v1, const in vec3 v2) {\\n    float x = dot(v1, v2);\\n    float y = abs(x);\\n    float a = 0.8543985 + ((0.4965155 + (0.0145206 * y)) * y);\\n    float b = 3.4175940 + ((4.1616724 + y) * y);\\n    float v = a / b;\\n    float theta_sintheta = x > 0.0 ? v : (0.5 * inversesqrt(max(1.0 - (x * x), 1e-7))) - v;\\n    return cross(v1, v2) * theta_sintheta;\\n}\\n\\nvec3 LTC_Evaluate(const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[4]) {\\n    vec3 v1 = rectCoords[1] - rectCoords[0];\\n    vec3 v2 = rectCoords[3] - rectCoords[0];\\n    vec3 lightNormal = cross(v1, v2);\\n    if (dot(lightNormal, P - rectCoords[0]) < 0.0)\\n        return vec3(0.0);\\n    vec3 T1, T2;\\n    T1 = normalize(V - (N * dot(V, N)));\\n    T2 = -cross(N, T1);\\n    mat3 mat = mInv * transpose(mat3(T1, T2, N));\\n    vec3 coords[4];\\n    coords[0] = mat * (rectCoords[0] - P);\\n    coords[1] = mat * (rectCoords[1] - P);\\n    coords[2] = mat * (rectCoords[2] - P);\\n    coords[3] = mat * (rectCoords[3] - P);\\n    coords[0] = normalize(coords[0]);\\n    coords[1] = normalize(coords[1]);\\n    coords[2] = normalize(coords[2]);\\n    coords[3] = normalize(coords[3]);\\n    vec3 vectorFormFactor = vec3(0.0);\\n    vectorFormFactor += LTC_EdgeVectorFormFactor(coords[0], coords[1]);\\n    vectorFormFactor += LTC_EdgeVectorFormFactor(coords[1], coords[2]);\\n    vectorFormFactor += LTC_EdgeVectorFormFactor(coords[2], coords[3]);\\n    vectorFormFactor += LTC_EdgeVectorFormFactor(coords[3], coords[0]);\\n    float result = LTC_ClippedSphereFormFactor(vectorFormFactor);\\n    return vec3(result);\\n}\\n\\nvec3 getAreaLight(const in vec3 diffuseColor, const in vec3 specularColor, const in float roughness, const in vec3 normal, const in vec3 viewDir, const in vec3 position, const in vec3 lightPos, const in vec3 lightColor, const in vec3 halfWidth, const in vec3 halfHeight, const in sampler2D areaLightsLtcTexture1, const in sampler2D areaLightsLtcTexture2){\\n    vec3 rectCoords[4];\\n    rectCoords[0] = (lightPos - halfWidth) - halfHeight;\\n    rectCoords[1] = (lightPos + halfWidth) - halfHeight;\\n    rectCoords[2] = (lightPos + halfWidth) + halfHeight;\\n    rectCoords[3] = (lightPos - halfWidth) + halfHeight;\\n    \\n    vec2 uv = LTC_Uv(normal, viewDir, roughness);\\n    vec4 t1 = texture2D(areaLightsLtcTexture1, uv);\\n    vec4 t2 = texture2D(areaLightsLtcTexture2, uv);\\n\\n    mat3 mInv = mat3(vec3(t1.x, 0, t1.y), vec3(0, 1, 0), vec3(t1.z, 0, t1.w));\\n    vec3 fresnel = (specularColor * t2.x) + ((vec3(1.0) - specularColor) * t2.y);\\n    \\n    vec3 color = vec3(0.0, 0.0, 0.0);\\n    color += ((lightColor * fresnel) * LTC_Evaluate(normal, viewDir, position, mInv, rectCoords));\\n    color += ((lightColor * diffuseColor) * LTC_Evaluate(normal, viewDir, position, mat3(1.0), rectCoords));\\n    return color;\\n}\\n\\n\"},function(t,e,n){\"use strict\";n.r(e),n.d(e,\"util\",(function(){return i})),n.d(e,\"GLTFExtensions\",(function(){return r})),n.d(e,\"Class\",(function(){return a.a})),n.d(e,\"EventMixin\",(function(){return s.a})),n.d(e,\"Fog\",(function(){return ir})),n.d(e,\"Mesh\",(function(){return cr})),n.d(e,\"Node\",(function(){return g})),n.d(e,\"SkinedMesh\",(function(){return dr})),n.d(e,\"Skeleton\",(function(){return _r})),n.d(e,\"Stage\",(function(){return Br})),n.d(e,\"Tween\",(function(){return zr})),n.d(e,\"version\",(function(){return pr})),n.d(e,\"BoxGeometry\",(function(){return Wr})),n.d(e,\"Geometry\",(function(){return Z})),n.d(e,\"GeometryData\",(function(){return C})),n.d(e,\"MorphGeometry\",(function(){return jn})),n.d(e,\"PlaneGeometry\",(function(){return Jr})),n.d(e,\"SphereGeometry\",(function(){return ti})),n.d(e,\"Camera\",(function(){return I})),n.d(e,\"PerspectiveCamera\",(function(){return Q})),n.d(e,\"OrthographicCamera\",(function(){return an})),n.d(e,\"Buffer\",(function(){return xt})),n.d(e,\"capabilities\",(function(){return et})),n.d(e,\"extensions\",(function(){return tt})),n.d(e,\"Framebuffer\",(function(){return ie})),n.d(e,\"glType\",(function(){return Tt})),n.d(e,\"logGLResource\",(function(){return ni})),n.d(e,\"Program\",(function(){return Lt})),n.d(e,\"RenderInfo\",(function(){return gr})),n.d(e,\"RenderList\",(function(){return Mr})),n.d(e,\"VertexArrayObject\",(function(){return Ft})),n.d(e,\"WebGLRenderer\",(function(){return Fr})),n.d(e,\"WebGLResourceManager\",(function(){return Lr})),n.d(e,\"WebGLState\",(function(){return Ar})),n.d(e,\"BasicLoader\",(function(){return oi})),n.d(e,\"CubeTextureLoader\",(function(){return fi})),n.d(e,\"GLTFLoader\",(function(){return Wi})),n.d(e,\"GLTFParser\",(function(){return zi})),n.d(e,\"AliAMCExtension\",(function(){return Wn})),n.d(e,\"HDRLoader\",(function(){return ea})),n.d(e,\"KTXLoader\",(function(){return ia})),n.d(e,\"LoadCache\",(function(){return ii})),n.d(e,\"LoadQueue\",(function(){return aa})),n.d(e,\"ShaderMaterialLoader\",(function(){return oa})),n.d(e,\"TextureLoader\",(function(){return ca})),n.d(e,\"Loader\",(function(){return ci})),n.d(e,\"Texture\",(function(){return Yt})),n.d(e,\"LazyTexture\",(function(){return pi})),n.d(e,\"CubeTexture\",(function(){return fe})),n.d(e,\"DataTexture\",(function(){return ve})),n.d(e,\"Shader\",(function(){return dt})),n.d(e,\"BasicMaterial\",(function(){return Ze})),n.d(e,\"GeometryMaterial\",(function(){return nn})),n.d(e,\"Material\",(function(){return We})),n.d(e,\"PBRMaterial\",(function(){return di})),n.d(e,\"semantic\",(function(){return Pe})),n.d(e,\"ShaderMaterial\",(function(){return Gn})),n.d(e,\"AxisHelper\",(function(){return da})),n.d(e,\"AxisNetHelper\",(function(){return pa})),n.d(e,\"CameraHelper\",(function(){return Ta})),n.d(e,\"AmbientLight\",(function(){return Aa})),n.d(e,\"AreaLight\",(function(){return Oa})),n.d(e,\"DirectionalLight\",(function(){return Pn})),n.d(e,\"CubeLightShadow\",(function(){return Rn})),n.d(e,\"Light\",(function(){return M})),n.d(e,\"LightManager\",(function(){return Rr})),n.d(e,\"LightShadow\",(function(){return ln})),n.d(e,\"PointLight\",(function(){return xn})),n.d(e,\"SpotLight\",(function(){return Fn})),n.d(e,\"Animation\",(function(){return Ci})),n.d(e,\"AnimationStates\",(function(){return Ni})),n.d(e,\"MeshPicker\",(function(){return ya})),n.d(e,\"Ticker\",(function(){return xa})),n.d(e,\"log\",(function(){return m.a})),n.d(e,\"Cache\",(function(){return J})),n.d(e,\"browser\",(function(){return Ur})),n.d(e,\"WebGLSupport\",(function(){return Na})),n.d(e,\"constants\",(function(){return P.a})),n.d(e,\"Color\",(function(){return ba.Color})),n.d(e,\"Euler\",(function(){return ba.Euler})),n.d(e,\"EulerNotifier\",(function(){return ba.EulerNotifier})),n.d(e,\"Frustum\",(function(){return ba.Frustum})),n.d(e,\"math\",(function(){return ba.math})),n.d(e,\"Matrix3\",(function(){return ba.Matrix3})),n.d(e,\"Matrix4\",(function(){return ba.Matrix4})),n.d(e,\"Matrix4Notifier\",(function(){return ba.Matrix4Notifier})),n.d(e,\"Plane\",(function(){return ba.Plane})),n.d(e,\"Quaternion\",(function(){return ba.Quaternion})),n.d(e,\"Ray\",(function(){return ba.Ray})),n.d(e,\"Sphere\",(function(){return ba.Sphere})),n.d(e,\"SphericalHarmonics3\",(function(){return ba.SphericalHarmonics3})),n.d(e,\"Vector2\",(function(){return ba.Vector2})),n.d(e,\"Vector3\",(function(){return ba.Vector3})),n.d(e,\"Vector3Notifier\",(function(){return ba.Vector3Notifier})),n.d(e,\"Vector4\",(function(){return ba.Vector4}));var r={};n.r(r),n.d(r,\"ALI_amc_mesh_compression\",(function(){return Wn})),n.d(r,\"WEB3D_quantized_attributes\",(function(){return Zn})),n.d(r,\"HILO_animation_clips\",(function(){return Kn})),n.d(r,\"ALI_animation_clips\",(function(){return Qn})),n.d(r,\"ALI_bounding_box\",(function(){return Jn})),n.d(r,\"KHR_materials_pbrSpecularGlossiness\",(function(){return $n})),n.d(r,\"KHR_materials_clearcoat\",(function(){return tr})),n.d(r,\"KHR_lights_punctual\",(function(){return er})),n.d(r,\"KHR_techniques_webgl\",(function(){return nr}));var i=n(4),a=n(1),s=n(9),o=n(7),u=n(21),c=n(5),h=n(17),f=n(22),l=n(10),d=n(6),m=n(3),_=new c.a(0,1,0),p=new o.a,g=a.a.create({Statics:{TRAVERSE_STOP_NONE:!1,TRAVERSE_STOP_CHILDREN:1,TRAVERSE_STOP_ALL:!0},Mixes:s.a,isNode:!0,className:\"Node\",name:\"\",anim:null,animationId:\"\",jointName:\"\",autoUpdateWorldMatrix:!0,autoUpdateChildWorldMatrix:!0,parent:null,_quatDirty:!1,_matrixDirty:!1,needCallChildUpdate:!0,visible:!0,pointerEnabled:!0,pointerChildren:!0,useHandCursor:!1,userData:null,__forceUseParentWorldMatrix:!1,constructor:function(t){var e=this;this.id=d.a.generateUUID(this.className),this.up=_.clone(),this.children=[],this.worldMatrix=new o.a,this._matrix=new u.a,this._position=new h.a(0,0,0),this._scale=new h.a(1,1,1),this._pivot=new h.a(0,0,0),this._rotation=new f.a,this._quaternion=new l.a,this._matrix.on(\"update\",(function(){e._onMatrixUpdate()})),this._position.on(\"update\",(function(){e._onPositionUpdate()})),this._scale.on(\"update\",(function(){e._onScaleUpdate()})),this._pivot.on(\"update\",(function(){e._onPivotUpdate()})),this._rotation.on(\"update\",(function(){e._onRotationUpdate()})),this._quaternion.on(\"update\",(function(){e._onQuaternionUpdate()})),Object.assign(this,t)},clone:function(t){var e=new this.constructor;return e.name=this.name,e.jointName=this.jointName,e.animationId=this.animationId,e.setPosition(this.x,this.y,this.z),e.setScale(this.scaleX,this.scaleY,this.scaleZ),e.setRotation(this.rotationX,this.rotationY,this.rotationZ),this.children.forEach((function(t){e.addChild(t.clone(!0))})),t||(this.anim&&(e.anim=this.anim.clone(e)),e.resetSkinedMeshRootNode()),e},setAnim:function(t){return this.anim=t,t.rootNode=this,this},resetSkinedMeshRootNode:function(){var t=this;this.traverse((function(e){e.isSkinedMesh&&e.skeleton&&(e.skeleton.rootNode=t)}),!0)},getChildrenNameMap:function(){var t={};return this.traverse((function(e){t[e.name]=e;var n=e._originName;void 0===n||t[n]||(t[n]=e)}),!0),t},addChild:function(t){return t.parent&&t.removeFromParent(),t.parent=this,this.children.push(t),this},removeChild:function(t){var e=this.children.indexOf(t);return e>-1&&(this.children.splice(e,1),t.parent=null),this},addTo:function(t){return t.addChild(this),this},removeFromParent:function(){return this.parent&&this.parent.removeChild(this),this},updateMatrix:function(){return this._matrixDirty&&(this._matrixDirty=!1,this.matrixVersion++,this._matrix.fromRotationTranslationScaleOrigin(this.quaternion,this._position,this._scale,this._pivot,!0)),this},updateQuaternion:function(){return this._quatDirty&&(this._quatDirty=!1,this._quaternion.fromEuler(this._rotation,!0)),this},updateTransform:function(){return this._matrix.decompose(this._quaternion,this._position,this._scale,this._pivot),this._onQuaternionUpdate(),this._matrixDirty=!1,this},updateMatrixWorld:function(t){return this.traverse((function(e){return(e.autoUpdateWorldMatrix||t)&&(e.parent?e.__forceUseParentWorldMatrix?e.worldMatrix.copy(e.parent.worldMatrix):e.worldMatrix.multiply(e.parent.worldMatrix,e.matrix):e.worldMatrix.copy(e.matrix)),!e.autoUpdateChildWorldMatrix&&!t&&1})),this},getConcatenatedMatrix:function(t){for(var e=new o.a,n=this;n&&n!==t;n=n.parent)e.multiply(n.matrix,e);return e},_traverse:function(t,e){if(!e){var n=t(this);if(n)return n}for(var r=this.children,i=0,a=r.length;i<a;i++){var s=r[i]._traverse(t,!1);if(!0===s)return s}return!1},traverse:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return this._traverse(t,e),this},traverseBFS:function(t){var e,n,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1];for(n=r?this.children:[this];n.length;){e=n,n=[];for(var i=0,a=e.length;i<a;i++){var s=e[i],o=t(s);if(o){if(!0===o)return this}else n=n.concat(s.children)}}return this},getChildByFnBFS:function(t){var e=null;return this.traverseBFS((function(n){return!!t(n)&&(e=n,!0)}),!0),e},getChildByNamePath:function(t){for(var e=this,n=function(n,r){var i=t[n],a=e.getChildByFnBFS((function(t){return t.name===i}));if(!a)return{v:null};e=a},r=0,i=t.length;r<i;r++){var a=n(r);if(\"object\"==typeof a)return a.v}return e},traverseUpdate:function(t){return this.traverse((function(e){return e.onUpdate&&e.onUpdate(t),!e.needCallChildUpdate&&1})),this},getChildByFn:function(t){var e=null;return this.traverse((function(n){return!!t(n)&&(e=n,!0)}),!0),e},getChildrenByFn:function(t){var e=[];return this.traverse((function(n){t(n)&&e.push(n)}),!0),e},getChildByName:function(t){return this.getChildByFn((function(e){return e.name===t}))},getChildrenByName:function(t){return this.getChildrenByFn((function(e){return e.name===t}))},getChildById:function(t){return this.getChildByFn((function(e){return e.id===t}))},getChildrenByClassName:function(t){return this.getChildrenByFn((function(e){return e.className===t}))},getChildrenByBaseClassName:function(t){return this.getChildrenByFn((function(e){return e[\"is\"+t]}))},setScale:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:e;return this._scale.set(t,e,n),this},setPosition:function(t,e,n){return this._position.set(t,e,n),this},setRotation:function(t,e,n){return this._rotation.setDegree(t,e,n),this},setPivot:function(t,e,n){return this._pivot.set(t,e,n),this},lookAt:function(t){return this.isCamera?p.targetTo(this,t,this.up):p.targetTo(t,this,this.up),this._quaternion.fromMat4(p),this},raycast:function(t){var e=this,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!this.visible)return null;var i=[];return this.traverse((function(n){if(r&&!n.pointerEnabled)return 1;if(n.isMesh){var a=n.raycast(t,!1);a&&(i=i.concat(a.map((function(t){return{mesh:n,point:t}}))))}return!(!r||e.pointerChildren)&&1})),i.length?(n&&t.sortPoints(i,\"point\"),i):null},matrix:{get:function(){return this.updateMatrix(),this._matrix},set:function(t){m.a.warnOnce(\"Node.matrix.set\",\"node.matrix is readOnly.Use node.matrix.copy instead.\"),this._matrix.copy(t)}},position:{get:function(){return this._position},set:function(t){m.a.warnOnce(\"Node.position.set\",\"node.position is readOnly.Use node.position.copy instead.\"),this._position.copy(t)}},x:{get:function(){return this._position.elements[0]},set:function(t){this._position.elements[0]=t,this._matrixDirty=!0}},y:{get:function(){return this._position.elements[1]},set:function(t){this._position.elements[1]=t,this._matrixDirty=!0}},z:{get:function(){return this._position.elements[2]},set:function(t){this._position.elements[2]=t,this._matrixDirty=!0}},scale:{get:function(){return this._scale},set:function(t){m.a.warnOnce(\"Node.scale.set\",\"node.scale is readOnly.Use node.scale.copy instead.\"),this._scale.copy(t)}},scaleX:{get:function(){return this._scale.elements[0]},set:function(t){this._scale.elements[0]=t,this._matrixDirty=!0}},scaleY:{get:function(){return this._scale.elements[1]},set:function(t){this._scale.elements[1]=t,this._matrixDirty=!0}},scaleZ:{get:function(){return this._scale.elements[2]},set:function(t){this._scale.elements[2]=t,this._matrixDirty=!0}},pivot:{get:function(){return this._pivot},set:function(t){m.a.warnOnce(\"Node.pivot.set\",\"node.pivot is readOnly.Use node.pivot.copy instead.\"),this._pivot.copy(t)}},pivotX:{get:function(){return this._pivot.elements[0]},set:function(t){this._pivot.elements[0]=t,this._matrixDirty=!0}},pivotY:{get:function(){return this._pivot.elements[1]},set:function(t){this._pivot.elements[1]=t,this._matrixDirty=!0}},pivotZ:{get:function(){return this._pivot.elements[2]},set:function(t){this._pivot.elements[2]=t,this._matrixDirty=!0}},rotation:{get:function(){return this._rotation},set:function(t){m.a.warnOnce(\"Node.rotation.set\",\"node.rotation is readOnly.Use node.rotation.copy instead.\"),this._rotation.copy(t)}},rotationX:{get:function(){return this._rotation.degX},set:function(t){this._rotation.degX=t}},rotationY:{get:function(){return this._rotation.degY},set:function(t){this._rotation.degY=t}},rotationZ:{get:function(){return this._rotation.degZ},set:function(t){this._rotation.degZ=t}},quaternion:{get:function(){return this.updateQuaternion(),this._quaternion},set:function(t){m.a.warnOnce(\"Node.quaternion.set\",\"node.quaternion is readOnly.Use node.quaternion.copy instead.\"),this._quaternion.copy(t)}},matrixVersion:0,getBounds:function(t,e,n){return e?e.multiply(this.matrix):e=this.getConcatenatedMatrix(t),this.children.forEach((function(t){n=t.getBounds(null,e.clone(),n)})),this.isMesh&&(n=this.geometry.getBounds(e,n)),n},_fireMouseEvent:function(t){if(t.eventCurrentTarget=this,this.fire(t),\"mousemove\"===t.type){if(!this.__mouseOver){this.__mouseOver=!0;var e=Object.assign({},t);e.type=\"mouseover\",this.fire(e)}}else\"mouseout\"===t.type&&(this.__mouseOver=!1);var n=this.parent;t._stopped||t._stopPropagationed||!n||n._fireMouseEvent(t)},destroy:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=this.getChildrenByBaseClassName(\"Node\");return this.off(),n.forEach((function(n){n.isMesh?n.destroy(t,e):(n.off(),n.removeFromParent())})),this.removeFromParent(),this},_onMatrixUpdate:function(){this.matrixVersion++,this.updateTransform()},_onPositionUpdate:function(){this._matrixDirty=!0},_onScaleUpdate:function(){this._matrixDirty=!0},_onPivotUpdate:function(){this._matrixDirty=!0},_onRotationUpdate:function(){this._quatDirty=!0,this._matrixDirty=!0},_onQuaternionUpdate:function(){this._rotation.fromQuat(this._quaternion),this._quatDirty=!1}}),v=n(8),E=new v.a,T=a.a.create({Extends:g,isLight:!0,className:\"Light\",amount:1,enabled:!0,constantAttenuation:1,linearAttenuation:0,quadraticAttenuation:0,_range:0,range:{get:function(){return this._range},set:function(t){this.constantAttenuation=1,t<=0?(this.linearAttenuation=0,this.quadraticAttenuation=0):(this.linearAttenuation=4.5/t,this.quadraticAttenuation=75/(t*t)),this._range=t}},shadow:null,isDirty:!1,constructor:function(t){this.color=new v.a(1,1,1),T.superclass.constructor.call(this,t)},toInfoArray:function(t,e){return t[e+0]=this.constantAttenuation,t[e+1]=this.linearAttenuation,t[e+2]=this.quadraticAttenuation,this},getRealColor:function(){return E.copy(this.color).scale(this.amount)},createShadowMap:function(t,e){}}),M=T,A=n(23),L=new o.a,O=a.a.create({Extends:g,isCamera:!0,className:\"Camera\",_needUpdateProjectionMatrix:!0,_isGeometryDirty:!1,constructor:function(t){this.viewMatrix=new o.a,this.projectionMatrix=new o.a,this.viewProjectionMatrix=new o.a,this._frustum=new A.a,O.superclass.constructor.call(this,t)},updateViewMatrix:function(){return this.updateMatrixWorld(!0),this.viewMatrix.invert(this.worldMatrix),this},updateProjectionMatrix:function(){},getGeometry:function(t){},updateViewProjectionMatrix:function(){return this._needUpdateProjectionMatrix&&(this.updateProjectionMatrix(),this._needUpdateProjectionMatrix=!1),this.updateViewMatrix(),this.viewProjectionMatrix.multiply(this.projectionMatrix,this.viewMatrix),this.updateFrustum(this.viewProjectionMatrix),this},getModelViewMatrix:function(t,e){return(e=e||new o.a).multiply(this.viewMatrix,t.worldMatrix),e},getModelProjectionMatrix:function(t,e){return(e=e||new o.a).multiply(this.viewProjectionMatrix,t.worldMatrix),e},projectVector:function(t,e,n){var r=t.clone();return r.transformMat4(this.viewProjectionMatrix),e&&n&&(r.x=(r.x+1)/2*e,r.y=n-(r.y+1)/2*n),r},unprojectVector:function(t,e,n){var r=t.clone();return e&&n&&(r.x=r.x/e*2-1,r.y=1-r.y/n*2),L.invert(this.viewProjectionMatrix),r.transformMat4(L),r},isPointVisible:function(t){return!!this._frustum.intersectsSphere({center:t,radius:0})},isMeshVisible:function(t){var e=t.geometry;if(e){var n=e.getSphereBounds(t.worldMatrix);if(this._frustum.intersectsSphere(n))return!0}return!1},updateFrustum:function(t){return this._frustum.fromMatrix(t),this}}),I=O,S=n(14),R=n(12),y=n(11),x=n(20),N={2:new S.a,3:new c.a,4:new R.a,16:new o.a},b=a.a.create({className:\"GeometryData\",isGeometryData:!0,size:void 0,normalized:!1,type:void 0,_isSubDirty:!1,_isAllDirty:!1,isDirty:{get:function(){return this._isSubDirty||this._isAllDirty},set:function(t){this._isAllDirty=t,!1===t&&this.clearSubData()}},bufferViewId:void 0,glBuffer:null,constructor:function(t,e,n){this.id=d.a.generateUUID(this.className),this.data=t,this.size=e,Object.assign(this,n),this.bufferViewId||(this.bufferViewId=this.id),this.size||m.a.warn(\"GeometryData.constructor: geometryData must set size!\",this)},_stride:0,stride:{get:function(){return this._stride},set:function(t){this._stride=t,this.strideSize=0===t?0:t/this.data.BYTES_PER_ELEMENT}},strideSize:0,_offset:0,offset:{get:function(){return this._offset},set:function(t){this._offset=t,this.offsetSize=t/this.data.BYTES_PER_ELEMENT}},offsetSize:0,data:{set:function(t){t&&(this._data=t,this.type=Object(i.getTypedArrayGLType)(t),this.stride=this._stride,this.offset=this._offset,this._isAllDirty=!0)},get:function(){return this._data}},length:{get:function(){return this._data.length}},realLength:{get:function(){return 0===this.strideSize?this._data.length:this._data.length/this.strideSize*this.size}},getByteLength:function(){return this._data.BYTES_PER_ELEMENT*this.realLength},count:{get:function(){return 0===this.strideSize?this._data.length/this.size:this._data.length/this.strideSize}},setSubData:function(t,e){this._isSubDirty=!0,this.data.set(e,t),this.subDataList||(this.subDataList=[]);var n=e.BYTES_PER_ELEMENT*t;this.subDataList.push({byteOffset:n,data:e})},clearSubData:function(){this.subDataList&&(this.subDataList.length=0),this._isSubDirty=!1},clone:function(){var t=new b(null,1);return t.copy(this),t},copy:function(t){var e=t.data;this.data=new e.constructor(e),this.size=t.size,this.stride=t.stride,this.normalized=t.normalized,this.type=t.type,this.offset=t.offset},getOffset:function(t){var e=this.strideSize;return 0===e?t*this.size:t*e+this.offsetSize},get:function(t){var e=this.getOffset(t);return this.getByOffset(e)},getCopy:function(t){return this.get(t).clone()},set:function(t,e){var n=this.getOffset(t);return this.setByOffset(n,e),n},getByOffset:function(t){var e=this.size;return e>1?N[e].fromArray(this._data,t):this._data[t]},setByOffset:function(t,e){var n=this.size,r=this._data;n>1?e.toArray(r,t):r[t]=e,this._isAllDirty=!0},traverse:function(t){for(var e=this.count,n=0;n<e;n++){var r=this.getOffset(n);if(t(this.getByOffset(r),n,r))return!0}return!1},traverseByComponent:function(t){for(var e=this.count,n=this.size,r=this._data,i=0;i<e;i++)for(var a=this.getOffset(i),s=i*n,o=0;o<n;o++){var u=a+o;if(t(r[u],s+o,u))return!0}return!1},merge:function(t,e){if(t.type!==this.type||t.size!==this.size)return m.a.warn(\"geometryData type or size not same, cannot merge!\",this,t),this;var n=Object(i.getTypedArrayClass)(this.type),r=this.realLength,a=t.realLength,s=new n(r+a);return this.traverseByComponent((function(t,e){s[e]=t})),t.traverseByComponent((function(t,n){e&&(t=e(t,n)),s[r+n]=t})),this.stride=0,this.offset=0,this.data=s,this}}),C=b,P=n(2),w=P.a.TRIANGLES,H=P.a.LINES,D=P.a.FRONT,F=P.a.BACK,U=P.a.FRONT_AND_BACK,G=new c.a,B=new c.a,V=new c.a,X=new R.a,j=new S.a,k=new S.a,z=new S.a,Y=new y.a,W=new o.a,q=new l.a,Z=a.a.create({isGeometry:!0,className:\"Geometry\",vertices:null,uvs:null,uvs1:null,colors:null,indices:null,skinIndices:null,skinWeights:null,mode:w,isStatic:!0,isDirty:!0,useAABBRaycast:!1,userData:null,constructor:function(t){this.id=d.a.generateUUID(this.className),Object.assign(this,t),this.currentVerticesCount=0,this.currentIndicesCount=0},_needUpdateNormals:!1,normals:{get:function(){return!this._needUpdateNormals&&this._normals||this.calculateNormals(),this._normals},set:function(t){this._normals=t,this._needUpdateNormals=!1}},calculateNormals:function(){var t=this.vertices;if(t){this._normals||(this._normals=new C(new Float32Array(t.realLength),3));var e,n=this._normals;if(this.indices)e=this.indices.data;else{var r=t.length/3;e=new Array(r);for(var i=0;i<r;i++)e[i]=i}for(var a=0,s=new Uint8Array(t.count),o=0;o<e.length;o+=3){a=e[o],G.copy(t.get(a)),a=e[o+1],B.copy(t.get(a)),a=e[o+2],V.copy(t.get(a)),B.sub(G),V.sub(G),B.cross(V);for(var u=0;u<3;u++){if(s[a=e[o+u]]){var c=n.get(a);c.scale(s[a]),c.add(B),c.scale(1/(s[a]+1)),n.set(a,c)}else n.set(a,B);s[a]++}}this.isDirty=!0,this._needUpdateNormals=!1}else m.a.warnOnce(\"geometry.calculateNormals\",\"geometry.calculateNormals error:no vertices data.\")},tangents:{get:function(){return this._tangents||this.calculateTangents(this.uvs,\"_tangents\"),this._tangents},set:function(t){this._tangents=t}},tangents1:{get:function(){return this._tangents1||this.calculateTangents(this.uvs1,\"_tangents1\"),this._tangents1},set:function(t){this._tangents1=t}},calculateTangents:function(t,e){var n=this.vertices;if(n){this[e]||(this[e]=new C(new Float32Array(4*n.count),4));var r,i=this[e];if(this.indices)r=this.indices.data;else{var a=n.length/3;r=new Array(a);for(var s=0;s<a;s++)r[s]=s}for(var o=0,u=0;u<r.length;u+=3){o=r[u],G.copy(n.get(o)),j.copy(t.get(o)),o=r[u+1],B.copy(n.get(o)),k.copy(t.get(o)),o=r[u+2],V.copy(n.get(o)),z.copy(t.get(o)),B.sub(G),V.sub(G),k.sub(j),z.sub(j);var c=1/(k.x*z.y-z.x*k.y);Number.isFinite(c)?(G.x=c*(z.y*B.x-k.y*V.x),G.y=c*(z.y*B.y-k.y*V.y),G.z=c*(z.y*B.z-k.y*V.z)):(G.x=0,G.y=0,G.z=1),X.set(G.x,G.y,G.z,1),i.set(r[u],X),i.set(r[u+1],X),i.set(r[u+2],X)}this.isDirty=!0}else m.a.warnOnce(\"geometry.calculateTangents\",\"geometry.calculateTangents error:no vertices data.\")},convertToLinesMode:function(){if(this.mode===w)if(this.indices){for(var t=new Uint16Array(2*this.indices.length),e=this.indices.data,n=0;n<e.length;n+=3)t[2*n]=e[n],t[2*n+1]=e[n+1],t[2*n+2]=e[n+1],t[2*n+3]=e[n+2],t[2*n+4]=e[n+2],t[2*n+5]=e[n];this.indices.data=t,this.mode=H}else m.a.warn(\"Has no indices!\");else m.a.warn(\"Only support convert triangles to lines mode!\")},translate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transformMat4(W.fromTranslation(G.set(t,e,n))),this},scale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;return this.transformMat4(W.fromScaling(G.set(t,e,n))),this},rotate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return this.transformMat4(W.fromQuat(q.fromEuler({x:t*d.a.DEG2RAD,y:e*d.a.DEG2RAD,z:n*d.a.DEG2RAD}))),this},transformMat4:function(t){var e=this.vertices;if(e&&e.traverse((function(n,r,i){e.setByOffset(i,n.transformMat4(t))})),Y.normalFromMat4(t),this._normals){var n=this.normals;n.traverse((function(t,e,r){n.setByOffset(r,t.transformMat3(Y).normalize())}))}if(this._tangents){var r=this.tangents;r.traverse((function(t,e,n){r.setByOffset(n,t.transformMat3(Y).normalize())}))}return this.isDirty=!0,this},merge:function(t,e){var n=t.vertices;if(n&&this.vertices){var r=this.vertices.count;e&&(n=t.vertices.clone()).traverse((function(t,r,i){n.setByOffset(i,t.transformMat4(e))})),this.vertices.merge(n),this.indices&&t.indices?this.indices.merge(t.indices,(function(t){return t+r})):this.indices=null}return this.uvs&&t.uvs?this.uvs.merge(t.uvs):this.uvs=null,this.uvs1&&t.uvs1?this.uvs1.merge(t.uvs1):this.uvs1=null,this.colors&&t.colors?this.colors.merge(t.colors):this.colors=null,this._normals&&(this._normals=null),this._tangents&&(this._tangents=null),this._tangents1&&(this._tangents1=null),this.isDirty=!0,this},ensureData:function(t,e,n,r){var i=this[t];if(!i||n>i.length){var a=new r(n);i?(a.set(i.data),i.data=a):this[t]=new C(a,e)}},addPoints:function(){var t=this,e=[].slice.call(arguments),n=3*(this.currentVerticesCount+e.length);this.ensureData(\"vertices\",3,n,Float32Array);var r=this.vertices.data;return e.forEach((function(e){var n=3*t.currentVerticesCount++;r[n]=e[0],r[n+1]=e[1],r[n+2]=e[2]})),this.currentVerticesCount-e.length},addIndices:function(){var t=this,e=[].slice.call(arguments),n=this.currentIndicesCount+e.length;this.ensureData(\"indices\",1,n,Uint16Array);var r=this.indices.data;e.forEach((function(e){r[t.currentIndicesCount++]=e})),this._needUpdateNormals=!0},addLine:function(t,e){var n=this.addPoints(t,e);this.addIndices(n,n+1)},addFace:function(t,e,n){var r=this.addPoints(t,e,n);this.addIndices(r,r+1,r+2)},addRect:function(t,e,n,r){var i=this.addPoints(t,e,n,r);this.addIndices(i,i+1,i+2,i,i+2,i+3)},setVertexUV:function(t,e){this.ensureData(\"uvs\",2,this.vertices.length/3*2,Float32Array);for(var n=this.uvs.data,r=0;r<e.length;r++)n[t+2*r]=e[r][0],n[t+2*r+1]=e[r][1]},setFaceUV:function(t,e,n,r){this.setVertexUV(t,[e,n,r])},setRectUV:function(t,e,n,r,i){this.setVertexUV(t,[e,n,r,i])},getBounds:function(t,e){e||(e={xMin:1/0,xMax:-1/0,yMin:1/0,yMax:-1/0,zMin:1/0,zMax:-1/0});var n=this.vertices;return n?(n.traverse((function(n){t&&n.transformMat4(t),e.xMax=Math.max(e.xMax,n.x),e.yMax=Math.max(e.yMax,n.y),e.zMax=Math.max(e.zMax,n.z),e.xMin=Math.min(e.xMin,n.x),e.yMin=Math.min(e.yMin,n.y),e.zMin=Math.min(e.zMin,n.z)})),e.width=e.xMax-e.xMin,e.height=e.yMax-e.yMin,e.depth=e.zMax-e.zMin,e.x=(e.xMin+e.xMax)/2,e.y=(e.yMin+e.yMax)/2,e.z=(e.zMin+e.zMax)/2,e):(m.a.warnOnce(\"geometry.getBounds\",\"geometry has no vertices data, geometry.getBounds will return Infinity bounds.\"),e)},getLocalBounds:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return this._localBounds&&!t||(this._localBounds=this.getBounds()),this._localBounds},getSphereBounds:function(t){this._sphereBounds||(this._sphereBounds=new x.a);var e=this._sphereBounds;return e.copy(this.getLocalSphereBounds()),t&&e.transformMat4(t),e},getLocalSphereBounds:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(!this._localSphereBounds||t){var e=this.getLocalBounds(t),n=new x.a({center:new c.a(e.x,e.y,e.z)}),r=this.vertices;r?n.fromGeometryData(r):(m.a.warnOnce(\"geometry.getLocalSphereBounds\",\"geometry has no vertices data, geometry.getLocalSphereBounds will return Infinity bounds.\"),n.radius=1/0),this._localSphereBounds=n}return this._localSphereBounds},convertToNoIndices:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;if(this.mode===w)if(this.indices){for(var e=this.indices.data,n=e.length,r=new Float32Array(n*t),a=this.uvs?new Float32Array(2*n):null,s=new Float32Array(3*n),o=this.colors?new Float32Array(this.colors.size*n):null,u=this.skinIndices?new Float32Array(4*n):null,c=this.skinWeights?new Float32Array(4*n):null,h=0;h<n;h++){var f=e[h];Object(i.copyArrayData)(r,this.vertices,h*t,3*f,3),4===t&&(r[4*h+3]=1),Object(i.copyArrayData)(a,this.uvs,2*h,2*f,2),Object(i.copyArrayData)(s,this.normals,3*h,3*f,3),Object(i.copyArrayData)(u,this.skinIndices,4*h,4*f,4),Object(i.copyArrayData)(c,this.skinWeights,4*h,4*f,4),this.colors&&Object(i.copyArrayData)(o,this.colors,h*this.colors.size,f*this.colors.size,this.colors.size)}delete this.indices,this.vertices.data=r,this.uvs&&(this.uvs.data=a),this.normals&&(this.normals.data=s),this.colors&&(this.colors.data=o),this.skinIndices&&(this.skinIndices.data=u),this.skinWeights&&(this.skinWeights.data=c)}else m.a.warn(\"Has no indices!\");else m.a.warn(\"Only support convert triangles to lines mode!\")},clone:function(){var t=new this.constructor({mode:this.mode});return this.vertices&&(t.vertices=this.vertices.clone()),this.uvs&&(t.uvs=this.uvs.clone()),this.uvs1&&(t.uvs1=this.uvs1.clone()),this.colors&&(t.colors=this.colors.clone()),this.indices&&(t.indices=this.indices.clone()),this.skinWeights&&(t.skinWeights=this.skinWeights.clone()),this.skinIndices&&(t.skinIndices=this.skinIndices.clone()),this._normals&&(t._normals=this._normals.clone()),this._tangents&&(t._tangents=this._tangents.clone()),this._tangents1&&(t._tangents1=this._tangents1.clone()),this.positionDecodeMat&&(t.positionDecodeMat=this.positionDecodeMat),this.uvDecodeMat&&(t.uvDecodeMat=this.uvDecodeMat),this.uv1DecodeMat&&(t.uv1DecodeMat=this.uv1DecodeMat),this.normalDecodeMat&&(t.normalDecodeMat=this.normalDecodeMat),t},_aabbRaycast:function(t){var e=this.getLocalBounds(),n=t.intersectsBox([[e.xMin,e.yMin,e.zMin],[e.xMax,e.yMax,e.zMax]]);return n?[n]:null},_raycast:function(t,e){var n=this.vertices;if(!n)return null;var r,i=this.indices,a=[],s=[];r=i?i.realLength:n.realLength/3;for(var o=0;o<r;o+=3){var u=i?i.get(o):o;G.copy(n.get(u)),u=i?i.get(o+1):o+1,B.copy(n.get(u)),u=i?i.get(o+2):o+2,V.copy(n.get(u));var c=void 0;e===D?(a[0]=G.elements,a[1]=B.elements,a[2]=V.elements,c=t.intersectsTriangle(a)):e===F?(a[1]=G.elements,a[0]=B.elements,a[2]=V.elements,c=t.intersectsTriangle(a)):e===U&&(a[0]=G.elements,a[1]=B.elements,a[2]=V.elements,(c=t.intersectsTriangle(a))||(a[1]=G.elements,a[0]=B.elements,a[2]=V.elements,c=t.intersectsTriangle(a))),c&&s.push(c)}return s.length?s:null},raycast:function(t,e){var n,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];return(n=this.useAABBRaycast?this._aabbRaycast(t):this._raycast(t,e))&&r&&t.sortPoints(n),n},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.positionDecodeMat&&(t.QUANTIZED=1,t.POSITION_QUANTIZED=1),this.normalDecodeMat&&(t.QUANTIZED=1,t.NORMAL_QUANTIZED=1),this.uvDecodeMat&&(t.QUANTIZED=1,t.UV_QUANTIZED=1),this.uv1DecodeMat&&(t.QUANTIZED=1,t.UV1_QUANTIZED=1),this.colors&&(t.HAS_COLOR=1,t.COLOR_SIZE=this.colors.size),t},getShaderKey:function(){return void 0===this._shaderKey&&(this._shaderKey=\"geometry\",this.isMorphGeometry?this._shaderKey+=\"_id_\".concat(this.id):(this.colors&&(this._shaderKey+=\"_colors\"),this.positionDecodeMat&&(this._shaderKey+=\"positionDecodeMat\"))),this._shaderKey},getSize:function(){var t=0;for(var e in this)Object(i.hasOwnProperty)(this,e)&&this[e]&&this[e].isGeometryData&&(t+=this[e].getByteLength());return t},destroy:function(){m.a.warn(\"Geometry.destroy has been deprecated, use mesh.destroy(renderer) instead.\")}}),K=a.a.create({Extends:I,isPerspectiveCamera:!0,className:\"PerspectiveCamera\",_near:.1,near:{get:function(){return this._near},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._near=t}},_far:null,far:{get:function(){return this._far},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._far=t}},_fov:50,fov:{get:function(){return this._fov},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._fov=t}},_aspect:1,aspect:{get:function(){return this._aspect},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._aspect=t}},constructor:function(t){K.superclass.constructor.call(this,t),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.projectionMatrix.elements,e=this.near,n=this.far,r=this.aspect,i=this.fov,a=1/Math.tan(.5*d.a.degToRad(i));if(t[0]=a/r,t[5]=a,t[11]=-1,t[15]=0,n){var s=1/(e-n);t[10]=(e+n)*s,t[14]=2*n*e*s}else t[10]=-1,t[14]=-2*e},getGeometry:function(t){if(t||!this._geometry||this._isGeometryDirty){this._isGeometryDirty=!1;var e=new Z,n=Math.tan(this.fov/2*Math.PI/180),r=this.near,i=this.far,a=r*n,s=i*n,o=this.aspect*a,u=this.aspect*s,c=[-o,-a,-r],h=[o,-a,-r],f=[o,a,-r],l=[-o,a,-r],d=[-u,-s,-i],m=[u,-s,-i],_=[u,s,-i],p=[-u,s,-i];e.addRect(d,m,_,p),e.addRect(m,h,f,_),e.addRect(h,c,l,f),e.addRect(c,d,p,l),e.addRect(p,_,f,l),e.addRect(c,h,m,d),this._geometry=e}return this._geometry}}),Q=K,J=a.a.create({constructor:function(){this._cache={}},get:function(t){return this._cache[t]},getObject:function(t){return this._cache[t.__cacheId]},add:function(t,e){\"object\"==typeof e&&(e.__cacheId=t),this._cache[t]=e},remove:function(t){delete this._cache[t]},removeObject:function(t){delete this._cache[t.__cacheId]},removeAll:function(){this._cache={}},each:function(t){var e=this._cache;for(var n in e)t(e[n],n)}}),$={instanced:void 0,vao:void 0,texFloat:void 0,loseContext:void 0,textureFilterAnisotropic:void 0,_usedExtensions:{},_disabledExtensions:{},init:function(t){this.reset(t)},reset:function(t){this.gl=t;var e=this._usedExtensions;for(var n in e){var r=e[n];this[r]=void 0,this.get(n,r)}},use:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;this.gl?this.get(t,e):this._usedExtensions[t]=e},get:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:t;if(this._disabledExtensions[t])return null;var n=this[e];return void 0===n&&(n=this._getExtension(t),this[e]=n),n},disable:function(t){this._disabledExtensions[t]=!0},enable:function(t){this._disabledExtensions[t]=!1},_getExtension:function(t){var e=this.gl;return e&&e.getExtension&&(e.getExtension(t)||e.getExtension(\"WEBKIT_\"+t)||e.getExtension(\"MOZ_\"+t))||null}};$.use(\"ANGLE_instanced_arrays\",\"instanced\"),$.use(\"OES_vertex_array_object\",\"vao\"),$.use(\"OES_texture_float\",\"texFloat\"),$.use(\"WEBGL_lose_context\",\"loseContext\"),$.use(\"OES_element_index_uint\",\"uintIndices\"),$.use(\"EXT_shader_texture_lod\",\"shaderTextureLod\"),$.use(\"EXT_texture_filter_anisotropic\",\"textureFilterAnisotropic\");var tt=$,et={MAX_TEXTURE_INDEX:null,MAX_PRECISION:null,MAX_VERTEX_PRECISION:null,MAX_FRAGMENT_PRECISION:null,VERTEX_TEXTURE_FLOAT:null,FRAGMENT_TEXTURE_FLOAT:null,MAX_TEXTURE_MAX_ANISOTROPY:1,MAX_RENDERBUFFER_SIZE:void 0,MAX_COMBINED_TEXTURE_IMAGE_UNITS:void 0,MAX_CUBE_MAP_TEXTURE_SIZE:void 0,MAX_FRAGMENT_UNIFORM_VECTORS:void 0,MAX_TEXTURE_IMAGE_UNITS:void 0,MAX_TEXTURE_SIZE:void 0,MAX_VARYING_VECTORS:void 0,MAX_VERTEX_ATTRIBS:void 0,MAX_VERTEX_TEXTURE_IMAGE_UNITS:void 0,MAX_VERTEX_UNIFORM_VECTORS:void 0,init:function(t){var e=this;this.gl=t;[\"MAX_RENDERBUFFER_SIZE\",\"MAX_COMBINED_TEXTURE_IMAGE_UNITS\",\"MAX_CUBE_MAP_TEXTURE_SIZE\",\"MAX_FRAGMENT_UNIFORM_VECTORS\",\"MAX_TEXTURE_IMAGE_UNITS\",\"MAX_TEXTURE_SIZE\",\"MAX_VARYING_VECTORS\",\"MAX_VERTEX_ATTRIBS\",\"MAX_VERTEX_TEXTURE_IMAGE_UNITS\",\"MAX_VERTEX_UNIFORM_VECTORS\"].forEach((function(t){e.get(t)})),this.MAX_TEXTURE_INDEX=this.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,this.MAX_VERTEX_PRECISION=this._getMaxSupportPrecision(t.VERTEX_SHADER),this.MAX_FRAGMENT_PRECISION=this._getMaxSupportPrecision(t.FRAGMENT_SHADER),this.MAX_PRECISION=this.getMaxPrecision(this.MAX_FRAGMENT_PRECISION,this.MAX_VERTEX_PRECISION),this.VERTEX_TEXTURE_FLOAT=!!tt.texFloat&&this.MAX_VERTEX_TEXTURE_IMAGE_UNITS>0,this.FRAGMENT_TEXTURE_FLOAT=!!tt.texFloat,this.EXT_FRAG_DEPTH=tt.get(\"EXT_frag_depth\"),this.SHADER_TEXTURE_LOD=!!tt.shaderTextureLod,tt.textureFilterAnisotropic&&(this.MAX_TEXTURE_MAX_ANISOTROPY=t.getParameter(tt.textureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))},get:function(t){var e=this.gl,n=this[t];return void 0===n&&(n=this[t]=e.getParameter(e[t])),n},_getMaxSupportPrecision:function(t){var e=this.gl,n=\"lowp\";if(e.getShaderPrecisionFormat)for(var r=[{name:\"highp\",type:e.HIGH_FLOAT},{name:\"mediump\",type:e.MEDIUM_FLOAT}],i=0;i<r.length;i++){var a=r[i];if((e.getShaderPrecisionFormat(t,a.type)||{}).precision>0){n=a.name;break}}else n=\"mediump\";return n},getMaxPrecision:function(t,e){return\"highp\"===t||\"mediump\"===t&&\"lowp\"===e?e:t}},nt=n(52),rt=n.n(nt),it=n(53),at=n.n(it),st=n(54),ot=n.n(st),ut=n(55),ct=n.n(ut),ht=new J,ft=new J,lt=a.a.create({isShader:!0,className:\"Shader\",vs:\"\",fs:\"\",Statics:{commonOptions:{},shaders:{\"chunk/baseDefine.glsl\":n(18),\"chunk/color.frag\":n(38),\"chunk/color.vert\":n(77),\"chunk/color_main.vert\":n(79),\"chunk/diffuse.frag\":n(59),\"chunk/diffuse_main.frag\":n(68),\"chunk/extensions.frag\":n(24),\"chunk/extensions.vert\":n(50),\"chunk/fog.frag\":n(45),\"chunk/fog_main.frag\":n(70),\"chunk/frag_color.frag\":n(49),\"chunk/joint.vert\":n(72),\"chunk/joint_main.vert\":n(82),\"chunk/light.frag\":n(42),\"chunk/lightFog.frag\":n(41),\"chunk/lightFog.vert\":n(75),\"chunk/lightFog_main.frag\":n(47),\"chunk/lightFog_main.vert\":n(85),\"chunk/logDepth.frag\":n(28),\"chunk/logDepth_main.frag\":n(29),\"chunk/logDepth.vert\":n(78),\"chunk/logDepth_main.vert\":n(86),\"chunk/morph.vert\":n(76),\"chunk/morph_main.vert\":n(81),\"chunk/normal.frag\":n(40),\"chunk/normal.vert\":n(74),\"chunk/normal_main.frag\":n(46),\"chunk/normal_main.vert\":n(84),\"chunk/pbr.frag\":n(88),\"chunk/pbr_main.frag\":n(90),\"chunk/phong.frag\":n(66),\"chunk/phong_main.frag\":n(69),\"chunk/precision.frag\":n(25),\"chunk/precision.vert\":n(51),\"chunk/transparency.frag\":n(44),\"chunk/transparency_main.frag\":n(48),\"chunk/unQuantize.vert\":n(71),\"chunk/unQuantize_main.vert\":n(80),\"chunk/uv.frag\":n(39),\"chunk/uv.vert\":n(73),\"chunk/uv_main.vert\":n(83),\"method/encoding.glsl\":n(89),\"method/getDiffuse.glsl\":n(61),\"method/getLightAttenuation.glsl\":n(63),\"method/getShadow.glsl\":n(65),\"method/getSpecular.glsl\":n(62),\"method/packFloat.glsl\":n(87),\"method/textureEnvMap.glsl\":n(43),\"method/transpose.glsl\":n(60),\"method/unpackFloat.glsl\":n(64),\"basic.frag\":n(52),\"basic.vert\":n(53),\"geometry.frag\":n(54),\"pbr.frag\":n(55),\"screen.frag\":n(56),\"screen.vert\":n(57)},init:function(t){this.renderer=t,this.commonHeader=this._getCommonHeader(this.renderer)},cache:{get:function(){return ht}},headerCache:{get:function(){return ft}},reset:function(t){ht.removeAll()},getHeaderKey:function(t,e,n,r,i){var a=\"header_\"+e.id+\"_\"+n.lightInfo.uid;return t.isSkinedMesh&&(a+=\"_joint\"+t.skeleton.jointCount),r&&(a+=\"_fog_\"+r.mode),a+=\"_\"+t.geometry.getShaderKey(),i&&(a+=\"_fogDepth\"),a},getHeader:function(t,e,n,r,i){var a=this.getHeaderKey(t,e,n,r),s=ft.get(a);if(!s||e.isDirty){var o={};Object.assign(o,this.commonOptions);var u=e.lightType;u&&\"NONE\"!==u&&n.getRenderOption(o),e.getRenderOption(o),t.getRenderOption(o),r&&(o.HAS_FOG=1,r.getRenderOption(o)),i&&(o.USE_LOG_DEPTH=1,et.EXT_FRAG_DEPTH&&(o.USE_EXT_FRAG_DEPTH=1)),o.HAS_NORMAL&&o.NORMAL_MAP&&(o.HAS_TANGENT=1),o.RECEIVE_SHADOWS||(delete o.DIRECTIONAL_LIGHTS_SMC,delete o.SPOT_LIGHTS_SMC,delete o.POINT_LIGHTS_SMC),s=\"#define SHADER_NAME \".concat(e.className,\"\\n\"),s+=Object.keys(o).map((function(t){return t.indexOf(\"HILO_CUSTUM_OPTION_\")>-1?\"#define \".concat(t.replace(\"HILO_CUSTUM_OPTION_\",\"\"),\" \").concat(o[t]):\"#define HILO_\".concat(t,\" \").concat(o[t])})).join(\"\\n\")+\"\\n\",ft.add(a,s)}return s},_getCommonHeader:function(t){var e=et.getMaxPrecision(et.MAX_VERTEX_PRECISION,t.vertexPrecision),n=et.getMaxPrecision(et.MAX_FRAGMENT_PRECISION,t.fragmentPrecision),r=et.getMaxPrecision(e,n);return\"\\n#define HILO_MAX_PRECISION \".concat(r,\"\\n#define HILO_MAX_VERTEX_PRECISION \").concat(e,\"\\n#define HILO_MAX_FRAGMENT_PRECISION \").concat(n,\"\\n\")},getShader:function(t,e,n,r,i,a){var s=this.getHeader(t,e,r,i,a);return e.isBasicMaterial||e.isPBRMaterial?this.getBasicShader(e,n,s):e.isShaderMaterial?this.getCustomShader(e.vs,e.fs,s,e.shaderCacheId||e.id,e.useHeaderCache):null},getBasicShader:function(t,e,n){var r=\"\";e&&(r=(r=t.getInstancedUniforms().map((function(t){return t.name}))).join(\"|\"));var i=t.className+\":\"+r;t.onBeforeCompile&&(i+=\":\"+(t.shaderCacheId||t.id));var a=ht.get(i);if(!a){var s=\"\",o=at.a;if(t.isBasicMaterial?t.isGeometryMaterial?s+=ot.a:s+=rt.a:t.isPBRMaterial&&(s+=ct.a),t.onBeforeCompile){var u=t.onBeforeCompile(o,s);s=u.fs,o=u.vs}if(r){var c=new RegExp(\"^\\\\s*uniform\\\\s+(\\\\w+)\\\\s+(\".concat(r,\");\"),\"gm\");o=o.replace(c,\"attribute $1 $2;\")}a=this.getCustomShader(o,s,n,i,!0)}if(a){var h=this._getNumId(a);null!==h&&(t._shaderNumId=h)}return a},_getNumId:function(t){var e=t.id.match(/_(\\d+)/);return e&&e[1]?parseInt(e[1],10):null},getCustomShader:function(t,e,n,r,i){var a,s=this.commonHeader;return r&&(i&&(r+=\":\"+n),a=ht.get(r)),a||(a=new lt({vs:s+n+t,fs:s+n+e}),r&&ht.add(r,a)),a}},alwaysUse:!1,constructor:function(t){this.id=d.a.generateUUID(this.className),Object.assign(this,t)},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(ht.removeObject(this),this._isDestroyed=!0),this}}),dt=lt,mt=n(57),_t=n.n(mt),pt=n(56),gt=n.n(pt),vt=[{name:\"FLOAT\",byteSize:4,uniformFuncName:\"uniform1f\",type:\"Scalar\",size:1},{name:\"FLOAT_VEC2\",byteSize:8,uniformFuncName:\"uniform2f\",type:\"Vector\",size:2},{name:\"FLOAT_VEC3\",byteSize:12,uniformFuncName:\"uniform3f\",type:\"Vector\",size:3},{name:\"FLOAT_VEC4\",byteSize:16,uniformFuncName:\"uniform4f\",type:\"Vector\",size:4},{name:\"FLOAT_MAT2\",byteSize:16,uniformFuncName:\"uniformMatrix2fv\",type:\"Matrix\",size:4},{name:\"FLOAT_MAT3\",byteSize:36,uniformFuncName:\"uniformMatrix3fv\",type:\"Matrix\",size:9},{name:\"FLOAT_MAT4\",byteSize:64,uniformFuncName:\"uniformMatrix4fv\",type:\"Matrix\",size:16},{name:\"INT\",byteSize:4,uniformFuncName:\"uniform1i\",type:\"Scalar\",size:1},{name:\"INT_VEC2\",byteSize:8,uniformFuncName:\"uniform2i\",type:\"Vector\",size:2},{name:\"INT_VEC3\",byteSize:12,uniformFuncName:\"uniform3i\",type:\"Vector\",size:3},{name:\"INT_VEC4\",byteSize:16,uniformFuncName:\"uniform4i\",type:\"Vector\",size:4},{name:\"BOOL\",byteSize:4,uniformFuncName:\"uniform1i\",type:\"Scalar\",size:1},{name:\"BOOL_VEC2\",byteSize:8,uniformFuncName:\"uniform2i\",type:\"Vector\",size:2},{name:\"BOOL_VEC3\",byteSize:12,uniformFuncName:\"uniform3i\",type:\"Vector\",size:3},{name:\"BOOL_VEC4\",byteSize:16,uniformFuncName:\"uniform4i\",type:\"Vector\",size:4},{name:\"SAMPLER_2D\",byteSize:4,uniformFuncName:\"uniform1i\",type:\"Scalar\",size:1},{name:\"SAMPLER_CUBE\",byteSize:4,uniformFuncName:\"uniform1i\",type:\"Scalar\",size:1}],Et={},Tt={dict:Et,init:function(t){vt.forEach((function(e){var n,r,i=e.name,a=e.uniformFuncName,s=a+\"v\";\"Matrix\"===e.type?n=r=function(e,n){void 0!==n&&t[a](e,!1,n)}:(n=function(e,n){void 0!==n&&t[a](e,n)},r=function(e,n){t[s](e,n)}),Et[t[i]]=Object.assign(e,{glValue:t[i],uniform:n,uniformArray:r})}))},get:function(t){return Et[t]}},Mt=new J,At=a.a.create({Statics:{cache:{get:function(){return Mt}},reset:function(t){Mt.each((function(t){t.destroy()}))},getProgram:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=t.id,i=Mt.get(r);return i||(i=new At({state:e,vertexShader:t.vs,fragShader:t.fs,ignoreError:n}),Mt.add(r,i)),i},getBlankProgram:function(t){var e=dt.getCustomShader(\"void main(){}\",\"precision HILO_MAX_FRAGMENT_PRECISION float;void main(){gl_FragColor = vec4(0.0);}\",\"\",\"__hiloBlankShader\");return this.getProgram(e,t,!0)}},className:\"Program\",isProgram:!0,fragShader:\"\",vertexShader:\"\",attributes:null,uniforms:null,program:null,gl:null,state:null,alwaysUse:!1,constructor:function(t){return this.id=d.a.generateUUID(this.className),Object.assign(this,t),this._dict={},this.attributes={},this.uniforms={},this.gl=this.state.gl,this.program=this.createProgram(),this.program?(this.initAttributes(),this.initUniforms(),this):this.ignoreError?this:At.getBlankProgram(t.state)},createProgram:function(){var t=this.gl,e=t.createProgram(),n=this.createShader(t.VERTEX_SHADER,this.vertexShader),r=this.createShader(t.FRAGMENT_SHADER,this.fragShader);if(n&&r){if(t.attachShader(e,n),t.attachShader(e,r),t.linkProgram(e),t.deleteShader(n),t.deleteShader(r),!t.getProgramParameter(e,t.LINK_STATUS)){var i=t.getProgramInfoLog(e);return m.a.error(\"compileProgramError: \"+i,this),t.deleteProgram(e),null}return e}return null},useProgram:function(){this.state.useProgram(this.program)},createShader:function(t,e){var n=this.gl,r=n.createShader(t);if(n.shaderSource(r,e),n.compileShader(r),!n.getShaderParameter(r,n.COMPILE_STATUS)){var i=n.getShaderInfoLog(r);return m.a.error(\"compileShaderError: \"+i,e.split(\"\\n\").map((function(t,e){return\"\".concat(e+1,\" \").concat(t)})).join(\"\\n\")),null}return r},initAttributes:function(){for(var t=this,e=this.gl,n=this.program,r=e.getProgramParameter(n,e.ACTIVE_ATTRIBUTES),i=tt.instanced,a=function(r){var a=e.getActiveAttrib(n,r),s=a.name,o=a.type,u=a.size,c=e.getAttribLocation(n,s),h=Tt.get(o),f=function(t){var n=t.type,r=void 0===n?e.FLOAT:n,i=t.normalized,a=void 0!==i&&i,s=t.stride,o=void 0===s?0:s,u=t.offset,f=void 0===u?0:u,l=t.size,d=void 0===l?h.size:l;e.vertexAttribPointer(c,d,r,a,o,f)},l=function(){e.enableVertexAttribArray(c)},d=function(){},m=function(t,e){t[c]=e};if(i&&(d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;i.vertexAttribDivisorANGLE(c,t)}),\"Matrix\"===h.type){var _=h.byteSize,p=h.size,g=Math.sqrt(p),v=4*g,E=function(t){for(var e=0;e<g;e++)t(c+e,e)};f=function(t){var n,r=t.type,i=void 0===r?e.FLOAT:r,a=t.normalized,s=void 0!==a&&a,o=t.stride,u=void 0===o?0:o,c=t.offset,h=void 0===c?0:c;n=0===u?_:u,E((function(t,r){e.vertexAttribPointer(t,g,i,s,n,h+v*r)}))},l=function(){E((function(t){e.enableVertexAttribArray(t)}))},m=function(t,e){E((function(n){t[n]=e}))},i&&(d=function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;E((function(e){i.vertexAttribDivisorANGLE(e,t)}))})}t.attributes[s]={name:s,location:c,type:o,size:u,glTypeInfo:h,pointer:f,enable:l,divisor:d,addTo:m}},s=0;s<r;s++)a(s)},initUniforms:function(){for(var t=this,e=this.gl,n=this.program,r=e.getProgramParameter(n,e.ACTIVE_UNIFORMS),i=0,a=function(r){var a=e.getActiveUniform(n,r),s=a.name,o=a.size,u=a.type;s=s.replace(/\\[0\\]$/,\"\");var c=e.getUniformLocation(n,s),h=Tt.get(u),f=h.uniformArray,l=h.uniform;t.uniforms[s]={name:s,location:c,type:u,size:o,glTypeInfo:h},u!==e.SAMPLER_2D&&u!==e.SAMPLER_CUBE||(t.uniforms[s].textureIndex=i,i+=o),Object.defineProperty(t,s,{set:h.size>1||o>1?function(t){f(c,t)}:function(e){t._dict[s]!==e&&(t._dict[s]=e,l(c,e))}})},s=0;s<r;s++)a(s)},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(this.gl.deleteProgram(this.program),this.uniforms=null,this.attributes=null,this.program=null,this.gl=null,this.state=null,this._dict=null,Mt.removeObject(this),this._isDestroyed=!0),this}}),Lt=At,Ot=P.a.ARRAY_BUFFER,It=P.a.ELEMENT_ARRAY_BUFFER,St=P.a.STATIC_DRAW,Rt=new J,yt=a.a.create({Statics:{cache:{get:function(){return Rt}},reset:function(t){Rt.each((function(t){t.destroy()}))},createVertexBuffer:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:St;return this.createBuffer(t,Ot,e,n)},createBuffer:function(t,e,n,r){var i=n.bufferViewId,a=Rt.get(i);return a||(n.isDirty=!1,a=new yt(t,e,n.data,r),Rt.add(i,a),a)},createIndexBuffer:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:St;return this.createBuffer(t,It,e,n)}},className:\"Buffer\",isBuffer:!0,constructor:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Ot,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:St;this.id=d.a.generateUUID(this.className),this.gl=t,this.target=e,this.usage=r,this.buffer=t.createBuffer(),n&&this.bufferData(n)},bind:function(){return this.gl.bindBuffer(this.target,this.buffer),this},bufferData:function(t){var e=this.gl,n=this.target,r=this.usage;return this.bind(),e.bufferData(n,t,r),this.data=t,this},bufferSubData:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.gl,i=this.target;return n||this.bind(),r.bufferSubData(i,t,e),this},uploadGeometryData:function(t){var e=this,n=t.subDataList;return!this.data||this.data.byteLength<t.data.byteLength||!0===t._isAllDirty?this.bufferData(t.data):n&&n.length?(this.bind(),n.forEach((function(t){e.bufferSubData(t.byteOffset,t.data,!0)}))):this.bufferData(t.data),t.isDirty=!1,this},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){return this._isDestroyed||(this.gl.deleteBuffer(this.buffer),this.data=null,Rt.removeObject(this),this._isDestroyed=!0),this}}),xt=yt,Nt=new ArrayBuffer(1),bt={getTypedArray:function(t,e){return this._updateBuffer(e*t.BYTES_PER_ELEMENT),new t(Nt,0,e)},fillArrayData:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=0,i=e.length;r<i;r++)t[n+r]=e[r]},_updateBuffer:function(t){Nt.byteLength<t&&(Nt=new ArrayBuffer(2*t))}},Ct=P.a.TRIANGLES,Pt=[],wt=null,Ht=new J,Dt=a.a.create({Statics:{cache:{get:function(){return Ht}},getVao:function(t,e,n){var r=Ht.get(e);return r?n.mode&&n.mode!==r.mode&&(r.mode=n.mode):(r=new Dt(t,e,n),Ht.add(e,r)),r},reset:function(t){wt=null,Pt=[],this.bindSystemVao(),Ht.each((function(e){e.destroy(t)}))},bindSystemVao:function(){tt.vao&&tt.vao.bindVertexArrayOES(null),wt=null}},className:\"VertexArrayObject\",isVertexArrayObject:!0,vertexCount:null,useVao:!1,useInstanced:!1,mode:Ct,isDirty:!0,constructor:function(t,e,n){this.gl=t,this.id=e,this.vaoExtension=tt.vao,this.instancedExtension=tt.instanced,Object.assign(this,n),this.vaoExtension||(this.useVao=!1),this.instancedExtension||(this.useInstanced=!1),this.useVao&&(this.vao=this.vaoExtension.createVertexArrayOES()),this.attributes=[],this.activeStates=[],this.indexBuffer=null},bind:function(){wt!==this&&(this.useVao?this.vaoExtension.bindVertexArrayOES(this.vao):this.bindSystemVao(),wt=this)},bindSystemVao:function(){var t=this.gl;wt&&wt.useVao&&wt.unbind();var e,n=this.activeStates;this.attributes.forEach((function(t){var n=t.buffer,r=t.attribute,i=t.geometryData;e!==n&&(e=n,n.bind()),r.enable(),r.pointer(i),t.useInstanced?r.divisor(1):r.divisor(0)})),Pt.forEach((function(e,r){var i=n[r];e&&!i&&(e.attribute.divisor(0),t.disableVertexAttribArray(r))})),this.indexBuffer&&this.indexBuffer.bind(),Pt=n},unbind:function(){this.useVao&&this.vaoExtension.bindVertexArrayOES(null),wt=null},draw:function(){this.bind();var t=this.gl,e=this.mode;this.indexBuffer?t.drawElements(e,this.vertexCount,this.indexType,0):t.drawArrays(e,0,this.getVertexCount())},getVertexCount:function(){if(null===this.vertexCount){var t=this.attributes[0];this.vertexCount=t?t.geometryData.count:0}return this.vertexCount},drawInstance:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;this.bind();var e=this.gl,n=this.mode;this.useInstanced&&(this.indexBuffer?this.instancedExtension.drawElementsInstancedANGLE(n,this.vertexCount,e.UNSIGNED_SHORT,0,t):this.instancedExtension.drawArraysInstancedANGLE(n,0,this.getVertexCount(),t))},addIndexBuffer:function(t,e){this.bind();var n=this.gl,r=this.indexBuffer;return this.indexType=t.type,r?t.isDirty&&(r.uploadGeometryData(t),this.vertexCount=t.length):((r=xt.createIndexBuffer(n,t,e)).bind(),this.indexBuffer=r,this.vertexCount=t.length),r},addAttribute:function(t,e,n,r){this.bind();var i=this.gl,a=e.name,s=this[a];if(!s){var o=xt.createVertexBuffer(i,t,n);o.bind(),e.enable(),e.pointer(t),s={attribute:e,buffer:o,geometryData:t},this.attributes.push(s),this[a]=s,e.addTo(this.activeStates,s),r&&r(s)}if(t.isDirty){var u=s.buffer;u.bind(),e.enable(),e.pointer(t),u.uploadGeometryData(t)}return s},addInstancedAttribute:function(t,e,n){this.bind();var r=this.gl,i=t.name,a=t.glTypeInfo,s=bt.getTypedArray(Float32Array,e.length*a.size);e.forEach((function(t,e){void 0!==n(t)?bt.fillArrayData(s,n(t),e*a.size):m.a.warn(\"no attributeData:\"+i+\"-\"+t.name)}));var o,u=this[i];return u?(o=u.geometryData).data=s:o=new C(s,1),this.addAttribute(o,t,r.DYNAMIC_DRAW,(function(e){t.divisor(1),e.useInstanced=!0}))},getResources:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];return this.attributes&&this.attributes.forEach((function(e){t.push(e.buffer)})),this.indexBuffer&&t.push(this.indexBuffer),t},destroyIfNoRef:function(t){return t.resourceManager.destroyIfNoRef(this),this},destroy:function(){var t=this;return this._isDestroyed||(this.instancedExtension=null,this.useVao&&(this.vaoExtension.deleteVertexArrayOES(this.vao),this.vao=null,this.vaoExtension=null),this.gl=null,this.indexBuffer=null,this.attributes.forEach((function(e){var n=e.attribute||{};t[n.name]=null})),this.attributes=null,this.activeStates=null,Ht.removeObject(this),this._isDestroyed=!0),this}}),Ft=Dt,Ut=P.a.TEXTURE_2D,Gt=P.a.RGBA,Bt=P.a.LINEAR,Vt=P.a.NEAREST,Xt=P.a.REPEAT,jt=P.a.CLAMP_TO_EDGE,kt=P.a.UNSIGNED_BYTE,zt=new J,Yt=a.a.create({Statics:{cache:{get:function(){return zt}},reset:function(t){zt.each((function(e,n){t.deleteTexture(e),zt.remove(n)}))}},isTexture:!0,className:\"Texture\",isImageCanRelease:!1,_isImageReleased:!1,_image:null,image:{get:function(){return this._isImageReleased&&m.a.errorOnce(\"Read Texture.image(\".concat(this.id,\")\"),\"Read Texture.image after image released!\"),this._image},set:function(t){this._image=t,this._isImageReleased=!1}},_releaseImage:function(){this._canvasImage=null,this._canvasCtx=null,this._originImage=null,this._image=null,this.mipmaps=null,this._isImageReleased=!0},mipmaps:null,target:Ut,internalFormat:Gt,format:Gt,type:kt,width:0,height:0,border:0,magFilter:Bt,minFilter:Bt,wrapS:Xt,wrapT:Xt,name:\"\",premultiplyAlpha:!1,flipY:!1,compressed:!1,needUpdate:!0,needDestroy:!1,autoUpdate:!1,uv:0,anisotropic:1,origWidth:{get:function(){return this._originImage?this._originImage.width||this.width:this.image&&this.image.width||this.width}},origHeight:{get:function(){return this.originImage?this._originImage.height||this.height:this.image&&this.image.height||this.height}},useMipmap:{get:function(){return this.minFilter!==Bt&&this.minFilter!==Vt},set:function(){m.a.warn(\"texture.useMipmap is readOnly!\")}},useRepeat:{get:function(){return this.wrapS!==jt||this.wrapT!==jt},set:function(){m.a.warn(\"texture.useRepeat is readOnly!\")}},mipmapCount:{get:function(){return Math.floor(Math.log2(Math.max(this.width,this.height))+1)},set:function(){m.a.warn(\"texture.mipmapCount is readOnly!\")}},constructor:function(t){this.id=d.a.generateUUID(this.className),Object.assign(this,t)},isImgPowerOfTwo:function(t){return d.a.isPowerOfTwo(t.width)&&d.a.isPowerOfTwo(t.height)},getSupportSize:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],n=t.width,r=t.height;e&&!this.isImgPowerOfTwo(t)&&(n=d.a.nextPowerOfTwo(n),r=d.a.nextPowerOfTwo(r));var i=et.MAX_TEXTURE_SIZE;return i&&(n>i&&(n=i),r>i&&(r=i)),{width:n,height:r}},resizeImgToPowerOfTwo:function(t){var e=this.getSupportSize(t,!0);return this.resizeImg(t,e.width,e.height)},resizeImg:function(t,e,n){if(t.width===e&&t.height===n)return t;var r=this._canvasImage;return r?(r.width=e,r.height=n,this._canvasCtx=r.getContext(\"2d\")):((r=document.createElement(\"canvas\")).width=e,r.height=n,this._canvasImage=r,this._canvasCtx=r.getContext(\"2d\")),this._canvasCtx.drawImage(t,0,0,t.width,t.height,0,0,e,n),m.a.warnOnce(\"Texture.resizeImg(\".concat(this.id,\")\"),\"image size(\".concat(t.width,\"x\").concat(t.height,\") is not support. Resized to \").concat(r.width,\"x\").concat(r.height),t.src),this._originImage=t,r},_glUploadTexture:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:this.width,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:this.height,s=t.gl;return this.compressed?s.compressedTexImage2D(e,r,this.internalFormat,i,a,this.border,n):n&&void 0!==n.width?s.texImage2D(e,r,this.internalFormat,this.format,this.type,n):s.texImage2D(e,r,this.internalFormat,i,a,this.border,this.format,this.type,n),this},_uploadTexture:function(t){var e=this;return this.useMipmap&&this.mipmaps?this.mipmaps.forEach((function(n,r){e._glUploadTexture(t,e.target,n.data,r,n.width,n.height)})):this._glUploadTexture(t,this.target,this.image,0),this},updateTexture:function(t,e){var n=t.gl;if(this.needUpdate||this.autoUpdate){this._originImage&&this.image===this._canvasImage&&(this.image=this._originImage);var r=this.useMipmap,i=this.useRepeat;if(this.image&&!this.image.length){var a=i||r,s=this.getSupportSize(this.image,a);this.image=this.resizeImg(this.image,s.width,s.height),this.width=this.image.width,this.height=this.image.height}t.activeTexture(n.TEXTURE0+et.MAX_TEXTURE_INDEX),t.bindTexture(this.target,e),t.pixelStorei(n.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(n.UNPACK_FLIP_Y_WEBGL,!!this.flipY);var o=tt.textureFilterAnisotropic;o&&this.anisotropic>1&&n.texParameterf(this.target,o.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(this.anisotropic,et.MAX_TEXTURE_MAX_ANISOTROPY)),this._uploadTexture(t),r&&(this.compressed?this.mipmaps||(m.a.warn(\"Compressed texture has no mipmips, changed the minFilter from \".concat(this.minFilter,\" to Linear!\"),this),this.minFilter=Bt):n.generateMipmap(this.target)),n.texParameterf(this.target,n.TEXTURE_MAG_FILTER,this.magFilter),n.texParameterf(this.target,n.TEXTURE_MIN_FILTER,this.minFilter),n.texParameterf(this.target,n.TEXTURE_WRAP_S,this.wrapS),n.texParameterf(this.target,n.TEXTURE_WRAP_T,this.wrapT),this.needUpdate=!1}return this._needUpdateSubTexture&&(this._uploadSubTextures(t,e),this._needUpdateSubTexture=!1),this},_uploadSubTextures:function(t,e){var n=this;if(this._subTextureList&&this._subTextureList.length>0){var r=t.gl;t.activeTexture(r.TEXTURE0+et.MAX_TEXTURE_INDEX),t.bindTexture(this.target,e),t.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,this.premultiplyAlpha),t.pixelStorei(r.UNPACK_FLIP_Y_WEBGL,!!this.flipY),this._subTextureList.forEach((function(t){var e=t[0],i=t[1],a=t[2];r.texSubImage2D(n.target,0,e,i,n.format,n.type,a)})),this._subTextureList.length=0}},_needUpdateSubTexture:!1,_subTextureList:null,updateSubTexture:function(t,e,n){this._subTextureList||(this._subTextureList=[]),this._subTextureList.push([t,e,n]),this._needUpdateSubTexture=!0},getGLTexture:function(t){this.state=t;var e=this.gl=t.gl,n=this.id;this.needDestroy&&(this.destroy(),this.needDestroy=!1);var r=zt.get(n);return r||(r=e.createTexture(),zt.add(n,r),this.needUpdate=!0),this.updateTexture(t,r),this.isImageCanRelease&&this._releaseImage(),r},setGLTexture:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return e&&this.destroy(),zt.add(this.id,t),this},destroy:function(){var t=this.id,e=zt.get(t);return e&&this.gl&&(this.gl.deleteTexture(e),zt.remove(t)),this},clone:function(){var t=Object.assign({},this);return delete t.id,new this.constructor(t)}}),Wt=P.a.TEXTURE_2D,qt=P.a.RGBA,Zt=P.a.UNSIGNED_BYTE,Kt=P.a.COLOR_ATTACHMENT0,Qt=P.a.DEPTH_STENCIL,Jt=P.a.DEPTH_TEST,$t=P.a.CULL_FACE,te=P.a.TRIANGLE_STRIP,ee=P.a.NEAREST,ne=P.a.CLAMP_TO_EDGE,re=new J,ie=a.a.create({Statics:{cache:{get:function(){return re}},reset:function(t){re.each((function(t){t.reset()}))},destroy:function(t){re.each((function(t){t.destroy()}))}},className:\"Framebuffer\",isFramebuffer:!0,bufferInternalFormat:Qt,target:Wt,format:qt,internalFormat:qt,type:Zt,minFilter:ee,magFilter:ee,data:null,attachment:Kt,needRenderbuffer:!0,useVao:!0,renderer:null,texture:null,renderbuffer:null,framebuffer:null,_isInit:!1,constructor:function(t,e){this.id=d.a.generateUUID(this.className),this.renderer=t,Object.assign(this,e),this.width||(this.width=t.width),this.height||(this.height=t.height),re.add(this.id,this)},init:function(){if(!this._isInit&&this.renderer.isInit){this._isInit=!0;var t=this.renderer;this.gl=t.gl,this.state=t.state,this.reset()}},reset:function(){this.destroyResource();var t=this.gl;this.framebuffer=t.createFramebuffer(),this.bind(),this.needRenderbuffer&&(this.renderbuffer=this.createRenderbuffer()),this.texture=this.createTexture(),this.isComplete()||m.a.warn(\"Framebuffer is not complete => \"+t.checkFramebufferStatus(t.FRAMEBUFFER)),this.unbind()},isComplete:function(){var t=this.gl;return!(!t||t.checkFramebufferStatus(t.FRAMEBUFFER)!==t.FRAMEBUFFER_COMPLETE)},bind:function(){this.init(),this._isInit&&this.state.bindFramebuffer(this.gl.FRAMEBUFFER,this.framebuffer)},unbind:function(){if(this.init(),this._isInit){var t=this.state;t.bindFramebuffer(this.gl.FRAMEBUFFER,t.preFramebuffer)}},clear:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new v.a(0,0,0,0);if(this._isInit){var e=this.gl;e.clearColor(t.r,t.g,t.b,t.a),e.clear(e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT)}},render:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=arguments.length>4?arguments[4]:void 0;if(this._isInit){var a=this.gl,s=this.state;s.disable(Jt),s.disable($t),i&&this.clear(i);var o=dt.getCustomShader(_t.a,gt.a,\"\",\"FramebufferTextureShader\"),u=Lt.getProgram(o,s);u.useProgram();var c=\"\".concat(t,\"_\").concat(e,\"_\").concat(n,\"_\").concat(r,\"_\").concat(u.id),h=Ft.getVao(a,c,{useVao:this.useVao,useInstanced:!1,mode:te});if(h.isDirty){h.isDirty=!1;var f=[t=2*t-1,e=1-2*e,t+(n*=2),e,t,e-(r*=2),t+n,e-r];h.addAttribute(new C(new Float32Array(f),2),u.attributes.a_position),h.addAttribute(new C(new Float32Array([0,1,1,1,0,0,1,0]),2),u.attributes.a_texcoord0)}s.activeTexture(a.TEXTURE0),s.bindTexture(a.TEXTURE_2D,this.texture.getGLTexture(s)),h.draw()}},createRenderbuffer:function(){var t=this.gl,e=this.width,n=this.height,r=t.createRenderbuffer();return t.bindRenderbuffer(t.RENDERBUFFER,r),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e,n),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),r},createTexture:function(){var t=this.state,e=t.gl,n=new Yt({minFilter:this.minFilter,magFilter:this.magFilter,internalFormat:this.internalFormat,format:this.format,type:this.type,width:this.width,height:this.height,image:this.data,wrapS:ne,wrapT:ne}),r=n.getGLTexture(t);return e.framebufferTexture2D(e.FRAMEBUFFER,this.attachment,this.target,r,0),n},resize:function(t,e,n){(n||this.width!==t||this.height!==e)&&(this.width=t,this.height=e,this._isInit&&this.reset())},readPixels:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,a=Object(i.getTypedArrayClass)(this.type),s=new a(n*r*4);if(this._isInit){var o=this.gl;e=this.height-e-r,this.bind(),o.readPixels(t,e,n,r,this.format,this.type,s),this.unbind()}return s},destroy:function(){this.destroyResource(),this.gl=null,re.removeObject(this)},destroyResource:function(){var t=this.gl;t&&(this.framebuffer&&(t.deleteFramebuffer(this.framebuffer),this.framebuffer=null),this.renderbuffer&&(t.deleteRenderbuffer(this.renderbuffer),this.renderbuffer=null),this.texture&&(this.texture.destroy(),this.texture=null))}}),ae=P.a.TEXTURE_CUBE_MAP,se=P.a.RGB,oe=P.a.LINEAR,ue=P.a.CLAMP_TO_EDGE,ce=P.a.TEXTURE_CUBE_MAP_POSITIVE_X,he=a.a.create({Extends:Yt,isCubeTexture:!0,className:\"CubeTexture\",target:ae,internalFormat:se,format:se,magFilter:oe,minFilter:oe,wrapS:ue,wrapT:ue,constructor:function(t){he.superclass.constructor.call(this,t),this.image=this.image||[]},_uploadTexture:function(t){var e=this,n=this.image;Array.isArray(n)&&6===n.length?(n[0]&&n[0].width&&(this.width=n[0].width,this.height=n[0].height),n.forEach((function(n,r){e._glUploadTexture(t,ce+r,n,0)}))):m.a.error(\"CubeTexture image must be an Array of length 6\",n)},right:{get:function(){return this.image[0]},set:function(t){this.image[0]=t}},left:{get:function(){return this.image[1]},set:function(t){this.image[1]=t}},top:{get:function(){return this.image[2]},set:function(t){this.image[2]=t}},bottom:{get:function(){return this.image[3]},set:function(t){this.image[3]=t}},front:{get:function(){return this.image[4]},set:function(t){this.image[4]=t}},back:{get:function(){return this.image[5]},set:function(t){this.image[5]=t}}}),fe=he,le=P.a.TEXTURE_2D,de=P.a.RGBA,me=P.a.NEAREST,_e=P.a.CLAMP_TO_EDGE,pe=P.a.FLOAT,ge=a.a.create({Extends:Yt,isDataTexture:!0,className:\"DataTexture\",target:le,internalFormat:de,format:de,type:pe,magFilter:me,minFilter:me,wrapS:_e,wrapT:_e,dataLength:0,resetSize:function(t){if(t!==this.dataLength){this.dataLength=t;var e=d.a.nextPowerOfTwo(t/4),n=Math.max(Math.log2(e),4),r=Math.floor(n/2),a=n-r;this.width=Math.pow(2,r),this.height=Math.pow(2,a),this.DataClass=Object(i.getTypedArrayClass)(this.type)}},data:{get:function(){return this.image},set:function(t){if(this.image!==t){this.resetSize(t.length);var e=this.width*this.height*4;e===t.length&&t instanceof this.DataClass?this.image=t:(this.image&&this.image.length===e||(this.image=new this.DataClass(e)),this.image.set(t,0)),this.needUpdate=!0}}},constructor:function(t){ge.superclass.constructor.call(this,t)}}),ve=ge;function Ee(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(\"undefined\"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return Te(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(t);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Te(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function Te(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Me,Ae,Le,Oe,Ie,Se,Re=new c.a,ye=new y.a,xe=new o.a,Ne=new Float32Array([.5,.5,.5,1]),be=new Float32Array([0,0]),Ce={state:null,camera:null,lightManager:null,fog:null,gl:null,renderer:null,blankInfo:{get:function(){}},init:function(t,e,n,r,i){Se=this._renderer=t,Oe=this.state=e,Me=this.camera=n,Le=this.lightManager=r,Ie=this.fog=i,Ae=this.gl=Oe.gl},setCamera:function(t){Me=this.camera=t},handlerColorOrTexture:function(t,e){return t&&t.isTexture?this.handlerTexture(t,e):(t&&t.isColor?t.toArray(Ne):Ne[0]=Ne[1]=Ne[2]=.5,Ne)},handlerTexture:function(t,e){if(t&&t.isTexture)return this.handlerGLTexture(t.target,t.getGLTexture(Oe),e)},handlerGLTexture:function(t,e,n){if(e)return Oe.activeTexture(Ae.TEXTURE0+n),Oe.bindTexture(t,e),n},handlerUV:function(t){return t&&t.isTexture&&t.uv||0},POSITION:{get:function(t,e,n){return t.geometry.vertices}},NORMAL:{get:function(t,e,n){return t.geometry.normals}},TANGENT:{get:function(t,e,n){var r=e.normalMap||e.clearcoatNormalMap;return r&&r.isTexture&&1===Number(r.uv)?t.geometry.tangents1:t.geometry.tangents}},TEXCOORD_0:{get:function(t,e,n){if(t.geometry.uvs)return t.geometry.uvs}},TEXCOORD_1:{get:function(t,e,n){if(t.geometry.uvs1)return t.geometry.uvs1}},UVMATRIX_0:{get:function(t,e,n){if(e.uvMatrix)return e.uvMatrix.elements}},UVMATRIX_1:{get:function(t,e,n){if(e.uvMatrix1)return e.uvMatrix1.elements}},CAMERAFAR:{get:function(t,e,n){if(Me.isPerspectiveCamera)return Me.far}},CAMERANEAR:{get:function(t,e,n){if(Me.isPerspectiveCamera)return Me.near}},CAMERATYPE:{get:function(t,e,n){return Me.isPerspectiveCamera?1:0}},CAMERAPOSITION:{get:function(t,e,n){return Me.worldMatrix.getTranslation(Re).elements}},COLOR_0:{get:function(t,e,n){if(t.geometry.colors)return t.geometry.colors}},SKININDICES:{get:function(t,e,n){return t.geometry.skinIndices}},SKINWEIGHTS:{get:function(t,e,n){return t.geometry.skinWeights}},RENDERERSIZE:{get:function(t,e,n){return be[0]=Se.width,be[1]=Se.height,be}},LOCAL:{get:function(t,e,n){return t.matrix.elements},isDependMesh:!0},MODEL:{get:function(t,e,n){return t.worldMatrix.elements},isDependMesh:!0},VIEW:{get:function(t,e,n){return Me.viewMatrix.elements}},PROJECTION:{get:function(t,e,n){return Me.projectionMatrix.elements}},VIEWPROJECTION:{get:function(t,e,n){return Me.viewProjectionMatrix.elements}},MODELVIEW:{get:function(t,e,n){return Me.getModelViewMatrix(t,xe).elements},isDependMesh:!0},MODELVIEWPROJECTION:{get:function(t,e,n){return Me.getModelProjectionMatrix(t,xe).elements},isDependMesh:!0},MODELINVERSE:{get:function(t,e,n){return xe.invert(t.worldMatrix).elements},isDependMesh:!0},VIEWINVERSE:{get:function(t,e,n){return Me.worldMatrix.elements}},VIEWINVERSEINVERSETRANSPOSE:{get:function(t,e,n){return ye.normalFromMat4(Me.worldMatrix).elements}},PROJECTIONINVERSE:{get:function(t,e,n){return xe.invert(Me.projectionMatrix).elements}},MODELVIEWINVERSE:{get:function(t,e,n){return xe.invert(Me.getModelViewMatrix(t,xe)).elements},isDependMesh:!0},MODELVIEWPROJECTIONINVERSE:{get:function(t,e,n){return xe.invert(Me.getModelProjectionMatrix(t,xe)).elements},isDependMesh:!0},MODELINVERSETRANSPOSE:{get:function(t,e,n){return ye.normalFromMat4(t.worldMatrix).elements},isDependMesh:!0},MODELVIEWINVERSETRANSPOSE:{get:function(t,e,n){return ye.normalFromMat4(Me.getModelViewMatrix(t,xe)).elements},isDependMesh:!0},VIEWPORT:void 0,JOINTMATRIX:{get:function(t,e,n){if(t.isSkinedMesh)return t.getJointMat();m.a.warnOnce(\"semantic.JOINTMATRIX(\".concat(t.id,\")\"),\"Current mesh is not SkinedMesh!\",t.id)},isDependMesh:!0,notSupportInstanced:!0},JOINTMATRIXTEXTURE:{get:function(t,e,n){if(t.isSkinedMesh)return t.updateJointMatTexture(),Ce.handlerTexture(t.jointMatTexture,n.textureIndex);m.a.warnOnce(\"semantic.JOINTMATRIXTEXTURE(\".concat(t.id,\")\"),\"Current mesh is not SkinedMesh!\",t.id)},isDependMesh:!0,notSupportInstanced:!0},JOINTMATRIXTEXTURESIZE:{get:function(t,e,n){if(t.isSkinedMesh)return t.initJointMatTexture(),[t.jointMatTexture.width,t.jointMatTexture.height];m.a.warnOnce(\"semantic.JOINTMATRIXTEXTURESIZE(\".concat(t.id,\")\"),\"Current mesh is not SkinedMesh!\",t.id)},isDependMesh:!0,notSupportInstanced:!0},NORMALMAPSCALE:{get:function(t,e,n){return e.normalMapScale}},OCCLUSIONSTRENGTH:{get:function(t,e,n){return e.occlusionStrength}},SHININESS:{get:function(t,e,n){return e.shininess}},SPECULARENVMATRIX:{get:function(t,e,n){return e.specularEnvMatrix&&e.specularEnvMap?e.specularEnvMatrix.elements:(xe.identity(),xe.elements)}},REFLECTIVITY:{get:function(t,e,n){return e.reflectivity}},REFRACTRATIO:{get:function(t,e,n){return e.refractRatio}},REFRACTIVITY:{get:function(t,e,n){return e.refractivity}},LOGDEPTH:{get:function(t,e,n){return 2/(Math.log(Me.far+1)/Math.LN2)}},AMBIENTLIGHTSCOLOR:{get:function(t,e,n){return Le.ambientInfo}},DIRECTIONALLIGHTSCOLOR:{get:function(t,e,n){return Le.directionalInfo.colors}},DIRECTIONALLIGHTSINFO:{get:function(t,e,n){return Le.directionalInfo.infos}},DIRECTIONALLIGHTSSHADOWMAP:{get:function(t,e,n){return Le.directionalInfo.shadowMap.map((function(t,e){return Ce.handlerTexture(t,n.textureIndex+e)}))}},DIRECTIONALLIGHTSSHADOWMAPSIZE:{get:function(t,e,n){return Le.directionalInfo.shadowMapSize}},DIRECTIONALLIGHTSSHADOWBIAS:{get:function(t,e,n){return Le.directionalInfo.shadowBias}},DIRECTIONALLIGHTSPACEMATRIX:{get:function(t,e,n){return Le.directionalInfo.lightSpaceMatrix}},POINTLIGHTSPOS:{get:function(t,e,n){return Le.pointInfo.poses}},POINTLIGHTSCOLOR:{get:function(t,e,n){return Le.pointInfo.colors}},POINTLIGHTSINFO:{get:function(t,e,n){return Le.pointInfo.infos}},POINTLIGHTSRANGE:{get:function(t,e,n){return Le.pointInfo.ranges}},POINTLIGHTSSHADOWMAP:{get:function(t,e,n){return Le.pointInfo.shadowMap.map((function(t,e){return Ce.handlerTexture(t,n.textureIndex+e)}))}},POINTLIGHTSSHADOWBIAS:{get:function(t,e,n){return Le.pointInfo.shadowBias}},POINTLIGHTSPACEMATRIX:{get:function(t,e,n){return Le.pointInfo.lightSpaceMatrix}},POINTLIGHTCAMERA:{get:function(t,e,n){return Le.pointInfo.cameras}},SPOTLIGHTSPOS:{get:function(t,e,n){return Le.spotInfo.poses}},SPOTLIGHTSDIR:{get:function(t,e,n){return Le.spotInfo.dirs}},SPOTLIGHTSCOLOR:{get:function(t,e,n){return Le.spotInfo.colors}},SPOTLIGHTSCUTOFFS:{get:function(t,e,n){return Le.spotInfo.cutoffs}},SPOTLIGHTSINFO:{get:function(t,e,n){return Le.spotInfo.infos}},SPOTLIGHTSRANGE:{get:function(t,e,n){return Le.spotInfo.ranges}},SPOTLIGHTSSHADOWMAP:{get:function(t,e,n){return Le.spotInfo.shadowMap.map((function(t,e){return Ce.handlerTexture(t,n.textureIndex+e)}))}},SPOTLIGHTSSHADOWMAPSIZE:{get:function(t,e,n){return Le.spotInfo.shadowMapSize}},SPOTLIGHTSSHADOWBIAS:{get:function(t,e,n){return Le.spotInfo.shadowBias}},SPOTLIGHTSPACEMATRIX:{get:function(t,e,n){return Le.spotInfo.lightSpaceMatrix}},AREALIGHTSCOLOR:{get:function(t,e,n){return Le.areaInfo.colors}},AREALIGHTSPOS:{get:function(t,e,n){return Le.areaInfo.poses}},AREALIGHTSWIDTH:{get:function(t,e,n){return Le.areaInfo.width}},AREALIGHTSHEIGHT:{get:function(t,e,n){return Le.areaInfo.height}},AREALIGHTSLTCTEXTURE1:{get:function(t,e,n){return Ce.handlerTexture(Le.areaInfo.ltcTexture1,n.textureIndex)}},AREALIGHTSLTCTEXTURE2:{get:function(t,e,n){return Ce.handlerTexture(Le.areaInfo.ltcTexture2,n.textureIndex)}},FOGCOLOR:{get:function(t,e,n){if(Ie)return Ie.color.elements}},FOGINFO:{get:function(t,e,n){if(Ie)return Ie.getInfo()}},POSITIONDECODEMAT:{get:function(t,e,n){return t.geometry.positionDecodeMat},isDependMesh:!0},NORMALDECODEMAT:{get:function(t,e,n){return t.geometry.normalDecodeMat},isDependMesh:!0},UVDECODEMAT:{get:function(t,e,n){return t.geometry.uvDecodeMat},isDependMesh:!0},UV1DECODEMAT:{get:function(t,e,n){return t.geometry.uv1DecodeMat},isDependMesh:!0},BASECOLOR:{get:function(t,e,n){return e.baseColor.elements}},METALLIC:{get:function(t,e,n){return e.metallic}},ROUGHNESS:{get:function(t,e,n){return e.roughness}},DIFFUSEENVMAP:{get:function(t,e,n){return Ce.handlerTexture(e.diffuseEnvMap,n.textureIndex)}},DIFFUSEENVINTENSITY:{get:function(t,e,n){return e.diffuseEnvIntensity}},DIFFUSEENVSPHEREHARMONICS3:{get:function(t,e,n){var r=e.diffuseEnvSphereHarmonics3;if(r)return r.toArray()}},BRDFLUT:{get:function(t,e,n){return Ce.handlerTexture(e.brdfLUT,n.textureIndex)}},SPECULARENVMAP:{get:function(t,e,n){return Ce.handlerTexture(e.specularEnvMap,n.textureIndex)}},SPECULARENVINTENSITY:{get:function(t,e,n){return e.specularEnvIntensity}},SPECULARENVMAPMIPCOUNT:{get:function(t,e,n){var r=e.specularEnvMap;return r?r.mipmapCount:1}},GLOSSINESS:{get:function(t,e,n){return e.glossiness}},ALPHACUTOFF:{get:function(t,e,n){return e.alphaCutoff}},EXPOSURE:{get:function(t,e,n){return e.exposure}},GAMMAFACTOR:{get:function(t,e,n){return e.gammaFactor}},MORPHWEIGHTS:{isDependMesh:!0,notSupportInstanced:!0,get:function(t,e,n){var r=t.geometry;if(r.isMorphGeometry&&r.weights)return r.weights}},CLEARCOATFACTOR:{isDependMesh:!1,notSupportInstanced:!1,get:function(t,e,n){return e.clearcoatFactor}},CLEARCOATROUGHNESSFACTOR:{isDependMesh:!1,notSupportInstanced:!1,get:function(t,e,n){return e.clearcoatRoughnessFactor}}};[[\"POSITION\",\"vertices\"],[\"NORMAL\",\"normals\"],[\"TANGENT\",\"tangents\"]].forEach((function(t){for(var e=0;e<8;e++)Ce[\"MORPH\"+t[0]+e]={get:function(t,e){return function(n,r,i){var a=n.geometry;if(a.isMorphGeometry&&a.targets&&a.targets[t]){var s=a._originalMorphIndices?a._originalMorphIndices[e]:e,o=a.targets[t][s],u=\"_target_\".concat(t,\"_\").concat(e);return a[u]!==s&&o&&(o.isDirty=!0,a[u]=s),o}}}(t[1],e)}})),[[\"DIFFUSE\",\"diffuse\"],[\"SPECULAR\",\"specular\"],[\"EMISSION\",\"emission\"],[\"AMBIENT\",\"ambient\"]].forEach((function(t){var e=Ee(t,2),n=e[0],r=e[1];Ce[n]={get:function(t,e,n){return Ce.handlerColorOrTexture(e[r],n.textureIndex)}},Ce[\"\".concat(n,\"UV\")]={get:function(t,e,n){return Ce.handlerUV(e[r])}}})),[[\"NORMALMAP\",\"normalMap\"],[\"PARALLAXMAP\",\"parallaxMap\"],[\"BASECOLORMAP\",\"baseColorMap\"],[\"METALLICMAP\",\"metallicMap\"],[\"ROUGHNESSMAP\",\"roughnessMap\"],[\"METALLICROUGHNESSMAP\",\"metallicRoughnessMap\"],[\"OCCLUSIONMAP\",\"occlusionMap\"],[\"SPECULARGLOSSINESSMAP\",\"specularGlossinessMap\"],[\"LIGHTMAP\",\"lightMap\"],[\"CLEARCOATMAP\",\"clearcoatMap\"],[\"CLEARCOATROUGHNESSMAP\",\"clearcoatRoughnessMap\"],[\"CLEARCOATNORMALMAP\",\"clearcoatNormalMap\"]].forEach((function(t){var e=Ee(t,2),n=e[0],r=e[1];Ce[n]={get:function(t,e,n){return Ce.handlerTexture(e[r],n.textureIndex)}},Ce[\"\".concat(n,\"UV\")]={get:function(t,e,n){return Ce.handlerUV(e[r])}}})),[[\"TRANSPARENCY\",\"transparency\"]].forEach((function(t){var e=Ee(t,2),n=e[0],r=e[1];Ce[n]={get:function(t,e,n){var i=e[r];return i&&i.isTexture?Ce.handlerTexture(i,n.textureIndex):null!=i?i:1}},Ce[\"\".concat(n,\"UV\")]={get:function(t,e,n){return Ce.handlerUV(e[r])}}}));var Pe=Ce,we=P.a.LEQUAL,He=P.a.BACK,De=P.a.FRONT,Fe=P.a.FRONT_AND_BACK,Ue=P.a.ZERO,Ge=P.a.FUNC_ADD,Be=P.a.ONE,Ve=P.a.SRC_ALPHA,Xe=P.a.ONE_MINUS_SRC_ALPHA,je=P.a.CCW,ke=P.a.ALWAYS,ze=P.a.KEEP,Ye={isBlankInfo:!0,get:function(){}},We=a.a.create({isMaterial:!0,className:\"Material\",name:null,shaderCacheId:null,lightType:\"NONE\",wireframe:!1,frontFace:je,depthTest:!0,sampleAlphaToCoverage:!1,depthMask:!0,depthRange:[0,1],depthFunc:we,_cullFace:!0,normalMap:null,parallaxMap:null,normalMapScale:1,ignoreTranparent:!1,gammaCorrection:!1,usePhysicsLight:!1,isDiffuesEnvAndAmbientLightWorkTogether:!1,userData:null,renderOrder:0,_premultiplyAlpha:!0,premultiplyAlpha:{get:function(){return this._premultiplyAlpha},set:function(t){this._premultiplyAlpha=t,this.transparent&&this.setDefaultTransparentBlend()}},gammaOutput:{get:function(){return m.a.warnOnce(\"Matrial.gammaOutput\",\"material.gammaOutput has deprecated. Use material.gammaCorrection instead.\"),this.gammaCorrection},set:function(t){m.a.warnOnce(\"Matrial.gammaOutput\",\"material.gammaOutput has deprecated. Use material.gammaCorrection instead.\"),this.gammaCorrection=t}},gammaFactor:2.2,castShadows:!0,receiveShadows:!0,uvMatrix:null,uvMatrix1:null,cullFace:{get:function(){return this._cullFace},set:function(t){this._cullFace=t,t?this.cullFaceType=this._cullFaceType:this._side=Fe}},_cullFaceType:He,cullFaceType:{get:function(){return this._cullFaceType},set:function(t){this._cullFaceType=t,this._cullFace&&(t===He?this._side=De:t===De&&(this._side=He))}},_side:De,side:{get:function(){return this._side},set:function(t){this._side!==t&&(this._side=t,t===Fe?this._cullFace=!1:(this._cullFace=!0,t===De?this._cullFaceType=He:t===He&&(this._cullFaceType=De)))}},blend:!1,blendEquation:Ge,blendEquationAlpha:Ge,blendSrc:Be,blendDst:Ue,blendSrcAlpha:Be,blendDstAlpha:Ue,stencilTest:!1,stencilMask:255,stencilFunc:ke,stencilFuncRef:1,stencilFuncMask:255,stencilOpFail:ze,stencilOpZFail:ze,stencilOpZPass:ze,isDirty:!1,transparency:1,_transparent:!1,transparent:{get:function(){return this._transparent},set:function(t){this._transparent!==t&&(this._transparent=t,t?this.setDefaultTransparentBlend():(this.blend=!1,this.depthMask=!0))}},setDefaultTransparentBlend:function(){this.blend=!0,this.depthMask=!1,this.premultiplyAlpha?(this.blendSrc=Be,this.blendDst=Xe,this.blendSrcAlpha=Be,this.blendDstAlpha=Xe):(this.blendSrc=Ve,this.blendDst=Xe,this.blendSrcAlpha=Ve,this.blendDstAlpha=Xe)},alphaCutoff:0,useHDR:!1,exposure:1,needBasicUnifroms:!0,needBasicAttributes:!0,constructor:function(t){this.id=d.a.generateUUID(this.className),this.uniforms={},this.attributes={},Object.assign(this,t),this.needBasicAttributes&&this.addBasicAttributes(),this.needBasicUnifroms&&this.addBasicUniforms()},addBasicAttributes:function(){var t=this.attributes;this._copyProps(t,{a_position:\"POSITION\",a_normal:\"NORMAL\",a_tangent:\"TANGENT\",a_texcoord0:\"TEXCOORD_0\",a_texcoord1:\"TEXCOORD_1\",a_color:\"COLOR_0\",a_skinIndices:\"SKININDICES\",a_skinWeights:\"SKINWEIGHTS\"}),[\"POSITION\",\"NORMAL\",\"TANGENT\"].forEach((function(e){for(var n=e.slice(0,1)+e.slice(1).toLowerCase(),r=0;r<8;r++){var i=\"a_morph\"+n+r;void 0===t[i]&&(t[i]=\"MORPH\"+e+r)}}))},addBasicUniforms:function(){this._copyProps(this.uniforms,{u_modelMatrix:\"MODEL\",u_viewMatrix:\"VIEW\",u_projectionMatrix:\"PROJECTION\",u_modelViewMatrix:\"MODELVIEW\",u_modelViewProjectionMatrix:\"MODELVIEWPROJECTION\",u_viewInverseNormalMatrix:\"VIEWINVERSEINVERSETRANSPOSE\",u_normalMatrix:\"MODELVIEWINVERSETRANSPOSE\",u_normalWorldMatrix:\"MODELINVERSETRANSPOSE\",u_cameraPosition:\"CAMERAPOSITION\",u_rendererSize:\"RENDERERSIZE\",u_logDepth:\"LOGDEPTH\",u_ambientLightsColor:\"AMBIENTLIGHTSCOLOR\",u_directionalLightsColor:\"DIRECTIONALLIGHTSCOLOR\",u_directionalLightsInfo:\"DIRECTIONALLIGHTSINFO\",u_directionalLightsShadowMap:\"DIRECTIONALLIGHTSSHADOWMAP\",u_directionalLightsShadowMapSize:\"DIRECTIONALLIGHTSSHADOWMAPSIZE\",u_directionalLightsShadowBias:\"DIRECTIONALLIGHTSSHADOWBIAS\",u_directionalLightSpaceMatrix:\"DIRECTIONALLIGHTSPACEMATRIX\",u_pointLightsPos:\"POINTLIGHTSPOS\",u_pointLightsColor:\"POINTLIGHTSCOLOR\",u_pointLightsInfo:\"POINTLIGHTSINFO\",u_pointLightsRange:\"POINTLIGHTSRANGE\",u_pointLightsShadowBias:\"POINTLIGHTSSHADOWBIAS\",u_pointLightsShadowMap:\"POINTLIGHTSSHADOWMAP\",u_pointLightSpaceMatrix:\"POINTLIGHTSPACEMATRIX\",u_pointLightCamera:\"POINTLIGHTCAMERA\",u_spotLightsPos:\"SPOTLIGHTSPOS\",u_spotLightsDir:\"SPOTLIGHTSDIR\",u_spotLightsColor:\"SPOTLIGHTSCOLOR\",u_spotLightsCutoffs:\"SPOTLIGHTSCUTOFFS\",u_spotLightsInfo:\"SPOTLIGHTSINFO\",u_spotLightsRange:\"SPOTLIGHTSRANGE\",u_spotLightsShadowMap:\"SPOTLIGHTSSHADOWMAP\",u_spotLightsShadowMapSize:\"SPOTLIGHTSSHADOWMAPSIZE\",u_spotLightsShadowBias:\"SPOTLIGHTSSHADOWBIAS\",u_spotLightSpaceMatrix:\"SPOTLIGHTSPACEMATRIX\",u_areaLightsPos:\"AREALIGHTSPOS\",u_areaLightsColor:\"AREALIGHTSCOLOR\",u_areaLightsWidth:\"AREALIGHTSWIDTH\",u_areaLightsHeight:\"AREALIGHTSHEIGHT\",u_areaLightsLtcTexture1:\"AREALIGHTSLTCTEXTURE1\",u_areaLightsLtcTexture2:\"AREALIGHTSLTCTEXTURE2\",u_jointMat:\"JOINTMATRIX\",u_jointMatTexture:\"JOINTMATRIXTEXTURE\",u_jointMatTextureSize:\"JOINTMATRIXTEXTURESIZE\",u_positionDecodeMat:\"POSITIONDECODEMAT\",u_normalDecodeMat:\"NORMALDECODEMAT\",u_uvDecodeMat:\"UVDECODEMAT\",u_uv1DecodeMat:\"UV1DECODEMAT\",u_morphWeights:\"MORPHWEIGHTS\",u_normalMapScale:\"NORMALMAPSCALE\",u_emission:\"EMISSION\",u_transparency:\"TRANSPARENCY\",u_uvMatrix:\"UVMATRIX_0\",u_uvMatrix1:\"UVMATRIX_1\",u_fogColor:\"FOGCOLOR\",u_fogInfo:\"FOGINFO\",u_alphaCutoff:\"ALPHACUTOFF\",u_exposure:\"EXPOSURE\",u_gammaFactor:\"GAMMAFACTOR\"}),this.addTextureUniforms({u_normalMap:\"NORMALMAP\",u_parallaxMap:\"PARALLAXMAP\",u_emission:\"EMISSION\",u_transparency:\"TRANSPARENCY\"})},addTextureUniforms:function(t){var e={};for(var n in t){var r=t[n];e[n]=r,e[\"\".concat(n,\".texture\")]=r,e[\"\".concat(n,\".uv\")]=\"\".concat(r,\"UV\")}this._copyProps(this.uniforms,e)},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=this.lightType;e[\"LIGHT_TYPE_\".concat(n)]=1,e.SIDE=this.side,\"NONE\"!==n&&(e.HAS_LIGHT=1),this.premultiplyAlpha&&(e.PREMULTIPLY_ALPHA=1);var r=this._textureOption.reset(e);return e.HAS_LIGHT&&(e.HAS_NORMAL=1,r.add(this.normalMap,\"NORMAL_MAP\",(function(){1!==t.normalMapScale&&(e.NORMAL_MAP_SCALE=1)}))),r.add(this.parallaxMap,\"PARALLAX_MAP\"),r.add(this.emission,\"EMISSION_MAP\"),r.add(this.transparency,\"TRANSPARENCY_MAP\"),this.ignoreTranparent&&(e.IGNORE_TRANSPARENT=1),this.alphaCutoff>0&&(e.ALPHA_CUTOFF=1),this.useHDR&&(e.USE_HDR=1),this.gammaCorrection&&(e.GAMMA_CORRECTION=1),this.receiveShadows&&(e.RECEIVE_SHADOWS=1),this.castShadows&&(e.CAST_SHADOWS=1),this.uvMatrix&&(e.UV_MATRIX=1),this.uvMatrix1&&(e.UV_MATRIX1=1),this.usePhysicsLight&&(e.USE_PHYSICS_LIGHT=1),this.isDiffuesEnvAndAmbientLightWorkTogether&&(e.IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER=1),r.update(),e},_textureOption:{uvTypes:null,option:null,reset:function(t){return this.option=t,this.uvTypes={},this},add:function(t,e,n){if(t&&t.isTexture){var r=this.uvTypes,i=this.option,a=t.uv||0;r[a]=1,i[e]=a,t.isCubeTexture&&(i[\"\".concat(e,\"_CUBE\")]=1),n&&n(t)}return this},update:function(){var t=[0,1],e=this.uvTypes,n=this.option;for(var r in e)-1!==t.indexOf(Number(r))?n[\"HAS_TEXCOORD\".concat(r)]=1:(m.a.warnOnce(\"Material._textureOption.update(\".concat(r,\")\"),\"uv_\".concat(r,\" not support!\")),n.HAS_TEXCOORD0=1);return this}},getInstancedUniforms:function(){var t=this._instancedUniforms;if(!this._instancedUniforms){var e=this.uniforms;for(var n in t=this._instancedUniforms=[],e){var r=this.getUniformInfo(n);r.isDependMesh&&!r.notSupportInstanced&&t.push({name:n,info:r})}}return t},getUniformData:function(t,e,n){return this.getUniformInfo(t).get(e,this,n)},getAttributeData:function(t,e,n){return this.getAttributeInfo(t).get(e,this,n)},getUniformInfo:function(t){return this.getInfo(\"uniforms\",t)},getAttributeInfo:function(t){return this.getInfo(\"attributes\",t)},getInfo:function(t,e){var n=this[t][e];return\"string\"==typeof n&&(n=Pe[n]),n&&n.get||(m.a.warnOnce(\"material.getInfo-\"+e,\"Material.getInfo: no this semantic:\"+e),n=Ye),n},clone:function(){var t=new this.constructor;for(var e in this)\"id\"!==e&&(t[e]=this[e]);return t},destroyTextures:function(){this.getTextures().forEach((function(t){t.destroy()}))},getTextures:function(){var t=[];for(var e in this){var n=this[e];n&&n.isTexture&&t.push(n)}return t},_copyProps:function(t,e){for(var n in e)void 0===t[n]&&(t[n]=e[n])}}),qe=a.a.create({Extends:We,isBasicMaterial:!0,className:\"BasicMaterial\",lightType:\"BLINN-PHONG\",diffuse:null,ambient:null,specular:null,emission:null,specularEnvMap:null,specularEnvMatrix:null,reflectivity:0,refractRatio:0,refractivity:0,shininess:32,usedUniformVectors:11,constructor:function(t){this.diffuse=new v.a(.5,.5,.5),this.specular=new v.a(1,1,1),this.emission=new v.a(0,0,0),qe.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_diffuse:\"DIFFUSE\",u_specular:\"SPECULAR\",u_ambient:\"AMBIENT\",u_shininess:\"SHININESS\",u_reflectivity:\"REFLECTIVITY\",u_refractRatio:\"REFRACTRATIO\",u_refractivity:\"REFRACTIVITY\",u_specularEnvMap:\"SPECULARENVMAP\",u_specularEnvMatrix:\"SPECULARENVMATRIX\"}),this.addTextureUniforms({u_diffuse:\"DIFFUSE\",u_specular:\"SPECULAR\",u_ambient:\"AMBIENT\"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};qe.superclass.getRenderOption.call(this,t);var e=this._textureOption.reset(t),n=this.lightType;\"PHONG\"!==n&&\"BLINN-PHONG\"!==n||(t.HAS_SPECULAR=1);var r=this.diffuse;return r&&r.isTexture&&(r.isCubeTexture?t.DIFFUSE_CUBE_MAP=1:e.add(this.diffuse,\"DIFFUSE_MAP\")),t.HAS_LIGHT&&(e.add(this.specular,\"SPECULAR_MAP\"),e.add(this.ambient,\"AMBIENT_MAP\"),e.add(this.specularEnvMap,\"SPECULAR_ENV_MAP\")),e.update(),t}}),Ze=qe,Ke=P.a.POSITION,Qe=P.a.NORMAL,Je=P.a.DEPTH,$e=P.a.DISTANCE,tn=P.a.NONE,en=a.a.create({Extends:Ze,isGeometryMaterial:!0,className:\"GeometryMaterial\",vertexType:Ke,lightType:tn,writeOriginData:!1,constructor:function(t){en.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_cameraFar:\"CAMERAFAR\",u_cameraNear:\"CAMERANEAR\",u_cameraType:\"CAMERATYPE\"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};switch(en.superclass.getRenderOption.call(this,t),t[\"VERTEX_TYPE_\".concat(this.vertexType)]=1,this.vertexType){case Ke:t.HAS_FRAG_POS=1;break;case Qe:t.HAS_NORMAL=1;break;case Je:break;case $e:t.HAS_FRAG_POS=1}return this.writeOriginData&&(t.WRITE_ORIGIN_DATA=1),t}}),nn=en,rn=a.a.create({Extends:I,isOrthographicCamera:!0,className:\"OrthographicCamera\",_left:-1,left:{get:function(){return this._left},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._left=t}},_right:1,right:{get:function(){return this._right},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._right=t}},_bottom:-1,bottom:{get:function(){return this._bottom},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._bottom=t}},_top:1,top:{get:function(){return this._top},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._top=t}},_near:.1,near:{get:function(){return this._near},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._near=t}},_far:1,far:{get:function(){return this._far},set:function(t){this._needUpdateProjectionMatrix=!0,this._isGeometryDirty=!0,this._far=t}},constructor:function(t){rn.superclass.constructor.call(this,t),this.updateProjectionMatrix()},updateProjectionMatrix:function(){this.projectionMatrix.ortho(this.left,this.right,this.bottom,this.top,this.near,this.far)},getGeometry:function(t){if(t||!this._geometry||this._isGeometryDirty){this._isGeometryDirty=!1;var e=new Z,n=[this.left,this.bottom,-this.near],r=[this.right,this.bottom,-this.near],i=[this.right,this.top,-this.near],a=[this.left,this.top,-this.near],s=[this.left,this.bottom,-this.far],o=[this.right,this.bottom,-this.far],u=[this.right,this.top,-this.far],c=[this.left,this.top,-this.far];e.addRect(s,o,u,c),e.addRect(o,r,i,u),e.addRect(r,n,a,i),e.addRect(n,s,c,a),e.addRect(c,u,i,a),e.addRect(n,r,o,s),this._geometry=e}return this._geometry}}),an=rn,sn=P.a.DEPTH,on=P.a.BACK,un=null,cn=new v.a(1,1,1),hn=new o.a,fn=function(t){return t.material.castShadows},ln=a.a.create({isLightShadow:!0,className:\"LightShadow\",light:null,renderer:null,framebuffer:null,camera:null,width:1024,height:1024,maxBias:.05,minBias:.005,cameraInfo:null,debug:!1,constructor:function(t){this.id=d.a.generateUUID(this.className),Object.assign(this,t)},createFramebuffer:function(){this.framebuffer||(this.framebuffer=new ie(this.renderer,{width:this.width,height:this.height}),this.debug&&this.showShadowMap())},updateLightCamera:function(t){this.light.isDirectionalLight?this.updateDirectionalLightCamera(t):this.light.isSpotLight&&this.updateSpotLightCamera(t)},updateDirectionalLightCamera:function(t){var e=this.light;if(this.camera.lookAt(e.direction),this.cameraInfo)this.updateCustumCamera(this.cameraInfo);else{var n=t.getGeometry();if(n){this.camera.updateViewMatrix(),hn.multiply(this.camera.viewMatrix,t.worldMatrix);var r=n.getBounds(hn);this.camera.near=-r.zMax,this.camera.far=-r.zMin,this.camera.left=r.xMin,this.camera.right=r.xMax,this.camera.bottom=r.yMin,this.camera.top=r.yMax}}this.camera.updateViewMatrix()},updateCustumCamera:function(t){for(var e in t)this.camera[e]=t[e]},updateSpotLightCamera:function(t){var e=this.light;this.camera.lookAt(e.direction),this.cameraInfo?this.updateCustumCamera(this.cameraInfo):(this.camera.fov=2*e.outerCutoff,this.camera.near=.01,this.camera.far=t.far,this.camera.aspect=1),this.camera.updateViewMatrix()},createCamera:function(t){this.camera||(this.light.isDirectionalLight?this.camera=new an:this.light.isSpotLight&&(this.camera=new Q),this.camera.addTo(this.light)),(this.light.isDirty||this._cameraMatrixVersion!==t.matrixVersion)&&(this.updateLightCamera(t),this._cameraMatrixVersion=t.matrixVersion,this.light.isDirty=!1)},createShadowMap:function(t){this.createFramebuffer(),this.createCamera(t);var e=this.renderer,n=this.framebuffer,r=this.camera;un||(un=new nn({vertexType:sn,side:on,writeOriginData:!0})),n.bind(),e.state.viewport(0,0,this.width,this.height),e.clear(cn),r.updateViewProjectionMatrix(),Pe.setCamera(r),e.forceMaterial=un,this.renderShadowScene(e),delete e.forceMaterial,n.unbind(),Pe.setCamera(t),e.viewport()},renderShadowScene:function(t){t.renderList.traverse((function(e){fn(e)&&t.renderMesh(e)}),(function(e){t.renderInstancedMeshes(e.filter((function(t){return fn(t)})))}))},showShadowMap:function(){var t=this;this.renderer.on(\"afterRender\",(function(){t.framebuffer.render(0,.7,.3,.3)}))}}),dn=P.a.DISTANCE,mn=P.a.BACK,_n=P.a.TEXTURE_CUBE_MAP,pn=P.a.TEXTURE0,gn=P.a.TEXTURE_CUBE_MAP_POSITIVE_X,vn=P.a.NEAREST,En=P.a.FRAMEBUFFER,Tn=P.a.FRAMEBUFFER_COMPLETE,Mn=null,An=new v.a(0,0,0,0),Ln=new c.a,On=[[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],[0,-1,0,0,-1,0,0,0,1,0,0,-1,0,-1,0,0,-1,0]],In=function(t,e){if(t.material.castShadows){if(!t.frustumTest)return!0;if(e.isMeshVisible(t))return!0}return!1},Sn=a.a.create({isLightShadow:!0,className:\"CubeLightShadow\",Extends:ln,light:null,renderer:null,framebuffer:null,camera:null,width:1024,height:1024,maxBias:.05,minBias:.005,debug:!1,constructor:function(t){Sn.superclass.constructor.call(this,t)},createFramebuffer:function(){if(!this.framebuffer){this.framebuffer=new ie(this.renderer,{target:_n,width:1024,height:1024,createTexture:function(){var t=this.state.gl,e=new fe({image:[null,null,null,null,null,null],type:this.type,format:this.format,internalFormat:this.internalFormat,magFilter:vn,minFilter:vn,width:1024,height:1024});return t.checkFramebufferStatus(En)!==Tn&&m.a.warn(\"Framebuffer is not complete\",t.checkFramebufferStatus(En)),e},bindTexture:function(t){t=t||0;var e=this.state,n=e.gl,r=this.texture.getGLTexture(e);e.activeTexture(pn+et.MAX_TEXTURE_INDEX),e.bindTexture(this.target,r),n.framebufferTexture2D(En,this.attachment,gn+t,r,0)}})}},updateLightCamera:function(t){this.camera.fov=90,this.camera.near=t.near,this.camera.far=t.far,this.camera.aspect=1,this.camera.updateViewMatrix()},createCamera:function(t){this.camera||(this.camera=new Q,this.updateLightCamera(t))},createShadowMap:function(t){this.createFramebuffer(),this.createCamera(t);var e=this.renderer,n=this.framebuffer,r=this.camera;Mn||(Mn=new nn({vertexType:dn,side:mn,writeOriginData:!1})),n.bind(),e.state.viewport(0,0,n.width,n.height),this.light.worldMatrix.getTranslation(r.position);for(var i=0;i<6;i++)n.bindTexture(i),Ln.fromArray(On[0],3*i).add(r.position),r.up.fromArray(On[1],3*i),r.lookAt(Ln),r.updateViewProjectionMatrix(),e.clear(An),Pe.setCamera(r),e.forceMaterial=Mn,this.renderShadowScene(e);r.matrix.identity(),r.updateViewProjectionMatrix(),delete e.forceMaterial,n.unbind(),Pe.setCamera(t),e.viewport()},renderShadowScene:function(t){var e=t.renderList,n=this.camera;e.traverse((function(e){In(e,n)&&t.renderMesh(e)}),(function(e){var r=e.filter((function(t){return In(t,n)}));t.renderInstancedMeshes(r)}))}}),Rn=Sn,yn=a.a.create({Extends:M,isPointLight:!0,className:\"PointLight\",constructor:function(t){yn.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new Rn({light:this,renderer:t}),\"minBias\"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),\"maxBias\"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))}}),xn=yn,Nn=new o.a,bn=new c.a,Cn=a.a.create({Extends:M,isDirectionalLight:!0,className:\"DirectionalLight\",constructor:function(t){this.direction=new c.a(0,0,1),Cn.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new ln({light:this,renderer:t,width:this.shadow.width||t.width,height:this.shadow.height||t.height,debug:this.shadow.debug,cameraInfo:this.shadow.cameraInfo}),\"minBias\"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),\"maxBias\"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))},getWorldDirection:function(){return bn.copy(this.direction).transformDirection(this.worldMatrix).normalize(),bn},getViewDirection:function(t){var e=t.getModelViewMatrix(this,Nn);return bn.copy(this.direction).transformDirection(e).normalize(),bn}}),Pn=Cn,wn=new o.a,Hn=new c.a,Dn=a.a.create({Extends:M,isSpotLight:!0,className:\"SpotLight\",_cutoffCos:.9763,_cutoff:12.5,cutoff:{get:function(){return this._cutoff},set:function(t){this._cutoff=t,this._cutoffCos=Math.cos(d.a.degToRad(t))}},_outerCutoffCos:.9537,_outerCutoff:17.5,outerCutoff:{get:function(){return this._outerCutoff},set:function(t){this._outerCutoff=t,this._outerCutoffCos=Math.cos(d.a.degToRad(t))}},constructor:function(t){this.direction=new c.a(0,0,1),Dn.superclass.constructor.call(this,t)},createShadowMap:function(t,e){this.shadow&&(this.lightShadow||(this.lightShadow=new ln({light:this,renderer:t,width:this.shadow.width||t.width,height:this.shadow.height||t.height,debug:this.shadow.debug,cameraInfo:this.shadow.cameraInfo}),\"minBias\"in this.shadow&&(this.lightShadow.minBias=this.shadow.minBias),\"maxBias\"in this.shadow&&(this.lightShadow.maxBias=this.shadow.maxBias)),this.lightShadow.createShadowMap(e))},getWorldDirection:function(){return Hn.copy(this.direction).transformDirection(this.worldMatrix).normalize(),Hn},getViewDirection:function(t){var e=t.getModelViewMatrix(this,wn);return Hn.copy(this.direction).transformDirection(e).normalize(),Hn}}),Fn=Dn,Un=a.a.create({Extends:We,isShaderMaterial:!0,className:\"ShaderMaterial\",vs:\"\",fs:\"\",useHeaderCache:!1,constructor:function(t){Un.superclass.constructor.call(this,t)},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(Un.superclass.getRenderOption.call(this,t),this.getCustomRenderOption){var e=this.getCustomRenderOption({});for(var n in e)t[\"HILO_CUSTUM_OPTION_\".concat(n)]=e[n]}return t},getCustomRenderOption:null}),Gn=Un,Bn=n(15),Vn=n.n(Bn),Xn=a.a.create({Extends:Z,isMorphGeometry:!0,className:\"MorphGeometry\",isStatic:!1,weights:[],targets:null,constructor:function(t){Xn.superclass.constructor.call(this,t),this.weights=this.weights||[]},update:function(t,e){this.weights=t,this._originalMorphIndices=e},clone:function(){return Z.prototype.clone.call(this,{targets:this.targets,weights:this.weights})},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Xn.superclass.getRenderOption.call(this,e),this.targets&&(this._maxMorphTargetCount||(this._maxMorphTargetCount=Math.floor(8/Object.keys(this.targets).length)),Object(i.each)(this.targets,(function(n,r){e.MORPH_TARGET_COUNT=Math.min(n.length,t._maxMorphTargetCount),\"vertices\"===r?e.MORPH_HAS_POSITION=1:\"normals\"===r?e.MORPH_HAS_NORMAL=1:\"tangents\"===r&&(e.MORPH_HAS_TANGENT=1)}))),e}}),jn=Xn,kn={POSITION:{name:\"vertices\",decodeMatName:\"positionDecodeMat\"},TEXCOORD_0:{name:\"uvs\",decodeMatName:\"uvDecodeMat\"},TEXCOORD_1:{name:\"uvs1\",decodeMatName:\"uv1DecodeMat\"},NORMAL:{name:\"normals\",decodeMatName:\"normalDecodeMat\"},JOINT:{name:\"skinIndices\"},JOINTS_0:{name:\"skinIndices\"},WEIGHT:{name:\"skinWeights\"},WEIGHTS_0:{name:\"skinWeights\"},TANGENT:{name:\"tangents\"},COLOR_0:{name:\"colors\"}},zn={Geometry:Z,GeometryData:C};var Yn={_decodeTotalTime:0,wasmURL:\"\",workerURL:\"\",useWASM:!0,useWebWorker:!0,useAuto:!0,init:function(){return Yn.useAuto?Vn.a.initWASM(Yn.wasmURL,Yn.memPages):Yn.useWebWorker?Vn.a.initWorker(Yn.workerURL):Yn.useWASM?Vn.a.initWASM(Yn.wasmURL,Yn.memPages):Promise.resolve()},parse:function(t,e,n,r){var i=Date.now(),a=e.bufferViews[t.bufferView],s=Yn.wasmURL,o=Yn.workerURL,u=Yn.useAuto,c=Yn.useWASM,h=Yn.useWebWorker,f=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);function l(e){Yn._decodeTotalTime+=Date.now()-i;var n=e.toHilo3dGeometry(zn,r.primitive._geometry);return t.targets&&(n=function(t,e,n){if(!n.isMorphGeometry){var r=new jn;for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&\"id\"!==i&&(r[i]=n[i]);r.targets={},n=r}for(var a=n.targets,s=0;s<t.targets.length;s++){var o=t.targets[s];for(var u in o)if(u in kn){var c=o[u],h=kn[u].name;a[h]||(a[h]=[]);var f=e.attrs[c];a[h].push(new C(f.data,f.itemCount))}}return t.weights?n.weights=t.weights:n.weights=new Float32Array(t.targets.length),n}(t,e,n)),n}return u?Vn.a.decompress(f,s,o).then(l):h?Vn.a.decompressWithWorker(f,c,s,o).then(l):l(c?Vn.a.decompressWithWASM(f,s):Vn.a.decompressWithJS(f))},freeMemory:function(){Vn.a.destory()}},Wn=Yn,qn=P.a.SAMPLER_2D,Zn={unQuantizeData:function(t,e){if(!e)return t;var n=Math.sqrt(e.length),r=n-1,i=new Float32Array(t.length),a=[];return t.traverse((function(t,s){t.toArray?t.toArray(a):a[0]=t;for(var o=s*r,u=0;u<n;u++){i[o+u]=0;for(var c=0;c<n;c++){var h=c===r?1:a[c];i[o+u]+=e[c*n+u]*h}}})),t.data=i,t.stride=0,t.offset=0,t},parse:function(t,e,n,r){var i=t.decodeMatrix;return r.isDecode?n=Zn.unQuantizeData(n,i):n.decodeMat=i,n}},Kn={parseOnEnd:function(t,e,n){if(!n.anim||e.isMultiAnim)return n;for(var r in t){var i=t[r];n.anim.addClip(r,i[0],i[1])}return n}},Qn=Kn,Jn={parse:function(t,e,n){return t.center=t.max.map((function(e,n){return(e+t.min[n])/2})),t.width=t.max[0]-t.min[0],t.height=t.max[1]-t.min[1],t.depth=t.max[2]-t.min[2],t.size=Math.sqrt(Math.pow(t.width,2)+Math.pow(t.height,2)+Math.pow(t.depth,2)),n.bounds=t,n}},$n={getUsedTextureNameMap:function(t,e){t.diffuseTexture&&(e[t.diffuseTexture.index]=!0),t.specularGlossinessTexture&&(e[t.specularGlossinessTexture.index]=!0)},parse:function(t,e,n){return t.diffuseFactor&&n.baseColor.fromArray(t.diffuseFactor),t.diffuseTexture&&(n.baseColorMap=e.getTexture(t.diffuseTexture)),t.specularFactor&&(n.specular.fromArray(t.specularFactor),n.specular.a=1),\"glossinessFactor\"in t&&(n.glossiness=t.glossinessFactor),t.specularGlossinessTexture&&(n.specularGlossinessMap=e.getTexture(t.specularGlossinessTexture)),n.isSpecularGlossiness=!0,n}},tr={getUsedTextureNameMap:function(t,e){t.clearcoatTexture&&(e[t.clearcoatTexture.index]=!0),t.clearcoatRoughnessTexture&&(e[t.clearcoatRoughnessTexture.index]=!0),t.clearcoatNormalTexture&&(e[t.clearcoatNormalTexture.index]=!0)},parse:function(t,e,n){return t.clearcoatFactor&&(n.clearcoatFactor=t.clearcoatFactor),t.clearcoatTexture&&(n.clearcoatMap=e.getTexture(t.clearcoatTexture)),t.clearcoatRoughnessFactor&&(n.clearcoatRoughnessFactor=t.clearcoatRoughnessFactor),t.clearcoatRoughnessTexture&&(n.clearcoatRoughnessMap=e.getTexture(t.clearcoatRoughnessTexture)),t.clearcoatNormalTexture&&(n.clearcoatNormalMap=e.getTexture(t.clearcoatNormalTexture)),n}},er={parse:function(t,e,n){if(!e.isUseExtension(e.json,\"KHR_lights_punctual\")||!e.json.extensions.KHR_lights_punctual.lights)return n;var r,i=e.json.extensions.KHR_lights_punctual.lights[t.light];if(!i)return n;var a=new v.a(1,1,1,1);i.color&&(a.r=i.color[0],a.g=i.color[1],a.b=i.color[2]);var s=void 0!==i.intensity?i.intensity:1,o=i.name||\"\",u=i.spot||{},c=void 0!==u.innerConeAngle?d.a.radToDeg(u.innerConeAngle):0,h=void 0!==u.outerConeAngle?d.a.radToDeg(u.outerConeAngle):45,f=i.range||0;switch(i.type){case\"directional\":(r=new Pn({color:a,amount:s,name:o,range:f})).direction.set(0,0,-1);break;case\"point\":r=new xn({color:a,amount:s,name:o,range:f});break;case\"spot\":(r=new Fn({color:a,amount:s,name:o,range:f,cutoff:c,outerCutoff:h})).direction.set(0,0,-1);break;default:return n}return r&&(n.addChild(r),e.lights.push(r)),n}},nr={init:function(t,e){var n=[],r=(e.json.extensions||{}).KHR_techniques_webgl||{},a=r.programs||[],s=r.shaders||[],o=r.techniques||[];return e.shaders={},s.forEach((function(r,a){var s=i.getRelativePath(e.src,r.uri);e.preHandlerShaderURI&&(s=e.preHandlerShaderURI(s,a,r)),n.push(t.loadRes(s).then((function(t){e.shaders[a]=t})))})),e.programs={},a.forEach((function(t,n){e.programs[n]=Object.assign({},t)})),e.techniques={},o.forEach((function(t,n){var r=(e.techniques[n]=Object.assign({},t)).textureInfos={},i=t.uniforms||{};for(var a in i){var s=i[a];s.type===qn&&(r[a]=s.value||{})}})),Promise.all(n)},getUsedTextureNameMap:function(t,e,n){var r=n.techniques[t.technique],i=t.values||{};if(r){var a=r.textureInfos;for(var s in a){var o=void 0;i[s]&&void 0!==i[s].index?o=i[s].index:void 0!==a[s].index&&(o=a[s].index),void 0!==o&&(e[a[s].index]=!0)}}},parse:function(t,e,n){var r=e.textures||[],i=e.techniques[t.technique];if(!i)return n;var a=e.programs[i.program];if(!a)return n;var s=e.shaders[a.fragmentShader],o=e.shaders[a.vertexShader],u=i.uniforms||{},c=i.attributes||{},h=t.values||{},f={},l={},d=function(t){var n=u[t]||{},i=h[t];void 0===i&&(i=n.value);var a=void 0;if(void 0!==i)if(n.type===qn){var s=i.index||0;a={get:function(t,e,n){return Pe.handlerTexture(r[s],n.textureIndex)}}}else a={get:function(){return i}};else if(n.semantic&&Pe[n.semantic]){var o,c=Pe[n.semantic],f=n.node;a=void 0!==f?{get:function(t,n,r){return void 0===o&&(o=e.node.getChildByFn((function(t){return t.animationId===f}))||t),c.get(o,n,r)}}:n.semantic}else m.a.warn(\"KHR_techniques_webgl: no \".concat(t,\" value found!\")),a=Pe.blankInfo;l[t]=a};for(var _ in u)d(_);for(var p in c){var g=c[p]||{};g.semantic&&(f[p]=g.semantic)}return new Gn({needBasicUnifroms:!1,needBasicAttributes:!1,vs:o,fs:s,attributes:f,uniforms:l})}},rr=new Float32Array(2),ir=a.a.create({isFog:!0,className:\"Fog\",mode:\"LINEAR\",start:5,end:10,density:.1,constructor:function(t){this.id=d.a.generateUUID(this.className),this.color=new v.a(1,1,1,1),Object.assign(this,t)},getInfo:function(){return\"LINEAR\"===this.mode?(rr[0]=this.start,rr[1]=this.end,rr):this.density},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return t[\"FOG_\".concat(this.mode)]=1,t}}),ar=n(16),sr=new ar.a,or=new o.a,ur=a.a.create({Extends:g,isMesh:!0,className:\"Mesh\",geometry:null,material:null,useInstanced:!1,frustumTest:!0,constructor:function(t){ur.superclass.constructor.call(this,t)},clone:function(t){var e=g.prototype.clone.call(this,t);return Object.assign(e,{geometry:this.geometry,material:this.material}),e},raycast:function(t){var e=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];if(!this.visible)return null;var n=this.geometry,r=this.material,i=this.worldMatrix;if(n&&r){or.invert(i),sr.copy(t),sr.transformMat4(or);var a=n.raycast(sr,r.side,e);if(a)return a.forEach((function(t){t.transformMat4(i)})),a}return null},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return this.geometry.getRenderOption(t),t},isDestroyed:{get:function(){return this._isDestroyed}},destroy:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(this._isDestroyed)return this;this.removeFromParent();var n=t.resourceManager;return n.destroyMesh(this),this.material&&e&&this.material.destroyTextures(),this.off(),this.geometry=null,this.material=null,this._isDestroyed=!0,this}}),cr=ur,hr=new o.a,fr=new o.a,lr=a.a.create({Extends:cr,isSkinedMesh:!0,className:\"SkinedMesh\",useInstanced:!1,jointMatTexture:null,frustumTest:!1,skeleton:null,constructor:function(t){lr.superclass.constructor.call(this,t)},getJointMat:function(){var t=this;if(this.skeleton&&!(this.skeleton.jointCount<=0)){var e=this.skeleton.jointNodeList,n=this.skeleton.inverseBindMatrices,r=16*this.skeleton.jointCount;return this.jointMat&&this.jointMat.length===r||(this.jointMat=new Float32Array(r)),this.clonedFrom?fr.invert(this.clonedFrom.worldMatrix):fr.invert(this.worldMatrix),e.forEach((function(e,r){hr.copy(fr),hr.multiply(e.worldMatrix),hr.multiply(n[r]),hr.toArray(t.jointMat,16*r)})),this.jointMat}},resetJointNamesByNodeName:function(t){this.skeleton.resetJointNamesByNodeName(t)},resetSkinIndices:function(t){var e=this.skeleton;if(e){var n=this.geometry,r=n.skinIndices;if(r){this.material.isDirty=!0,n.isDirty=!0,r.isDirty=!0;var i=new R.a;r.traverse((function(n,a,s){n.elements.forEach((function(n,r){var a=e.jointNames[n],s=t.jointNames.indexOf(a);s>=0?i.elements[r]=s:m.a.warnOnce(\"SkinedMesh.resetSkinIndices\",\"SkinedMesh.resetSkinIndices: no jointName found!\",a)})),r.setByOffset(s,i)}))}}},initJointMatTexture:function(){if(!this.jointMatTexture){var t=this.getJointMat();this.jointMatTexture=new ve({data:t})}return this.jointMatTexture},updateJointMatTexture:function(){if(this.jointMatTexture){var t=this.getJointMat();this.jointMatTexture.data.set(t,0),this.jointMatTexture.needUpdate=!0}else this.initJointMatTexture()},clone:function(t){var e=cr.prototype.clone.call(this,t);return Object.assign(e,{useInstanced:this.useInstanced,skeleton:this.skeleton.clone()}),e.clonedFrom=this,e},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};lr.superclass.getRenderOption.call(this,t);var e=this.skeleton.jointCount;if(e&&(t.JOINT_COUNT=e,et.VERTEX_TEXTURE_FLOAT)){var n=(et.MAX_VERTEX_UNIFORM_VECTORS-22)/4;e>n&&(t.JOINT_MAT_MAP=1)}return t}}),dr=lr,mr=a.a.create({isSkeleton:!0,className:\"Skeleton\",userData:null,constructor:function(t){this.id=d.a.generateUUID(this.className),this.jointNodeList=[],this.jointNames=[],this.inverseBindMatrices=[],Object.assign(this,t)},jointCount:{get:function(){return this.jointNodeList.length}},_rootNode:null,rootNode:{get:function(){return this._rootNode},set:function(t){this._rootNode=t,t&&this._initJointNodeList()}},_initJointNodeList:function(){var t={};this.rootNode.traverse((function(e){t[e.jointName]=e})),this.jointNodeList=this.jointNames.map((function(e){return t[e]}))},resetJointNamesByNodeName:function(t){var e=this.jointNames;this.jointNodeList.forEach((function(n,r){var i=t.rootNode.getChildByName(n.name);i&&(e[r]=i.jointName)}))},clone:function(t){var e=new mr;return e.copy(this,t),e},copy:function(t,e){return this.inverseBindMatrices=t.inverseBindMatrices,this.jointNames=t.jointNames.slice(),void 0===e&&(e=t.rootNode),this.rootNode=e,this}}),_r=mr,pr=\"1.15.15\",gr=a.a.create({className:\"RenderInfo\",isRenderInfo:!0,constructor:function(){this.reset()},addFaceCount:function(t){this._currentFaceCount+=t},addDrawCount:function(t){this._currentDrawCount+=t},reset:function(){this.faceCount=Math.floor(this._currentFaceCount),this.drawCount=Math.floor(this._currentDrawCount),this._currentFaceCount=0,this._currentDrawCount=0}}),vr=new c.a,Er=function(t,e){var n=t.material.renderOrder,r=e.material.renderOrder;if(n!==r)return n-r;var i=t.material._shaderNumId||0,a=e.material._shaderNumId||0;return i!==a?i-a:t._sortRenderZ-e._sortRenderZ},Tr=function(t,e){var n=t.material.renderOrder,r=e.material.renderOrder;return n!==r?n-r:e._sortRenderZ-t._sortRenderZ},Mr=a.a.create({className:\"RenderList\",isRenderList:!0,useInstanced:!1,constructor:function(){this.opaqueList=[],this.transparentList=[],this.instancedDict={}},reset:function(){this.opaqueList.length=0,this.transparentList.length=0,this.instancedDict={}},traverse:function(t,e){this.opaqueList.forEach((function(e){t(e)}));var n=this.instancedDict;for(var r in n){var i=n[r];i.length>2&&e?e(i):i.forEach((function(e){t(e)}))}this.transparentList.forEach((function(e){t(e)}))},sort:function(){this.transparentList.sort(Tr),this.opaqueList.sort(Er)},addMesh:function(t,e){var n=t.material,r=t.geometry;if(n&&r){if(t.frustumTest&&!e.isMeshVisible(t))return;if(this.useInstanced&&t.useInstanced){var i=this.instancedDict,a=n.id+\"_\"+r.id,s=i[a];i[a]||(s=i[a]=[]),s.push(t)}else t.worldMatrix.getTranslation(vr),vr.transformMat4(e.viewProjectionMatrix),t._sortRenderZ=vr.z,n.transparent?this.transparentList.push(t):this.opaqueList.push(t)}else m.a.warnOnce(\"RenderList.addMesh(\".concat(t.id,\")\"),\"Mesh must have material and geometry\",t)}}),Ar=a.a.create({className:\"WebGLState\",isWebGLState:!0,systemFramebuffer:null,constructor:function(t){this.gl=t,this.reset()},reset:function(){this._dict={},this.activeTextureIndex=null,this.textureUnitDict={},this.currentFramebuffer=null,this.preFramebuffer=null,this._pixelStorei={}},enable:function(t){!0!==this._dict[t]&&(this._dict[t]=!0,this.gl.enable(t))},disable:function(t){!1!==this._dict[t]&&(this._dict[t]=!1,this.gl.disable(t))},bindFramebuffer:function(t,e){this.currentFramebuffer!==e&&(this.preFramebuffer=this.currentFramebuffer,this.currentFramebuffer=e,this.gl.bindFramebuffer(t,e))},bindSystemFramebuffer:function(){this.bindFramebuffer(this.gl.FRAMEBUFFER,this.systemFramebuffer)},useProgram:function(t){this.set1(\"useProgram\",t)},depthFunc:function(t){this.set1(\"depthFunc\",t)},depthMask:function(t){this.set1(\"depthMask\",t)},clear:function(t){this.gl.clear(t)},depthRange:function(t,e){this.set2(\"depthRange\",t,e)},stencilFunc:function(t,e,n){this.set3(\"stencilFunc\",t,e,n)},stencilMask:function(t){this.set1(\"stencilMask\",t)},stencilOp:function(t,e,n){this.set3(\"stencilOp\",t,e,n)},colorMask:function(t,e,n,r){this.set4(\"colorMask\",t,e,n,r)},cullFace:function(t){this.set1(\"cullFace\",t)},frontFace:function(t){this.set1(\"frontFace\",t)},blendFuncSeparate:function(t,e,n,r){this.set4(\"blendFuncSeparate\",t,e,n,r)},blendEquationSeparate:function(t,e){this.set2(\"blendEquationSeparate\",t,e)},pixelStorei:function(t,e){this._pixelStorei[t]!==e&&(this._pixelStorei[t]=e,this.gl.pixelStorei(t,e))},viewport:function(t,e,n,r){this.set4(\"viewport\",t,e,n,r)},activeTexture:function(t){this.activeTextureIndex!==t&&(this.activeTextureIndex=t,this.gl.activeTexture(t))},bindTexture:function(t,e){var n=this.getActiveTextureUnit();n[t]!==e&&(n[t]=e,this.gl.bindTexture(t,e))},getActiveTextureUnit:function(){var t=this.textureUnitDict[this.activeTextureIndex];return t||(t=this.textureUnitDict[this.activeTextureIndex]={}),t},set1:function(t,e){this._dict[t]!==e&&(this._dict[t]=e,this.gl[t](e))},set2:function(t,e,n){var r=this._dict[t];r||(r=this._dict[t]=[]),r[0]===e&&r[1]===n||(r[0]=e,r[1]=n,this.gl[t](e,n))},set3:function(t,e,n,r){var i=this._dict[t];i||(i=this._dict[t]=[]),i[0]===e&&i[1]===n&&i[2]===r||(i[0]=e,i[1]=n,i[2]=r,this.gl[t](e,n,r))},set4:function(t,e,n,r,i){var a=this._dict[t];a||(a=this._dict[t]=[]),a[0]===e&&a[1]===n&&a[2]===r&&a[3]===i||(a[0]=e,a[1]=n,a[2]=r,a[3]=i,this.gl[t](e,n,r,i))},get:function(t){return this._dict[t]}}),Lr=a.a.create({Mixes:s.a,className:\"WebGLResourceManager\",isWebGLResourceManager:!0,hasNeedDestroyResource:!1,constructor:function(t){this._needDestroyResources=[],Object.assign(this,t)},destroyMesh:function(t){var e=this;this.getMeshResources(t).forEach((function(t){e.destroyIfNoRef(t)})),t._vao=t._program=t._shader=null},getMeshResources:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];return t._shader&&e.push(t._shader),t._vao&&(e.push(t._vao),t._vao.getResources(e)),t._program&&e.push(t._program),e},destroyIfNoRef:function(t){var e=this._needDestroyResources;return t&&e.indexOf(t)<0&&e.push(t),this},getUsedResources:function(t){var e=this,n=[];return t&&t.traverse((function(t){t.isMesh&&!t.isDestroyed&&e.getMeshResources(t,n)})),n},destroyUnsuedResource:function(t){var e=this,n=this._needDestroyResources;if(0===n.length)return this;var r=this.getUsedResources(t);return n.forEach((function(t){r.indexOf(t)<0&&t&&t.destroy&&!t.alwaysUse&&(e.fire(\"destroyResource\",t.id),t.destroy())})),this.reset(),this},reset:function(){return this._needDestroyResources.length=0,this}}),Or=new o.a,Ir=new c.a,Sr=new Float32Array([0,0,0]),Rr=a.a.create({isLightManager:!0,className:\"LightManager\",constructor:function(t){this.ambientLights=[],this.directionalLights=[],this.pointLights=[],this.spotLights=[],this.areaLights=[],this.lightInfo={AMBIENT_LIGHTS:0,POINT_LIGHTS:0,DIRECTIONAL_LIGHTS:0,SPOT_LIGHTS:0,AREA_LIGHTS:0,uid:0},Object.assign(this,t)},getRenderOption:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return Object(i.each)(this.lightInfo,(function(n,r){if(\"uid\"!==r&&n){e[r]=n;var i=t.getShadowMapCount(r);i&&(e[r+\"_SMC\"]=i)}})),e},addLight:function(t){var e=null;return t.enabled?(t.isAmbientLight?e=this.ambientLights:t.isDirectionalLight?e=this.directionalLights:t.isPointLight?e=this.pointLights:t.isSpotLight?e=this.spotLights:t.isAreaLight?e=this.areaLights:m.a.warnOnce(\"LightManager.addLight(\".concat(t.id,\")\"),\"Not support this light:\",t),e&&(t.shadow?e.unshift(t):e.push(t)),this):this},getDirectionalInfo:function(t){var e=[],n=[],r=[],i=[],a=[],s=[];this.directionalLights.forEach((function(o,u){var c=3*u;o.getRealColor().toRGBArray(e,c),o.getViewDirection(t).toArray(n,c),o.shadow&&o.lightShadow&&(r.push(o.lightShadow.framebuffer.texture),i.push(o.lightShadow.width),i.push(o.lightShadow.height),s.push(o.lightShadow.minBias,o.lightShadow.maxBias),Or.copy(t.worldMatrix),Or.premultiply(o.lightShadow.camera.viewProjectionMatrix),Or.toArray(a,16*u))}));var o={colors:new Float32Array(e),infos:new Float32Array(n)};return r.length&&(o.shadowMap=r,o.shadowMapSize=new Float32Array(i),o.shadowBias=new Float32Array(s),o.lightSpaceMatrix=new Float32Array(a)),o},getSpotInfo:function(t){var e=[],n=[],r=[],i=[],a=[],s=[],o=[],u=[],c=[],h=[];this.spotLights.forEach((function(f,l){var d=3*l;f.getRealColor().toRGBArray(e,d),f.toInfoArray(n,d),f.getViewDirection(t).toArray(i,d),h.push(f.range),a.push(f._cutoffCos,f._outerCutoffCos),t.getModelViewMatrix(f,Or),Or.getTranslation(Ir),Ir.toArray(r,d),f.shadow&&f.lightShadow&&(s.push(f.lightShadow.framebuffer.texture),o.push(f.lightShadow.width),o.push(f.lightShadow.height),c.push(f.lightShadow.minBias,f.lightShadow.maxBias),Or.multiply(f.lightShadow.camera.viewProjectionMatrix,t.worldMatrix),Or.toArray(u,16*l))}));var f={colors:new Float32Array(e),infos:new Float32Array(n),poses:new Float32Array(r),dirs:new Float32Array(i),cutoffs:new Float32Array(a),ranges:new Float32Array(h)};return s.length&&(f.shadowMap=s,f.shadowMapSize=new Float32Array(o),f.shadowBias=new Float32Array(c),f.lightSpaceMatrix=new Float32Array(u)),f},getPointInfo:function(t){var e=[],n=[],r=[],i=[],a=[],s=[],o=[],u=[];this.pointLights.forEach((function(c,h){var f=3*h;c.getRealColor().toRGBArray(e,f),c.toInfoArray(n,f),u.push(c.range),t.getModelViewMatrix(c,Or),Or.getTranslation(Ir),Ir.toArray(r,f),c.shadow&&c.lightShadow&&(i.push(c.lightShadow.framebuffer.texture),s.push(c.lightShadow.minBias,c.lightShadow.maxBias),t.worldMatrix.toArray(a,16*h),o[2*h]=c.lightShadow.camera.near,o[2*h+1]=c.lightShadow.camera.far)}));var c={colors:new Float32Array(e),infos:new Float32Array(n),poses:new Float32Array(r),ranges:new Float32Array(u)};return i.length&&(c.shadowMap=i,c.shadowBias=new Float32Array(s),c.lightSpaceMatrix=new Float32Array(a),c.cameras=new Float32Array(o)),c},getAreaInfo:function(t){var e,n,r=[],i=[],a=[],s=[];return this.areaLights.forEach((function(o,u){var c=3*u;o.getRealColor().toRGBArray(r,c),t.getModelViewMatrix(o,Or),Or.getTranslation(Ir),Ir.toArray(i,c);var h=Or.getRotation();Or.fromQuat(h),Ir.set(.5*o.width,0,0),Ir.transformMat4(Or),Ir.toArray(a,c),Ir.set(0,.5*o.height,0),Ir.transformMat4(Or),Ir.toArray(s,c),e=o.ltcTexture1,n=o.ltcTexture2})),{colors:new Float32Array(r),poses:new Float32Array(i),width:new Float32Array(a),height:new Float32Array(s),ltcTexture1:e,ltcTexture2:n}},getAmbientInfo:function(){return Sr[0]=Sr[1]=Sr[2]=0,this.ambientLights.forEach((function(t){var e=t.getRealColor();Sr[0]+=e.r,Sr[1]+=e.g,Sr[2]+=e.b})),Sr[0]=Math.min(1,Sr[0]),Sr[1]=Math.min(1,Sr[1]),Sr[2]=Math.min(1,Sr[2]),Sr},updateInfo:function(t){var e=this.lightInfo,n=this.ambientLights,r=this.directionalLights,i=this.pointLights,a=this.spotLights,s=this.areaLights;e.AMBIENT_LIGHTS=n.length,e.POINT_LIGHTS=i.length,e.DIRECTIONAL_LIGHTS=r.length,e.SPOT_LIGHTS=a.length,e.AREA_LIGHTS=s.length;var o=function(t){return!!t.shadow};e.SHADOW_POINT_LIGHTS=i.filter(o).length,e.SHADOW_SPOT_LIGHTS=a.filter(o).length,e.SHADOW_DIRECTIONAL_LIGHTS=r.filter(o).length,e.uid=[e.AMBIENT_LIGHTS,e.POINT_LIGHTS,e.SHADOW_POINT_LIGHTS,e.DIRECTIONAL_LIGHTS,e.SHADOW_DIRECTIONAL_LIGHTS,e.SPOT_LIGHTS,e.SHADOW_SPOT_LIGHTS,e.AREA_LIGHTS].join(\"_\"),this.directionalInfo=this.getDirectionalInfo(t),this.pointInfo=this.getPointInfo(t),this.spotInfo=this.getSpotInfo(t),this.areaInfo=this.getAreaInfo(t),this.ambientInfo=this.getAmbientInfo()},getInfo:function(){return this.lightInfo},reset:function(){this.ambientLights.length=0,this.directionalLights.length=0,this.pointLights.length=0,this.spotLights.length=0,this.areaLights.length=0},getShadowMapCount:function(t){var e=[];\"POINT_LIGHTS\"===t?e=this.pointLights:\"DIRECTIONAL_LIGHTS\"===t?e=this.directionalLights:(\"SPOT_LIGHTS\"===t||\"AREA_LIGHTS\"===t)&&(e=this.spotLights);var n=0;return e.forEach((function(t){n+=t.shadow?1:0})),n},createShadowMap:function(t,e){this.directionalLights.forEach((function(n){n.createShadowMap(t,e)})),this.spotLights.forEach((function(n){n.createShadowMap(t,e)})),this.pointLights.forEach((function(n){n.createShadowMap(t,e)})),this.areaLights.forEach((function(n){n.createShadowMap(t,e)}))}}),yr=P.a.DEPTH_TEST,xr=P.a.STENCIL_TEST,Nr=P.a.SAMPLE_ALPHA_TO_COVERAGE,br=P.a.CULL_FACE,Cr=P.a.FRONT_AND_BACK,Pr=P.a.BLEND,wr=P.a.LINES,Hr=P.a.STATIC_DRAW,Dr=P.a.DYNAMIC_DRAW,Fr=a.a.create({Mixes:s.a,className:\"WebGLRenderer\",isWebGLRenderer:!0,gl:null,width:0,height:0,pixelRatio:1,domElement:null,useInstanced:!1,useVao:!0,alpha:!1,depth:!0,stencil:!1,antialias:!0,premultipliedAlpha:!0,preserveDrawingBuffer:!1,failIfMajorPerformanceCaveat:!1,gameMode:!1,useFramebuffer:!1,framebufferOption:{},useLogDepth:!1,vertexPrecision:\"highp\",fragmentPrecision:\"highp\",fog:null,offsetX:0,offsetY:0,isInitFailed:!1,_isInit:!1,_isContextLost:!1,constructor:function(t){this.clearColor=new v.a(1,1,1),Object.assign(this,t),this.renderInfo=new gr,this.renderList=new Mr,this.lightManager=new Rr,this.resourceManager=new Lr},resize:function(t,e,n){if(n||this.width!==t||this.height!==e){var r=this.domElement;this.width=t,this.height=e,r.width=t,r.height=e,this.framebuffer&&this.framebuffer.resize(this.width,this.height,n),this.viewport()}},setOffset:function(t,e){this.offsetX===t&&this.offsetY===e||(this.offsetX=t,this.offsetY=e,this.viewport())},viewport:function(t,e,n,r){var i=this.state,a=this.gl;i&&(void 0===t?t=this.offsetX:this.offsetX=t,void 0===e?e=this.offsetY:this.offsetY=e,void 0===n&&(n=a.drawingBufferWidth),void 0===r&&(r=a.drawingBufferHeight),i.viewport(t,e,n,r))},isInit:{get:function(){return this._isInit&&!this.isInitFailed}},onInit:function(t){var e=this;this._isInit?t(this):this.on(\"init\",(function(){t(e)}),!0)},initContext:function(){if(!this._isInit){this._isInit=!0;try{this._initContext(),this.fire(\"init\")}catch(t){this.isInitFailed=!0,this.fire(\"initFailed\",t)}}},_initContext:function(){var t=this,e={alpha:this.alpha,depth:this.depth,stencil:this.stencil,antialias:this.antialias,premultipliedAlpha:this.premultipliedAlpha,failIfMajorPerformanceCaveat:this.failIfMajorPerformanceCaveat};!0===this.preserveDrawingBuffer&&(e.preserveDrawingBuffer=!0),!0===this.gameMode&&(e.gameMode=!0);var n=this.gl=this.domElement.getContext(\"webgl\",e);n.viewport(0,0,this.width,this.height),Tt.init(n),tt.init(n),et.init(n),dt.init(this),this.state=new Ar(n),tt.instanced||(this.useInstanced=!1),this.renderList.useInstanced=this.useInstanced,tt.vao||(this.useVao=!1),this.useFramebuffer&&(this.framebuffer=new ie(this,Object.assign({useVao:this.useVao,width:this.width,height:this.height},this.framebufferOption))),this.domElement.addEventListener(\"webglcontextlost\",(function(e){t._onContextLost(e)}),!1),this.domElement.addEventListener(\"webglcontextrestored\",(function(e){t._onContextRestore(e)}),!1)},_onContextLost:function(t){this.fire(\"webglContextLost\");var e=this.gl;this._isContextLost=!0,t.preventDefault(),Lt.reset(e),dt.reset(e),Yt.reset(e),xt.reset(e),Ft.reset(e),this.state.reset(e),this._lastMaterial=null,this._lastProgram=null},_onContextRestore:function(t){this.fire(\"webglContextRestored\");var e=this.gl;this._isContextLost=!1,tt.reset(e),ie.reset(e)},setupDepthTest:function(t){var e=this.state;t.depthTest?(e.enable(yr),e.depthFunc(t.depthFunc),e.depthMask(t.depthMask),e.depthRange(t.depthRange[0],t.depthRange[1])):e.disable(yr)},setupSampleAlphaToCoverage:function(t){var e=this.state;t.sampleAlphaToCoverage?e.enable(Nr):e.disable(Nr)},setupCullFace:function(t){var e=this.state;t.cullFace&&t.cullFaceType!==Cr?(e.enable(br),e.cullFace(t.cullFaceType),e.frontFace(t.frontFace)):e.disable(br)},setupBlend:function(t){var e=this.state;t.blend?(e.enable(Pr),e.blendFuncSeparate(t.blendSrc,t.blendDst,t.blendSrcAlpha,t.blendDstAlpha),e.blendEquationSeparate(t.blendEquation,t.blendEquationAlpha)):e.disable(Pr)},setupStencil:function(t){if(this.stencil){var e=this.state;t.stencilTest?(e.enable(xr),e.stencilMask(t.stencilMask),e.stencilFunc(t.stencilFunc,t.stencilFuncRef,t.stencilFuncMask),e.stencilOp(t.stencilOpFail,t.stencilOpZFail,t.stencilOpZPass)):e.disable(xr)}},setupUniforms:function(t,e,n,r){var i=this.forceMaterial||e.material;for(var a in t.uniforms){var s=i.getUniformInfo(a),o=t.uniforms[a];if(!s.isBlankInfo&&(r||s.isDependMesh&&!n)){var u=s.get(e,i,o);null!=u&&(t[a]=u)}}},setupVao:function(t,e,n){var r=n.geometry,i=r.isStatic;if(t.isDirty||!i||r.isDirty){t.isDirty=!1;var a=this.forceMaterial||n.material,s=a.attributes,o=i?Hr:Dr;for(var u in s){var c=e.attributes[u];if(c){var h=a.getAttributeData(u,n,c);null!=h&&t.addAttribute(h,c,o)}}r.indices&&t.addIndexBuffer(r.indices,o),r.isDirty=!1}r.vertexCount&&(t.vertexCount=r.vertexCount)},setupMaterial:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]&&arguments[3],i=this.forceMaterial||e.material;(i.isDirty||this._lastMaterial!==i)&&(this.setupDepthTest(i),this.setupSampleAlphaToCoverage(i),this.setupCullFace(i),this.setupBlend(i),this.setupStencil(i),r=!0),this.setupUniforms(t,e,n,r),i.isDirty=!1,this._lastMaterial=i},setupMesh:function(t,e){var n=this.gl,r=this.state,i=this.lightManager,a=t.geometry,s=this.forceMaterial||t.material,o=dt.getShader(t,s,e,i,this.fog,this.useLogDepth),u=Lt.getProgram(o,r);u.useProgram(),this.setupMaterial(u,t,e,this._lastProgram!==u),this._lastProgram=u,t.material.wireframe&&a.mode!==wr&&a.convertToLinesMode();var c=a.id+u.id,h=Ft.getVao(n,c,{useInstanced:e,useVao:this.useVao,mode:a.mode});return this.setupVao(h,u,t),t._vao=h,t._shader=o,t._program=u,{vao:h,program:u,geometry:a}},addRenderInfo:function(t,e){var n=this.renderInfo;n.addFaceCount(t),n.addDrawCount(e)},render:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(this.initContext(),!this.isInitFailed&&!this._isContextLost){var r=this.renderList,i=this.renderInfo,a=this.lightManager,s=this.resourceManager,o=this.state;this.fog=t.fog,a.reset(),i.reset(),r.reset(),Pe.init(this,o,e,a,this.fog),t.updateMatrixWorld(),e.updateViewProjectionMatrix(),t.traverse((function(t){return t.visible?(t.isMesh?r.addMesh(t,e):t.isLight&&a.addLight(t),g.TRAVERSE_STOP_NONE):g.TRAVERSE_STOP_CHILDREN})),r.sort(),a.createShadowMap(this,e),a.updateInfo(e),n&&this.fire(\"beforeRender\"),this.useFramebuffer&&this.framebuffer.bind(),this.clear(),n&&this.fire(\"beforeRenderScene\"),this.renderScene(),this.useFramebuffer&&this.renderToScreen(this.framebuffer),n&&this.fire(\"afterRender\"),s.destroyUnsuedResource(t)}},renderScene:function(){var t=this;this.renderList.traverse((function(e){t.renderMesh(e)}),(function(e){t.renderInstancedMeshes(e)})),this._gameModeSumbit()},_gameModeSumbit:function(){var t=this.gl;this.gameMode&&t&&t.submit&&t.submit()},clear:function(t){var e=this.gl,n=this.state;t=t||this.clearColor,this._lastMaterial=null,this._lastProgram=null,e.clearColor(t.r,t.g,t.b,t.a),n.depthMask(!0);var r=e.COLOR_BUFFER_BIT|e.DEPTH_BUFFER_BIT;this.stencil&&(n.stencilMask(!0),r|=e.STENCIL_BUFFER_BIT),e.clear(r)},clearDepth:function(){var t=this.gl;this.state.depthMask(!0),t.clear(t.DEPTH_BUFFER_BIT)},clearStencil:function(){var t=this.gl;this.state.stencilMask(!0),t.clear(t.STENCIL_BUFFER_BIT)},renderToScreen:function(t){this.state.bindSystemFramebuffer(),t.render(0,0,1,1,this.clearColor)},renderMesh:function(t){var e=this.setupMesh(t,!1).vao;e.draw(),this.addRenderInfo(e.vertexCount/3,1)},renderInstancedMeshes:function(t){var e=t[0];if(e){var n=this.forceMaterial||e.material,r=this.setupMesh(e,!0),i=r.vao,a=r.program;n.getInstancedUniforms().forEach((function(e){var n=e.name,r=e.info,s=a.attributes[n];s&&i.addInstancedAttribute(s,t,(function(t){return r.get(t)}))})),i.drawInstance(t.length),this.addRenderInfo(i.vertexCount/3*t.length,1)}},renderMultipleMeshes:function(t){var e=this;t.forEach((function(t){e.renderMesh(t)}))},releaseGLResource:function(){var t=this.gl;t&&(Lt.reset(t),dt.reset(t),xt.reset(t),Ft.reset(t),this.state.reset(t),Yt.reset(t),ie.destroy(t))}}),Ur=function(){var t,e=navigator.userAgent,n=document,r=window,i=n.documentElement,a={iphone:/iphone/i.test(e),ipad:/ipad/i.test(e),ipod:/ipod/i.test(e),ios:/iphone|ipad|ipod/i.test(e),android:/android/i.test(e),webkit:/webkit/i.test(e),chrome:/chrome/i.test(e),safari:/safari/i.test(e),firefox:/firefox/i.test(e),ie:/msie/i.test(e),opera:/opera/i.test(e),supportTouch:\"ontouchstart\"in r,supportCanvas:!!n.createElement(\"canvas\").getContext,supportStorage:void 0,supportOrientation:\"orientation\"in r||\"orientation\"in r.screen,supportDeviceMotion:\"ondevicemotion\"in r};try{localStorage.setItem(\"hilo\",\"hilo\"),localStorage.removeItem(\"hilo\"),a.supportStorage=!0}catch(t){a.supportStorage=!1,m.a.warn(\"LocalStorage disabled\")}t=a.webkit||a.firefox?\"webkit\":a.opera?\"o\":a.ie?\"ms\":\"\",a.jsVendor=t;var s=a.cssVendor=\"-\"+t+\"-\",o=n.createElement(\"div\"),u=o.style,c=void 0!==u[t+\"Transform\"],h=void 0!==u[t+\"Perspective\"];h&&(o.id=\"test3d\",(u=n.createElement(\"style\")).textContent=\"@media (\"+s+\"transform-3d){#test3d{height:3px}}\",n.head.appendChild(u),i.appendChild(o),h=3===o.offsetHeight,n.head.removeChild(u),i.removeChild(o)),a.supportTransform=c,a.supportTransform3D=h;var f=a.supportTouch,l=f?\"touchstart\":\"mousedown\",d=f?\"touchmove\":\"mousemove\",_=f?\"touchend\":\"mouseup\";return a.POINTER_START=l,a.POINTER_MOVE=d,a.POINTER_END=_,a}(),Gr=a.a.create({Extends:g,isStage:!0,className:\"Stage\",renderer:null,camera:null,pixelRatio:null,offsetX:0,offsetY:0,canvas:null,constructor:function(t){if(t.width||(t.width=window.innerWidth),t.height||(t.height=window.innerHeight),!t.pixelRatio){var e=window.devicePixelRatio||1;e=Math.min(e,1024/Math.max(t.width,t.height),2),e=Math.max(e,1),t.pixelRatio=e}Gr.superclass.constructor.call(this,t),this.initRenderer(t),m.a.log(\"Hilo3d version: \".concat(pr))},initRenderer:function(t){var e=this.canvas=this.createCanvas(t);this.renderer=new Fr(Object.assign(t,{domElement:e})),this.resize(this.width,this.height,this.pixelRatio,!0)},createCanvas:function(t){var e;return e=t.canvas?t.canvas:document.createElement(\"canvas\"),t.container&&t.container.appendChild(e),e},resize:function(t,e,n,r){if(void 0===n&&(n=this.pixelRatio),r||this.width!==t||this.height!==e||this.pixelRatio!==n){this.width=t,this.height=e,this.pixelRatio=n,this.rendererWidth=t*n,this.rendererHeight=e*n;var i=this.canvas;this.renderer.resize(this.rendererWidth,this.rendererHeight,r),i.style.width=this.width+\"px\",i.style.height=this.height+\"px\",this.updateDomViewport()}return this},setOffset:function(t,e){if(this.offsetX!==t||this.offsetY!==e){this.offsetX=t,this.offsetY=e;var n=this.pixelRatio;this.renderer.setOffset(t*n,e*n)}return this},viewport:function(t,e,n,r){return this.resize(n,r,this.pixelRatio,!0),this.setOffset(t,e),this},tick:function(t){return this.traverseUpdate(t),this.camera&&this.renderer.render(this,this.camera,!0),this},enableDOMEvent:function(t){var e=this,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=this.canvas,i=this._domListener||(this._domListener=function(t){e._onDOMEvent(t)});return(t=\"string\"==typeof t?[t]:t).forEach((function(t){n?r.addEventListener(t,i,!1):r.removeEventListener(t,i)})),this},_onDOMEvent:function(t){var e=this.canvas,n=this._eventTarget,r=t.type,i=0===r.indexOf(\"touch\"),a=t;if(i){var s=t.touches,o=t.changedTouches;s&&s.length?a=s[0]:o&&o.length&&(a=o[0])}var u=this.domViewport||this.updateDomViewport(),c=(a.pageX||a.clientX)-u.left,h=(a.pageY||a.clientY)-u.top;t.stageX=c,t.stageY=h,t.stopPropagation=function(){this._stopPropagationed=!0};var f=this.getMeshResultAtPoint(c,h,!0),l=f.mesh;t.hitPoint=f.point;var d=\"mouseout\"===r;if(n&&(n!==l&&(!n.contains||!n.contains(l))||d)){var m=!1;if(\"touchmove\"===r?m=\"touchout\":\"mousemove\"!==r&&!d&&l||(m=\"mouseout\"),m){var _=Object.assign({},t);_.type=m,_.eventTarget=n,n._fireMouseEvent(_)}t.lastEventTarget=n,this._eventTarget=null}if(l&&l.pointerEnabled&&\"mouseout\"!==r&&(t.eventTarget=this._eventTarget=l,l._fireMouseEvent(t)),!i){var p=l&&l.pointerEnabled&&l.useHandCursor?\"pointer\":\"\";e.style.cursor=p}Ur.android&&\"touchmove\"===r&&t.preventDefault()},updateDomViewport:function(){var t=this.canvas,e=null;return t.parentNode&&(e=this.domViewport=Object(i.getElementRect)(t)),e},getMeshResultAtPoint:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=this.camera,i=this._ray;i||(i=this._ray=new ar.a),i.fromCamera(r,t,e,this.width,this.height);var a=this.raycast(i,!0,n);if(a)return a[0];this._stageResultAtPoint||(this._stageResultAtPoint={mesh:this,point:new c.a});var s=this._stageResultAtPoint.point;return s.copy(r.unprojectVector(s.set(t,e,0),this.width,this.height)),this._stageResultAtPoint},releaseGLResource:function(){return this.renderer.releaseGLResource(),this},destroy:function(){return Gr.superclass.destroy.call(this,this.renderer),this.releaseGLResource(),this.traverse((function(t){t.off(),t.parent=null})),this.children.length=0,this.renderer.off(),this}}),Br=Gr,Vr=n(58),Xr=n.n(Vr),jr=n(102),kr=n.n(jr);Xr.a.Ease=kr.a;var zr=Xr.a,Yr=a.a.create({Extends:Z,isBoxGeometry:!0,className:\"BoxGeometry\",width:1,height:1,depth:1,widthSegments:1,heightSegments:1,depthSegments:1,constructor:function(t){Yr.superclass.constructor.call(this,t),this.isSegments()?this.buildWithSegments():this.build()},buildWithSegments:function(){var t=this.width,e=this.height,n=this.depth,r=this.widthSegments,i=this.heightSegments,a=this.depthSegments,s=i*a*6,o=r*a*6,u=r*i*6,c=2*((i+1)*(a+1)+(r+1)*(a+1)+(r+1)*(i+1)),h=new Float32Array(3*c),f=new Float32Array(3*c),l=new Float32Array(2*c),d=new Uint16Array(2*(s+o+u));this.vertices=new C(h,3),this.normals=new C(f,3),this.uvs=new C(l,2),this.indices=new C(d,1);var m=[0,0];this.buildPlane(m,2,1,0,-1,1,n,e,t/2,a,i),this.buildPlane(m,2,1,0,1,1,n,e,-t/2,a,i),this.buildPlane(m,0,2,1,1,-1,t,n,e/2,r,a),this.buildPlane(m,0,2,1,1,1,t,n,-e/2,r,a),this.buildPlane(m,0,1,2,1,1,t,e,n/2,r,i),this.buildPlane(m,0,1,2,-1,1,t,e,-n/2,r,i)},buildPlane:function(t,e,n,r,i,a,s,o,u,c,h){for(var f=s/c,l=o/h,d=s/2,m=o/2,_=t[0],p=t[1],g=this.vertices.data,v=this.normals.data,E=this.uvs.data,T=this.indices.data,M=0;M<=h;M++)for(var A=(M*l-m)*a,L=0;L<=c;L++){if(g[3*_+e]=(L*f-d)*i,g[3*_+n]=A,g[3*_+r]=u,v[3*_+e]=0,v[3*_+n]=0,v[3*_+r]=u<0?-1:1,E[2*_]=L/c,E[2*_+1]=1-M/h,L<c&&M<h){var O=t[0]+(M+1)*(c+1)+L;T[p++]=O,T[p++]=_,T[p++]=O+1,T[p++]=O+1,T[p++]=_,T[p++]=_+1}_++}t[0]=_,t[1]=p},build:function(){var t=new Float32Array(72),e=new Uint16Array(36);this.vertices=new C(t,3),this.indices=new C(e,1);var n=this.width/2,r=this.height/2,i=this.depth/2,a=[-n,-r,-i],s=[n,-r,-i],o=[n,r,-i],u=[-n,r,-i],c=[-n,-r,i],h=[n,-r,i],f=[n,r,i],l=[-n,r,i];this.addRect(h,s,o,f),this.addRect(a,c,l,u),this.addRect(l,f,o,u),this.addRect(a,s,h,c),this.addRect(c,h,f,l),this.addRect(s,a,u,o)},isSegments:function(){return this.widthSegments>1||this.heightSegments>1||this.depthSegments>1},setFrontUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setFrontUV!\"):this.setVertexUV(32,t)},setRightUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setRightUV!\"):this.setVertexUV(0,t)},setBackUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setBackUV!\"):this.setVertexUV(40,t)},setLeftUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setLeftUV!\"):this.setVertexUV(8,t)},setTopUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setTopUV!\"):this.setVertexUV(16,t)},setBottomUV:function(t){this.isSegments()?m.a.warn(\"segmented BoxGeometry dont support setBottomUV!\"):this.setVertexUV(24,t)},setAllRectUV:function(t){if(this.isSegments())return m.a.warn(\"segmented BoxGeometry dont support setAllRectUV!\"),null;for(var e=0;e<6;e++)this.setVertexUV(8*e,t);return this},_raycast:function(t,e){return Yr.superclass._raycast.call(this,t,e)}}),Wr=Yr,qr=P.a.FRONT,Zr=P.a.BACK,Kr=[0,0,1],Qr=a.a.create({Extends:Z,isPlaneGeometry:!0,className:\"PlaneGeometry\",width:1,height:1,widthSegments:1,heightSegments:1,constructor:function(t){Qr.superclass.constructor.call(this,t),this.build()},build:function(){for(var t=this.widthSegments,e=this.heightSegments,n=(t+1)*(e+1),r=this.width/t,i=this.height/e,a=new Float32Array(3*n),s=new Float32Array(3*n),o=new Float32Array(2*n),u=new Uint16Array(t*e*6),c=0,h=0;h<=e;h++)for(var f=0;f<=t;f++){var l=h*(t+1)+f;if(a[3*l]=f*r-this.width/2,a[3*l+1]=this.height/2-h*i,s[3*l]=0,s[3*l+1]=0,s[3*l+2]=1,o[2*l]=f/t,o[2*l+1]=1-h/e,h<e&&f<t){var d=(h+1)*(t+1)+f;u[c++]=l,u[c++]=d,u[c++]=d+1,u[c++]=l,u[c++]=d+1,u[c++]=l+1}}this.vertices=new C(a,3),this.indices=new C(u,1),this.normals=new C(s,3),this.uvs=new C(o,2)},_raycast:function(t,e){var n=t.origin.z,r=t.direction.z;if(e===qr&&(r>0||n<0))return null;if(e===Zr&&(r<0||n>0))return null;var i=t.intersectsPlane(Kr,0);if(i){var a=i.x,s=i.y,o=.5*this.width,u=.5*this.height;if(a>=-o&&a<=o&&s>=-u&&s<=u)return[i]}return null}}),Jr=Qr,$r=a.a.create({Extends:Z,isSphereGeometry:!0,className:\"SphereGeometry\",radius:1,heightSegments:16,widthSegments:32,constructor:function(t){$r.superclass.constructor.call(this,t),this.build()},build:function(){for(var t=this.radius,e=this.heightSegments,n=this.widthSegments,r=(n+1)*(e+1),i=n*e,a=new Float32Array(3*r),s=new Float32Array(4*r),o=new Float32Array(2*r),u=new Uint16Array(6*i),c=0,h=0,f=0,l=0,d=0,m=2*Math.PI,_=Math.PI,p=0;p<=e;p++)for(var g=p/e,v=_*g,E=Math.cos(v)*t,T=Math.sin(v)*t,M=0;M<=n;M++){var A=M/n,L=m*A,O=Math.cos(L),I=Math.sin(L),S=O*T,R=I*T,y=I,x=-O;if(s[f++]=y,s[f++]=0,s[f++]=x,s[f++]=1,a[h++]=S,a[h++]=E,a[h++]=R,o[l++]=A,o[l++]=g,p>0&&M>0){var N=d,b=N-1,P=b-n-1,w=N-n-1;u[c++]=P,u[c++]=w,u[c++]=N,u[c++]=P,u[c++]=N,u[c++]=b}d++}this.vertices=new C(a,3),this.indices=new C(u,1),this.uvs=new C(o,2),this.tangents=new C(s,4),this.normals=new C(new Float32Array(a),3)},_raycast:function(t,e){return $r.superclass._raycast.call(this,t,e)}}),ti=$r,ei=[dt,Lt,xt,Ft,Yt],ni=function(){var t=\"\";ei.forEach((function(e){t+=\"\".concat(e.prototype.className,\":\").concat(Object.keys(e.cache._cache).length,\" \")})),m.a.log(t)},ri=a.a.create({Mixes:s.a,isLoadCache:!0,className:\"LoadCache\",Statics:{PENDING:1,LOADED:2,FAILED:3},enabled:!0,constructor:function(){this._files={}},update:function(t,e,n){if(this.enabled){var r={key:t,state:e,data:n};this._files[t]=r,this.fire(\"update\",r),this.fire(\"update:\".concat(r.key),r)}},get:function(t){return this.enabled?this._files[t]:null},getLoaded:function(t){var e=this.get(t);return e&&e.state===ri.LOADED?e.data:null},remove:function(t){delete this._files[t]},clear:function(){this._files={}},wait:function(t){var e=this;return t?t.state===ri.LOADED?Promise.resolve(t.data):t.state===ri.FAILED?Promise.reject():new Promise((function(n,r){e.on(\"update:\".concat(t.key),(function(t){var e=t.detail;e.state===ri.LOADED?n(e.data):e.state===ri.FAILED&&r(e.data)}),!0)})):Promise.reject()}}),ii=ri,ai=new ii,si=a.a.create({Mixes:s.a,isBasicLoader:!0,className:\"BasicLoader\",Statics:{_cache:ai,enalbeCache:function(){ai.enabled=!0},disableCache:function(){ai.enabled=!1},deleteCache:function(t){ai.remove(t)},clearCache:function(){ai.clear()},cache:{get:function(){return ai},set:function(){m.a.warn(\"BasicLoader.cache is readonly!\")}},TYPE_IMAGE:\"img\",TYPE_JSON:\"json\",TYPE_BUFFER:\"buffer\",TYPE_TEXT:\"text\"},load:function(t){var e=t.src,n=t.type;if(!n){var r=Object(i.getExtension)(e);/^(?:png|jpe?g|gif|webp|bmp)$/i.test(r)&&(n=\"img\"),n||(n=t.defaultType)}return n===si.TYPE_IMAGE?this.loadImg(e,t.crossOrigin):this.loadRes(e,n)},isCrossOrigin:function(t){var e=window.location,n=document.createElement(\"a\");return n.href=t,n.hostname!==e.hostname||n.port!==e.port||n.protocol!==e.protocol},isBase64:function(t){return/^data:(.+?);base64,/.test(t)},Uint8ArrayFrom:function(t,e){if(Uint8Array.from)return Uint8Array.from(t,e);for(var n=t.length,r=new Uint8Array(n),i=0;i<n;i++)r[i]=e(t[i]);return r},loadImg:function(t,e){var n=this,r=ai.get(t);return r?ai.wait(r):new Promise((function(r,i){var a=new Image;ai.update(t,ii.PENDING),a.onload=function(){a.onerror=null,a.onabort=null,a.onload=null,ai.update(t,ii.LOADED,a),r(a)},a.onerror=function(){a.onerror=null,a.onabort=null,a.onload=null;var e=new Error(\"Image load failed for \".concat(t.slice(0,100)));ai.update(t,ii.FAILED,e),i(e)},a.onabort=a.onerror,(e||n.isCrossOrigin(t))&&(n.isBase64(t)||(a.crossOrigin=\"anonymous\")),a.src=t}))},loadRes:function(t,e){var n=this;if(this.isBase64(t)){var r=RegExp.$1,i=t.slice(13+r.length),a=atob(i);return e===si.TYPE_JSON?a=JSON.parse(a):e===si.TYPE_BUFFER&&(a=this.Uint8ArrayFrom(a,(function(t){return t.charCodeAt(0)})).buffer),Promise.resolve(a)}var s=ai.get(t);return s?ai.wait(s):(ai.update(t,ii.PENDING),this.fire(\"beforeload\"),this.request({url:t,type:e}).then((function(e){return n.fire(\"loaded\"),ai.update(t,ii.LOADED,e),e}),(function(e){throw n.fire(\"failed\",e),ai.update(t,ii.FAILED),new Error(\"Resource load failed for \".concat(t,\", \").concat(e))})))},request:function(t){var e=this;return new Promise((function(n,r){var a=new XMLHttpRequest;a.onload=function(){if(a.status<200||a.status>=300)r(new TypeError(\"Network request failed for \".concat(a.status)));else{var e=\"response\"in a?a.response:a.responseText;if(t.type===si.TYPE_JSON)try{e=JSON.parse(e)}catch(t){return void r(new TypeError(\"JSON.parse error\"+t))}n(e)}},a.onprogress=function(n){e.fire(\"progress\",{url:t.url,loaded:n.loaded,total:n.total})},a.onerror=function(){r(new TypeError(\"Network request failed\"))},a.ontimeout=function(){r(new TypeError(\"Network request timed out\"))},a.open(t.method||\"GET\",t.url,!0),\"include\"===t.credentials&&(a.withCredentials=!0),t.type===si.TYPE_BUFFER&&(a.responseType=\"arraybuffer\"),Object(i.each)(t.headers,(function(t,e){a.setRequestHeader(e,t)})),a.send(t.body||null)}))}}),oi=si,ui=a.a.create({isLoader:!0,className:\"Loader\",maxConnections:2,Statics:{_loaderClassMap:{},_loaders:{},addLoader:function(t,e){ui._loaderClassMap[t]=e},getLoader:function(t){if(!ui._loaders[t]){var e=ui._loaderClassMap[t]?ui._loaderClassMap[t]:oi;ui._loaders[t]=new e}return ui._loaders[t]}},preHandlerUrl:null,load:function(t){var e=this;if(t instanceof Array)return Promise.all(t.map((function(t){return e.load(t)})));var n=t.type||Object(i.getExtension)(t.src),r=ui.getLoader(n),a=t;return this.preHandlerUrl&&((a=Object.assign({},t)).src=this.preHandlerUrl(t.src)),r.load(a)}}),ci=ui,hi=a.a.create({Extends:oi,isCubeTextureLoader:!0,className:\"CubeTextureLoader\",constructor:function(){hi.superclass.constructor.call(this)},load:function(t){var e,n=this;return e=t.images&&Array.isArray(t.images)?t.images:[t.right,t.left,t.top,t.bottom,t.front,t.back],Promise.all(e.map((function(e){return n.loadImg(e,t.crossOrigin)}))).then((function(e){var n=Object.assign({},t);return delete n.images,delete n.type,delete n.right,delete n.left,delete n.top,delete n.bottom,delete n.front,delete n.back,n.image=e,new fe(n)})).catch((function(t){throw m.a.error(\"load CubeTexture failed\",t.message,t.stack),t}))}});ci.addLoader(\"CubeTexture\",hi);var fi=hi,li=a.a.create({Extends:We,isPBRMaterial:!0,className:\"PBRMaterial\",lightType:\"PBR\",gammaCorrection:!0,usePhysicsLight:!0,baseColor:null,baseColorMap:null,metallic:1,metallicMap:null,roughness:1,roughnessMap:null,metallicRoughnessMap:null,occlusionMap:null,occlusionStrength:1,isOcclusionInMetallicRoughnessMap:!1,diffuseEnvMap:null,diffuseEnvSphereHarmonics3:null,diffuseEnvIntensity:1,brdfLUT:null,specularEnvIntensity:1,specularEnvMap:null,isSpecularEnvMapIncludeMipmaps:!1,emission:null,isSpecularGlossiness:!1,specular:null,glossiness:1,specularGlossinessMap:null,clearcoatFactor:0,clearcoatMap:null,clearcoatRoughnessFactor:0,clearcoatRoughnessMap:null,clearcoatNormalMap:null,usedUniformVectors:11,constructor:function(t){this.baseColor=new v.a(1,1,1),this.specular=new v.a(1,1,1),li.superclass.constructor.call(this,t),Object.assign(this.uniforms,{u_baseColor:\"BASECOLOR\",u_metallic:\"METALLIC\",u_roughness:\"ROUGHNESS\",u_specular:\"SPECULAR\",u_glossiness:\"GLOSSINESS\",u_brdfLUT:\"BRDFLUT\",u_diffuseEnvMap:\"DIFFUSEENVMAP\",u_diffuseEnvIntensity:\"DIFFUSEENVINTENSITY\",u_occlusionStrength:\"OCCLUSIONSTRENGTH\",u_specularEnvMap:\"SPECULARENVMAP\",u_specularEnvIntensity:\"SPECULARENVINTENSITY\",u_specularEnvMapMipCount:\"SPECULARENVMAPMIPCOUNT\",u_diffuseEnvSphereHarmonics3:\"DIFFUSEENVSPHEREHARMONICS3\",u_clearcoatFactor:\"CLEARCOATFACTOR\",u_clearcoatRoughnessFactor:\"CLEARCOATROUGHNESSFACTOR\"}),this.addTextureUniforms({u_baseColorMap:\"BASECOLORMAP\",u_metallicMap:\"METALLICMAP\",u_roughnessMap:\"ROUGHNESSMAP\",u_metallicRoughnessMap:\"METALLICROUGHNESSMAP\",u_occlusionMap:\"OCCLUSIONMAP\",u_specularGlossinessMap:\"SPECULARGLOSSINESSMAP\",u_lightMap:\"LIGHTMAP\",u_clearcoatMap:\"CLEARCOATMAP\",u_clearcoatRoughnessMap:\"CLEARCOATROUGHNESSMAP\",u_clearcoatNormalMap:\"CLEARCOATNORMALMAP\"})},getRenderOption:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};li.superclass.getRenderOption.call(this,t);var e=this._textureOption.reset(t);return e.add(this.baseColorMap,\"BASE_COLOR_MAP\"),e.add(this.metallicMap,\"METALLIC_MAP\"),e.add(this.roughnessMap,\"ROUGHNESS_MAP\"),e.add(this.metallicRoughnessMap,\"METALLIC_ROUGHNESS_MAP\"),e.add(this.diffuseEnvMap,\"DIFFUSE_ENV_MAP\"),e.add(this.occlusionMap,\"OCCLUSION_MAP\"),e.add(this.lightMap,\"LIGHT_MAP\"),this.brdfLUT&&(e.add(this.specularEnvMap,\"SPECULAR_ENV_MAP\"),et.SHADER_TEXTURE_LOD&&this.specularEnvMap&&(t.USE_SHADER_TEXTURE_LOD=1)),this.isSpecularGlossiness&&(t.PBR_SPECULAR_GLOSSINESS=1,e.add(this.specularGlossinessMap,\"SPECULAR_GLOSSINESS_MAP\")),this.isOcclusionInMetallicRoughnessMap&&(t.IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP=1),1!==this.occlusionStrength&&(t.OCCLUSION_STRENGTH=1),this.diffuseEnvSphereHarmonics3&&(t.HAS_NORMAL=1,t.DIFFUSE_ENV_SPHERE_HARMONICS3=1),(this.specularEnvMap||this.diffuseEnvSphereHarmonics3||this.specularEnvMap)&&(t.NEED_WORLD_NORMAL=1),this.specularEnvMap&&this.isSpecularEnvMapIncludeMipmaps&&(t.IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS=1),this.clearcoatFactor>0&&(t.HAS_CLEARCOAT=1,t.HAS_NORMAL=1,this.clearcoatMap&&e.add(this.clearcoatMap,\"CLEARCOAT_MAP\"),this.clearcoatNormalMap&&e.add(this.clearcoatNormalMap,\"CLEARCOAT_NORMAL_MAP\"),this.clearcoatRoughnessMap&&e.add(this.clearcoatRoughnessMap,\"CLEARCOAT_ROUGHNESS_MAP\")),e.update(),t}}),di=li,mi=new Image;mi.src=\"data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7\";var _i=a.a.create({Extends:Yt,Mixes:s.a,isLazyTexture:!0,className:\"LazyTexture\",_src:\"\",crossOrigin:!1,autoLoad:!0,resType:\"\",src:{get:function(){return this._src},set:function(t){this._src!==t&&(this._src=t,this.autoLoad&&this.load())}},constructor:function(t){t&&(\"crossOrigin\"in t&&(this.crossOrigin=t.crossOrigin),\"autoLoad\"in t&&(this.autoLoad=t.autoLoad)),_i.superclass.constructor.call(this,t),this.image=this.placeHolder||mi},load:function(t){var e=this;return _i.loader=_i.loader||new ci,_i.loader.load({src:this.src,crossOrigin:this.crossOrigin,type:this.resType,defaultType:\"img\"}).then((function(t){t.isTexture?(Object.assign(e,t),e.needUpdate=!0,e.needDestroy=!0,e.fire(\"load\")):(e.image=t,e.needUpdate=!0,e.fire(\"load\"))}),(function(n){if(e.fire(\"error\"),t)throw new Error(\"LazyTexture Failed \".concat(n));m.a.warn(\"LazyTexture Failed \".concat(n))}))},_releaseImage:function(){this._src&&\"string\"!=typeof this._src&&(this._src=\"\"),_i.superclass._releaseImage.call(this)}}),pi=_i,gi=n(13);function vi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(\"undefined\"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return Ei(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(t);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ei(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function Ei(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Ti=new l.a,Mi=new l.a,Ai=new l.a,Li=new l.a,Oi=new l.a,Ii=new l.a,Si=new gi.a,Ri=[];function yi(t,e){return t-e}var xi=a.a.create({Statics:{interpolation:{LINEAR:function(t,e,n){if(void 0===e)return t;if(t.slerp)return t.slerp(e,n);if(t.lerp)return t.lerp(e,n);if(Object(i.isArrayLike)(t)){Ri.length=0;for(var r=t.length-1;r>=0;r--)Ri[r]=t[r]+n*(e[r]-t[r]);return Ri}return t+n*(e-t)},STEP:function(t,e,n){return t},CUBICSPLINE:function(t,e,n,r){var a=t.length/3;if(void 0===e)return 1===a?t[1]:t.slice(a,-a);var s=t[1],o=t[2],u=e[1],c=e[0];return a>1&&(s=t.slice(a,-a),o=t.slice(-a),u=e.slice(a,-a),c=e.slice(0,a)),s.hermite?s.hermite(s,o.scale(r),u,c.scale(r),n):s.isQuaternion?(s.fromArray(this._cubicSpline(s.elements,o.elements,u.elements,c.elements,r,n),0,!0),s.normalize(!0)):(Object(i.isArrayLike)(s)||(s=[s],o=[o],u=[u],c=[c]),s=this._cubicSpline(s,o,u,c,r,n)),s},_cubicSpline:function(t,e,n,r,i,a){var s=a*a,o=s*a,u=2*o-3*s+1,c=o-2*s+a,h=-2*o+3*s,f=o-s;Ri.length=0;for(var l=t.length-1;l>=0;l--)Ri[l]=t[l]*u+c*e[l]*i+n[l]*h+f*r[l]*i;return Ri}},StateType:{TRANSLATE:\"Translation\",POSITION:\"Translation\",TRANSLATION:\"Translation\",SCALE:\"Scale\",ROTATE:\"Rotation\",ROTATION:\"Rotation\",QUATERNION:\"Quaternion\",WEIGHTS:\"Weights\"},getType:function(t){return t=String(t).toUpperCase(),xi.StateType[t]||xi._extraStateHandlers.type[t]},_extraStateHandlers:{type:{},handler:{}},registerStateHandler:function(t,e){xi._extraStateHandlers.type[String(t).toUpperCase()]=t,xi._extraStateHandlers.handler[t]=e}},isAnimationStates:!0,className:\"AnimationStates\",nodeName:\"\",type:\"\",interpolationType:\"LINEAR\",constructor:function(t){this.id=d.a.generateUUID(this.className),this.keyTime=[],this.states=[],Object.assign(this,t)},findIndexByTime:function(t){return Object(i.getIndexFromSortedArray)(this.keyTime,t,yi)},getStateByIndex:function(t){var e=this.states.length/this.keyTime.length;return 1===e?this.states[t]:this.states.slice(t*e,t*e+e)},getState:function(t){var e=vi(this.findIndexByTime(t),2),n=e[0],r=e[1];if(n<0||r>=this.keyTime.length)return null;var a=this.keyTime[n],s=this.keyTime[r],o=this.getStateByIndex(n);if(\"STEP\"===this.interpolationType)return o;if(n===r){var u=this.interpolation(o);return this.type===xi.StateType.ROTATION&&(u=Ti.fromEuler(Si.fromArray(u))),u.elements||u}var c=this.getStateByIndex(r),h=s-a,f=(t-a)/h;this.type===xi.StateType.ROTATION?Object(i.isArrayLike)(o[0])?(o[0]=Ti.fromEuler(Si.fromArray(o[0])),o[1]=Mi.fromEuler(Si.fromArray(o[1])),o[2]=Ai.fromEuler(Si.fromArray(o[2])),c[0]=Li.fromEuler(Si.fromArray(c[0])),c[1]=Oi.fromEuler(Si.fromArray(c[1])),c[2]=Ii.fromEuler(Si.fromArray(c[2]))):(o=Ti.fromEuler(Si.fromArray(o)),c=Mi.fromEuler(Si.fromArray(c))):this.type===xi.StateType.QUATERNION&&(Object(i.isArrayLike)(o[0])?(o[0]=Ti.fromArray(o[0]),o[1]=Mi.fromArray(o[1]),o[2]=Ai.fromArray(o[2]),c[0]=Li.fromArray(c[0]),c[1]=Oi.fromArray(c[1]),c[2]=Ii.fromArray(c[2])):(o=Ti.fromArray(o),c=Mi.fromArray(c)));var l=this.interpolation(o,c,f,h);return l.elements||l},interpolation:function(t,e,n,r){return xi.interpolation[this.interpolationType](t,e,n,r)},updateNodeTranslation:function(t,e){t.x=e[0],t.y=e[1],t.z=e[2]},updateNodeScale:function(t,e){t.scaleX=e[0],t.scaleY=e[1],t.scaleZ=e[2]},updateNodeQuaternion:function(t,e){t.quaternion.fromArray(e)},updateNodeWeights:function(t,e){var n=this._originalWeightIndices=this._originalWeightIndices||[],r=e.length;e=e.slice();for(var i=0;i<r;i++)n[i]=i;for(var a=0;a<r;a++)for(var s=a+1;s<r;s++)if(e[s]>e[a]){var o=e[a];e[a]=e[s],e[s]=o,o=n[a],n[a]=n[s],n[s]=o}t.traverse((function(t){t.isMesh&&t.geometry&&t.geometry.isMorphGeometry&&t.geometry.update(e,n)}))},updateNodeState:function(t,e){if(e){var n=this.type;n===xi.StateType.ROTATION&&(n=xi.StateType.QUATERNION);var r=this.getState(t);if(r){var i=\"updateNode\"+n;this[i]?this[i](e,r):xi._extraStateHandlers.handler[n]?xi._extraStateHandlers.handler[n].call(this,e,r):m.a.warnOnce(i,\"updateNodeState failed unknow type(%s)\",n)}}},clone:function(){return new this.constructor({keyTime:this.keyTime,states:this.states,type:this.type,nodeName:this.nodeName})}}),Ni=xi,bi=a.a.create({Statics:{_anims:[],tick:function(t){this._anims.forEach((function(e){return e.tick(t)}))}},Mixes:s.a,isAnimation:!0,className:\"Animation\",paused:!1,currentLoopCount:0,loop:1/0,currentTime:0,timeScale:1,startTime:0,endTime:0,clipStartTime:0,clipEndTime:0,nodeNameMap:null,_rootNode:null,rootNode:{get:function(){return this._rootNode},set:function(t){this._rootNode=t,this._initNodeNameMap()}},_animStatesList:null,animStatesList:{get:function(){return this._animStatesList},set:function(t){this._animStatesList=t,this._initClipTime()}},validAnimationIds:null,constructor:function(t){this.id=d.a.generateUUID(this.className),this.clips={},this._animStatesList=[],Object.assign(this,t)},addClip:function(t,e,n,r){this.clips[t]={start:e,end:n,animStatesList:r}},removeClip:function(t){this.clips[t]=null},getAnimStatesListTimeInfo:function(t){var e=0,n=1/0;return t.forEach((function(t){e=Math.max(t.keyTime[t.keyTime.length-1],e),n=Math.min(t.keyTime[0],n)})),{startTime:n,endTime:e}},_initClipTime:function(){var t=this.getAnimStatesListTimeInfo(this.animStatesList);this.clipStartTime=t.startTime,this.clipEndTime=t.endTime},_initNodeNameMap:function(){if(this._rootNode){var t=this.nodeNameMap={};this._rootNode.traverse((function(e){t[e.animationId]=e;var n=e.name;void 0===n||t[n]||(t[n]=e)}),!1)}},tick:function(t){this.paused||(this.currentTime+=t/1e3*this.timeScale,this.currentTime>=this.endTime?(this.currentLoopCount++,this.currentTime=this.endTime,this.updateAnimStates(),this.fire(\"loopEnd\"),!this.loop||this.currentLoopCount>=this.loop?(this.stop(),this.fire(\"end\")):this.currentTime=this.startTime):this.updateAnimStates())},updateAnimStates:function(){var t=this;return this.animStatesList.forEach((function(e){e.updateNodeState(t.currentTime,t.nodeNameMap[e.nodeName])})),this},play:function(t,e){var n;if(\"string\"==typeof t){var r=this.clips[t];r?(n=r.start,e=r.end,r.animStatesList&&(this.animStatesList=r.animStatesList,this._initClipTime())):m.a.warn(\"no this animation clip name:\"+t)}else n=t;void 0===n&&(n=this.clipStartTime),void 0===e&&(e=this.clipEndTime),this.endTime=Math.min(e,this.clipEndTime),this.startTime=Math.min(n,this.endTime),this.currentTime=this.startTime,this.currentLoopCount=0,this.stop(),this.paused=!1,bi._anims.push(this)},stop:function(){this.paused=!0;var t=bi._anims,e=t.indexOf(this);-1!==e&&t.splice(e,1)},pause:function(){this.paused=!0},resume:function(){this.paused=!1},clone:function(t){var e=new this.constructor({rootNode:t,animStatesList:this.animStatesList,timeScale:this.timeScale,loop:this.loop,paused:this.paused,currentTime:this.currentTime,startTime:this.startTime,endTime:this.endTime,clips:this.clips});return this.paused||e.play(),e}}),Ci=bi;function Pi(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){if(\"undefined\"==typeof Symbol||!(Symbol.iterator in Object(t)))return;var n=[],r=!0,i=!1,a=void 0;try{for(var s,o=t[Symbol.iterator]();!(r=(s=o.next()).done)&&(n.push(s.value),!e||n.length!==e);r=!0);}catch(t){i=!0,a=t}finally{try{r||null==o.return||o.return()}finally{if(i)throw a}}return n}(t,e)||function(t,e){if(!t)return;if(\"string\"==typeof t)return wi(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);\"Object\"===n&&t.constructor&&(n=t.constructor.name);if(\"Map\"===n||\"Set\"===n)return Array.from(t);if(\"Arguments\"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return wi(t,e)}(t,e)||function(){throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\")}()}function wi(t,e){(null==e||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}var Hi=P.a.BLEND,Di=P.a.DEPTH_TEST,Fi=P.a.CULL_FACE,Ui=P.a.FRONT,Gi=P.a.BACK,Bi=P.a.FRONT_AND_BACK,Vi={5120:[1,Int8Array],5121:[1,Uint8Array],5122:[2,Int16Array],5123:[2,Uint16Array],5125:[4,Uint32Array],5126:[4,Float32Array]},Xi={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},ji={POSITION:{name:\"vertices\",decodeMatName:\"positionDecodeMat\"},TEXCOORD_0:{name:\"uvs\",decodeMatName:\"uvDecodeMat\"},TEXCOORD_1:{name:\"uvs1\",decodeMatName:\"uv1DecodeMat\"},NORMAL:{name:\"normals\",decodeMatName:\"normalDecodeMat\"},JOINT:{name:\"skinIndices\"},JOINTS_0:{name:\"skinIndices\"},WEIGHT:{name:\"skinWeights\"},WEIGHTS_0:{name:\"skinWeights\"},TANGENT:{name:\"tangents\"},COLOR_0:{name:\"colors\"}},ki=a.a.create({isGLTFParser:!0,className:\"GLTFParser\",Statics:{MAGIC:\"glTF\",extensionHandlers:r,registerExtensionHandler:function(t,e){this.extensionHandlers[t]=e},unregisterExtensionHandler:function(t){this.extensionHandlers[t]&&delete this.extensionHandlers[t]}},isMultiAnim:!0,isProgressive:!1,isUnQuantizeInShader:!0,isLoadAllTextures:!1,preHandlerImageURI:null,preHandlerBufferURI:null,customMaterialCreator:null,ignoreTextureError:!1,forceCreateNewBuffer:!1,src:\"\",constructor:function(t,e){Object.assign(this,e),this.content=t},parse:function(t){var e=this;if(this.content instanceof ArrayBuffer){var n=this.content;if(i.convertUint8ArrayToString(new Uint8Array(n,0,4))===ki.MAGIC)this.parseBinary(n);else{var r=i.convertUint8ArrayToString(new Uint8Array(n),!0);this.json=JSON.parse(r)}}else this.json=JSON.parse(this.content);return this.glTFVersion=parseFloat(this.json.asset.version),this.glTFVersion>=2&&(this.isGLTF2=!0),this.parseExtensionUsed(),this.loadResources(t).then((function(){return e.parseExtensions(e.json.extensions,null,{isGlobal:!0,methodName:\"parseOnLoad\"}),Promise.resolve()})).then((function(){return e.parseGeometries()})).then((function(){return e.parseScene()}))},parseExtensionUsed:function(){var t=this;this.extensionsUsed={},i.each(this.json.extensionsUsed,(function(e){t.extensionsUsed[e]=!0})),this.extensionsUsed.WEB3D_quantized_attributes||(this.isUnQuantizeInShader=!1)},getExtensionHandler:function(t){return this.extensionHandlers&&this.extensionHandlers[t]||ki.extensionHandlers[t]},parseExtension:function(t,e,n){var r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},i=t[e],a=this.getExtensionHandler(e);return a&&a.parse?a.parse(i,this,n,r):n},parseExtensions:function(t,e){var n=this,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return i.each(t,(function(t,i){if(!r.ignoreExtensions||!r.ignoreExtensions[i]){var a=n.getExtensionHandler(i),s=r.methodName||\"parse\";a&&a[s]&&(e=a[s](t,n,e,r))}})),e},isUseExtension:function(t,e){return!!(t&&t.extensions&&t.extensions[e])},parseBinary:function(t){this.isBinary=!0;var e,n=new DataView(t),r=n.getUint32(4,!0),a=n.getUint32(8,!0),s=12;if(r<2){var o=n.getUint32(s,!0);e=new Uint8Array(t,20,o),e=i.convertUint8ArrayToString(e,!0),this.json=JSON.parse(e),this.binaryBody=t.slice(20+o)}else{if(2!==r)throw new Error(\"Dont support glTF version \".concat(r));for(;s<a;){var u=n.getUint32(s,!0),c=n.getUint32(s+4,!0);1313821514===c?(e=new Uint8Array(t,s+8,u),e=i.convertUint8ArrayToString(e,!0),this.json=JSON.parse(e)):5130562===c&&(this.binaryBody=t.slice(s+8,s+8+u)),s+=8+u}}},loadResources:function(t){var e=this,n=[];for(var r in this.extensionsUsed){var i=this.getExtensionHandler(r);i&&i.init&&n.push(i.init(t,this))}return this.isBinary?n.push(this.loadBuffers(t).then((function(){return e.loadTextures(t)}))):(n.push(this.loadBuffers(t)),n.push(this.loadTextures(t))),Promise.all(n)},getBufferUri:function(t){var e=i.getRelativePath(this.src,this.json.buffers[t].uri);return this.preHandlerBufferURI&&(e=this.preHandlerBufferURI(e,this.json.buffers[t])),e},loadBuffers:function(t){var e=this;return this.buffers={},this.isBinary?(this.isGLTF2?this.buffers[0]=this.binaryBody:this.buffers.binary_glTF=this.binaryBody,this.parseBufferViews(),Promise.resolve()):Promise.all(Object.keys(this.json.buffers||[]).map((function(n){var r=e.getBufferUri(n);return t.loadRes(r,oi.TYPE_BUFFER).then((function(t){e.buffers[n]=t}))}))).then((function(){e.parseBufferViews()}))},getImageUri:function(t){var e=this.json.images[t],n=e.uri;if(this.isUseExtension(e,\"KHR_binary_glTF\")){var r=e.extensions.KHR_binary_glTF,a=this.bufferViews[r.bufferView],s=new Uint8Array(a.buffer,a.byteOffset,a.byteLength);n=i.getBlobUrl(r.mimeType,s)}else if(n)n=i.getRelativePath(this.src,n);else if(\"bufferView\"in e){var o=this.bufferViews[e.bufferView],u=new Uint8Array(o.buffer,o.byteOffset,o.byteLength);n=\"image/ktx\"===e.mimeType?u:i.getBlobUrl(e.mimeType,u)}return this.preHandlerImageURI&&(n=this.preHandlerImageURI(n,e)),n},getImageType:function(t){var e=this.json.images[t],n=\"\";return e&&/^image\\/(.*)$/.test(e.mimeType)&&(n=RegExp.$1),[\"ktx\"].indexOf(n)<0&&(n=\"\"),n},getUsedTextureNameMap:function(){var t=this,e={};return i.each(this.json.materials,(function(n){var r=n,a=!1;if(t.isUseExtension(n,\"KHR_materials_common\")&&(a=!0,r=n.extensions.KHR_materials_common.values),t.isGLTF2&&!a){if(r.normalTexture&&(e[r.normalTexture.index]=!0),r.occlusionTexture&&(e[r.occlusionTexture.index]=!0),r.emissiveTexture&&(e[r.emissiveTexture.index]=!0),r.transparencyTexture&&(e[r.transparencyTexture.index]=!0),r.extensions&&i.each(r.extensions,(function(n,r){var i=t.getExtensionHandler(r);i&&i.getUsedTextureNameMap&&i.getUsedTextureNameMap(n,e,t)})),!t.isUseExtension(r,\"KHR_materials_pbrSpecularGlossiness\")&&r.pbrMetallicRoughness){var s=r.pbrMetallicRoughness;s.baseColorTexture&&(e[s.baseColorTexture.index]=!0),s.metallicRoughnessTexture&&(e[s.metallicRoughnessTexture.index]=!0)}}else a||(r=n.values),[\"diffuse\",\"specular\",\"emission\",\"ambient\",\"transparency\",\"normalMap\"].forEach((function(n){var a=r[n];a instanceof Object&&\"index\"in a&&(a=a.index),i.isStrOrNumber(a)&&t.json.textures[a]&&(e[a]=!0)}))})),e},loadTextures:function(){var t=this;if(this.textures={},!this.json.textures)return Promise.resolve();var e=Object.keys(this.json.textures);if(!this.isLoadAllTextures){var n=this.getUsedTextureNameMap();e=e.filter((function(t){return n[t]}))}return Promise.all(e.map((function(e){var n=t.json.textures[e],r=t.getImageUri(n.source),a=new pi(n);if(a.uv=void 0,a.autoLoad=t.isProgressive,a.crossOrigin=!0,a.resType=t.getImageType(n.source),a.src=r,a.name=n.name||e,i.isBlobUrl(r)){var s=function t(){i.revokeBlobUrl(r),a.off(\"load\",t),a.off(\"error\",t)};a.on(\"load\",s,!0),a.on(\"error\",s,!0)}return t.json.samplers&&Object.assign(a,t.json.samplers[n.sampler]),n.extensions&&(a=t.parseExtensions(n.extensions,a)),t.textures[e]=a,t.isProgressive?Promise.resolve():a.load(!t.ignoreTextureError)})))},parseBufferViews:function(){var t=this;this.bufferViews={},i.each(this.json.bufferViews,(function(e,n){var r=t.buffers[e.buffer],i=e.byteOffset||0,a=e.byteLength;t.bufferViews[n]={id:d.a.generateUUID(\"bufferView\"),byteOffset:i,byteLength:a,buffer:r,byteStride:e.byteStride}})),this.isBinary||delete this.buffers},getTexture:function(t){var e=this.textures[t.index];if(!e)return null;var n=t.texCoord||0,r=t.index+\"_\"+n;return this.textures[r]?e=this.textures[r]:\"number\"==typeof e.uv&&e.uv!==n&&(e=e.clone(),this.textures[r]=e),e.uv=n,e.__gltfTextureInfo=t,e},getColorOrTexture:function(t){return Array.isArray(t)?new v.a(t[0],t[1],t[2]):(t instanceof Object&&\"index\"in t&&(t=t.index),this.textures[t])},parseMaterialCommonProps:function(t,e){switch(e.alphaMode){case\"BLEND\":t.transparent=!0;break;case\"MASK\":t.alphaCutoff=\"alphaCutoff\"in e?e.alphaCutoff:.5;break;case\"OPAQUE\":default:t.ignoreTranparent=!0}e.doubleSided?t.side=Bi:t.side=Ui,e.transparencyTexture&&(t.transparency=this.getTexture(e.transparencyTexture))},createPBRMaterial:function(t){var e=new di,n=t,r=!this.isUseExtension(n,\"KHR_materials_unlit\");if(r){var i=n.normalTexture;i&&(e.normalMap=this.getTexture(i),void 0!==i.scale?e.normalMapScale=i.scale:e.normalMapScale=1);var a=n.occlusionTexture;a&&(e.occlusionMap=this.getTexture(a),void 0!==a.strength?e.occlusionStrength=a.strength:e.occlusionStrength=1);var s=n.emissiveTexture;s&&(e.emission=this.getTexture(s))}else e.lightType=\"NONE\";if(this.isUseExtension(n,\"KHR_materials_pbrSpecularGlossiness\"))this.parseExtension(n.extensions,\"KHR_materials_pbrSpecularGlossiness\",e);else if(n.pbrMetallicRoughness){var o=n.pbrMetallicRoughness;o.baseColorFactor&&e.baseColor.fromArray(o.baseColorFactor),o.baseColorTexture&&(e.baseColorMap=this.getTexture(o.baseColorTexture)),r&&(o.metallicRoughnessTexture&&(e.metallicRoughnessMap=this.getTexture(o.metallicRoughnessTexture),e.occlusionMap===e.metallicRoughnessMap&&(e.occlusionMap=null,e.isOcclusionInMetallicRoughnessMap=!0)),\"roughnessFactor\"in o&&(e.roughness=o.roughnessFactor),\"metallicFactor\"in o&&(e.metallic=o.metallicFactor))}return e.baseColorMap&&this._parseTextureTransform(e,e.baseColorMap),e},_parseTextureTransform:function(t,e){var n=e.__gltfTextureInfo;if(this.isUseExtension(n,\"KHR_texture_transform\")){var r=n.extensions.KHR_texture_transform;if(void 0!==r.texCoord&&(e.uv=r.texCoord),r.offset||r.rotation||r.scale){var i=r.offset||[0,0],a=r.rotation||0,s=r.scale||[1,1],o=(new y.a).fromRotationTranslationScale(a,i[0],i[1],s[0],s[1]);0===e.uv?t.uvMatrix=o:1===e.uv&&(t.uvMatrix1=o)}}},createKMCMaterial:function(t,e){var n,r=new Ze;return e?(n=e.values,r.lightType=e.technique):n=t.values,r.diffuse=this.getColorOrTexture(n.diffuse)||r.diffuse,r.specular=this.getColorOrTexture(n.specular)||r.specular,r.emission=this.getColorOrTexture(n.emission)||r.emission,r.ambient=this.getColorOrTexture(n.ambient)||r.ambient,n.normalMap&&(r.normalMap=this.getColorOrTexture(n.normalMap)),\"number\"==typeof n.transparency?(r.transparency=n.transparency,r.transparency<1&&(r.transparent=!0)):\"string\"==typeof n.transparency&&(r.transparency=this.getColorOrTexture(n.transparency),r.transparent=!0),!0===n.transparent&&(r.transparent=!0),\"shininess\"in n&&(r.shininess=n.shininess),this._parseTextureTransform(r,r.diffuse),r},parseMaterials:function(){var t=this;this.materials={},i.each(this.json.materials,(function(e,n){if(t.customMaterialCreator){var r=t.customMaterialCreator(n,e,t.json,t);if(r)return void(t.materials[n]=r)}var i,a=null;t.isUseExtension(e,\"KHR_materials_common\")&&(a=e.extensions.KHR_materials_common),t.isGLTF2&&!a?(i=t.isUseExtension(e,\"KHR_techniques_webgl\")?t.parseExtension(e.extensions,\"KHR_techniques_webgl\"):t.createPBRMaterial(e),t.parseMaterialCommonProps(i,e)):i=t.createKMCMaterial(e,a),(i=t.parseExtensions(e.extensions,i,{ignoreExtensions:{KHR_techniques_webgl:1,KHR_materials_common:1,KHR_materials_pbrSpecularGlossiness:1},isMaterial:!0})).name=e.name||n,t.materials[n]=i,t.parseTechnique(e,i)}))},sparseAccessorHandler:function(t,e){if(!e)return t;var n=e.count,r=t.data.constructor,a=new r(t.realLength);a.set(t.data),t.data=a;for(var s=this.bufferViews[e.values.bufferView],o=new r(s.buffer,s.byteOffset+(e.values.byteOffset||0),n*t.size),u=new(r=Vi[e.indices.componentType][1])((s=this.bufferViews[e.indices.bufferView]).buffer,s.byteOffset+(e.indices.byteOffset||0),n),c=0;c<n;c++)i.copyArrayData(a,o,u[c]*t.size,c*t.size,t.size);return t},getAccessorData:function(t,e){var n=this.json.accessors[t];if(n.data)return n.data;var r,i=Pi(Vi[n.componentType],2)[1],a=Xi[n.type],s=this.bufferViews[n.bufferView],o=n.count*a;if(s)if(s.byteStride&&s.byteStride>a*i.BYTES_PER_ELEMENT)s.array=new i(s.buffer,s.byteOffset,s.byteLength/i.BYTES_PER_ELEMENT),r=new C(s.array,a,{offset:n.byteOffset||0,stride:s.byteStride,bufferViewId:s.id});else{var u,c=(n.byteOffset||0)+s.byteOffset;if(c%i.BYTES_PER_ELEMENT||this.forceCreateNewBuffer)u=new i(s.buffer.slice(c,c+o*i.BYTES_PER_ELEMENT));else u=new i(s.buffer,c,o);r=new C(u,a)}return n.sparse&&(r||(r=new C(new i(o),a)),r=this.sparseAccessorHandler(r,n.sparse)),r=this.parseExtensions(n.extensions,r,{isDecode:e,isAccessor:!0}),n.data=r,n.normalized&&(r.normalized=!0),r},getArrayByAccessor:function(t,e){var n=this.json.accessors[t];if(n.array)return n.array;var r=this.getAccessorData(t,e);if(!r.stride&&!r.offset&&1===r.size)return r.data;var i=[];return r.traverse((function(t){i.push(t.toArray?t.toArray():t)})),n.array=i,i},parseTechnique:function(t,e){var n=null;this.json.techniques&&(n=this.json.techniques[t.technique]),n&&n.states&&(n.states.enable.forEach((function(t){switch(t){case Hi:e.blend=!0;break;case Di:e.depthTest=!0;break;case Fi:e.cullFace=!0}})),i.each(n.states.functions,(function(t,n){switch(n){case\"blendEquationSeparate\":e.blendEquation=t[0],e.blendEquationAlpha=t[1];break;case\"blendFuncSeparate\":e.blendSrc=t[0],e.blendDst=t[1],e.blendSrcAlpha=t[2],e.blendDstAlpha=t[3];break;case\"depthMask\":e.depthMask=t[0];break;case\"cullFace\":e.cullFaceType=t[0];break;default:e[n]=t}})),e.cullFace?e.side=e.cullFaceType===Ui?Gi:Ui:e.side=Bi)},createMorphGeometry:function(t,e){var n=this,r=new jn,a=r.targets={};return i.each(t.targets,(function(t){i.each(t,(function(t,e){var r=ji[e].name;a[r]||(a[r]=[]);var i=n.getAccessorData(t,!0);a[r].push(i)}))})),r.weights=e||new Float32Array(t.targets.length),r},handlerGeometry:function(t,e){var n=void 0===e.mode?4:e.mode;if(e.extensions){var r=this.parseExtensions(e.extensions,null,{primitive:e,isPrimitive:!0});if(r)return r.mode=n,r}t||(t=new Z({mode:n})),\"indices\"in e&&(t.indices=this.getAccessorData(e.indices));var i=e.attributes;for(var a in i){var s=ji[a];if(s){var o=!(this.isUnQuantizeInShader&&s.decodeMatName);t[s.name]=this.getAccessorData(i[a],o),o||(t[s.decodeMatName]=t[s.name].decodeMat,delete t[s.name].decodeMat)}else m.a.warn(\"Unknow attribute named \".concat(a,\"!\"))}return t},handlerSkinedMesh:function(t,e){e&&(t.skeleton=e,this.useInstanced&&(t.useInstanced=!0))},fixProgressiveGeometry:function(t,e){t._geometry=e,this.isProgressive&&t._meshes&&t._meshes.forEach((function(t){t.visible=!0,t.geometry=e}))},parseGeometries:function(){var t=this,e=i.serialRun(this.json.meshes,(function(e){return i.serialRun(e.primitives,(function(n){var r;n.targets&&n.targets.length&&(r=t.createMorphGeometry(n,e.weights)),n._geometry=r;var i=t.handlerGeometry(r,n);return i&&i.then?i.then((function(e){t.fixProgressiveGeometry(n,e)}),(function(t){m.a.error(\"geometry parse error\",t)})):(t.fixProgressiveGeometry(n,i),i)}))}));return this.isProgressive?null:e},parseMesh:function(t,e,n){var r=this,i=this.json.meshes[t];i.primitives.forEach((function(a){var s,o=r.skins&&r.skins[n.skin];if(a.meshNode)s=a.meshNode.clone();else{var u=r.materials[a.material]||new Ze;s=new(o?dr:cr)({geometry:a._geometry,material:u,name:\"mesh-\"+(i.name||t)}),a.meshNode=s}r.handlerSkinedMesh(s,o),r.isProgressive&&!s.geometry&&(s.visible=!1,a._meshes=a._meshes||[],a._meshes.push(s)),e.addChild(s),r.meshes.push(s)}))},parseCameras:function(){var t=this;this.cameras={};var e=window.innerWidth/window.innerHeight;i.each(this.json.cameras,(function(n,r){var i;\"perspective\"===n.type&&n.perspective?((i=new Q).fov=d.a.radToDeg(n.perspective.yfov),i.near=n.perspective.znear,i.far=n.perspective.zfar,n.aspectRatio?i.aspect=n.aspectRatio:i.aspect=e):\"orthographic\"===n.type&&n.orthographic&&((i=new an).near=n.orthographic.znear,i.far=n.orthographic.zfar,i.right=n.orthographic.xmag,i.left=-1*i.right,i.top=n.orthographic.ymag,i.bottom=-1*i.top),(i=t.parseExtensions(n.extensions,i,{isCamera:!0}))&&(i.name=n.name||r,t.cameras[r]=i)}))},handlerNodeTransform:function(t,e){e.matrix?t.matrix.fromArray(e.matrix):(e.rotation&&t.quaternion.fromArray(e.rotation),e.scale&&t.setScale(e.scale[0],e.scale[1],e.scale[2]),e.translation&&(t.x=e.translation[0],t.y=e.translation[1],t.z=e.translation[2]))},parseNode:function(t,e){var n,r=this,i=this.json.nodes[t];i||m.a.warn(\"GLTFParser.parseNode: nodes[\".concat(t,\"] has nothing.\")),n=new g({name:i.name,animationId:t}),n=this.parseExtensions(i.extensions,n,{isNode:!0}),\"camera\"in i&&this.cameras[i.camera]&&n.addChild(this.cameras[i.camera]),this.handlerNodeTransform(n,i),i.jointName?(n.jointName=i.jointName,this.jointMap[n.jointName]=n):this.isGLTF2&&(n.jointName=t,this.jointMap[t]=n),i.meshes?i.meshes.forEach((function(t){return r.parseMesh(t,n,i)})):\"mesh\"in i&&this.parseMesh(i.mesh,n,i),i.children&&i.children.forEach((function(t){return r.parseNode(t,n)})),e.addChild(n)},parseAnimations:function(){var t=this;if(!this.json.animations)return null;var e=this.isMultiAnim,n={},r=[],a={};return i.each(this.json.animations,(function(i){i.channels.forEach((function(e){var n=e.target.path,s=e.target.id;t.isGLTF2&&(s=e.target.node);var o=i.samplers[e.sampler],u=t.isGLTF2?o.input:i.parameters[o.input],c=t.isGLTF2?o.output:i.parameters[n],h=t.getArrayByAccessor(u,!0),f=t.getArrayByAccessor(c,!0);\"rotation\"===n&&(n=\"quaternion\");var l=new Ni({interpolationType:o.interpolation||\"LINEAR\",nodeName:s,keyTime:h,states:f,type:Ni.getType(n)});r.push(l),a[s]=!0})),e&&r.length&&(n[i.name]={animStatesList:r},r=[])})),e&&Object.keys(n).length>0&&(r=Object.values(n)[0].animStatesList),r.length?new Ci({rootNode:this.node,animStatesList:r,validAnimationIds:a,clips:n}):null},parseScene:function(){var t=this;this.parseMaterials(),this.jointMap={},this.meshes=[],this.lights=[],this.node=new g({needCallChildUpdate:!1}),this.parseCameras();var e=this.json.scenes[this.getDefaultSceneName()];if(!e)return m.a.warn(\"GLTFParser:no scene!\"),{node:this.node,meshes:[],cameras:[],lights:[],textures:[],materials:[]};var n=e.nodes;this.parseSkins(),n.forEach((function(e){return t.parseNode(e,t.node)})),this.resetSkinInfo(this.node);var r={node:this.node,scene:this.node,meshes:this.meshes,json:this.json,cameras:Object.values(this.cameras),lights:this.lights,textures:Object.values(this.textures),materials:Object.values(this.materials)},i=this.parseAnimations();return i&&(this.node.setAnim(i),i.play(),r.anim=i),this.parseExtensions(e.extensions,null,{isScene:!0}),this.parseExtensions(this.json.extensions,r,{isGlobal:!0,methodName:\"parseOnEnd\"}),r},getDefaultSceneName:function(){return void 0!==this.defaultScene?this.defaultScene:this.json.scenes?Object.keys(this.json.scenes)[0]:null},parseSkins:function(){var t=this;this.skins=[];var e=this.json.skins;e&&e.length&&(this.skins=e.map((function(e){for(var n=new _r,r=e.joints.length,i=t.getArrayByAccessor(e.inverseBindMatrices,!0),a=0;a<r;a++){var s=(new o.a).fromArray(i[a]);n.inverseBindMatrices.push(s)}return n.jointNames=e.joints,n})))},resetSkinInfo:function(t){var e={};t.traverse((function(t){var n=\"\".concat(t.id,\"_\").concat(t.name);e[t.jointName]=n,t.jointName=n})),this.skins.forEach((function(t){t.jointNames=t.jointNames.map((function(t){return e[t]}))})),t.resetSkinedMeshRootNode()}}),zi=ki,Yi=a.a.create({Extends:oi,isGLTFLoader:!0,className:\"GLTFLoader\",constructor:function(){Yi.superclass.constructor.call(this)},load:function(t){var e=this;return this.loadRes(t.src,\"buffer\").then((function(n){return new zi(n,t).parse(e)})).catch((function(t){throw m.a.error(\"load gltf failed\",t.message,t.stack),t}))}});ci.addLoader(\"gltf\",Yi),ci.addLoader(\"glb\",Yi);var Wi=Yi,qi=n(103),Zi=n.n(qi),Ki=P.a.RGBA,Qi=P.a.NEAREST,Ji=P.a.CLAMP_TO_EDGE,$i=P.a.FLOAT,ta=a.a.create({Extends:oi,isHDRLoader:!0,className:\"HDRLoader\",constructor:function(){ta.superclass.constructor.call(this)},load:function(t){return this.loadRes(t.src,\"buffer\").then((function(e){try{var n=Zi()(e),r=n.shape,i=n.data,a=new Yt({width:r[0],height:r[1],flipY:t.flipY||!1,image:i,type:$i,magFilter:Qi,minFilter:Qi,wrapS:Ji,wrapT:Ji,internalFormat:Ki,format:Ki});return Object.assign(a,t),a}catch(t){m.a.error(\"HDRLoader:parse error => \",t)}return null}))}});ci.addLoader(\"hdr\",ta);var ea=ta,na=a.a.create({Statics:{HEADER_LEN:64,COMPRESSED_2D:0,COMPRESSED_3D:1,TEX_2D:2,TEX_3D:3},isKhronosTextureContainer:!0,className:\"KhronosTextureContainer\",constructor:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.arrayBuffer=t,this.baseOffset=n;var r=new Uint8Array(this.arrayBuffer,this.baseOffset,12);if(171===r[0]&&75===r[1]&&84===r[2]&&88===r[3]&&32===r[4]&&49===r[5]&&49===r[6]&&187===r[7]&&13===r[8]&&10===r[9]&&26===r[10]&&10===r[11]){var i=Uint32Array.BYTES_PER_ELEMENT,a=new DataView(this.arrayBuffer,this.baseOffset+12,13*i),s=a.getUint32(0,!0),o=67305985===s;this.glType=a.getUint32(1*i,o),this.glTypeSize=a.getUint32(2*i,o),this.glFormat=a.getUint32(3*i,o),this.glInternalFormat=a.getUint32(4*i,o),this.glBaseInternalFormat=a.getUint32(5*i,o),this.pixelWidth=a.getUint32(6*i,o),this.pixelHeight=a.getUint32(7*i,o),this.pixelDepth=a.getUint32(8*i,o),this.numberOfArrayElements=a.getUint32(9*i,o),this.numberOfFaces=a.getUint32(10*i,o),this.numberOfMipmapLevels=a.getUint32(11*i,o),this.bytesOfKeyValueData=a.getUint32(12*i,o),this.numberOfMipmapLevels=Math.max(1,this.numberOfMipmapLevels),0!==this.pixelHeight&&0===this.pixelDepth?0===this.numberOfArrayElements?this.numberOfFaces===e?0===this.glType?this.loadType=na.COMPRESSED_2D:this.loadType=na.TEX_2D:m.a.warn(\"number of faces expected\"+e+\", but found \"+this.numberOfFaces):m.a.warn(\"texture arrays not currently supported\"):m.a.warn(\"only 2D textures currently supported\")}else m.a.error(\"texture missing KTX identifier\")},mipmaps:function(t){for(var e=[],n=na.HEADER_LEN+this.bytesOfKeyValueData,r=this.pixelWidth,i=this.pixelHeight,a=t?this.numberOfMipmapLevels:1,s=0;s<a;s++){for(var o=new Int32Array(this.arrayBuffer,this.baseOffset+n,1)[0],u=0;u<this.numberOfFaces;u++){var c=new Uint8Array(this.arrayBuffer,this.baseOffset+n+4,o);e.push({data:c,width:r,height:i}),n+=o+4,n+=3-(o+3)%4}r=Math.max(1,.5*r),i=Math.max(1,.5*i)}return e}}),ra=a.a.create({Extends:oi,Statics:{astc:\"WEBGL_compressed_texture_astc\",etc:\"WEBGL_compressed_texture_etc\",etc1:\"WEBGL_compressed_texture_etc1\",pvrtc:\"WEBGL_compressed_texture_pvrtc\",s3tc:\"WEBGL_compressed_texture_s3tc\"},isKTXLoader:!0,className:\"KTXLoader\",constructor:function(){tt.use(ra.astc),tt.use(ra.atc),tt.use(ra.etc),tt.use(ra.etc1),tt.use(ra.pvrtc),tt.use(ra.s3tc),tt.use(ra.s3tc_srgb),ra.superclass.constructor.call(this)},load:function(t){var e=this;return t.src instanceof ArrayBuffer?Promise.resolve(this.createTexture(t,t.src)):ArrayBuffer.isView(t.src)?Promise.resolve(this.createTexture(t,t.src.buffer,t.src.byteOffset)):this.loadRes(t.src,\"buffer\").then((function(n){return e.createTexture(t,n)}))},createTexture:function(t,e){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=new na(e,1,n),i={compressed:0===r.glType,type:r.glType,width:r.pixelWidth,height:r.pixelHeight,internalFormat:r.glInternalFormat,format:r.glFormat,isCubemap:6===r.numberOfFaces};return r.numberOfMipmapLevels>=Math.floor(Math.log2(Math.max(i.width,i.height))+1)?(i.mipmaps=r.mipmaps(!0),i.image=i.mipmaps[0].data):(i.mipmaps=null,i.image=r.mipmaps(!1)[0].data),new Yt(i)}});ci.addLoader(\"ktx\",ra);var ia=ra,aa=a.a.create({Mixes:s.a,isLoadQueue:!0,className:\"LoadQueue\",Statics:{addLoader:function(t,e){m.a.warn(\"LoadQueue.addLoader is duplicated, please use Loader.addLoader\"),ci.addLoader(t,e)}},constructor:function(t){this._source=[],this.add(t)},maxConnections:2,_source:null,_loaded:0,_connections:0,_currentIndex:-1,add:function(t){return t&&(t=Array.isArray(t)?t:[t],this._source=this._source.concat(t)),this},get:function(t){if(!t)return null;for(var e=this._source,n=0;n<e.length;n++){var r=e[n];if(r.id===t||r.src===t)return r}return null},getContent:function(t){var e=this.get(t);return e&&e.content},start:function(){return this._loader||(this._loader=new ci),this._loadNext(),this},_loadNext:function(){var t=this,e=this._source,n=e.length;if(this._loaded>=n)this.fire(\"complete\");else if(this._currentIndex<n-1&&this._connections<this.maxConnections){var r=++this._currentIndex,i=e[r];this._connections++,this._loader.load(i).then((function(e){t._onItemLoad(r,e)}),(function(e){t._onItemError(r,e)}))}},_onItemLoad:function(t,e){var n=this._source[t];n.loaded=!0,n.content=e,this._connections--,this._loaded++,this.fire(\"load\",n),this._loadNext()},_onItemError:function(t,e){var n=this._source[t];n.error=e,this._connections--,this._loaded++,this.fire(\"error\",n),this._loadNext()},getSize:function(t){for(var e=0,n=this._source,r=0;r<n.length;r++){var i=n[r];e+=(t?i.loaded&&i.size:i.size)||0}return e},getLoaded:function(){return this._loaded},getTotal:function(){return this._source.length},getAllContent:function(){return this._source.map((function(t){return t.content}))}}),sa=a.a.create({Extends:oi,isShaderMaterialLoader:!0,className:\"ShaderMaterialLoader\",constructor:function(){sa.superclass.constructor.call(this)},load:function(t){var e=[this.loadRes(t.fs),this.loadRes(t.vs)],n=Object.assign({},t);return Promise.all(e).then((function(t){return n.fs=t[0],n.vs=t[1],new Gn(n)}),(function(t){m.a.warn(\"ShaderMaterial Loader Failed for \".concat(t))}))}}),oa=sa,ua=a.a.create({Extends:oi,isTextureLoader:!0,className:\"TextureLoader\",constructor:function(){ua.superclass.constructor.call(this)},load:function(t){return this.loadImg(t.src,t.crossOrigin).then((function(e){var n=Object.assign({},t);return n.image=e,delete n.type,new Yt(n)})).catch((function(t){throw m.a.error(\"load Texture failed\",t.message,t.stack),t}))}});ci.addLoader(\"Texture\",ua);var ca=ua,ha=P.a.LINES,fa={x:[0,0,0,1,0,0],y:[0,0,0,0,1,0],z:[0,0,0,0,0,1]},la=a.a.create({Extends:g,isAxisHelper:!0,className:\"AxisHelper\",size:1,constructor:function(t){la.superclass.constructor.call(this,t),this.init()},addAxis:function(t){var e=new cr({name:\"AxisHelper_\"+t,geometry:new Z({mode:ha,vertices:new C(new Float32Array(fa[t]),3),indices:new C(new Uint16Array([0,1]),1)}),material:new Ze({diffuse:new v.a(fa[t][3],fa[t][4],fa[t][5]),lightType:\"NONE\"})});this.addChild(e)},init:function(){this.setScale(this.size),this.addAxis(\"x\"),this.addAxis(\"y\"),this.addAxis(\"z\")}}),da=la,ma=P.a.LINES,_a=a.a.create({Extends:cr,isAxisNetHelper:!0,className:\"AxisNetHelper\",size:5,constructor:function(t){_a.superclass.constructor.call(this,t),this.color=this.color||new v.a(.5,.5,.5);for(var e=new Z({mode:ma}),n=this.size,r=2*n+1,i=0;i<r;i++){var a=i/n-1;e.addLine([a,0,-1],[a,0,1]),e.addLine([-1,0,a],[1,0,a])}this.geometry=e,this.material=new Ze({diffuse:this.color,lightType:\"NONE\"})}}),pa=_a,ga=P.a.LINES,va=new c.a,Ea=a.a.create({Extends:cr,isCameraHelper:!0,className:\"CameraHelper\",camera:null,color:null,constructor:function(t){Ea.superclass.constructor.call(this,t),this.color||(this.color=new v.a(.3,.9,.6)),this.material=new Ze({lightType:\"NONE\",diffuse:this.color||new v.a(.5,.5,.5,1)}),this.geometry=new Z({mode:ga,isStatic:!1,vertices:new C(new Float32Array(27),3),indices:new C(new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7,8,4,8,5,8,6,8,7]),1)})},onUpdate:function(){this.camera&&(this.camera.updateViewProjectionMatrix(),this._buildGeometry())},_buildGeometry:function(){var t=this.camera,e=this.geometry;e.vertices.set(0,t.unprojectVector(va.set(-1,-1,1))),e.vertices.set(1,t.unprojectVector(va.set(-1,1,1))),e.vertices.set(2,t.unprojectVector(va.set(1,1,1))),e.vertices.set(3,t.unprojectVector(va.set(1,-1,1))),e.vertices.set(4,t.unprojectVector(va.set(-1,-1,-1))),e.vertices.set(5,t.unprojectVector(va.set(-1,1,-1))),e.vertices.set(6,t.unprojectVector(va.set(1,1,-1))),e.vertices.set(7,t.unprojectVector(va.set(1,-1,-1))),e.vertices.set(8,t.worldMatrix.getTranslation(va))}}),Ta=Ea,Ma=a.a.create({Extends:M,isAmbientLight:!0,className:\"AmbientLight\",autoUpdateWorldMatrix:!1,constructor:function(t){Ma.superclass.constructor.call(this,t)}}),Aa=Ma,La=a.a.create({Statics:{ltcTexture1:null,ltcTexture2:null,ltcTextureReady:!1,ltcTextureUrl:\"//g.alicdn.com/tmapp/static/4.0.63/ltcTexture.js\",loadLtcTexture:function(){var t=this;this.ltcTextureReady||void 0===this._loader&&(this._loader=new ci,this._loader.load({type:\"json\",src:this.ltcTextureUrl}).then((function(e){t._loader=null,t.ltcTexture1=new ve({data:e.ltcTexture1}),t.ltcTexture2=new ve({data:e.ltcTexture2}),t.ltcTextureReady=!0})))}},Extends:M,isAreaLight:!0,className:\"AreaLight\",width:10,height:10,_enabled:!0,enabled:{get:function(){return this._enabled&&La.ltcTextureReady},set:function(t){this._enabled=t}},constructor:function(t){La.superclass.constructor.call(this,t),La.loadLtcTexture()},ltcTexture1:{get:function(){return La.ltcTexture1},set:function(t){La.ltcTexture1=t}},ltcTexture2:{get:function(){return La.ltcTexture2},set:function(t){La.ltcTexture2=t}}}),Oa=La,Ia=new Ze({lightType:\"NONE\"}),Sa=new v.a(1,1,1),Ra=new v.a,ya=a.a.create({isMeshPicker:!0,className:\"MeshPicker\",debug:!1,renderer:null,colorMeshMap:null,constructor:function(t){Object.assign(this,t),this.colorMeshMap={},this.init()},createFramebuffer:function(){if(!this.framebuffer){var t=this.renderer;this.framebuffer=new ie(t,{useVao:t.useVao,width:t.width,height:t.height})}},renderDebug:function(){this.framebuffer.render(0,.7,.3,.3)},createMeshNumberId:function(t){\"numberId\"in t||(t.numberId=10*Number(t.id.replace(/^.*_(\\d+)$/,\"$1\")),t.color=Object(i.padLeft)(t.numberId.toString(16),6),this.colorMeshMap[t.color]=t)},renderColoredMeshes:function(){var t=this,e=this.renderer,n=this.framebuffer;n.bind(),e.clear(Sa);var r=e.forceMaterial;e.forceMaterial=Ia,e.renderList.traverse((function(n){t.createMeshNumberId(n),Ia.diffuse.fromHEX(n.color),Ia.isDirty=!0,e.renderMesh(n)})),e.forceMaterial=r,n.unbind()},getSelection:function(t,e){for(var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1,i=this.renderer.pixelRatio,a=[],s=this.framebuffer.readPixels(t*i,e*i,n*i,r*i),o=0;o<s.length;o+=4){var u=Ra.fromUintArray(s,o).toHEX();this.colorMeshMap[u]&&a.push(this.colorMeshMap[u])}return a},init:function(){var t=this;this.createFramebuffer(),this.renderer.on(\"afterRender\",(function(){t.renderColoredMeshes(),t.debug&&t.renderDebug()}))}}),xa=a.a.create({constructor:function(t){this._targetFPS=t||60,this._interval=1e3/this._targetFPS,this._tickers=[]},_paused:!1,_targetFPS:0,_interval:0,_intervalId:null,_tickers:null,_lastTime:0,_tickCount:0,_tickTime:0,_measuredFPS:0,start:function(t){if(void 0===t&&(t=!0),!this._intervalId){this._lastTime=+new Date;var e,n=this,r=this._interval,i=window.requestAnimationFrame;t&&i&&r<17?(this._useRAF=!0,e=function(){n._intervalId=i(e),n._tick()}):e=function(){n._intervalId=setTimeout(e,r),n._tick()},this._paused=!1,e()}},stop:function(){this._useRAF?(0,window.cancelAnimationFrame)(this._intervalId):clearTimeout(this._intervalId);this._intervalId=null,this._lastTime=0,this._paused=!0},pause:function(){this._paused=!0},resume:function(){this._paused=!1},_tick:function(){if(!this._paused){var t=+new Date,e=t-this._lastTime,n=this._tickers;++this._tickCount>=this._targetFPS?(this._measuredFPS=1e3/(this._tickTime/this._tickCount)+.5>>0,this._tickCount=0,this._tickTime=0):this._tickTime+=t-this._lastTime,this._lastTime=t;for(var r=n.slice(0),i=0,a=r.length;i<a;i++)r[i].tick(e)}},getMeasuredFPS:function(){return Math.min(this._measuredFPS,this._targetFPS)},addTick:function(t){if(!t||\"function\"!=typeof t.tick)throw new Error(\"Ticker: The tick object must implement the tick method.\");this._tickers.push(t)},removeTick:function(t){var e=this._tickers,n=e.indexOf(t);n>=0&&e.splice(n,1)},nextTick:function(t){var e=this,n={tick:function(){e.removeTick(n),t()}};return e.addTick(n),n},timeout:function(t,e){var n=this,r=(new Date).getTime()+e,i={tick:function(){(new Date).getTime()-r>=0&&(n.removeTick(i),t())}};return n.addTick(i),i},interval:function(t,e){var n=(new Date).getTime()+e,r={tick:function(){var r=(new Date).getTime(),i=r-n;i>=0&&(i<e&&(r-=i),n=r+e,t())}};return this.addTick(r),r}}),Na={get:function(){if(void 0===this._isWebGLSupport)try{var t=document.createElement(\"canvas\"),e=t.getContext(\"webgl\");e.clearColor(0,1,0,1),e.clear(e.COLOR_BUFFER_BIT);var n=new Uint8Array(4);e.readPixels(0,0,1,1,e.RGBA,e.UNSIGNED_BYTE,n),0===n[0]&&255===n[1]&&0===n[2]&&255===n[3]?this._isWebGLSupport=!0:this._isWebGLSupport=!1,t=null,e=null,n=null}catch(t){this._isWebGLSupport=!1}return this._isWebGLSupport}},ba=n(27)},,,function(t,e,n){n(104),t.exports=n(110)}]),\"undefined\"!=typeof window&&window.Hilo3d&&\"object\"==typeof exports&&\"object\"==typeof module&&(module.exports=window.Hilo3d);\n\n//# sourceURL=webpack:///./node_modules/_hilo3d@1.15.15@hilo3d/build/Hilo3d.js?");

/***/ }),

/***/ "./node_modules/_hilo3d@1.15.15@hilo3d/examples/js/OrbitControls.js":
/*!**************************************************************************!*\
  !*** ./node_modules/_hilo3d@1.15.15@hilo3d/examples/js/OrbitControls.js ***!
  \**************************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("(function () {\n    var PI2 = Math.PI / 2;\n    var tempEuler = new Hilo3d.Euler();\n    tempEuler.order = 'XYZ';\n    var tempQuat = new Hilo3d.Quaternion();\n    var tempMatrix = new Hilo3d.Matrix4();\n    var tempVector = new Hilo3d.Vector3();\n    var MOUSE = {\n        LEFT: 0,\n        MID: 1,\n        RIGHT: 2\n    };\n    var STATE = {\n        NONE: -1,\n        MOVE: 0,\n        ZOOM: 1,\n        PAN: 2\n    }\n\n    function OrbitControls(stage, opt) {\n        if (opt instanceof Hilo3d.Node) {\n            opt = {\n                model: opt\n            };\n        } else if (!opt) {\n            opt = {};\n        }\n        this.model = opt.model || stage;\n        this.stage = stage;\n        this.canvas = stage.canvas;\n        this.isLockZ = !!opt.isLockZ;\n        this.rotationXLimit = opt.rotationXLimit;\n        this.isLockScale = !!opt.isLockScale;\n        this.isLockRotate = !!opt.isLockRotate;\n        this.isLockMove = !!opt.isLockMove;\n        if (opt.eulerOrder) {\n            tempEuler.order = opt.eulerOrder;\n        }\n\n        if (this.isLockZ) {\n            tempEuler.x = this.model.rotationX * Math.PI / 180;\n            tempEuler.y = this.model.rotationY * Math.PI / 180;\n        }\n\n        this.mouseInfo = {\n            startX: 0,\n            startY: 0,\n            isDown: false\n        };\n\n        this.onWheel = this.onWheel.bind(this);\n        this.onMouseDown = this.onMouseDown.bind(this);\n        this.onMouseMove = this.onMouseMove.bind(this);\n        this.onMouseUp = this.onMouseUp.bind(this);\n\n        this.isEnabled = false;\n        this.enable();\n    }\n\n    OrbitControls.prototype.enable = function(){\n        if(!this.isEnabled){\n            this.isEnabled = true;\n            var canvas = this.canvas;\n            canvas.addEventListener('wheel', this.onWheel, false);\n\n            if ('ontouchmove' in window) {\n                canvas.addEventListener('touchstart', this.onMouseDown, false);\n                canvas.addEventListener('touchmove', this.onMouseMove, false);\n                canvas.addEventListener('touchend', this.onMouseUp, false);\n            } else {\n                document.addEventListener('contextmenu', function (evt) {\n                    //禁掉鼠标右键菜单\n                    evt.preventDefault()\n                });\n                canvas.addEventListener('mousedown', this.onMouseDown, false);\n                canvas.addEventListener('mousemove', this.onMouseMove, false);\n                canvas.addEventListener('mouseup', this.onMouseUp, false);\n            }\n        }\n    };\n\n    OrbitControls.prototype.disable = function(){\n        if(this.isEnabled){\n            this.isEnabled = false;\n            this.mouseInfo.isDown = false;\n            this.mouseInfo.state = STATE.NONE;\n\n            var canvas = this.canvas;\n            canvas.removeEventListener('wheel', this.onWheel, false);\n\n            if ('ontouchmove' in window) {\n                canvas.removeEventListener('touchstart', this.onMouseDown, false);\n                canvas.removeEventListener('touchmove', this.onMouseMove, false);\n                canvas.removeEventListener('touchend', this.onMouseUp, false);\n            } else {\n                document.removeEventListener('contextmenu', function (evt) {\n                    //禁掉鼠标右键菜单\n                    evt.preventDefault()\n                });\n                canvas.removeEventListener('mousedown', this.onMouseDown, false);\n                canvas.removeEventListener('mousemove', this.onMouseMove, false);\n                canvas.removeEventListener('mouseup', this.onMouseUp, false);\n            }\n        }\n    }\n\n    OrbitControls.prototype.rotate = function(distanceX, distanceY) {\n        if (this.isLockRotate) {\n            return;\n        }\n        var x = distanceY / 200;\n        var y = distanceX / 200;\n        if (this.isLockZ) {\n            tempEuler.x += x;\n            tempEuler.y += y;\n            if (this.rotationXLimit) {\n                if (tempEuler.x > this.rotationXLimit) {\n                    tempEuler.x = this.rotationXLimit;\n                } else if (tempEuler.x < -this.rotationXLimit) {\n                    tempEuler.x = -this.rotationXLimit;\n                }\n            }\n            this.model.quaternion.fromEuler(tempEuler);\n        } else {\n            tempEuler.set(x, y, 0);\n            tempQuat.fromEuler(tempEuler);\n            this.model.quaternion.premultiply(tempQuat);\n        }\n    };\n\n    OrbitControls.prototype.scale = function(s) {\n        if (this.isLockScale) {\n            return;\n        }\n        this.model.scaleX *= s;\n        this.model.scaleY *= s;\n        this.model.scaleZ *= s;\n\n        this.onScale && this.onScale(s);\n    };\n\n    OrbitControls.prototype.move = function(x, y) {\n        if(this.isLockMove){\n            return;\n        }\n        this.model.x += x;\n        this.model.y += y;\n    };\n\n    OrbitControls.prototype.onMouseDown = function (evt) {\n        this.mouseInfo.isDown = true;\n        if (evt.type === 'touchstart') {\n\n            this.mouseInfo.startX = evt.touches[0].pageX;\n            this.mouseInfo.startY = evt.touches[0].pageY;\n\n            switch (evt.touches.length) {\n                case 1:\n                    this.mouseInfo.state = STATE.MOVE;\n                    break;\n                case 2:\n                    var x = evt.touches[1].pageX - evt.touches[0].pageX;\n                    var y = evt.touches[1].pageY - evt.touches[0].pageY;\n                    this.mouseInfo.startPointerDistance = Math.sqrt(x * x + y * y);\n                    this.mouseInfo.state = STATE.ZOOM;\n                    break;\n                case 3:\n                    this.mouseInfo.state = STATE.PAN;\n                    break;\n            }\n        } else {\n            switch (evt.button) {\n                case MOUSE.LEFT:\n                    this.mouseInfo.startX = evt.pageX;\n                    this.mouseInfo.startY = evt.pageY;\n                    this.mouseInfo.state = STATE.MOVE;\n                    break;\n                case MOUSE.RIGHT:\n                    this.mouseInfo.startX = evt.pageX;\n                    this.mouseInfo.startY = evt.pageY;\n                    this.mouseInfo.state = STATE.PAN;\n                    break;\n            }\n        }\n    }\n\n    OrbitControls.prototype.onMouseMove = function (evt) {\n        if (!this.mouseInfo.isDown) {\n            return;\n        }\n        evt.preventDefault();\n        evt.stopPropagation();\n        var scope = this;\n        if (evt.type === 'touchmove') {\n            switch (this.mouseInfo.state) {\n                case STATE.MOVE:\n                    scope.handlerToucheMove(evt);\n                    break;\n                case STATE.ZOOM:\n                    scope.handlerToucheZoom(evt);\n                    break;\n                case STATE.PAN:\n                    scope.handlerTouchePan(evt);\n                    break;\n            }\n        } else {\n            switch (this.mouseInfo.state) {\n                case STATE.MOVE:\n                    scope.handlerMouseMove(evt);\n                    break;\n                case STATE.PAN:\n                    scope.handlerMousePan(evt);\n                    break;\n            }\n        }\n\n    }\n\n    OrbitControls.prototype.handlerMousePan = function (evt) {\n        var distanceX = evt.pageX - this.mouseInfo.startX;\n        var distanceY = evt.pageY - this.mouseInfo.startY;\n        this.mouseInfo.startX = evt.pageX;\n        this.mouseInfo.startY = evt.pageY;\n        this.model.worldMatrix.getScaling(tempVector);\n        this.move(distanceX * 2 * tempVector.x, distanceY * 2 * tempVector.y);\n    }\n\n    OrbitControls.prototype.handlerMouseMove = function (evt) {\n        var distanceX = evt.pageX - this.mouseInfo.startX;\n        var distanceY = evt.pageY - this.mouseInfo.startY;\n        this.mouseInfo.startX = evt.pageX;\n        this.mouseInfo.startY = evt.pageY;\n\n        this.rotate(distanceX, distanceY);\n    }\n\n    OrbitControls.prototype.handlerToucheZoom = function (evt) {\n        var x = evt.touches[1].pageX - evt.touches[0].pageX;\n        var y = evt.touches[1].pageY - evt.touches[0].pageY;\n        var pointerDistance = Math.sqrt(x * x + y * y);\n        var scale = 1\n        scale = pointerDistance / this.mouseInfo.startPointerDistance;\n        this.mouseInfo.startPointerDistance = pointerDistance;\n        if (scale != 1) {\n            this.scale(scale);\n        }\n    }\n\n    OrbitControls.prototype.handlerTouchePan = function (evt) {\n        evt = evt.touches[0];\n        var distanceX = evt.pageX - this.mouseInfo.startX;\n        var distanceY = evt.pageY - this.mouseInfo.startY;\n        this.mouseInfo.startX = evt.pageX;\n        this.mouseInfo.startY = evt.pageY;\n        this.move(distanceX * .01, -distanceY * .01);\n    }\n\n    OrbitControls.prototype.handlerToucheMove = function (evt) {\n        var model = this.model;\n        evt = evt.touches[0];\n        this.handlerMouseMove(evt);\n    }\n\n    OrbitControls.prototype.onMouseUp = function (evt) {\n        this.mouseInfo.isDown = false;\n        this.mouseInfo.state = STATE.NONE;\n    }\n\n    OrbitControls.prototype.onWheel = function (evt) {\n        evt.preventDefault();\n        var _deltaY = evt.deltaY;\n        if (_deltaY < -100) {\n            _deltaY = -90\n        } else if (_deltaY > 100) {\n            _deltaY = 90\n        }\n        var s = 1 + _deltaY * 0.001;\n        this.scale(1 / s);\n    }\n\n    OrbitControls.prototype.bindEvent = function () {\n        \n    }\n\n    if(true){\n        module.exports = OrbitControls;\n    }\n\n    if(typeof window !== 'undefined'){\n        window.OrbitControls = OrbitControls;\n    }\n})();\n\n//# sourceURL=webpack:///./node_modules/_hilo3d@1.15.15@hilo3d/examples/js/OrbitControls.js?");

/***/ }),

/***/ "./node_modules/_hilojs@2.0.2@hilojs/hilo-standalone.js":
/*!**************************************************************!*\
  !*** ./node_modules/_hilojs@2.0.2@hilojs/hilo-standalone.js ***!
  \**************************************************************/
/*! no static exports found */
/***/ (function(module, exports, __webpack_require__) {

eval("/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\n\n\n/**\n * @language=en\n * @class Browser feature set\n * @static\n * @module hilo/util/browser\n */\nvar browser = (function(){\n    var ua = navigator.userAgent;\n    var doc = document;\n    var win = window;\n    var docElem = doc.documentElement;\n\n    var data = /** @lends browser */ {\n        /**\n         * 是否是iphone\n         * @type {Boolean}\n         */\n        iphone: /iphone/i.test(ua),\n\n        /**\n         * 是否是ipad\n         * @type {Boolean}\n         */\n        ipad: /ipad/i.test(ua),\n\n        /**\n         * 是否是ipod\n         * @type {Boolean}\n         */\n        ipod: /ipod/i.test(ua),\n\n        /**\n         * 是否是ios\n         * @type {Boolean}\n         */\n        ios: /iphone|ipad|ipod/i.test(ua),\n\n        /**\n         * 是否是android\n         * @type {Boolean}\n         */\n        android: /android/i.test(ua),\n\n        /**\n         * 是否是webkit\n         * @type {Boolean}\n         */\n        webkit: /webkit/i.test(ua),\n\n        /**\n         * 是否是chrome\n         * @type {Boolean}\n         */\n        chrome: /chrome/i.test(ua),\n\n        /**\n         * 是否是safari\n         * @type {Boolean}\n         */\n        safari: /safari/i.test(ua),\n\n        /**\n         * 是否是firefox\n         * @type {Boolean}\n         */\n        firefox: /firefox/i.test(ua),\n\n        /**\n         * 是否是ie\n         * @type {Boolean}\n         */\n        ie: /msie/i.test(ua),\n\n        /**\n         * 是否是opera\n         * @type {Boolean}\n         */\n        opera: /opera/i.test(ua),\n        /**\n         * 是否支持触碰事件。\n         * @type {String}\n         */\n        supportTouch: 'ontouchstart' in win,\n\n        /**\n         * 是否支持canvas元素。\n         * @type {Boolean}\n         */\n        supportCanvas: doc.createElement('canvas').getContext != null,\n        /**\n         * 是否支持本地存储localStorage。\n         * @type {Boolean}\n         */\n        supportStorage: false,\n\n        /**\n         * 是否支持检测设备方向orientation。\n         * @type {Boolean}\n         */\n        supportOrientation: 'orientation' in win || 'orientation' in win.screen,\n\n        /**\n         * 是否支持检测加速度devicemotion。\n         * @type {Boolean}\n         */\n        supportDeviceMotion: 'ondevicemotion' in win\n    };\n\n    //`localStorage` is null or `localStorage.setItem` throws error in some cases (e.g. localStorage is disabled)\n    try{\n        var value = 'hilo';\n        localStorage.setItem(value, value);\n        localStorage.removeItem(value);\n        data.supportStorage = true;\n    }catch(e){}\n\n    /**\n     * 浏览器厂商CSS前缀的js值。比如：webkit。\n     * @type {String}\n     */\n    var jsVendor = data.jsVendor = data.webkit ? 'webkit' : data.firefox ? 'webkit' : data.opera ? 'o' : data.ie ? 'ms' : '';\n    /**\n     * 浏览器厂商CSS前缀的css值。比如：-webkit-。\n     * @type {String}\n     */\n    var cssVendor = data.cssVendor = '-' + jsVendor + '-';\n\n    //css transform/3d feature dectection\n    var testElem = doc.createElement('div'), style = testElem.style;\n    /**\n     * 是否支持CSS Transform变换。\n     * @type {Boolean}\n     */\n    var supportTransform = style[jsVendor + 'Transform'] != undefined;\n\n    /**\n     * 是否支持CSS Transform 3D变换。\n     * @type {Boolean}\n     */\n    var supportTransform3D = style[jsVendor + 'Perspective'] != undefined;\n    if(supportTransform3D){\n        testElem.id = 'test3d';\n        style = doc.createElement('style');\n        style.textContent = '@media ('+ cssVendor +'transform-3d){#test3d{height:3px}}';\n        doc.head.appendChild(style);\n\n        docElem.appendChild(testElem);\n        supportTransform3D = testElem.offsetHeight == 3;\n        doc.head.removeChild(style);\n        docElem.removeChild(testElem);\n    }\n    data.supportTransform = supportTransform;\n    data.supportTransform3D = supportTransform3D;\n\n    var supportTouch = data.supportTouch;\n    \n    /**\n     * 鼠标或触碰开始事件。对应touchstart或mousedown。\n     * @type {String}\n     */\n    var POINTER_START = supportTouch ? 'touchstart' : 'mousedown';\n\n    /**\n     * 鼠标或触碰移动事件。对应touchmove或mousemove。\n     * @type {String}\n     */\n    var POINTER_MOVE = supportTouch ? 'touchmove' : 'mousemove';\n\n    /**\n     * 鼠标或触碰结束事件。对应touchend或mouseup。\n     * @type {String}\n     */\n    var POINTER_END = supportTouch ? 'touchend' : 'mouseup';\n\n    data.POINTER_START = POINTER_START;\n    data.POINTER_MOVE = POINTER_MOVE;\n    data.POINTER_END = POINTER_END;\n    \n    return data;\n})();\nwindow.Hilo.browser = browser;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\n\n\n/**\n * @language=en\n * @class util method set\n * @static\n * @module hilo/util/util\n */\nvar util = {\n    /**\n     * @language=en\n     * Simple shallow copy objects.\n     * @param {Object} target Target object to copy to.\n     * @param {Object} source Source object to copy.\n     * @param {Boolean} strict Indicates whether replication is undefined property, default is false, i.e., undefined attributes are not copied.\n     * @returns {Object} Object after copying.\n     */\n    copy: function(target, source, strict){\n        for(var key in source){\n            if(!strict || target.hasOwnProperty(key) || target[key] !== undefined){\n                target[key] = source[key];\n            }\n        }\n        return target;\n    }\n};\nwindow.Hilo.util = util;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar browser = window.Hilo.browser;\nvar util = window.Hilo.util;\n\n\nvar win = window,\n    doc = document,\n    docElem = doc.documentElement,\n    uid = 0;\n\nvar hasWarnedDict = {};\n\n/**\n * @language=en\n * @namespace Hilo The underlying core set of methods.\n * @static\n * @module hilo/core/Hilo\n * @requires hilo/util/browser\n * @requires hilo/util/util\n */\nvar Hilo = {\n    /**\n     * Hilo version\n     * @type String\n     */\n    version: '2.0.2',\n    /**\n     * @language=en\n     * Gets a globally unique id. Such as Stage1, Bitmap2 etc.\n     * @param {String} prefix Generated id's prefix.\n     * @returns {String} Globally unique id.\n     */\n    getUid: function(prefix) {\n        var id = ++uid;\n        if (prefix) {\n            var charCode = prefix.charCodeAt(prefix.length - 1);\n            if (charCode >= 48 && charCode <= 57) prefix += \"_\"; //0至9之间添加下划线\n            return prefix + id;\n        }\n        return id;\n    },\n\n    /**\n     * @language=en\n     * Generates a string representation that contains a path to the specified visual object. Such as Stage1.Container2.Bitmap3.\n     * @param {View} view Specified visual object.\n     * @returns {String} String representation of the visual object.\n     */\n    viewToString: function(view) {\n        var result, obj = view;\n        while (obj) {\n            result = result ? (obj.id + '.' + result) : obj.id;\n            obj = obj.parent;\n        }\n        return result;\n    },\n\n    /**\n     * @language=en\n     * Simple shallow copy objects.\n     * @deprecated use Hilo.util.copy instead\n     * @param {Object} target Target object to copy to.\n     * @param {Object} source Source object to copy.\n     * @param {Boolean} strict Indicates whether replication is undefined property, default is false, i.e., undefined attributes are not copied.\n     * @returns {Object} Object after copying.\n     */\n    copy: function(target, source, strict) {\n        util.copy(target, source, strict);\n        if (!hasWarnedDict.copy) {\n            hasWarnedDict.copy = true;\n            console.warn('Hilo.copy has been Deprecated! Use Hilo.util.copy instead.');\n        }\n        return target;\n    },\n\n    /**\n     * @language=en\n     * Browser feature set includes:\n     * @see browser\n     */\n    browser: browser,\n\n    /**\n     * @language=en\n     * Event enumeration objects include:\n     * <ul>\n     * <li><b>POINTER_START</b> - Mouse or touch start event. Corresponds to touchstart or mousedown.</li>\n     * <li><b>POINTER_MOVE</b> - Mouse or touch move event. Corresponds to touchmove or mousemove.</li>\n     * <li><b>POINTER_END</b> - Mouse or touch end event. Corresponds to touchend or mouseup.</li>\n     * </ul>\n     */\n    event: {\n        POINTER_START: browser.POINTER_START,\n        POINTER_MOVE: browser.POINTER_MOVE,\n        POINTER_END: browser.POINTER_END\n    },\n\n    /**\n     * @language=en\n     * Visual object alinment enumeration objects include:\n     * <ul>\n     * <li><b>TOP_LEFT</b> - Align the top left corner.</li>\n     * <li><b>TOP</b> - Top center alignment.</li>\n     * <li><b>TOP_RIGHT</b> - Align the top right corner.</li>\n     * <li><b>LEFT</b> - Left center alignment.</li>\n     * <li><b>CENTER</b> - Align center.</li>\n     * <li><b>RIGHT</b> - Right center alignment.</li>\n     * <li><b>BOTTOM_LEFT</b> - Align the bottom left corner.</li>\n     * <li><b>BOTTOM</b> - Bottom center alignment.</li>\n     * <li><b>BOTTOM_RIGHT</b> - Align the bottom right corner.</li>\n     * </ul>\n     */\n    align: {\n        TOP_LEFT: 'TL', //top & left\n        TOP: 'T', //top & center\n        TOP_RIGHT: 'TR', //top & right\n        LEFT: 'L', //left & center\n        CENTER: 'C', //center\n        RIGHT: 'R', //right & center\n        BOTTOM_LEFT: 'BL', //bottom & left\n        BOTTOM: 'B', //bottom & center\n        BOTTOM_RIGHT: 'BR' //bottom & right\n    },\n\n    /**\n     * @language=en\n     * Get DOM element content in the page display area.\n     * @param {HTMLElement} elem DOM elements.\n     * @returns {Object} Viewable area DOM elements. Format is: {left:0, top:0, width:100, height:100}.\n     */\n    getElementRect: function(elem) {\n        var bounds;\n        try {\n            //this fails if it's a disconnected DOM node\n            bounds = elem.getBoundingClientRect();\n        } catch (e) {\n            bounds = {\n                top: elem.offsetTop,\n                left: elem.offsetLeft,\n                right: elem.offsetLeft + elem.offsetWidth,\n                bottom: elem.offsetTop + elem.offsetHeight\n            };\n        }\n\n        var offsetX = ((win.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0)) || 0;\n        var offsetY = ((win.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0)) || 0;\n        var styles = win.getComputedStyle ? getComputedStyle(elem) : elem.currentStyle;\n        var parseIntFn = parseInt;\n\n        var padLeft = (parseIntFn(styles.paddingLeft) + parseIntFn(styles.borderLeftWidth)) || 0;\n        var padTop = (parseIntFn(styles.paddingTop) + parseIntFn(styles.borderTopWidth)) || 0;\n        var padRight = (parseIntFn(styles.paddingRight) + parseIntFn(styles.borderRightWidth)) || 0;\n        var padBottom = (parseIntFn(styles.paddingBottom) + parseIntFn(styles.borderBottomWidth)) || 0;\n\n        var top = bounds.top || 0;\n        var left = bounds.left || 0;\n        var right = bounds.right || 0;\n        var bottom = bounds.bottom || 0;\n\n        return {\n            left: left + offsetX + padLeft,\n            top: top + offsetY + padTop,\n            width: right - padRight - left - padLeft,\n            height: bottom - padBottom - top - padTop\n        };\n    },\n\n    /**\n     * @language=en\n     * Create a DOM element. You can specify properties and styles.\n     * @param {String} type DOM element type to be created. Such as: 'div'.\n     * @param {Object} properties Properties and styles for DOM element.\n     * @returns {HTMLElement} A DOM element.\n     */\n    createElement: function(type, properties) {\n        var elem = doc.createElement(type),\n            p, val, s;\n        for (p in properties) {\n            val = properties[p];\n            if (p === 'style') {\n                for (s in val) elem.style[s] = val[s];\n            } else {\n                elem[p] = val;\n            }\n        }\n        return elem;\n    },\n\n    /**\n     * @language=en\n     * Gets a DOM element according to the parameter id. This method is equivalent to document.getElementById(id).\n     * @param {String} id id of the DOM element you want to get.\n     * @returns {HTMLElement} A DOM element.\n     */\n    getElement: function(id) {\n        return doc.getElementById(id);\n    },\n\n    /**\n     * @language=en\n     * Set visual object DOM element CSS style.\n     * @param {View} obj Specifies the CSS style to set the visual object.\n     * @private\n     */\n    setElementStyleByView: function(obj) {\n        var drawable = obj.drawable,\n            style = drawable.domElement.style,\n            stateCache = obj._stateCache || (obj._stateCache = {}),\n            prefix = Hilo.browser.jsVendor,\n            px = 'px',\n            flag = false;\n\n        if (this.cacheStateIfChanged(obj, ['visible'], stateCache)) {\n            style.display = !obj.visible ? 'none' : '';\n        }\n        if (this.cacheStateIfChanged(obj, ['alpha'], stateCache)) {\n            style.opacity = obj.alpha;\n        }\n        if (!obj.visible || obj.alpha <= 0) return;\n\n        if (this.cacheStateIfChanged(obj, ['width'], stateCache)) {\n            style.width = obj.width + px;\n        }\n        if (this.cacheStateIfChanged(obj, ['height'], stateCache)) {\n            style.height = obj.height + px;\n        }\n        if (this.cacheStateIfChanged(obj, ['depth'], stateCache)) {\n            style.zIndex = obj.depth + 1;\n        }\n        if (obj.transform){\n            var transform = obj.transform;\n            if (flag = this.cacheStateIfChanged(obj, ['pivotX', 'pivotY'], stateCache)) {\n                style[prefix + 'TransformOrigin'] = '0 0';\n            }\n            style[prefix + 'Transform'] = 'matrix3d(' + transform.a + ', '+ transform.b + ', 0, 0, '+ transform.c + ', '+ transform.d + ', 0, 0, 0, 0, 1, 0, '+ transform.tx + ', '+ transform.ty + ', 0, 1)';\n        }\n        else{\n            if (flag = this.cacheStateIfChanged(obj, ['pivotX', 'pivotY'], stateCache)) {\n                style[prefix + 'TransformOrigin'] = obj.pivotX + px + ' ' + obj.pivotY + px;\n            }\n\n            if (this.cacheStateIfChanged(obj, ['x', 'y', 'rotation', 'scaleX', 'scaleY'], stateCache) || flag) {\n                style[prefix + 'Transform'] = this.getTransformCSS(obj);\n            }\n        }\n        \n        if (this.cacheStateIfChanged(obj, ['background'], stateCache)) {\n            style.backgroundColor = obj.background;\n        }\n        if (!style.pointerEvents) {\n            style.pointerEvents = 'none';\n        }\n\n        //render image as background\n        var image = drawable.image;\n        if (image) {\n            var src = image.src;\n            if (src !== stateCache.image) {\n                stateCache.image = src;\n                style.backgroundImage = 'url(' + src + ')';\n            }\n\n            var rect = drawable.rect;\n            if (rect) {\n                var sx = rect[0],\n                    sy = rect[1];\n                if (sx !== stateCache.sx) {\n                    stateCache.sx = sx;\n                    style.backgroundPositionX = -sx + px;\n                }\n                if (sy !== stateCache.sy) {\n                    stateCache.sy = sy;\n                    style.backgroundPositionY = -sy + px;\n                }\n            }\n        }\n\n        //render mask\n        var mask = obj.mask;\n        if (mask) {\n            var maskImage = mask.drawable.domElement.style.backgroundImage;\n            if (maskImage !== stateCache.maskImage) {\n                stateCache.maskImage = maskImage;\n                style[prefix + 'MaskImage'] = maskImage;\n                style[prefix + 'MaskRepeat'] = 'no-repeat';\n            }\n\n            var maskX = mask.x,\n                maskY = mask.y;\n            if (maskX !== stateCache.maskX || maskY !== stateCache.maskY) {\n                stateCache.maskX = maskX;\n                stateCache.maskY = maskY;\n                style[prefix + 'MaskPosition'] = maskX + px + ' ' + maskY + px;\n            }\n        }\n    },\n\n    /**\n     * @private\n     */\n    cacheStateIfChanged: function(obj, propNames, stateCache) {\n        var i, len, name, value, changed = false;\n        for (i = 0, len = propNames.length; i < len; i++) {\n            name = propNames[i];\n            value = obj[name];\n            if (value != stateCache[name]) {\n                stateCache[name] = value;\n                changed = true;\n            }\n        }\n        return changed;\n    },\n\n    /**\n     * @language=en\n     * Generated visual object CSS style transformation.\n     * @param {View} obj Specifies visual object whose CSS style must be got.\n     * @returns {String} String representation of the CSS style.\n     */\n    getTransformCSS: function(obj) {\n        var use3d = this.browser.supportTransform3D,\n            str3d = use3d ? '3d' : '';\n\n        return 'translate' + str3d + '(' + (obj.x - obj.pivotX) + 'px, ' + (obj.y - obj.pivotY) + (use3d ? 'px, 0px)' : 'px)') +\n            'rotate' + str3d + (use3d ? '(0, 0, 1, ' : '(') + obj.rotation + 'deg)' +\n            'scale' + str3d + '(' + obj.scaleX + ', ' + obj.scaleY + (use3d ? ', 1)' : ')');\n    }\n};\nfor(var i in Hilo){window.Hilo[i] = Hilo[i];}\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\n\n\n/**\n * @language=en\n * Create Example Class:\n * <pre>\n * var Bird = Hilo.Class.create({\n *     Extends: Animal,\n *     Mixes: EventMixin,\n *     constructor: function(name){\n *         this.name = name;\n *     },\n *     fly: function(){\n *         console.log('I am flying');\n *     },\n *     Statics: {\n *         isBird: function(bird){\n *             return bird instanceof Bird;\n *         }\n *     }\n * });\n *\n * var swallow = new Bird('swallow');\n * swallow.fly();\n * Bird.isBird(swallow);\n * </pre>\n * @namespace Class Class is created to aid the developer.\n * @static\n * @module hilo/core/Class\n */\nvar Class = (function(){\n\n/**\n * @language=en\n * Create a class based on the parameters, properties and methods specified.\n * @param {Object} properties Properties and methods to create the class.\n * <ul>\n * <li><b>Extends</b> - Designed to inherit the parent class.</li>\n * <li><b>Mixes</b> - Specifies mixed member collection object.</li>\n * <li><b>Statics</b> - Static property or method specified class.</li>\n * <li><b>constructor</b> -  The constructor of specified class.</li>\n * <li>Other members of the property or method to create the class.</li>\n * </ul>\n * @returns {Object} Create classes.\n */\nvar create = function(properties){\n    properties = properties || {};\n    var clazz = properties.hasOwnProperty('constructor') ? properties.constructor : function(){};\n    implement.call(clazz, properties);\n    return clazz;\n};\n\n/**\n * @language=en\n * @private\n */\nvar implement = function(properties){\n    var proto = {}, key, value;\n    for(key in properties){\n        value = properties[key];\n        if(classMutators.hasOwnProperty(key)){\n            classMutators[key].call(this, value);\n        }else{\n            proto[key] = value;\n        }\n    }\n\n    mix(this.prototype, proto);\n};\n\nvar classMutators = /** @ignore */{\n    Extends: function(parent){\n        var existed = this.prototype, proto = createProto(parent.prototype);\n        //inherit static properites\n        mix(this, parent);\n        //keep existed properties\n        mix(proto, existed);\n        //correct constructor\n        proto.constructor = this;\n        //prototype chaining\n        this.prototype = proto;\n        //shortcut to parent's prototype\n        this.superclass = parent.prototype;\n    },\n\n    Mixes: function(items){\n        items instanceof Array || (items = [items]);\n        var proto = this.prototype, item;\n\n        while(item = items.shift()){\n            mix(proto, item.prototype || item);\n        }\n    },\n\n    Statics: function(properties){\n        mix(this, properties);\n    }\n};\n\n/**\n * @language=en\n * @private\n */\nvar createProto = (function(){\n    if(Object.__proto__){\n        return function(proto){\n            return {__proto__: proto};\n        };\n    }else{\n        var Ctor = function(){};\n        return function(proto){\n            Ctor.prototype = proto;\n            return new Ctor();\n        };\n    }\n})();\n\n/**\n * @language=en\n * Mixed property or method.\n * @param {Object} target Mixed audiences.\n * @param {Object} source The source whose methods and properties are to be mixed. It can support multiple source parameters.\n * @returns {Object} Mixed audiences.\n */\nvar mix = function(target){\n    for(var i = 1, len = arguments.length; i < len; i++){\n        var source  = arguments[i], defineProps;\n        for(var key in source){\n            var prop = source[key];\n            if(prop && typeof prop === 'object'){\n                if(prop.value !== undefined || typeof prop.get === 'function' || typeof prop.set === 'function'){\n                    defineProps = defineProps || {};\n                    defineProps[key] = prop;\n                    continue;\n                }\n            }\n            target[key] = prop;\n        }\n        if(defineProps) defineProperties(target, defineProps);\n    }\n\n    return target;\n};\n\nvar defineProperty, defineProperties;\ntry{\n    defineProperty = Object.defineProperty;\n    defineProperties = Object.defineProperties;\n    defineProperty({}, '$', {value:0});\n}catch(e){\n    if('__defineGetter__' in Object){\n        defineProperty = function(obj, prop, desc){\n            if('value' in desc) obj[prop] = desc.value;\n            if('get' in desc) obj.__defineGetter__(prop, desc.get);\n            if('set' in desc) obj.__defineSetter__(prop, desc.set);\n            return obj;\n        };\n        defineProperties = function(obj, props){\n            for(var prop in props){\n                if(props.hasOwnProperty(prop)){\n                    defineProperty(obj, prop, props[prop]);\n                }\n            }\n            return obj;\n        };\n    }\n}\n\nreturn {create:create, mix:mix};\n\n})();\n\nwindow.Hilo.Class = Class;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * @class Matrix class is a transforming matrix, which declare how points in one coordinate maped to another coordinate.\n * @param {Number} a The value affects pixel positioning alongside the x axis when Scale or rotate images.\n * @param {Number} b The value affects pixel positioning alongside the y axis when rotate or skew images.\n * @param {Number} c The value affects pixel positioning alongside the x axis when rotate or skew images.\n * @param {Number} d The value affects pixel positioning alongside the y axis when Scale or rotate images.\n * @param {Number} tx The distance to move every point alongside the x axis.\n * @param {Number} ty The distance to move every point alongside the y axis.\n * @module hilo/geom/Matrix\n * @requires hilo/core/Class\n */\nvar Matrix = Class.create(/** @lends Matrix.prototype */{\n    constructor: function(a, b, c, d, tx, ty){\n        this.a = a;\n        this.b = b;\n        this.c = c;\n        this.d = d;\n        this.tx = tx;\n        this.ty = ty;\n    },\n\n    /**\n     * set\n     * @param {Number} a \n     * @param {Number} b \n     * @param {Number} c \n     * @param {Number} d \n     * @param {Number} tx\n     * @param {Number} ty\n     */\n    set: function(a, b, c, d, tx, ty){\n        this.a = a;\n        this.b = b;\n        this.c = c;\n        this.d = d;\n        this.tx = tx;\n        this.ty = ty;\n\t\n\treturn this;\n    },\n\n    /**\n     * copy\n     * @param  {Matrix} mat\n     * @return {Matrix}  this\n     */\n    copy: function(mat){\n        this.a = mat.a;\n        this.b = mat.b;\n        this.c = mat.c;\n        this.d = mat.d;\n        this.tx = mat.tx;\n        this.ty = mat.ty;\n\n        return this;\n    },\n\n    /**\n     * clone\n     * @return {Matrix}\n     */\n    clone: function(){\n        return new Matrix().copy(this);\n    },\n\n    /**\n     * @language=en\n     * Link a Matrix to current Matrix, in order to make geometry effects on these two composed more effective.\n     * @param {Matrix} mtx Matrix that link to the source matrix.\n     * @returns {Matrix} A Matrix Object.\n     */\n    concat: function(mtx){\n        var args = arguments,\n            a = this.a, b = this.b, c = this.c, d = this.d,\n            tx = this.tx, ty = this.ty;\n\n        var ma, mb, mc, md, mx, my;\n        if(args.length >= 6){\n            ma = args[0];\n            mb = args[1];\n            mc = args[2];\n            md = args[3];\n            mx = args[4];\n            my = args[5];\n        }\n        else{\n            ma = mtx.a;\n            mb = mtx.b;\n            mc = mtx.c;\n            md = mtx.d;\n            mx = mtx.tx;\n            my = mtx.ty;\n        }\n\n        this.a = a * ma + b * mc;\n        this.b = a * mb + b * md;\n        this.c = c * ma + d * mc;\n        this.d = c * mb + d * md;\n        this.tx = tx * ma + ty * mc + mx;\n        this.ty = tx * mb + ty * md + my;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Rotate the Matrix Object.\n     * @param {Number} angle The angle to rotate.\n     * @returns {Matrix} A Matrix object.\n     */\n    rotate: function(angle){\n        var sin = Math.sin(angle), cos = Math.cos(angle),\n            a = this.a, b = this.b, c = this.c, d = this.d,\n            tx = this.tx, ty = this.ty;\n\n        this.a = a * cos - b * sin;\n        this.b = a * sin + b * cos;\n        this.c = c * cos - d * sin;\n        this.d = c * sin + d * cos;\n        this.tx = tx * cos - ty * sin;\n        this.ty = tx * sin + ty * cos;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Scale the Matrix.\n     * @param {Number} sx The value to multiply those object scale alongside the x axis.\n     * @param {Number} sy The value to multiply those object scale alongside the y axis.\n     * @returns {Matrix} A Matrix object.\n     */\n    scale: function(sx, sy){\n        this.a *= sx;\n        this.d *= sy;\n        this.c *= sx;\n        this.b *= sy;\n        this.tx *= sx;\n        this.ty *= sy;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Translate the Matrix alongside x axis and y axis by dx and dy.\n     * @param {Number} dx Translate Matrix alongside the x axis to the right (measured in px).\n     * @param {Number} dy Translate Matrix alongside the y axis to the right (measured in px).\n     * @returns {Matrix} A Matrix object.\n     */\n    translate: function(dx, dy){\n        this.tx += dx;\n        this.ty += dy;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set each Matrix property a value to trigger null transform. The Matrix after applying identity matrix transformation will be exactly the same as original.\n     * @returns {Matrix} A Matrix object.\n     */\n    identity: function(){\n        this.a = this.d = 1;\n        this.b = this.c = this.tx = this.ty = 0;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Apply an invert transformation of original Matrix. Using this invert transformation, you can reset a Matrix to a state before it had been apply some Matrix.\n     * @returns {Matrix} A Matrix object.\n     */\n    invert: function(){\n        var a = this.a;\n        var b = this.b;\n        var c = this.c;\n        var d = this.d;\n        var tx = this.tx;\n        var i = a * d - b * c;\n\n        this.a = d / i;\n        this.b = -b / i;\n        this.c = -c / i;\n        this.d = a / i;\n        this.tx = (c * this.ty - d * tx) / i;\n        this.ty = -(a * this.ty - b * tx) / i;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Return the result after apply a Matrix displaying transform on the point.\n     * @param {Object} point Point need to transform.\n     * @param {Boolean} round Whether ceil the coordinate values of the point.\n     * @param {Boolean} returnNew Whether return a new point.\n     * @returns {Object} 由应用矩阵转换所产生的点。\n     */\n    transformPoint: function(point, round, returnNew){\n        var x = point.x * this.a + point.y * this.c + this.tx,\n            y = point.x * this.b + point.y * this.d + this.ty;\n\n        if(round){\n            x = x + 0.5 >> 0;\n            y = y + 0.5 >> 0;\n        }\n        if(returnNew) return {x:x, y:y};\n        point.x = x;\n        point.y = y;\n        return point;\n    }\n\n});\n\nwindow.Hilo.Matrix = Matrix;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * @class EventMixin is a mixin on event related functions. Use Class.mix(target, EventMixin) to add event function onto target.\n * @static\n * @mixin\n * @module hilo/event/EventMixin\n * @requires hilo/core/Class\n */\nvar EventMixin = /** @lends EventMixin# */{\n    _listeners: null,\n\n    /**\n     * @language=en\n     * Add an event listenser.\n     * @param {String} type Event type to listen.\n     * @param {Function} listener Callback function of event listening.\n     * @param {Boolean} once Listen on event only once and no more response after the first response?\n     * @returns {Object} The Event itself. Functions chain call supported.\n     */\n    on: function(type, listener, once){\n        var listeners = (this._listeners = this._listeners || {});\n        var eventListeners = (listeners[type] = listeners[type] || []);\n        for(var i = 0, len = eventListeners.length; i < len; i++){\n            var el = eventListeners[i];\n            if(el.listener === listener) return;\n        }\n        eventListeners.push({listener:listener, once:once});\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Remove one event listener. Remove all event listeners if no parameter provided, and remove all event listeners on one type which is provided as the only parameter.\n     * @param {String} type The type of event listener that want to remove.\n     * @param {Function} listener Event listener callback function to be removed.\n     * @returns {Object} The Event itself. Functions chain call supported.\n     */\n    off: function(type, listener){\n        //remove all event listeners\n        if(arguments.length == 0){\n            this._listeners = null;\n            return this;\n        }\n\n        var eventListeners = this._listeners && this._listeners[type];\n        if(eventListeners){\n            //remove event listeners by specified type\n            if(arguments.length == 1){\n                delete this._listeners[type];\n                return this;\n            }\n\n            for(var i = 0, len = eventListeners.length; i < len; i++){\n                var el = eventListeners[i];\n                if(el.listener === listener){\n                    eventListeners.splice(i, 1);\n                    if(eventListeners.length === 0) delete this._listeners[type];\n                    break;\n                }\n            }\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Send events. If the first parameter is an Object, take it  as an Event Object.\n     * @param {String} type Event type to send.\n     * @param {Object} detail The detail (parameters go with the event) of Event to send.\n     * @returns {Boolean} Whether Event call successfully.\n     */\n    fire: function(type, detail){\n        var event, eventType;\n        if(typeof type === 'string'){\n            eventType = type;\n        }else{\n            event = type;\n            eventType = type.type;\n        }\n\n        var listeners = this._listeners;\n        if(!listeners) return false;\n\n        var eventListeners = listeners[eventType];\n        if(eventListeners){\n            var eventListenersCopy = eventListeners.slice(0);\n            event = event || new EventObject(eventType, this, detail);\n            if(event._stopped) return false;\n\n            for(var i = 0; i < eventListenersCopy.length; i++){\n                var el = eventListenersCopy[i];\n                el.listener.call(this, event);\n                if(el.once) {\n                    var index = eventListeners.indexOf(el);\n                    if(index > -1){\n                        eventListeners.splice(index, 1);\n                    }\n                }\n            }\n\n            if(eventListeners.length == 0) delete listeners[eventType];\n            return true;\n        }\n        return false;\n    }\n};\n\n/**\n * @language=en\n * Event Object class. It's an private class now, but maybe will become a public class if needed.\n */\nvar EventObject = Class.create({\n    constructor: function EventObject(type, target, detail){\n        this.type = type;\n        this.target = target;\n        this.detail = detail;\n        this.timeStamp = +new Date();\n    },\n\n    type: null,\n    target: null,\n    detail: null,\n    timeStamp: 0,\n\n    stopImmediatePropagation: function(){\n        this._stopped = true;\n    }\n});\n\n//Trick: `stopImmediatePropagation` compatibility\nvar RawEvent = window.Event;\nif(RawEvent){\n    var proto = RawEvent.prototype,\n        stop = proto.stopImmediatePropagation;\n    proto.stopImmediatePropagation = function(){\n        stop && stop.call(this);\n        this._stopped = true;\n    };\n}\n\nwindow.Hilo.EventMixin = EventMixin;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * @class Drawable is a wrapper of drawable images.\n * @param {Object} properties create Objects properties, contains all writable properties.\n * @module hilo/view/Drawable\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @property {Object} image Image to be drawed, can used by CanvasRenderingContext2D.drawImage，like HTMLImageElement、HTMLCanvasElement、HTMLVideoElement。\n * @property {array} rect The retangle area that image will be drawed.\n */\nvar Drawable = Class.create(/** @lends Drawable.prototype */{\n    constructor: function(properties){\n        this.init(properties);\n    },\n\n    image: null,\n    rect: null,\n\n    /**\n     * @language=en\n     * Initialize drawable elements.\n     * @param {Object} properties Properties need to be initialized.\n     */\n    init: function(properties){\n        var me = this, oldImage = me.image;\n        if(Drawable.isDrawable(properties)){\n            me.image = properties;\n        }else{\n            util.copy(me, properties, true);\n        }\n\n        var image = me.image;\n        if(typeof image === 'string'){\n            if(oldImage && image === oldImage.getAttribute('src')){\n                image = me.image = oldImage;\n            }else{\n                me.image = null;\n                //load image dynamically\n                var img = new Image();\n                if(properties.crossOrigin){\n                    img.crossOrigin = \"Anonymous\";\n                }\n                img.onload = function(){\n                    img.onload = null;\n                    me.init(img);\n                };\n                img.src = image;\n                return;\n            }\n        }\n\n        if(image && !me.rect) me.rect = [0, 0, image.width, image.height];\n    },\n\n    Statics: /** @lends Drawable */{\n        /**\n         * @language=en\n         * Check whether the given 'elem' and be wrapped into Drawable object.\n         * @param {Object} elem Element to be tested.\n         * @return {Boolean} Return true if element can be wrapped into Drawable element, otherwises return false.\n         */\n        isDrawable: function(elem){\n            if(!elem || !elem.tagName) return false;\n            var tagName = elem.tagName.toLowerCase();\n            return tagName === \"img\" || tagName === \"canvas\" || tagName === \"video\";\n        }\n    }\n});\nwindow.Hilo.Drawable = Drawable;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * @class Renderer Renderer is the base class of renderer.\n * @param {Object} properties The properties to create a renderer, contains all writeable props of this class.\n * @module hilo/renderer/Renderer\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @property {Object} canvas The canvas of renderer. It can be a dom element, such as a div element, or a canvas element. readonly.\n * @property {Object} stage The stage of renderer, readonly.\n * @property {String} renderType The render type of renderer, readonly.\n */\nvar Renderer = Class.create(/** @lends Renderer.prototype */{\n    constructor: function(properties){\n        properties = properties || {};\n        util.copy(this, properties, true);\n    },\n\n    renderType:null,\n    canvas: null,\n    stage: null,\n    blendMode:'source-over',\n\n    /**\n     * @language=en\n     * Prepare for draw visual object. The subclass need to implement it.\n     * @param {View} target The visual target to draw.\n     */\n    startDraw: function(target){ },\n\n    /**\n     * @language=en\n     * Draw the visual object. The subclass need to implement it.\n     * @param {View} target The visual target to draw.\n     */\n    draw: function(target){ },\n\n    /**\n     * @language=en\n     * The handling method after draw the visual object. The subclass need to implement it.\n     * @param {View} target The visual target to draw.\n     */\n    endDraw: function(target){ },\n\n    /**\n     * @language=en\n     * Transfrom the visual object. The subclass need to implement it.\n     */\n    transform: function(){ },\n\n    /**\n     * @language=en\n     * Hide the visual object. The subclass need to implement it.\n     */\n    hide: function(){ },\n\n    /**\n     * @language=en\n     * Remove the visual object from canvas. Notice that it dosen't remove the object from stage. The subclass need to implement it.\n     * @param {View} target The visual target to remove.\n     */\n    remove: function(target){ },\n\n    /**\n     * @language=en\n     * Clear the given region of canvas. The subclass need to implement it.\n     * @param {Number} x The position on the x axis of the given region.\n     * @param {Number} y The position on the y axis of the given region.\n     * @param {Number} width The width of the given region.\n     * @param {Number} height The height of the given region.\n     */\n    clear: function(x, y, width, height){ },\n\n    /**\n     * @language=en\n     * Resize the renderer's canvas.\n     * @param {Number} width The width of renderer's canvas.\n     * @param {Number} height The height of the renderer's canvas.\n     */\n    resize: function(width, height){ }\n\n});\nwindow.Hilo.Renderer = Renderer;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar Hilo = window.Hilo;var Renderer = window.Hilo.Renderer;\n\n\n/**\n * @language=en\n * @class CanvasRenderer CanvasRenderer, all the visual object is drawing on the canvas element.The stage will create different renderer depend on the canvas and renderType properties, developer need not use this class directly.\n * @augments Renderer\n * @param {Object} properties The properties to create a renderer, contains all writeable props of this class.\n * @module hilo/renderer/CanvasRenderer\n * @requires hilo/core/Class\n * @requires hilo/core/Hilo\n * @requires hilo/renderer/Renderer\n * @property {CanvasRenderingContext2D} context The context of the canvas element, readonly.\n */\nvar CanvasRenderer = Class.create( /** @lends CanvasRenderer.prototype */ {\n    Extends: Renderer,\n    constructor: function(properties) {\n        CanvasRenderer.superclass.constructor.call(this, properties);\n\n        this.context = this.canvas.getContext(\"2d\");\n    },\n    renderType: 'canvas',\n    context: null,\n\n    /**\n     * @private\n     * @see Renderer#startDraw\n     */\n    startDraw: function(target) {\n        if (target.visible && target.alpha > 0) {\n            if (target === this.stage) {\n                this.context.clearRect(0, 0, target.width, target.height);\n            }\n            if (target.blendMode !== this.blendMode) {\n                this.context.globalCompositeOperation = this.blendMode = target.blendMode;\n            }\n            this.context.save();\n            return true;\n        }\n        return false;\n    },\n\n    /**\n     * @private\n     * @see Renderer#draw\n     */\n    draw: function(target) {\n        var ctx = this.context,\n            w = target.width,\n            h = target.height;\n\n        //draw background\n        var bg = target.background;\n        if (bg) {\n            ctx.fillStyle = bg;\n            ctx.fillRect(0, 0, w, h);\n        }\n\n        //draw image\n        var drawable = target.drawable,\n            image = drawable && drawable.image;\n        if (image) {\n            var rect = drawable.rect,\n                sw = rect[2],\n                sh = rect[3],\n                offsetX = rect[4],\n                offsetY = rect[5];\n            //ie9+浏览器宽高为0时会报错 fixed ie9 bug.\n            if (!sw || !sh) {\n                return;\n            }\n            if (!w && !h) {\n                //fix width/height TODO: how to get rid of this?\n                w = target.width = sw;\n                h = target.height = sh;\n            }\n            //the pivot is the center of frame if has offset, otherwise is (0, 0)\n            if (offsetX || offsetY) ctx.translate(offsetX - sw * 0.5, offsetY - sh * 0.5);\n            ctx.drawImage(image, rect[0], rect[1], sw, sh, 0, 0, w, h);\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#endDraw\n     */\n    endDraw: function(target) {\n        this.context.restore();\n    },\n\n    /**\n     * @private\n     * @see Renderer#transform\n     */\n    transform: function(target) {\n        var drawable = target.drawable;\n        if (drawable && drawable.domElement) {\n            Hilo.setElementStyleByView(target);\n            return;\n        }\n\n        var ctx = this.context,\n            scaleX = target.scaleX,\n            scaleY = target.scaleY;\n\n        if (target === this.stage) {\n            var style = this.canvas.style,\n                oldScaleX = target._scaleX,\n                oldScaleY = target._scaleY,\n                isStyleChange = false;\n\n            if ((!oldScaleX && scaleX != 1) || (oldScaleX && oldScaleX != scaleX)) {\n                target._scaleX = scaleX;\n                style.width = scaleX * target.width + \"px\";\n                isStyleChange = true;\n            }\n            if ((!oldScaleY && scaleY != 1) || (oldScaleY && oldScaleY != scaleY)) {\n                target._scaleY = scaleY;\n                style.height = scaleY * target.height + \"px\";\n                isStyleChange = true;\n            }\n            if (isStyleChange) {\n                target.updateViewport();\n            }\n        } else {\n            var x = target.x,\n                y = target.y,\n                pivotX = target.pivotX,\n                pivotY = target.pivotY,\n                rotation = target.rotation % 360,\n                transform = target.transform,\n                mask = target.mask;\n\n            if (mask) {\n                mask._render(this);\n                ctx.clip();\n            }\n\n            //alignment\n            var align = target.align;\n            if (align) {\n                var pos = target.getAlignPosition();\n                x = pos.x;\n                y = pos.y;\n            }\n            \n            if (transform) {\n                ctx.transform(transform.a, transform.b, transform.c, transform.d, transform.tx, transform.ty);\n            } else {\n                if (x != 0 || y != 0) ctx.translate(x, y);\n                if (rotation != 0) ctx.rotate(rotation * Math.PI / 180);\n                if (scaleX != 1 || scaleY != 1) ctx.scale(scaleX, scaleY);\n                if (pivotX != 0 || pivotY != 0) ctx.translate(-pivotX, -pivotY);\n            }\n\n        }\n\n        if (target.alpha > 0) ctx.globalAlpha *= target.alpha;\n    },\n\n    /**\n     * @private\n     * @see Renderer#remove\n     */\n    remove: function(target) {\n        var drawable = target.drawable;\n        var elem = drawable && drawable.domElement;\n\n        if (elem) {\n            var parentElem = elem.parentNode;\n            if (parentElem) {\n                parentElem.removeChild(elem);\n            }\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#clear\n     */\n    clear: function(x, y, width, height) {\n        this.context.clearRect(x, y, width, height);\n    },\n\n    /**\n     * @private\n     * @see Renderer#resize\n     */\n    resize: function(width, height) {\n        var canvas = this.canvas;\n        var stage = this.stage;\n        var style = canvas.style;\n\n        canvas.width = width;\n        canvas.height = height;\n\n        style.width = stage.width * stage.scaleX + 'px';\n        style.height = stage.height * stage.scaleY + 'px';\n    }\n\n});\nwindow.Hilo.CanvasRenderer = CanvasRenderer;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar Hilo = window.Hilo;var Renderer = window.Hilo.Renderer;\nvar Drawable = window.Hilo.Drawable;\n\n\n/**\n * @language=en\n * @class DomRenderer The DomRenderer, all the visual object is drawing using dom element.The stage will create different renderer depend on the canvas and renderType properties, developer need not use this class directly.\n * @augments Renderer\n * @param {Object} properties The properties to create a renderer, contains all writeable props of this class.\n * @module hilo/renderer/DOMRenderer\n * @requires hilo/core/Class\n * @requires hilo/core/Hilo\n * @requires hilo/renderer/Renderer\n * @requires hilo/view/Drawable\n */\nvar DOMRenderer = (function(){\n\nreturn Class.create({\n    Extends: Renderer,\n    constructor: function(properties){\n        DOMRenderer.superclass.constructor.call(this, properties);\n    },\n    renderType:'dom',\n    /**\n     * @private\n     * @see Renderer#startDraw\n     */\n    startDraw: function(target){\n        //prepare drawable\n        var drawable = (target.drawable = target.drawable || new Drawable());\n        drawable.domElement = drawable.domElement || createDOMDrawable(target, drawable);\n        return true;\n    },\n\n    /**\n     * @private\n     * @see Renderer#draw\n     */\n    draw: function(target){\n        var parent = target.parent,\n            targetElem = target.drawable.domElement,\n            currentParent = targetElem.parentNode;\n\n        if(parent){\n            var parentElem = parent.drawable.domElement;\n            if(parentElem != currentParent){\n                parentElem.appendChild(targetElem);\n            }\n            //fix image load bug\n            if(!target.width && !target.height){\n                var rect = target.drawable.rect;\n                if(rect && (rect[2] || rect[3])){\n                    target.width = rect[2];\n                    target.height = rect[3];\n                }\n            }\n        }\n        else if(target === this.stage && !currentParent){\n            targetElem.style.overflow = 'hidden';\n            this.canvas.appendChild(targetElem);\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#transform\n     */\n    transform: function(target){\n        Hilo.setElementStyleByView(target);\n        if(target === this.stage){\n            var style = this.canvas.style,\n                oldScaleX = target._scaleX,\n                oldScaleY = target._scaleY,\n                scaleX = target.scaleX,\n                scaleY = target.scaleY;\n\n            if((!oldScaleX && scaleX != 1) || (oldScaleX && oldScaleX != scaleX)){\n                target._scaleX = scaleX;\n                style.width = scaleX * target.width + \"px\";\n            }\n            if((!oldScaleY && scaleY != 1) || (oldScaleY && oldScaleY != scaleY)){\n                target._scaleY = scaleY;\n                style.height = scaleY * target.height + \"px\";\n            }\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#remove\n     */\n    remove: function(target){\n        var drawable = target.drawable;\n        var elem = drawable && drawable.domElement;\n\n        if(elem){\n            var parentElem = elem.parentNode;\n            if(parentElem){\n                parentElem.removeChild(elem);\n            }\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#hide\n     */\n    hide: function(target){\n        var elem = target.drawable && target.drawable.domElement;\n        if(elem) elem.style.display = 'none';\n    },\n\n    /**\n     * @private\n     * @see Renderer#resize\n     */\n    resize: function(width, height){\n        var style = this.canvas.style;\n        style.width = width + 'px';\n        style.height = height + 'px';\n        if(style.position != \"absolute\") {\n          style.position = \"relative\";\n        }\n    }\n});\n\n/**\n * @language=en\n * Create a dom element, you can set the tagName property，such as canvas and div.\n * @param {Object} view A visual object.\n * @param {Object} imageObj The image object to render, include the image propertiy and other associated properties, such as rect.\n * @return {HTMLElement} The created dom element.\n * @private\n */\nfunction createDOMDrawable(view, imageObj){\n    var tag = view.tagName || \"div\",\n        img = imageObj.image,\n        w = view.width || (img && img.width),\n        h =  view.height || (img && img.height),\n        elem = Hilo.createElement(tag), style = elem.style;\n\n    if(view.id) elem.id = view.id;\n    style.position = \"absolute\";\n    style.left = (view.left || 0) + \"px\";\n    style.top = (view.top || 0) + \"px\";\n    style.width = w + \"px\";\n    style.height = h + \"px\";\n\n    if(tag == \"canvas\"){\n        elem.width = w;\n        elem.height = h;\n        if(img){\n            var ctx = elem.getContext(\"2d\");\n            var rect = imageObj.rect || [0, 0, w, h];\n            ctx.drawImage(img, rect[0], rect[1], rect[2], rect[3],\n                         (view.x || 0), (view.y || 0),\n                         (view.width || rect[2]),\n                         (view.height || rect[3]));\n        }\n    }else{\n        style.opacity = view.alpha != undefined ? view.alpha : 1;\n        if(view === this.stage || view.clipChildren) style.overflow = \"hidden\";\n        if(img && img.src){\n            style.backgroundImage = \"url(\" + img.src + \")\";\n            var bgX = view.rectX || 0, bgY = view.rectY || 0;\n            style.backgroundPosition = (-bgX) + \"px \" + (-bgY) + \"px\";\n        }\n    }\n    return elem;\n}\n\n})();\n\nwindow.Hilo.DOMRenderer = DOMRenderer;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar Hilo = window.Hilo;var Renderer = window.Hilo.Renderer;\nvar Matrix = window.Hilo.Matrix;\n\n\n/**\n * Heavily inspired by PIXI's SpriteRenderer:\n * https://github.com/pixijs/pixi.js/blob/v3.0.9/src/core/sprites/webgl/SpriteRenderer.js\n */\n\nvar DEG2RAD = Math.PI / 180;\n/**\n * @language=en\n * @class WebGLRenderer The WebGLRenderer, all the visual object is drawing on the canvas using WebGL.The stage will create different renderer depend on the canvas and renderType properties, developer need not use this class directly.\n * @augments Renderer\n * @param {Object} properties The properties to create a renderer, contains all writeable props of this class.\n * @module hilo/renderer/WebGLRenderer\n * @requires hilo/core/Class\n * @requires hilo/core/Hilo\n * @requires hilo/renderer/Renderer\n * @requires  hilo/geom/Matrix\n * @property {WebGLRenderingContext} gl The WebGL context of the renderer, readonly.\n */\nvar WebGLRenderer = Class.create(/** @lends WebGLRenderer.prototype */{\n    Extends: Renderer,\n    Statics:/** @lends WebGLRenderer */{\n        /**\n         * @language=en\n         * The max num of batch draw, default is 2000.\n         * @type {Number}\n         */\n        MAX_BATCH_NUM:2000,\n        /**\n         * @language=en\n         * The num of vertex attributes, readonly.\n         * @type {Number}\n         */\n        ATTRIBUTE_NUM:5,\n        /**\n         * @language=en\n         * is WebGL supported, readonly.\n         * @type {Boolean}\n         */\n        isSupport:function(){\n            if(this._isSupported == undefined){\n                var canvas = document.createElement('canvas');\n                if(canvas.getContext && (canvas.getContext('webgl')||canvas.getContext('experimental-webgl'))){\n                    this._isSupported = true;\n                }\n                else{\n                    this._isSupported = false;\n                }\n            }\n            return this._isSupported;\n        },\n        /**\n         * WebGL context Options\n         * @see  https://developer.mozilla.org/en-US/docs/Web/API/WebGLRenderingContext/getContextAttributes\n         * @type {Object}\n         */\n        contextOptions: null\n    },\n    renderType:'webgl',\n    gl:null,\n    _isContextLost:false,\n    _cacheTexture:{},\n    constructor: function(properties){\n        WebGLRenderer.superclass.constructor.call(this, properties);\n        var that = this;\n        var contextOptions = WebGLRenderer.contextOptions || {};\n        this.gl = this.canvas.getContext(\"webgl\", contextOptions)||this.canvas.getContext('experimental-webgl', contextOptions);\n\n        this.maxBatchNum = WebGLRenderer.MAX_BATCH_NUM;\n        this.positionStride = WebGLRenderer.ATTRIBUTE_NUM * 4;\n        var vertexNum = this.maxBatchNum * WebGLRenderer.ATTRIBUTE_NUM * 4;\n        var indexNum = this.maxBatchNum * 6;\n        this.arrayBuffer = new ArrayBuffer(vertexNum * 4);\n        this.float32Array = new Float32Array(this.arrayBuffer);\n        this.uint32Array = new Uint32Array(this.arrayBuffer);\n        this.indexs = new Uint16Array(indexNum);\n        for (var i=0, j=0; i < indexNum; i += 6, j += 4)\n        {\n            this.indexs[i + 0] = j + 0;\n            this.indexs[i + 1] = j + 1;\n            this.indexs[i + 2] = j + 2;\n            this.indexs[i + 3] = j + 1;\n            this.indexs[i + 4] = j + 2;\n            this.indexs[i + 5] = j + 3;\n        }\n        this.batchIndex = 0;\n        this.sprites = [];\n\n        this.canvas.addEventListener('webglcontextlost', function(e){\n            that._isContextLost = true;\n            e.preventDefault();\n        }, false);\n\n        this.canvas.addEventListener('webglcontextrestored', function(e){\n            that._isContextLost = false;\n            that.setupWebGLStateAndResource();\n        }, false);\n\n        this.setupWebGLStateAndResource();\n    },\n    setupWebGLStateAndResource:function(){\n        var gl = this.gl;\n        gl.blendFunc(gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n        gl.clearColor(0, 0, 0, 0);\n        gl.disable(gl.DEPTH_TEST);\n        gl.disable(gl.CULL_FACE);\n        gl.enable(gl.BLEND);\n\n        this._cacheTexture = {};\n        this._initShaders();\n        this.defaultShader.active();\n\n        this.positionBuffer = gl.createBuffer();\n        this.indexBuffer = gl.createBuffer();\n\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, this.indexs, gl.STATIC_DRAW);\n\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.positionBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, this.arrayBuffer, gl.DYNAMIC_DRAW);\n\n        gl.vertexAttribPointer(this.a_position, 2, gl.FLOAT, false, this.positionStride, 0);//x, y\n        gl.vertexAttribPointer(this.a_TexCoord, 2, gl.FLOAT, false, this.positionStride, 2 * 4);//x, y\n        gl.vertexAttribPointer(this.a_tint, 4, gl.UNSIGNED_BYTE, true, this.positionStride, 4 * 4);//alpha\n    },\n\n    context: null,\n\n    /**\n     * @private\n     * @see Renderer#startDraw\n     */\n    startDraw: function(target){\n        if(target.visible && target.alpha > 0){\n            if(target === this.stage){\n                this.clear();\n            }\n            return true;\n        }\n        return false;\n    },\n    /**\n     * @private\n     * @see Renderer#draw\n     */\n    draw: function(target){\n        var w = target.width,\n            h = target.height;\n\n        //TODO:draw background\n        var bg = target.background; // jshint ignore:line\n\n        //draw image\n        var drawable = target.drawable, image = drawable && drawable.image;\n        if(image){\n            var rect = drawable.rect, sw = rect[2], sh = rect[3];\n            if(!w && !h){\n                //fix width/height TODO: how to get rid of this?\n                w = target.width = sw;\n                h = target.height = sh;\n            }\n\n            if(this.batchIndex >= this.maxBatchNum){\n                this._renderBatches();\n            }\n\n            var vertexs = this._createVertexs(image, rect[0], rect[1], sw, sh, 0, 0, w, h);\n            var index = this.batchIndex * this.positionStride;\n            var float32Array = this.float32Array;\n            var uint32Array = this.uint32Array;\n\n            var tint = (target.tint >> 16) + (target.tint & 0xff00) + ((target.tint & 0xff) << 16) + (target.__webglRenderAlpha * 255 << 24);\n\n            float32Array[index + 0] = vertexs[0];//x\n            float32Array[index + 1] = vertexs[1];//y\n            float32Array[index + 2] = vertexs[2];//uvx\n            float32Array[index + 3] = vertexs[3];//uvy\n            uint32Array[index + 4] = tint;//tint\n\n            float32Array[index + 5] = vertexs[4];\n            float32Array[index + 6] = vertexs[5];\n            float32Array[index + 7] = vertexs[6];\n            float32Array[index + 8] = vertexs[7];\n            uint32Array[index + 9] = tint;\n\n            float32Array[index + 10] = vertexs[8];\n            float32Array[index + 11] = vertexs[9];\n            float32Array[index + 12] = vertexs[10];\n            float32Array[index + 13] = vertexs[11];\n            uint32Array[index + 14] = tint;\n\n            float32Array[index + 15] = vertexs[12];\n            float32Array[index + 16] = vertexs[13];\n            float32Array[index + 17] = vertexs[14];\n            float32Array[index + 18] = vertexs[15];\n            uint32Array[index + 19] = tint;\n\n            var matrix = target.__webglWorldMatrix;\n            for(var i = 0;i < 4;i ++){\n                var x = float32Array[index + i*5];\n                var y = float32Array[index + i*5 + 1];\n\n                float32Array[index + i*5] = matrix.a*x + matrix.c*y + matrix.tx;\n                float32Array[index + i*5 + 1] = matrix.b*x + matrix.d*y + matrix.ty;\n            }\n\n            target.__textureImage = image;\n            this.sprites[this.batchIndex++] = target;\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#endDraw\n     */\n    endDraw: function(target){\n        if(target === this.stage){\n            this._renderBatches();\n        }\n    },\n    /**\n     * @private\n     * @see Renderer#transform\n     */\n    transform: function(target){\n        var drawable = target.drawable;\n        if(drawable && drawable.domElement){\n            Hilo.setElementStyleByView(target);\n            return;\n        }\n\n        var scaleX = target.scaleX,\n            scaleY = target.scaleY;\n\n        if(target === this.stage){\n            var style = this.canvas.style,\n                oldScaleX = target._scaleX,\n                oldScaleY = target._scaleY,\n                isStyleChange = false;\n\n            if((!oldScaleX && scaleX != 1) || (oldScaleX && oldScaleX != scaleX)){\n                target._scaleX = scaleX;\n                style.width = scaleX * target.width + \"px\";\n                isStyleChange = true;\n            }\n            if((!oldScaleY && scaleY != 1) || (oldScaleY && oldScaleY != scaleY)){\n                target._scaleY = scaleY;\n                style.height = scaleY * target.height + \"px\";\n                isStyleChange = true;\n            }\n            if(isStyleChange){\n                target.updateViewport();\n            }\n            target.__webglWorldMatrix = target.__webglWorldMatrix||new Matrix(1, 0, 0, 1, 0, 0);\n        }\n        else if(target.parent){\n            target.__webglWorldMatrix = target.__webglWorldMatrix||new Matrix(1, 0, 0, 1, 0, 0);\n            this._setConcatenatedMatrix(target, target.parent);\n        }\n\n        if(target.alpha > 0) {\n            if(target.parent && target.parent.__webglRenderAlpha){\n                target.__webglRenderAlpha = target.alpha * target.parent.__webglRenderAlpha;\n            }\n            else{\n                target.__webglRenderAlpha = target.alpha;\n            }\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#remove\n     */\n    remove: function(target){\n        var drawable = target.drawable;\n        var elem = drawable && drawable.domElement;\n\n        if(elem){\n            var parentElem = elem.parentNode;\n            if(parentElem){\n                parentElem.removeChild(elem);\n            }\n        }\n    },\n\n    /**\n     * @private\n     * @see Renderer#clear\n     */\n    clear: function(x, y, width, height){\n        this.gl.clear(this.gl.COLOR_BUFFER_BIT);\n    },\n\n    /**\n     * @private\n     * @see Renderer#resize\n     */\n    resize: function(width, height){\n        if(this.width !== width || this.height !== height){\n            var canvas = this.canvas;\n            var stage = this.stage;\n            var style = canvas.style;\n\n            this.width = canvas.width = width;\n            this.height = canvas.height = height;\n\n            style.width = stage.width * stage.scaleX + 'px';\n            style.height = stage.height * stage.scaleY + 'px';\n\n            this.gl.viewport(0, 0, width, height);\n\n            this.canvasHalfWidth = width * .5;\n            this.canvasHalfHeight = height * .5;\n\n            this._uploadProjectionTransform(true);\n        }\n    },\n    _renderBatches:function(){\n        var gl = this.gl;\n        gl.bufferSubData(gl.ARRAY_BUFFER, 0, this.uint32Array.subarray(0, this.batchIndex * this.positionStride));\n        var startIndex = 0;\n        var batchNum = 0;\n        var preTextureImage = null;\n        for(var i = 0;i < this.batchIndex;i ++){\n            var sprite = this.sprites[i];\n            if(preTextureImage && preTextureImage !== sprite.__textureImage){\n                this._renderBatch(startIndex, i);\n                startIndex = i;\n                batchNum = 1;\n            }\n            preTextureImage = sprite.__textureImage;\n        }\n        this._renderBatch(startIndex, this.batchIndex);\n        this.batchIndex = 0;\n    },\n    _renderBatch:function(start, end){\n        var gl = this.gl;\n        var num = end - start;\n        if(num > 0){\n            gl.bindTexture(gl.TEXTURE_2D, this._getTexture(this.sprites[start]));\n            gl.drawElements(gl.TRIANGLES, num * 6, gl.UNSIGNED_SHORT, start * 6 * 2);\n        }\n    },\n    _uploadProjectionTransform:function(force){\n        if(!this._projectionTransformElements||force){\n            this._projectionTransformElements = new Float32Array([\n                1/this.canvasHalfWidth, 0, 0,\n                0, -1/this.canvasHalfHeight, 0,\n                -1, 1, 1,\n            ]);\n        }\n\n        this.gl.uniformMatrix3fv(this.u_projectionTransform, false, this._projectionTransformElements);\n    },\n    _initShaders:function(){\n        var VSHADER_SOURCE ='\\\n            attribute vec2 a_position;\\n\\\n            attribute vec2 a_TexCoord;\\n\\\n            attribute vec4 a_tint;\\n\\\n            uniform mat3 u_projectionTransform;\\n\\\n            varying vec2 v_TexCoord;\\n\\\n            varying vec4 v_tint;\\n\\\n            void main(){\\n\\\n                gl_Position =  vec4((u_projectionTransform * vec3(a_position, 1.0)).xy, 1.0, 1.0);\\n\\\n                v_TexCoord = a_TexCoord;\\n\\\n                v_tint = vec4(a_tint.rgb * a_tint.a, a_tint.a);\\n\\\n            }\\n\\\n        ';\n\n        var FSHADER_SOURCE = '\\n\\\n            precision mediump float;\\n\\\n            uniform sampler2D u_Sampler;\\n\\\n            varying vec2 v_TexCoord;\\n\\\n            varying vec4 v_tint;\\n\\\n            void main(){\\n\\\n                gl_FragColor = texture2D(u_Sampler, v_TexCoord) * v_tint;\\n\\\n            }\\n\\\n        ';\n\n        this.defaultShader = new Shader(this, {\n            v:VSHADER_SOURCE,\n            f:FSHADER_SOURCE\n        },{\n            attributes:[\"a_position\", \"a_TexCoord\", \"a_tint\"],\n            uniforms:[\"u_projectionTransform\", \"u_Sampler\"]\n        });\n    },\n    _createVertexs:function(img, tx, ty, tw, th, x, y, w, h){\n        var tempVertexs = this.__tempVertexs||[];\n        var width = img.width;\n        var height = img.height;\n\n        tw = tw/width;\n        th = th/height;\n        tx = tx/width;\n        ty = ty/height;\n\n        w = w;\n        h = h;\n        x = x;\n        y = y;\n\n        if(tw + tx > 1){\n            tw = 1 - tx;\n        }\n\n        if(th + ty > 1){\n            th = 1 - ty;\n        }\n\n        var index = 0;\n        tempVertexs[index++] = x; tempVertexs[index++] = y; tempVertexs[index++] = tx; tempVertexs[index++] = ty;\n        tempVertexs[index++] = x+w;tempVertexs[index++] = y; tempVertexs[index++] = tx+tw; tempVertexs[index++] = ty;\n        tempVertexs[index++] = x; tempVertexs[index++] = y+h; tempVertexs[index++] = tx;tempVertexs[index++] = ty+th;\n        tempVertexs[index++] = x+w;tempVertexs[index++] = y+h;tempVertexs[index++] = tx+tw;tempVertexs[index++] = ty+th;\n\n        return tempVertexs;\n    },\n    _setConcatenatedMatrix:function(view, ancestor){\n        var mtx = view.__webglWorldMatrix;\n        var cos = 1, sin = 0,\n            rotation = view.rotation % 360,\n            pivotX = view.pivotX, pivotY = view.pivotY,\n            scaleX = view.scaleX, scaleY = view.scaleY,\n            transform = view.transform;\n\n        if (transform) {\n            mtx.copy(transform);\n        }\n        else {\n            if(rotation){\n                var r = rotation * DEG2RAD;\n                cos = Math.cos(r);\n                sin = Math.sin(r);\n            }\n\n            var pos = view.getAlignPosition();\n\n            mtx.a = cos*scaleX;\n            mtx.b = sin*scaleX;\n            mtx.c = -sin*scaleY;\n            mtx.d = cos*scaleY;\n            mtx.tx =  pos.x - mtx.a * pivotX - mtx.c * pivotY;\n            mtx.ty =  pos.y - mtx.b * pivotX - mtx.d * pivotY;\n        }\n\n        mtx.concat(ancestor.__webglWorldMatrix);\n    },\n    _getTexture:function(sprite){\n        var image = sprite.__textureImage;\n        var texture = this._cacheTexture[image.src];\n        if(!texture){\n            texture = this.activeShader.uploadTexture(image);\n        }\n        return texture;\n    }\n});\n\n/**\n * @language=en\n * shader\n * @param {WebGLRenderer} renderer [description]\n * @param {Object} source\n * @param {String} source.v 顶点shader\n * @param {String} source.f 片段shader\n * @param {Object} attr\n * @param {Array} attr.attributes attribute数组\n * @param {Array} attr.uniforms uniform数组\n */\nvar Shader = function(renderer, source, attr){\n    this.renderer = renderer;\n    this.gl = renderer.gl;\n    this.program = this._createProgram(this.gl, source.v, source.f);\n\n    attr = attr||{};\n    this.attributes = attr.attributes||[];\n    this.uniforms = attr.uniforms||[];\n};\n\nShader.prototype = {\n    active:function(){\n        var that = this;\n        var renderer = that.renderer;\n        var gl = that.gl;\n        var program = that.program;\n\n        if(program && gl){\n            renderer.activeShader = that;\n            gl.useProgram(program);\n            that.attributes.forEach(function(attribute){\n                renderer[attribute] = gl.getAttribLocation(program, attribute);\n                gl.enableVertexAttribArray(renderer[attribute]);\n            });\n\n            that.uniforms.forEach(function(uniform){\n                renderer[uniform] = gl.getUniformLocation(program, uniform);\n            });\n\n            if(that.width !== renderer.width || that.height !== renderer.height){\n                that.width = renderer.width;\n                that.height = renderer.height;\n                renderer._uploadProjectionTransform();\n            }\n        }\n    },\n    uploadTexture:function(image){\n        var gl = this.gl;\n        var renderer = this.renderer;\n        var texture = gl.createTexture();\n        var u_Sampler = renderer.u_Sampler;\n\n        gl.activeTexture(gl.TEXTURE0);\n        gl.bindTexture(gl.TEXTURE_2D, texture);\n\n        // gl.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, 1);\n        gl.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, 1);\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, image);\n\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n        gl.uniform1i(u_Sampler, 0);\n        gl.bindTexture(gl.TEXTURE_2D, null);\n\n        this.renderer._cacheTexture[image.src] = texture;\n        return texture;\n    },\n    _createProgram:function(gl, vshader, fshader){\n        var vertexShader = this._createShader(gl, gl.VERTEX_SHADER, vshader);\n        var fragmentShader = this._createShader(gl, gl.FRAGMENT_SHADER, fshader);\n        if (!vertexShader || !fragmentShader) {\n            return null;\n        }\n\n        var program = gl.createProgram();\n        if (program) {\n            gl.attachShader(program, vertexShader);\n            gl.attachShader(program, fragmentShader);\n\n            gl.linkProgram(program);\n\n            gl.deleteShader(fragmentShader);\n            gl.deleteShader(vertexShader);\n            var linked = gl.getProgramParameter(program, gl.LINK_STATUS);\n            if (!linked) {\n                var error = gl.getProgramInfoLog(program);\n                console.log('Failed to link program: ' + error);\n                gl.deleteProgram(program);\n                return null;\n            }\n        }\n        return program;\n    },\n    _createShader:function(gl, type, source){\n        var shader = gl.createShader(type);\n        if(shader){\n            gl.shaderSource(shader, source);\n            gl.compileShader(shader);\n\n            var compiled = gl.getShaderParameter(shader, gl.COMPILE_STATUS);\n            if (!compiled) {\n                var error = gl.getShaderInfoLog(shader);\n                console.log('Failed to compile shader: ' + error);\n                gl.deleteShader(shader);\n                return null;\n            }\n        }\n        return shader;\n    }\n};\nwindow.Hilo.WebGLRenderer = WebGLRenderer;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar EventMixin = window.Hilo.EventMixin;\nvar Matrix = window.Hilo.Matrix;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * @class View View is the base class of all display objects\n * @mixes EventMixin\n * @borrows EventMixin#on as #on\n * @borrows EventMixin#off as #off\n * @borrows EventMixin#fire as #fire\n * @param {Object} properties The properties to create a view object, contains all writeable props of this class\n * @module hilo/view/View\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/event/EventMixin\n * @requires hilo/geom/Matrix\n * @requires hilo/util/util\n * @property {String} id The identifier for the view.\n * @property {Number} x The position of the view on the x axis relative to the local coordinates of the parent, default value is 0.\n * @property {Number} y The position of the view on the y axis relative to the local coordinates of the parent, default value is 0.\n * @property {Number} width The width of the view, default value is 0.\n * @property {Number} height The height of the view, default value is 0.\n * @property {Number} alpha The opacity of the view, default value is 1.\n * @property {Number} rotation The rotation of the view in angles, default value is 0.\n * @property {Boolean} visible The visibility of the view. If false the vew will not be drawn, default value is true.\n * @property {Number} pivotX Position of the center point on the x axis of the view, default value is 0.\n * @property {Number} pivotY Position of the center point on the y axis of the view, default value is 0.\n * @property {Number} scaleX The x axis scale factor of the view, default value is 1.\n * @property {Number} scaleY The y axis scale factor of the view, default value is 1.\n * @property {Matrix} transform The transform of the view.If set the transform, x, y, scaleX, scaleY, rotation, pivotX, pivotY will be ignored.default is null.\n * @property {Boolean} pointerEnabled Is the view can receive DOM events, default value is true.\n * @property {Object} background The background style to fill the view, can be css color, gradient or pattern of canvas\n * @property {Graphics} mask Sets a mask for the view. A mask is an object that limits the visibility of an object to the shape of the mask applied to it. A regular mask must be a Hilo.Graphics object. This allows for much faster masking in canvas as it utilises shape clipping. To remove a mask, set this property to null.\n * @property {Number} tint The tint applied to the view，default is 0xFFFFFF.Only support in WebGL mode.\n * @property {String|Function} align The alignment of the view, the value must be one of Hilo.align enum.\n * @property {Container} parent The parent view of this view, readonly!\n * @property {Number} depth The z index of the view, readonly!\n * @property {Drawable} drawable The drawable object of the view. Only for advanced develop.\n * @property {Array} boundsArea The vertex points of the view, the points are relative to the center point. This is a example: [{x:10, y:10}, {x:20, y:20}].\n */\nvar View = (function(){\n\nreturn Class.create(/** @lends View.prototype */{\n    Mixes: EventMixin,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"View\");\n        util.copy(this, properties, true);\n    },\n\n    tint:0xffffff,\n    id: null,\n    x: 0,\n    y: 0,\n    width: 0,\n    height: 0,\n    alpha: 1,\n    rotation: 0,\n    visible: true,\n    pivotX: 0,\n    pivotY: 0,\n    scaleX: 1,\n    scaleY: 1,\n    pointerEnabled: true,\n    background: null,\n    mask: null,\n    align: null,\n    drawable: null,\n    boundsArea: null,\n    parent: null,\n    depth: -1,\n    transform: null,\n    blendMode:'source-over',\n\n    /**\n     * @language=en\n     * Get the stage object of the view. If the view doesn't add to any stage, null will be returned.\n     * @returns {Stage} The stage object of the view.\n     */\n    getStage: function(){\n        var obj = this, parent;\n        while(parent = obj.parent) obj = parent;\n        //NOTE: don't use `instanceof` to prevent circular module requirement.\n        //But it's not a very reliable way to check it's a stage instance.\n        if(obj.canvas) return obj;\n        return null;\n    },\n\n    /**\n     * @language=en\n     * Get the scaled width of the view.\n     * @returns {Number} scaled width of the view.\n     */\n    getScaledWidth: function(){\n        return this.width * this.scaleX;\n    },\n\n    /**\n     * @language=en\n     * Get the scaled height of the view.\n     * @returns {Number} scaled height of the view.\n     */\n    getScaledHeight: function(){\n        return this.height * this.scaleY;\n    },\n\n    /**\n     * @language=en\n     * Add current view to a Contaner.\n     * @param {Container} container Container object.\n     * @param {Uint} index The index of the view in container.\n     * @returns {View} Current view.\n     */\n    addTo: function(container, index){\n        if(typeof index === 'number') container.addChildAt(this, index);\n        else container.addChild(this);\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Remove current view from it's parent container\n     * @returns {View} Current view.\n     */\n    removeFromParent: function(){\n        var parent = this.parent;\n        if(parent) parent.removeChild(this);\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Get the bounds of the view as a circumscribed rectangle and all vertex points relative to the coordinates of the stage.\n     * @returns {Array} The vertex points array, and the array contains the following properties:\n     * <ul>\n     * <li><b>x</b> - The position of the view on the x axis relative to the coordinates of the stage.</li>\n     * <li><b>y</b> - The position of the view on the y axis relative to the coordinates of the stage.</li>\n     * <li><b>width</b> - The width of circumscribed rectangle of the view.</li>\n     * <li><b>height</b> - The height of circumscribed rectangle of the view</li>\n     * </ul>\n     */\n    getBounds: function(){\n        var w = this.width, h = this.height,\n            mtx = this.getConcatenatedMatrix(),\n            poly = this.boundsArea || [{x:0, y:0}, {x:w, y:0}, {x:w, y:h}, {x:0, y:h}],\n            vertexs = [], point, x, y, minX, maxX, minY, maxY;\n\n        for(var i = 0, len = poly.length; i < len; i++){\n            point = mtx.transformPoint(poly[i], true, true);\n            x = point.x;\n            y = point.y;\n\n            if(i == 0){\n                minX = maxX = x;\n                minY = maxY = y;\n            }else{\n                if(minX > x) minX = x;\n                else if(maxX < x) maxX = x;\n                if(minY > y) minY = y;\n                else if(maxY < y) maxY = y;\n            }\n            vertexs[i] = point;\n        }\n\n        vertexs.x = minX;\n        vertexs.y = minY;\n        vertexs.width = maxX - minX;\n        vertexs.height = maxY - minY;\n        return vertexs;\n    },\n\n    /**\n     * @language=en\n     * Get the matrix that can transform points from current view coordinates to the ancestor container coordinates.\n     * @param {View} ancestor The ancestor of current view, default value is the top container.\n     * @private\n     */\n    getConcatenatedMatrix: function(ancestor){\n        var mtx = new Matrix(1, 0, 0, 1, 0, 0);\n\n        for(var o = this; o != ancestor && o.parent; o = o.parent){\n            var cos = 1, sin = 0,\n                rotation = o.rotation % 360,\n                pivotX = o.pivotX, pivotY = o.pivotY,\n                scaleX = o.scaleX, scaleY = o.scaleY,\n                transform = o.transform;\n\n            if(transform) {\n                mtx.concat(transform);\n            }\n            else{\n                if(rotation){\n                    var r = rotation * Math.PI / 180;\n                    cos = Math.cos(r);\n                    sin = Math.sin(r);\n                }\n\n                if(pivotX != 0) mtx.tx -= pivotX;\n                if(pivotY != 0) mtx.ty -= pivotY;\n\n                var pos = o.getAlignPosition();\n                mtx.concat(cos*scaleX, sin*scaleX, -sin*scaleY, cos*scaleY, pos.x, pos.y);\n            }\n            \n        }\n        return mtx;\n    },\n\n    getAlignPosition: function(){\n        var parent = this.parent;\n        var align = this.align;\n        var x = this.x;\n        var y = this.y;\n\n        if(parent && this.align){\n            if(typeof align === 'function'){\n                return this.align();\n            }\n\n            var w = this.width, h = this.height,\n                pw = parent.width, ph = parent.height;\n            switch(align){\n                case 'TL':\n                    x = 0;\n                    y = 0;\n                    break;\n                case 'T':\n                    x = pw - w >> 1;\n                    y = 0;\n                    break;\n                case 'TR':\n                    x = pw - w;\n                    y = 0;\n                    break;\n                case 'L':\n                    x = 0;\n                    y = ph - h >> 1;\n                    break;\n                case 'C':\n                    x = pw - w >> 1;\n                    y = ph - h >> 1;\n                    break;\n                case 'R':\n                    x = pw - w;\n                    y = ph - h >> 1;\n                    break;\n                case 'BL':\n                    x = 0;\n                    y = ph - h;\n                    break;\n                case 'B':\n                    x = pw - w >> 1;\n                    y = ph - h;\n                    break;\n                case 'BR':\n                    x = pw - w;\n                    y = ph - h;\n                    break;\n            }\n        }\n\n        return {\n            x:x,\n            y:y\n        };\n    },\n\n    /**\n     * @language=en\n     * Determining whether a point is in the circumscribed rectangle of current view.\n     * @param {Number} x The x axis relative to the stage coordinates.\n     * @param {Number} y The y axis relative to the stage coordinates.\n     * @param {Boolean} usePolyCollision Is use polygon collision, default value is false.\n     * @returns {Boolean} the point is in the circumscribed rectangle of current view.\n     */\n    hitTestPoint: function(x, y, usePolyCollision){\n        var bound = this.getBounds(),\n            hit = x >= bound.x && x <= bound.x + bound.width &&\n                  y >= bound.y && y <= bound.y + bound.height;\n\n        if(hit && usePolyCollision){\n            hit = pointInPolygon(x, y, bound);\n        }\n        return hit;\n    },\n\n    /**\n     * @language=en\n     * Determining whether an object is in the circumscribed rectangle of current view.\n     * @param {View} object The object need to determining.\n     * @param {Boolean} usePolyCollision Is use polygon collision, default value is false.\n     */\n    hitTestObject: function(object, usePolyCollision){\n        var b1 = this.getBounds(),\n            b2 = object.getBounds(),\n            hit = b1.x <= b2.x + b2.width && b2.x <= b1.x + b1.width &&\n                  b1.y <= b2.y + b2.height && b2.y <= b1.y + b1.height;\n\n        if(hit && usePolyCollision){\n            hit = polygonCollision(b1, b2);\n        }\n        return !!hit;\n    },\n\n    /**\n     * @language=en\n     * The method to render current display object. Only for advanced develop.\n     * @param {Renderer} renderer Renderer object.\n     * @param {Number} delta The delta time of render.\n     * @protected\n     */\n    _render: function(renderer, delta){\n        if((!this.onUpdate || this.onUpdate(delta) !== false) && renderer.startDraw(this)){\n            renderer.transform(this);\n            this.render(renderer, delta);\n            renderer.endDraw(this);\n        }\n    },\n    /**\n     * @language=en\n     * Mouse event\n    */\n    _fireMouseEvent:function(e){\n        e.eventCurrentTarget = this;\n        this.fire(e);\n\n        // 处理mouseover事件 mouseover不需要阻止冒泡\n        // handle mouseover event, mouseover needn't stop propagation.\n        if(e.type == \"mousemove\"){\n            if(!this.__mouseOver){\n                this.__mouseOver = true;\n                var overEvent = util.copy({}, e);\n                overEvent.type = \"mouseover\";\n                this.fire(overEvent);\n            }\n        }\n        else if(e.type == \"mouseout\"){\n            this.__mouseOver = false;\n        }\n\n        // 向上冒泡\n        // handle event propagation\n        var parent = this.parent;\n        if(!e._stopped && !e._stopPropagationed && parent){\n            if(e.type == \"mouseout\" || e.type == \"touchout\"){\n                if(!parent.hitTestPoint(e.stageX, e.stageY, true)){\n                    parent._fireMouseEvent(e);\n                }\n            }\n            else{\n                parent._fireMouseEvent(e);\n            }\n        }\n    },\n\n    /**\n     * @language=en\n     * This method will call while the view need update(usually caused by ticker update). This method can return a Boolean value, if return false, the view will not be drawn.\n     * Limit: If you change the index in it's parent, it will not be drawn correct in current frame but next frame is correct.\n     * @type Function\n     * @default null\n     */\n    onUpdate: null,\n\n    /**\n     * @language=en\n     * The render method of current view. The subclass can implement it's own render logic by rewrite this function.\n     * @param {Renderer} renderer Renderer object.\n     * @param {Number} delta The delta time of render.\n     */\n    render: function(renderer, delta){\n        renderer.draw(this);\n    },\n\n    /**\n     * @language=en\n     * Get a string representing current view.\n     * @returns {String} string representing current view.\n     */\n    toString: function(){\n        return Hilo.viewToString(this);\n    }\n});\n\n/**\n * @language=en\n * @private\n */\nfunction pointInPolygon(x, y, poly){\n    var cross = 0, onBorder = false, minX, maxX, minY, maxY;\n\n    for(var i = 0, len = poly.length; i < len; i++){\n        var p1 = poly[i], p2 = poly[(i+1)%len];\n\n        if(p1.y == p2.y && y == p1.y){\n            p1.x > p2.x ? (minX = p2.x, maxX = p1.x) : (minX = p1.x, maxX = p2.x);\n            if(x >= minX && x <= maxX){\n                onBorder = true;\n                continue;\n            }\n        }\n\n        p1.y > p2.y ? (minY = p2.y, maxY = p1.y) : (minY = p1.y, maxY = p2.y);\n        if(y < minY || y > maxY) continue;\n\n        var nx = (y - p1.y)*(p2.x - p1.x) / (p2.y - p1.y) + p1.x;\n        if(nx > x) cross++;\n        else if(nx == x) onBorder = true;\n\n        //当射线和多边形相交\n        if(p1.x > x && p1.y == y){\n            var p0 = poly[(len+i-1)%len];\n            //当交点的两边在射线两旁\n            if(p0.y < y && p2.y > y || p0.y > y && p2.y < y){\n                cross ++;\n            }\n        }\n    }\n\n    return onBorder || (cross % 2 == 1);\n}\n\n/**\n * @language=en\n * @private\n */\nfunction polygonCollision(poly1, poly2){\n    var result = doSATCheck(poly1, poly2, {overlap:-Infinity, normal:{x:0, y:0}});\n    if(result) return doSATCheck(poly2, poly1, result);\n    return false;\n}\n\n/**\n * @language=en\n * @private\n */\nfunction doSATCheck(poly1, poly2, result){\n    var len1 = poly1.length, len2 = poly2.length,\n        currentPoint, nextPoint, distance,\n        min1, max1, min2, max2, dot, overlap, normal = {x:0, y:0};\n\n    for(var i = 0; i < len1; i++){\n        currentPoint = poly1[i];\n        nextPoint = poly1[(i < len1-1 ? i+1 : 0)];\n\n        normal.x = currentPoint.y - nextPoint.y;\n        normal.y = nextPoint.x - currentPoint.x;\n\n        distance = Math.sqrt(normal.x * normal.x + normal.y * normal.y);\n        normal.x /= distance;\n        normal.y /= distance;\n\n        min1 = max1 = poly1[0].x * normal.x + poly1[0].y * normal.y;\n        for(var j = 1; j < len1; j++){\n            dot = poly1[j].x * normal.x + poly1[j].y * normal.y;\n            if(dot > max1) max1 = dot;\n            else if(dot < min1) min1 = dot;\n        }\n\n        min2 = max2 = poly2[0].x * normal.x + poly2[0].y * normal.y;\n        for(j = 1; j < len2; j++){\n            dot = poly2[j].x * normal.x + poly2[j].y * normal.y;\n            if(dot > max2) max2 = dot;\n            else if(dot < min2) min2 = dot;\n        }\n\n        if(min1 < min2){\n            overlap = min2 - max1;\n            normal.x = -normal.x;\n            normal.y = -normal.y;\n        }else{\n            overlap = min1 - max2;\n        }\n\n        if(overlap >= 0){\n            return false;\n        }else if(overlap > result.overlap){\n            result.overlap = overlap;\n            result.normal.x = normal.x;\n            result.normal.y = normal.y;\n        }\n    }\n\n    return result;\n}\n\n})();\nwindow.Hilo.View = View;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Drawable = window.Hilo.Drawable;\nvar browser = window.Hilo.browser;\n\n\nvar _cacheCanvas, _cacheContext;\n/**\n * @language=en\n * @class CacheMixin A mixin that contains cache method.You can mix cache method to the target by use Class.mix(target, CacheMixin).\n * @static\n * @mixin\n * @module hilo/view/CacheMixin\n * @requires hilo/view/Drawable\n * @requires hilo/util/browser\n */\nvar CacheMixin = /** @lends CacheMixin# */ {\n    _cacheDirty:true,\n    /**\n     * @language=en\n     * Cache the view.\n     * @param {Boolean} forceUpdate is force update cache.\n     */\n    cache: function(forceUpdate){\n        if(forceUpdate || this._cacheDirty || !this.drawable){\n            this.updateCache();\n        }\n    },\n    /**\n     * @language=en\n     * Update the cache.\n     */\n    updateCache:function(){\n        if(browser.supportCanvas){\n            if(!_cacheCanvas){\n                _cacheCanvas = document.createElement('canvas');\n                _cacheContext = _cacheCanvas.getContext('2d');\n            }\n\n            //TODO:width, height自动判断\n            _cacheCanvas.width = this.width;\n            _cacheCanvas.height = this.height;\n            this._draw(_cacheContext);\n            this.drawable = this.drawable||new Drawable();\n            this.drawable.init({\n                image:_cacheCanvas.toDataURL()\n            });\n            this._cacheDirty = false;\n        }\n    },\n    /**\n     * @language=en\n     * set the cache state diry.\n     * @param {Boolean} dirty is cache dirty\n     */\n    setCacheDirty:function(dirty){\n        this._cacheDirty = dirty;\n    }\n};\nwindow.Hilo.CacheMixin = CacheMixin;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\n\n\n/**\n * @language=en\n * @class Container is the base class to all container classes. Each Container can add other view object as children.\n * @augments View\n * @param {Object} properties Properties parameters of the object to create. Contains all writable properties of this class.\n * @module hilo/view/Container\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @property {Array} children List of children elements of the container, readonly!\n * @property {Boolean} pointerChildren Whether children elements of the container can response to user interactive events, default value is true.\n * @property {Boolean} clipChildren Whether clip children elements which are out of the container, default value is false.\n */\nvar Container = Class.create(/** @lends Container.prototype */{\n    Extends: View,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"Container\");\n        Container.superclass.constructor.call(this, properties);\n\n        if(this.children) this._updateChildren();\n        else this.children = [];\n    },\n\n    children: null,\n    pointerChildren: true,\n    clipChildren: false,\n\n    /**\n     * @language=en\n     * Return the amount of the children elements of the container.\n     * @returns {Uint} The amount of the children elements of the container.\n     */\n    getNumChildren: function(){\n        return this.children.length;\n    },\n\n    /**\n     * @language=en\n     * Add child element at given index.\n     * @param {View} child Element to add.\n     * @param {Number} index The given index position, range from 0.\n     */\n    addChildAt: function(child, index){\n        var children = this.children,\n            len = children.length,\n            parent = child.parent;\n\n        index = index < 0 ? 0 : index > len ? len : index;\n        var childIndex = this.getChildIndex(child);\n        if(childIndex == index){\n            return this;\n        }else if(childIndex >= 0){\n            children.splice(childIndex, 1);\n            index = index == len ? len - 1 : index;\n        }else if(parent){\n            parent.removeChild(child);\n        }\n\n        children.splice(index, 0, child);\n\n        //直接插入，影响插入位置之后的深度\n        //Insert directly, this will affect depth of elements after the index.\n        if(childIndex < 0){\n            this._updateChildren(index);\n        }\n        //只是移动时影响中间段的深度\n        //Will affect depth of elements in the middle during moving\n        else{\n            var startIndex = childIndex < index ? childIndex : index;\n            var endIndex = childIndex < index ? index : childIndex;\n            this._updateChildren(startIndex, endIndex + 1);\n        }\n\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Add child element at the top.\n     * @param {View} child Elements to add.\n     */\n    addChild: function(child){\n        var total = this.children.length,\n            args = arguments;\n\n        for(var i = 0, len = args.length; i < len; i++){\n            this.addChildAt(args[i], total + i);\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Remove element at the index.\n     * @param {Int} index Index of the element to remove, range from 0.\n     * @returns {View} Element had been removed.\n     */\n    removeChildAt: function(index){\n        var children = this.children;\n        if(index < 0 || index >= children.length) return null;\n\n        var child = children[index];\n        if(child){\n            //NOTE: use `__renderer` for fixing child removal (DOMRenderer and FlashRenderer only).\n            //Do `not` use it in any other case.\n            if(!child.__renderer){\n                var obj = child;\n                while(obj = obj.parent){\n                    //obj is stage\n                    if(obj.renderer){\n                        child.__renderer = obj.renderer;\n                        break;\n                    }\n                    else if(obj.__renderer){\n                        child.__renderer = obj.__renderer;\n                        break;\n                    }\n                }\n            }\n\n            if(child.__renderer){\n                child.__renderer.remove(child);\n            }\n\n            child.parent = null;\n            child.depth = -1;\n        }\n\n        children.splice(index, 1);\n        this._updateChildren(index);\n\n        return child;\n    },\n\n    /**\n     * @language=en\n     * Remove the given child element.\n     * @param {View} child The child element to remove.\n     * @returns {View} Element had been removed.\n     */\n    removeChild: function(child){\n        return this.removeChildAt(this.getChildIndex(child));\n    },\n\n    /**\n     * @language=en\n     * Remove child element by its id.\n     * @param {String} id The id of element to remove.\n     * @returns {View} Element had been removed.\n     */\n    removeChildById: function(id){\n        var children = this.children, child;\n        for(var i = 0, len = children.length; i < len; i++){\n            child = children[i];\n            if(child.id === id){\n                this.removeChildAt(i);\n                return child;\n            }\n        }\n        return null;\n    },\n\n    /**\n     * @language=en\n     * Remove all children elements.\n     * @returns {Container} Container itself.\n     */\n    removeAllChildren: function(){\n        while(this.children.length) this.removeChildAt(0);\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Return child element at the given index.\n     * @param {Number} index The index of the element, range from 0.\n     */\n    getChildAt: function(index){\n        var children = this.children;\n        if(index < 0 || index >= children.length) return null;\n        return children[index];\n    },\n\n    /**\n     * @language=en\n     * Return child element at the given id.\n     * @param {String} id The id of child element to return.\n     */\n    getChildById: function(id){\n        var children = this.children, child;\n        for(var i = 0, len = children.length; i < len; i++){\n            child = children[i];\n            if(child.id === id) return child;\n        }\n        return null;\n    },\n\n    /**\n     * @language=en\n     * Return index value of the given child element.\n     * @param {View} child The child element need to get its index.\n     */\n    getChildIndex: function(child){\n        return this.children.indexOf(child);\n    },\n\n    /**\n     * @language=en\n     * Set the index of child element.\n     * @param {View} child The child element need to set index.\n     * @param {Number} index The index to set to the element.\n     */\n    setChildIndex: function(child, index){\n        var children = this.children,\n            oldIndex = children.indexOf(child);\n\n        if(oldIndex >= 0 && oldIndex != index){\n            var len = children.length;\n            index = index < 0 ? 0 : index >= len ? len - 1 : index;\n            children.splice(oldIndex, 1);\n            children.splice(index, 0, child);\n            this._updateChildren();\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Swap index between two child elements.\n     * @param {View} child1 Child element A.\n     * @param {View} child2 Child element B.\n     */\n    swapChildren: function(child1, child2){\n        var children = this.children,\n            index1 = this.getChildIndex(child1),\n            index2 = this.getChildIndex(child2);\n\n        child1.depth = index2;\n        children[index2] = child1;\n        child2.depth = index1;\n        children[index1] = child2;\n    },\n\n    /**\n     * @language=en\n     * Swap two children elements at given indexes.\n     * @param {Number} index1 Given index A.\n     * @param {Number} index2 Given index B.\n     */\n    swapChildrenAt: function(index1, index2){\n        var children = this.children,\n            child1 = this.getChildAt(index1),\n            child2 = this.getChildAt(index2);\n\n        child1.depth = index2;\n        children[index2] = child1;\n        child2.depth = index1;\n        children[index1] = child2;\n    },\n\n    /**\n     * @language=en\n     * Sort children elements by the given key or function.\n     * @param {Object} keyOrFunction If is String, sort children elements by the given property string; If is Function, sort by the function.\n     */\n    sortChildren: function(keyOrFunction){\n        var fn = keyOrFunction,\n            children = this.children;\n        if(typeof fn == \"string\"){\n            var key = fn;\n            fn = function(a, b){\n                return b[key] - a[key];\n            };\n        }\n        children.sort(fn);\n        this._updateChildren();\n    },\n\n    /**\n     * @language=en\n     * Update children elements.\n     * @private\n     */\n    _updateChildren: function(start, end){\n        var children = this.children, child;\n        start = start || 0;\n        end = end || children.length;\n        for(var i = start; i < end; i++){\n            child = children[i];\n            child.depth = i + 1;\n            child.parent = this;\n        }\n    },\n\n    /**\n     * @language=en\n     * Return whether this container contains the parameter described child element.\n     * @param {View} child The child element to test.\n     */\n    contains: function(child){\n        while(child = child.parent){\n            if(child === this){\n                return true;\n            }\n        }\n        return false;\n    },\n\n    /**\n     * @language=en\n     * Return object at the point positioned by given values on x axis and y axis.\n     * @param {Number} x The point's value on the coordinate's x axis.\n     * @param {Number} y The point's value on the coordinate's y asix.\n     * @param {Boolean} usePolyCollision Whether use polygon collision detection, default value is false.\n     * @param {Boolean} global Whether return all elements that match the condition, default value is false.\n     * @param {Boolean} eventMode Whether find elements under event mode, default value is false.\n     */\n    getViewAtPoint: function(x, y, usePolyCollision, global, eventMode){\n        var result = global ? [] : null,\n            children = this.children, child, obj;\n\n        for(var i = children.length - 1; i >= 0; i--){\n            child = children[i];\n            //skip child which is not shown or pointer enabled\n            if(!child || !child.visible || child.alpha <= 0 || (eventMode && !child.pointerEnabled)) continue;\n            //find child recursively\n            if(child.children && child.children.length && !(eventMode && !child.pointerChildren)){\n                obj = child.getViewAtPoint(x, y, usePolyCollision, global, eventMode);\n            }\n\n            if(obj){\n                if(!global) return obj;\n                else if(obj.length) result = result.concat(obj);\n            }else if(child.hitTestPoint(x, y, usePolyCollision)){\n                if(!global) return child;\n                else result.push(child);\n            }\n        }\n\n        return global && result.length ? result : null;\n    },\n\n    /**\n     * @language=en\n     * Rewrite render method.\n     * @private\n     */\n    render: function(renderer, delta){\n        Container.superclass.render.call(this, renderer, delta);\n\n        var children = this.children.slice(0), i, len, child;\n        for(i = 0, len = children.length; i < len; i++){\n            child = children[i];\n            //NOTE: the child could remove or change it's parent\n            if(child.parent === this) child._render(renderer, delta);\n        }\n    }\n\n});\n\nwindow.Hilo.Container = Container;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar Container = window.Hilo.Container;\nvar CanvasRenderer = window.Hilo.CanvasRenderer;\nvar DOMRenderer = window.Hilo.DOMRenderer;\nvar WebGLRenderer = window.Hilo.WebGLRenderer;\nvar browser = window.Hilo.browser;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * Demo:\n * <pre>\n * var stage = new Hilo.Stage({\n *     renderType:'canvas',\n *     container: containerElement,\n *     width: 320,\n *     height: 480\n * });\n * </pre>\n * @class Stage is the root of all visual object tree, any visual object will be render only after being added to Stage or any children elements of Stage. Normally, every hilo application start with an stage instance.\n * @augments Container\n * @param {Object} properties Properties parameters for the object. Includes all writable properties of this class. Some important like:\n * <ul>\n * <li><b>container</b>:String|HTMLElement - Assign the parent container element of the Stage in the page. It should be a dom container or an id. If this parameter is not given and canvas isn't in the dom tree, you should add the stage vanvas into the dom tree yourself, otherwise Stage will not render. optional.</li>\n * <li><b>renderType</b>:String - Renering way: canvas|dom|webgl，default value is canvas, optional.</li>\n * <li><b>canvas</b>:String|HTMLCanvasElement|HTMLElement - 指定舞台所对应的画布元素。它是一个canvas或普通的div，也可以传入元素的id。若为canvas，则使用canvas来渲染所有对象，否则使用dom+css来渲染。可选。</li>\n * <li><b>width</b>:Number</li> - The width of the Stage, default value is the width of canvas, optional.\n * <li><b>height</b>:Number</li> - The height of the Stage, default value is the height of canvas, optional.\n * <li><b>paused</b>:Boolean</li> - Whether stop rendering the Stage, default value is false, optional.\n * </ul>\n * @module hilo/view/Stage\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/Container\n * @requires hilo/renderer/CanvasRenderer\n * @requires hilo/renderer/DOMRenderer\n * @requires hilo/renderer/WebGLRenderer\n * @requires hilo/util/browser\n * @requires hilo/util/util\n * @property {HTMLCanvasElement|HTMLElement} canvas The canvas the Stage is related to. It can be a canvas or a div element, readonly!\n * @property {Renderer} renderer Stage renderer, readonly!\n * @property {Boolean} paused Paused Stage rendering.\n * @property {Object} viewport Rendering area of the Stage. Including properties like: left, top, width, height. readonly!\n */\nvar Stage = Class.create(/** @lends Stage.prototype */{\n    Extends: Container,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid('Stage');\n        Stage.superclass.constructor.call(this, properties);\n\n        this._initRenderer(properties);\n\n        //init size\n        var width = this.width, height = this.height,\n            viewport = this.updateViewport();\n        if(!properties.width) width = (viewport && viewport.width) || 320;\n        if(!properties.height) height = (viewport && viewport.height) || 480;\n        this.resize(width, height, true);\n    },\n\n    canvas: null,\n    renderer: null,\n    paused: false,\n    viewport: null,\n\n    /**\n     * @language=en\n     * @private\n     */\n    _initRenderer: function(properties){\n        var canvas = properties.canvas;\n        var container = properties.container;\n        var renderType = properties.renderType||'canvas';\n\n        if(typeof canvas === 'string') canvas = Hilo.getElement(canvas);\n        if(typeof container === 'string') container = Hilo.getElement(container);\n\n        if(!canvas){\n            var canvasTagName = renderType === 'dom'?'div':'canvas';\n            canvas = Hilo.createElement(canvasTagName, {\n                style: {\n                    position: 'absolute'\n                }\n            });\n        }\n        else if(!canvas.getContext){\n            renderType = 'dom';\n        }\n\n        this.canvas = canvas;\n        if(container) container.appendChild(canvas);\n\n        var props = {canvas:canvas, stage:this};\n        switch(renderType){\n            case 'dom':\n                this.renderer = new DOMRenderer(props);\n                break;\n            case 'webgl':\n                if(WebGLRenderer.isSupport()){\n                    this.renderer = new WebGLRenderer(props);\n                }\n                else{\n                    this.renderer = new CanvasRenderer(props);\n                }\n                break;\n            case 'canvas':\n\t        /* falls through */\n            default:\n                this.renderer = new CanvasRenderer(props);\n                break;\n        }\n    },\n\n    /**\n     * @language=en\n     * Add Stage canvas to DOM container. Note: this function overwrite View.addTo function.\n     * @param {HTMLElement} domElement An dom element.\n     * @returns {Stage} The Stage Object, chained call supported.\n     */\n    addTo: function(domElement){\n        var canvas = this.canvas;\n        if(canvas.parentNode !== domElement){\n            domElement.appendChild(canvas);\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Invoke tick function and Stage will update and render. Developer may not need to use this funciton.\n     * @param {Number} delta The time had pass between this tick invoke and last tick invoke.\n     */\n    tick: function(delta){\n        if(!this.paused){\n            this._render(this.renderer, delta);\n        }\n    },\n\n    /**\n     * @language=en\n     * Turn on/off Stage response to DOM event. To make visual objects on the Stage interactive, use this function to turn on Stage's responses to events.\n     * @param {String|Array} type The event name or array that need to turn on/off.\n     * @param {Boolean} enabled Whether turn on or off the response method of stage DOM event. If not provided, default value is true.\n     * @returns {Stage} The Stage Object, chained call supported.\n     */\n    enableDOMEvent: function(types, enabled){\n        var me = this,\n            canvas = me.canvas,\n            handler = me._domListener || (me._domListener = function(e){me._onDOMEvent(e);});\n\n        types = typeof types === 'string' ? [types] : types;\n        enabled = enabled !== false;\n\n        for(var i = 0; i < types.length; i++){\n            var type = types[i];\n\n            if(enabled){\n                canvas.addEventListener(type, handler, false);\n            }else{\n                canvas.removeEventListener(type, handler);\n            }\n        }\n\n        return me;\n    },\n\n    /**\n     * @language=en\n     * DOM events handler function. This funciton will invoke events onto the visual object, which is on the position of the coordinate where the events is invoked.\n     * @private\n     */\n    _onDOMEvent: function(e){\n        var type = e.type, event = e, isTouch = type.indexOf('touch') == 0;\n\n        //calculate stageX/stageY\n        var posObj = e;\n        if(isTouch){\n            var touches = e.touches, changedTouches = e.changedTouches;\n            posObj = (touches && touches.length) ? touches[0] :\n                     (changedTouches && changedTouches.length) ? changedTouches[0] : null;\n        }\n\n        var x = posObj.pageX || posObj.clientX, y = posObj.pageY || posObj.clientY,\n            viewport = this.viewport || this.updateViewport();\n\n        event.stageX = x = (x - viewport.left) / this.scaleX;\n        event.stageY = y = (y - viewport.top) / this.scaleY;\n\n        //鼠标事件需要阻止冒泡方法 Prevent bubbling on mouse events.\n        event.stopPropagation = function(){\n            this._stopPropagationed = true;\n        };\n\n        var obj = this.getViewAtPoint(x, y, true, false, true)||this,\n            canvas = this.canvas, target = this._eventTarget;\n\n        //fire mouseout/touchout event for last event target\n        var leave = type === 'mouseout';\n        //当obj和target不同 且obj不是target的子元素时才触发out事件 fire out event when obj and target isn't the same as well as obj is not a child element to target.\n        if(target && (target != obj && (!target.contains || !target.contains(obj))|| leave)){\n            var out = (type === 'touchmove') ? 'touchout' :\n                      (type === 'mousemove' || leave || !obj) ? 'mouseout' : null;\n            if(out) {\n                var outEvent = util.copy({}, event);\n                outEvent.type = out;\n                outEvent.eventTarget = target;\n                target._fireMouseEvent(outEvent);\n            }\n            event.lastEventTarget = target;\n            this._eventTarget = null;\n        }\n\n        //fire event for current view\n        if(obj && obj.pointerEnabled && type !== 'mouseout'){\n            event.eventTarget = this._eventTarget = obj;\n            obj._fireMouseEvent(event);\n        }\n\n        //set cursor for current view\n        if(!isTouch){\n            var cursor = (obj && obj.pointerEnabled && obj.useHandCursor) ? 'pointer' : '';\n            canvas.style.cursor = cursor;\n        }\n\n        //fix android: `touchmove` fires only once\n        if(browser.android && type === 'touchmove'){\n            e.preventDefault();\n        }\n    },\n\n    /**\n     * @language=en\n     * Update the viewport (rendering area) which Stage show on the page. Invoke this function to update viewport when Stage canvas changes border, margin or padding properties.\n     * @returns {Object} The visible area of the Stage (the viewport property).\n     */\n    updateViewport: function(){\n        var canvas = this.canvas, viewport = null;\n        if(canvas.parentNode){\n            viewport = this.viewport = Hilo.getElementRect(canvas);\n        }\n        return viewport;\n    },\n\n    /**\n     * @language=en\n     * Resize the Stage.\n     * @param {Number} width The width of the new Stage.\n     * @param {Number} height The height of the new Stage.\n     * @param {Boolean} forceResize Whether forced to resize the Stage, means no matter the size of the Stage, force to change the size to keep Stage, canvas and window act at the same time.\n     */\n    resize: function(width, height, forceResize){\n        if(forceResize || this.width !== width || this.height !== height){\n            this.width = width;\n            this.height = height;\n            this.renderer.resize(width, height);\n            this.updateViewport();\n        }\n    }\n\n});\n\nwindow.Hilo.Stage = Stage;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar Drawable = window.Hilo.Drawable;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Bitmap.html?noHeader' width = '300' height = '200' scrolling='no'></iframe>\n * <br/>\n * Example:\n * <pre>\n * var bmp = new Hilo.Bitmap({image:imgElem, rect:[0, 0, 100, 100]});\n * stage.addChild(bmp);\n * </pre>\n * @class Bitmap\n * @augments View\n * @param {Object} properties the options of create Instance.It can contains all writable property and Moreover：\n * <ul>\n * <li><b>image</b> - the image of bitmap which contained, required.</li>\n * <li><b>rect</b> - the range of bitmap in the image, option</li>\n * <li><b>crossOrigin</b> - Whether cross-domain is needed, default is false</li>\n * </ul>\n * @module hilo/view/Bitmap\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/Drawable\n */\n var Bitmap = Class.create(/** @lends Bitmap.prototype */{\n    Extends: View,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"Bitmap\");\n        Bitmap.superclass.constructor.call(this, properties);\n\n        this.drawable = new Drawable(properties);\n\n        //init width and height\n        if(!this.width || !this.height){\n            var rect = this.drawable.rect;\n            if(rect){\n                this.width = rect[2];\n                this.height = rect[3];\n            }\n        }\n    },\n\n    /**\n     * @language=en\n     * set the image。\n     * @param {Image|String} Image Object or URL.\n     * @param {Array} rect the range of bitmap in the image, option.\n     * @param {Boolean} crossOrigin Whether cross-domain is needed, default is false.\n     * @returns {Bitmap} self。\n     */\n    setImage: function(image, rect, crossOrigin){\n        this.drawable.init({image:image, rect:rect, crossOrigin:crossOrigin});\n        if(rect){\n            this.width = rect[2];\n            this.height = rect[3];\n        }\n        else if(!this.width && !this.height){\n            rect = this.drawable.rect;\n            if(rect){\n                this.width = rect[2];\n                this.height = rect[3];\n            }\n        }\n        return this;\n    }\n });\n\nwindow.Hilo.Bitmap = Bitmap;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar Drawable = window.Hilo.Drawable;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Sprite.html?noHeader' width = '550' height = '400' scrolling='no'></iframe>\n * <br/>\n * @class Sprite animation class.\n * @augments View\n * @module hilo/view/Sprite\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/Drawable\n * @param properties Properties parameters for creating object, include all writable properties of this class, also include:\n * <ul>\n * <li><b>frames</b> - Sprite animation frames data object.</li>\n * </ul>\n * @property {number} currentFrame Current showing frame index, range from 0, readoly!\n * @property {boolean} paused Is sprite paused, default value is false.\n * @property {boolean} loop Is sprite play in loop, default value is false.\n * @property {boolean} timeBased Is sprite animate base on time, default value is false (base on frame).\n * @property {number} interval Interval between sprite animation frames. If timeBased is true, measured in ms, otherwise, measured in frames.\n */\nvar Sprite = Class.create(/** @lends Sprite.prototype */{\n    Extends: View,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"Sprite\");\n        Sprite.superclass.constructor.call(this, properties);\n\n        this._frames = [];\n        this._frameNames = {};\n        this.drawable = new Drawable();\n        if(properties.frames) this.addFrame(properties.frames);\n    },\n\n    _frames: null, //所有帧的集合 Collection of all frames\n    _frameNames: null, //带名字name的帧的集合 Collection of frames that with name\n    _frameElapsed: 0, //当前帧持续的时间或帧数 Elapsed time of current frame.\n    _firstRender: true, //标记是否是第一次渲染 Is the first render.\n\n    paused: false,\n    loop: true,\n    timeBased: false,\n    interval: 1,\n    currentFrame: 0, //当前帧的索引 Index of current frame\n\n    /**\n     * @language=en\n     * Return the total amount of sprite animation frames.\n     * @returns {Uint} The total amount of frames.\n     */\n    getNumFrames: function(){\n        return this._frames ? this._frames.length : 0;\n    },\n\n    /**\n     * @language=en\n     * Add frame into sprite.\n     * @param {Object} frame Frames to add into.\n     * @param {Int} startIndex The index to start adding frame, if is not given, add at the end of sprite.\n     * @returns {Sprite} Sprite itself.\n     */\n    addFrame: function(frame, startIndex){\n        var start = startIndex != null ? startIndex : this._frames.length;\n        if(frame instanceof Array){\n            for(var i = 0, len = frame.length; i < len; i++){\n                this.setFrame(frame[i], start + i);\n            }\n        }else{\n            this.setFrame(frame, start);\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set the frame on the given index.\n     * @param {Object} frame The frame data to set on that index.\n     * @param {Int} index Index of the frame to set.\n     * @returns {Sprite} Sprite itself.\n     */\n    setFrame: function(frame, index){\n        var frames = this._frames,\n            total = frames.length;\n        index = index < 0 ? 0 : index > total ? total : index;\n        frames[index] = frame;\n        if(frame.name) this._frameNames[frame.name] = frame;\n        if(index == 0 && !this.width || !this.height){\n            this.width = frame.rect[2];\n            this.height = frame.rect[3];\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Get the frame of given parameter from sprite.\n     * @param {Object} indexOrName The index or name of the frame.\n     * @returns {Object} The sprite object.\n     */\n    getFrame: function(indexOrName){\n        if(typeof indexOrName === 'number'){\n            var frames = this._frames;\n            if(indexOrName < 0 || indexOrName >= frames.length) return null;\n            return frames[indexOrName];\n        }\n        return this._frameNames[indexOrName];\n    },\n\n    /**\n     * @language=en\n     * Get frame index from sprite.\n     * @param {Object} frameValue Index or name of the frame.\n     * @returns {Object} Sprite frame object.\n     */\n    getFrameIndex: function(frameValue){\n        var frames = this._frames,\n            total = frames.length,\n            index = -1;\n        if(typeof frameValue === 'number'){\n            index = frameValue;\n        }else{\n            var frame = typeof frameValue === 'string' ? this._frameNames[frameValue] : frameValue;\n            if(frame){\n                for(var i = 0; i < total; i++){\n                    if(frame === frames[i]){\n                        index = i;\n                        break;\n                    }\n                }\n            }\n        }\n        return index;\n    },\n\n    /**\n     * @language=en\n     * Play sprite.\n     * @returns {Sprite} The Sprite object.\n     */\n    play: function(){\n        this.paused = false;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Pause playing sprite.\n     * @returns {Sprite} The Sprite object.\n     */\n    stop: function(){\n        this.paused = true;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Jump to an assigned frame.\n     * @param {Object} indexOrName Index or name of an frame to jump to.\n     * @param {Boolean} pause Does pause after jumping to the new index.\n     * @returns {Sprite} The Sprite object.\n     */\n    goto: function(indexOrName, pause){\n        var total = this._frames.length,\n            index = this.getFrameIndex(indexOrName);\n\n        this.currentFrame = index < 0 ? 0 : index >= total ? total - 1 : index;\n        this.paused = pause;\n        this._firstRender = true;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Render function.\n     * @private\n     */\n    _render: function(renderer, delta){\n        var lastFrameIndex = this.currentFrame, frameIndex;\n\n        if(this._firstRender){\n            frameIndex = lastFrameIndex;\n            this._firstRender = false;\n        }else{\n            frameIndex = this._nextFrame(delta);\n        }\n\n        if(frameIndex != lastFrameIndex){\n            this.currentFrame = frameIndex;\n            var callback = this._frames[frameIndex].callback;\n            callback && callback.call(this);\n        }\n\n        //NOTE: it will be deprecated, don't use it.\n        if(this.onEnterFrame) this.onEnterFrame(frameIndex);\n\n        this.drawable.init(this._frames[frameIndex]);\n        Sprite.superclass._render.call(this, renderer, delta);\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _nextFrame: function(delta){\n        var frames = this._frames,\n            total = frames.length,\n            frameIndex = this.currentFrame,\n            frame = frames[frameIndex],\n            duration = frame.duration || this.interval,\n            elapsed = this._frameElapsed;\n\n        //calculate the current frame elapsed frames/time\n        var value = (frameIndex == 0 && !this.drawable) ? 0 : elapsed + (this.timeBased ? delta : 1);\n        elapsed = this._frameElapsed = value < duration ? value : 0;\n\n        if(frame.stop || !this.loop && frameIndex >= total - 1){\n            this.stop();\n        }\n\n        if(!this.paused && elapsed == 0){\n            if(frame.next != null){\n                //jump to the specified frame\n                frameIndex = this.getFrameIndex(frame.next);\n            }else if(frameIndex >= total - 1){\n                //at the end of the frames, go back to first frame\n                frameIndex = 0;\n            }else if(this.drawable){\n                //normal go forward to next frame\n                frameIndex++;\n            }\n        }\n\n        return frameIndex;\n    },\n\n    /**\n     * @language=en\n     * Set a callback on an assigned frame. Every time assigned frame is played, invoke the callback function. If callback is empty, callback function will be removed.\n     * @param {Int|String} frame Index or name of the assigned frame.\n     * @param {Function} callback Callback function.\n     * @returns {Sprite} The Sprite object.\n     */\n    setFrameCallback: function(frame, callback){\n        frame = this.getFrame(frame);\n        if(frame) frame.callback = callback;\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Callback function on when sprite enter a new frame. default value is null. Note: this function is obsolete, use addFrameCallback funciton instead.\n     * @type Function\n     * @deprecated\n     */\n    onEnterFrame: null\n\n});\n\nwindow.Hilo.Sprite = Sprite;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar Drawable = window.Hilo.Drawable;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/DOMElement.html?noHeader' width = '330' height = '250' scrolling='no'></iframe>\n * <br/>\n * demo:\n * <pre>\n * var domView = new Hilo.DOMElement({\n *     element: Hilo.createElement('div', {\n *         style: {\n *             backgroundColor: '#004eff',\n *             position: 'absolute'\n *         }\n *     }),\n *     width: 100,\n *     height: 100,\n *     x: 50,\n *     y: 70\n * }).addTo(stage);\n * </pre>\n * @name DOMElement\n * @class DOMElement is a wrapper of dom element.（The DOMElement's parent must be stage）\n * @augments View\n * @param {Object} properties create Objects properties. Contains all writable properties in this class. Special properties include:\n * <ul>\n * <li><b>element</b> - dom element to wrap, required! </li>\n * </ul>\n * @module hilo/view/DOMElement\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/Drawable\n */\nvar DOMElement = Class.create(/** @lends DOMElement.prototype */{\n    Extends: View,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"DOMElement\");\n        DOMElement.superclass.constructor.call(this, properties);\n\n        this.drawable = new Drawable();\n        var elem = this.drawable.domElement = properties.element || Hilo.createElement('div');\n        elem.id = this.id;\n\n        if(this.pointerEnabled && !elem.style.pointerEvents){\n            elem.style.pointerEvents = 'visible';\n        }\n    },\n\n    /**\n     * @language=en\n     * Overwrite render method.\n     * @private\n     */\n    _render: function(renderer, delta){\n        if(!this.onUpdate || this.onUpdate(delta) !== false){\n            renderer.transform(this);\n            if(this.visible && this.alpha > 0){\n                this.render(renderer, delta);\n            }\n        }\n    },\n\n    /**\n     * @language=en\n     * Overwrite render method.\n     * @private\n     */\n    render: function(renderer, delta){\n        if(renderer.renderType !== 'dom'){\n            var canvas = renderer.canvas;\n            var stage = this.parent;\n            var domElementContainer = renderer._domElementContainer;\n            if(!renderer._domElementContainer){\n                domElementContainer = renderer._domElementContainer = Hilo.createElement('div', {\n                    style:{\n                        'position':'absolute',\n                        'transform':'scale3d(' + stage.scaleX + ',' + stage.scaleY + ', 1)',\n                        'transformOrigin':'0 0',\n                        'zIndex':'1'\n                    }\n                });\n                canvas.parentNode.insertBefore(renderer._domElementContainer, canvas.nextSibling);\n            }\n\n            var elem = this.drawable.domElement, depth = this.depth,\n                nextElement = domElementContainer.childNodes[0], nextDepth;\n            if(elem.parentNode) return;\n\n            //draw dom element just after stage canvas\n            while(nextElement && nextElement.nodeType != 3){\n                nextDepth = parseInt(nextElement.style.zIndex) || 0;\n                if(nextDepth <= 0 || nextDepth > depth){\n                    break;\n                }\n                nextElement = nextElement.nextSibling;\n            }\n            domElementContainer.insertBefore(this.drawable.domElement, nextElement);\n        }else{\n            renderer.draw(this);\n        }\n    }\n});\nwindow.Hilo.DOMElement = DOMElement;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar CacheMixin = window.Hilo.CacheMixin;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Graphics.html?noHeader' width = '430' height = '400' scrolling='no'></iframe>\n * <br/>\n * @class Graphics class contains a group of functions for creating vector graphics.\n * @augments View\n * @mixes CacheMixin\n * @borrows CacheMixin#cache as #cache\n * @borrows CacheMixin#updateCache as #updateCache\n * @borrows CacheMixin#setCacheDirty as #setCacheDirty\n * @param {Object} properties Properties parameters of the object to create. Contains all writable properties of this class.\n * @module hilo/view/Graphics\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/CacheMixin\n * @property {Number} lineWidth The thickness of lines in space units, default value is 1, readonly!\n * @property {Number} lineAlpha The alpha value (transparency) of line, default value is 1, readonly!\n * @property {String} lineCap The style of how every end point of line are drawn, value options: butt, round, square. default value is null, readonly!\n * @property {String} lineJoin The joint style of two lines. value options: miter, round, bevel. default value is null, readonly!\n * @property {Number} miterLimit The miter limit ratio in space units, works only when lineJoin value is miter. default value is 10, readonly!\n * @property {String} strokeStyle The color or style to use for lines around shapes, default value is 0 (the black color), readonly!\n * @property {String} fillStyle The color or style to use inside shapes, default value is 0 (the black color), readonly!\n * @property {Number} fillAlpha The transparency of color or style inside shapes, default value is 0, readonly!\n */\nvar Graphics = (function(){\n\nvar canvas = document.createElement('canvas');\nvar helpContext = canvas.getContext && canvas.getContext('2d');\n\nreturn Class.create(/** @lends Graphics.prototype */{\n    Extends: View,\n    Mixes:CacheMixin,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid('Graphics');\n        Graphics.superclass.constructor.call(this, properties);\n\n        this._actions = [];\n    },\n\n    lineWidth: 1,\n    lineAlpha: 1,\n    lineCap: null, //'butt', 'round', 'square'\n    lineJoin: null, //'miter', 'round', 'bevel'\n    miterLimit: 10,\n    hasStroke: false,\n    strokeStyle: '0',\n    hasFill: false,\n    fillStyle: '0',\n    fillAlpha: 0,\n\n    /**\n     * @language=en\n     * Set the lines style for drawing shapes.\n     * @param {Number} thickness The thickness of lines, default value is 1.\n     * @param {String} lineColor The CSS color value of lines, default value is 0 (the black color).\n     * @param {Number} lineAlpha The transparency of lines, default value is 1 (fully opaque).\n     * @param {String} lineCap The style of how every end point of line are drawn, value options: butt, round, square. default value is null.\n     * @param {String} lineJoin The joint style of two lines. value options: miter, round, bevel. default value is null.\n     * @param {Number} miterLimit The miter limit ratio in space units, works only when lineJoin value is miter. default value is 10.\n     * @returns {Graphics} The Graphics Object.\n     */\n    lineStyle: function(thickness, lineColor, lineAlpha, lineCap, lineJoin, miterLimit){\n        var me = this, addAction = me._addAction;\n\n        addAction.call(me, ['lineWidth', (me.lineWidth = thickness || 1)]);\n        addAction.call(me, ['strokeStyle', (me.strokeStyle = lineColor || '0')]);\n        addAction.call(me, ['lineAlpha', (me.lineAlpha = lineAlpha || 1)]);\n        if(lineCap != undefined) addAction.call(me, ['lineCap', (me.lineCap = lineCap)]);\n        if(lineJoin != undefined) addAction.call(me, ['lineJoin', (me.lineJoin = lineJoin)]);\n        if(miterLimit != undefined) addAction.call(me, ['miterLimit', (me.miterLimit = miterLimit)]);\n        me.hasStroke = true;\n        return me;\n    },\n\n    /**\n     * 设置虚线样式\n     * @param {Number[]} segments 一组描述交替绘制线段和间距（坐标空间单位）长度的数字\n     * @see https://developer.mozilla.org/zh-CN/docs/Web/API/CanvasRenderingContext2D/setLineDash\n     */\n    setLineDash: function(segments){\n        return this._addAction(['setLineDash', segments]);\n    },\n\n    /**\n     * @language=en\n     * Set how to fill shapes and the transparency.\n     * @param {String} fill Filling style. this can be color, gradient or pattern.\n     * @param {Number} alpha Transparency.\n     * @returns {Graphics} The Graphics Object.\n     */\n    beginFill: function(fill, alpha){\n        var me = this, addAction = me._addAction;\n\n        addAction.call(me, ['fillStyle', (me.fillStyle = fill)]);\n        addAction.call(me, ['fillAlpha', (me.fillAlpha = alpha || 1)]);\n        me.hasFill = true;\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Apply and end lines-drawing and shapes-filling.\n     * @returns {Graphics} The Graphics Object.\n     */\n    endFill: function(){\n        var me = this, addAction = me._addAction;\n\n        if(me.hasStroke) addAction.call(me, ['stroke']);\n        if(me.hasFill) addAction.call(me, ['fill']);\n        me.setCacheDirty(true);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Set linear gradient filling style to draw shapes.\n     * @param {Number} x0 The x-coordinate value of the linear gradient start point.\n     * @param {Number} y0 The y-coordinate value of the linear gradient start point.\n     * @param {Number} x1 The x-coordinate value of the linear gradient end point.\n     * @param {Number} y1 The y-coordinate value of the linear gradient end point.\n     * @param {Array} colors An array of CSS colors used in the linear gradient.\n     * @param {Array} ratios An array of position between start point and end point, should be one-to-one to colors in the colors array. each value range between 0.0 to 1.0.\n     * @returns {Graphics} The Graphics Object.\n     */\n    beginLinearGradientFill: function(x0, y0, x1, y1, colors, ratios){\n        var me = this, gradient = helpContext.createLinearGradient(x0, y0, x1, y1);\n\n        for (var i = 0, len = colors.length; i < len; i++){\n            gradient.addColorStop(ratios[i], colors[i]);\n        }\n        me.hasFill = true;\n        return me._addAction(['fillStyle', (me.fillStyle = gradient)]);\n    },\n\n    /**\n     * @language=en\n     * Set radial gradient filling style to draw shapes.\n     * @param {Number} x0 The x-coordinate value of the radial gradient start circle.\n     * @param {Number} y0 The y-coordinate value of the radial gradient start circle.\n     * @param {Number} r0 The diameter of the radial gradient start circle.\n     * @param {Number} x1 The x-coordinate value of the radial gradient end circle.\n     * @param {Number} y1 The y-coordinate value of the radial gradient end circle.\n     * @param {Number} r1 The radius of the radial gradient end circle.\n     * @param {Array} colors An array of CSS colors used in the radial gradient.\n     * @param {Array} ratios An array of position between start circle and end circle, should be one-to-one to colors in the colors array. each value range between 0.0 to 1.0.\n     * @returns {Graphics} The Graphics Object.\n     */\n    beginRadialGradientFill: function(x0, y0, r0, x1, y1, r1, colors, ratios){\n        var me = this, gradient = helpContext.createRadialGradient(x0, y0, r0, x1, y1, r1);\n        for (var i = 0, len = colors.length; i < len; i++)\n        {\n            gradient.addColorStop(ratios[i], colors[i]);\n        }\n        me.hasFill = true;\n        return me._addAction(['fillStyle', (me.fillStyle = gradient)]);\n    },\n\n    /**\n     * @language=en\n     * Begin an image filling pattern.\n     * @param {HTMLImageElement} image The Image to fill.\n     * @param {String} repetition The fill repetition style, can be one of valus:repeat, repeat-x, repeat-y, no-repeat. default valus is ''.\n     * @returns {Graphics} The Graphics Object.\n     */\n    beginBitmapFill: function(image, repetition){\n        var me = this, pattern = helpContext.createPattern(image, repetition || '');\n        me.hasFill = true;\n        return me._addAction(['fillStyle', (me.fillStyle = pattern)]);\n    },\n\n    /**\n     * @language=en\n     * Begin a new path.\n     * @returns {Graphics} The Graphics Object.\n     */\n    beginPath: function(){\n        return this._addAction(['beginPath']);\n    },\n\n    /**\n     * @language=en\n     * Close current path.\n     * @returns {Graphics} The Graphics Object.\n     */\n    closePath: function(){\n        return this._addAction(['closePath']);\n    },\n\n    /**\n     * @language=en\n     * Move current drawing point to a new point on coordinate values (x, y).\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @returns {Graphics} The Graphics Object.\n     */\n    moveTo: function(x, y){\n        return this._addAction(['moveTo', x, y]);\n    },\n\n    /**\n     * @language=en\n     * Draw a line from current point to the point on the coordinate value (x, y).\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @returns {Graphics} The Graphics Object.\n     */\n    lineTo: function(x, y){\n        return this._addAction(['lineTo', x, y]);\n    },\n\n    /**\n     * @language=en\n     * Draw a quadratic Bézier curve from current point to the point on coordinate (x, y).\n     * @param {Number} cpx The x-coordinate value of the Bézier curve control point cp.\n     * @param {Number} cpy The y-coordinate value of the Bézier curve control point cp.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @returns {Graphics} The Graphics Object.\n     */\n    quadraticCurveTo: function(cpx, cpy, x, y){\n        return this._addAction(['quadraticCurveTo', cpx, cpy, x, y]);\n    },\n\n    /**\n     * @language=en\n     * Draw a Bézier curve from current point to the point on coordinate (x, y).\n     * @param {Number} cp1x The x-coordinate value of the Bézier curve control point cp1.\n     * @param {Number} cp1y The y-coordinate value of the Bézier curve control point cp1.\n     * @param {Number} cp2x The x-coordinate value of the Bézier curve control point cp2.\n     * @param {Number} cp2y The y-coordinate value of the Bézier curve control point cp2.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @returns {Graphics} The Graphics Object.\n     */\n    bezierCurveTo: function(cp1x, cp1y, cp2x, cp2y, x, y){\n        return this._addAction(['bezierCurveTo', cp1x, cp1y, cp2x, cp2y, x, y]);\n    },\n\n    /**\n     * @language=en\n     * Draw a rectangle.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @param {Number} width The width of the rectangle.\n     * @param {Number} height The height of the rectangle.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawRect: function(x, y, width, height){\n        return this._addAction(['rect', x, y, width, height]);\n    },\n\n    /**\n     * @language=en\n     * Draw a complex rounded rectangle.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @param {Number} width The width of rounded rectangle.\n     * @param {Number} height The height of rounded rectangle.\n     * @param {Number} cornerTL The size of the rounded corner on the top-left of the rounded rectangle.\n     * @param {Number} cornerTR The size of the rounded corner on the top-right of the rounded rectangle.\n     * @param {Number} cornerBR The size of the rounded corner on the bottom-left of the rounded rectangle.\n     * @param {Number} cornerBL The size of the rounded corner on the bottom-right of the rounded rectangle.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawRoundRectComplex: function(x, y, width, height, cornerTL, cornerTR, cornerBR, cornerBL){\n        var me = this, addAction = me._addAction;\n        addAction.call(me, ['moveTo', x + cornerTL, y]);\n        addAction.call(me, ['lineTo', x + width - cornerTR, y]);\n        addAction.call(me, ['arc', x + width - cornerTR, y + cornerTR, cornerTR, -Math.PI/2, 0, false]);\n        addAction.call(me, ['lineTo', x + width, y + height - cornerBR]);\n        addAction.call(me, ['arc', x + width - cornerBR, y + height - cornerBR, cornerBR, 0, Math.PI/2, false]);\n        addAction.call(me, ['lineTo', x + cornerBL, y + height]);\n        addAction.call(me, ['arc', x + cornerBL, y + height - cornerBL, cornerBL, Math.PI/2, Math.PI, false]);\n        addAction.call(me, ['lineTo', x, y + cornerTL]);\n        addAction.call(me, ['arc', x + cornerTL, y + cornerTL, cornerTL, Math.PI, Math.PI*3/2, false]);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Draw a rounded rectangle.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @param {Number} width The width of rounded rectangle.\n     * @param {Number} height The height of rounded rectangle.\n     * @param {Number} cornerSize The size of all rounded corners.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawRoundRect: function(x, y, width, height, cornerSize){\n        return this.drawRoundRectComplex(x, y, width, height, cornerSize, cornerSize, cornerSize, cornerSize);\n    },\n\n    /**\n     * @language=en\n     * Draw a circle.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @param {Number} radius The radius of the circle.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawCircle: function(x, y, radius){\n        return this._addAction(['arc', x + radius, y + radius, radius, 0, Math.PI * 2, 0]);\n    },\n\n    /**\n     * @language=en\n     * Draw an ellipse.\n     * @param {Number} x The x-coordinate value.\n     * @param {Number} y The y-coordinate value.\n     * @param {Number} width The width of the ellipse.\n     * @param {Number} height The height of the ellipse.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawEllipse: function(x, y, width, height){\n        var me = this;\n        if(width == height) return me.drawCircle(x, y, width);\n\n        var addAction = me._addAction;\n        var w = width / 2, h = height / 2, C = 0.5522847498307933, cx = C * w, cy = C * h;\n        x = x + w;\n        y = y + h;\n\n        addAction.call(me, ['moveTo', x + w, y]);\n        addAction.call(me, ['bezierCurveTo', x + w, y - cy, x + cx, y - h, x, y - h]);\n        addAction.call(me, ['bezierCurveTo', x - cx, y - h, x - w, y - cy, x - w, y]);\n        addAction.call(me, ['bezierCurveTo', x - w, y + cy, x - cx, y + h, x, y + h]);\n        addAction.call(me, ['bezierCurveTo', x + cx, y + h, x + w, y + cy, x + w, y]);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Draw a path from the SVG data given by parameters. Not support Arcs.\n     * Demo:\n     * <p>var path = 'M250 150 L150 350 L350 350 Z';</p>\n     * <p>var shape = new Hilo.Graphics({width:500, height:500});</p>\n     * <p>shape.drawSVGPath(path).beginFill('#0ff').endFill();</p>\n     * @param {String} pathData The SVG path data to draw.\n     * @returns {Graphics} The Graphics Object.\n     */\n    drawSVGPath: function(pathData){\n        var me = this, addAction = me._addAction,\n            path = pathData.replace(/,/g, ' ').replace(/-/g, ' -').split(/(?=[a-zA-Z])/);\n        addAction.call(me, ['beginPath']);\n        var currentPoint = {x:0, y:0};\n        var lastControlPoint = {x:0, y:0};\n        var lastCmd;\n        for(var i = 0, len = path.length; i < len; i++){\n            var str = path[i];\n            if(!str.length){\n                continue;\n            }\n            var realCmd = str[0];\n            var cmd = realCmd.toUpperCase();\n            var p = this._getSVGParams(str);\n            var useRelative = cmd !== realCmd;\n\n            switch(cmd){\n                case 'M':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    addAction.call(me, ['moveTo', p[0], p[1]]);\n                    this._setCurrentPoint(currentPoint, p[0], p[1]);\n                    break;\n                case 'L':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    addAction.call(me, ['lineTo', p[0], p[1]]);\n                    this._setCurrentPoint(currentPoint, p[0], p[1]);\n                    break;\n                case 'H':\n                    if(useRelative){\n                        p[0] += currentPoint.x;\n                    }\n                    addAction.call(me, ['lineTo', p[0], currentPoint.y]);\n                    currentPoint.x = p[0];\n                    break;\n                case 'V':\n                    if(useRelative){\n                        p[0] += currentPoint.y;\n                    }\n                    addAction.call(me, ['lineTo', currentPoint.x, p[0]]);\n                    currentPoint.y = p[0];\n                    break;\n                case 'Z':\n                    addAction.call(me, ['closePath']);\n                    break;\n                case 'C':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    addAction.call(me, ['bezierCurveTo', p[0], p[1], p[2], p[3], p[4], p[5]]);\n                    lastControlPoint.x = p[2];\n                    lastControlPoint.y = p[3];\n                    this._setCurrentPoint(currentPoint, p[4], p[5]);\n                    break;\n                case 'S':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    if(lastCmd === 'C' || lastCmd === 'S'){\n                        controlPoint = this._getReflectionPoint(currentPoint, lastControlPoint);\n                    }\n                    else{\n                        controlPoint = currentPoint;\n                    }\n                    addAction.call(me, ['bezierCurveTo', controlPoint.x, controlPoint.y, p[0], p[1], p[2], p[3]]);\n                    lastControlPoint.x = p[0];\n                    lastControlPoint.y = p[1];\n                    this._setCurrentPoint(currentPoint, p[2], p[3]);\n                    break;\n                case 'Q':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    addAction.call(me, ['quadraticCurveTo', p[0], p[1], p[2], p[3]]);\n                    lastControlPoint.x = p[0];\n                    lastControlPoint.y = p[1];\n                    this._setCurrentPoint(currentPoint, p[2], p[3]);\n                    break;\n                case 'T':\n                    if(useRelative){\n                        this._convertToAbsolute(currentPoint, p);\n                    }\n                    var controlPoint;\n                    if(lastCmd === 'Q' || lastCmd === 'T'){\n                        controlPoint = this._getReflectionPoint(currentPoint, lastControlPoint);\n                    }\n                    else{\n                        controlPoint = currentPoint;\n                    }\n                    addAction.call(me, ['quadraticCurveTo', controlPoint.x, controlPoint.y, p[0], p[1]]);\n                    lastControlPoint = controlPoint;\n                    this._setCurrentPoint(currentPoint, p[0], p[1]);\n                    break;                \n            }\n            lastCmd = cmd;\n            \n        }\n        return me;\n    },\n    _getSVGParams:function(str){\n        var p = str.substring(1).replace(/[\\s]+$|^[\\s]+/g, '').split(/[\\s]+/);\n        if(p[0].length == 0) {\n            p.shift();\n        }\n        for(var i = 0, l = p.length;i < l;i ++){\n            p[i] = parseFloat(p[i]);\n        }\n        return p;\n    },\n    _convertToAbsolute:function(currentPoint, data){\n        for(var i = 0, l = data.length;i < l;i ++){\n            if(i%2 === 0){\n                data[i] += currentPoint.x;\n            }\n            else{\n                data[i] += currentPoint.y;\n            }\n        }\n    },\n    _setCurrentPoint:function(currentPoint, x, y){\n        currentPoint.x = x;\n        currentPoint.y = y;\n    },\n    _getReflectionPoint:function(centerPoint, point){\n        return {\n            x:centerPoint.x * 2 - point.x,\n            y:centerPoint.y * 2 - point.y\n        };\n    },\n\n    /**\n     * @language=en\n     * Apply all draw actions. private function.\n     * @private\n     */\n    _draw: function(context){\n        var me = this, actions = me._actions, len = actions.length, i;\n\n        context.beginPath();\n        for(i = 0; i < len; i++){\n            var action = actions[i],\n                f = action[0],\n                args = action.length > 1 ? action.slice(1) : null;\n\n            if(typeof(context[f]) == 'function') context[f].apply(context, args);\n            else context[f] = action[1];\n        }\n    },\n\n    /**\n     * @language=en\n     * Overwrite render function.\n     * @private\n     */\n    render: function(renderer, delta){\n        var me = this;\n        if(renderer.renderType === 'canvas'){\n            me._draw(renderer.context);\n        }else{\n            me.cache();\n            renderer.draw(me);\n        }\n    },\n\n    /**\n     * @language=en\n     * Clear all draw actions and reset to the initial state.\n     * @returns {Graphics} The Graphics Object.\n     */\n    clear: function(){\n        var me = this;\n\n        me._actions.length = 0;\n        me.lineWidth = 1;\n        me.lineAlpha = 1;\n        me.lineCap = null;\n        me.lineJoin = null;\n        me.miterLimit = 10;\n        me.hasStroke = false;\n        me.strokeStyle = '0';\n        me.hasFill = false;\n        me.fillStyle = '0';\n        me.fillAlpha = 1;\n\n        me.setCacheDirty(true);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Add a draw action, this is a private function.\n     * @private\n     */\n    _addAction: function(action){\n        var me = this;\n        me._actions.push(action);\n        return me;\n    }\n\n});\n\n})();\n\nwindow.Hilo.Graphics = Graphics;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar Hilo = window.Hilo;var View = window.Hilo.View;\nvar CacheMixin = window.Hilo.CacheMixin;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Text.html?noHeader' width = '320' height = '240' scrolling='no'></iframe>\n * <br/>\n * @class Text class provide basic text-display function, use DOMElement for complex text-display.\n * @augments View\n * @mixes CacheMixin\n * @borrows CacheMixin#cache as #cache\n * @borrows CacheMixin#updateCache as #updateCache\n * @borrows CacheMixin#setCacheDirty as #setCacheDirty\n * @param {Object} properties Properties parameters for the object. Includes all writable properties.\n * @module hilo/view/Text\n * @requires hilo/core/Class\n * @requires hilo/core/Hilo\n * @requires hilo/view/View\n * @requires hilo/view/CacheMixin\n * @property {String} text Text to display.\n * @property {String} color Color of the text.\n * @property {String} textAlign Horizontal alignment way of the text. May be one of the following value:'start', 'end', 'left', 'right', and 'center'. Note:Need to specify the width property of the text to take effect\n * @property {String} textVAlign Vertical alignment way of the text. May be one of the following value:'top', 'middle', 'bottom'. Note:Need to specify the height property of the text to take effect.\n * @property {Boolean} outline Draw the outline of the text or fill the text.\n * @property {Number} lineSpacing The spacing between lines. Measured in px, default value is 0.\n * @property {Number} maxWidth The max length of the text, default value is 200.\n * @property {String} font Text's CSS font style, readonly! Use setFont function to set text font.\n * @property {Number} textWidth Width of the text, readonly! Works only on canvas mode.\n * @property {Number} textHeight Height of the text, readonly! Works only on canvas mode.\n */\nvar Text = Class.create(/** @lends Text.prototype */{\n    Extends: View,\n    Mixes:CacheMixin,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid('Text');\n        Text.superclass.constructor.call(this, properties);\n\n        // if(!properties.width) this.width = 200; //default width\n        if(!properties.font) this.font = '12px arial'; //default font style\n        this._fontHeight = Text.measureFontHeight(this.font);\n    },\n\n    text: '',\n    color: '#000',\n    textAlign: null,\n    textVAlign: null,\n    outline: false,\n    lineSpacing: 0,\n    maxWidth: 200,\n    font: null, //ready-only\n    textWidth: 0, //read-only\n    textHeight: 0, //read-only\n\n    /**\n     * @language=en\n     * Set text CSS font style.\n     * @param {String} font Text CSS font style to set.\n     * @returns {Text} the Text object, chained call supported.\n     */\n    setFont: function(font){\n        var me = this;\n        if(me.font !== font){\n            me.font = font;\n            me._fontHeight = Text.measureFontHeight(font);\n        }\n\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Overwrite render function.\n     * @private\n     */\n    render: function(renderer, delta){\n        var me = this;\n\n        if(renderer.renderType === 'canvas'){\n            if(this.drawable){\n                renderer.draw(me);\n            }\n            else{\n                me._draw(renderer.context);\n            }\n        }\n        else if(renderer.renderType === 'dom'){\n            var drawable = me.drawable;\n            var domElement = drawable.domElement;\n            var style = domElement.style;\n\n            style.font = me.font;\n            style.textAlign = me.textAlign;\n            style.color = me.color;\n            style.width = me.width + 'px';\n            style.height = me.height + 'px';\n            style.lineHeight = (me._fontHeight + me.lineSpacing) + 'px';\n\n            domElement.innerHTML = me.text;\n            renderer.draw(this);\n        }\n        else{\n            //TODO:自动更新cache  TODO:auto update cache\n            me.cache();\n            renderer.draw(me);\n        }\n    },\n\n    /**\n     * @language=en\n     * Draw text under the assigned render context.\n     * @private\n     */\n    _draw: function(context){\n        var me = this, text = me.text.toString();\n        if(!text) return;\n\n        //set drawing style\n        context.font = me.font;\n        context.textAlign = me.textAlign;\n        context.textBaseline = 'top';\n\n        //find and draw all explicit lines\n        var lines = text.split(/\\r\\n|\\r|\\n|<br(?:[ \\/])*>/);\n        var width = 0, height = 0;\n        var lineHeight = me._fontHeight + me.lineSpacing;\n        var i, line, w, len, wlen;\n        var drawLines = [];\n\n        for(i = 0, len = lines.length; i < len; i++){\n            line = lines[i];\n            w = context.measureText(line).width;\n\n            //check if the line need to split\n            if(w <= me.maxWidth){\n                drawLines.push({text:line, y:height});\n                // me._drawTextLine(context, line, height);\n                if(width < w) width = w;\n                height += lineHeight;\n                continue;\n            }\n\n            var str = '', oldWidth = 0, newWidth, j, word;\n\n            for(j = 0, wlen = line.length; j < wlen; j++){\n                word = line[j];\n                newWidth = context.measureText(str + word).width;\n\n                if(newWidth > me.maxWidth){\n                    drawLines.push({text:str, y:height});\n                    // me._drawTextLine(context, str, height);\n                    if(width < oldWidth) width = oldWidth;\n                    height += lineHeight;\n                    str = word;\n                }else{\n                    oldWidth = newWidth;\n                    str += word;\n                }\n\n                if(j == wlen - 1){\n                    drawLines.push({text:str, y:height});\n                    // me._drawTextLine(context, str, height);\n                    if(str !== word && width < newWidth) width = newWidth;\n                    height += lineHeight;\n                }\n            }\n        }\n\n        me.textWidth = width;\n        me.textHeight = height;\n        if(!me.width) me.width = width;\n        if(!me.height) me.height = height;\n\n        //vertical alignment\n        var startY = 0;\n        switch(me.textVAlign){\n            case 'middle':\n                startY = me.height - me.textHeight >> 1;\n                break;\n            case 'bottom':\n                startY = me.height - me.textHeight;\n                break;\n        }\n\n        //draw background\n        var bg = me.background;\n        if(bg){\n            context.fillStyle = bg;\n            context.fillRect(0, 0, me.width, me.height);\n        }\n\n        if(me.outline) context.strokeStyle = me.color;\n        else context.fillStyle = me.color;\n\n        //draw text lines\n        for(i = 0; i < drawLines.length; i++){\n            line = drawLines[i];\n            me._drawTextLine(context, line.text, startY + line.y);\n        }\n    },\n\n    /**\n     * @language=en\n     * Draw a line of text under the assigned render context.\n     * @private\n     */\n    _drawTextLine: function(context, text, y){\n        var me = this, x = 0, width = me.width;\n\n        switch(me.textAlign){\n            case 'center':\n                x = width >> 1;\n                break;\n            case 'right':\n            case 'end':\n                x = width;\n                break;\n        }\n\n        if(me.outline) context.strokeText(text, x, y);\n        else context.fillText(text, x, y);\n    },\n\n    Statics: /** @lends Text */{\n        /**\n         * @language=en\n         * Measure the line height of the assigned text font style.\n         * @param {String} font Font style to measure.\n         * @return {Number} Return line height of the assigned font style.\n         */\n        measureFontHeight: function(font){\n            var docElement = document.documentElement, fontHeight;\n            var elem = Hilo.createElement('div', {style:{font:font, position:'absolute'}, innerHTML:'M'});\n\n            docElement.appendChild(elem);\n            fontHeight = elem.offsetHeight;\n            docElement.removeChild(elem);\n            return fontHeight;\n        }\n    }\n\n});\n\nwindow.Hilo.Text = Text;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar Hilo = window.Hilo;var Container = window.Hilo.Container;\nvar Bitmap = window.Hilo.Bitmap;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/BitmapText.html?noHeader' width = '550' height = '80' scrolling='no'></iframe>\n * <br/>\n * @class BitmapText  support bitmap text function ,but only support single-line text\n * @augments Container\n * @param {Object} properties the options of create Instance.It can contains all writable property\n * @module hilo/view/BitmapText\n * @requires hilo/core/Class\n * @requires hilo/core/Hilo\n * @requires hilo/view/Container\n * @requires hilo/view/Bitmap\n * @property {Object} glyphs font glyph set of bitmap. format:{letter:{image:img, rect:[0,0,100,100]}}\n * @property {Number} letterSpacing spacing of letter. default:0\n * @property {String} text content of bitmap text. Not writable,set this value by 'setText'\n * @property {String} textAlign property values:left、center、right, default:left,Not writable,set this property by 'setTextAlign'\n */\nvar BitmapText = Class.create(/** @lends BitmapText.prototype */{\n    Extends: Container,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid('BitmapText');\n        BitmapText.superclass.constructor.call(this, properties);\n\n        var text = properties.text + '';\n        if(text){\n            this.text = '';\n            this.setText(text);\n        }\n\n        this.pointerChildren = false; //disable user events for single letters\n    },\n\n    glyphs: null,\n    letterSpacing: 0,\n    text: '',\n    textAlign:'left',\n\n    /**\n     * @language=en\n     * set the content of bitmap text\n     * @param {String} text content\n     * @returns {BitmapText} BitmapText Instance,support chained calls\n     */\n    setText: function(text){\n        var me = this, str = text.toString(), len = str.length;\n        if(me.text == str) return;\n        me.text = str;\n\n        var i, charStr, charGlyph, charObj, width = 0, height = 0, left = 0;\n        for(i = 0; i < len; i++){\n            charStr = str.charAt(i);\n            charGlyph = me.glyphs[charStr];\n            if(charGlyph){\n                left = width + (width > 0 ? me.letterSpacing : 0);\n                if(me.children[i]){\n                    charObj = me.children[i];\n                    charObj.setImage(charGlyph.image, charGlyph.rect);\n                }\n                else{\n                    charObj = me._createBitmap(charGlyph);\n                    me.addChild(charObj);\n                }\n                charObj.x = left;\n                width = left + charGlyph.rect[2];\n                height = Math.max(height, charGlyph.rect[3]);\n            }\n        }\n\n        for(i = me.children.length - 1;i >= len;i --){\n            me._releaseBitmap(me.children[i]);\n            me.children[i].removeFromParent();\n        }\n\n        me.width = width;\n        me.height = height;\n        this.setTextAlign();\n        return me;\n    },\n    _createBitmap:function(cfg){\n        var bmp;\n        if(BitmapText._pool.length){\n            bmp = BitmapText._pool.pop();\n            bmp.setImage(cfg.image, cfg.rect);\n        }\n        else{\n            bmp = new Bitmap({\n                image:cfg.image,\n                rect:cfg.rect\n            });\n        }\n        return bmp;\n    },\n    _releaseBitmap:function(bmp){\n        BitmapText._pool.push(bmp);\n    },\n\n     /**\n      * @language=en\n      * set the textAlign of text。\n     * @param textAlign value of textAlign:left、center、right\n     * @returns {BitmapText} itmapText Instance,support chained calls\n     */\n    setTextAlign:function(textAlign){\n        this.textAlign = textAlign||this.textAlign;\n        switch(this.textAlign){\n            case \"center\":\n                this.pivotX = this.width * .5;\n                break;\n            case \"right\":\n                this.pivotX = this.width;\n                break;\n            case \"left\":\n                /* falls through */\n            default:\n                this.pivotX = 0;\n                break;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * detect whether can display the string by the currently assigned font provided\n     * @param {String} str to detect string\n     * @returns {Boolean} whether can display the string\n     */\n    hasGlyphs: function(str){\n        var glyphs = this.glyphs;\n        if(!glyphs) return false;\n\n        str = str.toString();\n        var len = str.length, i;\n        for(i = 0; i < len; i++){\n            if(!glyphs[str.charAt(i)]) return false;\n        }\n        return true;\n    },\n\n    Statics:/** @lends BitmapText */{\n        _pool:[],\n        /**\n         * @language=en\n         * easy way to generate a collection of glyphs\n         * @static\n         * @param {String} text character text.\n         * @param {Image} image character image.\n         * @param {Number} col default:the length of string\n         * @param {Number} row default:1\n         * @returns {BitmapText} BitmapText对象本身。链式调用支持。\n         */\n        createGlyphs:function(text, image, col, row){\n            var str = text.toString();\n            col = col||str.length;\n            row = row||1;\n            var w = image.width/col;\n            var h = image.height/row;\n            var glyphs = {};\n            for(var i = 0, l = text.length;i < l;i ++){\n                var charStr = str.charAt(i);\n                glyphs[charStr] = {\n                    image:image,\n                    rect:[w * (i % col), h * Math.floor(i / col), w, h]\n                };\n            }\n            return glyphs;\n        }\n    }\n\n});\n\nwindow.Hilo.BitmapText = BitmapText;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar Drawable = window.Hilo.Drawable;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Button.html?noHeader' width = '320' height = '170' scrolling='no'></iframe>\n * <br/>\n * demo:\n * <pre>\n * var btn = new Hilo.Button({\n *     image: buttonImage,\n *     upState: {rect:[0, 0, 64, 64]},\n *     overState: {rect:[64, 0, 64, 64]},\n *     downState: {rect:[128, 0, 64, 64]},\n *     disabledState: {rect:[192, 0, 64, 64]}\n * });\n * </pre>\n * @class Button class is a simple button class, contains four kinds of state: 'up', 'over', 'down', 'disabled'\n * @augments View\n * @param {Object} properties create object properties. Contains all writable properties. Also contains:\n * <ul>\n * <li><b>image</b> - the image element that button image is in</li>\n * </ul>\n * @module hilo/view/Button\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/Drawable\n * @requires hilo/util/util\n * @property {Object} upState The property of button 'up' state or collections of its drawable properties.\n * @property {Object} overState The property of button 'over' state or collections of its drawable properties.\n * @property {Object} downState The property of button 'down' state or collections of its drawable properties.\n * @property {Object} disabledState The property of button 'disabled' state or collections of its drawable properties.\n * @property {String} state the state name of button, could be one of Button.UP|OVER|DOWN|DISABLED, readonly!\n * @property {Boolean} enabled Is button enabled. default value is true, readonly!\n * @property {Boolean} useHandCursor If true, cursor over the button will become a pointer cursor, default value is true.\n */\n var Button = Class.create(/** @lends Button.prototype */{\n    Extends: View,\n    constructor: function(properties){\n        properties = properties || {};\n        this.id = this.id || properties.id || Hilo.getUid(\"Button\");\n        Button.superclass.constructor.call(this, properties);\n\n        this.drawable = new Drawable(properties);\n        this.setState(Button.UP);\n    },\n\n    upState: null,\n    overState: null,\n    downState: null,\n    disabledState: null,\n\n    state: null,\n    enabled: true,\n    useHandCursor: true,\n\n    /**\n     * @language=en\n     * Set whether the button is enabled.\n     * @param {Boolean} enabled Show whether the button is enabled.\n     * @returns {Button} Return the button itself.\n     */\n    setEnabled: function(enabled){\n        if(this.enabled != enabled){\n            if(!enabled){\n                this.setState(Button.DISABLED);\n            }else{\n                this.setState(Button.UP);\n            }\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set the state of the button. Invoke inside the Button and may not be used.\n     * @param {String} state New state of the button.\n     * @returns {Button} Return the button itself.\n     */\n    setState: function(state){\n        if(this.state !== state){\n            this.state = state;\n            this.pointerEnabled = this.enabled = state !== Button.DISABLED;\n\n            var stateObj;\n            switch(state){\n                case Button.UP:\n                    stateObj = this.upState;\n                    break;\n                case Button.OVER:\n                    stateObj = this.overState;\n                    break;\n                case Button.DOWN:\n                    stateObj = this.downState;\n                    break;\n                case Button.DISABLED:\n                    stateObj = this.disabledState;\n                    break;\n            }\n\n            if(stateObj){\n                this.drawable.init(stateObj);\n                util.copy(this, stateObj, true);\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * @language=en\n     * overwrite\n     * @private\n     */\n    fire: function(type, detail){\n        if(!this.enabled) return;\n\n        var evtType = typeof type === 'string' ? type : type.type;\n        switch(evtType){\n            case 'mousedown':\n            case 'touchstart':\n            case 'touchmove':\n                this.setState(Button.DOWN);\n                break;\n            case \"mouseover\":\n                this.setState(Button.OVER);\n                break;\n            case 'mouseup':\n                if(this.overState) this.setState(Button.OVER);\n                else if(this.upState) this.setState(Button.UP);\n                break;\n            case 'touchend':\n            case 'touchout':\n            case 'mouseout':\n                this.setState(Button.UP);\n                break;\n        }\n\n        return Button.superclass.fire.call(this, type, detail);\n    },\n\n    Statics: /** @lends Button */ {\n        /**\n         * @language=en\n         * Statics value of Button's 'up' state.\n         * @type String\n         */\n        UP: 'up',\n        /**\n         * @language=en\n         * Statics value of Button's 'over' state.\n         * @type String\n         */\n        OVER: 'over',\n        /**\n         * @language=en\n         * Statics value of Button's 'down' state.\n         * @type String\n         */\n        DOWN: 'down',\n        /**\n         * @language=en\n         * Statics value of Button's 'disabled' state.\n         * @type String\n         */\n        DISABLED: 'disabled'\n    }\n });\nwindow.Hilo.Button = Button;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * @class TextureAtlas纹理集是将许多小的纹理图片整合到一起的一张大图。这个类可根据一个纹理集数据读取纹理小图、精灵动画等。\n * @param {Object} atlasData 纹理集数据。它可包含如下数据：\n * <ul>\n * <li><b>image</b> - 纹理集图片。必需。</li>\n * <li><b>width</b> - 纹理集图片宽度。若frames数据为Object时，此属性必需。</li>\n * <li><b>height</b> - 纹理集图片高度。若frames数据为Object时，此属性必需。</li>\n * <li><b>frames</b> - 纹理集帧数据，可以是Array或Object。必需。\n * <ul>\n * <li>若为Array，则每项均为一个纹理图片帧数据，如：[[0, 0, 50, 50], [0, 50, 50, 50]。</li>\n * <li>若为Object，则需包含frameWidth(帧宽)、frameHeight(帧高)、numFrames(帧数) 属性。</li>\n * </ul>\n * </li>\n * <li><b>sprites</b> - 纹理集精灵动画定义，其每个值均定义一个精灵。为Object对象。可选。\n * <ul>\n * <li>若为Number，即此精灵只包含一帧，此帧为帧数据中索引为当前值的帧。如：sprites:{'foo':1}。</li>\n * <li>若为Array，则每项均为一个帧的索引值。如：sprites:{'foo':[0, 1, 2, 3]}。</li>\n * <li>若为Object，则需包含from(起始帧索引值)、to(末帧索引值) 属性。</li>\n * </ul>\n * </li>\n * </ul>\n * @module hilo/util/TextureAtlas\n * @requires hilo/core/Class\n */\nvar TextureAtlas = (function(){\n\nreturn Class.create(/** @lends TextureAtlas.prototype */{\n    constructor: function(atlasData){\n        this._frames = parseTextureFrames(atlasData);\n        this._sprites = parseTextureSprites(atlasData, this._frames);\n    },\n\n    _frames: null,\n    _sprites: null,\n\n    /**\n     * @language=en\n     * 获取指定索引位置index的帧数据。\n     * @param {Int} index 要获取帧的索引位置。\n     * @returns {Object} 帧数据。\n     */\n    getFrame: function(index){\n        var frames = this._frames;\n        return frames && frames[index];\n    },\n\n    /**\n     * @language=en\n     * 获取指定id的精灵数据。\n     * @param {String} id 要获取精灵的id。\n     * @returns {Object} 精灵数据。\n     */\n    getSprite: function(id){\n        var sprites = this._sprites;\n        return sprites && sprites[id];\n    },\n\n    Statics: /** @lends TextureAtlas */ {\n        /**\n         * @language=en\n         * Shorthand method to create spirte frames\n         * @param {String|Array} name Name of one animation|a group of animation\n         * @param {String} frames Frames message, eg:\"0-5\" means frame 0 to frame 5.\n         * @param {Number} w The width of each frame.\n         * @param {Number} h The height of each frame.\n         * @param {Boolean} loop Is play in loop.\n         * @param {Number} duration The time between each frame. default value is 1 (Frame), but if timeBased is true, default value will be duration(milli-second).\n         * @example\n         *  //demo1 make one animation\n         *  createSpriteFrames(\"walk\", \"0-5,8,9\", meImg, 55, 88, true, 1);\n         *  //demo2 make a group of animation\n         *  createSpriteFrames([\n         *    [\"walk\", \"0-5,8,9\", meImg, 55, 88, true, 1],\n         *    [\"jump\", \"0-5\", meImg, 55, 88, false, 1]\n         *  ]);\n        */\n        createSpriteFrames:function(name, frames, img, w, h, loop, duration){\n            var i, l;\n            if(Object.prototype.toString.call(name) === \"[object Array]\"){\n                var res = [];\n                for(i = 0, l = name.length;i < l;i ++){\n                    res = res.concat(this.createSpriteFrames.apply(this, name[i]));\n                }\n                return res;\n            }\n            else{\n                if(typeof(frames) === \"string\"){\n                    var all = frames.split(\",\");\n                    frames = [];\n                    for(var j = 0, jl = all.length;j < jl;j ++){\n                        var temp = all[j].split(\"-\");\n                        if(temp.length == 1){\n                            frames.push(parseInt(temp[0]));\n                        }\n                        else{\n                            for(i = parseInt(temp[0]), l = parseInt(temp[1]);i <= l;i ++){\n                                frames.push(i);\n                            }\n                        }\n                    }\n                }\n\n                var col = Math.floor(img.width/w);\n                for(i = 0;i < frames.length;i ++){\n                    var n = frames[i];\n                    frames[i] = {\n                        rect:[w*(n%col), h*Math.floor(n/col), w, h],\n                        image:img,\n                        duration:duration\n                    };\n                }\n                frames[0].name = name;\n                if(loop){\n                    frames[frames.length-1].next = name;\n                }\n                else{\n                    frames[frames.length-1].stop = true;\n                }\n                return frames;\n            }\n        }\n    }\n});\n\n/**\n * @language=en\n * Parse texture frames\n * @private\n */\nfunction parseTextureFrames(atlasData){\n    var i, len;\n    var frameData = atlasData.frames;\n    if(!frameData) return null;\n\n    var frames = [], obj;\n\n    if(frameData instanceof Array){ //frames by array\n        for(i = 0, len = frameData.length; i < len; i++){\n            obj = frameData[i];\n            frames[i] = {\n                image: atlasData.image,\n                rect: obj\n            };\n        }\n    }else{ //frames by object\n        var frameWidth = frameData.frameWidth;\n        var frameHeight = frameData.frameHeight;\n        var cols = atlasData.width / frameWidth | 0;\n        var rows = atlasData.height / frameHeight | 0;\n        var numFrames = frameData.numFrames || cols * rows;\n        for(i = 0; i < numFrames; i++){\n            frames[i] = {\n                image: atlasData.image,\n                rect: [i%cols*frameWidth, (i/cols|0)*frameHeight, frameWidth, frameHeight]\n            };\n        }\n    }\n\n    return frames;\n}\n\n/**\n * @language=en\n * Parse texture sprites\n * @private\n */\nfunction parseTextureSprites(atlasData, frames){\n    var i, len;\n    var spriteData = atlasData.sprites;\n    if(!spriteData) return null;\n\n    var sprites = {}, sprite, spriteFrames, spriteFrame;\n\n    for(var s in spriteData){\n        sprite = spriteData[s];\n        if(isNumber(sprite)){ //single frame\n            spriteFrames = translateSpriteFrame(frames[sprite]);\n        }else if(sprite instanceof Array){ //frames by array\n            spriteFrames = [];\n            for(i = 0, len = sprite.length; i < len; i++){\n                var spriteObj = sprite[i], frameObj;\n                if(isNumber(spriteObj)){\n                    spriteFrame = translateSpriteFrame(frames[spriteObj]);\n                }else{\n                    frameObj = spriteObj.rect;\n                    if(isNumber(frameObj)) frameObj = frames[spriteObj.rect];\n                    spriteFrame = translateSpriteFrame(frameObj, spriteObj);\n                }\n                spriteFrames[i] = spriteFrame;\n            }\n        }else{ //frames by object\n            spriteFrames = [];\n            for(i = sprite.from; i <= sprite.to; i++){\n                spriteFrames[i - sprite.from] = translateSpriteFrame(frames[i], sprite[i]);\n            }\n        }\n        sprites[s] = spriteFrames;\n    }\n\n    return sprites;\n}\n\nfunction translateSpriteFrame(frameObj, spriteObj){\n    var spriteFrame = {\n        image: frameObj.image,\n        rect: frameObj.rect\n    };\n\n    if(spriteObj){\n        spriteFrame.name = spriteObj.name || null;\n        spriteFrame.duration = spriteObj.duration || 0;\n        spriteFrame.stop = !!spriteObj.stop;\n        spriteFrame.next = spriteObj.next || null;\n    }\n\n    return spriteFrame;\n}\n\nfunction isNumber(value){\n    return typeof value === 'number';\n}\n\n})();\nwindow.Hilo.TextureAtlas = TextureAtlas;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar browser = window.Hilo.browser;\n\n\n/**\n * @language=en\n * @class Ticker is a Timer. It can run the code at specified framerate.\n * @param {Number} fps The fps of ticker.Default is 60.\n * @module hilo/util/Ticker\n * @requires hilo/core/Class\n * @requires hilo/util/browser\n */\nvar Ticker = Class.create(/** @lends Ticker.prototype */{\n    constructor: function(fps){\n        this._targetFPS = fps || 60;\n        this._interval = 1000 / this._targetFPS;\n        this._tickers = [];\n    },\n\n    _paused: false,\n    _targetFPS: 0,\n    _interval: 0,\n    _intervalId: null,\n    _tickers: null,\n    _lastTime: 0,\n    _tickCount: 0,\n    _tickTime: 0,\n    _measuredFPS: 0,\n\n    /**\n     * @language=en\n     * Start the ticker.\n     * @param {Boolean} userRAF Whether or not use requestAnimationFrame, default is true.\n     */\n    start: function(useRAF){\n        if(useRAF === undefined){\n            useRAF = true;\n        }\n        \n        if(this._intervalId) return;\n        this._lastTime = +new Date();\n\n        var self = this, interval = this._interval,\n            raf = window.requestAnimationFrame ||\n                  window[browser.jsVendor + 'RequestAnimationFrame'];\n\n        var runLoop;\n        if(useRAF && raf && interval < 17){\n            this._useRAF = true;\n            runLoop = function(){\n                self._intervalId = raf(runLoop);\n                self._tick();\n            };\n        }else{\n            runLoop = function(){\n                self._intervalId = setTimeout(runLoop, interval);\n                self._tick();\n            };\n        }\n\n        this._paused = false;\n        runLoop();\n    },\n\n    /**\n     * @language=en\n     * Stop the ticker.\n     */\n    stop: function(){\n        if(this._useRAF){\n            var cancelRAF = window.cancelAnimationFrame ||\n                  window[browser.jsVendor + 'CancelAnimationFrame'];\n            cancelRAF(this._intervalId);\n        }\n        else{\n            clearTimeout(this._intervalId);\n        }\n        this._intervalId = null;\n        this._lastTime = 0;\n        this._paused = true;\n    },\n\n    /**\n     * @language=en\n     * Pause the ticker.\n     */\n    pause: function(){\n        this._paused = true;\n    },\n\n    /**\n     * @language=en\n     * Resume the ticker.\n     */\n    resume: function(){\n        this._paused = false;\n    },\n\n    /**\n     * @private\n     */\n    _tick: function(){\n        if(this._paused) return;\n        var startTime = +new Date(),\n            deltaTime = startTime - this._lastTime,\n            tickers = this._tickers;\n\n        //calculates the real fps\n        if(++this._tickCount >= this._targetFPS){\n            this._measuredFPS = 1000 / (this._tickTime / this._tickCount) + 0.5 >> 0;\n            this._tickCount = 0;\n            this._tickTime = 0;\n        }else{\n            this._tickTime += startTime - this._lastTime;\n        }\n        this._lastTime = startTime;\n\n        var tickersCopy = tickers.slice(0);\n        for(var i = 0, len = tickersCopy.length; i < len; i++){\n            tickersCopy[i].tick(deltaTime);\n        }\n    },\n\n    /**\n     * @language=en\n     * Get the fps.\n     */\n    getMeasuredFPS: function(){\n        return Math.min(this._measuredFPS, this._targetFPS);\n    },\n\n    /**\n     * @language=en\n     * Add tickObject. The tickObject must implement the tick method.\n     * @param {Object} tickObject The tickObject to add.It must implement the tick method.\n     */\n    addTick: function(tickObject){\n        if(!tickObject || typeof(tickObject.tick) != 'function'){\n            throw new Error('Ticker: The tick object must implement the tick method.');\n        }\n        this._tickers.push(tickObject);\n    },\n\n    /**\n     * @language=en\n     * Remove the tickObject\n     * @param {Object} tickObject The tickObject to remove.\n     */\n    removeTick: function(tickObject){\n        var tickers = this._tickers,\n            index = tickers.indexOf(tickObject);\n        if(index >= 0){\n            tickers.splice(index, 1);\n        }\n    },\n    /**\n     * 下次tick时回调\n     * @param  {Function} callback\n     * @return {tickObj}\n     */\n    nextTick:function(callback){\n        var that = this;\n        var tickObj = {\n            tick:function(dt){\n                that.removeTick(tickObj);\n                callback();\n            }\n        };\n\n        that.addTick(tickObj);\n        return tickObj;\n    },\n    /**\n     * 延迟指定的时间后调用回调, 类似setTimeout\n     * @param  {Function} callback\n     * @param  {Number}   duration 延迟的毫秒数\n     * @return {tickObj}\n     */\n    timeout:function(callback, duration){\n        var that = this;\n        var targetTime = new Date().getTime() + duration;\n        var tickObj = {\n            tick:function(){\n                var nowTime = new Date().getTime();\n                var dt = nowTime - targetTime;\n                if(dt >= 0){\n                    that.removeTick(tickObj);\n                    callback();\n                }\n            }\n        };\n        that.addTick(tickObj);\n        return tickObj;\n    },\n    /**\n     * 指定的时间周期来调用函数, 类似setInterval\n     * @param  {Function} callback\n     * @param  {Number}   duration 时间周期，单位毫秒\n     * @return {tickObj}\n     */\n    interval:function(callback, duration){\n        var that = this;\n        var targetTime = new Date().getTime() + duration;\n        var tickObj = {\n            tick:function(){\n                var nowTime = new Date().getTime();\n                var dt = nowTime - targetTime;\n                if(dt >= 0){\n                    if(dt < duration){\n                        nowTime -= dt;\n                    }\n                    targetTime = nowTime + duration;\n                    callback();\n                }\n            }\n        };\n        that.addTick(tickObj);\n        return tickObj;\n    }\n});\nwindow.Hilo.Ticker = Ticker;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\n\n\nvar arrayProto = Array.prototype,\n    slice = arrayProto.slice;\n\n//polyfiil for Array.prototype.indexOf\nif (!arrayProto.indexOf) {\n    arrayProto.indexOf = function(elem, fromIndex){\n        fromIndex = fromIndex || 0;\n        var len = this.length, i;\n        if(len == 0 || fromIndex >= len) return -1;\n        if(fromIndex < 0) fromIndex = len + fromIndex;\n        for(i = fromIndex; i < len; i++){\n            if(this[i] === elem) return i;\n        }\n        return -1;\n    };\n}\n\nvar fnProto = Function.prototype;\n\n//polyfill for Function.prototype.bind\nif (!fnProto.bind) {\n    fnProto.bind = function(thisArg){\n        var target = this,\n            boundArgs = slice.call(arguments, 1),\n            F = function(){};\n\n        function bound(){\n            var args = boundArgs.concat(slice.call(arguments));\n            return target.apply(this instanceof bound ? this : thisArg, args);\n        }\n\n        F.prototype = target.prototype;\n        bound.prototype = new F();\n\n        return bound;\n    };\n}\nwindow.Hilo.undefined = undefined;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;\n\n/**\n * @language=en\n * <iframe src='../../../examples/drag.html?noHeader' width = '550' height = '250' scrolling='no'></iframe>\n * <br/>\n * example:\n * <pre>\n * var bmp = new Bitmap({image:img});\n * Hilo.util.copy(bmp, Hilo.drag);\n * bmp.startDrag([0, 0, 550, 400]);\n * </pre>\n * @class drag A mixin that contains drag method.You can mix drag method to the visual target by use Class.mix(target, drag) or Hilo.util.copy(target, drag).\n * @mixin\n * @static\n * @module hilo/util/drag\n * @requires hilo/core/Hilo\n */\nvar drag = {\n    _isDragStart:false,\n    /**\n     * 是否需要 transform，父元素有 transform 时需要设置为true\n     * @default false\n     * @type {Boolean}\n     */\n    dragNeedTransform:false,\n    /**\n     * @language=en\n     * start drag.\n      * @param {Array} bounds The bounds area that the view can move, relative to the coordinates of the view's parent, [x, y, width, height]， default is no limit.\n    */\n    startDrag:function(bounds){\n        var that = this;\n        \n        if(that._isDragStart){\n            that.stopDrag();\n        }\n        that._isDragStart = true;\n\n        var stage;\n        bounds = bounds||[-Infinity, -Infinity, Infinity, Infinity];\n        var mouse = {\n            x:0,\n            y:0,\n            preX:0,\n            preY:0\n        };\n        var minX = bounds[0];\n        var minY = bounds[1];\n        var maxX = bounds[2] == Infinity?Infinity:minX + bounds[2];\n        var maxY = bounds[3] == Infinity?Infinity:minY + bounds[3];\n\n        var worldPoint = {\n            x:0, \n            y:0\n        };\n\n        function onStart(e){\n            e.stopPropagation();\n            updateMouse(e);\n            that.off(Hilo.event.POINTER_START, onStart);\n\n            worldPoint.x = that.x;\n            worldPoint.y = that.y;\n            \n            if(that.dragNeedTransform && that.parent){\n                that.parent.getConcatenatedMatrix().transformPoint(worldPoint);\n            }\n\n            that.__dragX = worldPoint.x - mouse.x;\n            that.__dragY = worldPoint.y - mouse.y;\n\n            if(!stage){\n                stage = that.getStage();\n            }\n            stage.on(Hilo.event.POINTER_MOVE, onMove);\n            document.addEventListener(Hilo.event.POINTER_END, onStop);\n            that.fire(\"dragStart\", mouse);\n        }\n\n        function onStop(e){\n            document.removeEventListener(Hilo.event.POINTER_END, onStop);\n            stage && stage.off(Hilo.event.POINTER_MOVE, onMove);\n\n            that.on(Hilo.event.POINTER_START, onStart);\n            that.fire(\"dragEnd\", mouse);\n        }\n\n        function onMove(e){\n            updateMouse(e);\n\n            worldPoint.x = mouse.x + that.__dragX;\n            worldPoint.y = mouse.y + that.__dragY;\n\n            if(that.dragNeedTransform && that.parent){\n                that.parent.getConcatenatedMatrix().invert().transformPoint(worldPoint);\n            }\n\n            that.x = Math.max(minX, Math.min(maxX, worldPoint.x));\n            that.y = Math.max(minY, Math.min(maxY, worldPoint.y));\n            that.fire(\"dragMove\", mouse);\n        }\n\n        function updateMouse(e){\n            mouse.preX = mouse.x;\n            mouse.preY = mouse.y;\n            mouse.x = e.stageX;\n            mouse.y = e.stageY;\n        }\n\n        function stopDrag(){\n            that._isDragStart = false;\n            document.removeEventListener(Hilo.event.POINTER_END, onStop);\n            stage && stage.off(Hilo.event.POINTER_MOVE, onMove);\n            that.off(Hilo.event.POINTER_START, onStart);\n        }\n        that.on(Hilo.event.POINTER_START, onStart);\n\n        that.stopDrag = stopDrag;\n    },\n    /**\n     * @language=en\n     * stop drag.\n    */\n    stopDrag:function(){\n        this._isDragStart = false;\n    }\n};\nwindow.Hilo.drag = drag;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/Tween.html?noHeader' width = '550' height = '130' scrolling='no'></iframe>\n * <br/>\n * Demo:\n * <pre>\n * ticker.addTick(Hilo.Tween);//Tween works after being added to ticker\n *\n * var view = new View({x:5, y:10});\n * Hilo.Tween.to(view, {\n *     x:100,\n *     y:20,\n *     alpha:0\n * }, {\n *     duration:1000,\n *     delay:500,\n *     ease:Hilo.Ease.Quad.EaseIn,\n *     onComplete:function(){\n *         console.log('complete');\n *     }\n * });\n * </pre>\n * @class Tween class makes tweening (easing, slow motion).\n * @param {Object} target Tween target object.\n * @param {Object} fromProps Beginning properties of target tweening object.\n * @param {Object} toProps Ending properties of target tweening object.\n * @param {Object} params Tweening parameters, include all writable Tween class properties.\n * @module hilo/tween/Tween\n * @requires hilo/core/Class\n * @property {Object} target Tween target object, readonly!\n * @property {Int} duration Tweening duration, measure in ms.\n * @property {Int} delay Tweenning delay time, measure in ms.\n * @property {Boolean} paused Is tweening paused, default value is false.\n * @property {Boolean} loop Does tweening loop, default value is false.\n * @property {Boolean} reverse Does tweening reverse, default value is false.\n * @property {Int} repeat Repeat times of tweening, default value is 0.\n * @property {Int} repeatDelay Delay time of repeating tweening, measure in ms.\n * @property {Function} ease Tweening transform function, default value is null.\n * @property {Int} time Time that tweening taken, measure in ms, readonly!\n * @property {Function} onStart Function invoked on the beginning of tweening. Require 1 parameter: tween. default value is null.\n * @property {Function} onUpdate Function invoked on tweening update. Require 2 parameters: ratio, tween.  default value is null.\n * @property {Function} onComplete Function invoked on the end of tweening. Require 1 parameter: tween.  default value is null.\n */\nvar Tween = (function(){\n\nfunction now(){\n    return +new Date();\n}\n\nreturn Class.create(/** @lends Tween.prototype */{\n    constructor: function(target, fromProps, toProps, params){\n        var me = this;\n\n        me.target = target;\n        me._startTime = 0;\n        me._seekTime = 0;\n        me._pausedTime = 0;\n        me._pausedStartTime = 0;\n        me._reverseFlag = 1;\n        me._repeatCount = 0;\n\n        //no fromProps if pass 3 arguments\n        if(arguments.length == 3){\n            params = toProps;\n            toProps = fromProps;\n            fromProps = null;\n        }\n\n        for(var p in params) me[p] = params[p];\n        me._fromProps = fromProps;\n        me._toProps = toProps;\n\n        //for old version compatiblity\n        if(!params.duration && params.time){\n            me.duration = params.time || 0;\n            me.time = 0;\n        }\n    },\n\n    target: null,\n    duration: 1000,\n    delay: 0,\n    paused: false,\n    loop: false,\n    reverse: false,\n    repeat: 0,\n    repeatDelay: 0,\n    ease: null,\n    time: 0, //ready only\n\n    isStart:false,\n    isComplete:false,\n    onStart: null,\n    onUpdate: null,\n    onComplete: null,\n\n    /**\n     * @language=en\n     * Set beginning properties and ending properties of tweening object.\n     * @param {Object} fromProps Beginning properties of target tweening object.\n     * @param {Object} toProps Ending properties of target tweening object.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    setProps: function(fromProps, toProps){\n        var me = this, target = me.target,\n            propNames = fromProps || toProps,\n            from = me._fromProps = {}, to = me._toProps = {};\n\n        fromProps = fromProps || target;\n        toProps = toProps || target;\n\n        for(var p in propNames){\n            to[p] = toProps[p] || 0;\n            target[p] = from[p] = fromProps[p] || 0;\n        }\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Starting the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    start: function(){\n        var me = this;\n        me._startTime = now() + me.delay;\n        me._seekTime = 0;\n        me._pausedTime = 0;\n        me._reverseFlag = 1;\n        me._repeatCount = 0;\n        me.paused = false;\n        me.isStart = false;\n        me.isComplete = false;\n        Tween.add(me);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Stop the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    stop: function(){\n        Tween.remove(this);\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Pause the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    pause: function(){\n        var me = this;\n        me.paused = true;\n        me._pausedStartTime = now();\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Continue to play the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    resume: function(){\n        var me = this;\n        me.paused = false;\n        if(me._pausedStartTime) me._pausedTime += now() - me._pausedStartTime;\n        me._pausedStartTime = 0;\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Tween jumps to some point.\n     * @param {Number} time The time to jump to, range from 0 to duration.\n     * @param {Boolean} pause Is paused.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    seek: function(time, pause){\n        var me = this, current = now();\n        me._startTime = current;\n        me._seekTime = time;\n        me._pausedTime = 0;\n        if(pause !== undefined) me.paused = pause;\n        me._update(current, true);\n        Tween.add(me);\n        return me;\n    },\n\n    /**\n     * @language=en\n     * Link next Tween. The beginning time of next Tween depends on the delay value. If delay is a string that begins with '+' or '-', next Tween will begin at (delay) ms after or before the current tween is ended. If delay is out of previous situation, next Tween will begin at (delay) ms after the beginning point of current Tween.\n     * @param {Tween} tween Tween to link.\n     * @returns {Tween} next Tween, for chain calls.\n     */\n    link: function(tween){\n        var me = this, delay = tween.delay, startTime = me._startTime;\n\n        var plus, minus;\n        if(typeof delay === 'string'){\n            plus = delay.indexOf('+') == 0;\n            minus = delay.indexOf('-') == 0;\n            delay = plus || minus ? Number(delay.substr(1)) * (plus ? 1 : -1) : Number(delay);\n        }\n        tween.delay = delay;\n        tween._startTime = plus || minus ? startTime + me.duration + delay : startTime + delay;\n\n        me._next = tween;\n        Tween.remove(tween);\n        return tween;\n    },\n\n    /**\n     * @language=en\n     * Private render method inside Tween class.\n     * @private\n     */\n    _render: function(ratio){\n        var me = this, target = me.target, fromProps = me._fromProps, p;\n        for(p in fromProps) target[p] = fromProps[p] + (me._toProps[p] - fromProps[p]) * ratio;\n    },\n\n    /**\n     * @language=en\n     * Private update method inside Tween class.\n     * @private\n     */\n    _update: function(time, forceUpdate){\n        var me = this;\n        if(me.paused && !forceUpdate) return;\n        if(me.isComplete) return true;\n\n        //elapsed time\n        var elapsed = time - me._startTime - me._pausedTime + me._seekTime;\n        if(elapsed < 0) return;\n\n        //elapsed ratio\n        var ratio = elapsed / me.duration, callback;\n        ratio = ratio <= 0 ? 0 : ratio >= 1 ? 1 : ratio;\n        var easeRatio = me.ease ? me.ease(ratio) : ratio;\n\n        if(me.reverse && me.isStart){\n            //backward\n            if(me._reverseFlag < 0) {\n                ratio = 1 - ratio;\n                easeRatio = 1 - easeRatio;\n            }\n            //forward\n            if(ratio < 1e-7){\n                //repeat complete or not loop\n                if((me.repeat > 0 && me._repeatCount++ >= me.repeat) || (me.repeat == 0 && !me.loop)){\n                    me.isComplete = true;\n                }else{\n                    me._startTime = now();\n                    me._pausedTime = 0;\n                    me._reverseFlag *= -1;\n                }\n            }\n        }\n\n        //start callback\n        if(!me.isStart) {\n            me.setProps(me._fromProps, me._toProps);\n            me.isStart = true;\n            if(me.onStart){\n                me.onStart.call(me, me);\n            }\n        }\n        me.time = elapsed;\n\n        //render & update callback\n        me._render(easeRatio);\n        (callback = me.onUpdate) && callback.call(me, easeRatio, me);\n\n        //check if complete\n        if(ratio >= 1){\n            if(me.reverse){\n                me._startTime = now();\n                me._pausedTime = 0;\n                me._reverseFlag *= -1;\n            }else if(me.loop || me.repeat > 0 && me._repeatCount++ < me.repeat){\n                me._startTime = now() + me.repeatDelay;\n                me._pausedTime = 0;\n            }else{\n                me.isComplete = true;\n            }\n        }\n\n        //next tween\n        var next = me._next;\n        if(next && next.time <= 0){\n            var nextStartTime = next._startTime;\n            if(nextStartTime > 0 && nextStartTime <= time){\n                //parallel tween\n                next._render(ratio);\n                next.time = elapsed;\n                Tween.add(next);\n            }else if(me.isComplete && (nextStartTime < 0 || nextStartTime > time)){\n                //next tween\n                next.start();\n            }\n        }\n\n        //complete\n        if(me.isComplete){\n            (callback = me.onComplete) && callback.call(me, me);\n            return true;\n        }\n    },\n\n    Statics: /** @lends Tween */ {\n        /**\n         * @language=en\n         * @private\n         */\n        _tweens: [],\n\n        /**\n         * @language=en\n         * Update all Tween instances.\n         * @returns {Object} Tween。\n         */\n        tick: function(){\n            var tweens = Tween._tweens, tween, i, len = tweens.length;\n\n            for(i = 0; i < len; i++){\n                tween = tweens[i];\n                if(tween && tween._update(now())){\n                    tweens.splice(i, 1);\n                    i--;\n                }\n            }\n            return Tween;\n        },\n\n        /**\n         * @language=en\n         * Add a Tween instance.\n         * @param {Tween} tween Tween object to add.\n         * @returns {Object} Tween。\n         */\n        add: function(tween){\n            var tweens = Tween._tweens;\n            if(tweens.indexOf(tween) == -1) tweens.push(tween);\n            return Tween;\n        },\n\n        /**\n         * @language=en\n         * Remove one Tween target.\n         * @param {Tween|Object|Array} tweenOrTarget Tween object, target object or an array of object to remove\n         * @returns {Object} Tween。\n         */\n        remove: function(tweenOrTarget){\n            var i, l;\n            if(tweenOrTarget instanceof Array){\n                for(i = 0, l = tweenOrTarget.length;i < l;i ++){\n                    Tween.remove(tweenOrTarget[i]);\n                }\n                return Tween;\n            }\n\n            var tweens = Tween._tweens;\n            if(tweenOrTarget instanceof Tween){\n                i = tweens.indexOf(tweenOrTarget);\n                if(i > -1) tweens.splice(i, 1);\n            }else{\n                for(i = 0; i < tweens.length; i++){\n                    if(tweens[i].target === tweenOrTarget){\n                        tweens.splice(i, 1);\n                        i--;\n                    }\n                }\n            }\n\n            return Tween;\n        },\n\n        /**\n         * @language=en\n         * Remove all Tween instances.\n         * @returns {Object} Tween。\n         */\n        removeAll: function(){\n            Tween._tweens.length = 0;\n            return Tween;\n        },\n\n        /**\n         * @language=en\n         * Create a tween, make target object easing from beginning properties to ending properties.\n         * @param {Object|Array} target Tweening target or tweening target array.\n         * @param fromProps Beginning properties of target tweening object.\n         * @param toProps Ending properties of target tweening object.\n         * @param params Tweening parameters.\n         * @returns {Tween|Array} An tween instance or an array of tween instance.\n         */\n        fromTo: function(target, fromProps, toProps, params){\n            params = params || {};\n            var isArray = target instanceof Array;\n            target = isArray ? target : [target];\n\n            var tween, i, stagger = params.stagger, tweens = [];\n            for(i = 0; i < target.length; i++){\n                tween = new Tween(target[i], fromProps, toProps, params);\n                if(stagger) tween.delay = (params.delay || 0) + (i * stagger || 0);\n                tween.start();\n                tweens.push(tween);\n            }\n\n            return isArray?tweens:tween;\n        },\n\n        /**\n         * @language=en\n         * Create a tween, make target object easing from current properties to ending properties.\n         * @param {Object|Array} target Tweening target or tweening target array.\n         * @param toProps Ending properties of target tweening object.\n         * @param params Tweening parameters.\n         * @returns {Tween|Array} An tween instance or an array of tween instance.\n         */\n        to: function(target, toProps, params){\n            return Tween.fromTo(target, null, toProps, params);\n        },\n\n        /**\n         * @language=en\n         * Create a tween, make target object easing from beginning properties to current properties.\n         * @param {Object|Array} target Tweening target or tweening target array.\n         * @param fromProps Beginning properties of target tweening object.\n         * @param params Tweening parameters.\n         * @returns {Tween|Array} An tween instance or an array of tween instance.\n         */\n        from: function(target, fromProps, params){\n            return Tween.fromTo(target, fromProps, null, params);\n        }\n    }\n\n});\n\n})();\n\nwindow.Hilo.Tween = Tween;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\n\n\n/**\n * @language=en\n * @class Ease class provides multiple easing functions for Tween.\n * @module hilo/tween/Ease\n * @static\n */\nvar Ease = (function(){\n\nfunction createEase(obj, easeInFn, easeOutFn, easeInOutFn, easeNoneFn){\n    obj = obj || {};\n    easeInFn && (obj.EaseIn = easeInFn);\n    easeOutFn && (obj.EaseOut = easeOutFn);\n    easeInOutFn && (obj.EaseInOut = easeInOutFn);\n    easeNoneFn && (obj.EaseNone = easeNoneFn);\n    return obj;\n}\n\n/**\n * @language=en\n * Linear easing function.Include EaseNone.\n */\nvar Linear = createEase(null, null, null, null, function(k){\n    return k;\n});\n\n/**\n * @language=en\n * Quad easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Quad = createEase(null,\n    function(k){\n        return k * k;\n    },\n\n    function(k){\n        return - k * (k - 2);\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? 0.5 * k * k : -0.5 * (--k * (k - 2) - 1);\n    }\n);\n\n/**\n * @language=en\n * Cubic easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Cubic = createEase(null,\n    function(k){\n        return k * k * k;\n    },\n\n    function(k){\n        return --k * k * k + 1;\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? 0.5 * k * k * k : 0.5 * ((k -= 2) * k * k + 2);\n    }\n);\n\n/**\n * @language=en\n * Quart easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Quart = createEase(null,\n    function(k){\n        return k * k * k * k;\n    },\n\n    function(k){\n        return -(--k * k * k * k - 1);\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? 0.5 * k * k * k * k : - 0.5 * ((k -= 2) * k * k * k - 2);\n    }\n);\n\n/**\n * @language=en\n * Quint easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Quint = createEase(null,\n    function(k){\n        return k * k * k * k * k;\n    },\n\n    function(k){\n        return (k = k - 1) * k * k * k * k + 1;\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? 0.5 * k * k * k * k * k : 0.5 * ((k -= 2) * k * k * k * k + 2);\n    }\n);\n\nvar math = Math,\n    PI = math.PI, HALF_PI = PI * 0.5,\n    sin = math.sin, cos = math.cos,\n    pow = math.pow, sqrt = math.sqrt;\n\n/**\n * @language=en\n * Sine easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Sine = createEase(null,\n    function(k){\n        return -cos(k * HALF_PI) + 1;\n    },\n\n    function(k){\n        return sin(k * HALF_PI);\n    },\n\n    function(k){\n        return -0.5 * (cos(PI * k) - 1);\n    }\n);\n\n/**\n * @language=en\n * Expo easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Expo = createEase(null,\n    function(k){\n        return k == 0 ? 0 : pow(2, 10 * (k - 1));\n    },\n\n    function(k){\n        return k == 1 ? 1 : -pow(2, -10 * k) + 1;\n    },\n\n    function(k){\n        if(k == 0 || k == 1) return k;\n        if((k *= 2) < 1) return 0.5 * pow(2, 10 * (k - 1));\n        return 0.5 * (-pow(2, - 10 * (k - 1)) + 2);\n    }\n);\n\n/**\n * @language=en\n * Circ easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Circ = createEase(null,\n    function(k){\n        return -(sqrt(1 - k * k) - 1);\n    },\n\n    function(k){\n        return sqrt(1 - (--k * k));\n    },\n\n    function(k){\n        if((k /= 0.5) < 1) return - 0.5 * (sqrt(1 - k * k) - 1);\n        return 0.5 * (sqrt(1 - (k -= 2) * k) + 1);\n    }\n);\n\n/**\n * @language=en\n * Elastic easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Elastic = createEase(\n    {\n        a: 1,\n        p: 0.4,\n        s: 0.1,\n\n        config: function(amplitude, period){\n            Elastic.a = amplitude;\n            Elastic.p = period;\n            Elastic.s = period / (2 * PI) * Math.asin(1 / amplitude) || 0;\n        }\n    },\n\n    function(k){\n        return -(Elastic.a * pow(2, 10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p));\n    },\n\n    function(k){\n        return (Elastic.a * pow(2, -10 * k) * sin((k - Elastic.s) * (2 * PI) / Elastic.p) + 1);\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? -0.5 * (Elastic.a * pow(2, 10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p)) :\n               Elastic.a * pow(2, -10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p) * 0.5 + 1;\n    }\n);\n\n/**\n * @language=en\n * Back easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Back = createEase(\n    {\n        o: 1.70158,\n        s: 2.59491,\n\n        config: function(overshoot){\n            Back.o = overshoot;\n            Back.s = overshoot * 1.525;\n        }\n    },\n\n    function(k){\n        return k * k * ((Back.o + 1) * k - Back.o);\n    },\n\n    function(k){\n        return (k = k - 1) * k * ((Back.o + 1) * k + Back.o) + 1;\n    },\n\n    function(k){\n        return ((k *= 2) < 1) ? 0.5 * (k * k * ((Back.s + 1) * k - Back.s)) : 0.5 * ((k -= 2) * k * ((Back.s + 1) * k + Back.s) + 2);\n    }\n);\n\n/**\n * @language=en\n * Bounce easing function.Include EaseIn, EaseOut, EaseInOut.\n */\nvar Bounce = createEase(null,\n    function(k){\n        return 1 - Bounce.EaseOut(1 - k);\n    },\n\n    function(k){\n        if((k /= 1) < 0.36364){\n            return 7.5625 * k * k;\n        }else if(k < 0.72727){\n            return 7.5625 * (k -= 0.54545) * k + 0.75;\n        }else if(k < 0.90909){\n            return 7.5625 * (k -= 0.81818) * k + 0.9375;\n        }else{\n            return 7.5625 * (k -= 0.95455) * k + 0.984375;\n        }\n    },\n\n    function(k){\n        return k < 0.5 ? Bounce.EaseIn(k * 2) * 0.5 : Bounce.EaseOut(k * 2 - 1) * 0.5 + 0.5;\n    }\n);\n\nreturn {\n    Linear: Linear,\n    Quad: Quad,\n    Cubic: Cubic,\n    Quart: Quart,\n    Quint: Quint,\n    Sine: Sine,\n    Expo: Expo,\n    Circ: Circ,\n    Elastic: Elastic,\n    Back: Back,\n    Bounce: Bounce\n};\n\n})();\nwindow.Hilo.Ease = Ease;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * @private\n * @class image resources loader.\n * @module hilo/loader/ImageLoader\n * @requires hilo/core/Class\n */\nvar ImageLoader = Class.create({\n    load: function(data){\n        var me = this;\n\n        var image = new Image();\n        if(data.crossOrigin){\n            image.crossOrigin = \"Anonymous\";\n        }\n\n        image.onload = function(){\n            me.onLoad(image);\n        };\n        image.onerror = image.onabort = me.onError.bind(image);\n        image.src = data.src + (data.noCache ? (data.src.indexOf('?') == -1 ? '?' : '&') + 't=' + (+new Date()) : '');\n    },\n\n    onLoad: function(image){\n        image.onload = image.onerror = image.onabort = null;\n        return image;\n    },\n\n    onError: function(e){\n        var image = e.target;\n        image.onload = image.onerror = image.onabort = null;\n        return e;\n    }\n\n});\nwindow.Hilo.ImageLoader = ImageLoader;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\n\n\n/**\n * @language=en\n * @private\n * @class javascript or JSONP loader\n * @module hilo/loader/ScriptLoader\n * @requires hilo/core/Class\n */\nvar ScriptLoader = Class.create({\n    load: function(data){\n        var me = this, src = data.src, isJSONP = data.type == 'jsonp';\n\n        if(isJSONP){\n            var callbackName = data.callbackName || 'callback';\n            var callback = data.callback || 'jsonp' + (++ScriptLoader._count);\n            var win = window;\n\n            if(!win[callback]){\n                win[callback] = function(result){\n                    delete win[callback];\n                };\n            }\n\n            src += (src.indexOf('?') == -1 ? '?' : '&') + callbackName + '=' + callback;\n        }\n\n        if(data.noCache) src += (src.indexOf('?') == -1 ? '?' : '&') + 't=' + (+new Date());\n\n        var script = document.createElement('script');\n        script.type = 'text/javascript';\n        script.async = true;\n        script.onload = me.onLoad.bind(me);\n        script.onerror = me.onError.bind(me);\n        script.src = src;\n        if(data.id) script.id = data.id;\n        document.getElementsByTagName('head')[0].appendChild(script);\n    },\n\n    onLoad: function(e){\n        var script = e.target;\n        script.onload = script.onerror = null;\n        return script;\n    },\n\n    onError: function(e){\n        var script = e.target;\n        script.onload = script.onerror = null;\n        return e;\n    },\n\n    Statics: {\n        _count: 0\n    }\n\n});\nwindow.Hilo.ScriptLoader = ScriptLoader;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar EventMixin = window.Hilo.EventMixin;\nvar ImageLoader = window.Hilo.ImageLoader;\nvar ScriptLoader = window.Hilo.ScriptLoader;\n\n\n//TODO: 超时timeout，失败重连次数maxTries，更多的下载器Loader，队列暂停恢复等。\n\n/**\n * @language=en\n * @class LoadQueue is a queue-like loader.\n * @mixes EventMixin\n * @borrows EventMixin#on as #on\n * @borrows EventMixin#off as #off\n * @borrows EventMixin#fire as #fire\n * @param {Object} source resource that need to be loaded,could be a single object or array resource.\n * @module hilo/loader/LoadQueue\n * @requires hilo/core/Class\n * @requires hilo/event/EventMixin\n * @requires hilo/loader/ImageLoader\n * @requires hilo/loader/ScriptLoader\n * @property {Int} maxConnections the limited concurrent connections. default value  2.\n */\nvar LoadQueue = Class.create(/** @lends LoadQueue.prototype */{\n    Mixes: EventMixin,\n    constructor: function(source){\n        this._source = [];\n        this.add(source);\n    },\n\n    maxConnections: 2, //TODO: 应该是每个host的最大连接数。\n\n    _source: null,\n    _loaded: 0,\n    _connections: 0,\n    _currentIndex: -1,\n\n    /**\n     * @language=en\n     * Add desired resource,could be a single object or array resource.\n     * @param {Object|Array} source ,a single object or array resource. Each resource contains properties like below:\n     * <ul>\n     * <li><b>id</b> - resource identifier</li>\n     * <li><b>src</b> - resource url</li>\n     * <li><b>type</b> - resource type. By default, we automatically identify resource by file suffix and choose the relevant loader for you</li>\n     * <li><b>loader</b> - specified resource loader. If you specify this,we abandon choosing loader inside</li>\n     * <li><b>noCache</b> - a tag that set on or off to prevent cache,implemented by adding timestamp inside</li>\n     * <li><b>size</b> - predicted resource size, help calculating loading progress</li>\n     * <li><b>crossOrigin</b> - Whether cross-domain is needed, default is false</li>\n     * </ul>\n     * @returns {LoadQueue} 下载队列实例本身。\n     */\n    add: function(source){\n        var me = this;\n        if(source){\n            source = source instanceof Array ? source : [source];\n            me._source = me._source.concat(source);\n        }\n        return me;\n    },\n\n    /**\n     * @language=en\n     * get resource object by id or src\n     * @param {String}  specified id or src\n     * @returns {Object} resource object\n     */\n    get: function(id){\n        if(id){\n            var source = this._source;\n            for(var i = 0; i < source.length; i++){\n                var item = source[i];\n                if(item.id === id || item.src === id){\n                    return item;\n                }\n            }\n        }\n        return null;\n    },\n\n    /**\n     * @language=en\n     * get resource object content  by id or src\n     * @param {String} specified id or src\n     * @returns {Object} resource object content\n     */\n    getContent: function(id){\n        var item = this.get(id);\n        return item && item.content;\n    },\n    /**\n     * @language=en\n     * remove resource object content  by id or src\n     * @param {String} specified id or src\n     */\n    removeContent: function(id){\n        if(id){\n            var source = this._source;\n            for(var i = 0; i < source.length; i++){\n                var item = source[i];\n                if(item.id === id || item.src === id){\n                    source.splice(i, 1);\n                    return;\n                }\n            }\n        }\n    },\n\n    /**\n     * @language=en\n     * start loading\n     * @returns {LoadQueue} the loading instance\n     */\n    start: function(){\n        var me = this;\n        me._loadNext();\n        return me;\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _loadNext: function(){\n        var me = this, source = me._source, len = source.length;\n\n        //all items loaded\n        if(me._loaded >= len){\n            me.fire('complete');\n            return;\n        }\n\n        if(me._currentIndex < len - 1 && me._connections < me.maxConnections){\n            var index = ++me._currentIndex;\n            var item = source[index];\n            var loader = me._getLoader(item);\n\n            if(loader){\n                var onLoad = loader.onLoad, onError = loader.onError;\n\n                loader.onLoad = function(e){\n                    loader.onLoad = onLoad;\n                    loader.onError = onError;\n                    var content = onLoad && onLoad.call(loader, e) || e.target;\n                    me._onItemLoad(index, content);\n                };\n                loader.onError = function(e){\n                    loader.onLoad = onLoad;\n                    loader.onError = onError;\n                    onError && onError.call(loader, e);\n                    me._onItemError(index, e);\n                };\n                me._connections++;\n            }\n\n            me._loadNext();\n            loader && loader.load(item);\n        }\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _getLoader: function(item){\n        var loader = item.loader;\n        if(loader) return loader;\n\n        var type = item.type || getExtension(item.src);\n\n        switch(type){\n            case 'png':\n            case 'jpg':\n            case 'jpeg':\n            case 'gif':\n            case 'webp':\n                loader = new ImageLoader();\n                break;\n            case 'js':\n            case 'jsonp':\n                loader = new ScriptLoader();\n                break;\n        }\n\n        return loader;\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _onItemLoad: function(index, content){\n        var me = this, item = me._source[index];\n        item.loaded = true;\n        item.content = content;\n        me._connections--;\n        me._loaded++;\n        me.fire('load', item);\n        me._loadNext();\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _onItemError: function(index, e){\n        var me = this, item = me._source[index];\n        item.error = e;\n        me._connections--;\n        me._loaded++;\n        me.fire('error', item);\n        me._loadNext();\n    },\n\n    /**\n     * @language=en\n     *  get resource size, loaded or all.\n     * @param {Boolean} identify loaded or all resource. default is false, return all resource size. when set true, return loaded resource size.\n     * @returns {Number} resource size.\n     */\n    getSize: function(loaded){\n        var size = 0, source = this._source;\n        for(var i = 0; i < source.length; i++){\n            var item = source[i];\n            size += (loaded ? item.loaded && item.size : item.size) || 0;\n        }\n        return size;\n    },\n\n    /**\n     * @language=en\n     * get loaded resource count\n     * @returns {Uint} loaded resource count\n     */\n    getLoaded: function(){\n        return this._loaded;\n    },\n\n    /**\n     * @language=en\n     * get all resource count\n     * @returns {Uint} all resource count\n     */\n    getTotal: function(){\n        return this._source.length;\n    }\n\n});\n\n/**\n * @language=en\n * @private\n */\nfunction getExtension(src){\n    var extRegExp = /\\/?[^/]+\\.(\\w+)(\\?\\S+)?$/i, match, extension;\n    if(match = src.match(extRegExp)){\n        extension = match[1].toLowerCase();\n    }\n    return extension || null;\n}\nwindow.Hilo.LoadQueue = LoadQueue;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\nvar EventMixin = window.Hilo.EventMixin;\n\n\n/**\n * @language=en\n * @class HTMLAudio is an audio playing module, which uses HTMLAudioElement to play audio.\n * Limits: iOS platform requires user action events to start playing, and many Android browser can only play one audio at a time.\n * @param {Object} properties create object properties, include all writable properties of this class.\n * @module hilo/media/HTMLAudio\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @requires hilo/event/EventMixin\n * @property {String} src The source of the playing audio.\n * @property {Boolean} loop Is loop playback, default value is false.\n * @property {Boolean} autoPlay Is the audio autoplay, default value is false.\n * @property {Boolean} loaded Is the audio resource loaded, readonly!\n * @property {Boolean} playing Is the audio playing, readonly!\n * @property {Number} duration The duration of the audio, readonly!\n * @property {Number} volume The volume of the audio, value between 0 to 1.\n * @property {Boolean} muted Is the audio muted, default value is false.\n */\nvar HTMLAudio = Class.create(/** @lends HTMLAudio.prototype */{\n    Mixes: EventMixin,\n    constructor: function(properties){\n        util.copy(this, properties, true);\n\n        this._onAudioEvent = this._onAudioEvent.bind(this);\n    },\n\n    src: null,\n    loop: false,\n    autoPlay: false,\n    loaded: false,\n    playing: false,\n    duration: 0,\n    volume: 1,\n    muted: false,\n\n    _element: null, //HTMLAudioElement对象\n\n    /**\n     * @language=en\n     * Load audio file.\n     */\n    load: function(){\n        if(!this._element){\n            var elem;\n            try{\n                elem = this._element = new Audio();\n                elem.addEventListener('canplaythrough', this._onAudioEvent, false);\n                elem.addEventListener('ended', this._onAudioEvent, false);\n                elem.addEventListener('error', this._onAudioEvent, false);\n                elem.src = this.src;\n                elem.volume = this.volume;\n                elem.load();\n            }\n            catch(err){\n                //ie9 某些版本有Audio对象，但是执行play,pause会报错！\n                elem = this._element = {};\n                elem.play = elem.pause = function(){\n\n                };\n            }\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _onAudioEvent: function(e){\n        // console.log('onAudioEvent:', e.type);\n        var type = e.type;\n\n        switch(type){\n            case 'canplaythrough':\n                e.target.removeEventListener(type, this._onAudioEvent);\n                this.loaded = true;\n                this.duration = this._element.duration;\n                this.fire('load');\n                if(this.autoPlay) this._doPlay();\n                break;\n            case 'ended':\n                this.playing = false;\n                this.fire('end');\n                if(this.loop) this._doPlay();\n                break;\n            case 'error':\n                this.fire('error');\n                break;\n        }\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _doPlay: function(){\n        if(!this.playing){\n            this._element.volume = this.muted ? 0 : this.volume;\n            this._element.play();\n            this.playing = true;\n        }\n    },\n\n    /**\n     * @language=en\n     * Start playing the audio. And play the audio from the beginning if the audio is already playing.\n     * Note: To prevent failing to play at the first time, play when the audio is loaded.\n     */\n    play: function(){\n        if(this.playing) this.stop();\n\n        if(!this._element){\n            this.autoPlay = true;\n            this.load();\n        }else if(this.loaded){\n            this._doPlay();\n        }\n\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Pause (halt) the currently playing audio.\n     */\n    pause: function(){\n        if(this.playing){\n            this._element.pause();\n            this.playing = false;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Continue to play the audio.\n     */\n    resume: function(){\n        if(!this.playing){\n            this._doPlay();\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Stop playing the audio.\n     */\n    stop: function(){\n        if(this.playing){\n            this._element.pause();\n            this._element.currentTime = 0;\n            this.playing = false;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set the volume. Note: iOS devices cannot set volume.\n     */\n    setVolume: function(volume){\n        if(this.volume != volume){\n            this.volume = volume;\n            this._element.volume = volume;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set mute mode. Note: iOS devices cannot set mute mode.\n     */\n    setMute: function(muted){\n        if(this.muted != muted){\n            this.muted = muted;\n            this._element.volume = muted ? 0 : this.volume;\n        }\n        return this;\n    },\n\n    Statics: /** @lends HTMLAudio */ {\n        /**\n         * @language=en\n         * Does the browser supports HTMLAudio.\n         */\n        isSupported: window.Audio !== null\n    }\n\n});\nwindow.Hilo.HTMLAudio = HTMLAudio;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\nvar EventMixin = window.Hilo.EventMixin;\n\n\n/**\n * @language=en\n * @class WebAudio audio playing module. It provides a better way to play and control audio, use on iOS6+ platform.\n * Compatibility：iOS6+、Chrome33+、Firefox28+ supported，but all Android browsers do not support.\n * @param {Object} properties create object properties, include all writable properties of this class.\n * @module hilo/media/WebAudio\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @requires hilo/event/EventMixin\n * @property {String} src The source of the playing audio.\n * @property {Boolean} loop Is loop playback, default value is false.\n * @property {Boolean} autoPlay Is the audio autoplay, default value is false.\n * @property {Boolean} loaded Is the audio resource loaded, readonly!\n * @property {Boolean} playing Is the audio playing, readonly!\n * @property {Number} duration The duration of the audio, readonly!\n * @property {Number} volume The volume of the audio, value between 0 to 1.\n * @property {Boolean} muted Is the audio muted, default value is false.\n */\nvar WebAudio = (function(){\n\nvar context = null;\ntry {\n    var AudioContext = window.AudioContext || window.webkitAudioContext;\n    if (AudioContext) {\n        context = new AudioContext();\n    }\n} catch(e) {\n    context = null;\n}\n\nreturn Class.create(/** @lends WebAudio.prototype */{\n    Mixes: EventMixin,\n    constructor: function(properties){\n        util.copy(this, properties, true);\n\n        this._init();\n    },\n\n    src: null,\n    loop: false,\n    autoPlay: false,\n    loaded: false,\n    playing: false,\n    duration: 0,\n    volume: 1,\n    muted: false,\n\n    _context: null, //WebAudio上下文 the WebAudio Context\n    _gainNode: null, //音量控制器 the volume controller\n    _buffer: null, //音频缓冲文件 the audio file buffer\n    _audioNode: null, //音频播放器 the audio playing node\n    _startTime: 0, //开始播放时间戳 the start time to play the audio\n    _offset: 0, //播放偏移量 the offset of current playing audio\n\n    /**\n     * @language=en\n     * @private Initialize.\n     */\n    _init:function(){\n        this._context = context;\n        this._gainNode = context.createGain ? context.createGain() : context.createGainNode();\n        this._gainNode.connect(context.destination);\n\n        this._onAudioEvent = this._onAudioEvent.bind(this);\n        this._onDecodeComplete = this._onDecodeComplete.bind(this);\n        this._onDecodeError = this._onDecodeError.bind(this);\n    },\n    /**\n     * @language=en\n     * Load audio file. Note: use XMLHttpRequest to load the audio, should pay attention to cross-origin problem.\n     */\n    load: function(){\n        if(!this._buffer){\n            var buffer = WebAudio._bufferCache[this.src];\n            if(buffer){\n                this._onDecodeComplete(buffer);\n            }\n            else{\n                var request = new XMLHttpRequest();\n                request.src = this.src;\n                request.open('GET', this.src, true);\n                request.responseType = 'arraybuffer';\n                request.onload = this._onAudioEvent;\n                request.onprogress = this._onAudioEvent;\n                request.onerror = this._onAudioEvent;\n                request.send();\n            }\n            this._buffer = true;\n        }\n        return this;\n    },\n\n    /**\n     * @private\n     */\n    _onAudioEvent: function(e){\n        // console.log('onAudioEvent:', e.type);\n        var type = e.type;\n\n        switch(type){\n            case 'load':\n                var request = e.target;\n                request.onload = request.onprogress = request.onerror = null;\n                this._context.decodeAudioData(request.response, this._onDecodeComplete, this._onDecodeError);\n                request = null;\n                break;\n            case 'ended':\n                this.playing = false;\n                this.fire('end');\n                if(this.loop) this._doPlay();\n                break;\n            case 'progress':\n                this.fire(e);\n                break;\n            case 'error':\n                this.fire(e);\n                break;\n        }\n    },\n\n    /**\n     * @private\n     */\n    _onDecodeComplete: function(audioBuffer){\n        if(!WebAudio._bufferCache[this.src]){\n            WebAudio._bufferCache[this.src] = audioBuffer;\n        }\n\n        this._buffer = audioBuffer;\n        this.loaded = true;\n        this.duration = audioBuffer.duration;\n\n        this.fire('load');\n        if(this.autoPlay) this._doPlay();\n    },\n\n    /**\n     * @private\n     */\n    _onDecodeError: function(){\n        this.fire('error');\n    },\n\n    /**\n     * @private\n     */\n    _doPlay: function(){\n        this._clearAudioNode();\n\n        var audioNode = this._context.createBufferSource();\n\n        //some old browser are noteOn/noteOff -> start/stop\n        if(!audioNode.start){\n            audioNode.start = audioNode.noteOn;\n            audioNode.stop = audioNode.noteOff;\n        }\n\n        audioNode.buffer = this._buffer;\n        audioNode.onended = this._onAudioEvent;\n        this._gainNode.gain.value = this.muted ? 0 : this.volume;\n        audioNode.connect(this._gainNode);\n        audioNode.start(0, this._offset);\n\n        this._audioNode = audioNode;\n        this._startTime = this._context.currentTime;\n        this.playing = true;\n    },\n\n    /**\n     * @private\n     */\n    _clearAudioNode: function(){\n        var audioNode = this._audioNode;\n        if(audioNode){\n            audioNode.onended = null;\n            // audioNode.disconnect(this._gainNode);\n            audioNode.disconnect(0);\n            this._audioNode = null;\n        }\n    },\n\n    /**\n     * @language=en\n     * Play the audio. Restart playing the audio from the beginning if already playing.\n     */\n    play: function(){\n        if(this.playing) this.stop();\n\n        if(this.loaded){\n            this._doPlay();\n        }else if(!this._buffer){\n            this.autoPlay = true;\n            this.load();\n        }\n\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Pause (halt) playing the audio.\n     */\n    pause: function(){\n        if(this.playing){\n            this._audioNode.stop(0);\n            this._offset += this._context.currentTime - this._startTime;\n            this.playing = false;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Continue to play the audio.\n     */\n    resume: function(){\n        if(!this.playing){\n            this._doPlay();\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Stop playing the audio.\n     */\n    stop: function(){\n        if(this.playing){\n            this._audioNode.stop(0);\n            this._audioNode.disconnect();\n            this._offset = 0;\n            this.playing = false;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set the volume.\n     */\n    setVolume: function(volume){\n        if(this.volume != volume){\n            this.volume = volume;\n            this._gainNode.gain.value = volume;\n        }\n        return this;\n    },\n\n    /**\n     * @language=en\n     * Set mute mode.\n     */\n    setMute: function(muted){\n        if(this.muted != muted){\n            this.muted = muted;\n            this._gainNode.gain.value = muted ? 0 : this.volume;\n        }\n        return this;\n    },\n\n    Statics: /** @lends WebAudio */ {\n        /**\n         * @language=en\n         * Does the browser support WebAudio.\n         */\n        isSupported: context !== null,\n\n        /**\n         * @language=en\n         * Does browser activate WebAudio already.\n         */\n        enabled: false,\n\n        /**\n         * @language=en\n         * Activate WebAudio. Note: Require user action events to activate. Once activated, can play audio without user action events.\n         */\n        enable: function(){\n            if(!this.enabled && context){\n                var source = context.createBufferSource();\n                source.buffer = context.createBuffer(1, 1, 22050);\n                source.connect(context.destination);\n                source.start ? source.start(0, 0, 0) : source.noteOn(0, 0, 0);\n                this.enabled = true;\n                return true;\n            }\n            return this.enabled;\n        },\n        /**\n         * The audio buffer caches.\n         * @private\n         * @type {Object}\n         */\n        _bufferCache:{},\n        /**\n         * @language=en\n         * Clear the audio buffer cache.\n         * @param  {String} url audio's url. if url is none, it will clear all buffer.\n         */\n        clearBufferCache:function(url){\n            if(url){\n                this._bufferCache[url] = null;\n            }\n            else{\n                this._bufferCache = {};\n            }\n        }\n    }\n});\n\n})();\nwindow.Hilo.WebAudio = WebAudio;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar HTMLAudio = window.Hilo.HTMLAudio;\nvar WebAudio = window.Hilo.WebAudio;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/WebSound.html?noHeader' width = '320' height = '310' scrolling='no'></iframe>\n * <br/>\n * demo:\n * <pre>\n * var audio = WebSound.getAudio({\n *     src: 'test.mp3',\n *     loop: false,\n *     volume: 1\n * }).on('load', function(e){\n *     console.log('load');\n * }).on('end', function(e){\n *     console.log('end');\n * }).play();\n * </pre>\n * @class Audio playing manager.\n * @static\n * @module hilo/media/WebSound\n * @requires hilo/media/HTMLAudio\n * @requires hilo/media/WebAudio\n * @requires hilo/util/util\n */\nvar WebSound = {\n    _audios: {},\n\n    /**\n     * @language=en\n     * Activate audio function. Note: Require user action events to activate. Currently support WebAudio.\n     */\n    enableAudio: function(){\n        if(WebAudio.isSupported){\n            WebAudio.enable();\n        }\n    },\n\n    /**\n     * @language=en\n     * Get audio element. Default use WebAudio if supported.\n     * @param {String|Object} source If String, it's the source of the audio; If Object, it should contains a src property.\n     * @param {Boolean} [preferWebAudio=true] Whether or not to use WebAudio first, default is true.\n     * @returns {WebAudio|HTMLAudio} Audio playing instance.\n     */\n    getAudio: function(source, preferWebAudio){\n        if(preferWebAudio === undefined){\n            preferWebAudio = true;\n        }\n\n        source = this._normalizeSource(source);\n        var audio = this._audios[source.src];\n        if(!audio){\n            if(preferWebAudio && WebAudio.isSupported){\n                audio = new WebAudio(source);\n            }else if(HTMLAudio.isSupported){\n                audio = new HTMLAudio(source);\n            }\n            this._audios[source.src] = audio;\n        }\n\n        return audio;\n    },\n\n    /**\n     * @language=en\n     * Remove audio element.\n     * @param {String|Object} source If String, it's the source of the audio; If Object, it should contains a src property.\n     */\n    removeAudio: function(source){\n        var src = typeof source === 'string' ? source : source.src;\n        var audio = this._audios[src];\n        if(audio){\n            audio.stop();\n            audio.off();\n            this._audios[src] = null;\n            delete this._audios[src];\n        }\n    },\n\n    /**\n     * @language=en\n     * @private\n     */\n    _normalizeSource: function(source){\n        var result = {};\n        if(typeof source === 'string') result = {src:source};\n        else util.copy(result, source);\n        return result;\n    }\n\n};\nwindow.Hilo.WebSound = WebSound;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * @class Camera.\n * @param {Object} properties The properties to create a view object, contains all writeable props of this class\n * @module hilo/game/Camera\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @property {Number} width The width of the camera.\n * @property {Number} height The height of the camera.\n * @property {Object} scroll The scrolling value of the camera {x:0, y:0}.\n * @property {View} target The target that the camera follow.\n * @property {Array} bounds The rect area where camera is allowed to move [x, y, width, height].\n * @property {Array} deadzone The rect area where camera isn't allowed to move[ x, y, width, height].\n */\nvar Camera = Class.create(/** @lends Camera.prototype */{\n    constructor:function(properties){\n        this.width = 0;\n        this.height = 0;\n\n        this.target = null;\n        this.deadzone = null;\n        this.bounds = null;\n\n        this.scroll = {\n            x:0,\n            y:0\n        };\n\n        util.copy(this, properties);\n    },\n    /**\n     * @language=en\n     * update.\n     * @param {Number} deltaTime\n    */\n    tick:function(deltaTime){\n        var target = this.target;\n        var scroll = this.scroll;\n        var bounds = this.bounds;\n        var deadzone = this.deadzone;\n\n        if(target){\n            var viewX, viewY;\n            if(deadzone){\n                viewX = Math.min(Math.max(target.x - scroll.x, deadzone[0]), deadzone[0] + deadzone[2]);\n                viewY = Math.min(Math.max(target.y - scroll.y, deadzone[1]), deadzone[1] + deadzone[3]);\n            }\n            else{\n                viewX = this.width * .5;\n                viewY = this.height * .5;\n            }\n\n            scroll.x = target.x - viewX;\n            scroll.y = target.y - viewY;\n\n            if(bounds){\n                scroll.x = Math.min(Math.max(scroll.x, bounds[0]), bounds[0] + bounds[2]);\n                scroll.y = Math.min(Math.max(scroll.y, bounds[1]), bounds[1] + bounds[3]);\n            }\n        }\n        else{\n            scroll.x = 0;\n            scroll.y = 0;\n        }\n    },\n    /**\n     * @language=en\n     * Follow the target.\n     * @param {Object} target The target that the camera follow. It must has x and y properties.\n     * @param {Array} deadzone The rect area where camera isn't allowed to move[ x, y, width, height].\n    */\n    follow:function(target, deadzone){\n        this.target = target;\n        if(deadzone !== undefined){\n            this.deadzone = deadzone;\n        }\n        this.tick();\n    }\n});\n\nwindow.Hilo.Camera = Camera;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Class = window.Hilo.Class;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * @class Camera3d is a pseudo-3d camera.\n * @module hilo/game/Camera3d\n * @requires hilo/core/Class\n * @requires hilo/util/util\n * @property {Number} fv The distance of the fov(The distance between eyes and the Z plane，it determines the scale ratio of the 3d object).\n * @property {Number} fx The x position of the screen viewpoint(The distance between the screen viewpoint and the screen left top corner on the x axis).\n * @property {Number} fy The y position of the screen viewpoint(The distance between the screen viewpoint and the screen left top corner on the y axis).\n * @property {Object} stage The 3d object's container, it can be stage or container.It is required if you need to sort the 3d object by z axis.\n * @property {Number} x The x position.\n * @property {Number} y The y position.\n * @property {Number} z The z position.\n * @property {Number} rotationX The x rotation.\n * @property {Number} rotationY The y rotation.\n * @property {Number} rotationZ The z rotation.\n */\nvar Camera3d = (function(){\n\n    var degtorad = Math.PI / 180;\n\n    //Rotate the axis.\n    function rotateX(x, y, z, ca, sa) {//rotate x\n        return {\n            x: x,\n            y: y * ca - z * sa,\n            z: y * sa + z * ca\n        };\n    }\n    function rotateY(x, y, z, ca, sa) {//rotate y\n        return {\n            x: x * ca - z * sa,\n            y: y,\n            z: x * sa + z * ca\n        };\n    }\n    function rotateZ(x, y, z, ca, sa) {//rotate z\n        return {\n            x: x * ca - y * sa,\n            y: x * sa + y * ca,\n            z: z\n        };\n    }\n\n    var Camera3d = Class.create(/** @lends Camera3d.prototype */{\n\n        constructor: function(properties){\n            properties.x = properties.x || 0;\n            properties.y = properties.y || 0;\n            properties.z = properties.z || 0;\n            properties.rotationX = properties.rotationX || 0;\n            properties.rotationY = properties.rotationY || 0;\n            properties.rotationZ = properties.rotationZ || 0;\n\n            util.copy(this, properties);\n        },\n\n        /**\n         * @language=en\n         * Translate the camera，used for Zoomin/out feature.\n         * @param {Number} x The x position.\n         * @param {Number} y The y position.\n         * @param {Number} z The z position.\n         */\n        translate : function(x,y,z){\n            this.tx = x;\n            this.ty = y;\n            this.tz = z;\n        },\n\n        /**\n         * @language=en\n         * Rotate by the x axis.\n         * @param {Number} angle The rotate degree.\n         */\n        rotateX : function(angle){\n            this.rotationX = angle;\n        },\n\n        /**\n         * @language=en\n         * Rotate by the y axis.\n         * @param {Number} angle The rotate degree.\n         */\n        rotateY : function(angle){\n            this.rotationY = angle;\n        },\n\n        /**\n         * @language=en\n         * Rotate by the z axis.\n         * @param {Number} angle The rotate degree.\n         */\n        rotateZ : function(angle){\n            this.rotationZ = angle;\n        },\n\n        /**\n         * @language=en\n         * Project the 3d point to 2d point.\n         * @param {object} vector3D The 3d position, it must have x, y and z properties.\n         * @param {View} view The view related to the 3d position.It'll be auto translated by the 3d position.\n         * @returns {Object} The 2d object include z and scale properties, e.g.:{x:x, y:y, z:z, scale}\n         */\n        project : function(vector3D, view){\n\n            var rx = this.rotationX * degtorad,\n                ry = this.rotationY * degtorad,\n                rz = this.rotationZ * degtorad,\n\n                cosX = Math.cos(rx), sinX = Math.sin(rx),\n                cosY = Math.cos(ry), sinY = Math.sin(ry),\n                cosZ = Math.cos(rz), sinZ = Math.sin(rz),\n\n                // 旋转变换前的 仿射矩阵位移，\n                dx = vector3D.x - this.x,\n                dy = vector3D.y - this.y,\n                dz = vector3D.z - this.z;\n\n            // 旋转矩阵变换\n            var vector = rotateZ(dx, dy, dz, cosZ, sinZ);\n            vector = rotateY(vector.x, vector.y, vector.z, cosY, sinY);\n            vector = rotateX(vector.x, vector.y, vector.z, cosX, sinX);\n\n            // 最后的仿射矩阵变换\n            if(this.tx) vector.x -= this.tx;\n            if(this.ty) vector.y -= this.ty;\n            if(this.tz) vector.z -= this.tz;\n\n            var perspective = this.fv / (this.fv + vector.z),\n                _x = vector.x * perspective,\n                _y = -vector.y * perspective;\n\n            var result = {\n                x : _x + this.fx,\n                y : _y + this.fy,\n                z : -vector.z,\n                scale : perspective\n            };\n\n            if(view){\n                view.x = result.x;\n                view.y = result.y;\n                view.z = result.z;\n                view.scaleX = result.scale;\n                view.scaleY = result.scale;\n            }\n\n            return result;\n        },\n\n        /**\n         * @language=en\n         * Sort by z axis.\n         */\n        sortZ : function(){\n            this.stage.sortChildren(function(view_a, view_b){\n                return view_a.z - view_b.z;\n            });\n        },\n\n        /**\n         * @language=en\n         * Used for the ticker.\n         */\n        tick : function(){\n            this.sortZ();\n        }\n\n    });\n\n    return Camera3d;\n\n})();\nwindow.Hilo.Camera3d = Camera3d;\n})(window);\n/**\n * hilojs 2.0.2 for standalone\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n(function(window){\nif(!window.Hilo) window.Hilo = {};\nvar Hilo = window.Hilo;var Class = window.Hilo.Class;\nvar View = window.Hilo.View;\nvar Container = window.Hilo.Container;\nvar Drawable = window.Hilo.Drawable;\nvar util = window.Hilo.util;\n\n\n/**\n * @language=en\n * <iframe src='../../../examples/ParticleSystem.html?noHeader' width = '550' height = '400' scrolling='no'></iframe>\n * <br/>\n * @class ParticleSystem A particle system.\n * @augments Container\n * @module hilo/game/ParticleSystem\n * @requires hilo/core/Hilo\n * @requires hilo/core/Class\n * @requires hilo/view/View\n * @requires hilo/view/Container\n * @requires hilo/view/Drawable\n * @requires hilo/util/util\n * @property {Number} [emitTime=0.2] Emit time interval(in second).\n * @property {Number} [emitTimeVar=0] Emit time interval variances.\n * @property {Number} [emitNum=10] Emit number.\n * @property {Number} [emitNumVar=0] Emit number variances.\n * @property {Number} [emitterX=0] The emitter x position.\n * @property {Number} [emitterY=0] The emitter y position.\n * @property {Number} [totalTime=Infinity] Total time.\n * @property {Number} [gx=0] The gravity x value.\n * @property {Number} [gy=0] The gravity y value.\n * @param {Object} properties properties The properties to create a view object, contains all writeable props of this class\n * @param {Object} properties.particle The config of particle.\n * @param {Number} [properties.particle.x=0] The x position.\n * @param {Number} [properties.particle.y=0] The y position\n * @param {Number} [properties.particle.vx=0] The x velocity.\n * @param {Number} [properties.particle.vy=0] The y velocity.\n * @param {Number} [properties.particle.ax=0] The x acceleration.\n * @param {Number} [properties.particle.ay=0] The y acceleration.\n * @param {Number} [properties.particle.life=1] The time particle lives(in second).\n * @param {Number} [properties.particle.alpha=1] The alpha.\n * @param {Number} [properties.particle.alphaV=0] The alpha decline rate.\n * @param {Number} [properties.particle.scale=1] The scale.\n * @param {Number} [properties.particle.scaleV=0] The scale decline rate.\n*/\nvar ParticleSystem = (function(){\n    //粒子属性\n    var props = ['x', 'y', 'vx', 'vy', 'ax', 'ay', 'rotation', 'rotationV', 'scale', 'scaleV', 'alpha', 'alphaV', 'life'];\n    var PROPS = [];\n    for(var i = 0, l = props.length;i < l;i ++){\n        var p = props[i];\n        PROPS.push(p);\n        PROPS.push(p + \"Var\");\n    }\n\n    //粒子默认值\n    var PROPS_DEFAULT = {\n        x: 0,\n        y: 0,\n        vx: 0,\n        vy: 0,\n        ax: 0,\n        ay: 0,\n        scale:1,\n        scaleV:0,\n        alpha:1,\n        alphaV:0,\n        rotation: 0,\n        rotationV: 0,\n        life: 1\n    };\n\n    var diedParticles = [];\n\n    var ParticleSystem = Class.create(/** @lends ParticleSystem.prototype */{\n        Extends:Container,\n        constructor:function(properties){\n            this.id = this.id || properties.id || Hilo.getUid(\"ParticleSystem\");\n\n            this.emitterX = 0;\n            this.emitterY = 0;\n\n            this.gx = 0;\n            this.gy = 0;\n            this.totalTime = Infinity;\n\n            this.emitNum = 10;\n            this.emitNumVar = 0;\n\n            this.emitTime = .2;\n            this.emitTimeVar = 0;\n\n            this.particle = {};\n\n            ParticleSystem.superclass.constructor.call(this, properties);\n\n            this.reset(properties);\n        },\n        Statics:{\n            PROPS:PROPS,\n            PROPS_DEFAULT:PROPS_DEFAULT,\n            diedParticles:diedParticles\n        },\n        /**\n         * @language=en\n         * Reset the properties.\n         * @param {Object} cfg\n        */\n        reset: function(cfg) {\n            util.copy(this, cfg);\n            this.particle.system = this;\n            if(this.totalTime <= 0){\n                this.totalTime = Infinity;\n            }\n        },\n        /**\n         * @language=en\n         * 更新\n         * @param {Number} dt delta time(in milliseconds)\n        */\n        onUpdate: function(dt) {\n            dt *= .001;\n            if (this._isRun) {\n                this._totalRunTime += dt;\n                this._currentRunTime += dt;\n                if (this._currentRunTime >= this._emitTime) {\n                    this._currentRunTime = 0;\n                    this._emitTime = getRandomValue(this.emitTime, this.emitTimeVar);\n                    this._emit();\n                }\n\n                if (this._totalRunTime >= this.totalTime) {\n                    this.stop();\n                }\n            }\n        },\n        /**\n         * @language=en\n         * Emit particles.\n        */\n        _emit: function() {\n            var num = getRandomValue(this.emitNum, this.emitNumVar)>>0;\n            for (var i = 0; i < num; i++) {\n                this.addChild(Particle.create(this.particle));\n            }\n        },\n        /**\n         * @language=en\n         * Start emit particles.\n        */\n        start: function() {\n            this.stop(true);\n            this._currentRunTime = 0;\n            this._totalRunTime = 0;\n            this._isRun = true;\n            this._emitTime = getRandomValue(this.emitTime, this.emitTimeVar);\n        },\n        /**\n         * @language=en\n         * Stop emit particles.\n         * @param {Boolean} clear Whether or not clear all the particles.\n        */\n        stop: function(clear) {\n            this._isRun = false;\n            if (clear) {\n                for (var i = this.children.length - 1; i >= 0; i--) {\n                    this.children[i].destroy();\n                }\n            }\n        }\n    });\n\n    /**\n     * @language=en\n     * @class 粒子\n     * @inner\n     * @param {Number} vx The x velocity.\n     * @param {Number} vy The y velocity.\n     * @param {Number} ax The x acceleration.\n     * @param {Number} ay The y acceleration.\n     * @param {Number} scaleV The scale decline rate.\n     * @param {Number} alphaV The alpha decline rate.\n     * @param {Number} rotationV The rotate speed.\n     * @param {Number} life The time particle lives(in seconds)\n    */\n    var Particle = Class.create({\n        Extends:View,\n        constructor:function(properties){\n            this.id = this.id || properties.id || Hilo.getUid(\"Particle\");\n            Particle.superclass.constructor.call(this, properties);\n            this.init(properties);\n        },\n        /**\n         * @language=en\n         * Update the particle.\n        */\n        onUpdate: function(dt) {\n            dt *= .001;\n            if(this._died){\n                return false;\n            }\n            var ax = this.ax + this.system.gx;\n            var ay = this.ay + this.system.gy;\n\n            this.vx += ax * dt;\n            this.vy += ay * dt;\n            this.x += this.vx * dt;\n            this.y += this.vy * dt;\n\n            this.rotation += this.rotationV;\n\n            if (this._time > .1) {\n                this.alpha += this.alphaV;\n            }\n\n            this.scale += this.scaleV;\n            this.scaleX = this.scaleY = this.scale;\n\n            this._time += dt;\n            if (this._time >= this.life || this.alpha <= 0) {\n                this.destroy();\n                return false;\n            }\n        },\n        /**\n         * @language=en\n         * Set the image of particle.\n        */\n        setImage: function(img, frame) {\n            this.drawable = this.drawable||new Drawable();\n            frame = frame || [0, 0, img.width, img.height];\n\n            this.width = frame[2];\n            this.height = frame[3];\n            this.drawable.rect = frame;\n            this.drawable.image = img;\n        },\n        /**\n         * @language=en\n         * Destroy the particle.\n        */\n        destroy: function() {\n            this._died = true;\n            this.alpha = 0;\n            this.removeFromParent();\n            diedParticles.push(this);\n        },\n        /**\n         * @language=en\n         * Init the particle.\n        */\n        init: function(cfg) {\n            this.system = cfg.system;\n            this._died = false;\n            this._time = 0;\n            this.alpha = 1;\n            for (var i = 0, l = PROPS.length; i < l; i++) {\n                var p = PROPS[i];\n                var v = cfg[p] === undefined ? PROPS_DEFAULT[p] : cfg[p];\n                this[p] = getRandomValue(v, cfg[p + 'Var']);\n            }\n\n            this.x += this.system.emitterX;\n            this.y += this.system.emitterY;\n\n            if (cfg.image) {\n                var frame = cfg.frame;\n                if(frame && frame[0].length){\n                    frame = frame[(Math.random() * frame.length) >> 0];\n                }\n                this.setImage(cfg.image, frame);\n                if(cfg.pivotX !== undefined){\n                    this.pivotX = cfg.pivotX * frame[2];\n                }\n                if(cfg.pivotY !== undefined){\n                    this.pivotY = cfg.pivotY * frame[3];\n                }\n            }\n        },\n        Statics:{\n            /**\n             * @language=en\n             * Create the particle.\n             * @param {Object} cfg The config of particle.\n            */\n            create:function(cfg) {\n                if (diedParticles.length > 0) {\n                    var particle = diedParticles.pop();\n                    particle.init(cfg);\n                    return particle;\n                } else {\n                    return new Particle(cfg);\n                }\n            }\n        }\n\n    });\n\n    /**\n     * Get the random value.\n     * @private\n     * @param  {Number} value     The value.\n     * @param  {Number} variances The variances.\n     * @return {Number}\n     */\n    function getRandomValue(value, variances){\n        return variances ? value + (Math.random() - .5) * 2 * variances : value;\n    }\n\n    return ParticleSystem;\n})();\nwindow.Hilo.ParticleSystem = ParticleSystem;\n})(window);\n            if( true && module.exports){\n                module.exports = window.Hilo;\n            }\n        \n\n//# sourceURL=webpack:///./node_modules/_hilojs@2.0.2@hilojs/hilo-standalone.js?");

/***/ }),

/***/ "./node_modules/_process@0.11.10@process/browser.js":
/*!**********************************************************!*\
  !*** ./node_modules/_process@0.11.10@process/browser.js ***!
  \**********************************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("// shim for using process in browser\nvar process = module.exports = {};\n\n// cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n    throw new Error('setTimeout has not been defined');\n}\nfunction defaultClearTimeout () {\n    throw new Error('clearTimeout has not been defined');\n}\n(function () {\n    try {\n        if (typeof setTimeout === 'function') {\n            cachedSetTimeout = setTimeout;\n        } else {\n            cachedSetTimeout = defaultSetTimout;\n        }\n    } catch (e) {\n        cachedSetTimeout = defaultSetTimout;\n    }\n    try {\n        if (typeof clearTimeout === 'function') {\n            cachedClearTimeout = clearTimeout;\n        } else {\n            cachedClearTimeout = defaultClearTimeout;\n        }\n    } catch (e) {\n        cachedClearTimeout = defaultClearTimeout;\n    }\n} ())\nfunction runTimeout(fun) {\n    if (cachedSetTimeout === setTimeout) {\n        //normal enviroments in sane situations\n        return setTimeout(fun, 0);\n    }\n    // if setTimeout wasn't available but was latter defined\n    if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n        cachedSetTimeout = setTimeout;\n        return setTimeout(fun, 0);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedSetTimeout(fun, 0);\n    } catch(e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n            return cachedSetTimeout.call(null, fun, 0);\n        } catch(e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n            return cachedSetTimeout.call(this, fun, 0);\n        }\n    }\n\n\n}\nfunction runClearTimeout(marker) {\n    if (cachedClearTimeout === clearTimeout) {\n        //normal enviroments in sane situations\n        return clearTimeout(marker);\n    }\n    // if clearTimeout wasn't available but was latter defined\n    if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n        cachedClearTimeout = clearTimeout;\n        return clearTimeout(marker);\n    }\n    try {\n        // when when somebody has screwed with setTimeout but no I.E. maddness\n        return cachedClearTimeout(marker);\n    } catch (e){\n        try {\n            // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n            return cachedClearTimeout.call(null, marker);\n        } catch (e){\n            // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n            // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n            return cachedClearTimeout.call(this, marker);\n        }\n    }\n\n\n\n}\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n    if (!draining || !currentQueue) {\n        return;\n    }\n    draining = false;\n    if (currentQueue.length) {\n        queue = currentQueue.concat(queue);\n    } else {\n        queueIndex = -1;\n    }\n    if (queue.length) {\n        drainQueue();\n    }\n}\n\nfunction drainQueue() {\n    if (draining) {\n        return;\n    }\n    var timeout = runTimeout(cleanUpNextTick);\n    draining = true;\n\n    var len = queue.length;\n    while(len) {\n        currentQueue = queue;\n        queue = [];\n        while (++queueIndex < len) {\n            if (currentQueue) {\n                currentQueue[queueIndex].run();\n            }\n        }\n        queueIndex = -1;\n        len = queue.length;\n    }\n    currentQueue = null;\n    draining = false;\n    runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n    var args = new Array(arguments.length - 1);\n    if (arguments.length > 1) {\n        for (var i = 1; i < arguments.length; i++) {\n            args[i - 1] = arguments[i];\n        }\n    }\n    queue.push(new Item(fun, args));\n    if (queue.length === 1 && !draining) {\n        runTimeout(drainQueue);\n    }\n};\n\n// v8 likes predictible objects\nfunction Item(fun, array) {\n    this.fun = fun;\n    this.array = array;\n}\nItem.prototype.run = function () {\n    this.fun.apply(null, this.array);\n};\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) { return [] }\n\nprocess.binding = function (name) {\n    throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () { return '/' };\nprocess.chdir = function (dir) {\n    throw new Error('process.chdir is not supported');\n};\nprocess.umask = function() { return 0; };\n\n\n//# sourceURL=webpack:///./node_modules/_process@0.11.10@process/browser.js?");

/***/ }),

/***/ "./node_modules/_seinjs@1.5.17@seinjs/lib/seinjs.es.js":
/*!*************************************************************!*\
  !*** ./node_modules/_seinjs@1.5.17@seinjs/lib/seinjs.es.js ***!
  \*************************************************************/
/*! exports provided: AIControllerActor, Actor, AliAMCExtension, AmbientLightActor, AmbientLightComponent, Animation, AnimatorComponent, AtlasLoader, AtlasManager, BSPBoxActor, BSPBoxComponent, BSPComponent, BSPCylinderActor, BSPCylinderComponent, BSPMorphActor, BSPMorphComponent, BSPPlaneActor, BSPPlaneComponent, BSPSphereActor, BSPSphereComponent, BaseException, BasicMaterial, BoxColliderComponent, BoxGeometry, BreakGuardException, Buffer, CameraComponent, CannonPhysicWorld, ChildActorComponent, ColliderComponent, Color, CombineAnimation, Component, Constants, ContextMenuTrigger, ContextSupports, ControllerActor, CubeTexture, CubeTextureLoader, CylinderColliderComponent, CylinderGeometry, DEG2RAD, DataTexture, Debug, DirectionalLightActor, DirectionalLightComponent, DistanceJointComponent, DynamicTexture, EColliderType, EJointType, EPickMode, ERigidBodyType, ESeinNodeType, ESpace, Engine, Euler, EventManager, EventTrigger, FSMComponent, FSMState, Fog, FrameBuffer, GLCapabilities, GLExtensions, Game, GameModeActor, Geometry, GeometryData, GeometryMaterial, GlTFLoader, HTTP, Hilo3d, HingeJointComponent, ImageLoader, InfoActor, JointComponent, KeyDownTrigger, KeyPressTrigger, KeyUpTrigger, Layers, LazyTexture, Level, LevelScriptActor, LightComponent, LockJointComponent, Material, Matrix3, Matrix4, MemberConflictException, Mesh, MetaSClasses, MetaSMaterials, MissingMemberException, ModelAnimation, MorphGeometry, MouseClickTrigger, MouseDownTrigger, MouseEnterTrigger, MouseLeaveTrigger, MouseMoveTrigger, MouseOutTrigger, MouseOverTrigger, MouseUpTrigger, MouseWheelTrigger, Observable, OrthographicCameraActor, OrthographicCameraComponent, PBRMaterial, PerspectiveCameraActor, PerspectiveCameraComponent, PhysicPicker, PlaneColliderComponent, PlaneGeometry, Player, PlayerControllerActor, PlayerStateActor, PointLightActor, PointLightComponent, PointToPointJointComponent, PrimitiveComponent, Program, Quaternion, RAD2DEG, RawShaderMaterial, RenderSystemActor, ResourceLoadException, ResourceLoader, ResourceManager, RigidBodyComponent, SArray, SClass, SIterable, SMap, SMaterial, SName, SObject, SSet, SceneActor, SceneComponent, Semantic, Shader, ShaderChunk, ShaderMaterial, SkeletalMesh, SkeletalMeshActor, SkeletalMeshComponent, Skeleton, SkyboxMaterial, SphereColliderComponent, SphereGeometry, Spherical, SphericalHarmonics3, SpotLightActor, SpotLightComponent, SpringJointComponent, SpriteActor, SpriteAnimation, SpriteComponent, StateActor, StaticMeshActor, StaticMeshComponent, SystemActor, Texture, TextureLoader, Ticker, TimerActor, TouchCancelTrigger, TouchEndTrigger, TouchMoveTrigger, TouchStartTrigger, Tween, TweenAnimation, TypeConflictException, UnmetRequireException, Vector2, Vector3, Vector4, VertexArrayObject, WheelTrigger, WindowResizeTrigger, World, author, bfs, clamp, degToRad, deprecated, findActorByClass, findActorByClassName, findActorByFilter, findActorByName, findActorByNamePath, findActorByTag, findActorByUUID, findActorsByClass, findActorsByClassName, findActorsByFilter, findActorsByName, findActorsByTag, inspectable, isAIControllerActor, isActor, isAmbientLightActor, isAmbientLightComponent, isAnimation, isAnimatorComponent, isAtlasLoader, isAtlasManager, isBSPActor, isBSPBoxActor, isBSPBoxComponent, isBSPComponent, isBSPCylinderActor, isBSPCylinderComponent, isBSPMorphActor, isBSPMorphComponent, isBSPPlaneActor, isBSPPlaneComponent, isBSPSphereActor, isBSPSphereComponent, isBaseException, isBasicMaterial, isBoxColliderComponent, isBoxGeometry, isBreakGuardException, isCameraActor, isColliderComponent, isColor, isCombineAnimation, isComponent, isControllerActor, isCubeTexture, isCubeTextureLoader, isCylinderColliderComponent, isCylinderGeometry, isDataTexture, isDirectionalLightActor, isDirectionalLightComponent, isDistanceJointComponent, isDynamicTexture, isEngine, isEuler, isEventManager, isEventTrigger, isFSMComponent, isFSMState, isFog, isFrameBuffer, isGame, isGameModeActor, isGeometry, isGeometryData, isGeometryMaterial, isGlTFLoader, isHingeJointComponent, isImageLoader, isInfoActor, isJointComponent, isLayers, isLazyTexture, isLevel, isLevelScriptActor, isLightActor, isLightComponent, isLockJointComponent, isMaterial, isMatrix3, isMatrix4, isMemberConflictException, isMesh, isMissingMemberException, isModelAnimation, isMorphGeometry, isObservable, isOrthographicCameraActor, isOrthographicCameraComponent, isPBRMaterial, isPerspectiveCameraActor, isPerspectiveCameraComponent, isPhysicPicker, isPlaneColliderComponent, isPlaneGeometry, isPlayer, isPlayerControllerActor, isPlayerStateActor, isPointLightActor, isPointLightComponent, isPointToPointJointComponent, isPowerOfTwo, isPrimitiveActor, isPrimitiveComponent, isQuaternion, isRawShaderMaterial, isRenderSystemActor, isResourceLoadException, isResourceLoader, isResourceManager, isRigidBodyComponent, isSName, isSObject, isSceneActor, isSceneComponent, isShaderChunk, isShaderMaterial, isSkeletalMesh, isSkeletalMeshActor, isSkeletalMeshComponent, isSkyboxMaterial, isSphereColliderComponent, isSphereGeometry, isSpherical, isSphericalHarmonics3, isSpotLightActor, isSpotLightComponent, isSpringJointComponent, isSpriteActor, isSpriteAnimation, isSpriteComponent, isStateActor, isStaticMeshActor, isStaticMeshComponent, isSystemActor, isTexture, isTextureLoader, isTicker, isTimerActor, isTweenAnimation, isTypeConflictException, isUnmetRequireException, isVector2, isVector3, isVector4, isWorld, iterateActors, iterateActorsByClass, iterateActorsByClassType, iterateActorsByName, iterateActorsByTag, nearestPowerOfTwo, nextPowerOfTwo, radToDeg, serialize, shaderChunks, throwException, version */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* WEBPACK VAR INJECTION */(function(process, global, module) {/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AIControllerActor\", function() { return AIControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Actor\", function() { return Actor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AliAMCExtension\", function() { return AliAMCExtension; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AmbientLightActor\", function() { return AmbientLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AmbientLightComponent\", function() { return AmbientLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Animation\", function() { return Animation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AnimatorComponent\", function() { return AnimatorComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AtlasLoader\", function() { return AtlasLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"AtlasManager\", function() { return AtlasManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPBoxActor\", function() { return BSPBoxActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPBoxComponent\", function() { return BSPBoxComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPComponent\", function() { return BSPComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPCylinderActor\", function() { return BSPCylinderActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPCylinderComponent\", function() { return BSPCylinderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPMorphActor\", function() { return BSPMorphActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPMorphComponent\", function() { return BSPMorphComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPPlaneActor\", function() { return BSPPlaneActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPPlaneComponent\", function() { return BSPPlaneComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPSphereActor\", function() { return BSPSphereActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BSPSphereComponent\", function() { return BSPSphereComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BaseException\", function() { return BaseException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BasicMaterial\", function() { return BasicMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BoxColliderComponent\", function() { return BoxColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BoxGeometry\", function() { return BoxGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"BreakGuardException\", function() { return BreakGuardException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Buffer\", function() { return Buffer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CameraComponent\", function() { return CameraComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CannonPhysicWorld\", function() { return CannonPhysicWorld; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ChildActorComponent\", function() { return ChildActorComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ColliderComponent\", function() { return ColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Color\", function() { return Color; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CombineAnimation\", function() { return CombineAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Component\", function() { return Component; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Constants\", function() { return Constants; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ContextMenuTrigger\", function() { return ContextMenuTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ContextSupports\", function() { return ContextSupports; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ControllerActor\", function() { return ControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CubeTexture\", function() { return CubeTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CubeTextureLoader\", function() { return CubeTextureLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CylinderColliderComponent\", function() { return CylinderColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"CylinderGeometry\", function() { return CylinderGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DEG2RAD\", function() { return DEG2RAD; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DataTexture\", function() { return DataTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Debug\", function() { return Debug; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DirectionalLightActor\", function() { return DirectionalLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DirectionalLightComponent\", function() { return DirectionalLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DistanceJointComponent\", function() { return DistanceJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"DynamicTexture\", function() { return DynamicTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EColliderType\", function() { return EColliderType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EJointType\", function() { return EJointType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EPickMode\", function() { return EPickMode; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ERigidBodyType\", function() { return ERigidBodyType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ESeinNodeType\", function() { return ESeinNodeType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ESpace\", function() { return ESpace; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Engine\", function() { return Engine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Euler\", function() { return Euler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EventManager\", function() { return EventManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"EventTrigger\", function() { return EventTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FSMComponent\", function() { return FSMComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FSMState\", function() { return FSMState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Fog\", function() { return Fog; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"FrameBuffer\", function() { return FrameBuffer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GLCapabilities\", function() { return GLCapabilities; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GLExtensions\", function() { return GLExtensions; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Game\", function() { return Game; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GameModeActor\", function() { return GameModeActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Geometry\", function() { return Geometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GeometryData\", function() { return GeometryData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GeometryMaterial\", function() { return GeometryMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"GlTFLoader\", function() { return GlTFLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HTTP\", function() { return HTTP; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Hilo3d\", function() { return Hilo3d$2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"HingeJointComponent\", function() { return HingeJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ImageLoader\", function() { return ImageLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"InfoActor\", function() { return InfoActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"JointComponent\", function() { return JointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KeyDownTrigger\", function() { return KeyDownTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KeyPressTrigger\", function() { return KeyPressTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"KeyUpTrigger\", function() { return KeyUpTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Layers\", function() { return Layers; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LazyTexture\", function() { return LazyTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Level\", function() { return Level; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LevelScriptActor\", function() { return LevelScriptActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LightComponent\", function() { return LightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"LockJointComponent\", function() { return LockJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Material\", function() { return Material; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Matrix3\", function() { return Matrix3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Matrix4\", function() { return Matrix4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MemberConflictException\", function() { return MemberConflictException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Mesh\", function() { return Mesh; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MetaSClasses\", function() { return MetaSClasses; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MetaSMaterials\", function() { return MetaSMaterials; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MissingMemberException\", function() { return MissingMemberException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ModelAnimation\", function() { return ModelAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MorphGeometry\", function() { return MorphGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseClickTrigger\", function() { return MouseClickTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseDownTrigger\", function() { return MouseDownTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseEnterTrigger\", function() { return MouseEnterTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseLeaveTrigger\", function() { return MouseLeaveTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseMoveTrigger\", function() { return MouseMoveTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseOutTrigger\", function() { return MouseOutTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseOverTrigger\", function() { return MouseOverTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseUpTrigger\", function() { return MouseUpTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"MouseWheelTrigger\", function() { return MouseWheelTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Observable\", function() { return Observable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OrthographicCameraActor\", function() { return OrthographicCameraActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"OrthographicCameraComponent\", function() { return OrthographicCameraComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PBRMaterial\", function() { return PBRMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PerspectiveCameraActor\", function() { return PerspectiveCameraActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PerspectiveCameraComponent\", function() { return PerspectiveCameraComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PhysicPicker\", function() { return PhysicPicker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PlaneColliderComponent\", function() { return PlaneColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PlaneGeometry\", function() { return PlaneGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Player\", function() { return Player; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PlayerControllerActor\", function() { return PlayerControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PlayerStateActor\", function() { return PlayerStateActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PointLightActor\", function() { return PointLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PointLightComponent\", function() { return PointLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PointToPointJointComponent\", function() { return PointToPointJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"PrimitiveComponent\", function() { return PrimitiveComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Program\", function() { return Program; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Quaternion\", function() { return Quaternion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RAD2DEG\", function() { return RAD2DEG; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RawShaderMaterial\", function() { return RawShaderMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RenderSystemActor\", function() { return RenderSystemActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceLoadException\", function() { return ResourceLoadException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceLoader\", function() { return ResourceLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ResourceManager\", function() { return ResourceManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"RigidBodyComponent\", function() { return RigidBodyComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SArray\", function() { return SArray; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SClass\", function() { return SClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SIterable\", function() { return SIterable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SMap\", function() { return SMap; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SMaterial\", function() { return SMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SName\", function() { return SName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SObject\", function() { return SObject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SSet\", function() { return SSet; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SceneActor\", function() { return SceneActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SceneComponent\", function() { return SceneComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Semantic\", function() { return Semantic; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Shader\", function() { return Shader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderChunk\", function() { return ShaderChunk; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"ShaderMaterial\", function() { return ShaderMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SkeletalMesh\", function() { return SkeletalMesh; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SkeletalMeshActor\", function() { return SkeletalMeshActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SkeletalMeshComponent\", function() { return SkeletalMeshComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Skeleton\", function() { return Skeleton; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SkyboxMaterial\", function() { return SkyboxMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SphereColliderComponent\", function() { return SphereColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SphereGeometry\", function() { return SphereGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Spherical\", function() { return Spherical; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SphericalHarmonics3\", function() { return SphericalHarmonics3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpotLightActor\", function() { return SpotLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpotLightComponent\", function() { return SpotLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpringJointComponent\", function() { return SpringJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpriteActor\", function() { return SpriteActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpriteAnimation\", function() { return SpriteAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SpriteComponent\", function() { return SpriteComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StateActor\", function() { return StateActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StaticMeshActor\", function() { return StaticMeshActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"StaticMeshComponent\", function() { return StaticMeshComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"SystemActor\", function() { return SystemActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Texture\", function() { return Texture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TextureLoader\", function() { return TextureLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Ticker\", function() { return Ticker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TimerActor\", function() { return TimerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TouchCancelTrigger\", function() { return TouchCancelTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TouchEndTrigger\", function() { return TouchEndTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TouchMoveTrigger\", function() { return TouchMoveTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TouchStartTrigger\", function() { return TouchStartTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Tween\", function() { return Tween; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TweenAnimation\", function() { return TweenAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"TypeConflictException\", function() { return TypeConflictException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"UnmetRequireException\", function() { return UnmetRequireException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector2\", function() { return Vector2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector3\", function() { return Vector3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"Vector4\", function() { return Vector4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"VertexArrayObject\", function() { return VertexArrayObject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WheelTrigger\", function() { return WheelTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"WindowResizeTrigger\", function() { return WindowResizeTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"World\", function() { return World; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"author\", function() { return author; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"bfs\", function() { return bfs; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"clamp\", function() { return clamp; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"degToRad\", function() { return degToRad; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"deprecated\", function() { return deprecated; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByClass\", function() { return findActorByClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByClassName\", function() { return findActorByClassName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByFilter\", function() { return findActorByFilter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByName\", function() { return findActorByName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByNamePath\", function() { return findActorByNamePath; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByTag\", function() { return findActorByTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorByUUID\", function() { return findActorByUUID; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorsByClass\", function() { return findActorsByClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorsByClassName\", function() { return findActorsByClassName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorsByFilter\", function() { return findActorsByFilter; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorsByName\", function() { return findActorsByName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"findActorsByTag\", function() { return findActorsByTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"inspectable\", function() { return inspectable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAIControllerActor\", function() { return isAIControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isActor\", function() { return isActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAmbientLightActor\", function() { return isAmbientLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAmbientLightComponent\", function() { return isAmbientLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAnimation\", function() { return isAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAnimatorComponent\", function() { return isAnimatorComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAtlasLoader\", function() { return isAtlasLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isAtlasManager\", function() { return isAtlasManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPActor\", function() { return isBSPActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPBoxActor\", function() { return isBSPBoxActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPBoxComponent\", function() { return isBSPBoxComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPComponent\", function() { return isBSPComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPCylinderActor\", function() { return isBSPCylinderActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPCylinderComponent\", function() { return isBSPCylinderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPMorphActor\", function() { return isBSPMorphActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPMorphComponent\", function() { return isBSPMorphComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPPlaneActor\", function() { return isBSPPlaneActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPPlaneComponent\", function() { return isBSPPlaneComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPSphereActor\", function() { return isBSPSphereActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBSPSphereComponent\", function() { return isBSPSphereComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBaseException\", function() { return isBaseException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBasicMaterial\", function() { return isBasicMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBoxColliderComponent\", function() { return isBoxColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBoxGeometry\", function() { return isBoxGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isBreakGuardException\", function() { return isBreakGuardException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCameraActor\", function() { return isCameraActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isColliderComponent\", function() { return isColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isColor\", function() { return isColor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCombineAnimation\", function() { return isCombineAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isComponent\", function() { return isComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isControllerActor\", function() { return isControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCubeTexture\", function() { return isCubeTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCubeTextureLoader\", function() { return isCubeTextureLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCylinderColliderComponent\", function() { return isCylinderColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isCylinderGeometry\", function() { return isCylinderGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDataTexture\", function() { return isDataTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDirectionalLightActor\", function() { return isDirectionalLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDirectionalLightComponent\", function() { return isDirectionalLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDistanceJointComponent\", function() { return isDistanceJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isDynamicTexture\", function() { return isDynamicTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEngine\", function() { return isEngine; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEuler\", function() { return isEuler; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEventManager\", function() { return isEventManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isEventTrigger\", function() { return isEventTrigger; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFSMComponent\", function() { return isFSMComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFSMState\", function() { return isFSMState; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFog\", function() { return isFog; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isFrameBuffer\", function() { return isFrameBuffer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGame\", function() { return isGame; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGameModeActor\", function() { return isGameModeActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGeometry\", function() { return isGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGeometryData\", function() { return isGeometryData; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGeometryMaterial\", function() { return isGeometryMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isGlTFLoader\", function() { return isGlTFLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isHingeJointComponent\", function() { return isHingeJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isImageLoader\", function() { return isImageLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isInfoActor\", function() { return isInfoActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isJointComponent\", function() { return isJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLayers\", function() { return isLayers; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLazyTexture\", function() { return isLazyTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLevel\", function() { return isLevel; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLevelScriptActor\", function() { return isLevelScriptActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLightActor\", function() { return isLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLightComponent\", function() { return isLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isLockJointComponent\", function() { return isLockJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMaterial\", function() { return isMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMatrix3\", function() { return isMatrix3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMatrix4\", function() { return isMatrix4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMemberConflictException\", function() { return isMemberConflictException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMesh\", function() { return isMesh; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMissingMemberException\", function() { return isMissingMemberException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isModelAnimation\", function() { return isModelAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isMorphGeometry\", function() { return isMorphGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isObservable\", function() { return isObservable; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOrthographicCameraActor\", function() { return isOrthographicCameraActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isOrthographicCameraComponent\", function() { return isOrthographicCameraComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPBRMaterial\", function() { return isPBRMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPerspectiveCameraActor\", function() { return isPerspectiveCameraActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPerspectiveCameraComponent\", function() { return isPerspectiveCameraComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPhysicPicker\", function() { return isPhysicPicker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlaneColliderComponent\", function() { return isPlaneColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlaneGeometry\", function() { return isPlaneGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlayer\", function() { return isPlayer; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlayerControllerActor\", function() { return isPlayerControllerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPlayerStateActor\", function() { return isPlayerStateActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPointLightActor\", function() { return isPointLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPointLightComponent\", function() { return isPointLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPointToPointJointComponent\", function() { return isPointToPointJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPowerOfTwo\", function() { return isPowerOfTwo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPrimitiveActor\", function() { return isPrimitiveActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isPrimitiveComponent\", function() { return isPrimitiveComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isQuaternion\", function() { return isQuaternion; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isRawShaderMaterial\", function() { return isRawShaderMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isRenderSystemActor\", function() { return isRenderSystemActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isResourceLoadException\", function() { return isResourceLoadException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isResourceLoader\", function() { return isResourceLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isResourceManager\", function() { return isResourceManager; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isRigidBodyComponent\", function() { return isRigidBodyComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSName\", function() { return isSName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSObject\", function() { return isSObject; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSceneActor\", function() { return isSceneActor$1; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSceneComponent\", function() { return isSceneComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isShaderChunk\", function() { return isShaderChunk; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isShaderMaterial\", function() { return isShaderMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSkeletalMesh\", function() { return isSkeletalMesh; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSkeletalMeshActor\", function() { return isSkeletalMeshActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSkeletalMeshComponent\", function() { return isSkeletalMeshComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSkyboxMaterial\", function() { return isSkyboxMaterial; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSphereColliderComponent\", function() { return isSphereColliderComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSphereGeometry\", function() { return isSphereGeometry; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpherical\", function() { return isSpherical; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSphericalHarmonics3\", function() { return isSphericalHarmonics3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpotLightActor\", function() { return isSpotLightActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpotLightComponent\", function() { return isSpotLightComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpringJointComponent\", function() { return isSpringJointComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpriteActor\", function() { return isSpriteActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpriteAnimation\", function() { return isSpriteAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSpriteComponent\", function() { return isSpriteComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isStateActor\", function() { return isStateActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isStaticMeshActor\", function() { return isStaticMeshActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isStaticMeshComponent\", function() { return isStaticMeshComponent; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isSystemActor\", function() { return isSystemActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTexture\", function() { return isTexture; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTextureLoader\", function() { return isTextureLoader; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTicker\", function() { return isTicker; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTimerActor\", function() { return isTimerActor; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTweenAnimation\", function() { return isTweenAnimation; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isTypeConflictException\", function() { return isTypeConflictException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isUnmetRequireException\", function() { return isUnmetRequireException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isVector2\", function() { return isVector2; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isVector3\", function() { return isVector3; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isVector4\", function() { return isVector4; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"isWorld\", function() { return isWorld; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"iterateActors\", function() { return iterateActors; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"iterateActorsByClass\", function() { return iterateActorsByClass; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"iterateActorsByClassType\", function() { return iterateActorsByClassType; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"iterateActorsByName\", function() { return iterateActorsByName; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"iterateActorsByTag\", function() { return iterateActorsByTag; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"nearestPowerOfTwo\", function() { return nearestPowerOfTwo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"nextPowerOfTwo\", function() { return nextPowerOfTwo; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"radToDeg\", function() { return radToDeg; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"serialize\", function() { return serialize; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"shaderChunks\", function() { return shaderChunks; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"throwException\", function() { return throwException; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"version\", function() { return version; });\n/*! \n * @license Sein.js v1.5.17\n * Copyright (c) 2018-present SeinJS Group.\n *\n * This source code is licensed under the MIT license found in the\n * LICENSE file in the root directory of this source tree.\n */\n/**\r\n * @hidden\r\n */\r\nvar ESpace;\r\n(function (ESpace) {\r\n    ESpace[ESpace[\"BONE\"] = 0] = \"BONE\";\r\n    ESpace[ESpace[\"LOCAL\"] = 1] = \"LOCAL\";\r\n    ESpace[ESpace[\"WORLD\"] = 2] = \"WORLD\";\r\n    ESpace[ESpace[\"VIEW\"] = 3] = \"VIEW\";\r\n    ESpace[ESpace[\"NDC\"] = 4] = \"NDC\";\r\n    ESpace[ESpace[\"SCREEN\"] = 5] = \"SCREEN\";\r\n})(ESpace || (ESpace = {}));\n\n/**\r\n * 支持的碰撞体类型枚举。\r\n */\r\nvar EColliderType;\r\n(function (EColliderType) {\r\n    /**\r\n     * 没有碰撞体。\r\n     */\r\n    EColliderType[EColliderType[\"Null\"] = 0] = \"Null\";\r\n    /**\r\n     * 球碰撞体。\r\n     */\r\n    EColliderType[EColliderType[\"Sphere\"] = 1] = \"Sphere\";\r\n    /**\r\n     * 盒碰撞体。\r\n     */\r\n    EColliderType[EColliderType[\"Box\"] = 2] = \"Box\";\r\n    /**\r\n     * 平面碰撞体。\r\n     */\r\n    EColliderType[EColliderType[\"Plane\"] = 3] = \"Plane\";\r\n    /**\r\n     * 柱状碰撞体。\r\n     */\r\n    EColliderType[EColliderType[\"Cylinder\"] = 4] = \"Cylinder\";\r\n    // todo: support terrain\r\n    // Terrain = 5,\r\n    // Particle = 6,\r\n    // Mesh = 7\r\n})(EColliderType || (EColliderType = {}));\r\n/**\r\n * 支持的刚体类型枚举。\r\n */\r\nvar ERigidBodyType;\r\n(function (ERigidBodyType) {\r\n    /**\r\n     * 动态的，等同于`physicStatic = false`。\r\n     */\r\n    ERigidBodyType[ERigidBodyType[\"Dynamic\"] = 1] = \"Dynamic\";\r\n    /**\r\n     * 静态的，等同于`physicStatic = true`。\r\n     */\r\n    ERigidBodyType[ERigidBodyType[\"Static\"] = 2] = \"Static\";\r\n})(ERigidBodyType || (ERigidBodyType = {}));\r\n/**\r\n * 支持的关节类型枚举。\r\n */\r\nvar EJointType;\r\n(function (EJointType) {\r\n    /**\r\n     * 点对点约束。\r\n     */\r\n    EJointType[EJointType[\"PointToPoint\"] = 0] = \"PointToPoint\";\r\n    /**\r\n     * 铰链约束。\r\n     */\r\n    EJointType[EJointType[\"Hinge\"] = 1] = \"Hinge\";\r\n    /**\r\n     * 距离约束。\r\n     */\r\n    EJointType[EJointType[\"Distance\"] = 2] = \"Distance\";\r\n    /**\r\n     * 弹簧约束。\r\n     */\r\n    EJointType[EJointType[\"Spring\"] = 3] = \"Spring\";\r\n    /**\r\n     * 锁定约束。\r\n     */\r\n    EJointType[EJointType[\"Lock\"] = 4] = \"Lock\";\r\n})(EJointType || (EJointType = {}));\r\n/**\r\n * 支持的拾取模式枚举。\r\n */\r\nvar EPickMode;\r\n(function (EPickMode) {\r\n    /**\r\n     * 只拾取距离摄像机最近的刚体，性能最佳。\r\n     *\r\n     * @deprecated\r\n     */\r\n    EPickMode[EPickMode[\"CLOSEST\"] = 1] = \"CLOSEST\";\r\n    /**\r\n     * 只拾取距离摄像机最近的刚体，性能最佳。\r\n     */\r\n    EPickMode[EPickMode[\"Closest\"] = 1] = \"Closest\";\r\n    /**\r\n     * 拾取任意的刚体。\r\n     */\r\n    EPickMode[EPickMode[\"Any\"] = 2] = \"Any\";\r\n    /**\r\n     * 拾取所有的刚体。\r\n     */\r\n    EPickMode[EPickMode[\"All\"] = 4] = \"All\";\r\n})(EPickMode || (EPickMode = {}));\n\n/**\r\n * **GlTFLoader的扩展相关，不要自己使用。**\r\n *\r\n * @hidden\r\n */\r\nvar ESeinNodeType;\r\n(function (ESeinNodeType) {\r\n    ESeinNodeType[ESeinNodeType[\"Component\"] = 1] = \"Component\";\r\n    ESeinNodeType[ESeinNodeType[\"Actor\"] = 2] = \"Actor\";\r\n})(ESeinNodeType || (ESeinNodeType = {}));\n\n/**\r\n * @File   : SName.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 2018/10/8 上午11:13:40\r\n * @Description:\r\n */\r\n/**\r\n * 判断一个实例是否为`isSName`。\r\n */\r\nfunction isSName(value) {\r\n    return value.isSName;\r\n}\r\n/**\r\n * 一个字符串池，用于构建名字，后续可以快速拿来进行对比。\r\n */\r\nvar SName = /** @class */ (function () {\r\n    /**\r\n     * 通过字符串创建一个实例。\r\n     */\r\n    function SName(name) {\r\n        this.isSName = true;\r\n        this._value = '';\r\n        this._index = 0;\r\n        this._value = name;\r\n        if (!SName.TABLE[name]) {\r\n            SName.INDEX += 1;\r\n            SName.TABLE[name] = SName.INDEX;\r\n        }\r\n        this._index = SName.TABLE[name];\r\n    }\r\n    Object.defineProperty(SName.prototype, \"value\", {\r\n        /**\r\n         * 获取实例的字符串值。\r\n         */\r\n        get: function () {\r\n            return this._value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SName.prototype.equalsTo = function (name) {\r\n        if (isSName(name)) {\r\n            return this._index === name._index;\r\n        }\r\n        if (!SName.TABLE[name]) {\r\n            return false;\r\n        }\r\n        return SName.TABLE[name] === this._index;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SName.prototype.toString = function () {\r\n        return this._value;\r\n    };\r\n    SName.INDEX = 0;\r\n    SName.TABLE = {};\r\n    return SName;\r\n}());\n\n/*! *****************************************************************************\r\nCopyright (c) Microsoft Corporation. All rights reserved.\r\nLicensed under the Apache License, Version 2.0 (the \"License\"); you may not use\r\nthis file except in compliance with the License. You may obtain a copy of the\r\nLicense at http://www.apache.org/licenses/LICENSE-2.0\r\n\r\nTHIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY\r\nKIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED\r\nWARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,\r\nMERCHANTABLITY OR NON-INFRINGEMENT.\r\n\r\nSee the Apache Version 2.0 License for specific language governing permissions\r\nand limitations under the License.\r\n***************************************************************************** */\r\n/* global Reflect, Promise */\r\n\r\nvar extendStatics = function(d, b) {\r\n    extendStatics = Object.setPrototypeOf ||\r\n        ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||\r\n        function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };\r\n    return extendStatics(d, b);\r\n};\r\n\r\nfunction __extends(d, b) {\r\n    extendStatics(d, b);\r\n    function __() { this.constructor = d; }\r\n    d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());\r\n}\r\n\r\nvar __assign = function() {\r\n    __assign = Object.assign || function __assign(t) {\r\n        for (var s, i = 1, n = arguments.length; i < n; i++) {\r\n            s = arguments[i];\r\n            for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p)) t[p] = s[p];\r\n        }\r\n        return t;\r\n    };\r\n    return __assign.apply(this, arguments);\r\n};\r\n\r\nfunction __rest(s, e) {\r\n    var t = {};\r\n    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)\r\n        t[p] = s[p];\r\n    if (s != null && typeof Object.getOwnPropertySymbols === \"function\")\r\n        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\r\n            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))\r\n                t[p[i]] = s[p[i]];\r\n        }\r\n    return t;\r\n}\r\n\r\nfunction __decorate(decorators, target, key, desc) {\r\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\r\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\r\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\r\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\r\n}\r\n\r\nfunction __awaiter(thisArg, _arguments, P, generator) {\r\n    return new (P || (P = Promise))(function (resolve, reject) {\r\n        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }\r\n        function rejected(value) { try { step(generator[\"throw\"](value)); } catch (e) { reject(e); } }\r\n        function step(result) { result.done ? resolve(result.value) : new P(function (resolve) { resolve(result.value); }).then(fulfilled, rejected); }\r\n        step((generator = generator.apply(thisArg, _arguments || [])).next());\r\n    });\r\n}\r\n\r\nfunction __generator(thisArg, body) {\r\n    var _ = { label: 0, sent: function() { if (t[0] & 1) throw t[1]; return t[1]; }, trys: [], ops: [] }, f, y, t, g;\r\n    return g = { next: verb(0), \"throw\": verb(1), \"return\": verb(2) }, typeof Symbol === \"function\" && (g[Symbol.iterator] = function() { return this; }), g;\r\n    function verb(n) { return function (v) { return step([n, v]); }; }\r\n    function step(op) {\r\n        if (f) throw new TypeError(\"Generator is already executing.\");\r\n        while (_) try {\r\n            if (f = 1, y && (t = op[0] & 2 ? y[\"return\"] : op[0] ? y[\"throw\"] || ((t = y[\"return\"]) && t.call(y), 0) : y.next) && !(t = t.call(y, op[1])).done) return t;\r\n            if (y = 0, t) op = [op[0] & 2, t.value];\r\n            switch (op[0]) {\r\n                case 0: case 1: t = op; break;\r\n                case 4: _.label++; return { value: op[1], done: false };\r\n                case 5: _.label++; y = op[1]; op = [0]; continue;\r\n                case 7: op = _.ops.pop(); _.trys.pop(); continue;\r\n                default:\r\n                    if (!(t = _.trys, t = t.length > 0 && t[t.length - 1]) && (op[0] === 6 || op[0] === 2)) { _ = 0; continue; }\r\n                    if (op[0] === 3 && (!t || (op[1] > t[0] && op[1] < t[3]))) { _.label = op[1]; break; }\r\n                    if (op[0] === 6 && _.label < t[1]) { _.label = t[1]; t = op; break; }\r\n                    if (t && _.label < t[2]) { _.label = t[2]; _.ops.push(op); break; }\r\n                    if (t[2]) _.ops.pop();\r\n                    _.trys.pop(); continue;\r\n            }\r\n            op = body.call(thisArg, _);\r\n        } catch (e) { op = [6, e]; y = 0; } finally { f = t = 0; }\r\n        if (op[0] & 5) throw op[1]; return { value: op[0] ? op[1] : void 0, done: true };\r\n    }\r\n}\r\n\r\nfunction __spreadArrays() {\r\n    for (var s = 0, i = 0, il = arguments.length; i < il; i++) s += arguments[i].length;\r\n    for (var r = Array(s), k = 0, i = 0; i < il; i++)\r\n        for (var a = arguments[i], j = 0, jl = a.length; j < jl; j++, k++)\r\n            r[k] = a[j];\r\n    return r;\r\n}\n\n/**\r\n * @File   : index.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 10/24/2018, 4:04:57 PM\r\n * @Description:\r\n */\r\n/**\r\n * 当前环境，一般为`development`或`production`。\r\n */\r\nvar env = 'production';\r\nif (typeof process !== 'undefined') {\r\n    env = \"development\";\r\n}\r\n/**\r\n * 是否是开发模式。\r\n */\r\nvar devMode = env !== 'production';\r\n/**\r\n * 调试用，仅在开发环境会做出的警告。\r\n */\r\nfunction warn() {\r\n    var args = [];\r\n    for (var _i = 0; _i < arguments.length; _i++) {\r\n        args[_i] = arguments[_i];\r\n    }\r\n    if (devMode) {\r\n        console.warn.apply(console, args);\r\n    }\r\n}\r\n/**\r\n * 调试用，将一个Canvas渲染到控制台。\r\n */\r\nfunction logCanvas(canvas, width) {\r\n    var height = width * canvas.height / canvas.width;\r\n    var url = canvas.toDataURL();\r\n    /*tslint:disable-next-line */\r\n    console.log('%c+', \"font-size: 1px; padding: \" + height / 2 + \"px \" + width / 2 + \"px; line-height: \" + height + \"px; background: url(\" + url + \"); background-size: \" + width + \"px \" + height + \"px; background-repeat: no-repeat; color: transparent;\");\r\n}\r\nvar Debug = { devMode: devMode, warn: warn, logCanvas: logCanvas, env: env };\n\n/**\r\n * 判断一个实例是否为`BaseException`。\r\n */\r\nfunction isBaseException(value) {\r\n    return value.isBaseException;\r\n}\r\n/**\r\n * Sein中的异常基类，用于封装特定异常，同时也作为异常边界系统的基础。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BaseException = /** @class */ (function (_super) {\r\n    __extends(BaseException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function BaseException(name, object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, message) || this;\r\n        _this.isBaseException = true;\r\n        /**\r\n         * 异常涉及到的SObject堆栈，生产环境无效。\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.objectStack = [];\r\n        _this.__proto__ = BaseException.prototype;\r\n        _this.name = name;\r\n        _this.object = object;\r\n        _this.type = new SName(_this.name || 'Unknown');\r\n        if (Debug.devMode) {\r\n            _this.objectStack = _this.initObjectStack();\r\n        }\r\n        return _this;\r\n    }\r\n    /**\r\n     * 从一个普通错误转换为异常。\r\n     */\r\n    BaseException.FROM_NATIVE_JS_ERROR = function (error, object) {\r\n        var err = new BaseException(error.name, object, error.message);\r\n        err.stack = error.stack;\r\n        return err;\r\n    };\r\n    /**\r\n     * 手动获取错误对象栈，在错误上报时可能有用。\r\n     */\r\n    BaseException.prototype.initObjectStack = function () {\r\n        var currentObj = this.object;\r\n        var stack = [];\r\n        while (currentObj) {\r\n            stack.push(currentObj.constructor.CLASS_NAME.value + \"(\" + currentObj.name.value + \")\");\r\n            currentObj = currentObj.parent;\r\n        }\r\n        return stack;\r\n    };\r\n    return BaseException;\r\n}(Error));\n\n/**\r\n * @File   : throwException.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 10/17/2018, 5:24:42 PM\r\n * @Description:\r\n */\r\nfunction isBaseException$1(error) {\r\n    return error.isBaseException;\r\n}\r\nfunction isFunction(value) {\r\n    return !!value.call;\r\n}\r\n/**\r\n * 抛出异常函数。作为错误边界系统最重要的方法，此函数允许你抛出异常或错误，并给出错误对象的栈，进行错误边界处理。\r\n * 详见[Exception](../guide/exception)。\r\n *\r\n * @param error 异常实例。\r\n * @param errorObject 触发异常的实例。\r\n * @param errorDetails 异常的细节。\r\n * @noInheritDoc\r\n */\r\nfunction throwException(error, errorObject, errorDetails) {\r\n    if (errorDetails === void 0) { errorDetails = null; }\r\n    var err = error;\r\n    if (!isBaseException$1(error)) {\r\n        err = BaseException.FROM_NATIVE_JS_ERROR(error, errorObject);\r\n    }\r\n    if (Debug.devMode) {\r\n        console.error(err);\r\n        /* tslint:disable-next-line */\r\n        console.log(\"%cStack: \" + err.objectStack.join(' -> '), 'color: #ff0000; background: rgba(255, 0, 0, .1); padding: 16px');\r\n    }\r\n    var currentObj = errorObject;\r\n    while (currentObj) {\r\n        if (currentObj.onError && isFunction(currentObj.onError)) {\r\n            if (currentObj.onError(err, errorDetails) === true) {\r\n                return;\r\n            }\r\n        }\r\n        currentObj = currentObj.parent;\r\n    }\r\n    throw err;\r\n}\n\n/**\r\n * @File   : SObject.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 2018/9/25 下午5:22:43\r\n * @Description:\r\n */\r\n/**\r\n * 判断一个实例是否为`SObject`。\r\n */\r\nfunction isSObject(value) {\r\n    return value.isSObject;\r\n}\r\n/**\r\n * Sein.js的基础类，除了单纯存在于渲染引擎的实例，比如材质、几何体等，所有类都继承自`SObject`。\r\n * 此基类提供了基础的`uuid`计算、序列化与反序列化等标注接口。\r\n */\r\nvar SObject = /** @class */ (function () {\r\n    function SObject(name) {\r\n        if (name === void 0) { name = ''; }\r\n        // for serialize and deserialize\r\n        // user can not modify\r\n        // public _serializableMembers: (keyof IStateTypes)[] = [];\r\n        /**\r\n         * 一个实例是否为SObject的判据。\r\n         */\r\n        this.isSObject = true;\r\n        /**\r\n         * 预留给编辑器（有的话）。\r\n         *\r\n         * @hidden\r\n         */\r\n        this.editable = true;\r\n        SObject.UUID += 1;\r\n        this._uuid = SObject.UUID;\r\n        this.name = new SName(name || this.constructor.CLASS_NAME.value + \"-\" + this._uuid);\r\n    }\r\n    Object.defineProperty(SObject.prototype, \"uuid\", {\r\n        /**\r\n         * 所有继承自`SObject`的类的实例的唯一ID。\r\n         */\r\n        get: function () {\r\n            return this._uuid;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SObject.prototype, \"className\", {\r\n        /**\r\n         * 实例的类名，代理到类的静态属性`CLASS_NAME`。\r\n         */\r\n        get: function () {\r\n            return this.constructor.CLASS_NAME;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SObject.prototype, \"classType\", {\r\n        /**\r\n         * 实例的类型，代理到类的静态属性`CLASS_NAME`。\r\n         * 预留，暂时没啥用。\r\n         */\r\n        get: function () {\r\n            return this.constructor.CLASS_TYPE;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 通过字符串修改实例名字。\r\n     */\r\n    SObject.prototype.rename = function (name) {\r\n        this.name = new SName(name);\r\n    };\r\n    /**\r\n     * 克隆一个实例，交由子类实现。\r\n     */\r\n    SObject.prototype.clone = function (object) {\r\n        throw new Error('Not implement.');\r\n    };\r\n    /**\r\n     * 实例序列化，交由子类实现。\r\n     *\r\n     * @todo: 暂未实现，预留。\r\n     */\r\n    SObject.prototype.serialize = function () {\r\n        throw new Error('Not implement.');\r\n    };\r\n    /**\r\n     * 从一个json序列反序列化，交由子类实现。\r\n     *\r\n     * @todo: 暂未实现，预留。\r\n     */\r\n    SObject.prototype.deserialize = function (json) {\r\n        throw new Error('Not implement.');\r\n    };\r\n    /**\r\n     * 生命周期之一，会在实例将要销毁时被触发。\r\n     */\r\n    SObject.prototype.onDestroy = function () {\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SObject.prototype.destroy = function () {\r\n        try {\r\n            this.onDestroy();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * 实例的类名，用于反射，在类被实例化后有`object.className`作为代理。\r\n     */\r\n    SObject.CLASS_NAME = new SName('SObject');\r\n    /**\r\n     * 实例的类型用于反射，在类被实例化后有`object.classType`作为代理。\r\n     * 预留，暂时没用。\r\n     */\r\n    SObject.CLASS_TYPE = new SName('SObject');\r\n    /**\r\n     * 存储着所有监视器装饰器`SInspect`的类与属性表。配合`inspectable`装饰器使用。\r\n     *\r\n     * 每一个属性有`type`确定检视类型，不传则按照实际数据类型自动反射。\r\n     * 而`options`则是一个在特定`type`下一个的参数。\r\n     *\r\n     * 注意引擎本身不会对这个元信息做任何操作，只有引入了`seinjs-inspector`才会有效。\r\n     */\r\n    SObject.INSPECTABLE_PROPERTIES = {};\r\n    SObject.UUID = 0;\r\n    return SObject;\r\n}());\n\n/**\r\n * 全局单例，存储着所有`SClass`的键(`className`)和类的对应表。\r\n */\r\nvar MetaSClasses = {};\r\n/**\r\n * 全局单例，存储着所有`SMaterial`的键(`className`)和类的对应表。\r\n */\r\nvar MetaSMaterials = {};\n\n/* tslint:disable */\r\n/**\r\n * 装饰器，用于指定一个继承自`SObject`的类的类名和类型，并将其添加到全局的元信息中。\r\n */\r\nfunction SClass(options) {\r\n    return function Decorator(constructor) {\r\n        var Class = constructor;\r\n        Class.CLASS_NAME = new SName(options.className);\r\n        if (options.classType) {\r\n            Class.CLASS_TYPE = new SName(options.classType);\r\n        }\r\n        return MetaSClasses[options.className] = Class;\r\n    };\r\n}\r\n/**\r\n * 装饰器，用于指定一个继承自`RawShaderMaterial`的类的类名，并将其添加到全局的元信息中。\r\n */\r\nfunction SMaterial(options) {\r\n    return function Decorator(constructor) {\r\n        constructor.CLASS_NAME = new SName(options.className);\r\n        MetaSMaterials[options.className] = constructor;\r\n        return constructor;\r\n    };\r\n}\r\n/* tslint:enable */\r\n/**\r\n * @hidden\r\n */\r\nfunction serialize(target, key) {\r\n    // target._serializableMembers[key] = true;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction deprecated(target, key) {\r\n}\r\n/**\r\n * 装饰器，用于指定在`seinjs-inspector`中可检视的属性。\r\n *\r\n * @param type 检视属性的类型，若不指定则会根据类型自动判断。\r\n * @param options 检视属性的配置，用于比如`range`这种类型指定边界。\r\n */\r\nfunction inspectable(type, options) {\r\n    return function Decorator(target, key, descriptor) {\r\n        var clz = target.constructor;\r\n        if (!clz.CLASS_NAME) {\r\n            Debug.warn(\"'inspectable' decorator must be applied to property in 'SObject' with 'SClass' decorator!\");\r\n            return;\r\n        }\r\n        var obj = clz.INSPECTABLE_PROPERTIES = clz.INSPECTABLE_PROPERTIES || {};\r\n        obj[key] = {};\r\n        if (type) {\r\n            obj[key].type = type;\r\n        }\r\n        if (options) {\r\n            obj[key].options = options;\r\n        }\r\n        if (descriptor && !descriptor.writable) {\r\n            obj[key].readonly = true;\r\n        }\r\n    };\r\n}\n\n/**\r\n * 判断一个实例是否为`Observable`。\r\n */\r\nfunction isObservable(value) {\r\n    return value.isObservable;\r\n}\r\n/**\r\n * 可观察对象，事件机制的底层基础，维护一个观察回调队列。\r\n *\r\n * @template 队列中回调的参数类型。\r\n */\r\nvar Observable = /** @class */ (function (_super) {\r\n    __extends(Observable, _super);\r\n    /**\r\n     * @param parent 可选，用于构造异常链。\r\n     * @param name 可选，用于指定名字。\r\n     */\r\n    function Observable(parent, name) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isObservable = true;\r\n        /**\r\n         * 当队列从非空变为空时将会被触发的回调。\r\n         */\r\n        _this.onEmpty = function () { };\r\n        /**\r\n         * 父级SObject实例。\r\n         */\r\n        _this.parent = null;\r\n        _this._index = 0;\r\n        _this._length = 0;\r\n        _this._queue = [];\r\n        _this.parent = parent;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Observable.prototype, \"count\", {\r\n        /**\r\n         * 拥有的监听者数量。\r\n         */\r\n        get: function () {\r\n            return this._queue.length;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 添加一个回调到队列中。\r\n     */\r\n    Observable.prototype.add = function (callback, priority) {\r\n        if (priority !== undefined) {\r\n            this._queue.splice(priority, 0, { callback: callback, isOnce: false });\r\n        }\r\n        else {\r\n            this._queue.push({ callback: callback, isOnce: false });\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 添加一个回调到队列中，并再被触发执行一次后自动移除。\r\n     */\r\n    Observable.prototype.addOnce = function (callback, priority) {\r\n        if (priority !== undefined) {\r\n            this._queue.splice(priority, 0, { callback: callback, isOnce: true });\r\n        }\r\n        else {\r\n            this._queue.push({ callback: callback, isOnce: true });\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 清空队列。\r\n     */\r\n    Observable.prototype.clear = function () {\r\n        this._queue = [];\r\n        this.onEmpty();\r\n        return this;\r\n    };\r\n    /**\r\n     * 从队列中移除一个回调。\r\n     */\r\n    Observable.prototype.remove = function (callback) {\r\n        var length = this._queue.length;\r\n        var index = -1;\r\n        for (var i = 0; i < length; i += 1) {\r\n            if (this._queue[i].callback === callback) {\r\n                index = i;\r\n            }\r\n        }\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        this._queue.splice(index, 1);\r\n        // Guard: If remove a handler while notify\r\n        this._index -= 1;\r\n        this._length -= 1;\r\n        if (length === 1) {\r\n            this.onEmpty();\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 通过一个参数触发一次广播，调用所有回调。\r\n     */\r\n    Observable.prototype.notify = function (params) {\r\n        var originLength = this._queue.length;\r\n        this._index = 0;\r\n        this._length = originLength;\r\n        while (this._index < this._length) {\r\n            var _a = this._queue[this._index], callback = _a.callback, isOnce = _a.isOnce;\r\n            if (isOnce) {\r\n                this._queue.splice(this._index, 1);\r\n                this._length -= 1;\r\n            }\r\n            else {\r\n                this._index += 1;\r\n            }\r\n            try {\r\n                if (callback(params) === true) {\r\n                    return this;\r\n                }\r\n            }\r\n            catch (error) {\r\n                throwException(error, this);\r\n            }\r\n        }\r\n        if (originLength > 0 && this._length === 0) {\r\n            this.onEmpty();\r\n        }\r\n        return this;\r\n    };\r\n    Observable = __decorate([\r\n        SClass({ className: 'Observable' })\r\n    ], Observable);\r\n    return Observable;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`MissingMemberException`。\r\n */\r\nfunction isMissingMemberException(value) {\r\n    return value.isMissingMemberException;\r\n}\r\n/**\r\n * 成员缺失异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar MissingMemberException = /** @class */ (function (_super) {\r\n    __extends(MissingMemberException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param parent 成员父级实例。\r\n     * @param memberType 成员类型。\r\n     * @param memberName 成员名称。\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function MissingMemberException(parent, memberType, memberName, object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'MissingMember', object, parent.className + \" \\\"\" + parent.name + \"\\\" does not have \" + memberType + \" \\\"\" + memberName + \"\\\". \" + message) || this;\r\n        _this.isMissingMemberException = true;\r\n        return _this;\r\n    }\r\n    return MissingMemberException;\r\n}(BaseException));\n\n/**\r\n * 判断一个实例是否为`EventManager`。\r\n */\r\nfunction isEventManager(value) {\r\n    return value.isEventManager;\r\n}\r\n/**\r\n * 事件管理器类。作为事件的集中管理容器，承担着引擎绝大多数部分的事件注册、分发。\r\n *\r\n * @template IDefaultEvents 用于标注所有事件的名称以及对应的事件参数类型。\r\n * @noInheritDoc\r\n */\r\nvar EventManager = /** @class */ (function (_super) {\r\n    __extends(EventManager, _super);\r\n    /**\r\n     * @param objHasGame 拥有`getGame()`方法和`onError`方法的对象。\r\n     */\r\n    function EventManager(objHasGame) {\r\n        if (objHasGame === void 0) { objHasGame = null; }\r\n        var _this = _super.call(this, objHasGame.name.value) || this;\r\n        _this.isEventManager = true;\r\n        _this._observables = {};\r\n        _this._triggers = {};\r\n        _this._caches = {};\r\n        _this._objHasGame = null;\r\n        _this._objHasGame = objHasGame;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(EventManager.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例引用，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._objHasGame;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    EventManager.prototype.getGame = function () {\r\n        return this._objHasGame.getGame();\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在游戏中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    EventManager.prototype.onError = function () {\r\n    };\r\n    EventManager.prototype.register = function (type, TriggerClass) {\r\n        var _this = this;\r\n        if (this._observables[type]) {\r\n            Debug.warn(\"Event \" + type + \" is already registered, before re-register, please unregister it at first !\");\r\n            return this;\r\n        }\r\n        this._observables[type] = new Observable(this, type);\r\n        this._observables[type].onEmpty = function () {\r\n            if (_this._triggers[type] && !_this._triggers[type].paused) {\r\n                _this._triggers[type].pause();\r\n            }\r\n        };\r\n        if (TriggerClass) {\r\n            this._triggers[type] = new TriggerClass(type, this, this.getGame());\r\n        }\r\n        return this;\r\n    };\r\n    EventManager.prototype.unregister = function (type) {\r\n        if (!this._observables[type]) {\r\n            return this;\r\n        }\r\n        delete this._observables[type];\r\n        if (this._triggers[type]) {\r\n            this._triggers[type].destroy();\r\n            delete this._triggers[type];\r\n        }\r\n        return this;\r\n    };\r\n    EventManager.prototype.add = function (type, callback, priority) {\r\n        if (!this._observables[type]) {\r\n            this.register(type);\r\n        }\r\n        this._observables[type].add(callback, priority);\r\n        if (this._triggers[type] && this._triggers[type].paused) {\r\n            this._triggers[type].begin();\r\n        }\r\n        return this;\r\n    };\r\n    EventManager.prototype.addOnce = function (type, callback, priority) {\r\n        if (!this._observables[type]) {\r\n            this.register(type);\r\n        }\r\n        this._observables[type].addOnce(callback, priority);\r\n        if (this._triggers[type] && this._triggers[type].paused) {\r\n            this._triggers[type].begin();\r\n        }\r\n        return this;\r\n    };\r\n    EventManager.prototype.remove = function (type, callback) {\r\n        if (!this._observables[type]) {\r\n            return this;\r\n        }\r\n        this._observables[type].remove(callback);\r\n        return this;\r\n    };\r\n    /**\r\n     * 判断一个事件是否被注册。\r\n     */\r\n    EventManager.prototype.has = function (type) {\r\n        return !!this._observables[type];\r\n    };\r\n    /**\r\n     * 判断一个时间的监听者数量。\r\n     */\r\n    EventManager.prototype.getCount = function (type) {\r\n        if (!this.has(type)) {\r\n            return 0;\r\n        }\r\n        return this._observables[type].count;\r\n    };\r\n    EventManager.prototype.clear = function (type) {\r\n        if (!this._observables[type]) {\r\n            throwException(new MissingMemberException(this, 'Event', type, this), this);\r\n        }\r\n        this._observables[type].clear();\r\n        return this;\r\n    };\r\n    EventManager.prototype.trigger = function (type, event, immediately) {\r\n        if (immediately === void 0) { immediately = true; }\r\n        if (!this._observables[type]) {\r\n            throwException(new MissingMemberException(this, 'Event', type, this, 'Register it before trigger !'), this);\r\n        }\r\n        if (immediately || this.getGame().paused) {\r\n            this._observables[type].notify(event);\r\n            return this;\r\n        }\r\n        this._caches[type] = event;\r\n        return this;\r\n    };\r\n    EventManager.prototype.flush = function (type) {\r\n        if (!this._observables[type]) {\r\n            throw new MissingMemberException(this, 'Event', type, this, 'Register it before flush !');\r\n        }\r\n        var event = this._caches[type];\r\n        if (event) {\r\n            delete this._caches[type];\r\n            this._observables[type].notify(event);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 分发所有缓存的事件，一般不需要自行触发。\r\n     */\r\n    EventManager.prototype.flushAll = function () {\r\n        for (var type in this._caches) {\r\n            this.flush(type);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    EventManager.prototype.onDestroy = function () {\r\n        for (var type in this._triggers) {\r\n            this._triggers[type].destroy();\r\n        }\r\n    };\r\n    EventManager = __decorate([\r\n        SClass({ className: 'EventManager', classType: 'EventManager' })\r\n    ], EventManager);\r\n    return EventManager;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`Component`。\r\n */\r\nfunction isComponent(value) {\r\n    return value.isComponent;\r\n}\r\n/**\r\n * 游戏实体的功能的最小抽象，是Actor实际功能的体现。\r\n *\r\n * @template IStateTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n * @noInheritDoc\r\n */\r\nvar Component = /** @class */ (function (_super) {\r\n    __extends(Component, _super);\r\n    /**\r\n     * 构造Component，**不可自行构造！！！**请参见`actor.addComponent`方法。\r\n     */\r\n    function Component(name, actor, initState) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isComponent = true;\r\n        /**\r\n         * 自身是否为根组件。\r\n         */\r\n        _this.isRoot = false;\r\n        /**\r\n         * Component是否需要在每一帧进行进行`update`调用，如果为`false`，则将不会触发`onUpdate`生命周期（包括挂载在其下的所有Component）。\r\n         * 用于性能优化。\r\n         */\r\n        _this.updateOnEverTick = true;\r\n        /**\r\n         * 是否要将自身加入其挂载的Actor的更新队列中，同时决定自身是否要跟随Actor销毁。\r\n         * 如果为`false`，则说明此Component是一个纯静态组件（比如单纯的图元组件，没有逻辑）。\r\n         * 用于性能优化。\r\n         */\r\n        _this.needUpdateAndDestroy = true;\r\n        /**\r\n         * 是否允许自身在运行时被动态移除，用于保护某些特殊Component，比如根组件默认不可移除。\r\n         */\r\n        _this.canBeRemoved = true;\r\n        _this._owner = null;\r\n        _this._event = null;\r\n        _this._initState = initState || {};\r\n        _this._owner = actor;\r\n        _this._event = new EventManager(_this);\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Component.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例，根据情况不同可能有不同的类型，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._owner;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Component.prototype, \"event\", {\r\n        /**\r\n         * 获取自身的事件系统管理器。\r\n         */\r\n        get: function () {\r\n            return this._event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 用于验证一个该组件在当前状态是否可被添加，一般用于防止重复添加不可重复的组件。\r\n     * 你可以重写此方法来达成验证，如果验证不通过请抛出异常。\r\n     * 注意，此验证仅会在`development`环境下被执行！\r\n     */\r\n    Component.prototype.verifyAdding = function (initState) { };\r\n    /**\r\n     * 用于验证一个该组件在当前状态是否可被移除。\r\n     * 你可以重写此方法来达成验证，如果验证不通过请抛出异常。\r\n     * 注意，此验证仅会在`development`环境下被执行！\r\n     */\r\n    Component.prototype.verifyRemoving = function () { };\r\n    /**\r\n     * 生命周期，将在Component被创建后调用。\r\n     */\r\n    Component.prototype.onInit = function (initState) {\r\n    };\r\n    /**\r\n     * 生命周期，将在加入了Actor并且父级Actor被正式添加到了游戏中后调用。\r\n     */\r\n    Component.prototype.onAdd = function (initState) {\r\n    };\r\n    /**\r\n     * 生命周期，将在正式加入游戏后，并且`updateOnEverTick`与`needUpdateAndDestroy`均为`true`时在每一帧被调用。\r\n     */\r\n    Component.prototype.onUpdate = function (delta) {\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在游戏中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Component.prototype.onError = function (error, details) {\r\n    };\r\n    /**\r\n     * 当父级Actor被`unLink`时触发，详见[actor.unLink](../classes/actor#unlink).\r\n     */\r\n    Component.prototype.onUnLink = function () {\r\n    };\r\n    /**\r\n     * 当父级Actor被`reLink`时触发，详见[actor.reLink](../classes/actor#relink).\r\n     */\r\n    Component.prototype.onReLink = function () {\r\n    };\r\n    /**\r\n     * 生命周期，将在Component被销毁时触发。\r\n     */\r\n    Component.prototype.onDestroy = function () {\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.initialized = function () {\r\n        try {\r\n            this.onInit(this._initState);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.added = function () {\r\n        try {\r\n            this.onAdd(this._initState);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.update = function (delta) {\r\n        if (!this.updateOnEverTick || !this.parent) {\r\n            return;\r\n        }\r\n        try {\r\n            this.onUpdate(delta);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.unLink = function () {\r\n        try {\r\n            this.onUnLink();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.reLink = function () {\r\n        try {\r\n            this.onReLink();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Component.prototype.destroy = function () {\r\n        if (!this._owner) {\r\n            return;\r\n        }\r\n        this._event.destroy();\r\n        _super.prototype.destroy.call(this);\r\n        this._owner = null;\r\n    };\r\n    /**\r\n     * 获取当前`Game`实例。\r\n     *\r\n     * @template IGameState 当前游戏状态管理器的类型。\r\n     */\r\n    Component.prototype.getGame = function () {\r\n        return this._owner.getGame();\r\n    };\r\n    /**\r\n     * 获取当前`World`实例。\r\n     *\r\n     * @template IWorldState 当前世界状态管理器的类型。\r\n     */\r\n    Component.prototype.getWorld = function () {\r\n        return this._owner.getWorld();\r\n    };\r\n    /**\r\n     * 获取当前`Level`实例。\r\n     *\r\n     * @template ILevelState 当前关卡状态管理器的类型。\r\n     */\r\n    Component.prototype.getLevel = function () {\r\n        return this._owner.getLevel();\r\n    };\r\n    /**\r\n     * 仅在初始化了物理引擎之后，用于获取当前物理世界`PhysicWorld`实例。\r\n     * 如何使用物理引擎请见**Guide**和**Demo**。\r\n     */\r\n    Component.prototype.getPhysicWorld = function () {\r\n        return this._owner.getPhysicWorld();\r\n    };\r\n    /**\r\n     * 获取当前拥有自己的`Actor`。\r\n     *\r\n     * @template TOwner Actor的类型。\r\n     */\r\n    Component.prototype.getOwner = function () {\r\n        return this._owner;\r\n    };\r\n    /**\r\n     * 获取当前拥有自己的`Actor`的根组件。\r\n     *\r\n     * @template TRoot 根组件的类型。\r\n     */\r\n    Component.prototype.getRoot = function () {\r\n        return this._owner.root;\r\n    };\r\n    /**\r\n     * 将自己从父级移除，基本等同于`destroy`方法，从Owner中销毁自身。\r\n     */\r\n    Component.prototype.removeFromParent = function () {\r\n        this._owner.removeComponent(this);\r\n    };\r\n    Component = __decorate([\r\n        SClass({ className: 'Component', classType: 'Component' })\r\n    ], Component);\r\n    return Component;\r\n}(SObject));\n\nfunction isT(item) {\r\n    return item.isSObject;\r\n}\r\n/**\r\n * 可迭代对象基类，Sein.js封装的用于存储`SObject`实例的特殊容器。\r\n * 一般使用此基类的子类，不直接使用自身。\r\n *\r\n * @template T 存储的实例的类型。\r\n */\r\nvar SIterable = /** @class */ (function () {\r\n    function SIterable() {\r\n        this._array = [];\r\n    }\r\n    Object.defineProperty(SIterable.prototype, \"length\", {\r\n        /**\r\n         * 存储实例的个数。\r\n         */\r\n        get: function () {\r\n            return this._array.length;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SIterable.prototype, \"empty\", {\r\n        /**\r\n         * 是否为空。\r\n         */\r\n        get: function () {\r\n            return this._array.length === 0;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 从一个基本的数组实例初始化SIterable。\r\n     */\r\n    SIterable.prototype.fromArray = function (array) {\r\n        throw new Error('Not implemented');\r\n    };\r\n    /**\r\n     * 对存储的所有实例进行迭代。\r\n     * 通过回调的返回值设`true`，你可以终止迭代，这用于性能优化。\r\n     */\r\n    SIterable.prototype.forEach = function (func) {\r\n        var length = this.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            if (func(this._array[index])) {\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 清空所有存储的实例。\r\n     */\r\n    SIterable.prototype.clear = function () {\r\n        this._array = [];\r\n        return this;\r\n    };\r\n    SIterable.prototype.addItem = function (item) {\r\n        this._array.push(item);\r\n    };\r\n    SIterable.prototype.removeItem = function (item) {\r\n        var index;\r\n        if (isT(item)) {\r\n            index = this._array.indexOf(item);\r\n            if (index < 0) {\r\n                return;\r\n            }\r\n        }\r\n        else {\r\n            index = item;\r\n            item = this._array[index];\r\n            if (!item) {\r\n                return;\r\n            }\r\n        }\r\n        this._array.splice(index, 1);\r\n    };\r\n    /**\r\n     * 根据类来查找第一个实例。\r\n     */\r\n    SIterable.prototype.findByClass = function (Class) {\r\n        return this.findByFilter(function (item) { return item.className.equalsTo(Class.CLASS_NAME); });\r\n    };\r\n    /**\r\n     * 根据类来查找所有实例。\r\n     *\r\n     * @param stopFinding 通过当前实例判断是否要继续搜索，返回`true`则停止搜索，用于性能优化。\r\n     */\r\n    SIterable.prototype.findAllByClass = function (Class, stopFinding) {\r\n        return this.findAllByFilter(function (item) { return item.className.equalsTo(Class.CLASS_NAME); }, stopFinding);\r\n    };\r\n    /**\r\n     * 根据类型来查找第一个实例。\r\n     */\r\n    SIterable.prototype.findByClassType = function (classType) {\r\n        return this.findByFilter(function (item) { return item.classType.equalsTo(classType); });\r\n    };\r\n    /**\r\n     * 根据类型来查找所有实例。\r\n     *\r\n     * @param stopFinding 通过当前实例判断是否要继续搜索，返回`true`则停止搜索，用于性能优化。\r\n     */\r\n    SIterable.prototype.findAllByClassType = function (classType, stopFinding) {\r\n        return this.findAllByFilter(function (item) { return item.classType.equalsTo(classType); }, stopFinding);\r\n    };\r\n    /**\r\n     * 通过名字查找第一个实例。\r\n     */\r\n    SIterable.prototype.findByName = function (name) {\r\n        return this.findByFilter(function (item) { return item.name.equalsTo(name); });\r\n    };\r\n    /**\r\n     * 通过名字查找所有实例。\r\n     *\r\n     * @param stopFinding 通过当前实例判断是否要继续搜索，返回`true`则停止搜索，用于性能优化。\r\n     */\r\n    SIterable.prototype.findAllByName = function (name, stopFinding) {\r\n        return this.findAllByFilter(function (item) { return item.name.equalsTo(name); }, stopFinding);\r\n    };\r\n    /**\r\n     * 根据给定的filter函数来查找第一个实例。\r\n     */\r\n    SIterable.prototype.findByFilter = function (filter) {\r\n        var element = null;\r\n        this.forEach(function (ele) {\r\n            if (filter(ele)) {\r\n                element = ele;\r\n                return true;\r\n            }\r\n        });\r\n        return element;\r\n    };\r\n    /**\r\n     * 根据给定的filter函数来查找所有实例。\r\n     *\r\n     * @param stopFinding 通过当前实例判断是否要继续搜索，返回`true`则停止搜索，用于性能优化。\r\n     */\r\n    SIterable.prototype.findAllByFilter = function (filter, stopFinding) {\r\n        var result = [];\r\n        this.forEach(function (ele) {\r\n            if (filter(ele)) {\r\n                result.push(ele);\r\n                if (stopFinding && stopFinding(ele, result)) {\r\n                    return true;\r\n                }\r\n            }\r\n        });\r\n        return result;\r\n    };\r\n    /**\r\n     * 序列化，尚未实现。\r\n     *\r\n     * @hidden\r\n     */\r\n    SIterable.prototype.serialize = function () {\r\n        throw new Error('Not implemented');\r\n    };\r\n    /**\r\n     * 反序列化，尚未实现。\r\n     *\r\n     * @hidden\r\n     */\r\n    SIterable.prototype.deserialize = function (json) {\r\n        throw new Error('Not implemented');\r\n    };\r\n    return SIterable;\r\n}());\n\n/**\r\n * Sein.js封装的用于存储`SObject`实例的特殊数组容器。\r\n *\r\n * @template T 存储的实例的类型。\r\n */\r\nvar SArray = /** @class */ (function (_super) {\r\n    __extends(SArray, _super);\r\n    function SArray() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(SArray.prototype, \"array\", {\r\n        /**\r\n         * 原始基础数组。\r\n         */\r\n        get: function () {\r\n            return this._array;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 添加一个实例到容器中。\r\n     */\r\n    SArray.prototype.add = function (item) {\r\n        this.addItem(item);\r\n        return this;\r\n    };\r\n    /**\r\n     * 从容器中移除一个实例。\r\n     */\r\n    SArray.prototype.remove = function (item) {\r\n        this.removeItem(item);\r\n        return this;\r\n    };\r\n    /**\r\n     * 修改`index`索引处的实例。\r\n     */\r\n    SArray.prototype.set = function (index, value) {\r\n        this._array[index] = value;\r\n        return this;\r\n    };\r\n    /**\r\n     * 在`index`索引处后方插入一个实例。\r\n     */\r\n    SArray.prototype.insert = function (index, value) {\r\n        this._array.splice(index, 0, value);\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取`index`索引处的实例引用。\r\n     */\r\n    SArray.prototype.get = function (index) {\r\n        return this._array[index];\r\n    };\r\n    /**\r\n     * 释放容器队列中的最后一个实例。\r\n     */\r\n    SArray.prototype.pop = function () {\r\n        var length = this.length;\r\n        var item = this._array[length];\r\n        this.removeItem(length);\r\n        return item;\r\n    };\r\n    /**\r\n     * 查找实例在容器中的索引。\r\n     */\r\n    SArray.prototype.indexOf = function (item) {\r\n        return this._array.indexOf(item);\r\n    };\r\n    /**\r\n     * 合并当前和另一个容器。\r\n     */\r\n    SArray.prototype.merge = function (array) {\r\n        Array.prototype.push.apply(this._array, array._array);\r\n        return this;\r\n    };\r\n    /**\r\n     * 从另一个容器复制数据。\r\n     */\r\n    SArray.prototype.copy = function (array) {\r\n        this._array = array.array.slice();\r\n        return this;\r\n    };\r\n    /**\r\n     * 从一个基本的数组实例初始化SIterable。\r\n     */\r\n    SArray.prototype.fromArray = function (array) {\r\n        this._array = array.slice();\r\n        return this;\r\n    };\r\n    return SArray;\r\n}(SIterable));\n\nvar commonjsGlobal = typeof globalThis !== 'undefined' ? globalThis : typeof window !== 'undefined' ? window : typeof global !== 'undefined' ? global : typeof self !== 'undefined' ? self : {};\n\nfunction unwrapExports (x) {\n\treturn x && x.__esModule && Object.prototype.hasOwnProperty.call(x, 'default') ? x['default'] : x;\n}\n\nfunction createCommonjsModule(fn, module) {\n\treturn module = { exports: {} }, fn(module, module.exports), module.exports;\n}\n\nvar Hilo3d = createCommonjsModule(function (module, exports) {\n/*!\n * Hilo3d 1.15.8\n * Copyright (c) 2017-present Alibaba Group Holding Ltd.\n * @license MIT\n */\nwindow[\"Hilo3d\"] =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// define __esModule on exports\n/******/ \t__webpack_require__.r = function(exports) {\n/******/ \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n/******/ \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n/******/ \t\t}\n/******/ \t\tObject.defineProperty(exports, '__esModule', { value: true });\n/******/ \t};\n/******/\n/******/ \t// create a fake namespace object\n/******/ \t// mode & 1: value is a module id, require it\n/******/ \t// mode & 2: merge all properties of value into the ns\n/******/ \t// mode & 4: return value when already ns object\n/******/ \t// mode & 8|1: behave like require\n/******/ \t__webpack_require__.t = function(value, mode) {\n/******/ \t\tif(mode & 1) value = __webpack_require__(value);\n/******/ \t\tif(mode & 8) return value;\n/******/ \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n/******/ \t\tvar ns = Object.create(null);\n/******/ \t\t__webpack_require__.r(ns);\n/******/ \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n/******/ \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n/******/ \t\treturn ns;\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ({\n\n/***/ \"./node_modules/_amc@1.0.6@amc/build/amd.js\":\n/*!**************************************************!*\\\n  !*** ./node_modules/_amc@1.0.6@amc/build/amd.js ***!\n  \\**************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = function (e) {\n  var t = {};\n\n  function n(r) {\n    if (t[r]) return t[r].exports;\n    var i = t[r] = {\n      i: r,\n      l: !1,\n      exports: {}\n    };\n    return e[r].call(i.exports, i, i.exports, n), i.l = !0, i.exports;\n  }\n\n  return n.m = e, n.c = t, n.d = function (e, t, r) {\n    n.o(e, t) || Object.defineProperty(e, t, {\n      enumerable: !0,\n      get: r\n    });\n  }, n.r = function (e) {\n    \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(e, Symbol.toStringTag, {\n      value: \"Module\"\n    }), Object.defineProperty(e, \"__esModule\", {\n      value: !0\n    });\n  }, n.t = function (e, t) {\n    if (1 & t && (e = n(e)), 8 & t) return e;\n    if (4 & t && \"object\" == typeof e && e && e.__esModule) return e;\n    var r = Object.create(null);\n    if (n.r(r), Object.defineProperty(r, \"default\", {\n      enumerable: !0,\n      value: e\n    }), 2 & t && \"string\" != typeof e) for (var i in e) {\n      n.d(r, i, function (t) {\n        return e[t];\n      }.bind(null, i));\n    }\n    return r;\n  }, n.n = function (e) {\n    var t = e && e.__esModule ? function () {\n      return e[\"default\"];\n    } : function () {\n      return e;\n    };\n    return n.d(t, \"a\", t), t;\n  }, n.o = function (e, t) {\n    return Object.prototype.hasOwnProperty.call(e, t);\n  }, n.p = \"\", n(n.s = 2);\n}([function (e, t, n) {\n  function r(e, t) {\n    for (var n = 0; n < t.length; n++) {\n      var r = t[n];\n      r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n    }\n  }\n\n  function i(e, t, n) {\n    return t && r(e.prototype, t), n && r(e, n), e;\n  }\n\n  var a = n(1),\n      o = {\n    POSITION: \"POSITION\",\n    NORMAL: \"NORMAL\",\n    COLOR: \"COLOR\",\n    COLOR_0: \"COLOR\",\n    COLOR_1: \"COLOR_1\",\n    TEXCOORD: \"TEXCOORD\",\n    TEXCOORD_0: \"TEXCOORD\",\n    TEXCOORD_1: \"TEXCOORD_1\",\n    TEXCOORD_2: \"TEXCOORD_2\",\n    TANGENT: \"TANGENT\",\n    JOINT: \"JOINT\",\n    JOINTS_0: \"JOINT\",\n    WEIGHT: \"WEIGHT\",\n    WEIGHTS_0: \"WEIGHT\"\n  },\n      s = [\"POSITION\", \"NORMAL\", \"COLOR\", \"TEXCOORD\", \"TANGENT\", \"JOINT\", \"WEIGHT\", \"OTHER\", \"TEXCOORD_1\", \"TEXCOORD_2\", \"COLOR_1\"],\n      u = {\n    POSITION: 0,\n    NORMAL: 1,\n    COLOR: 2,\n    TEXCOORD: 3,\n    TANGENT: 4,\n    JOINT: 5,\n    WEIGHT: 6,\n    OTHER: 7,\n    TEXCOORD_1: 8,\n    TEXCOORD_2: 9,\n    COLOR_1: 10\n  },\n      c = {\n    POSITION: \"vertices\",\n    NORMAL: \"normals\",\n    COLOR: \"colors\",\n    TEXCOORD: \"uvs\",\n    TEXCOORD_1: \"uvs1\",\n    TEXCOORD_2: \"uvs2\",\n    TANGENT: \"tangents\",\n    JOINT: \"skinIndices\",\n    WEIGHT: \"skinWeights\"\n  },\n      h = {\n    vertices: \"POSITION\",\n    _normals: \"NORMAL\",\n    colors: \"COLOR\",\n    uvs: \"TEXCOORD\",\n    uvs1: \"TEXCOORD_1\",\n    uvs2: \"TEXCOORD_2\",\n    _tangents: \"TANGENT\",\n    skinIndices: \"JOINT\",\n    skinWeights: \"WEIGHT\"\n  },\n      l = {\n    POSITION: 3,\n    NORMAL: 3,\n    COLOR: 3,\n    COLOR_1: 3,\n    TEXCOORD: 2,\n    TEXCOORD_1: 2,\n    TEXCOORD_2: 2,\n    TANGENT: 4,\n    JOINT: 4,\n    WEIGHT: 4\n  },\n      f = function () {\n    function e(t) {\n      var n = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 4;\n      !function (e, t) {\n        if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n      }(this, e), this.indices = t, this.mode = n, this.attrs = [], this.attrIndexMap = {};\n    }\n\n    return i(e, null, [{\n      key: \"cp\",\n      value: function value(e) {\n        return e;\n      }\n    }, {\n      key: \"minus\",\n      value: function value(e, t) {\n        return e - t;\n      }\n    }, {\n      key: \"plus\",\n      value: function value(e, t) {\n        return e + t;\n      }\n    }, {\n      key: \"pp\",\n      value: function value(e, t, n, r) {\n        return r - t - n + e;\n      }\n    }, {\n      key: \"depp\",\n      value: function value(e, t, n, r) {\n        return t + n - e + r;\n      }\n    }, {\n      key: \"ATTR\",\n      get: function get() {\n        return o;\n      }\n    }, {\n      key: \"ATTR_NAME_ID\",\n      get: function get() {\n        return u;\n      }\n    }]), i(e, [{\n      key: \"getAttrLength\",\n      value: function value() {\n        return this.attrs[0].data.length / this.attrs[0].itemCount;\n      }\n    }, {\n      key: \"attrIdToName\",\n      value: function value(e) {\n        return s[e] || \"OTHER\";\n      }\n    }, {\n      key: \"addAttr\",\n      value: function value(e, t, n) {\n        o[e] ? (this.attrIndexMap[e] = this.attrs.length, n || (n = l[e])) : n || (n = 1), this.attrs.push({\n          name: e,\n          itemCount: n,\n          data: t\n        });\n      }\n    }, {\n      key: \"getAttr\",\n      value: function value(e) {\n        if (this.attrIndexMap[e]) return this.attrs[this.attrIndexMap[e]];\n\n        for (var t = this.attrs.length - 1; t >= 0; t--) {\n          var n = this.attrs[t];\n          if (n.name === e) return n;\n        }\n      }\n    }, {\n      key: \"cal\",\n      value: function value(e, t, n) {\n        for (var r = arguments.length, i = new Array(r > 3 ? r - 3 : 0), a = 3; a < r; a++) {\n          i[a - 3] = arguments[a];\n        }\n\n        this.attrs.forEach(function (r, a) {\n          for (var o = r.data, s = e.attrs[a].data, u = t * r.itemCount, c = r.itemCount - 1; c >= 0; c--) {\n            s[u + c] = n.apply(null, i.map(function (e) {\n              return o[e * r.itemCount + c];\n            }));\n          }\n        });\n      }\n    }, {\n      key: \"quantize\",\n      value: function value() {\n        var e = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n        this.attrs.forEach(function (t) {\n          if (\"JOINT\" !== t.name && 0 != e[t.name]) {\n            var n = a.encode(t.data, e[t.name] || 12);\n            t.quantizationBit = n.quantizationBit, t.min = n.min, t.max = n.max, t.data = n.data;\n          }\n        });\n      }\n    }, {\n      key: \"dequantize\",\n      value: function value() {\n        this.attrs.forEach(function (e) {\n          e.quantizationBit && (e.data = a.decode(e.data, e.quantizationBit, e.min, e.max));\n        });\n      }\n    }, {\n      key: \"convertTypedArray\",\n      value: function value() {\n        !this.indices || this.indices instanceof Array || (this.indices = Array.from(this.indices)), this.attrs.forEach(function (e) {\n          e.data instanceof Array || e.data instanceof Float32Array || (e.data = Array.from(e.data));\n        });\n      }\n    }, {\n      key: \"clearEBAttrs\",\n      value: function value() {\n        delete this.clers, delete this.holes, delete this.handles;\n      }\n    }, {\n      key: \"convertToTypedArray\",\n      value: function value() {\n        this.indices instanceof Array && (this.getAttrLength() > 65535 ? this.indices = new Uint32Array(this.indices) : this.indices = new Uint16Array(this.indices)), this.attrs.forEach(function (e) {\n          e.data instanceof Array && (e.data = new Float32Array(e.data));\n        });\n      }\n    }, {\n      key: \"prepareToWorkerSend\",\n      value: function value() {\n        return this.clearEBAttrs(), this.convertToTypedArray(), this.getAllBuffers();\n      }\n    }, {\n      key: \"clone\",\n      value: function value() {\n        var t = new e(Array.from(this.indices), this.mode);\n        return Object.assign(t.attrIndexMap, this.attrIndexMap), t.attrs = this.attrs.map(function (e) {\n          var t = Object.assign({}, e);\n          return t.data = Array.from(t.data), t;\n        }), t;\n      }\n    }, {\n      key: \"cloneStruct\",\n      value: function value() {\n        var t = new e();\n        return t.mode = this.mode, this.indices && (t.indices = []), Object.assign(t.attrIndexMap, this.attrIndexMap), t.attrs = this.attrs.map(function (e) {\n          var t = Object.assign({}, e);\n          return t.data = [], t;\n        }), t;\n      }\n    }, {\n      key: \"toHilo3dGeometry\",\n      value: function value(e, t) {\n        var n = t || new e.Geometry();\n        return this.indices && (this.indices.BYTES_PER_ELEMENT ? n.indices = new e.GeometryData(this.indices, 1) : this.getAttrLength() > 65535 ? n.indices = new e.GeometryData(new Uint32Array(this.indices), 1) : n.indices = new e.GeometryData(new Uint16Array(this.indices), 1)), this.attrs.forEach(function (t) {\n          var r = c[t.name];\n          r && (t.data.BYTES_PER_ELEMENT ? n[r] = new e.GeometryData(t.data, t.itemCount) : n[r] = new e.GeometryData(new Float32Array(t.data), t.itemCount));\n        }), n;\n      }\n    }, {\n      key: \"getAllBuffers\",\n      value: function value() {\n        var e = [];\n        return this.indices.BYTES_PER_ELEMENT && e.push(this.indices.buffer), this.attrs.forEach(function (t) {\n          t.data && t.data.BYTES_PER_ELEMENT && e.push(t.data.buffer);\n        }), e;\n      }\n    }], [{\n      key: \"fromGLTFPrimitive\",\n      value: function value(t) {\n        var n = new e(t.indices, t.mode),\n            r = t.attributes,\n            i = 0;\n\n        for (var a in r.POSITION && (i = r.POSITION.length / 3), r) {\n          if (o[a]) {\n            var s = l[o[a]];\n            i && (s = r[a].length / i), n.addAttr(o[a], r[a], s);\n          } else console.warn(\"Dont support attribute\", a);\n        }\n\n        return n;\n      }\n    }, {\n      key: \"fromHilo3dGeometry\",\n      value: function value(t) {\n        var n = new e(t.indices.data, t.mode);\n\n        for (var r in h) {\n          t[r] && n.addAttr(h[r], t[r].data, t[r].size);\n        }\n\n        return n;\n      }\n    }]), e;\n  }();\n\n  e.exports = f;\n}, function (e, t) {\n  var n = {};\n\n  function r(e) {\n    return n[e] || (n[e] = Math.pow(2, e) - 1), n[e];\n  }\n\n  e.exports = {\n    cal: function cal(e, t, n, i) {\n      var a = r(i),\n          o = n - t;\n      return Math.round((e - t) / o * a);\n    },\n    encode: function encode(e) {\n      for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 8, n = e.length, i = r(t), a = 1 / 0, o = -1 / 0, s = 0; s < n; s++) {\n        a = Math.min(a, e[s]), o = Math.max(o, e[s]);\n      }\n\n      var u = o - a || 1,\n          c = [];\n\n      for (s = 0; s < n; s++) {\n        c[s] = Math.round((e[s] - a) / u * i);\n      }\n\n      return {\n        min: a,\n        max: o,\n        quantizationBit: t,\n        data: c\n      };\n    },\n    encodeWithMinAndMax: function encodeWithMinAndMax(e) {\n      for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [], n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 0, i = arguments.length > 3 && void 0 !== arguments[3] ? arguments[3] : 1, a = arguments.length > 4 && void 0 !== arguments[4] ? arguments[4] : 8, o = e.length, s = r(a), u = i - n || 1, c = 0; c < o; c++) {\n        t[c] = Math.round((e[c] - n) / u * s);\n      }\n\n      return t;\n    },\n    decode: function decode(e) {\n      for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 8, n = arguments.length > 2 ? arguments[2] : void 0, i = arguments.length > 3 ? arguments[3] : void 0, a = e.length, o = r(t), s = i - n, u = new Float32Array(a), c = 0; c < a; c++) {\n        u[c] = n + s * (e[c] / o);\n      }\n\n      return u;\n    },\n    normalize: function normalize(e) {\n      for (var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : [], n = arguments.length > 2 && void 0 !== arguments[2] ? arguments[2] : 3, r = e.length, i = 0; i < r; i += n) {\n        for (var a = 0, o = 0; o < n; o++) {\n          a += e[i + o] * e[i + o];\n        }\n\n        a = Math.sqrt(a);\n\n        for (o = 0; o < n; o++) {\n          t[i + o] = e[i + o] / a;\n        }\n      }\n\n      return t;\n    }\n  };\n}, function (e, t, n) {\n  e.exports = n(3);\n}, function (e, t, n) {\n  var r = n(4);\n  r.Geometry = n(0), e.exports = r;\n}, function (e, t, n) {\n  var r = n(0),\n      i = n(5),\n      a = n(7),\n      o = n(8),\n      s = n(9),\n      u = [i],\n      c = [a];\n\n  function h(e) {\n    var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0;\n    return e instanceof Uint8Array && (t = e.byteOffset, e = e.buffer), function (e) {\n      return new u[e.type](e).decompress();\n    }(function (e, t) {\n      var n = new Uint8Array(e, t, 4);\n      if (65 !== n[0] || 77 !== n[1] || 67 !== n[2]) throw new Error(\"The file is not AMC format!\");\n      var r = c[n[3]].read(e, t + 4);\n      return r.geometry.type = n[3], r.geometry;\n    }(e, t));\n  }\n\n  var l,\n      f = null,\n      d = null;\n\n  function v(e, t) {\n    return !f && s() ? (f = new o({\n      wasmURL: e,\n      memPages: t\n    }), d = f.init()) : d || Promise.resolve();\n  }\n\n  function p(e, t, n) {\n    if (f || v(t, n), !f || !f.isReady) return h(e);\n\n    try {\n      return f.decompress(e);\n    } catch (t) {\n      return console.warn(\"wasm decompress error\", t), h(e);\n    }\n  }\n\n  var y = null;\n\n  function m(e) {\n    return e = e || \"https://g.alicdn.com/hilo/amc/0.1.27/worker.js\", y || (!1 === l || \"undefined\" == typeof Worker ? Promise.reject(\"dont support web worker\") : y = /^(?:http|blob|data:|\\/\\/)/.test(e) ? new Promise(function (t, n) {\n      var r = new XMLHttpRequest();\n      r.addEventListener(\"load\", function () {\n        if (\"undefined\" == typeof URL || \"undefined\" == typeof Blob) l = new Worker(\"data:application/javascript, \".concat(this.responseText));else {\n          var e = URL.createObjectURL(new Blob([this.responseText]));\n          l = new Worker(e);\n        }\n        l.onerror = function (e) {\n          console.log(\"web worker error\", e), l = !1, n(e);\n        }, t(l);\n      }), r.addEventListener(\"error\", function (e) {\n        return n(e);\n      }), r.open(\"get\", e, !0), r.send();\n    }) : new Promise(function (t, n) {\n      (l = new Worker(e)).onerror = function (e) {\n        console.log(\"web worker init error\", e), l = !1, n(e);\n      }, t(l);\n    }));\n  }\n\n  var g = 0;\n\n  function O(e, t, n, i) {\n    return t = t && s(), e = new Uint8Array(e), m(i).then(function (i) {\n      return new Promise(function (a, o) {\n        var s = g++,\n            _u = function u(t) {\n          if (t.data.id === s) if (i.removeEventListener(\"message\", _u), _u = null, t.data.data) {\n            var n = t.data.data;\n            n.constructor = r, n.__proto__ = r.prototype, a(n);\n          } else a(h(e));\n        };\n\n        i.addEventListener(\"message\", _u), i.postMessage({\n          id: s,\n          data: e,\n          useWASM: t,\n          wasmURL: n\n        }, [e.buffer]);\n      });\n    })[\"catch\"](function (r) {\n      return t ? p(e, n) : h(e);\n    });\n  }\n\n  e.exports = {\n    initWASM: v,\n    initWorker: m,\n    decompress: function decompress(e, t, n) {\n      var r = s();\n      return !r || e.byteLength > 1048576 ? O(e, r, t, n) : r ? Promise.resolve(p(e, t)) : Promise.resolve(h(e));\n    },\n    decompressWithJS: h,\n    decompressWithWASM: p,\n    decompressWithWorker: O,\n    destory: function destory() {\n      l && (l.terminate(), l = null, y = null), f && (f = null, d = null);\n    }\n  };\n}, function (e, t, n) {\n  function r(e) {\n    return function (e) {\n      if (Array.isArray(e)) {\n        for (var t = 0, n = new Array(e.length); t < e.length; t++) {\n          n[t] = e[t];\n        }\n\n        return n;\n      }\n    }(e) || function (e) {\n      if (Symbol.iterator in Object(e) || \"[object Arguments]\" === Object.prototype.toString.call(e)) return Array.from(e);\n    }(e) || function () {\n      throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n    }();\n  }\n\n  function i(e, t) {\n    for (var n = 0; n < t.length; n++) {\n      var r = t[n];\n      r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n    }\n  }\n\n  var a = n(0),\n      o = (n(1), n(6)),\n      u = o.map,\n      c = function () {\n    function e(t) {\n      !function (e, t) {\n        if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n      }(this, e), this.geometry = t, this.faceCount = t.clers.length, this.clers = t.clers, this.holes = t.holes, this.handles = t.handles, this.createHandleMap(this.handles), this.vertexCount = t.getAttrLength(), this.noParallelogramPrediction = !!t.noParallelogramPrediction;\n    }\n\n    var t, n;\n    return t = e, (n = [{\n      key: \"nextCorner\",\n      value: function value(e) {\n        return e < 0 ? -1 : e + (e % 3 == 2 ? -2 : 1);\n      }\n    }, {\n      key: \"prevCorner\",\n      value: function value(e) {\n        return e < 0 ? -1 : e + (e % 3 ? -1 : 2);\n      }\n    }, {\n      key: \"createHandleMap\",\n      value: function value(e) {\n        var t = this.handlesMap = {};\n        if (e) for (var n = e.length - 1; n >= 0; n -= 2) {\n          t[e[n]] = e[n - 1];\n        }\n      }\n    }, {\n      key: \"mapBoundary\",\n      value: function value(e) {\n        for (var t = this.indices, n = e.length, r = this.currentVertex, i = this.currentVertex - n + 1, a = n - 1; a >= 0; a--) {\n          t[this.nextCorner(e[a])] = r, r = i, t[this.prevCorner(e[a])] = i++;\n        }\n\n        this.currentVertex -= n;\n      }\n    }, {\n      key: \"mapHoleBoundary\",\n      value: function value(e) {\n        for (var t = this.indices, n = e.length, r = this.currentVertex - n + 1, i = r, a = n - 1; a >= 0; a--) {\n          t[this.nextCorner(e[a])] = r++, t[this.prevCorner(e[a])] = a ? r : i;\n        }\n\n        this.currentVertex -= n;\n      }\n    }, {\n      key: \"fixNegativeIndex\",\n      value: function value(e) {\n        for (var t = e, n = this.indices; n[e] < 0;) {\n          if (t === -n[-n[e]] || n[e] === n[-n[e]]) {\n            console.warn(\"dead loop bug!!\"), n[s] = 0;\n            break;\n          }\n\n          n[e] = n[-n[e]];\n        }\n      }\n    }, {\n      key: \"fixIndicesAndReadVertice\",\n      value: function value() {\n        for (var e, t = this.indices, n = this.handlesMap, r = this.clers, i = r.length, a = -1, s = [], u = 0, c = 0; u < i; u++, c += 3) {\n          -1 === a ? (this.fixNegativeIndex(c + 1), this.fixNegativeIndex(c + 2)) : (t[c + 1] = t[this.prevCorner(a)], t[c + 2] = t[this.nextCorner(a)]), this.fixNegativeIndex(c), -1 === a ? (this.readVertex(t[c + 2]), this.readVertex(t[c + 1]), this.readVertex(t[c])) : this.readVertex(t[c], a), a = c + 1, (e = r[u]) !== o.S || n[u] ? e === o.E || e === o.F ? a = s.pop() : e === o.R && (a = c + 2) : s.push(c + 2), e === o.F && (a = -1, delete this.lastReadVertexIndex), this._onDecompressFace(u, e);\n        }\n      }\n    }, {\n      key: \"readVertex\",\n      value: function value(e) {\n        var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : -1;\n\n        if (!this.readedVertexMap[e] && (this.readedVertexMap[e] = 1, !this.noParallelogramPrediction)) {\n          var n = this.indices,\n              r = this.geometry;\n          -1 === t ? void 0 !== this.lastReadVertexIndex && r.cal(r, e, a.plus, this.lastReadVertexIndex, e) : r.cal(r, e, a.depp, n[t], n[this.prevCorner(t)], n[this.nextCorner(t)], e), this.lastReadVertexIndex = e;\n        }\n      }\n    }, {\n      key: \"markCorner\",\n      value: function value(e, t) {\n        var n = this.indices;\n        void 0 === n[this.nextCorner(e)] && (n[this.nextCorner(e)] = -this.prevCorner(t[0])), void 0 === n[this.prevCorner(e)] && (n[this.prevCorner(e)] = -this.nextCorner(t[t.length - 1]));\n      }\n    }, {\n      key: \"onFaceC\",\n      value: function value(e) {\n        var t = this.indices,\n            n = 3 * this.currentFace,\n            r = this.currentVertex--;\n        t[n] = r;\n        var i = e.pop();\n        return t[this.nextCorner(i)] = r, t[this.prevCorner(i)] = -this.nextCorner(e[e.length - 1]), i = e.shift(), t[this.prevCorner(i)] = r, t[this.nextCorner(i)] = -this.prevCorner(e[0]), e.push(n), e;\n      }\n    }, {\n      key: \"onFaceL\",\n      value: function value(e) {\n        var t = 3 * this.currentFace;\n        return this.markCorner(e.pop(), e), e.unshift(t + 2), e.push(t), e;\n      }\n    }, {\n      key: \"onFaceF\",\n      value: function value(e, t) {\n        return e && this.mapBoundary(e), this.onFaceE(null, t);\n      }\n    }, {\n      key: \"onFaceE\",\n      value: function value(e, t) {\n        var n = 3 * this.currentFace;\n        return e && t.push(e), [n + 2, n + 1, n];\n      }\n    }, {\n      key: \"onFaceR\",\n      value: function value(e) {\n        var t = 3 * this.currentFace;\n        return this.markCorner(e.pop(), e), e.push(t + 1, t), e;\n      }\n    }, {\n      key: \"onHandleEnd\",\n      value: function value(e, t, n) {\n        var r = this.indices,\n            i = 3 * this.currentFace,\n            a = this.handlesMap[this.currentFace],\n            o = t.splice(0, e);\n        return t.shift(), n.push(o), r[this.nextCorner(a)] = -(i + 1), r[this.prevCorner(a)] = -this.nextCorner(o[o.length - 1]), r[i] = -this.prevCorner(o[0]), t.push(i), t;\n      }\n    }, {\n      key: \"onHandleStart\",\n      value: function value(e, t) {\n        for (var n, i = this.indices, a = 3 * this.currentFace, o = this.handlesMap[this.currentFace], s = t.length - 1; s >= 0; s--) {\n          var u = t[s].indexOf(o);\n\n          if (u >= 0) {\n            var c,\n                h = (n = t.splice(s, 1)[0]).splice(0, u);\n            n.shift(), (c = n).push.apply(c, r(h));\n            break;\n          }\n        }\n\n        return i[this.nextCorner(o)] = -(a + 1), i[this.prevCorner(o)] = -this.nextCorner(n[n.length - 1]), i[a] = -this.prevCorner(e[0]), (e = n.concat(e)).push(a), e;\n      }\n    }, {\n      key: \"onFaceS\",\n      value: function value(e, t, n) {\n        var r = this.handlesMap,\n            i = this.indices,\n            a = 3 * this.currentFace;\n\n        if (r[this.currentFace]) {\n          this.markCorner(e.pop(), e);\n          var o = e.indexOf(r[this.currentFace]);\n          e = o >= 0 ? this.onHandleEnd(o, e, n) : this.onHandleStart(e, n);\n        } else {\n          var s = e.pop();\n          this.markCorner(s, e), i[a] = -this.nextCorner(s);\n          var u = t.pop();\n          this.markCorner(u.pop(), u), (e = u.concat(e)).push(a);\n        }\n\n        return e;\n      }\n    }, {\n      key: \"onFaceM\",\n      value: function value(e, t, n) {\n        var r = this.indices,\n            i = 3 * this.currentFace,\n            a = e.splice(0, this.holes[this.currentHole--]);\n        this.mapHoleBoundary(a);\n        var o = r[this.prevCorner(a[0])];\n        r[i] = o;\n        var s = e.pop();\n        return r[this.prevCorner(s)] = -this.nextCorner(e[e.length - 1]), r[this.nextCorner(s)] = o, s = e.shift(), r[this.prevCorner(s)] = o, r[this.nextCorner(s)] = -this.prevCorner(e[0]), e.push(i), e;\n      }\n    }, {\n      key: \"decompress\",\n      value: function value() {\n        this.readedVertexMap = new Uint8Array(this.vertexCount);\n        var e = this.faceCount,\n            t = this.indices = new Array(3 * e);\n        this.currentFace = e - 1, this.currentVertex = this.vertexCount - 1, this.currentHole = this.holes.length - 1;\n\n        for (var n, r = this.clers, i = [], a = []; this.currentFace >= 0;) {\n          var o = \"onFace\" + u[r[this.currentFace]];\n          this[o] ? n = this[o](n, i, a) : console.warn(\"has no \".concat(o)), this.currentFace--;\n        }\n\n        return this.mapBoundary(n), this.fixIndicesAndReadVertice(this.indices), this.geometry.indices = t, this.geometry.dequantize(), this.geometry;\n      }\n    }, {\n      key: \"_onDecompressFace\",\n      value: function value(e, t) {\n        this.onDecompressFace && this.onDecompressFace(e, t);\n      }\n    }]) && i(t.prototype, n), e;\n  }();\n\n  e.exports = c;\n}, function (e, t) {\n  var n = {\n    C: 0,\n    R: 1,\n    L: 2,\n    S: 3,\n    E: 4,\n    M: 5,\n    F: 6\n  },\n      r = [];\n\n  for (var i in n) {\n    r[n[i]] = i;\n  }\n\n  n.map = r, e.exports = n;\n}, function (e, t, n) {\n  var r = n(0);\n\n  function i(e, t, n, r) {\n    return new e(t.slice(n, n + r * e.BYTES_PER_ELEMENT));\n  }\n\n  e.exports = {\n    read: function read(e) {\n      var t = arguments.length > 1 && void 0 !== arguments[1] ? arguments[1] : 0,\n          n = new DataView(e),\n          a = new r(),\n          o = function (e, t) {\n        var n = {};\n        return n.version = e.getUint8(t++), n.faceCount = e.getUint32(t, !0), t += 4, n.vertexCount = e.getUint32(t, !0), t += 4, n.attrCount = e.getUint8(t++), n.noParallelogramPrediction = e.getUint8(t++), n.holesCount = e.getUint16(t, !0), t += 2, n.handlesCount = e.getUint16(t, !0), t += 2, n.headerBytes = 15, n;\n      }(n, t);\n\n      return t += o.headerBytes, a.mode = \"CLERS\", t = function (e, t, n, r) {\n        return r.holesCount ? (e.holes = i(Uint16Array, t.buffer, n, r.holesCount), n + 2 * r.holesCount) : (e.holes = [], n);\n      }(a, n, t, o), t = function (e, t, n, r) {\n        return r.handlesCount ? (e.handles = i(Uint32Array, t.buffer, n, 2 * r.handlesCount), n + 8 * r.handlesCount) : (e.handles = [], n);\n      }(a, n, t, o), t = function (e, t, n, r) {\n        return e.clers = new Uint8Array(t.buffer, n, r.faceCount), n + r.faceCount;\n      }(a, n, t, o), t = function (e, t, n, r) {\n        for (var a = 0; a < r.attrCount; a++) {\n          var o = {},\n              s = t.getUint16(n, !0);\n          n += 2, o.name = e.attrIdToName(s), o.itemCount = t.getUint8(n++), o.quantizationBit = t.getUint8(n++), o.min = t.getFloat32(n, !0), n += 4, o.max = t.getFloat32(n, !0), n += 4, o.data = i(Int16Array, t.buffer, n, o.itemCount * r.vertexCount), n += o.itemCount * r.vertexCount * 2, e.attrs.push(o);\n        }\n\n        return n;\n      }(a, n, t, o), {\n        header: o,\n        geometry: a,\n        offset: t\n      };\n    }\n  };\n}, function (e, t, n) {\n  function r(e, t) {\n    return function (e) {\n      if (Array.isArray(e)) return e;\n    }(e) || function (e, t) {\n      var n = [],\n          r = !0,\n          i = !1,\n          a = void 0;\n\n      try {\n        for (var o, s = e[Symbol.iterator](); !(r = (o = s.next()).done) && (n.push(o.value), !t || n.length !== t); r = !0) {\n          ;\n        }\n      } catch (e) {\n        i = !0, a = e;\n      } finally {\n        try {\n          r || null == s[\"return\"] || s[\"return\"]();\n        } finally {\n          if (i) throw a;\n        }\n      }\n\n      return n;\n    }(e, t) || function () {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }();\n  }\n\n  function i(e) {\n    return function (e) {\n      if (Array.isArray(e)) {\n        for (var t = 0, n = new Array(e.length); t < e.length; t++) {\n          n[t] = e[t];\n        }\n\n        return n;\n      }\n    }(e) || function (e) {\n      if (Symbol.iterator in Object(e) || \"[object Arguments]\" === Object.prototype.toString.call(e)) return Array.from(e);\n    }(e) || function () {\n      throw new TypeError(\"Invalid attempt to spread non-iterable instance\");\n    }();\n  }\n\n  function a(e, t) {\n    for (var n = 0; n < t.length; n++) {\n      var r = t[n];\n      r.enumerable = r.enumerable || !1, r.configurable = !0, \"value\" in r && (r.writable = !0), Object.defineProperty(e, r.key, r);\n    }\n  }\n\n  var o = n(0),\n      s = function () {\n    function e() {\n      var t = arguments.length > 0 && void 0 !== arguments[0] ? arguments[0] : {};\n      !function (e, t) {\n        if (!(e instanceof t)) throw new TypeError(\"Cannot call a class as a function\");\n      }(this, e), this.wasmURL = t.wasmURL || \"https://ossgw.alicdn.com/tmall-c3/tmx/70b8d82ccf33e97a124e54c2d6a3e0c7.wasm\", this.memPages = t.memPages || 256, this.memPages < 256 && (this.memPages = 256), this.isReady = !1;\n    }\n\n    var t, n;\n    return t = e, (n = [{\n      key: \"initASMJS\",\n      value: function value() {\n        this.isReady = !0, this.dv = new DataView(HEAP8.buffer), this.heap8 = HEAP8, this.ins = {\n          exports: {\n            __Z7AMCinitj: Module.__Z7AMCinitj,\n            __Z12AMDecompressv: Module.__Z12AMDecompressv\n          }\n        };\n      }\n    }, {\n      key: \"init\",\n      value: function value() {\n        var e = this,\n            t = this.memory = new WebAssembly.Memory({\n          initial: this.memPages\n        });\n        this.dv = new DataView(t.buffer);\n        var n = this.heap8 = new Uint8Array(t.buffer),\n            r = {\n          global: {\n            NaN: 5,\n            Infinity: 6\n          },\n          env: {\n            memoryBase: 0,\n            memory: t,\n            _malloc: function _malloc() {\n              return 2097152;\n            },\n            _memset: function _memset(e, t, r) {\n              return n.fill(t, e, e + r), e;\n            },\n            _printf: function _printf(e, t) {\n              for (var r = e; n[r];) {\n                r++;\n              }\n\n              var a = String.fromCharCode.apply(String, i(n.slice(e, r))),\n                  o = 0;\n              a = a.replace(/%([duf])/g, function (e, n) {\n                return \"d\" === n || \"u\" === n ? dv.getInt32(t + 4 * o++, !0) : \"f\" === n ? dv.getFloat32(t + 4 * o++, !0) : void 0;\n              }), console.log(a);\n            }\n          }\n        };\n        return fetch(this.wasmURL).then(function (e) {\n          return e.arrayBuffer();\n        }).then(function (e) {\n          return WebAssembly.instantiate(e, r);\n        }).then(function (t) {\n          e.module = t, e.ins = t.instance, e.isReady = !0;\n        })[\"catch\"](function (e) {\n          return console.log(\"wasm load error, use js ver\");\n        });\n      }\n    }, {\n      key: \"getDataAddr\",\n      value: function value(e) {\n        return this.ins.exports.__Z7AMCinitj(e);\n      }\n    }, {\n      key: \"decompress\",\n      value: function value(e) {\n        e instanceof ArrayBuffer && (e = new Uint8Array(e));\n        var t = this.dv,\n            n = this.heap8,\n            i = this.getDataAddr(e.length);\n        n.set(e, i);\n\n        var a = this.ins.exports.__Z12AMDecompressv();\n\n        if (a <= 0) throw console.error(\"decompression error code: \" + a), new Error(\"decompression error code: \" + a);\n\n        for (var s = t.getUint32(a, !0), u = t.getUint32(a + 4, !0), c = t.getUint32(a + 8, !0), h = t.getUint32(a + 12, !0), l = [], f = 0; f < h; f++) {\n          var d = a + 16 + 12 * f;\n          l.push([t.getUint32(d, !0), t.getUint32(d + 4, !0), t.getUint32(d + 8, !0)]);\n        }\n\n        var v = new Uint32Array(t.buffer, u, 3 * s);\n        v = c > 65536 ? new Uint32Array(v) : new Uint16Array(v);\n        var p = new o(v);\n        return l.forEach(function (e) {\n          var n = r(e, 3),\n              i = n[0],\n              a = n[1],\n              o = n[2],\n              s = new Float32Array(t.buffer.slice(o, o + c * a * 4));\n          p.addAttr(p.attrIdToName(i), s, a);\n        }), p;\n      }\n    }]) && a(t.prototype, n), e;\n  }();\n\n  e.exports = s;\n}, function (e, t) {\n  function n() {\n    if (\"undefined\" == typeof WebAssembly || \"undefined\" == typeof fetch || function () {\n      if (!/iPad|iPhone|iPod/i.test(navigator.userAgent)) return !1;\n\n      if (/OS (\\d+)_(\\d+)_?(\\d+)?/i.test(navigator.userAgent)) {\n        var e = Number(RegExp.$1),\n            t = Number(RegExp.$2);\n        if (11 === e && t >= 3 || e > 11) return !1;\n      }\n\n      return !0;\n    }()) return !1;\n\n    try {\n      var e = new Uint8Array([0, 97, 115, 109, 1, 0, 0, 0, 1, 6, 1, 96, 1, 127, 1, 127, 3, 2, 1, 0, 5, 3, 1, 0, 1, 7, 8, 1, 4, 116, 101, 115, 116, 0, 0, 10, 16, 1, 14, 0, 32, 0, 65, 1, 54, 2, 0, 32, 0, 40, 2, 0, 11]),\n          t = new WebAssembly.Module(e);\n      return 0 !== new WebAssembly.Instance(t, {}).exports.test(4);\n    } catch (e) {\n      return console.log(\"err while check WebAssembly\", e), !1;\n    }\n  }\n\n  var r;\n\n  e.exports = function () {\n    return void 0 === r && (r = n()), r;\n  };\n}]);\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-constants@1.0.0@gl-constants/1.0/index.js\":\n/*!********************************************************************!*\\\n  !*** ./node_modules/_gl-constants@1.0.0@gl-constants/1.0/index.js ***!\n  \\********************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = {\n  ACTIVE_ATTRIBUTES: 35721,\n  ACTIVE_ATTRIBUTE_MAX_LENGTH: 35722,\n  ACTIVE_TEXTURE: 34016,\n  ACTIVE_UNIFORMS: 35718,\n  ACTIVE_UNIFORM_MAX_LENGTH: 35719,\n  ALIASED_LINE_WIDTH_RANGE: 33902,\n  ALIASED_POINT_SIZE_RANGE: 33901,\n  ALPHA: 6406,\n  ALPHA_BITS: 3413,\n  ALWAYS: 519,\n  ARRAY_BUFFER: 34962,\n  ARRAY_BUFFER_BINDING: 34964,\n  ATTACHED_SHADERS: 35717,\n  BACK: 1029,\n  BLEND: 3042,\n  BLEND_COLOR: 32773,\n  BLEND_DST_ALPHA: 32970,\n  BLEND_DST_RGB: 32968,\n  BLEND_EQUATION: 32777,\n  BLEND_EQUATION_ALPHA: 34877,\n  BLEND_EQUATION_RGB: 32777,\n  BLEND_SRC_ALPHA: 32971,\n  BLEND_SRC_RGB: 32969,\n  BLUE_BITS: 3412,\n  BOOL: 35670,\n  BOOL_VEC2: 35671,\n  BOOL_VEC3: 35672,\n  BOOL_VEC4: 35673,\n  BROWSER_DEFAULT_WEBGL: 37444,\n  BUFFER_SIZE: 34660,\n  BUFFER_USAGE: 34661,\n  BYTE: 5120,\n  CCW: 2305,\n  CLAMP_TO_EDGE: 33071,\n  COLOR_ATTACHMENT0: 36064,\n  COLOR_BUFFER_BIT: 16384,\n  COLOR_CLEAR_VALUE: 3106,\n  COLOR_WRITEMASK: 3107,\n  COMPILE_STATUS: 35713,\n  COMPRESSED_TEXTURE_FORMATS: 34467,\n  CONSTANT_ALPHA: 32771,\n  CONSTANT_COLOR: 32769,\n  CONTEXT_LOST_WEBGL: 37442,\n  CULL_FACE: 2884,\n  CULL_FACE_MODE: 2885,\n  CURRENT_PROGRAM: 35725,\n  CURRENT_VERTEX_ATTRIB: 34342,\n  CW: 2304,\n  DECR: 7683,\n  DECR_WRAP: 34056,\n  DELETE_STATUS: 35712,\n  DEPTH_ATTACHMENT: 36096,\n  DEPTH_BITS: 3414,\n  DEPTH_BUFFER_BIT: 256,\n  DEPTH_CLEAR_VALUE: 2931,\n  DEPTH_COMPONENT: 6402,\n  DEPTH_COMPONENT16: 33189,\n  DEPTH_FUNC: 2932,\n  DEPTH_RANGE: 2928,\n  DEPTH_STENCIL: 34041,\n  DEPTH_STENCIL_ATTACHMENT: 33306,\n  DEPTH_TEST: 2929,\n  DEPTH_WRITEMASK: 2930,\n  DITHER: 3024,\n  DONT_CARE: 4352,\n  DST_ALPHA: 772,\n  DST_COLOR: 774,\n  DYNAMIC_DRAW: 35048,\n  ELEMENT_ARRAY_BUFFER: 34963,\n  ELEMENT_ARRAY_BUFFER_BINDING: 34965,\n  EQUAL: 514,\n  FASTEST: 4353,\n  FLOAT: 5126,\n  FLOAT_MAT2: 35674,\n  FLOAT_MAT3: 35675,\n  FLOAT_MAT4: 35676,\n  FLOAT_VEC2: 35664,\n  FLOAT_VEC3: 35665,\n  FLOAT_VEC4: 35666,\n  FRAGMENT_SHADER: 35632,\n  FRAMEBUFFER: 36160,\n  FRAMEBUFFER_ATTACHMENT_OBJECT_NAME: 36049,\n  FRAMEBUFFER_ATTACHMENT_OBJECT_TYPE: 36048,\n  FRAMEBUFFER_ATTACHMENT_TEXTURE_CUBE_MAP_FACE: 36051,\n  FRAMEBUFFER_ATTACHMENT_TEXTURE_LEVEL: 36050,\n  FRAMEBUFFER_BINDING: 36006,\n  FRAMEBUFFER_COMPLETE: 36053,\n  FRAMEBUFFER_INCOMPLETE_ATTACHMENT: 36054,\n  FRAMEBUFFER_INCOMPLETE_DIMENSIONS: 36057,\n  FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT: 36055,\n  FRAMEBUFFER_UNSUPPORTED: 36061,\n  FRONT: 1028,\n  FRONT_AND_BACK: 1032,\n  FRONT_FACE: 2886,\n  FUNC_ADD: 32774,\n  FUNC_REVERSE_SUBTRACT: 32779,\n  FUNC_SUBTRACT: 32778,\n  GENERATE_MIPMAP_HINT: 33170,\n  GEQUAL: 518,\n  GREATER: 516,\n  GREEN_BITS: 3411,\n  HIGH_FLOAT: 36338,\n  HIGH_INT: 36341,\n  INCR: 7682,\n  INCR_WRAP: 34055,\n  INFO_LOG_LENGTH: 35716,\n  INT: 5124,\n  INT_VEC2: 35667,\n  INT_VEC3: 35668,\n  INT_VEC4: 35669,\n  INVALID_ENUM: 1280,\n  INVALID_FRAMEBUFFER_OPERATION: 1286,\n  INVALID_OPERATION: 1282,\n  INVALID_VALUE: 1281,\n  INVERT: 5386,\n  KEEP: 7680,\n  LEQUAL: 515,\n  LESS: 513,\n  LINEAR: 9729,\n  LINEAR_MIPMAP_LINEAR: 9987,\n  LINEAR_MIPMAP_NEAREST: 9985,\n  LINES: 1,\n  LINE_LOOP: 2,\n  LINE_STRIP: 3,\n  LINE_WIDTH: 2849,\n  LINK_STATUS: 35714,\n  LOW_FLOAT: 36336,\n  LOW_INT: 36339,\n  LUMINANCE: 6409,\n  LUMINANCE_ALPHA: 6410,\n  MAX_COMBINED_TEXTURE_IMAGE_UNITS: 35661,\n  MAX_CUBE_MAP_TEXTURE_SIZE: 34076,\n  MAX_FRAGMENT_UNIFORM_VECTORS: 36349,\n  MAX_RENDERBUFFER_SIZE: 34024,\n  MAX_TEXTURE_IMAGE_UNITS: 34930,\n  MAX_TEXTURE_SIZE: 3379,\n  MAX_VARYING_VECTORS: 36348,\n  MAX_VERTEX_ATTRIBS: 34921,\n  MAX_VERTEX_TEXTURE_IMAGE_UNITS: 35660,\n  MAX_VERTEX_UNIFORM_VECTORS: 36347,\n  MAX_VIEWPORT_DIMS: 3386,\n  MEDIUM_FLOAT: 36337,\n  MEDIUM_INT: 36340,\n  MIRRORED_REPEAT: 33648,\n  NEAREST: 9728,\n  NEAREST_MIPMAP_LINEAR: 9986,\n  NEAREST_MIPMAP_NEAREST: 9984,\n  NEVER: 512,\n  NICEST: 4354,\n  NONE: 0,\n  NOTEQUAL: 517,\n  NO_ERROR: 0,\n  NUM_COMPRESSED_TEXTURE_FORMATS: 34466,\n  ONE: 1,\n  ONE_MINUS_CONSTANT_ALPHA: 32772,\n  ONE_MINUS_CONSTANT_COLOR: 32770,\n  ONE_MINUS_DST_ALPHA: 773,\n  ONE_MINUS_DST_COLOR: 775,\n  ONE_MINUS_SRC_ALPHA: 771,\n  ONE_MINUS_SRC_COLOR: 769,\n  OUT_OF_MEMORY: 1285,\n  PACK_ALIGNMENT: 3333,\n  POINTS: 0,\n  POLYGON_OFFSET_FACTOR: 32824,\n  POLYGON_OFFSET_FILL: 32823,\n  POLYGON_OFFSET_UNITS: 10752,\n  RED_BITS: 3410,\n  RENDERBUFFER: 36161,\n  RENDERBUFFER_ALPHA_SIZE: 36179,\n  RENDERBUFFER_BINDING: 36007,\n  RENDERBUFFER_BLUE_SIZE: 36178,\n  RENDERBUFFER_DEPTH_SIZE: 36180,\n  RENDERBUFFER_GREEN_SIZE: 36177,\n  RENDERBUFFER_HEIGHT: 36163,\n  RENDERBUFFER_INTERNAL_FORMAT: 36164,\n  RENDERBUFFER_RED_SIZE: 36176,\n  RENDERBUFFER_STENCIL_SIZE: 36181,\n  RENDERBUFFER_WIDTH: 36162,\n  RENDERER: 7937,\n  REPEAT: 10497,\n  REPLACE: 7681,\n  RGB: 6407,\n  RGB5_A1: 32855,\n  RGB565: 36194,\n  RGBA: 6408,\n  RGBA4: 32854,\n  SAMPLER_2D: 35678,\n  SAMPLER_CUBE: 35680,\n  SAMPLES: 32937,\n  SAMPLE_ALPHA_TO_COVERAGE: 32926,\n  SAMPLE_BUFFERS: 32936,\n  SAMPLE_COVERAGE: 32928,\n  SAMPLE_COVERAGE_INVERT: 32939,\n  SAMPLE_COVERAGE_VALUE: 32938,\n  SCISSOR_BOX: 3088,\n  SCISSOR_TEST: 3089,\n  SHADER_COMPILER: 36346,\n  SHADER_SOURCE_LENGTH: 35720,\n  SHADER_TYPE: 35663,\n  SHADING_LANGUAGE_VERSION: 35724,\n  SHORT: 5122,\n  SRC_ALPHA: 770,\n  SRC_ALPHA_SATURATE: 776,\n  SRC_COLOR: 768,\n  STATIC_DRAW: 35044,\n  STENCIL_ATTACHMENT: 36128,\n  STENCIL_BACK_FAIL: 34817,\n  STENCIL_BACK_FUNC: 34816,\n  STENCIL_BACK_PASS_DEPTH_FAIL: 34818,\n  STENCIL_BACK_PASS_DEPTH_PASS: 34819,\n  STENCIL_BACK_REF: 36003,\n  STENCIL_BACK_VALUE_MASK: 36004,\n  STENCIL_BACK_WRITEMASK: 36005,\n  STENCIL_BITS: 3415,\n  STENCIL_BUFFER_BIT: 1024,\n  STENCIL_CLEAR_VALUE: 2961,\n  STENCIL_FAIL: 2964,\n  STENCIL_FUNC: 2962,\n  STENCIL_INDEX: 6401,\n  STENCIL_INDEX8: 36168,\n  STENCIL_PASS_DEPTH_FAIL: 2965,\n  STENCIL_PASS_DEPTH_PASS: 2966,\n  STENCIL_REF: 2967,\n  STENCIL_TEST: 2960,\n  STENCIL_VALUE_MASK: 2963,\n  STENCIL_WRITEMASK: 2968,\n  STREAM_DRAW: 35040,\n  SUBPIXEL_BITS: 3408,\n  TEXTURE: 5890,\n  TEXTURE0: 33984,\n  TEXTURE1: 33985,\n  TEXTURE2: 33986,\n  TEXTURE3: 33987,\n  TEXTURE4: 33988,\n  TEXTURE5: 33989,\n  TEXTURE6: 33990,\n  TEXTURE7: 33991,\n  TEXTURE8: 33992,\n  TEXTURE9: 33993,\n  TEXTURE10: 33994,\n  TEXTURE11: 33995,\n  TEXTURE12: 33996,\n  TEXTURE13: 33997,\n  TEXTURE14: 33998,\n  TEXTURE15: 33999,\n  TEXTURE16: 34000,\n  TEXTURE17: 34001,\n  TEXTURE18: 34002,\n  TEXTURE19: 34003,\n  TEXTURE20: 34004,\n  TEXTURE21: 34005,\n  TEXTURE22: 34006,\n  TEXTURE23: 34007,\n  TEXTURE24: 34008,\n  TEXTURE25: 34009,\n  TEXTURE26: 34010,\n  TEXTURE27: 34011,\n  TEXTURE28: 34012,\n  TEXTURE29: 34013,\n  TEXTURE30: 34014,\n  TEXTURE31: 34015,\n  TEXTURE_2D: 3553,\n  TEXTURE_BINDING_2D: 32873,\n  TEXTURE_BINDING_CUBE_MAP: 34068,\n  TEXTURE_CUBE_MAP: 34067,\n  TEXTURE_CUBE_MAP_NEGATIVE_X: 34070,\n  TEXTURE_CUBE_MAP_NEGATIVE_Y: 34072,\n  TEXTURE_CUBE_MAP_NEGATIVE_Z: 34074,\n  TEXTURE_CUBE_MAP_POSITIVE_X: 34069,\n  TEXTURE_CUBE_MAP_POSITIVE_Y: 34071,\n  TEXTURE_CUBE_MAP_POSITIVE_Z: 34073,\n  TEXTURE_MAG_FILTER: 10240,\n  TEXTURE_MIN_FILTER: 10241,\n  TEXTURE_WRAP_S: 10242,\n  TEXTURE_WRAP_T: 10243,\n  TRIANGLES: 4,\n  TRIANGLE_FAN: 6,\n  TRIANGLE_STRIP: 5,\n  UNPACK_ALIGNMENT: 3317,\n  UNPACK_COLORSPACE_CONVERSION_WEBGL: 37443,\n  UNPACK_FLIP_Y_WEBGL: 37440,\n  UNPACK_PREMULTIPLY_ALPHA_WEBGL: 37441,\n  UNSIGNED_BYTE: 5121,\n  UNSIGNED_INT: 5125,\n  UNSIGNED_SHORT: 5123,\n  UNSIGNED_SHORT_4_4_4_4: 32819,\n  UNSIGNED_SHORT_5_5_5_1: 32820,\n  UNSIGNED_SHORT_5_6_5: 33635,\n  VALIDATE_STATUS: 35715,\n  VENDOR: 7936,\n  VERSION: 7938,\n  VERTEX_ATTRIB_ARRAY_BUFFER_BINDING: 34975,\n  VERTEX_ATTRIB_ARRAY_ENABLED: 34338,\n  VERTEX_ATTRIB_ARRAY_NORMALIZED: 34922,\n  VERTEX_ATTRIB_ARRAY_POINTER: 34373,\n  VERTEX_ATTRIB_ARRAY_SIZE: 34339,\n  VERTEX_ATTRIB_ARRAY_STRIDE: 34340,\n  VERTEX_ATTRIB_ARRAY_TYPE: 34341,\n  VERTEX_SHADER: 35633,\n  VIEWPORT: 2978,\n  ZERO: 0\n};\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-extensions-constants@1.0.0@gl-extensions-constants/index.js\":\n/*!**************************************************************************************!*\\\n  !*** ./node_modules/_gl-extensions-constants@1.0.0@gl-extensions-constants/index.js ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar extensionsConstants = {\n  VERTEX_ATTRIB_ARRAY_DIVISOR_ANGLE: 0x88FE,\n  //  Describes the frequency divisor used for instanced rendering.\n  UNMASKED_VENDOR_WEBGL: 0x9245,\n  //  Passed to getParameter to get the vendor string of the graphics driver.\n  UNMASKED_RENDERER_WEBGL: 0x9246,\n  //  Passed to getParameter to get the renderer string of the graphics driver.\n  MAX_TEXTURE_MAX_ANISOTROPY_EXT: 0x84FF,\n  //  Returns the maximum available anisotropy.\n  TEXTURE_MAX_ANISOTROPY_EXT: 0x84FE,\n  //  Passed to texParameter to set the desired maximum anisotropy for a texture.\n  COMPRESSED_RGB_S3TC_DXT1_EXT: 0x83F0,\n  //  A DXT1-compressed image in an RGB image format.\n  COMPRESSED_RGBA_S3TC_DXT1_EXT: 0x83F1,\n  //  A DXT1-compressed image in an RGB image format with a simple on/off alpha value.\n  COMPRESSED_RGBA_S3TC_DXT3_EXT: 0x83F2,\n  //  A DXT3-compressed image in an RGBA image format. Compared to a 32-bit RGBA texture, it offers 4:1 compression.\n  COMPRESSED_RGBA_S3TC_DXT5_EXT: 0x83F3,\n  //  A DXT5-compressed image in an RGBA image format. It also provides a 4:1 compression, but differs to the DXT3 compression in how the alpha compression is done.\n  COMPRESSED_R11_EAC: 0x9270,\n  //  One-channel (red) unsigned format compression.\n  COMPRESSED_SIGNED_R11_EAC: 0x9271,\n  //  One-channel (red) signed format compression.\n  COMPRESSED_RG11_EAC: 0x9272,\n  //  Two-channel (red and green) unsigned format compression.\n  COMPRESSED_SIGNED_RG11_EAC: 0x9273,\n  //  Two-channel (red and green) signed format compression.\n  COMPRESSED_RGB8_ETC2: 0x9274,\n  //  Compresses RBG8 data with no alpha channel.\n  COMPRESSED_RGBA8_ETC2_EAC: 0x9275,\n  //  Compresses RGBA8 data. The RGB part is encoded the same as RGB_ETC2, but the alpha part is encoded separately.\n  COMPRESSED_SRGB8_ETC2: 0x9276,\n  //  Compresses sRBG8 data with no alpha channel.\n  COMPRESSED_SRGB8_ALPHA8_ETC2_EAC: 0x9277,\n  //  Compresses sRGBA8 data. The sRGB part is encoded the same as SRGB_ETC2, but the alpha part is encoded separately.\n  COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0x9278,\n  //  Similar to RGB8_ETC, but with ability to punch through the alpha channel, which means to make it completely opaque or transparent.\n  COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2: 0x9279,\n  //  Similar to SRGB8_ETC, but with ability to punch through the alpha channel, which means to make it completely opaque or transparent.\n  COMPRESSED_RGB_PVRTC_4BPPV1_IMG: 0x8C00,\n  //  RGB compression in 4-bit mode. One block for each 4×4 pixels.\n  COMPRESSED_RGBA_PVRTC_4BPPV1_IMG: 0x8C02,\n  //  RGBA compression in 4-bit mode. One block for each 4×4 pixels.\n  COMPRESSED_RGB_PVRTC_2BPPV1_IMG: 0x8C01,\n  //  RGB compression in 2-bit mode. One block for each 8×4 pixels.\n  COMPRESSED_RGBA_PVRTC_2BPPV1_IMG: 0x8C03,\n  //  RGBA compression in 2-bit mode. One block for each 8×4 pixe\n  COMPRESSED_RGB_ETC1_WEBGL: 0x8D64,\n  //  Compresses 24-bit RGB data with no alpha channel.\n  COMPRESSED_RGB_ATC_WEBGL: 0x8C92,\n  //  Compresses RGB textures with no alpha channel.\n  COMPRESSED_RGBA_ATC_EXPLICIT_ALPHA_WEBGL: 0x8C92,\n  //  Compresses RGBA textures using explicit alpha encoding (useful when alpha transitions are sharp).\n  COMPRESSED_RGBA_ATC_INTERPOLATED_ALPHA_WEBGL: 0x87EE,\n  //  Compresses RGBA textures using interpolated alpha encoding (useful when alpha transitions are gradient).\n  UNSIGNED_INT_24_8_WEBGL: 0x84FA,\n  //  Unsigned integer type for 24-bit depth texture data.\n  HALF_FLOAT_OES: 0x8D61,\n  //  Half floating-point type (16-bit).\n  RGBA32F_EXT: 0x8814,\n  //  RGBA 32-bit floating-point color-renderable format.\n  RGB32F_EXT: 0x8815,\n  //  RGB 32-bit floating-point color-renderable format.\n  FRAMEBUFFER_ATTACHMENT_COMPONENT_TYPE_EXT: 0x8211,\n  //   \n  UNSIGNED_NORMALIZED_EXT: 0x8C17,\n  //   \n  MIN_EXT: 0x8007,\n  //  Produces the minimum color components of the source and destination colors.\n  MAX_EXT: 0x8008,\n  //  Produces the maximum color components of the source and destination colors.\n  SRGB_EXT: 0x8C40,\n  //  Unsized sRGB format that leaves the precision up to the driver.\n  SRGB_ALPHA_EXT: 0x8C42,\n  //  Unsized sRGB format with unsized alpha component.\n  SRGB8_ALPHA8_EXT: 0x8C43,\n  //  Sized (8-bit) sRGB and alpha formats.\n  FRAMEBUFFER_ATTACHMENT_COLOR_ENCODING_EXT: 0x8210,\n  //  Returns the framebuffer color encoding.\n  FRAGMENT_SHADER_DERIVATIVE_HINT_OES: 0x8B8B,\n  //  Indicates the accuracy of the derivative calculation for the GLSL built-in functions: dFdx, dFdy, and fwidth.\n  COLOR_ATTACHMENT0_WEBGL: 0x8CE0,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT1_WEBGL: 0x8CE1,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT2_WEBGL: 0x8CE2,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT3_WEBGL: 0x8CE3,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT4_WEBGL: 0x8CE4,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT5_WEBGL: 0x8CE5,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT6_WEBGL: 0x8CE6,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT7_WEBGL: 0x8CE7,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT8_WEBGL: 0x8CE8,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT9_WEBGL: 0x8CE9,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT10_WEBGL: 0x8CEA,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT11_WEBGL: 0x8CEB,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT12_WEBGL: 0x8CEC,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT13_WEBGL: 0x8CED,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT14_WEBGL: 0x8CEE,\n  //  Framebuffer color attachment point\n  COLOR_ATTACHMENT15_WEBGL: 0x8CEF,\n  //  Framebuffer color attachment point\n  DRAW_BUFFER0_WEBGL: 0x8825,\n  //  Draw buffer\n  DRAW_BUFFER1_WEBGL: 0x8826,\n  //  Draw buffer\n  DRAW_BUFFER2_WEBGL: 0x8827,\n  //  Draw buffer\n  DRAW_BUFFER3_WEBGL: 0x8828,\n  //  Draw buffer\n  DRAW_BUFFER4_WEBGL: 0x8829,\n  //  Draw buffer\n  DRAW_BUFFER5_WEBGL: 0x882A,\n  //  Draw buffer\n  DRAW_BUFFER6_WEBGL: 0x882B,\n  //  Draw buffer\n  DRAW_BUFFER7_WEBGL: 0x882C,\n  //  Draw buffer\n  DRAW_BUFFER8_WEBGL: 0x882D,\n  //  Draw buffer\n  DRAW_BUFFER9_WEBGL: 0x882E,\n  //  Draw buffer\n  DRAW_BUFFER10_WEBGL: 0x882F,\n  //  Draw buffer\n  DRAW_BUFFER11_WEBGL: 0x8830,\n  //  Draw buffer\n  DRAW_BUFFER12_WEBGL: 0x8831,\n  //  Draw buffer\n  DRAW_BUFFER13_WEBGL: 0x8832,\n  //  Draw buffer\n  DRAW_BUFFER14_WEBGL: 0x8833,\n  //  Draw buffer\n  DRAW_BUFFER15_WEBGL: 0x8834,\n  //  Draw buffer\n  MAX_COLOR_ATTACHMENTS_WEBGL: 0x8CDF,\n  //  Maximum number of framebuffer color attachment points\n  MAX_DRAW_BUFFERS_WEBGL: 0x8824,\n  //  Maximum number of draw buffers\n  VERTEX_ARRAY_BINDING_OES: 0x85B5,\n  //  The bound vertex array object (VAO).\n  QUERY_COUNTER_BITS_EXT: 0x8864,\n  //  The number of bits used to hold the query result for the given target.\n  CURRENT_QUERY_EXT: 0x8865,\n  //  The currently active query.\n  QUERY_RESULT_EXT: 0x8866,\n  //  The query result.\n  QUERY_RESULT_AVAILABLE_EXT: 0x8867,\n  //  A Boolean indicating whether or not a query result is available.\n  TIME_ELAPSED_EXT: 0x88BF,\n  //  Elapsed time (in nanoseconds).\n  TIMESTAMP_EXT: 0x8E28,\n  //  The current time.\n  GPU_DISJOINT_EXT: 0x8FBB //  A Boolean indicating whether or not the GPU performed any disjoint operation.\n\n};\n\n{\n  module.exports = extensionsConstants;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js\":\n/*!***********************************************************************!*\\\n  !*** ./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js ***!\n  \\***********************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/*!\n@fileoverview gl-matrix - High performance matrix and vector operations\n@author Brandon Jones\n@author Colin MacKenzie IV\n@version 2.7.0\n\nCopyright (c) 2015-2018, Brandon Jones, Colin MacKenzie IV.\n\nPermission is hereby granted, free of charge, to any person obtaining a copy\nof this software and associated documentation files (the \"Software\"), to deal\nin the Software without restriction, including without limitation the rights\nto use, copy, modify, merge, publish, distribute, sublicense, and/or sell\ncopies of the Software, and to permit persons to whom the Software is\nfurnished to do so, subject to the following conditions:\n\nThe above copyright notice and this permission notice shall be included in\nall copies or substantial portions of the Software.\n\nTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR\nIMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\nFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE\nAUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER\nLIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,\nOUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN\nTHE SOFTWARE.\n\n*/\n!function (t, n) {\n  module.exports = n();\n}(\"undefined\" != typeof self ? self : this, function () {\n  return function (t) {\n    var n = {};\n\n    function r(a) {\n      if (n[a]) return n[a].exports;\n      var e = n[a] = {\n        i: a,\n        l: !1,\n        exports: {}\n      };\n      return t[a].call(e.exports, e, e.exports, r), e.l = !0, e.exports;\n    }\n\n    return r.m = t, r.c = n, r.d = function (t, n, a) {\n      r.o(t, n) || Object.defineProperty(t, n, {\n        enumerable: !0,\n        get: a\n      });\n    }, r.r = function (t) {\n      \"undefined\" != typeof Symbol && Symbol.toStringTag && Object.defineProperty(t, Symbol.toStringTag, {\n        value: \"Module\"\n      }), Object.defineProperty(t, \"__esModule\", {\n        value: !0\n      });\n    }, r.t = function (t, n) {\n      if (1 & n && (t = r(t)), 8 & n) return t;\n      if (4 & n && \"object\" == typeof t && t && t.__esModule) return t;\n      var a = Object.create(null);\n      if (r.r(a), Object.defineProperty(a, \"default\", {\n        enumerable: !0,\n        value: t\n      }), 2 & n && \"string\" != typeof t) for (var e in t) {\n        r.d(a, e, function (n) {\n          return t[n];\n        }.bind(null, e));\n      }\n      return a;\n    }, r.n = function (t) {\n      var n = t && t.__esModule ? function () {\n        return t[\"default\"];\n      } : function () {\n        return t;\n      };\n      return r.d(n, \"a\", n), n;\n    }, r.o = function (t, n) {\n      return Object.prototype.hasOwnProperty.call(t, n);\n    }, r.p = \"\", r(r.s = 10);\n  }([function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.setMatrixArrayType = function (t) {\n      n.ARRAY_TYPE = t;\n    }, n.toRadian = function (t) {\n      return t * e;\n    }, n.equals = function (t, n) {\n      return Math.abs(t - n) <= a * Math.max(1, Math.abs(t), Math.abs(n));\n    };\n    var a = n.EPSILON = 1e-6;\n    n.ARRAY_TYPE = \"undefined\" != typeof Float32Array ? Float32Array : Array, n.RANDOM = Math.random;\n    var e = Math.PI / 180;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.forEach = n.sqrLen = n.len = n.sqrDist = n.dist = n.div = n.mul = n.sub = void 0, n.create = e, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(4);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n;\n    }, n.fromValues = function (t, n, r, e) {\n      var u = new a.ARRAY_TYPE(4);\n      return u[0] = t, u[1] = n, u[2] = r, u[3] = e, u;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t;\n    }, n.set = function (t, n, r, a, e) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t;\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t;\n    }, n.subtract = u, n.multiply = o, n.divide = i, n.ceil = function (t, n) {\n      return t[0] = Math.ceil(n[0]), t[1] = Math.ceil(n[1]), t[2] = Math.ceil(n[2]), t[3] = Math.ceil(n[3]), t;\n    }, n.floor = function (t, n) {\n      return t[0] = Math.floor(n[0]), t[1] = Math.floor(n[1]), t[2] = Math.floor(n[2]), t[3] = Math.floor(n[3]), t;\n    }, n.min = function (t, n, r) {\n      return t[0] = Math.min(n[0], r[0]), t[1] = Math.min(n[1], r[1]), t[2] = Math.min(n[2], r[2]), t[3] = Math.min(n[3], r[3]), t;\n    }, n.max = function (t, n, r) {\n      return t[0] = Math.max(n[0], r[0]), t[1] = Math.max(n[1], r[1]), t[2] = Math.max(n[2], r[2]), t[3] = Math.max(n[3], r[3]), t;\n    }, n.round = function (t, n) {\n      return t[0] = Math.round(n[0]), t[1] = Math.round(n[1]), t[2] = Math.round(n[2]), t[3] = Math.round(n[3]), t;\n    }, n.scale = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t;\n    }, n.scaleAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t[3] = n[3] + r[3] * a, t;\n    }, n.distance = s, n.squaredDistance = c, n.length = f, n.squaredLength = M, n.negate = function (t, n) {\n      return t[0] = -n[0], t[1] = -n[1], t[2] = -n[2], t[3] = -n[3], t;\n    }, n.inverse = function (t, n) {\n      return t[0] = 1 / n[0], t[1] = 1 / n[1], t[2] = 1 / n[2], t[3] = 1 / n[3], t;\n    }, n.normalize = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = r * r + a * a + e * e + u * u;\n      o > 0 && (o = 1 / Math.sqrt(o), t[0] = r * o, t[1] = a * o, t[2] = e * o, t[3] = u * o);\n      return t;\n    }, n.dot = function (t, n) {\n      return t[0] * n[0] + t[1] * n[1] + t[2] * n[2] + t[3] * n[3];\n    }, n.lerp = function (t, n, r, a) {\n      var e = n[0],\n          u = n[1],\n          o = n[2],\n          i = n[3];\n      return t[0] = e + a * (r[0] - e), t[1] = u + a * (r[1] - u), t[2] = o + a * (r[2] - o), t[3] = i + a * (r[3] - i), t;\n    }, n.random = function (t, n) {\n      var r, e, u, o, i, s;\n      n = n || 1;\n\n      do {\n        r = 2 * a.RANDOM() - 1, e = 2 * a.RANDOM() - 1, i = r * r + e * e;\n      } while (i >= 1);\n\n      do {\n        u = 2 * a.RANDOM() - 1, o = 2 * a.RANDOM() - 1, s = u * u + o * o;\n      } while (s >= 1);\n\n      var c = Math.sqrt((1 - i) / s);\n      return t[0] = n * r, t[1] = n * e, t[2] = n * u * c, t[3] = n * o * c, t;\n    }, n.transformMat4 = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3];\n      return t[0] = r[0] * a + r[4] * e + r[8] * u + r[12] * o, t[1] = r[1] * a + r[5] * e + r[9] * u + r[13] * o, t[2] = r[2] * a + r[6] * e + r[10] * u + r[14] * o, t[3] = r[3] * a + r[7] * e + r[11] * u + r[15] * o, t;\n    }, n.transformQuat = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = r[0],\n          i = r[1],\n          s = r[2],\n          c = r[3],\n          f = c * a + i * u - s * e,\n          M = c * e + s * a - o * u,\n          h = c * u + o * e - i * a,\n          l = -o * a - i * e - s * u;\n      return t[0] = f * c + l * -o + M * -s - h * -i, t[1] = M * c + l * -i + h * -o - f * -s, t[2] = h * c + l * -s + f * -i - M * -o, t[3] = n[3], t;\n    }, n.str = function (t) {\n      return \"vec4(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \")\";\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = n[0],\n          s = n[1],\n          c = n[2],\n          f = n[3];\n      return Math.abs(r - i) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(i)) && Math.abs(e - s) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(s)) && Math.abs(u - c) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(c)) && Math.abs(o - f) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(f));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e() {\n      var t = new a.ARRAY_TYPE(4);\n      return a.ARRAY_TYPE != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 0), t;\n    }\n\n    function u(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t[3] = n[3] - r[3], t;\n    }\n\n    function o(t, n, r) {\n      return t[0] = n[0] * r[0], t[1] = n[1] * r[1], t[2] = n[2] * r[2], t[3] = n[3] * r[3], t;\n    }\n\n    function i(t, n, r) {\n      return t[0] = n[0] / r[0], t[1] = n[1] / r[1], t[2] = n[2] / r[2], t[3] = n[3] / r[3], t;\n    }\n\n    function s(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1],\n          e = n[2] - t[2],\n          u = n[3] - t[3];\n      return Math.sqrt(r * r + a * a + e * e + u * u);\n    }\n\n    function c(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1],\n          e = n[2] - t[2],\n          u = n[3] - t[3];\n      return r * r + a * a + e * e + u * u;\n    }\n\n    function f(t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2],\n          e = t[3];\n      return Math.sqrt(n * n + r * r + a * a + e * e);\n    }\n\n    function M(t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2],\n          e = t[3];\n      return n * n + r * r + a * a + e * e;\n    }\n\n    n.sub = u, n.mul = o, n.div = i, n.dist = s, n.sqrDist = c, n.len = f, n.sqrLen = M, n.forEach = function () {\n      var t = e();\n      return function (n, r, a, e, u, o) {\n        var i = void 0,\n            s = void 0;\n\n        for (r || (r = 4), a || (a = 0), s = e ? Math.min(e * r + a, n.length) : n.length, i = a; i < s; i += r) {\n          t[0] = n[i], t[1] = n[i + 1], t[2] = n[i + 2], t[3] = n[i + 3], u(t, t, o), n[i] = t[0], n[i + 1] = t[1], n[i + 2] = t[2], n[i + 3] = t[3];\n        }\n\n        return n;\n      };\n    }();\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.forEach = n.sqrLen = n.len = n.sqrDist = n.dist = n.div = n.mul = n.sub = void 0, n.create = e, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(3);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n;\n    }, n.length = u, n.fromValues = o, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t;\n    }, n.set = function (t, n, r, a) {\n      return t[0] = n, t[1] = r, t[2] = a, t;\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t;\n    }, n.subtract = i, n.multiply = s, n.divide = c, n.ceil = function (t, n) {\n      return t[0] = Math.ceil(n[0]), t[1] = Math.ceil(n[1]), t[2] = Math.ceil(n[2]), t;\n    }, n.floor = function (t, n) {\n      return t[0] = Math.floor(n[0]), t[1] = Math.floor(n[1]), t[2] = Math.floor(n[2]), t;\n    }, n.min = function (t, n, r) {\n      return t[0] = Math.min(n[0], r[0]), t[1] = Math.min(n[1], r[1]), t[2] = Math.min(n[2], r[2]), t;\n    }, n.max = function (t, n, r) {\n      return t[0] = Math.max(n[0], r[0]), t[1] = Math.max(n[1], r[1]), t[2] = Math.max(n[2], r[2]), t;\n    }, n.round = function (t, n) {\n      return t[0] = Math.round(n[0]), t[1] = Math.round(n[1]), t[2] = Math.round(n[2]), t;\n    }, n.scale = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t;\n    }, n.scaleAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t;\n    }, n.distance = f, n.squaredDistance = M, n.squaredLength = h, n.negate = function (t, n) {\n      return t[0] = -n[0], t[1] = -n[1], t[2] = -n[2], t;\n    }, n.inverse = function (t, n) {\n      return t[0] = 1 / n[0], t[1] = 1 / n[1], t[2] = 1 / n[2], t;\n    }, n.normalize = l, n.dot = v, n.cross = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = r[0],\n          i = r[1],\n          s = r[2];\n      return t[0] = e * s - u * i, t[1] = u * o - a * s, t[2] = a * i - e * o, t;\n    }, n.lerp = function (t, n, r, a) {\n      var e = n[0],\n          u = n[1],\n          o = n[2];\n      return t[0] = e + a * (r[0] - e), t[1] = u + a * (r[1] - u), t[2] = o + a * (r[2] - o), t;\n    }, n.hermite = function (t, n, r, a, e, u) {\n      var o = u * u,\n          i = o * (2 * u - 3) + 1,\n          s = o * (u - 2) + u,\n          c = o * (u - 1),\n          f = o * (3 - 2 * u);\n      return t[0] = n[0] * i + r[0] * s + a[0] * c + e[0] * f, t[1] = n[1] * i + r[1] * s + a[1] * c + e[1] * f, t[2] = n[2] * i + r[2] * s + a[2] * c + e[2] * f, t;\n    }, n.bezier = function (t, n, r, a, e, u) {\n      var o = 1 - u,\n          i = o * o,\n          s = u * u,\n          c = i * o,\n          f = 3 * u * i,\n          M = 3 * s * o,\n          h = s * u;\n      return t[0] = n[0] * c + r[0] * f + a[0] * M + e[0] * h, t[1] = n[1] * c + r[1] * f + a[1] * M + e[1] * h, t[2] = n[2] * c + r[2] * f + a[2] * M + e[2] * h, t;\n    }, n.random = function (t, n) {\n      n = n || 1;\n      var r = 2 * a.RANDOM() * Math.PI,\n          e = 2 * a.RANDOM() - 1,\n          u = Math.sqrt(1 - e * e) * n;\n      return t[0] = Math.cos(r) * u, t[1] = Math.sin(r) * u, t[2] = e * n, t;\n    }, n.transformMat4 = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = r[3] * a + r[7] * e + r[11] * u + r[15];\n      return o = o || 1, t[0] = (r[0] * a + r[4] * e + r[8] * u + r[12]) / o, t[1] = (r[1] * a + r[5] * e + r[9] * u + r[13]) / o, t[2] = (r[2] * a + r[6] * e + r[10] * u + r[14]) / o, t;\n    }, n.transformMat3 = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2];\n      return t[0] = a * r[0] + e * r[3] + u * r[6], t[1] = a * r[1] + e * r[4] + u * r[7], t[2] = a * r[2] + e * r[5] + u * r[8], t;\n    }, n.transformQuat = function (t, n, r) {\n      var a = r[0],\n          e = r[1],\n          u = r[2],\n          o = r[3],\n          i = n[0],\n          s = n[1],\n          c = n[2],\n          f = e * c - u * s,\n          M = u * i - a * c,\n          h = a * s - e * i,\n          l = e * h - u * M,\n          v = u * f - a * h,\n          d = a * M - e * f,\n          b = 2 * o;\n      return f *= b, M *= b, h *= b, l *= 2, v *= 2, d *= 2, t[0] = i + f + l, t[1] = s + M + v, t[2] = c + h + d, t;\n    }, n.rotateX = function (t, n, r, a) {\n      var e = [],\n          u = [];\n      return e[0] = n[0] - r[0], e[1] = n[1] - r[1], e[2] = n[2] - r[2], u[0] = e[0], u[1] = e[1] * Math.cos(a) - e[2] * Math.sin(a), u[2] = e[1] * Math.sin(a) + e[2] * Math.cos(a), t[0] = u[0] + r[0], t[1] = u[1] + r[1], t[2] = u[2] + r[2], t;\n    }, n.rotateY = function (t, n, r, a) {\n      var e = [],\n          u = [];\n      return e[0] = n[0] - r[0], e[1] = n[1] - r[1], e[2] = n[2] - r[2], u[0] = e[2] * Math.sin(a) + e[0] * Math.cos(a), u[1] = e[1], u[2] = e[2] * Math.cos(a) - e[0] * Math.sin(a), t[0] = u[0] + r[0], t[1] = u[1] + r[1], t[2] = u[2] + r[2], t;\n    }, n.rotateZ = function (t, n, r, a) {\n      var e = [],\n          u = [];\n      return e[0] = n[0] - r[0], e[1] = n[1] - r[1], e[2] = n[2] - r[2], u[0] = e[0] * Math.cos(a) - e[1] * Math.sin(a), u[1] = e[0] * Math.sin(a) + e[1] * Math.cos(a), u[2] = e[2], t[0] = u[0] + r[0], t[1] = u[1] + r[1], t[2] = u[2] + r[2], t;\n    }, n.angle = function (t, n) {\n      var r = o(t[0], t[1], t[2]),\n          a = o(n[0], n[1], n[2]);\n      l(r, r), l(a, a);\n      var e = v(r, a);\n      return e > 1 ? 0 : e < -1 ? Math.PI : Math.acos(e);\n    }, n.str = function (t) {\n      return \"vec3(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \")\";\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = n[0],\n          i = n[1],\n          s = n[2];\n      return Math.abs(r - o) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(o)) && Math.abs(e - i) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(i)) && Math.abs(u - s) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(s));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e() {\n      var t = new a.ARRAY_TYPE(3);\n      return a.ARRAY_TYPE != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t;\n    }\n\n    function u(t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2];\n      return Math.sqrt(n * n + r * r + a * a);\n    }\n\n    function o(t, n, r) {\n      var e = new a.ARRAY_TYPE(3);\n      return e[0] = t, e[1] = n, e[2] = r, e;\n    }\n\n    function i(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t;\n    }\n\n    function s(t, n, r) {\n      return t[0] = n[0] * r[0], t[1] = n[1] * r[1], t[2] = n[2] * r[2], t;\n    }\n\n    function c(t, n, r) {\n      return t[0] = n[0] / r[0], t[1] = n[1] / r[1], t[2] = n[2] / r[2], t;\n    }\n\n    function f(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1],\n          e = n[2] - t[2];\n      return Math.sqrt(r * r + a * a + e * e);\n    }\n\n    function M(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1],\n          e = n[2] - t[2];\n      return r * r + a * a + e * e;\n    }\n\n    function h(t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2];\n      return n * n + r * r + a * a;\n    }\n\n    function l(t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = r * r + a * a + e * e;\n      return u > 0 && (u = 1 / Math.sqrt(u), t[0] = n[0] * u, t[1] = n[1] * u, t[2] = n[2] * u), t;\n    }\n\n    function v(t, n) {\n      return t[0] * n[0] + t[1] * n[1] + t[2] * n[2];\n    }\n\n    n.sub = i, n.mul = s, n.div = c, n.dist = f, n.sqrDist = M, n.len = u, n.sqrLen = h, n.forEach = function () {\n      var t = e();\n      return function (n, r, a, e, u, o) {\n        var i = void 0,\n            s = void 0;\n\n        for (r || (r = 3), a || (a = 0), s = e ? Math.min(e * r + a, n.length) : n.length, i = a; i < s; i += r) {\n          t[0] = n[i], t[1] = n[i + 1], t[2] = n[i + 2], u(t, t, o), n[i] = t[0], n[i + 1] = t[1], n[i + 2] = t[2];\n        }\n\n        return n;\n      };\n    }();\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.setAxes = n.sqlerp = n.rotationTo = n.equals = n.exactEquals = n.normalize = n.sqrLen = n.squaredLength = n.len = n.length = n.lerp = n.dot = n.scale = n.mul = n.add = n.set = n.copy = n.fromValues = n.clone = void 0, n.create = s, n.identity = function (t) {\n      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t;\n    }, n.setAxisAngle = c, n.getAxisAngle = function (t, n) {\n      var r = 2 * Math.acos(n[3]),\n          e = Math.sin(r / 2);\n      e > a.EPSILON ? (t[0] = n[0] / e, t[1] = n[1] / e, t[2] = n[2] / e) : (t[0] = 1, t[1] = 0, t[2] = 0);\n      return r;\n    }, n.multiply = f, n.rotateX = function (t, n, r) {\n      r *= .5;\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = Math.sin(r),\n          s = Math.cos(r);\n      return t[0] = a * s + o * i, t[1] = e * s + u * i, t[2] = u * s - e * i, t[3] = o * s - a * i, t;\n    }, n.rotateY = function (t, n, r) {\n      r *= .5;\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = Math.sin(r),\n          s = Math.cos(r);\n      return t[0] = a * s - u * i, t[1] = e * s + o * i, t[2] = u * s + a * i, t[3] = o * s - e * i, t;\n    }, n.rotateZ = function (t, n, r) {\n      r *= .5;\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = Math.sin(r),\n          s = Math.cos(r);\n      return t[0] = a * s + e * i, t[1] = e * s - a * i, t[2] = u * s + o * i, t[3] = o * s - u * i, t;\n    }, n.calculateW = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2];\n      return t[0] = r, t[1] = a, t[2] = e, t[3] = Math.sqrt(Math.abs(1 - r * r - a * a - e * e)), t;\n    }, n.slerp = M, n.random = function (t) {\n      var n = a.RANDOM(),\n          r = a.RANDOM(),\n          e = a.RANDOM(),\n          u = Math.sqrt(1 - n),\n          o = Math.sqrt(n);\n      return t[0] = u * Math.sin(2 * Math.PI * r), t[1] = u * Math.cos(2 * Math.PI * r), t[2] = o * Math.sin(2 * Math.PI * e), t[3] = o * Math.cos(2 * Math.PI * e), t;\n    }, n.invert = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = r * r + a * a + e * e + u * u,\n          i = o ? 1 / o : 0;\n      return t[0] = -r * i, t[1] = -a * i, t[2] = -e * i, t[3] = u * i, t;\n    }, n.conjugate = function (t, n) {\n      return t[0] = -n[0], t[1] = -n[1], t[2] = -n[2], t[3] = n[3], t;\n    }, n.fromMat3 = h, n.fromEuler = function (t, n, r, a) {\n      var e = .5 * Math.PI / 180;\n      n *= e, r *= e, a *= e;\n      var u = Math.sin(n),\n          o = Math.cos(n),\n          i = Math.sin(r),\n          s = Math.cos(r),\n          c = Math.sin(a),\n          f = Math.cos(a);\n      return t[0] = u * s * f - o * i * c, t[1] = o * i * f + u * s * c, t[2] = o * s * c - u * i * f, t[3] = o * s * f + u * i * c, t;\n    }, n.str = function (t) {\n      return \"quat(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \")\";\n    };\n    var a = i(r(0)),\n        e = i(r(5)),\n        u = i(r(2)),\n        o = i(r(1));\n\n    function i(t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }\n\n    function s() {\n      var t = new a.ARRAY_TYPE(4);\n      return a.ARRAY_TYPE != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0), t[3] = 1, t;\n    }\n\n    function c(t, n, r) {\n      r *= .5;\n      var a = Math.sin(r);\n      return t[0] = a * n[0], t[1] = a * n[1], t[2] = a * n[2], t[3] = Math.cos(r), t;\n    }\n\n    function f(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = r[0],\n          s = r[1],\n          c = r[2],\n          f = r[3];\n      return t[0] = a * f + o * i + e * c - u * s, t[1] = e * f + o * s + u * i - a * c, t[2] = u * f + o * c + a * s - e * i, t[3] = o * f - a * i - e * s - u * c, t;\n    }\n\n    function M(t, n, r, e) {\n      var u = n[0],\n          o = n[1],\n          i = n[2],\n          s = n[3],\n          c = r[0],\n          f = r[1],\n          M = r[2],\n          h = r[3],\n          l = void 0,\n          v = void 0,\n          d = void 0,\n          b = void 0,\n          m = void 0;\n      return (v = u * c + o * f + i * M + s * h) < 0 && (v = -v, c = -c, f = -f, M = -M, h = -h), 1 - v > a.EPSILON ? (l = Math.acos(v), d = Math.sin(l), b = Math.sin((1 - e) * l) / d, m = Math.sin(e * l) / d) : (b = 1 - e, m = e), t[0] = b * u + m * c, t[1] = b * o + m * f, t[2] = b * i + m * M, t[3] = b * s + m * h, t;\n    }\n\n    function h(t, n) {\n      var r = n[0] + n[4] + n[8],\n          a = void 0;\n      if (r > 0) a = Math.sqrt(r + 1), t[3] = .5 * a, a = .5 / a, t[0] = (n[5] - n[7]) * a, t[1] = (n[6] - n[2]) * a, t[2] = (n[1] - n[3]) * a;else {\n        var e = 0;\n        n[4] > n[0] && (e = 1), n[8] > n[3 * e + e] && (e = 2);\n        var u = (e + 1) % 3,\n            o = (e + 2) % 3;\n        a = Math.sqrt(n[3 * e + e] - n[3 * u + u] - n[3 * o + o] + 1), t[e] = .5 * a, a = .5 / a, t[3] = (n[3 * u + o] - n[3 * o + u]) * a, t[u] = (n[3 * u + e] + n[3 * e + u]) * a, t[o] = (n[3 * o + e] + n[3 * e + o]) * a;\n      }\n      return t;\n    }\n\n    n.clone = o.clone, n.fromValues = o.fromValues, n.copy = o.copy, n.set = o.set, n.add = o.add, n.mul = f, n.scale = o.scale, n.dot = o.dot, n.lerp = o.lerp;\n    var l = n.length = o.length,\n        v = (n.len = l, n.squaredLength = o.squaredLength),\n        d = (n.sqrLen = v, n.normalize = o.normalize);\n    n.exactEquals = o.exactEquals, n.equals = o.equals, n.rotationTo = function () {\n      var t = u.create(),\n          n = u.fromValues(1, 0, 0),\n          r = u.fromValues(0, 1, 0);\n      return function (a, e, o) {\n        var i = u.dot(e, o);\n        return i < -.999999 ? (u.cross(t, n, e), u.len(t) < 1e-6 && u.cross(t, r, e), u.normalize(t, t), c(a, t, Math.PI), a) : i > .999999 ? (a[0] = 0, a[1] = 0, a[2] = 0, a[3] = 1, a) : (u.cross(t, e, o), a[0] = t[0], a[1] = t[1], a[2] = t[2], a[3] = 1 + i, d(a, a));\n      };\n    }(), n.sqlerp = function () {\n      var t = s(),\n          n = s();\n      return function (r, a, e, u, o, i) {\n        return M(t, a, o, i), M(n, e, u, i), M(r, t, n, 2 * i * (1 - i)), r;\n      };\n    }(), n.setAxes = function () {\n      var t = e.create();\n      return function (n, r, a, e) {\n        return t[0] = a[0], t[3] = a[1], t[6] = a[2], t[1] = e[0], t[4] = e[1], t[7] = e[2], t[2] = -r[0], t[5] = -r[1], t[8] = -r[2], d(n, h(n, t));\n      };\n    }();\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.sub = n.mul = void 0, n.create = function () {\n      var t = new a.ARRAY_TYPE(16);\n      a.ARRAY_TYPE != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0);\n      return t[0] = 1, t[5] = 1, t[10] = 1, t[15] = 1, t;\n    }, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(16);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n[4] = t[4], n[5] = t[5], n[6] = t[6], n[7] = t[7], n[8] = t[8], n[9] = t[9], n[10] = t[10], n[11] = t[11], n[12] = t[12], n[13] = t[13], n[14] = t[14], n[15] = t[15], n;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[4] = n[4], t[5] = n[5], t[6] = n[6], t[7] = n[7], t[8] = n[8], t[9] = n[9], t[10] = n[10], t[11] = n[11], t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15], t;\n    }, n.fromValues = function (t, n, r, e, u, o, i, s, c, f, M, h, l, v, d, b) {\n      var m = new a.ARRAY_TYPE(16);\n      return m[0] = t, m[1] = n, m[2] = r, m[3] = e, m[4] = u, m[5] = o, m[6] = i, m[7] = s, m[8] = c, m[9] = f, m[10] = M, m[11] = h, m[12] = l, m[13] = v, m[14] = d, m[15] = b, m;\n    }, n.set = function (t, n, r, a, e, u, o, i, s, c, f, M, h, l, v, d, b) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t[4] = u, t[5] = o, t[6] = i, t[7] = s, t[8] = c, t[9] = f, t[10] = M, t[11] = h, t[12] = l, t[13] = v, t[14] = d, t[15] = b, t;\n    }, n.identity = e, n.transpose = function (t, n) {\n      if (t === n) {\n        var r = n[1],\n            a = n[2],\n            e = n[3],\n            u = n[6],\n            o = n[7],\n            i = n[11];\n        t[1] = n[4], t[2] = n[8], t[3] = n[12], t[4] = r, t[6] = n[9], t[7] = n[13], t[8] = a, t[9] = u, t[11] = n[14], t[12] = e, t[13] = o, t[14] = i;\n      } else t[0] = n[0], t[1] = n[4], t[2] = n[8], t[3] = n[12], t[4] = n[1], t[5] = n[5], t[6] = n[9], t[7] = n[13], t[8] = n[2], t[9] = n[6], t[10] = n[10], t[11] = n[14], t[12] = n[3], t[13] = n[7], t[14] = n[11], t[15] = n[15];\n\n      return t;\n    }, n.invert = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = n[6],\n          c = n[7],\n          f = n[8],\n          M = n[9],\n          h = n[10],\n          l = n[11],\n          v = n[12],\n          d = n[13],\n          b = n[14],\n          m = n[15],\n          p = r * i - a * o,\n          P = r * s - e * o,\n          A = r * c - u * o,\n          E = a * s - e * i,\n          O = a * c - u * i,\n          R = e * c - u * s,\n          y = f * d - M * v,\n          q = f * b - h * v,\n          x = f * m - l * v,\n          _ = M * b - h * d,\n          Y = M * m - l * d,\n          L = h * m - l * b,\n          S = p * L - P * Y + A * _ + E * x - O * q + R * y;\n\n      if (!S) return null;\n      return S = 1 / S, t[0] = (i * L - s * Y + c * _) * S, t[1] = (e * Y - a * L - u * _) * S, t[2] = (d * R - b * O + m * E) * S, t[3] = (h * O - M * R - l * E) * S, t[4] = (s * x - o * L - c * q) * S, t[5] = (r * L - e * x + u * q) * S, t[6] = (b * A - v * R - m * P) * S, t[7] = (f * R - h * A + l * P) * S, t[8] = (o * Y - i * x + c * y) * S, t[9] = (a * x - r * Y - u * y) * S, t[10] = (v * O - d * A + m * p) * S, t[11] = (M * A - f * O - l * p) * S, t[12] = (i * q - o * _ - s * y) * S, t[13] = (r * _ - a * q + e * y) * S, t[14] = (d * P - v * E - b * p) * S, t[15] = (f * E - M * P + h * p) * S, t;\n    }, n.adjoint = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = n[6],\n          c = n[7],\n          f = n[8],\n          M = n[9],\n          h = n[10],\n          l = n[11],\n          v = n[12],\n          d = n[13],\n          b = n[14],\n          m = n[15];\n      return t[0] = i * (h * m - l * b) - M * (s * m - c * b) + d * (s * l - c * h), t[1] = -(a * (h * m - l * b) - M * (e * m - u * b) + d * (e * l - u * h)), t[2] = a * (s * m - c * b) - i * (e * m - u * b) + d * (e * c - u * s), t[3] = -(a * (s * l - c * h) - i * (e * l - u * h) + M * (e * c - u * s)), t[4] = -(o * (h * m - l * b) - f * (s * m - c * b) + v * (s * l - c * h)), t[5] = r * (h * m - l * b) - f * (e * m - u * b) + v * (e * l - u * h), t[6] = -(r * (s * m - c * b) - o * (e * m - u * b) + v * (e * c - u * s)), t[7] = r * (s * l - c * h) - o * (e * l - u * h) + f * (e * c - u * s), t[8] = o * (M * m - l * d) - f * (i * m - c * d) + v * (i * l - c * M), t[9] = -(r * (M * m - l * d) - f * (a * m - u * d) + v * (a * l - u * M)), t[10] = r * (i * m - c * d) - o * (a * m - u * d) + v * (a * c - u * i), t[11] = -(r * (i * l - c * M) - o * (a * l - u * M) + f * (a * c - u * i)), t[12] = -(o * (M * b - h * d) - f * (i * b - s * d) + v * (i * h - s * M)), t[13] = r * (M * b - h * d) - f * (a * b - e * d) + v * (a * h - e * M), t[14] = -(r * (i * b - s * d) - o * (a * b - e * d) + v * (a * s - e * i)), t[15] = r * (i * h - s * M) - o * (a * h - e * M) + f * (a * s - e * i), t;\n    }, n.determinant = function (t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2],\n          e = t[3],\n          u = t[4],\n          o = t[5],\n          i = t[6],\n          s = t[7],\n          c = t[8],\n          f = t[9],\n          M = t[10],\n          h = t[11],\n          l = t[12],\n          v = t[13],\n          d = t[14],\n          b = t[15];\n      return (n * o - r * u) * (M * b - h * d) - (n * i - a * u) * (f * b - h * v) + (n * s - e * u) * (f * d - M * v) + (r * i - a * o) * (c * b - h * l) - (r * s - e * o) * (c * d - M * l) + (a * s - e * i) * (c * v - f * l);\n    }, n.multiply = u, n.translate = function (t, n, r) {\n      var a = r[0],\n          e = r[1],\n          u = r[2],\n          o = void 0,\n          i = void 0,\n          s = void 0,\n          c = void 0,\n          f = void 0,\n          M = void 0,\n          h = void 0,\n          l = void 0,\n          v = void 0,\n          d = void 0,\n          b = void 0,\n          m = void 0;\n      n === t ? (t[12] = n[0] * a + n[4] * e + n[8] * u + n[12], t[13] = n[1] * a + n[5] * e + n[9] * u + n[13], t[14] = n[2] * a + n[6] * e + n[10] * u + n[14], t[15] = n[3] * a + n[7] * e + n[11] * u + n[15]) : (o = n[0], i = n[1], s = n[2], c = n[3], f = n[4], M = n[5], h = n[6], l = n[7], v = n[8], d = n[9], b = n[10], m = n[11], t[0] = o, t[1] = i, t[2] = s, t[3] = c, t[4] = f, t[5] = M, t[6] = h, t[7] = l, t[8] = v, t[9] = d, t[10] = b, t[11] = m, t[12] = o * a + f * e + v * u + n[12], t[13] = i * a + M * e + d * u + n[13], t[14] = s * a + h * e + b * u + n[14], t[15] = c * a + l * e + m * u + n[15]);\n      return t;\n    }, n.scale = function (t, n, r) {\n      var a = r[0],\n          e = r[1],\n          u = r[2];\n      return t[0] = n[0] * a, t[1] = n[1] * a, t[2] = n[2] * a, t[3] = n[3] * a, t[4] = n[4] * e, t[5] = n[5] * e, t[6] = n[6] * e, t[7] = n[7] * e, t[8] = n[8] * u, t[9] = n[9] * u, t[10] = n[10] * u, t[11] = n[11] * u, t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15], t;\n    }, n.rotate = function (t, n, r, e) {\n      var u = e[0],\n          o = e[1],\n          i = e[2],\n          s = Math.sqrt(u * u + o * o + i * i),\n          c = void 0,\n          f = void 0,\n          M = void 0,\n          h = void 0,\n          l = void 0,\n          v = void 0,\n          d = void 0,\n          b = void 0,\n          m = void 0,\n          p = void 0,\n          P = void 0,\n          A = void 0,\n          E = void 0,\n          O = void 0,\n          R = void 0,\n          y = void 0,\n          q = void 0,\n          x = void 0,\n          _ = void 0,\n          Y = void 0,\n          L = void 0,\n          S = void 0,\n          w = void 0,\n          I = void 0;\n\n      if (s < a.EPSILON) return null;\n      u *= s = 1 / s, o *= s, i *= s, c = Math.sin(r), f = Math.cos(r), M = 1 - f, h = n[0], l = n[1], v = n[2], d = n[3], b = n[4], m = n[5], p = n[6], P = n[7], A = n[8], E = n[9], O = n[10], R = n[11], y = u * u * M + f, q = o * u * M + i * c, x = i * u * M - o * c, _ = u * o * M - i * c, Y = o * o * M + f, L = i * o * M + u * c, S = u * i * M + o * c, w = o * i * M - u * c, I = i * i * M + f, t[0] = h * y + b * q + A * x, t[1] = l * y + m * q + E * x, t[2] = v * y + p * q + O * x, t[3] = d * y + P * q + R * x, t[4] = h * _ + b * Y + A * L, t[5] = l * _ + m * Y + E * L, t[6] = v * _ + p * Y + O * L, t[7] = d * _ + P * Y + R * L, t[8] = h * S + b * w + A * I, t[9] = l * S + m * w + E * I, t[10] = v * S + p * w + O * I, t[11] = d * S + P * w + R * I, n !== t && (t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15]);\n      return t;\n    }, n.rotateX = function (t, n, r) {\n      var a = Math.sin(r),\n          e = Math.cos(r),\n          u = n[4],\n          o = n[5],\n          i = n[6],\n          s = n[7],\n          c = n[8],\n          f = n[9],\n          M = n[10],\n          h = n[11];\n      n !== t && (t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15]);\n      return t[4] = u * e + c * a, t[5] = o * e + f * a, t[6] = i * e + M * a, t[7] = s * e + h * a, t[8] = c * e - u * a, t[9] = f * e - o * a, t[10] = M * e - i * a, t[11] = h * e - s * a, t;\n    }, n.rotateY = function (t, n, r) {\n      var a = Math.sin(r),\n          e = Math.cos(r),\n          u = n[0],\n          o = n[1],\n          i = n[2],\n          s = n[3],\n          c = n[8],\n          f = n[9],\n          M = n[10],\n          h = n[11];\n      n !== t && (t[4] = n[4], t[5] = n[5], t[6] = n[6], t[7] = n[7], t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15]);\n      return t[0] = u * e - c * a, t[1] = o * e - f * a, t[2] = i * e - M * a, t[3] = s * e - h * a, t[8] = u * a + c * e, t[9] = o * a + f * e, t[10] = i * a + M * e, t[11] = s * a + h * e, t;\n    }, n.rotateZ = function (t, n, r) {\n      var a = Math.sin(r),\n          e = Math.cos(r),\n          u = n[0],\n          o = n[1],\n          i = n[2],\n          s = n[3],\n          c = n[4],\n          f = n[5],\n          M = n[6],\n          h = n[7];\n      n !== t && (t[8] = n[8], t[9] = n[9], t[10] = n[10], t[11] = n[11], t[12] = n[12], t[13] = n[13], t[14] = n[14], t[15] = n[15]);\n      return t[0] = u * e + c * a, t[1] = o * e + f * a, t[2] = i * e + M * a, t[3] = s * e + h * a, t[4] = c * e - u * a, t[5] = f * e - o * a, t[6] = M * e - i * a, t[7] = h * e - s * a, t;\n    }, n.fromTranslation = function (t, n) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = n[0], t[13] = n[1], t[14] = n[2], t[15] = 1, t;\n    }, n.fromScaling = function (t, n) {\n      return t[0] = n[0], t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = n[1], t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = n[2], t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.fromRotation = function (t, n, r) {\n      var e = r[0],\n          u = r[1],\n          o = r[2],\n          i = Math.sqrt(e * e + u * u + o * o),\n          s = void 0,\n          c = void 0,\n          f = void 0;\n      if (i < a.EPSILON) return null;\n      return e *= i = 1 / i, u *= i, o *= i, s = Math.sin(n), c = Math.cos(n), f = 1 - c, t[0] = e * e * f + c, t[1] = u * e * f + o * s, t[2] = o * e * f - u * s, t[3] = 0, t[4] = e * u * f - o * s, t[5] = u * u * f + c, t[6] = o * u * f + e * s, t[7] = 0, t[8] = e * o * f + u * s, t[9] = u * o * f - e * s, t[10] = o * o * f + c, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.fromXRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = a, t[6] = r, t[7] = 0, t[8] = 0, t[9] = -r, t[10] = a, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.fromYRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = a, t[1] = 0, t[2] = -r, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = r, t[9] = 0, t[10] = a, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.fromZRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = a, t[1] = r, t[2] = 0, t[3] = 0, t[4] = -r, t[5] = a, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.fromRotationTranslation = o, n.fromQuat2 = function (t, n) {\n      var r = new a.ARRAY_TYPE(3),\n          e = -n[0],\n          u = -n[1],\n          i = -n[2],\n          s = n[3],\n          c = n[4],\n          f = n[5],\n          M = n[6],\n          h = n[7],\n          l = e * e + u * u + i * i + s * s;\n      l > 0 ? (r[0] = 2 * (c * s + h * e + f * i - M * u) / l, r[1] = 2 * (f * s + h * u + M * e - c * i) / l, r[2] = 2 * (M * s + h * i + c * u - f * e) / l) : (r[0] = 2 * (c * s + h * e + f * i - M * u), r[1] = 2 * (f * s + h * u + M * e - c * i), r[2] = 2 * (M * s + h * i + c * u - f * e));\n      return o(t, n, r), t;\n    }, n.getTranslation = function (t, n) {\n      return t[0] = n[12], t[1] = n[13], t[2] = n[14], t;\n    }, n.getScaling = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[4],\n          o = n[5],\n          i = n[6],\n          s = n[8],\n          c = n[9],\n          f = n[10];\n      return t[0] = Math.sqrt(r * r + a * a + e * e), t[1] = Math.sqrt(u * u + o * o + i * i), t[2] = Math.sqrt(s * s + c * c + f * f), t;\n    }, n.getRotation = function (t, n) {\n      var r = n[0] + n[5] + n[10],\n          a = 0;\n      r > 0 ? (a = 2 * Math.sqrt(r + 1), t[3] = .25 * a, t[0] = (n[6] - n[9]) / a, t[1] = (n[8] - n[2]) / a, t[2] = (n[1] - n[4]) / a) : n[0] > n[5] && n[0] > n[10] ? (a = 2 * Math.sqrt(1 + n[0] - n[5] - n[10]), t[3] = (n[6] - n[9]) / a, t[0] = .25 * a, t[1] = (n[1] + n[4]) / a, t[2] = (n[8] + n[2]) / a) : n[5] > n[10] ? (a = 2 * Math.sqrt(1 + n[5] - n[0] - n[10]), t[3] = (n[8] - n[2]) / a, t[0] = (n[1] + n[4]) / a, t[1] = .25 * a, t[2] = (n[6] + n[9]) / a) : (a = 2 * Math.sqrt(1 + n[10] - n[0] - n[5]), t[3] = (n[1] - n[4]) / a, t[0] = (n[8] + n[2]) / a, t[1] = (n[6] + n[9]) / a, t[2] = .25 * a);\n      return t;\n    }, n.fromRotationTranslationScale = function (t, n, r, a) {\n      var e = n[0],\n          u = n[1],\n          o = n[2],\n          i = n[3],\n          s = e + e,\n          c = u + u,\n          f = o + o,\n          M = e * s,\n          h = e * c,\n          l = e * f,\n          v = u * c,\n          d = u * f,\n          b = o * f,\n          m = i * s,\n          p = i * c,\n          P = i * f,\n          A = a[0],\n          E = a[1],\n          O = a[2];\n      return t[0] = (1 - (v + b)) * A, t[1] = (h + P) * A, t[2] = (l - p) * A, t[3] = 0, t[4] = (h - P) * E, t[5] = (1 - (M + b)) * E, t[6] = (d + m) * E, t[7] = 0, t[8] = (l + p) * O, t[9] = (d - m) * O, t[10] = (1 - (M + v)) * O, t[11] = 0, t[12] = r[0], t[13] = r[1], t[14] = r[2], t[15] = 1, t;\n    }, n.fromRotationTranslationScaleOrigin = function (t, n, r, a, e) {\n      var u = n[0],\n          o = n[1],\n          i = n[2],\n          s = n[3],\n          c = u + u,\n          f = o + o,\n          M = i + i,\n          h = u * c,\n          l = u * f,\n          v = u * M,\n          d = o * f,\n          b = o * M,\n          m = i * M,\n          p = s * c,\n          P = s * f,\n          A = s * M,\n          E = a[0],\n          O = a[1],\n          R = a[2],\n          y = e[0],\n          q = e[1],\n          x = e[2],\n          _ = (1 - (d + m)) * E,\n          Y = (l + A) * E,\n          L = (v - P) * E,\n          S = (l - A) * O,\n          w = (1 - (h + m)) * O,\n          I = (b + p) * O,\n          N = (v + P) * R,\n          g = (b - p) * R,\n          T = (1 - (h + d)) * R;\n\n      return t[0] = _, t[1] = Y, t[2] = L, t[3] = 0, t[4] = S, t[5] = w, t[6] = I, t[7] = 0, t[8] = N, t[9] = g, t[10] = T, t[11] = 0, t[12] = r[0] + y - (_ * y + S * q + N * x), t[13] = r[1] + q - (Y * y + w * q + g * x), t[14] = r[2] + x - (L * y + I * q + T * x), t[15] = 1, t;\n    }, n.fromQuat = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = r + r,\n          i = a + a,\n          s = e + e,\n          c = r * o,\n          f = a * o,\n          M = a * i,\n          h = e * o,\n          l = e * i,\n          v = e * s,\n          d = u * o,\n          b = u * i,\n          m = u * s;\n      return t[0] = 1 - M - v, t[1] = f + m, t[2] = h - b, t[3] = 0, t[4] = f - m, t[5] = 1 - c - v, t[6] = l + d, t[7] = 0, t[8] = h + b, t[9] = l - d, t[10] = 1 - c - M, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }, n.frustum = function (t, n, r, a, e, u, o) {\n      var i = 1 / (r - n),\n          s = 1 / (e - a),\n          c = 1 / (u - o);\n      return t[0] = 2 * u * i, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 2 * u * s, t[6] = 0, t[7] = 0, t[8] = (r + n) * i, t[9] = (e + a) * s, t[10] = (o + u) * c, t[11] = -1, t[12] = 0, t[13] = 0, t[14] = o * u * 2 * c, t[15] = 0, t;\n    }, n.perspective = function (t, n, r, a, e) {\n      var u = 1 / Math.tan(n / 2),\n          o = void 0;\n      t[0] = u / r, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = u, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[11] = -1, t[12] = 0, t[13] = 0, t[15] = 0, null != e && e !== 1 / 0 ? (o = 1 / (a - e), t[10] = (e + a) * o, t[14] = 2 * e * a * o) : (t[10] = -1, t[14] = -2 * a);\n      return t;\n    }, n.perspectiveFromFieldOfView = function (t, n, r, a) {\n      var e = Math.tan(n.upDegrees * Math.PI / 180),\n          u = Math.tan(n.downDegrees * Math.PI / 180),\n          o = Math.tan(n.leftDegrees * Math.PI / 180),\n          i = Math.tan(n.rightDegrees * Math.PI / 180),\n          s = 2 / (o + i),\n          c = 2 / (e + u);\n      return t[0] = s, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = c, t[6] = 0, t[7] = 0, t[8] = -(o - i) * s * .5, t[9] = (e - u) * c * .5, t[10] = a / (r - a), t[11] = -1, t[12] = 0, t[13] = 0, t[14] = a * r / (r - a), t[15] = 0, t;\n    }, n.ortho = function (t, n, r, a, e, u, o) {\n      var i = 1 / (n - r),\n          s = 1 / (a - e),\n          c = 1 / (u - o);\n      return t[0] = -2 * i, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = -2 * s, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 2 * c, t[11] = 0, t[12] = (n + r) * i, t[13] = (e + a) * s, t[14] = (o + u) * c, t[15] = 1, t;\n    }, n.lookAt = function (t, n, r, u) {\n      var o = void 0,\n          i = void 0,\n          s = void 0,\n          c = void 0,\n          f = void 0,\n          M = void 0,\n          h = void 0,\n          l = void 0,\n          v = void 0,\n          d = void 0,\n          b = n[0],\n          m = n[1],\n          p = n[2],\n          P = u[0],\n          A = u[1],\n          E = u[2],\n          O = r[0],\n          R = r[1],\n          y = r[2];\n      if (Math.abs(b - O) < a.EPSILON && Math.abs(m - R) < a.EPSILON && Math.abs(p - y) < a.EPSILON) return e(t);\n      h = b - O, l = m - R, v = p - y, d = 1 / Math.sqrt(h * h + l * l + v * v), o = A * (v *= d) - E * (l *= d), i = E * (h *= d) - P * v, s = P * l - A * h, (d = Math.sqrt(o * o + i * i + s * s)) ? (o *= d = 1 / d, i *= d, s *= d) : (o = 0, i = 0, s = 0);\n      c = l * s - v * i, f = v * o - h * s, M = h * i - l * o, (d = Math.sqrt(c * c + f * f + M * M)) ? (c *= d = 1 / d, f *= d, M *= d) : (c = 0, f = 0, M = 0);\n      return t[0] = o, t[1] = c, t[2] = h, t[3] = 0, t[4] = i, t[5] = f, t[6] = l, t[7] = 0, t[8] = s, t[9] = M, t[10] = v, t[11] = 0, t[12] = -(o * b + i * m + s * p), t[13] = -(c * b + f * m + M * p), t[14] = -(h * b + l * m + v * p), t[15] = 1, t;\n    }, n.targetTo = function (t, n, r, a) {\n      var e = n[0],\n          u = n[1],\n          o = n[2],\n          i = a[0],\n          s = a[1],\n          c = a[2],\n          f = e - r[0],\n          M = u - r[1],\n          h = o - r[2],\n          l = f * f + M * M + h * h;\n      l > 0 && (l = 1 / Math.sqrt(l), f *= l, M *= l, h *= l);\n      var v = s * h - c * M,\n          d = c * f - i * h,\n          b = i * M - s * f;\n      (l = v * v + d * d + b * b) > 0 && (l = 1 / Math.sqrt(l), v *= l, d *= l, b *= l);\n      return t[0] = v, t[1] = d, t[2] = b, t[3] = 0, t[4] = M * b - h * d, t[5] = h * v - f * b, t[6] = f * d - M * v, t[7] = 0, t[8] = f, t[9] = M, t[10] = h, t[11] = 0, t[12] = e, t[13] = u, t[14] = o, t[15] = 1, t;\n    }, n.str = function (t) {\n      return \"mat4(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \", \" + t[4] + \", \" + t[5] + \", \" + t[6] + \", \" + t[7] + \", \" + t[8] + \", \" + t[9] + \", \" + t[10] + \", \" + t[11] + \", \" + t[12] + \", \" + t[13] + \", \" + t[14] + \", \" + t[15] + \")\";\n    }, n.frob = function (t) {\n      return Math.sqrt(Math.pow(t[0], 2) + Math.pow(t[1], 2) + Math.pow(t[2], 2) + Math.pow(t[3], 2) + Math.pow(t[4], 2) + Math.pow(t[5], 2) + Math.pow(t[6], 2) + Math.pow(t[7], 2) + Math.pow(t[8], 2) + Math.pow(t[9], 2) + Math.pow(t[10], 2) + Math.pow(t[11], 2) + Math.pow(t[12], 2) + Math.pow(t[13], 2) + Math.pow(t[14], 2) + Math.pow(t[15], 2));\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t[4] = n[4] + r[4], t[5] = n[5] + r[5], t[6] = n[6] + r[6], t[7] = n[7] + r[7], t[8] = n[8] + r[8], t[9] = n[9] + r[9], t[10] = n[10] + r[10], t[11] = n[11] + r[11], t[12] = n[12] + r[12], t[13] = n[13] + r[13], t[14] = n[14] + r[14], t[15] = n[15] + r[15], t;\n    }, n.subtract = i, n.multiplyScalar = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t[4] = n[4] * r, t[5] = n[5] * r, t[6] = n[6] * r, t[7] = n[7] * r, t[8] = n[8] * r, t[9] = n[9] * r, t[10] = n[10] * r, t[11] = n[11] * r, t[12] = n[12] * r, t[13] = n[13] * r, t[14] = n[14] * r, t[15] = n[15] * r, t;\n    }, n.multiplyScalarAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t[3] = n[3] + r[3] * a, t[4] = n[4] + r[4] * a, t[5] = n[5] + r[5] * a, t[6] = n[6] + r[6] * a, t[7] = n[7] + r[7] * a, t[8] = n[8] + r[8] * a, t[9] = n[9] + r[9] * a, t[10] = n[10] + r[10] * a, t[11] = n[11] + r[11] * a, t[12] = n[12] + r[12] * a, t[13] = n[13] + r[13] * a, t[14] = n[14] + r[14] * a, t[15] = n[15] + r[15] * a, t;\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3] && t[4] === n[4] && t[5] === n[5] && t[6] === n[6] && t[7] === n[7] && t[8] === n[8] && t[9] === n[9] && t[10] === n[10] && t[11] === n[11] && t[12] === n[12] && t[13] === n[13] && t[14] === n[14] && t[15] === n[15];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = t[4],\n          s = t[5],\n          c = t[6],\n          f = t[7],\n          M = t[8],\n          h = t[9],\n          l = t[10],\n          v = t[11],\n          d = t[12],\n          b = t[13],\n          m = t[14],\n          p = t[15],\n          P = n[0],\n          A = n[1],\n          E = n[2],\n          O = n[3],\n          R = n[4],\n          y = n[5],\n          q = n[6],\n          x = n[7],\n          _ = n[8],\n          Y = n[9],\n          L = n[10],\n          S = n[11],\n          w = n[12],\n          I = n[13],\n          N = n[14],\n          g = n[15];\n      return Math.abs(r - P) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(P)) && Math.abs(e - A) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(A)) && Math.abs(u - E) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(E)) && Math.abs(o - O) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(O)) && Math.abs(i - R) <= a.EPSILON * Math.max(1, Math.abs(i), Math.abs(R)) && Math.abs(s - y) <= a.EPSILON * Math.max(1, Math.abs(s), Math.abs(y)) && Math.abs(c - q) <= a.EPSILON * Math.max(1, Math.abs(c), Math.abs(q)) && Math.abs(f - x) <= a.EPSILON * Math.max(1, Math.abs(f), Math.abs(x)) && Math.abs(M - _) <= a.EPSILON * Math.max(1, Math.abs(M), Math.abs(_)) && Math.abs(h - Y) <= a.EPSILON * Math.max(1, Math.abs(h), Math.abs(Y)) && Math.abs(l - L) <= a.EPSILON * Math.max(1, Math.abs(l), Math.abs(L)) && Math.abs(v - S) <= a.EPSILON * Math.max(1, Math.abs(v), Math.abs(S)) && Math.abs(d - w) <= a.EPSILON * Math.max(1, Math.abs(d), Math.abs(w)) && Math.abs(b - I) <= a.EPSILON * Math.max(1, Math.abs(b), Math.abs(I)) && Math.abs(m - N) <= a.EPSILON * Math.max(1, Math.abs(m), Math.abs(N)) && Math.abs(p - g) <= a.EPSILON * Math.max(1, Math.abs(p), Math.abs(g));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e(t) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 0, t[5] = 1, t[6] = 0, t[7] = 0, t[8] = 0, t[9] = 0, t[10] = 1, t[11] = 0, t[12] = 0, t[13] = 0, t[14] = 0, t[15] = 1, t;\n    }\n\n    function u(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = n[6],\n          f = n[7],\n          M = n[8],\n          h = n[9],\n          l = n[10],\n          v = n[11],\n          d = n[12],\n          b = n[13],\n          m = n[14],\n          p = n[15],\n          P = r[0],\n          A = r[1],\n          E = r[2],\n          O = r[3];\n      return t[0] = P * a + A * i + E * M + O * d, t[1] = P * e + A * s + E * h + O * b, t[2] = P * u + A * c + E * l + O * m, t[3] = P * o + A * f + E * v + O * p, P = r[4], A = r[5], E = r[6], O = r[7], t[4] = P * a + A * i + E * M + O * d, t[5] = P * e + A * s + E * h + O * b, t[6] = P * u + A * c + E * l + O * m, t[7] = P * o + A * f + E * v + O * p, P = r[8], A = r[9], E = r[10], O = r[11], t[8] = P * a + A * i + E * M + O * d, t[9] = P * e + A * s + E * h + O * b, t[10] = P * u + A * c + E * l + O * m, t[11] = P * o + A * f + E * v + O * p, P = r[12], A = r[13], E = r[14], O = r[15], t[12] = P * a + A * i + E * M + O * d, t[13] = P * e + A * s + E * h + O * b, t[14] = P * u + A * c + E * l + O * m, t[15] = P * o + A * f + E * v + O * p, t;\n    }\n\n    function o(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = a + a,\n          s = e + e,\n          c = u + u,\n          f = a * i,\n          M = a * s,\n          h = a * c,\n          l = e * s,\n          v = e * c,\n          d = u * c,\n          b = o * i,\n          m = o * s,\n          p = o * c;\n      return t[0] = 1 - (l + d), t[1] = M + p, t[2] = h - m, t[3] = 0, t[4] = M - p, t[5] = 1 - (f + d), t[6] = v + b, t[7] = 0, t[8] = h + m, t[9] = v - b, t[10] = 1 - (f + l), t[11] = 0, t[12] = r[0], t[13] = r[1], t[14] = r[2], t[15] = 1, t;\n    }\n\n    function i(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t[3] = n[3] - r[3], t[4] = n[4] - r[4], t[5] = n[5] - r[5], t[6] = n[6] - r[6], t[7] = n[7] - r[7], t[8] = n[8] - r[8], t[9] = n[9] - r[9], t[10] = n[10] - r[10], t[11] = n[11] - r[11], t[12] = n[12] - r[12], t[13] = n[13] - r[13], t[14] = n[14] - r[14], t[15] = n[15] - r[15], t;\n    }\n\n    n.mul = u, n.sub = i;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.sub = n.mul = void 0, n.create = function () {\n      var t = new a.ARRAY_TYPE(9);\n      a.ARRAY_TYPE != Float32Array && (t[1] = 0, t[2] = 0, t[3] = 0, t[5] = 0, t[6] = 0, t[7] = 0);\n      return t[0] = 1, t[4] = 1, t[8] = 1, t;\n    }, n.fromMat4 = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[4], t[4] = n[5], t[5] = n[6], t[6] = n[8], t[7] = n[9], t[8] = n[10], t;\n    }, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(9);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n[4] = t[4], n[5] = t[5], n[6] = t[6], n[7] = t[7], n[8] = t[8], n;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[4] = n[4], t[5] = n[5], t[6] = n[6], t[7] = n[7], t[8] = n[8], t;\n    }, n.fromValues = function (t, n, r, e, u, o, i, s, c) {\n      var f = new a.ARRAY_TYPE(9);\n      return f[0] = t, f[1] = n, f[2] = r, f[3] = e, f[4] = u, f[5] = o, f[6] = i, f[7] = s, f[8] = c, f;\n    }, n.set = function (t, n, r, a, e, u, o, i, s, c) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t[4] = u, t[5] = o, t[6] = i, t[7] = s, t[8] = c, t;\n    }, n.identity = function (t) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;\n    }, n.transpose = function (t, n) {\n      if (t === n) {\n        var r = n[1],\n            a = n[2],\n            e = n[5];\n        t[1] = n[3], t[2] = n[6], t[3] = r, t[5] = n[7], t[6] = a, t[7] = e;\n      } else t[0] = n[0], t[1] = n[3], t[2] = n[6], t[3] = n[1], t[4] = n[4], t[5] = n[7], t[6] = n[2], t[7] = n[5], t[8] = n[8];\n\n      return t;\n    }, n.invert = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = n[6],\n          c = n[7],\n          f = n[8],\n          M = f * o - i * c,\n          h = -f * u + i * s,\n          l = c * u - o * s,\n          v = r * M + a * h + e * l;\n      if (!v) return null;\n      return v = 1 / v, t[0] = M * v, t[1] = (-f * a + e * c) * v, t[2] = (i * a - e * o) * v, t[3] = h * v, t[4] = (f * r - e * s) * v, t[5] = (-i * r + e * u) * v, t[6] = l * v, t[7] = (-c * r + a * s) * v, t[8] = (o * r - a * u) * v, t;\n    }, n.adjoint = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = n[6],\n          c = n[7],\n          f = n[8];\n      return t[0] = o * f - i * c, t[1] = e * c - a * f, t[2] = a * i - e * o, t[3] = i * s - u * f, t[4] = r * f - e * s, t[5] = e * u - r * i, t[6] = u * c - o * s, t[7] = a * s - r * c, t[8] = r * o - a * u, t;\n    }, n.determinant = function (t) {\n      var n = t[0],\n          r = t[1],\n          a = t[2],\n          e = t[3],\n          u = t[4],\n          o = t[5],\n          i = t[6],\n          s = t[7],\n          c = t[8];\n      return n * (c * u - o * s) + r * (-c * e + o * i) + a * (s * e - u * i);\n    }, n.multiply = e, n.translate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = n[6],\n          f = n[7],\n          M = n[8],\n          h = r[0],\n          l = r[1];\n      return t[0] = a, t[1] = e, t[2] = u, t[3] = o, t[4] = i, t[5] = s, t[6] = h * a + l * o + c, t[7] = h * e + l * i + f, t[8] = h * u + l * s + M, t;\n    }, n.rotate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = n[6],\n          f = n[7],\n          M = n[8],\n          h = Math.sin(r),\n          l = Math.cos(r);\n      return t[0] = l * a + h * o, t[1] = l * e + h * i, t[2] = l * u + h * s, t[3] = l * o - h * a, t[4] = l * i - h * e, t[5] = l * s - h * u, t[6] = c, t[7] = f, t[8] = M, t;\n    }, n.scale = function (t, n, r) {\n      var a = r[0],\n          e = r[1];\n      return t[0] = a * n[0], t[1] = a * n[1], t[2] = a * n[2], t[3] = e * n[3], t[4] = e * n[4], t[5] = e * n[5], t[6] = n[6], t[7] = n[7], t[8] = n[8], t;\n    }, n.fromTranslation = function (t, n) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = 1, t[5] = 0, t[6] = n[0], t[7] = n[1], t[8] = 1, t;\n    }, n.fromRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = a, t[1] = r, t[2] = 0, t[3] = -r, t[4] = a, t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;\n    }, n.fromScaling = function (t, n) {\n      return t[0] = n[0], t[1] = 0, t[2] = 0, t[3] = 0, t[4] = n[1], t[5] = 0, t[6] = 0, t[7] = 0, t[8] = 1, t;\n    }, n.fromMat2d = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = 0, t[3] = n[2], t[4] = n[3], t[5] = 0, t[6] = n[4], t[7] = n[5], t[8] = 1, t;\n    }, n.fromQuat = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = r + r,\n          i = a + a,\n          s = e + e,\n          c = r * o,\n          f = a * o,\n          M = a * i,\n          h = e * o,\n          l = e * i,\n          v = e * s,\n          d = u * o,\n          b = u * i,\n          m = u * s;\n      return t[0] = 1 - M - v, t[3] = f - m, t[6] = h + b, t[1] = f + m, t[4] = 1 - c - v, t[7] = l - d, t[2] = h - b, t[5] = l + d, t[8] = 1 - c - M, t;\n    }, n.normalFromMat4 = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = n[6],\n          c = n[7],\n          f = n[8],\n          M = n[9],\n          h = n[10],\n          l = n[11],\n          v = n[12],\n          d = n[13],\n          b = n[14],\n          m = n[15],\n          p = r * i - a * o,\n          P = r * s - e * o,\n          A = r * c - u * o,\n          E = a * s - e * i,\n          O = a * c - u * i,\n          R = e * c - u * s,\n          y = f * d - M * v,\n          q = f * b - h * v,\n          x = f * m - l * v,\n          _ = M * b - h * d,\n          Y = M * m - l * d,\n          L = h * m - l * b,\n          S = p * L - P * Y + A * _ + E * x - O * q + R * y;\n\n      if (!S) return null;\n      return S = 1 / S, t[0] = (i * L - s * Y + c * _) * S, t[1] = (s * x - o * L - c * q) * S, t[2] = (o * Y - i * x + c * y) * S, t[3] = (e * Y - a * L - u * _) * S, t[4] = (r * L - e * x + u * q) * S, t[5] = (a * x - r * Y - u * y) * S, t[6] = (d * R - b * O + m * E) * S, t[7] = (b * A - v * R - m * P) * S, t[8] = (v * O - d * A + m * p) * S, t;\n    }, n.projection = function (t, n, r) {\n      return t[0] = 2 / n, t[1] = 0, t[2] = 0, t[3] = 0, t[4] = -2 / r, t[5] = 0, t[6] = -1, t[7] = 1, t[8] = 1, t;\n    }, n.str = function (t) {\n      return \"mat3(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \", \" + t[4] + \", \" + t[5] + \", \" + t[6] + \", \" + t[7] + \", \" + t[8] + \")\";\n    }, n.frob = function (t) {\n      return Math.sqrt(Math.pow(t[0], 2) + Math.pow(t[1], 2) + Math.pow(t[2], 2) + Math.pow(t[3], 2) + Math.pow(t[4], 2) + Math.pow(t[5], 2) + Math.pow(t[6], 2) + Math.pow(t[7], 2) + Math.pow(t[8], 2));\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t[4] = n[4] + r[4], t[5] = n[5] + r[5], t[6] = n[6] + r[6], t[7] = n[7] + r[7], t[8] = n[8] + r[8], t;\n    }, n.subtract = u, n.multiplyScalar = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t[4] = n[4] * r, t[5] = n[5] * r, t[6] = n[6] * r, t[7] = n[7] * r, t[8] = n[8] * r, t;\n    }, n.multiplyScalarAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t[3] = n[3] + r[3] * a, t[4] = n[4] + r[4] * a, t[5] = n[5] + r[5] * a, t[6] = n[6] + r[6] * a, t[7] = n[7] + r[7] * a, t[8] = n[8] + r[8] * a, t;\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3] && t[4] === n[4] && t[5] === n[5] && t[6] === n[6] && t[7] === n[7] && t[8] === n[8];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = t[4],\n          s = t[5],\n          c = t[6],\n          f = t[7],\n          M = t[8],\n          h = n[0],\n          l = n[1],\n          v = n[2],\n          d = n[3],\n          b = n[4],\n          m = n[5],\n          p = n[6],\n          P = n[7],\n          A = n[8];\n      return Math.abs(r - h) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(h)) && Math.abs(e - l) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(l)) && Math.abs(u - v) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(v)) && Math.abs(o - d) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(d)) && Math.abs(i - b) <= a.EPSILON * Math.max(1, Math.abs(i), Math.abs(b)) && Math.abs(s - m) <= a.EPSILON * Math.max(1, Math.abs(s), Math.abs(m)) && Math.abs(c - p) <= a.EPSILON * Math.max(1, Math.abs(c), Math.abs(p)) && Math.abs(f - P) <= a.EPSILON * Math.max(1, Math.abs(f), Math.abs(P)) && Math.abs(M - A) <= a.EPSILON * Math.max(1, Math.abs(M), Math.abs(A));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = n[6],\n          f = n[7],\n          M = n[8],\n          h = r[0],\n          l = r[1],\n          v = r[2],\n          d = r[3],\n          b = r[4],\n          m = r[5],\n          p = r[6],\n          P = r[7],\n          A = r[8];\n      return t[0] = h * a + l * o + v * c, t[1] = h * e + l * i + v * f, t[2] = h * u + l * s + v * M, t[3] = d * a + b * o + m * c, t[4] = d * e + b * i + m * f, t[5] = d * u + b * s + m * M, t[6] = p * a + P * o + A * c, t[7] = p * e + P * i + A * f, t[8] = p * u + P * s + A * M, t;\n    }\n\n    function u(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t[3] = n[3] - r[3], t[4] = n[4] - r[4], t[5] = n[5] - r[5], t[6] = n[6] - r[6], t[7] = n[7] - r[7], t[8] = n[8] - r[8], t;\n    }\n\n    n.mul = e, n.sub = u;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.forEach = n.sqrLen = n.sqrDist = n.dist = n.div = n.mul = n.sub = n.len = void 0, n.create = e, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(2);\n      return n[0] = t[0], n[1] = t[1], n;\n    }, n.fromValues = function (t, n) {\n      var r = new a.ARRAY_TYPE(2);\n      return r[0] = t, r[1] = n, r;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t;\n    }, n.set = function (t, n, r) {\n      return t[0] = n, t[1] = r, t;\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t;\n    }, n.subtract = u, n.multiply = o, n.divide = i, n.ceil = function (t, n) {\n      return t[0] = Math.ceil(n[0]), t[1] = Math.ceil(n[1]), t;\n    }, n.floor = function (t, n) {\n      return t[0] = Math.floor(n[0]), t[1] = Math.floor(n[1]), t;\n    }, n.min = function (t, n, r) {\n      return t[0] = Math.min(n[0], r[0]), t[1] = Math.min(n[1], r[1]), t;\n    }, n.max = function (t, n, r) {\n      return t[0] = Math.max(n[0], r[0]), t[1] = Math.max(n[1], r[1]), t;\n    }, n.round = function (t, n) {\n      return t[0] = Math.round(n[0]), t[1] = Math.round(n[1]), t;\n    }, n.scale = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t;\n    }, n.scaleAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t;\n    }, n.distance = s, n.squaredDistance = c, n.length = f, n.squaredLength = M, n.negate = function (t, n) {\n      return t[0] = -n[0], t[1] = -n[1], t;\n    }, n.inverse = function (t, n) {\n      return t[0] = 1 / n[0], t[1] = 1 / n[1], t;\n    }, n.normalize = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = r * r + a * a;\n      e > 0 && (e = 1 / Math.sqrt(e), t[0] = n[0] * e, t[1] = n[1] * e);\n      return t;\n    }, n.dot = function (t, n) {\n      return t[0] * n[0] + t[1] * n[1];\n    }, n.cross = function (t, n, r) {\n      var a = n[0] * r[1] - n[1] * r[0];\n      return t[0] = t[1] = 0, t[2] = a, t;\n    }, n.lerp = function (t, n, r, a) {\n      var e = n[0],\n          u = n[1];\n      return t[0] = e + a * (r[0] - e), t[1] = u + a * (r[1] - u), t;\n    }, n.random = function (t, n) {\n      n = n || 1;\n      var r = 2 * a.RANDOM() * Math.PI;\n      return t[0] = Math.cos(r) * n, t[1] = Math.sin(r) * n, t;\n    }, n.transformMat2 = function (t, n, r) {\n      var a = n[0],\n          e = n[1];\n      return t[0] = r[0] * a + r[2] * e, t[1] = r[1] * a + r[3] * e, t;\n    }, n.transformMat2d = function (t, n, r) {\n      var a = n[0],\n          e = n[1];\n      return t[0] = r[0] * a + r[2] * e + r[4], t[1] = r[1] * a + r[3] * e + r[5], t;\n    }, n.transformMat3 = function (t, n, r) {\n      var a = n[0],\n          e = n[1];\n      return t[0] = r[0] * a + r[3] * e + r[6], t[1] = r[1] * a + r[4] * e + r[7], t;\n    }, n.transformMat4 = function (t, n, r) {\n      var a = n[0],\n          e = n[1];\n      return t[0] = r[0] * a + r[4] * e + r[12], t[1] = r[1] * a + r[5] * e + r[13], t;\n    }, n.rotate = function (t, n, r, a) {\n      var e = n[0] - r[0],\n          u = n[1] - r[1],\n          o = Math.sin(a),\n          i = Math.cos(a);\n      return t[0] = e * i - u * o + r[0], t[1] = e * o + u * i + r[1], t;\n    }, n.angle = function (t, n) {\n      var r = t[0],\n          a = t[1],\n          e = n[0],\n          u = n[1],\n          o = r * r + a * a;\n      o > 0 && (o = 1 / Math.sqrt(o));\n      var i = e * e + u * u;\n      i > 0 && (i = 1 / Math.sqrt(i));\n      var s = (r * e + a * u) * o * i;\n      return s > 1 ? 0 : s < -1 ? Math.PI : Math.acos(s);\n    }, n.str = function (t) {\n      return \"vec2(\" + t[0] + \", \" + t[1] + \")\";\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = n[0],\n          o = n[1];\n      return Math.abs(r - u) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(u)) && Math.abs(e - o) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(o));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e() {\n      var t = new a.ARRAY_TYPE(2);\n      return a.ARRAY_TYPE != Float32Array && (t[0] = 0, t[1] = 0), t;\n    }\n\n    function u(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t;\n    }\n\n    function o(t, n, r) {\n      return t[0] = n[0] * r[0], t[1] = n[1] * r[1], t;\n    }\n\n    function i(t, n, r) {\n      return t[0] = n[0] / r[0], t[1] = n[1] / r[1], t;\n    }\n\n    function s(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1];\n      return Math.sqrt(r * r + a * a);\n    }\n\n    function c(t, n) {\n      var r = n[0] - t[0],\n          a = n[1] - t[1];\n      return r * r + a * a;\n    }\n\n    function f(t) {\n      var n = t[0],\n          r = t[1];\n      return Math.sqrt(n * n + r * r);\n    }\n\n    function M(t) {\n      var n = t[0],\n          r = t[1];\n      return n * n + r * r;\n    }\n\n    n.len = f, n.sub = u, n.mul = o, n.div = i, n.dist = s, n.sqrDist = c, n.sqrLen = M, n.forEach = function () {\n      var t = e();\n      return function (n, r, a, e, u, o) {\n        var i = void 0,\n            s = void 0;\n\n        for (r || (r = 2), a || (a = 0), s = e ? Math.min(e * r + a, n.length) : n.length, i = a; i < s; i += r) {\n          t[0] = n[i], t[1] = n[i + 1], u(t, t, o), n[i] = t[0], n[i + 1] = t[1];\n        }\n\n        return n;\n      };\n    }();\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.sqrLen = n.squaredLength = n.len = n.length = n.dot = n.mul = n.setReal = n.getReal = void 0, n.create = function () {\n      var t = new a.ARRAY_TYPE(8);\n      a.ARRAY_TYPE != Float32Array && (t[0] = 0, t[1] = 0, t[2] = 0, t[4] = 0, t[5] = 0, t[6] = 0, t[7] = 0);\n      return t[3] = 1, t;\n    }, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(8);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n[4] = t[4], n[5] = t[5], n[6] = t[6], n[7] = t[7], n;\n    }, n.fromValues = function (t, n, r, e, u, o, i, s) {\n      var c = new a.ARRAY_TYPE(8);\n      return c[0] = t, c[1] = n, c[2] = r, c[3] = e, c[4] = u, c[5] = o, c[6] = i, c[7] = s, c;\n    }, n.fromRotationTranslationValues = function (t, n, r, e, u, o, i) {\n      var s = new a.ARRAY_TYPE(8);\n      s[0] = t, s[1] = n, s[2] = r, s[3] = e;\n      var c = .5 * u,\n          f = .5 * o,\n          M = .5 * i;\n      return s[4] = c * e + f * r - M * n, s[5] = f * e + M * t - c * r, s[6] = M * e + c * n - f * t, s[7] = -c * t - f * n - M * r, s;\n    }, n.fromRotationTranslation = i, n.fromTranslation = function (t, n) {\n      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t[4] = .5 * n[0], t[5] = .5 * n[1], t[6] = .5 * n[2], t[7] = 0, t;\n    }, n.fromRotation = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[4] = 0, t[5] = 0, t[6] = 0, t[7] = 0, t;\n    }, n.fromMat4 = function (t, n) {\n      var r = e.create();\n      u.getRotation(r, n);\n      var o = new a.ARRAY_TYPE(3);\n      return u.getTranslation(o, n), i(t, r, o), t;\n    }, n.copy = s, n.identity = function (t) {\n      return t[0] = 0, t[1] = 0, t[2] = 0, t[3] = 1, t[4] = 0, t[5] = 0, t[6] = 0, t[7] = 0, t;\n    }, n.set = function (t, n, r, a, e, u, o, i, s) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t[4] = u, t[5] = o, t[6] = i, t[7] = s, t;\n    }, n.getDual = function (t, n) {\n      return t[0] = n[4], t[1] = n[5], t[2] = n[6], t[3] = n[7], t;\n    }, n.setDual = function (t, n) {\n      return t[4] = n[0], t[5] = n[1], t[6] = n[2], t[7] = n[3], t;\n    }, n.getTranslation = function (t, n) {\n      var r = n[4],\n          a = n[5],\n          e = n[6],\n          u = n[7],\n          o = -n[0],\n          i = -n[1],\n          s = -n[2],\n          c = n[3];\n      return t[0] = 2 * (r * c + u * o + a * s - e * i), t[1] = 2 * (a * c + u * i + e * o - r * s), t[2] = 2 * (e * c + u * s + r * i - a * o), t;\n    }, n.translate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = .5 * r[0],\n          s = .5 * r[1],\n          c = .5 * r[2],\n          f = n[4],\n          M = n[5],\n          h = n[6],\n          l = n[7];\n      return t[0] = a, t[1] = e, t[2] = u, t[3] = o, t[4] = o * i + e * c - u * s + f, t[5] = o * s + u * i - a * c + M, t[6] = o * c + a * s - e * i + h, t[7] = -a * i - e * s - u * c + l, t;\n    }, n.rotateX = function (t, n, r) {\n      var a = -n[0],\n          u = -n[1],\n          o = -n[2],\n          i = n[3],\n          s = n[4],\n          c = n[5],\n          f = n[6],\n          M = n[7],\n          h = s * i + M * a + c * o - f * u,\n          l = c * i + M * u + f * a - s * o,\n          v = f * i + M * o + s * u - c * a,\n          d = M * i - s * a - c * u - f * o;\n      return e.rotateX(t, n, r), a = t[0], u = t[1], o = t[2], i = t[3], t[4] = h * i + d * a + l * o - v * u, t[5] = l * i + d * u + v * a - h * o, t[6] = v * i + d * o + h * u - l * a, t[7] = d * i - h * a - l * u - v * o, t;\n    }, n.rotateY = function (t, n, r) {\n      var a = -n[0],\n          u = -n[1],\n          o = -n[2],\n          i = n[3],\n          s = n[4],\n          c = n[5],\n          f = n[6],\n          M = n[7],\n          h = s * i + M * a + c * o - f * u,\n          l = c * i + M * u + f * a - s * o,\n          v = f * i + M * o + s * u - c * a,\n          d = M * i - s * a - c * u - f * o;\n      return e.rotateY(t, n, r), a = t[0], u = t[1], o = t[2], i = t[3], t[4] = h * i + d * a + l * o - v * u, t[5] = l * i + d * u + v * a - h * o, t[6] = v * i + d * o + h * u - l * a, t[7] = d * i - h * a - l * u - v * o, t;\n    }, n.rotateZ = function (t, n, r) {\n      var a = -n[0],\n          u = -n[1],\n          o = -n[2],\n          i = n[3],\n          s = n[4],\n          c = n[5],\n          f = n[6],\n          M = n[7],\n          h = s * i + M * a + c * o - f * u,\n          l = c * i + M * u + f * a - s * o,\n          v = f * i + M * o + s * u - c * a,\n          d = M * i - s * a - c * u - f * o;\n      return e.rotateZ(t, n, r), a = t[0], u = t[1], o = t[2], i = t[3], t[4] = h * i + d * a + l * o - v * u, t[5] = l * i + d * u + v * a - h * o, t[6] = v * i + d * o + h * u - l * a, t[7] = d * i - h * a - l * u - v * o, t;\n    }, n.rotateByQuatAppend = function (t, n, r) {\n      var a = r[0],\n          e = r[1],\n          u = r[2],\n          o = r[3],\n          i = n[0],\n          s = n[1],\n          c = n[2],\n          f = n[3];\n      return t[0] = i * o + f * a + s * u - c * e, t[1] = s * o + f * e + c * a - i * u, t[2] = c * o + f * u + i * e - s * a, t[3] = f * o - i * a - s * e - c * u, i = n[4], s = n[5], c = n[6], f = n[7], t[4] = i * o + f * a + s * u - c * e, t[5] = s * o + f * e + c * a - i * u, t[6] = c * o + f * u + i * e - s * a, t[7] = f * o - i * a - s * e - c * u, t;\n    }, n.rotateByQuatPrepend = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = r[0],\n          s = r[1],\n          c = r[2],\n          f = r[3];\n      return t[0] = a * f + o * i + e * c - u * s, t[1] = e * f + o * s + u * i - a * c, t[2] = u * f + o * c + a * s - e * i, t[3] = o * f - a * i - e * s - u * c, i = r[4], s = r[5], c = r[6], f = r[7], t[4] = a * f + o * i + e * c - u * s, t[5] = e * f + o * s + u * i - a * c, t[6] = u * f + o * c + a * s - e * i, t[7] = o * f - a * i - e * s - u * c, t;\n    }, n.rotateAroundAxis = function (t, n, r, e) {\n      if (Math.abs(e) < a.EPSILON) return s(t, n);\n      var u = Math.sqrt(r[0] * r[0] + r[1] * r[1] + r[2] * r[2]);\n      e *= .5;\n      var o = Math.sin(e),\n          i = o * r[0] / u,\n          c = o * r[1] / u,\n          f = o * r[2] / u,\n          M = Math.cos(e),\n          h = n[0],\n          l = n[1],\n          v = n[2],\n          d = n[3];\n      t[0] = h * M + d * i + l * f - v * c, t[1] = l * M + d * c + v * i - h * f, t[2] = v * M + d * f + h * c - l * i, t[3] = d * M - h * i - l * c - v * f;\n      var b = n[4],\n          m = n[5],\n          p = n[6],\n          P = n[7];\n      return t[4] = b * M + P * i + m * f - p * c, t[5] = m * M + P * c + p * i - b * f, t[6] = p * M + P * f + b * c - m * i, t[7] = P * M - b * i - m * c - p * f, t;\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t[4] = n[4] + r[4], t[5] = n[5] + r[5], t[6] = n[6] + r[6], t[7] = n[7] + r[7], t;\n    }, n.multiply = c, n.scale = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t[4] = n[4] * r, t[5] = n[5] * r, t[6] = n[6] * r, t[7] = n[7] * r, t;\n    }, n.lerp = function (t, n, r, a) {\n      var e = 1 - a;\n      f(n, r) < 0 && (a = -a);\n      return t[0] = n[0] * e + r[0] * a, t[1] = n[1] * e + r[1] * a, t[2] = n[2] * e + r[2] * a, t[3] = n[3] * e + r[3] * a, t[4] = n[4] * e + r[4] * a, t[5] = n[5] * e + r[5] * a, t[6] = n[6] * e + r[6] * a, t[7] = n[7] * e + r[7] * a, t;\n    }, n.invert = function (t, n) {\n      var r = h(n);\n      return t[0] = -n[0] / r, t[1] = -n[1] / r, t[2] = -n[2] / r, t[3] = n[3] / r, t[4] = -n[4] / r, t[5] = -n[5] / r, t[6] = -n[6] / r, t[7] = n[7] / r, t;\n    }, n.conjugate = function (t, n) {\n      return t[0] = -n[0], t[1] = -n[1], t[2] = -n[2], t[3] = n[3], t[4] = -n[4], t[5] = -n[5], t[6] = -n[6], t[7] = n[7], t;\n    }, n.normalize = function (t, n) {\n      var r = h(n);\n\n      if (r > 0) {\n        r = Math.sqrt(r);\n        var a = n[0] / r,\n            e = n[1] / r,\n            u = n[2] / r,\n            o = n[3] / r,\n            i = n[4],\n            s = n[5],\n            c = n[6],\n            f = n[7],\n            M = a * i + e * s + u * c + o * f;\n        t[0] = a, t[1] = e, t[2] = u, t[3] = o, t[4] = (i - a * M) / r, t[5] = (s - e * M) / r, t[6] = (c - u * M) / r, t[7] = (f - o * M) / r;\n      }\n\n      return t;\n    }, n.str = function (t) {\n      return \"quat2(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \", \" + t[4] + \", \" + t[5] + \", \" + t[6] + \", \" + t[7] + \")\";\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3] && t[4] === n[4] && t[5] === n[5] && t[6] === n[6] && t[7] === n[7];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = t[4],\n          s = t[5],\n          c = t[6],\n          f = t[7],\n          M = n[0],\n          h = n[1],\n          l = n[2],\n          v = n[3],\n          d = n[4],\n          b = n[5],\n          m = n[6],\n          p = n[7];\n      return Math.abs(r - M) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(M)) && Math.abs(e - h) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(h)) && Math.abs(u - l) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(l)) && Math.abs(o - v) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(v)) && Math.abs(i - d) <= a.EPSILON * Math.max(1, Math.abs(i), Math.abs(d)) && Math.abs(s - b) <= a.EPSILON * Math.max(1, Math.abs(s), Math.abs(b)) && Math.abs(c - m) <= a.EPSILON * Math.max(1, Math.abs(c), Math.abs(m)) && Math.abs(f - p) <= a.EPSILON * Math.max(1, Math.abs(f), Math.abs(p));\n    };\n    var a = o(r(0)),\n        e = o(r(3)),\n        u = o(r(4));\n\n    function o(t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }\n\n    function i(t, n, r) {\n      var a = .5 * r[0],\n          e = .5 * r[1],\n          u = .5 * r[2],\n          o = n[0],\n          i = n[1],\n          s = n[2],\n          c = n[3];\n      return t[0] = o, t[1] = i, t[2] = s, t[3] = c, t[4] = a * c + e * s - u * i, t[5] = e * c + u * o - a * s, t[6] = u * c + a * i - e * o, t[7] = -a * o - e * i - u * s, t;\n    }\n\n    function s(t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[4] = n[4], t[5] = n[5], t[6] = n[6], t[7] = n[7], t;\n    }\n\n    n.getReal = e.copy;\n    n.setReal = e.copy;\n\n    function c(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = r[4],\n          s = r[5],\n          c = r[6],\n          f = r[7],\n          M = n[4],\n          h = n[5],\n          l = n[6],\n          v = n[7],\n          d = r[0],\n          b = r[1],\n          m = r[2],\n          p = r[3];\n      return t[0] = a * p + o * d + e * m - u * b, t[1] = e * p + o * b + u * d - a * m, t[2] = u * p + o * m + a * b - e * d, t[3] = o * p - a * d - e * b - u * m, t[4] = a * f + o * i + e * c - u * s + M * p + v * d + h * m - l * b, t[5] = e * f + o * s + u * i - a * c + h * p + v * b + l * d - M * m, t[6] = u * f + o * c + a * s - e * i + l * p + v * m + M * b - h * d, t[7] = o * f - a * i - e * s - u * c + v * p - M * d - h * b - l * m, t;\n    }\n\n    n.mul = c;\n    var f = n.dot = e.dot;\n    var M = n.length = e.length,\n        h = (n.len = M, n.squaredLength = e.squaredLength);\n    n.sqrLen = h;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.sub = n.mul = void 0, n.create = function () {\n      var t = new a.ARRAY_TYPE(6);\n      a.ARRAY_TYPE != Float32Array && (t[1] = 0, t[2] = 0, t[4] = 0, t[5] = 0);\n      return t[0] = 1, t[3] = 1, t;\n    }, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(6);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n[4] = t[4], n[5] = t[5], n;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t[4] = n[4], t[5] = n[5], t;\n    }, n.identity = function (t) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 1, t[4] = 0, t[5] = 0, t;\n    }, n.fromValues = function (t, n, r, e, u, o) {\n      var i = new a.ARRAY_TYPE(6);\n      return i[0] = t, i[1] = n, i[2] = r, i[3] = e, i[4] = u, i[5] = o, i;\n    }, n.set = function (t, n, r, a, e, u, o) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t[4] = u, t[5] = o, t;\n    }, n.invert = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = n[4],\n          i = n[5],\n          s = r * u - a * e;\n      if (!s) return null;\n      return s = 1 / s, t[0] = u * s, t[1] = -a * s, t[2] = -e * s, t[3] = r * s, t[4] = (e * i - u * o) * s, t[5] = (a * o - r * i) * s, t;\n    }, n.determinant = function (t) {\n      return t[0] * t[3] - t[1] * t[2];\n    }, n.multiply = e, n.rotate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = Math.sin(r),\n          f = Math.cos(r);\n      return t[0] = a * f + u * c, t[1] = e * f + o * c, t[2] = a * -c + u * f, t[3] = e * -c + o * f, t[4] = i, t[5] = s, t;\n    }, n.scale = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = r[0],\n          f = r[1];\n      return t[0] = a * c, t[1] = e * c, t[2] = u * f, t[3] = o * f, t[4] = i, t[5] = s, t;\n    }, n.translate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = r[0],\n          f = r[1];\n      return t[0] = a, t[1] = e, t[2] = u, t[3] = o, t[4] = a * c + u * f + i, t[5] = e * c + o * f + s, t;\n    }, n.fromRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = a, t[1] = r, t[2] = -r, t[3] = a, t[4] = 0, t[5] = 0, t;\n    }, n.fromScaling = function (t, n) {\n      return t[0] = n[0], t[1] = 0, t[2] = 0, t[3] = n[1], t[4] = 0, t[5] = 0, t;\n    }, n.fromTranslation = function (t, n) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 1, t[4] = n[0], t[5] = n[1], t;\n    }, n.str = function (t) {\n      return \"mat2d(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \", \" + t[4] + \", \" + t[5] + \")\";\n    }, n.frob = function (t) {\n      return Math.sqrt(Math.pow(t[0], 2) + Math.pow(t[1], 2) + Math.pow(t[2], 2) + Math.pow(t[3], 2) + Math.pow(t[4], 2) + Math.pow(t[5], 2) + 1);\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t[4] = n[4] + r[4], t[5] = n[5] + r[5], t;\n    }, n.subtract = u, n.multiplyScalar = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t[4] = n[4] * r, t[5] = n[5] * r, t;\n    }, n.multiplyScalarAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t[3] = n[3] + r[3] * a, t[4] = n[4] + r[4] * a, t[5] = n[5] + r[5] * a, t;\n    }, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3] && t[4] === n[4] && t[5] === n[5];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = t[4],\n          s = t[5],\n          c = n[0],\n          f = n[1],\n          M = n[2],\n          h = n[3],\n          l = n[4],\n          v = n[5];\n      return Math.abs(r - c) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(c)) && Math.abs(e - f) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(f)) && Math.abs(u - M) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(M)) && Math.abs(o - h) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(h)) && Math.abs(i - l) <= a.EPSILON * Math.max(1, Math.abs(i), Math.abs(l)) && Math.abs(s - v) <= a.EPSILON * Math.max(1, Math.abs(s), Math.abs(v));\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = n[4],\n          s = n[5],\n          c = r[0],\n          f = r[1],\n          M = r[2],\n          h = r[3],\n          l = r[4],\n          v = r[5];\n      return t[0] = a * c + u * f, t[1] = e * c + o * f, t[2] = a * M + u * h, t[3] = e * M + o * h, t[4] = a * l + u * v + i, t[5] = e * l + o * v + s, t;\n    }\n\n    function u(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t[3] = n[3] - r[3], t[4] = n[4] - r[4], t[5] = n[5] - r[5], t;\n    }\n\n    n.mul = e, n.sub = u;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.sub = n.mul = void 0, n.create = function () {\n      var t = new a.ARRAY_TYPE(4);\n      a.ARRAY_TYPE != Float32Array && (t[1] = 0, t[2] = 0);\n      return t[0] = 1, t[3] = 1, t;\n    }, n.clone = function (t) {\n      var n = new a.ARRAY_TYPE(4);\n      return n[0] = t[0], n[1] = t[1], n[2] = t[2], n[3] = t[3], n;\n    }, n.copy = function (t, n) {\n      return t[0] = n[0], t[1] = n[1], t[2] = n[2], t[3] = n[3], t;\n    }, n.identity = function (t) {\n      return t[0] = 1, t[1] = 0, t[2] = 0, t[3] = 1, t;\n    }, n.fromValues = function (t, n, r, e) {\n      var u = new a.ARRAY_TYPE(4);\n      return u[0] = t, u[1] = n, u[2] = r, u[3] = e, u;\n    }, n.set = function (t, n, r, a, e) {\n      return t[0] = n, t[1] = r, t[2] = a, t[3] = e, t;\n    }, n.transpose = function (t, n) {\n      if (t === n) {\n        var r = n[1];\n        t[1] = n[2], t[2] = r;\n      } else t[0] = n[0], t[1] = n[2], t[2] = n[1], t[3] = n[3];\n\n      return t;\n    }, n.invert = function (t, n) {\n      var r = n[0],\n          a = n[1],\n          e = n[2],\n          u = n[3],\n          o = r * u - e * a;\n      if (!o) return null;\n      return o = 1 / o, t[0] = u * o, t[1] = -a * o, t[2] = -e * o, t[3] = r * o, t;\n    }, n.adjoint = function (t, n) {\n      var r = n[0];\n      return t[0] = n[3], t[1] = -n[1], t[2] = -n[2], t[3] = r, t;\n    }, n.determinant = function (t) {\n      return t[0] * t[3] - t[2] * t[1];\n    }, n.multiply = e, n.rotate = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = Math.sin(r),\n          s = Math.cos(r);\n      return t[0] = a * s + u * i, t[1] = e * s + o * i, t[2] = a * -i + u * s, t[3] = e * -i + o * s, t;\n    }, n.scale = function (t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = r[0],\n          s = r[1];\n      return t[0] = a * i, t[1] = e * i, t[2] = u * s, t[3] = o * s, t;\n    }, n.fromRotation = function (t, n) {\n      var r = Math.sin(n),\n          a = Math.cos(n);\n      return t[0] = a, t[1] = r, t[2] = -r, t[3] = a, t;\n    }, n.fromScaling = function (t, n) {\n      return t[0] = n[0], t[1] = 0, t[2] = 0, t[3] = n[1], t;\n    }, n.str = function (t) {\n      return \"mat2(\" + t[0] + \", \" + t[1] + \", \" + t[2] + \", \" + t[3] + \")\";\n    }, n.frob = function (t) {\n      return Math.sqrt(Math.pow(t[0], 2) + Math.pow(t[1], 2) + Math.pow(t[2], 2) + Math.pow(t[3], 2));\n    }, n.LDU = function (t, n, r, a) {\n      return t[2] = a[2] / a[0], r[0] = a[0], r[1] = a[1], r[3] = a[3] - t[2] * r[1], [t, n, r];\n    }, n.add = function (t, n, r) {\n      return t[0] = n[0] + r[0], t[1] = n[1] + r[1], t[2] = n[2] + r[2], t[3] = n[3] + r[3], t;\n    }, n.subtract = u, n.exactEquals = function (t, n) {\n      return t[0] === n[0] && t[1] === n[1] && t[2] === n[2] && t[3] === n[3];\n    }, n.equals = function (t, n) {\n      var r = t[0],\n          e = t[1],\n          u = t[2],\n          o = t[3],\n          i = n[0],\n          s = n[1],\n          c = n[2],\n          f = n[3];\n      return Math.abs(r - i) <= a.EPSILON * Math.max(1, Math.abs(r), Math.abs(i)) && Math.abs(e - s) <= a.EPSILON * Math.max(1, Math.abs(e), Math.abs(s)) && Math.abs(u - c) <= a.EPSILON * Math.max(1, Math.abs(u), Math.abs(c)) && Math.abs(o - f) <= a.EPSILON * Math.max(1, Math.abs(o), Math.abs(f));\n    }, n.multiplyScalar = function (t, n, r) {\n      return t[0] = n[0] * r, t[1] = n[1] * r, t[2] = n[2] * r, t[3] = n[3] * r, t;\n    }, n.multiplyScalarAndAdd = function (t, n, r, a) {\n      return t[0] = n[0] + r[0] * a, t[1] = n[1] + r[1] * a, t[2] = n[2] + r[2] * a, t[3] = n[3] + r[3] * a, t;\n    };\n\n    var a = function (t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }(r(0));\n\n    function e(t, n, r) {\n      var a = n[0],\n          e = n[1],\n          u = n[2],\n          o = n[3],\n          i = r[0],\n          s = r[1],\n          c = r[2],\n          f = r[3];\n      return t[0] = a * i + u * s, t[1] = e * i + o * s, t[2] = a * c + u * f, t[3] = e * c + o * f, t;\n    }\n\n    function u(t, n, r) {\n      return t[0] = n[0] - r[0], t[1] = n[1] - r[1], t[2] = n[2] - r[2], t[3] = n[3] - r[3], t;\n    }\n\n    n.mul = e, n.sub = u;\n  }, function (t, n, r) {\n\n    Object.defineProperty(n, \"__esModule\", {\n      value: !0\n    }), n.vec4 = n.vec3 = n.vec2 = n.quat2 = n.quat = n.mat4 = n.mat3 = n.mat2d = n.mat2 = n.glMatrix = void 0;\n    var a = l(r(0)),\n        e = l(r(9)),\n        u = l(r(8)),\n        o = l(r(5)),\n        i = l(r(4)),\n        s = l(r(3)),\n        c = l(r(7)),\n        f = l(r(6)),\n        M = l(r(2)),\n        h = l(r(1));\n\n    function l(t) {\n      if (t && t.__esModule) return t;\n      var n = {};\n      if (null != t) for (var r in t) {\n        Object.prototype.hasOwnProperty.call(t, r) && (n[r] = t[r]);\n      }\n      return n[\"default\"] = t, n;\n    }\n\n    n.glMatrix = a, n.mat2 = e, n.mat2d = u, n.mat3 = o, n.mat4 = i, n.quat = s, n.quat2 = c, n.vec2 = f, n.vec3 = M, n.vec4 = h;\n  }]);\n});\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js\":\n/*!****************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js ***!\n  \\****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = add;\n/**\n * Adds two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction add(out, a, b) {\n  out[0] = a[0] + b[0];\n  out[1] = a[1] + b[1];\n  out[2] = a[2] + b[2];\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js\":\n/*!*****************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js ***!\n  \\*****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = copy;\n/**\n * Copy the values from one vec3 to another\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the source vector\n * @returns {vec3} out\n */\n\nfunction copy(out, a) {\n  out[0] = a[0];\n  out[1] = a[1];\n  out[2] = a[2];\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js\":\n/*!******************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js ***!\n  \\******************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = cross;\n/**\n * Computes the cross product of two vec3's\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction cross(out, a, b) {\n  var ax = a[0],\n      ay = a[1],\n      az = a[2],\n      bx = b[0],\n      by = b[1],\n      bz = b[2];\n  out[0] = ay * bz - az * by;\n  out[1] = az * bx - ax * bz;\n  out[2] = ax * by - ay * bx;\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js\":\n/*!****************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js ***!\n  \\****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = dot;\n/**\n * Calculates the dot product of two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} dot product of a and b\n */\n\nfunction dot(a, b) {\n  return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js\":\n/*!******************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js ***!\n  \\******************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = scale;\n/**\n * Scales a vec3 by a scalar number\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the vector to scale\n * @param {Number} b amount to scale the vector by\n * @returns {vec3} out\n */\n\nfunction scale(out, a, b) {\n  out[0] = a[0] * b;\n  out[1] = a[1] * b;\n  out[2] = a[2] * b;\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js\":\n/*!************************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js ***!\n  \\************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = scaleAndAdd;\n/**\n * Adds two vec3's after scaling the second operand by a scalar value\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @param {Number} scale the amount to scale b by before adding\n * @returns {vec3} out\n */\n\nfunction scaleAndAdd(out, a, b, scale) {\n  out[0] = a[0] + b[0] * scale;\n  out[1] = a[1] + b[1] * scale;\n  out[2] = a[2] + b[2] * scale;\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js\":\n/*!****************************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js ***!\n  \\****************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = squaredDistance;\n/**\n * Calculates the squared euclidian distance between two vec3's\n *\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {Number} squared distance between a and b\n */\n\nfunction squaredDistance(a, b) {\n  var x = b[0] - a[0],\n      y = b[1] - a[1],\n      z = b[2] - a[2];\n  return x * x + y * y + z * z;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js\":\n/*!*********************************************************!*\\\n  !*** ./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js ***!\n  \\*********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = subtract;\n/**\n * Subtracts vector b from vector a\n *\n * @param {vec3} out the receiving vector\n * @param {vec3} a the first operand\n * @param {vec3} b the second operand\n * @returns {vec3} out\n */\n\nfunction subtract(out, a, b) {\n  out[0] = a[0] - b[0];\n  out[1] = a[1] - b[1];\n  out[2] = a[2] - b[2];\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\":\n/*!*********************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/core/Class.js ***!\n  \\*********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n\n/**\n * @language=en\n * Create Example Class:\n * <pre>\n * var Bird = Hilo.Class.create({\n *     Extends: Animal,\n *     Mixes: EventMixin,\n *     constructor: function(name){\n *         this.name = name;\n *     },\n *     fly: function(){\n *         console.log('I am flying');\n *     },\n *     Statics: {\n *         isBird: function(bird){\n *             return bird instanceof Bird;\n *         }\n *     }\n * });\n *\n * var swallow = new Bird('swallow');\n * swallow.fly();\n * Bird.isBird(swallow);\n * </pre>\n * @namespace Class Class is created to aid the developer.\n * @static\n * @module hilo/core/Class\n */\nvar Class = function () {\n  /**\n   * @language=en\n   * Create a class based on the parameters, properties and methods specified.\n   * @param {Object} properties Properties and methods to create the class.\n   * <ul>\n   * <li><b>Extends</b> - Designed to inherit the parent class.</li>\n   * <li><b>Mixes</b> - Specifies mixed member collection object.</li>\n   * <li><b>Statics</b> - Static property or method specified class.</li>\n   * <li><b>constructor</b> -  The constructor of specified class.</li>\n   * <li>Other members of the property or method to create the class.</li>\n   * </ul>\n   * @returns {Object} Create classes.\n   */\n  var create = function create(properties) {\n    properties = properties || {};\n    var clazz = properties.hasOwnProperty('constructor') ? properties.constructor : function () {};\n    implement.call(clazz, properties);\n    return clazz;\n  };\n  /**\n   * @language=en\n   * @private\n   */\n\n\n  var implement = function implement(properties) {\n    var proto = {},\n        key,\n        value;\n\n    for (key in properties) {\n      value = properties[key];\n\n      if (classMutators.hasOwnProperty(key)) {\n        classMutators[key].call(this, value);\n      } else {\n        proto[key] = value;\n      }\n    }\n\n    mix(this.prototype, proto);\n  };\n\n  var classMutators =\n  /** @ignore */\n  {\n    Extends: function Extends(parent) {\n      var existed = this.prototype,\n          proto = createProto(parent.prototype); //inherit static properites\n\n      mix(this, parent); //keep existed properties\n\n      mix(proto, existed); //correct constructor\n\n      proto.constructor = this; //prototype chaining\n\n      this.prototype = proto; //shortcut to parent's prototype\n\n      this.superclass = parent.prototype;\n    },\n    Mixes: function Mixes(items) {\n      items instanceof Array || (items = [items]);\n      var proto = this.prototype,\n          item;\n\n      while (item = items.shift()) {\n        mix(proto, item.prototype || item);\n      }\n    },\n    Statics: function Statics(properties) {\n      mix(this, properties);\n    }\n  };\n  /**\n   * @language=en\n   * @private\n   */\n\n  var createProto = function () {\n    if (Object.__proto__) {\n      return function (proto) {\n        return {\n          __proto__: proto\n        };\n      };\n    } else {\n      var Ctor = function Ctor() {};\n\n      return function (proto) {\n        Ctor.prototype = proto;\n        return new Ctor();\n      };\n    }\n  }();\n  /**\n   * @language=en\n   * Mixed property or method.\n   * @param {Object} target Mixed audiences.\n   * @param {Object} source The source whose methods and properties are to be mixed. It can support multiple source parameters.\n   * @returns {Object} Mixed audiences.\n   */\n\n\n  var mix = function mix(target) {\n    for (var i = 1, len = arguments.length; i < len; i++) {\n      var source = arguments[i],\n          defineProps;\n\n      for (var key in source) {\n        var prop = source[key];\n\n        if (prop && typeof prop === 'object') {\n          if (prop.value !== undefined || typeof prop.get === 'function' || typeof prop.set === 'function') {\n            defineProps = defineProps || {};\n            defineProps[key] = prop;\n            continue;\n          }\n        }\n\n        target[key] = prop;\n      }\n\n      if (defineProps) defineProperties(target, defineProps);\n    }\n\n    return target;\n  };\n\n  var defineProperty, defineProperties;\n\n  try {\n    defineProperty = Object.defineProperty;\n    defineProperties = Object.defineProperties;\n    defineProperty({}, '$', {\n      value: 0\n    });\n  } catch (e) {\n    if ('__defineGetter__' in Object) {\n      defineProperty = function defineProperty(obj, prop, desc) {\n        if ('value' in desc) obj[prop] = desc.value;\n        if ('get' in desc) obj.__defineGetter__(prop, desc.get);\n        if ('set' in desc) obj.__defineSetter__(prop, desc.set);\n        return obj;\n      };\n\n      defineProperties = function defineProperties(obj, props) {\n        for (var prop in props) {\n          if (props.hasOwnProperty(prop)) {\n            defineProperty(obj, prop, props[prop]);\n          }\n        }\n\n        return obj;\n      };\n    }\n  }\n\n  return {\n    create: create,\n    mix: mix\n  };\n}();\n\nmodule.exports = Class;\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/event/EventMixin.js\":\n/*!***************************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/event/EventMixin.js ***!\n  \\***************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\nvar Class = __webpack_require__(/*! ../core/Class */ \"./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\");\n/**\n * @language=en\n * @class EventMixin is a mixin on event related functions. Use Class.mix(target, EventMixin) to add event function onto target.\n * @static\n * @mixin\n * @module hilo/event/EventMixin\n * @requires hilo/core/Class\n */\n\n\nvar EventMixin =\n/** @lends EventMixin# */\n{\n  _listeners: null,\n\n  /**\n   * @language=en\n   * Add an event listenser.\n   * @param {String} type Event type to listen.\n   * @param {Function} listener Callback function of event listening.\n   * @param {Boolean} once Listen on event only once and no more response after the first response?\n   * @returns {Object} The Event itself. Functions chain call supported.\n   */\n  on: function on(type, listener, once) {\n    var listeners = this._listeners = this._listeners || {};\n    var eventListeners = listeners[type] = listeners[type] || [];\n\n    for (var i = 0, len = eventListeners.length; i < len; i++) {\n      var el = eventListeners[i];\n      if (el.listener === listener) return;\n    }\n\n    eventListeners.push({\n      listener: listener,\n      once: once\n    });\n    return this;\n  },\n\n  /**\n   * @language=en\n   * Remove one event listener. Remove all event listeners if no parameter provided, and remove all event listeners on one type which is provided as the only parameter.\n   * @param {String} type The type of event listener that want to remove.\n   * @param {Function} listener Event listener callback function to be removed.\n   * @returns {Object} The Event itself. Functions chain call supported.\n   */\n  off: function off(type, listener) {\n    //remove all event listeners\n    if (arguments.length == 0) {\n      this._listeners = null;\n      return this;\n    }\n\n    var eventListeners = this._listeners && this._listeners[type];\n\n    if (eventListeners) {\n      //remove event listeners by specified type\n      if (arguments.length == 1) {\n        delete this._listeners[type];\n        return this;\n      }\n\n      for (var i = 0, len = eventListeners.length; i < len; i++) {\n        var el = eventListeners[i];\n\n        if (el.listener === listener) {\n          eventListeners.splice(i, 1);\n          if (eventListeners.length === 0) delete this._listeners[type];\n          break;\n        }\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * @language=en\n   * Send events. If the first parameter is an Object, take it  as an Event Object.\n   * @param {String} type Event type to send.\n   * @param {Object} detail The detail (parameters go with the event) of Event to send.\n   * @returns {Boolean} Whether Event call successfully.\n   */\n  fire: function fire(type, detail) {\n    var event, eventType;\n\n    if (typeof type === 'string') {\n      eventType = type;\n    } else {\n      event = type;\n      eventType = type.type;\n    }\n\n    var listeners = this._listeners;\n    if (!listeners) return false;\n    var eventListeners = listeners[eventType];\n\n    if (eventListeners) {\n      var eventListenersCopy = eventListeners.slice(0);\n      event = event || new EventObject(eventType, this, detail);\n      if (event._stopped) return false;\n\n      for (var i = 0; i < eventListenersCopy.length; i++) {\n        var el = eventListenersCopy[i];\n        el.listener.call(this, event);\n\n        if (el.once) {\n          var index = eventListeners.indexOf(el);\n\n          if (index > -1) {\n            eventListeners.splice(index, 1);\n          }\n        }\n      }\n\n      if (eventListeners.length == 0) delete listeners[eventType];\n      return true;\n    }\n\n    return false;\n  }\n};\n/**\n * @language=en\n * Event Object class. It's an private class now, but maybe will become a public class if needed.\n */\n\nvar EventObject = Class.create({\n  constructor: function EventObject(type, target, detail) {\n    this.type = type;\n    this.target = target;\n    this.detail = detail;\n    this.timeStamp = +new Date();\n  },\n  type: null,\n  target: null,\n  detail: null,\n  timeStamp: 0,\n  stopImmediatePropagation: function stopImmediatePropagation() {\n    this._stopped = true;\n  }\n}); //Trick: `stopImmediatePropagation` compatibility\n\nvar RawEvent = window.Event;\n\nif (RawEvent) {\n  var proto = RawEvent.prototype,\n      stop = proto.stopImmediatePropagation;\n\n  proto.stopImmediatePropagation = function () {\n    stop && stop.call(this);\n    this._stopped = true;\n  };\n}\n\nmodule.exports = EventMixin;\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/tween/Ease.js\":\n/*!*********************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/tween/Ease.js ***!\n  \\*********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n\n/**\n * @language=en\n * @class Ease class provides multiple easing functions for Tween.\n * @module hilo/tween/Ease\n * @static\n */\nvar Ease = function () {\n  function createEase(obj, easeInFn, easeOutFn, easeInOutFn, easeNoneFn) {\n    obj = obj || {};\n    easeInFn && (obj.EaseIn = easeInFn);\n    easeOutFn && (obj.EaseOut = easeOutFn);\n    easeInOutFn && (obj.EaseInOut = easeInOutFn);\n    easeNoneFn && (obj.EaseNone = easeNoneFn);\n    return obj;\n  }\n  /**\n   * @language=en\n   * Linear easing function.Include EaseNone.\n   */\n\n\n  var Linear = createEase(null, null, null, null, function (k) {\n    return k;\n  });\n  /**\n   * @language=en\n   * Quad easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Quad = createEase(null, function (k) {\n    return k * k;\n  }, function (k) {\n    return -k * (k - 2);\n  }, function (k) {\n    return (k *= 2) < 1 ? 0.5 * k * k : -0.5 * (--k * (k - 2) - 1);\n  });\n  /**\n   * @language=en\n   * Cubic easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Cubic = createEase(null, function (k) {\n    return k * k * k;\n  }, function (k) {\n    return --k * k * k + 1;\n  }, function (k) {\n    return (k *= 2) < 1 ? 0.5 * k * k * k : 0.5 * ((k -= 2) * k * k + 2);\n  });\n  /**\n   * @language=en\n   * Quart easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Quart = createEase(null, function (k) {\n    return k * k * k * k;\n  }, function (k) {\n    return -(--k * k * k * k - 1);\n  }, function (k) {\n    return (k *= 2) < 1 ? 0.5 * k * k * k * k : -0.5 * ((k -= 2) * k * k * k - 2);\n  });\n  /**\n   * @language=en\n   * Quint easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Quint = createEase(null, function (k) {\n    return k * k * k * k * k;\n  }, function (k) {\n    return (k = k - 1) * k * k * k * k + 1;\n  }, function (k) {\n    return (k *= 2) < 1 ? 0.5 * k * k * k * k * k : 0.5 * ((k -= 2) * k * k * k * k + 2);\n  });\n  var math = Math,\n      PI = math.PI,\n      HALF_PI = PI * 0.5,\n      sin = math.sin,\n      cos = math.cos,\n      pow = math.pow,\n      sqrt = math.sqrt;\n  /**\n   * @language=en\n   * Sine easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Sine = createEase(null, function (k) {\n    return -cos(k * HALF_PI) + 1;\n  }, function (k) {\n    return sin(k * HALF_PI);\n  }, function (k) {\n    return -0.5 * (cos(PI * k) - 1);\n  });\n  /**\n   * @language=en\n   * Expo easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Expo = createEase(null, function (k) {\n    return k == 0 ? 0 : pow(2, 10 * (k - 1));\n  }, function (k) {\n    return k == 1 ? 1 : -pow(2, -10 * k) + 1;\n  }, function (k) {\n    if (k == 0 || k == 1) return k;\n    if ((k *= 2) < 1) return 0.5 * pow(2, 10 * (k - 1));\n    return 0.5 * (-pow(2, -10 * (k - 1)) + 2);\n  });\n  /**\n   * @language=en\n   * Circ easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Circ = createEase(null, function (k) {\n    return -(sqrt(1 - k * k) - 1);\n  }, function (k) {\n    return sqrt(1 - --k * k);\n  }, function (k) {\n    if ((k /= 0.5) < 1) return -0.5 * (sqrt(1 - k * k) - 1);\n    return 0.5 * (sqrt(1 - (k -= 2) * k) + 1);\n  });\n  /**\n   * @language=en\n   * Elastic easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Elastic = createEase({\n    a: 1,\n    p: 0.4,\n    s: 0.1,\n    config: function config(amplitude, period) {\n      Elastic.a = amplitude;\n      Elastic.p = period;\n      Elastic.s = period / (2 * PI) * Math.asin(1 / amplitude) || 0;\n    }\n  }, function (k) {\n    return -(Elastic.a * pow(2, 10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p));\n  }, function (k) {\n    return Elastic.a * pow(2, -10 * k) * sin((k - Elastic.s) * (2 * PI) / Elastic.p) + 1;\n  }, function (k) {\n    return (k *= 2) < 1 ? -0.5 * (Elastic.a * pow(2, 10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p)) : Elastic.a * pow(2, -10 * (k -= 1)) * sin((k - Elastic.s) * (2 * PI) / Elastic.p) * 0.5 + 1;\n  });\n  /**\n   * @language=en\n   * Back easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Back = createEase({\n    o: 1.70158,\n    s: 2.59491,\n    config: function config(overshoot) {\n      Back.o = overshoot;\n      Back.s = overshoot * 1.525;\n    }\n  }, function (k) {\n    return k * k * ((Back.o + 1) * k - Back.o);\n  }, function (k) {\n    return (k = k - 1) * k * ((Back.o + 1) * k + Back.o) + 1;\n  }, function (k) {\n    return (k *= 2) < 1 ? 0.5 * (k * k * ((Back.s + 1) * k - Back.s)) : 0.5 * ((k -= 2) * k * ((Back.s + 1) * k + Back.s) + 2);\n  });\n  /**\n   * @language=en\n   * Bounce easing function.Include EaseIn, EaseOut, EaseInOut.\n   */\n\n  var Bounce = createEase(null, function (k) {\n    return 1 - Bounce.EaseOut(1 - k);\n  }, function (k) {\n    if ((k /= 1) < 0.36364) {\n      return 7.5625 * k * k;\n    } else if (k < 0.72727) {\n      return 7.5625 * (k -= 0.54545) * k + 0.75;\n    } else if (k < 0.90909) {\n      return 7.5625 * (k -= 0.81818) * k + 0.9375;\n    } else {\n      return 7.5625 * (k -= 0.95455) * k + 0.984375;\n    }\n  }, function (k) {\n    return k < 0.5 ? Bounce.EaseIn(k * 2) * 0.5 : Bounce.EaseOut(k * 2 - 1) * 0.5 + 0.5;\n  });\n  return {\n    Linear: Linear,\n    Quad: Quad,\n    Cubic: Cubic,\n    Quart: Quart,\n    Quint: Quint,\n    Sine: Sine,\n    Expo: Expo,\n    Circ: Circ,\n    Elastic: Elastic,\n    Back: Back,\n    Bounce: Bounce\n  };\n}();\n\nmodule.exports = Ease;\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/tween/Tween.js\":\n/*!**********************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/tween/Tween.js ***!\n  \\**********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\nvar Class = __webpack_require__(/*! ../core/Class */ \"./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\");\n/**\n * @language=en\n * <iframe src='../../../examples/Tween.html?noHeader' width = '550' height = '130' scrolling='no'></iframe>\n * <br/>\n * Demo:\n * <pre>\n * ticker.addTick(Hilo.Tween);//Tween works after being added to ticker\n *\n * var view = new View({x:5, y:10});\n * Hilo.Tween.to(view, {\n *     x:100,\n *     y:20,\n *     alpha:0\n * }, {\n *     duration:1000,\n *     delay:500,\n *     ease:Hilo.Ease.Quad.EaseIn,\n *     onComplete:function(){\n *         console.log('complete');\n *     }\n * });\n * </pre>\n * @class Tween class makes tweening (easing, slow motion).\n * @param {Object} target Tween target object.\n * @param {Object} fromProps Beginning properties of target tweening object.\n * @param {Object} toProps Ending properties of target tweening object.\n * @param {Object} params Tweening parameters, include all writable Tween class properties.\n * @module hilo/tween/Tween\n * @requires hilo/core/Class\n * @property {Object} target Tween target object, readonly!\n * @property {Int} duration Tweening duration, measure in ms.\n * @property {Int} delay Tweenning delay time, measure in ms.\n * @property {Boolean} paused Is tweening paused, default value is false.\n * @property {Boolean} loop Does tweening loop, default value is false.\n * @property {Boolean} reverse Does tweening reverse, default value is false.\n * @property {Int} repeat Repeat times of tweening, default value is 0.\n * @property {Int} repeatDelay Delay time of repeating tweening, measure in ms.\n * @property {Function} ease Tweening transform function, default value is null.\n * @property {Int} time Time that tweening taken, measure in ms, readonly!\n * @property {Function} onStart Function invoked on the beginning of tweening. Require 1 parameter: tween. default value is null.\n * @property {Function} onUpdate Function invoked on tweening update. Require 2 parameters: ratio, tween.  default value is null.\n * @property {Function} onComplete Function invoked on the end of tweening. Require 1 parameter: tween.  default value is null.\n */\n\n\nvar Tween = function () {\n  function now() {\n    return +new Date();\n  }\n\n  return Class.create(\n  /** @lends Tween.prototype */\n  {\n    constructor: function constructor(target, fromProps, toProps, params) {\n      var me = this;\n      me.target = target;\n      me._startTime = 0;\n      me._seekTime = 0;\n      me._pausedTime = 0;\n      me._pausedStartTime = 0;\n      me._reverseFlag = 1;\n      me._repeatCount = 0; //no fromProps if pass 3 arguments\n\n      if (arguments.length == 3) {\n        params = toProps;\n        toProps = fromProps;\n        fromProps = null;\n      }\n\n      for (var p in params) {\n        me[p] = params[p];\n      }\n\n      me._fromProps = fromProps;\n      me._toProps = toProps; //for old version compatiblity\n\n      if (!params.duration && params.time) {\n        me.duration = params.time || 0;\n        me.time = 0;\n      }\n    },\n    target: null,\n    duration: 1000,\n    delay: 0,\n    paused: false,\n    loop: false,\n    reverse: false,\n    repeat: 0,\n    repeatDelay: 0,\n    ease: null,\n    time: 0,\n    //ready only\n    isStart: false,\n    isComplete: false,\n    onStart: null,\n    onUpdate: null,\n    onComplete: null,\n\n    /**\n     * @language=en\n     * Set beginning properties and ending properties of tweening object.\n     * @param {Object} fromProps Beginning properties of target tweening object.\n     * @param {Object} toProps Ending properties of target tweening object.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    setProps: function setProps(fromProps, toProps) {\n      var me = this,\n          target = me.target,\n          propNames = fromProps || toProps,\n          from = me._fromProps = {},\n          to = me._toProps = {};\n      fromProps = fromProps || target;\n      toProps = toProps || target;\n\n      for (var p in propNames) {\n        to[p] = toProps[p] || 0;\n        target[p] = from[p] = fromProps[p] || 0;\n      }\n\n      return me;\n    },\n\n    /**\n     * @language=en\n     * Starting the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    start: function start() {\n      var me = this;\n      me._startTime = now() + me.delay;\n      me._seekTime = 0;\n      me._pausedTime = 0;\n      me._reverseFlag = 1;\n      me._repeatCount = 0;\n      me.paused = false;\n      me.isStart = false;\n      me.isComplete = false;\n      Tween.add(me);\n      return me;\n    },\n\n    /**\n     * @language=en\n     * Stop the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    stop: function stop() {\n      Tween.remove(this);\n      return this;\n    },\n\n    /**\n     * @language=en\n     * Pause the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    pause: function pause() {\n      var me = this;\n      me.paused = true;\n      me._pausedStartTime = now();\n      return me;\n    },\n\n    /**\n     * @language=en\n     * Continue to play the tweening.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    resume: function resume() {\n      var me = this;\n      me.paused = false;\n      if (me._pausedStartTime) me._pausedTime += now() - me._pausedStartTime;\n      me._pausedStartTime = 0;\n      return me;\n    },\n\n    /**\n     * @language=en\n     * Tween jumps to some point.\n     * @param {Number} time The time to jump to, range from 0 to duration.\n     * @param {Boolean} pause Is paused.\n     * @returns {Tween} Current Tween, for chain calls.\n     */\n    seek: function seek(time, pause) {\n      var me = this,\n          current = now();\n      me._startTime = current;\n      me._seekTime = time;\n      me._pausedTime = 0;\n      if (pause !== undefined) me.paused = pause;\n\n      me._update(current, true);\n\n      Tween.add(me);\n      return me;\n    },\n\n    /**\n     * @language=en\n     * Link next Tween. The beginning time of next Tween depends on the delay value. If delay is a string that begins with '+' or '-', next Tween will begin at (delay) ms after or before the current tween is ended. If delay is out of previous situation, next Tween will begin at (delay) ms after the beginning point of current Tween.\n     * @param {Tween} tween Tween to link.\n     * @returns {Tween} next Tween, for chain calls.\n     */\n    link: function link(tween) {\n      var me = this,\n          delay = tween.delay,\n          startTime = me._startTime;\n      var plus, minus;\n\n      if (typeof delay === 'string') {\n        plus = delay.indexOf('+') == 0;\n        minus = delay.indexOf('-') == 0;\n        delay = plus || minus ? Number(delay.substr(1)) * (plus ? 1 : -1) : Number(delay);\n      }\n\n      tween.delay = delay;\n      tween._startTime = plus || minus ? startTime + me.duration + delay : startTime + delay;\n      me._next = tween;\n      Tween.remove(tween);\n      return tween;\n    },\n\n    /**\n     * @language=en\n     * Private render method inside Tween class.\n     * @private\n     */\n    _render: function _render(ratio) {\n      var me = this,\n          target = me.target,\n          fromProps = me._fromProps,\n          p;\n\n      for (p in fromProps) {\n        target[p] = fromProps[p] + (me._toProps[p] - fromProps[p]) * ratio;\n      }\n    },\n\n    /**\n     * @language=en\n     * Private update method inside Tween class.\n     * @private\n     */\n    _update: function _update(time, forceUpdate) {\n      var me = this;\n      if (me.paused && !forceUpdate) return;\n      if (me.isComplete) return true; //elapsed time\n\n      var elapsed = time - me._startTime - me._pausedTime + me._seekTime;\n      if (elapsed < 0) return; //elapsed ratio\n\n      var ratio = elapsed / me.duration,\n          callback;\n      ratio = ratio <= 0 ? 0 : ratio >= 1 ? 1 : ratio;\n      var easeRatio = me.ease ? me.ease(ratio) : ratio;\n\n      if (me.reverse && me.isStart) {\n        //backward\n        if (me._reverseFlag < 0) {\n          ratio = 1 - ratio;\n          easeRatio = 1 - easeRatio;\n        } //forward\n\n\n        if (ratio < 1e-7) {\n          //repeat complete or not loop\n          if (me.repeat > 0 && me._repeatCount++ >= me.repeat || me.repeat == 0 && !me.loop) {\n            me.isComplete = true;\n          } else {\n            me._startTime = now();\n            me._pausedTime = 0;\n            me._reverseFlag *= -1;\n          }\n        }\n      } //start callback\n\n\n      if (!me.isStart) {\n        me.setProps(me._fromProps, me._toProps);\n        me.isStart = true;\n\n        if (me.onStart) {\n          me.onStart.call(me, me);\n        }\n      }\n\n      me.time = elapsed; //render & update callback\n\n      me._render(easeRatio);\n\n      (callback = me.onUpdate) && callback.call(me, easeRatio, me); //check if complete\n\n      if (ratio >= 1) {\n        if (me.reverse) {\n          me._startTime = now();\n          me._pausedTime = 0;\n          me._reverseFlag *= -1;\n        } else if (me.loop || me.repeat > 0 && me._repeatCount++ < me.repeat) {\n          me._startTime = now() + me.repeatDelay;\n          me._pausedTime = 0;\n        } else {\n          me.isComplete = true;\n        }\n      } //next tween\n\n\n      var next = me._next;\n\n      if (next && next.time <= 0) {\n        var nextStartTime = next._startTime;\n\n        if (nextStartTime > 0 && nextStartTime <= time) {\n          //parallel tween\n          next._render(ratio);\n\n          next.time = elapsed;\n          Tween.add(next);\n        } else if (me.isComplete && (nextStartTime < 0 || nextStartTime > time)) {\n          //next tween\n          next.start();\n        }\n      } //complete\n\n\n      if (me.isComplete) {\n        (callback = me.onComplete) && callback.call(me, me);\n        return true;\n      }\n    },\n    Statics:\n    /** @lends Tween */\n    {\n      /**\n       * @language=en\n       * @private\n       */\n      _tweens: [],\n\n      /**\n       * @language=en\n       * Update all Tween instances.\n       * @returns {Object} Tween。\n       */\n      tick: function tick() {\n        var tweens = Tween._tweens,\n            tween,\n            i,\n            len = tweens.length;\n\n        for (i = 0; i < len; i++) {\n          tween = tweens[i];\n\n          if (tween && tween._update(now())) {\n            tweens.splice(i, 1);\n            i--;\n          }\n        }\n\n        return Tween;\n      },\n\n      /**\n       * @language=en\n       * Add a Tween instance.\n       * @param {Tween} tween Tween object to add.\n       * @returns {Object} Tween。\n       */\n      add: function add(tween) {\n        var tweens = Tween._tweens;\n        if (tweens.indexOf(tween) == -1) tweens.push(tween);\n        return Tween;\n      },\n\n      /**\n       * @language=en\n       * Remove one Tween target.\n       * @param {Tween|Object|Array} tweenOrTarget Tween object, target object or an array of object to remove\n       * @returns {Object} Tween。\n       */\n      remove: function remove(tweenOrTarget) {\n        var i, l;\n\n        if (tweenOrTarget instanceof Array) {\n          for (i = 0, l = tweenOrTarget.length; i < l; i++) {\n            Tween.remove(tweenOrTarget[i]);\n          }\n\n          return Tween;\n        }\n\n        var tweens = Tween._tweens;\n\n        if (tweenOrTarget instanceof Tween) {\n          i = tweens.indexOf(tweenOrTarget);\n          if (i > -1) tweens.splice(i, 1);\n        } else {\n          for (i = 0; i < tweens.length; i++) {\n            if (tweens[i].target === tweenOrTarget) {\n              tweens.splice(i, 1);\n              i--;\n            }\n          }\n        }\n\n        return Tween;\n      },\n\n      /**\n       * @language=en\n       * Remove all Tween instances.\n       * @returns {Object} Tween。\n       */\n      removeAll: function removeAll() {\n        Tween._tweens.length = 0;\n        return Tween;\n      },\n\n      /**\n       * @language=en\n       * Create a tween, make target object easing from beginning properties to ending properties.\n       * @param {Object|Array} target Tweening target or tweening target array.\n       * @param fromProps Beginning properties of target tweening object.\n       * @param toProps Ending properties of target tweening object.\n       * @param params Tweening parameters.\n       * @returns {Tween|Array} An tween instance or an array of tween instance.\n       */\n      fromTo: function fromTo(target, fromProps, toProps, params) {\n        params = params || {};\n        var isArray = target instanceof Array;\n        target = isArray ? target : [target];\n        var tween,\n            i,\n            stagger = params.stagger,\n            tweens = [];\n\n        for (i = 0; i < target.length; i++) {\n          tween = new Tween(target[i], fromProps, toProps, params);\n          if (stagger) tween.delay = (params.delay || 0) + (i * stagger || 0);\n          tween.start();\n          tweens.push(tween);\n        }\n\n        return isArray ? tweens : tween;\n      },\n\n      /**\n       * @language=en\n       * Create a tween, make target object easing from current properties to ending properties.\n       * @param {Object|Array} target Tweening target or tweening target array.\n       * @param toProps Ending properties of target tweening object.\n       * @param params Tweening parameters.\n       * @returns {Tween|Array} An tween instance or an array of tween instance.\n       */\n      to: function to(target, toProps, params) {\n        return Tween.fromTo(target, null, toProps, params);\n      },\n\n      /**\n       * @language=en\n       * Create a tween, make target object easing from beginning properties to current properties.\n       * @param {Object|Array} target Tweening target or tweening target array.\n       * @param fromProps Beginning properties of target tweening object.\n       * @param params Tweening parameters.\n       * @returns {Tween|Array} An tween instance or an array of tween instance.\n       */\n      from: function from(target, fromProps, params) {\n        return Tween.fromTo(target, fromProps, null, params);\n      }\n    }\n  });\n}();\n\nmodule.exports = Tween;\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/util/Ticker.js\":\n/*!**********************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/util/Ticker.js ***!\n  \\**********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\nvar Class = __webpack_require__(/*! ../core/Class */ \"./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\");\n\nvar browser = __webpack_require__(/*! ./browser */ \"./node_modules/_hilojs@2.0.2@hilojs/util/browser.js\");\n/**\n * @language=en\n * @class Ticker is a Timer. It can run the code at specified framerate.\n * @param {Number} fps The fps of ticker.Default is 60.\n * @module hilo/util/Ticker\n * @requires hilo/core/Class\n * @requires hilo/util/browser\n */\n\n\nvar Ticker = Class.create(\n/** @lends Ticker.prototype */\n{\n  constructor: function constructor(fps) {\n    this._targetFPS = fps || 60;\n    this._interval = 1000 / this._targetFPS;\n    this._tickers = [];\n  },\n  _paused: false,\n  _targetFPS: 0,\n  _interval: 0,\n  _intervalId: null,\n  _tickers: null,\n  _lastTime: 0,\n  _tickCount: 0,\n  _tickTime: 0,\n  _measuredFPS: 0,\n\n  /**\n   * @language=en\n   * Start the ticker.\n   * @param {Boolean} userRAF Whether or not use requestAnimationFrame, default is true.\n   */\n  start: function start(useRAF) {\n    if (useRAF === undefined) {\n      useRAF = true;\n    }\n\n    if (this._intervalId) return;\n    this._lastTime = +new Date();\n    var self = this,\n        interval = this._interval,\n        raf = window.requestAnimationFrame || window[browser.jsVendor + 'RequestAnimationFrame'];\n\n    var _runLoop2;\n\n    if (useRAF && raf && interval < 17) {\n      this._useRAF = true;\n\n      _runLoop2 = function runLoop() {\n        self._intervalId = raf(_runLoop2);\n\n        self._tick();\n      };\n    } else {\n      _runLoop2 = function _runLoop() {\n        self._intervalId = setTimeout(_runLoop2, interval);\n\n        self._tick();\n      };\n    }\n\n    this._paused = false;\n\n    _runLoop2();\n  },\n\n  /**\n   * @language=en\n   * Stop the ticker.\n   */\n  stop: function stop() {\n    if (this._useRAF) {\n      var cancelRAF = window.cancelAnimationFrame || window[browser.jsVendor + 'CancelAnimationFrame'];\n      cancelRAF(this._intervalId);\n    } else {\n      clearTimeout(this._intervalId);\n    }\n\n    this._intervalId = null;\n    this._lastTime = 0;\n    this._paused = true;\n  },\n\n  /**\n   * @language=en\n   * Pause the ticker.\n   */\n  pause: function pause() {\n    this._paused = true;\n  },\n\n  /**\n   * @language=en\n   * Resume the ticker.\n   */\n  resume: function resume() {\n    this._paused = false;\n  },\n\n  /**\n   * @private\n   */\n  _tick: function _tick() {\n    if (this._paused) return;\n    var startTime = +new Date(),\n        deltaTime = startTime - this._lastTime,\n        tickers = this._tickers; //calculates the real fps\n\n    if (++this._tickCount >= this._targetFPS) {\n      this._measuredFPS = 1000 / (this._tickTime / this._tickCount) + 0.5 >> 0;\n      this._tickCount = 0;\n      this._tickTime = 0;\n    } else {\n      this._tickTime += startTime - this._lastTime;\n    }\n\n    this._lastTime = startTime;\n    var tickersCopy = tickers.slice(0);\n\n    for (var i = 0, len = tickersCopy.length; i < len; i++) {\n      tickersCopy[i].tick(deltaTime);\n    }\n  },\n\n  /**\n   * @language=en\n   * Get the fps.\n   */\n  getMeasuredFPS: function getMeasuredFPS() {\n    return Math.min(this._measuredFPS, this._targetFPS);\n  },\n\n  /**\n   * @language=en\n   * Add tickObject. The tickObject must implement the tick method.\n   * @param {Object} tickObject The tickObject to add.It must implement the tick method.\n   */\n  addTick: function addTick(tickObject) {\n    if (!tickObject || typeof tickObject.tick != 'function') {\n      throw new Error('Ticker: The tick object must implement the tick method.');\n    }\n\n    this._tickers.push(tickObject);\n  },\n\n  /**\n   * @language=en\n   * Remove the tickObject\n   * @param {Object} tickObject The tickObject to remove.\n   */\n  removeTick: function removeTick(tickObject) {\n    var tickers = this._tickers,\n        index = tickers.indexOf(tickObject);\n\n    if (index >= 0) {\n      tickers.splice(index, 1);\n    }\n  },\n\n  /**\n   * 下次tick时回调\n   * @param  {Function} callback\n   * @return {tickObj}\n   */\n  nextTick: function nextTick(callback) {\n    var that = this;\n    var tickObj = {\n      tick: function tick(dt) {\n        that.removeTick(tickObj);\n        callback();\n      }\n    };\n    that.addTick(tickObj);\n    return tickObj;\n  },\n\n  /**\n   * 延迟指定的时间后调用回调, 类似setTimeout\n   * @param  {Function} callback\n   * @param  {Number}   duration 延迟的毫秒数\n   * @return {tickObj}\n   */\n  timeout: function timeout(callback, duration) {\n    var that = this;\n    var targetTime = new Date().getTime() + duration;\n    var tickObj = {\n      tick: function tick() {\n        var nowTime = new Date().getTime();\n        var dt = nowTime - targetTime;\n\n        if (dt >= 0) {\n          that.removeTick(tickObj);\n          callback();\n        }\n      }\n    };\n    that.addTick(tickObj);\n    return tickObj;\n  },\n\n  /**\n   * 指定的时间周期来调用函数, 类似setInterval\n   * @param  {Function} callback\n   * @param  {Number}   duration 时间周期，单位毫秒\n   * @return {tickObj}\n   */\n  interval: function interval(callback, duration) {\n    var that = this;\n    var targetTime = new Date().getTime() + duration;\n    var tickObj = {\n      tick: function tick() {\n        var nowTime = new Date().getTime();\n        var dt = nowTime - targetTime;\n\n        if (dt >= 0) {\n          if (dt < duration) {\n            nowTime -= dt;\n          }\n\n          targetTime = nowTime + duration;\n          callback();\n        }\n      }\n    };\n    that.addTick(tickObj);\n    return tickObj;\n  }\n});\nmodule.exports = Ticker;\n\n/***/ }),\n\n/***/ \"./node_modules/_hilojs@2.0.2@hilojs/util/browser.js\":\n/*!***********************************************************!*\\\n  !*** ./node_modules/_hilojs@2.0.2@hilojs/util/browser.js ***!\n  \\***********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\n/**\n * hilojs 2.0.2 for commonjs\n * Copyright 2016 alibaba.com\n * Licensed under the MIT License\n */\n\n/**\n * @language=en\n * @class Browser feature set\n * @static\n * @module hilo/util/browser\n */\nvar browser = function () {\n  var ua = navigator.userAgent;\n  var doc = document;\n  var win = window;\n  var docElem = doc.documentElement;\n  var data =\n  /** @lends browser */\n  {\n    /**\n     * 是否是iphone\n     * @type {Boolean}\n     */\n    iphone: /iphone/i.test(ua),\n\n    /**\n     * 是否是ipad\n     * @type {Boolean}\n     */\n    ipad: /ipad/i.test(ua),\n\n    /**\n     * 是否是ipod\n     * @type {Boolean}\n     */\n    ipod: /ipod/i.test(ua),\n\n    /**\n     * 是否是ios\n     * @type {Boolean}\n     */\n    ios: /iphone|ipad|ipod/i.test(ua),\n\n    /**\n     * 是否是android\n     * @type {Boolean}\n     */\n    android: /android/i.test(ua),\n\n    /**\n     * 是否是webkit\n     * @type {Boolean}\n     */\n    webkit: /webkit/i.test(ua),\n\n    /**\n     * 是否是chrome\n     * @type {Boolean}\n     */\n    chrome: /chrome/i.test(ua),\n\n    /**\n     * 是否是safari\n     * @type {Boolean}\n     */\n    safari: /safari/i.test(ua),\n\n    /**\n     * 是否是firefox\n     * @type {Boolean}\n     */\n    firefox: /firefox/i.test(ua),\n\n    /**\n     * 是否是ie\n     * @type {Boolean}\n     */\n    ie: /msie/i.test(ua),\n\n    /**\n     * 是否是opera\n     * @type {Boolean}\n     */\n    opera: /opera/i.test(ua),\n\n    /**\n     * 是否支持触碰事件。\n     * @type {String}\n     */\n    supportTouch: 'ontouchstart' in win,\n\n    /**\n     * 是否支持canvas元素。\n     * @type {Boolean}\n     */\n    supportCanvas: doc.createElement('canvas').getContext != null,\n\n    /**\n     * 是否支持本地存储localStorage。\n     * @type {Boolean}\n     */\n    supportStorage: false,\n\n    /**\n     * 是否支持检测设备方向orientation。\n     * @type {Boolean}\n     */\n    supportOrientation: 'orientation' in win || 'orientation' in win.screen,\n\n    /**\n     * 是否支持检测加速度devicemotion。\n     * @type {Boolean}\n     */\n    supportDeviceMotion: 'ondevicemotion' in win\n  }; //`localStorage` is null or `localStorage.setItem` throws error in some cases (e.g. localStorage is disabled)\n\n  try {\n    var value = 'hilo';\n    localStorage.setItem(value, value);\n    localStorage.removeItem(value);\n    data.supportStorage = true;\n  } catch (e) {}\n  /**\n   * 浏览器厂商CSS前缀的js值。比如：webkit。\n   * @type {String}\n   */\n\n\n  var jsVendor = data.jsVendor = data.webkit ? 'webkit' : data.firefox ? 'webkit' : data.opera ? 'o' : data.ie ? 'ms' : '';\n  /**\n   * 浏览器厂商CSS前缀的css值。比如：-webkit-。\n   * @type {String}\n   */\n\n  var cssVendor = data.cssVendor = '-' + jsVendor + '-'; //css transform/3d feature dectection\n\n  var testElem = doc.createElement('div'),\n      style = testElem.style;\n  /**\n   * 是否支持CSS Transform变换。\n   * @type {Boolean}\n   */\n\n  var supportTransform = style[jsVendor + 'Transform'] != undefined;\n  /**\n   * 是否支持CSS Transform 3D变换。\n   * @type {Boolean}\n   */\n\n  var supportTransform3D = style[jsVendor + 'Perspective'] != undefined;\n\n  if (supportTransform3D) {\n    testElem.id = 'test3d';\n    style = doc.createElement('style');\n    style.textContent = '@media (' + cssVendor + 'transform-3d){#test3d{height:3px}}';\n    doc.head.appendChild(style);\n    docElem.appendChild(testElem);\n    supportTransform3D = testElem.offsetHeight == 3;\n    doc.head.removeChild(style);\n    docElem.removeChild(testElem);\n  }\n\n  data.supportTransform = supportTransform;\n  data.supportTransform3D = supportTransform3D;\n  var supportTouch = data.supportTouch;\n  /**\n   * 鼠标或触碰开始事件。对应touchstart或mousedown。\n   * @type {String}\n   */\n\n  var POINTER_START = supportTouch ? 'touchstart' : 'mousedown';\n  /**\n   * 鼠标或触碰移动事件。对应touchmove或mousemove。\n   * @type {String}\n   */\n\n  var POINTER_MOVE = supportTouch ? 'touchmove' : 'mousemove';\n  /**\n   * 鼠标或触碰结束事件。对应touchend或mouseup。\n   * @type {String}\n   */\n\n  var POINTER_END = supportTouch ? 'touchend' : 'mouseup';\n  data.POINTER_START = POINTER_START;\n  data.POINTER_MOVE = POINTER_MOVE;\n  data.POINTER_END = POINTER_END;\n  return data;\n}();\n\nmodule.exports = browser;\n\n/***/ }),\n\n/***/ \"./node_modules/_object-assign@4.1.1@object-assign/index.js\":\n/*!******************************************************************!*\\\n  !*** ./node_modules/_object-assign@4.1.1@object-assign/index.js ***!\n  \\******************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n/*\nobject-assign\n(c) Sindre Sorhus\n@license MIT\n*/\n\n/* eslint-disable no-unused-vars */\n\nvar getOwnPropertySymbols = Object.getOwnPropertySymbols;\nvar hasOwnProperty = Object.prototype.hasOwnProperty;\nvar propIsEnumerable = Object.prototype.propertyIsEnumerable;\n\nfunction toObject(val) {\n  if (val === null || val === undefined) {\n    throw new TypeError('Object.assign cannot be called with null or undefined');\n  }\n\n  return Object(val);\n}\n\nfunction shouldUseNative() {\n  try {\n    if (!Object.assign) {\n      return false;\n    } // Detect buggy property enumeration order in older V8 versions.\n    // https://bugs.chromium.org/p/v8/issues/detail?id=4118\n\n\n    var test1 = new String('abc'); // eslint-disable-line no-new-wrappers\n\n    test1[5] = 'de';\n\n    if (Object.getOwnPropertyNames(test1)[0] === '5') {\n      return false;\n    } // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\n\n    var test2 = {};\n\n    for (var i = 0; i < 10; i++) {\n      test2['_' + String.fromCharCode(i)] = i;\n    }\n\n    var order2 = Object.getOwnPropertyNames(test2).map(function (n) {\n      return test2[n];\n    });\n\n    if (order2.join('') !== '0123456789') {\n      return false;\n    } // https://bugs.chromium.org/p/v8/issues/detail?id=3056\n\n\n    var test3 = {};\n    'abcdefghijklmnopqrst'.split('').forEach(function (letter) {\n      test3[letter] = letter;\n    });\n\n    if (Object.keys(Object.assign({}, test3)).join('') !== 'abcdefghijklmnopqrst') {\n      return false;\n    }\n\n    return true;\n  } catch (err) {\n    // We don't expect any of the above to throw, but better to be safe.\n    return false;\n  }\n}\n\nmodule.exports = shouldUseNative() ? Object.assign : function (target, source) {\n  var from;\n  var to = toObject(target);\n  var symbols;\n\n  for (var s = 1; s < arguments.length; s++) {\n    from = Object(arguments[s]);\n\n    for (var key in from) {\n      if (hasOwnProperty.call(from, key)) {\n        to[key] = from[key];\n      }\n    }\n\n    if (getOwnPropertySymbols) {\n      symbols = getOwnPropertySymbols(from);\n\n      for (var i = 0; i < symbols.length; i++) {\n        if (propIsEnumerable.call(from, symbols[i])) {\n          to[symbols[i]] = from[symbols[i]];\n        }\n      }\n    }\n  }\n\n  return to;\n};\n\n/***/ }),\n\n/***/ \"./node_modules/_object-values@2.0.0@object-values/index.js\":\n/*!******************************************************************!*\\\n  !*** ./node_modules/_object-values@2.0.0@object-values/index.js ***!\n  \\******************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nmodule.exports = function (object) {\n  return Object.keys(object).map(function (i) {\n    return object[i];\n  });\n};\n\n/***/ }),\n\n/***/ \"./node_modules/_object.keys@0.1.0@object.keys/index.js\":\n/*!**************************************************************!*\\\n  !*** ./node_modules/_object.keys@0.1.0@object.keys/index.js ***!\n  \\**************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n/**\n * Object.keys() - Polyfill\n *\n * @ref https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Object/keys\n */\n\n\n(function () {\n  if (!Object.keys) {\n    Object.keys = function () {\n\n      var hasOwnProperty = Object.prototype.hasOwnProperty,\n          hasDontEnumBug = !{\n        toString: null\n      }.propertyIsEnumerable('toString'),\n          dontEnums = ['toString', 'toLocaleString', 'valueOf', 'hasOwnProperty', 'isPrototypeOf', 'propertyIsEnumerable', 'constructor'],\n          dontEnumsLength = dontEnums.length;\n      return function (obj) {\n        if (typeof obj !== 'object' && (typeof obj !== 'function' || obj === null)) {\n          throw new TypeError('Object.keys called on non-object');\n        }\n\n        var result = [],\n            prop,\n            i;\n\n        for (prop in obj) {\n          if (hasOwnProperty.call(obj, prop)) {\n            result.push(prop);\n          }\n        }\n\n        if (hasDontEnumBug) {\n          for (i = 0; i < dontEnumsLength; i++) {\n            if (hasOwnProperty.call(obj, dontEnums[i])) {\n              result.push(dontEnums[i]);\n            }\n          }\n        }\n\n        return result;\n      };\n    }();\n  }\n})();\n\n/***/ }),\n\n/***/ \"./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js\":\n/*!**********************************************************!*\\\n  !*** ./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js ***!\n  \\**********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\n//Code ported by Marcin Ignac (2014)\n//Based on Java implementation from\n//https://code.google.com/r/cys12345-research/source/browse/hdr/image_processor/RGBE.java?r=7d84e9fd866b24079dbe61fa0a966ce8365f5726\nvar radiancePattern = \"#\\\\?RADIANCE\";\nvar commentPattern = \"#.*\";\nvar exposurePattern = \"EXPOSURE=\\\\s*([0-9]*[.][0-9]*)\";\nvar formatPattern = \"FORMAT=32-bit_rle_rgbe\";\nvar widthHeightPattern = \"-Y ([0-9]+) \\\\+X ([0-9]+)\"; //http://croquetweak.blogspot.co.uk/2014/08/deconstructing-floats-frexp-and-ldexp.html\n\nfunction readPixelsRawRLE(buffer, data, offset, fileOffset, scanline_width, num_scanlines) {\n  var rgbe = new Array(4);\n  var scanline_buffer = null;\n  var ptr;\n  var ptr_end;\n  var count;\n  var buf = new Array(2);\n  var bufferLength = buffer.length;\n\n  function readBuf(buf) {\n    var bytesRead = 0;\n\n    do {\n      buf[bytesRead++] = buffer[fileOffset];\n    } while (++fileOffset < bufferLength && bytesRead < buf.length);\n\n    return bytesRead;\n  }\n\n  function readBufOffset(buf, offset, length) {\n    var bytesRead = 0;\n\n    do {\n      buf[offset + bytesRead++] = buffer[fileOffset];\n    } while (++fileOffset < bufferLength && bytesRead < length);\n\n    return bytesRead;\n  }\n\n  function readPixelsRaw(buffer, data, offset, numpixels) {\n    var numExpected = 4 * numpixels;\n    var numRead = readBufOffset(data, offset, numExpected);\n\n    if (numRead < numExpected) {\n      throw new Error('Error reading raw pixels: got ' + numRead + ' bytes, expected ' + numExpected);\n    }\n  }\n\n  while (num_scanlines > 0) {\n    if (readBuf(rgbe) < rgbe.length) {\n      throw new Error(\"Error reading bytes: expected \" + rgbe.length);\n    }\n\n    if (rgbe[0] != 2 || rgbe[1] != 2 || (rgbe[2] & 0x80) != 0) {\n      //this file is not run length encoded\n      data[offset++] = rgbe[0];\n      data[offset++] = rgbe[1];\n      data[offset++] = rgbe[2];\n      data[offset++] = rgbe[3];\n      readPixelsRaw(buffer, data, offset, scanline_width * num_scanlines - 1);\n      return;\n    }\n\n    if (((rgbe[2] & 0xFF) << 8 | rgbe[3] & 0xFF) != scanline_width) {\n      throw new Error(\"Wrong scanline width \" + ((rgbe[2] & 0xFF) << 8 | rgbe[3] & 0xFF) + \", expected \" + scanline_width);\n    }\n\n    if (scanline_buffer == null) {\n      scanline_buffer = new Array(4 * scanline_width);\n    }\n\n    ptr = 0;\n    /* read each of the four channels for the scanline into the buffer */\n\n    for (var i = 0; i < 4; i++) {\n      ptr_end = (i + 1) * scanline_width;\n\n      while (ptr < ptr_end) {\n        if (readBuf(buf) < buf.length) {\n          throw new Error(\"Error reading 2-byte buffer\");\n        }\n\n        if ((buf[0] & 0xFF) > 128) {\n          /* a run of the same value */\n          count = (buf[0] & 0xFF) - 128;\n\n          if (count == 0 || count > ptr_end - ptr) {\n            throw new Error(\"Bad scanline data\");\n          }\n\n          while (count-- > 0) {\n            scanline_buffer[ptr++] = buf[1];\n          }\n        } else {\n          /* a non-run */\n          count = buf[0] & 0xFF;\n\n          if (count == 0 || count > ptr_end - ptr) {\n            throw new Error(\"Bad scanline data\");\n          }\n\n          scanline_buffer[ptr++] = buf[1];\n\n          if (--count > 0) {\n            if (readBufOffset(scanline_buffer, ptr, count) < count) {\n              throw new Error(\"Error reading non-run data\");\n            }\n\n            ptr += count;\n          }\n        }\n      }\n    }\n    /* copy byte data to output */\n\n\n    for (var i = 0; i < scanline_width; i++) {\n      data[offset + 0] = scanline_buffer[i];\n      data[offset + 1] = scanline_buffer[i + scanline_width];\n      data[offset + 2] = scanline_buffer[i + 2 * scanline_width];\n      data[offset + 3] = scanline_buffer[i + 3 * scanline_width];\n      offset += 4;\n    }\n\n    num_scanlines--;\n  }\n} //Returns data as floats and flipped along Y by default\n\n\nfunction parseHdr(buffer) {\n  if (buffer instanceof ArrayBuffer) {\n    buffer = new Uint8Array(buffer);\n  }\n\n  var fileOffset = 0;\n  var bufferLength = buffer.length;\n  var NEW_LINE = 10;\n\n  function readLine() {\n    var buf = \"\";\n\n    do {\n      var b = buffer[fileOffset];\n\n      if (b == NEW_LINE) {\n        ++fileOffset;\n        break;\n      }\n\n      buf += String.fromCharCode(b);\n    } while (++fileOffset < bufferLength);\n\n    return buf;\n  }\n\n  var width = 0;\n  var height = 0;\n  var exposure = 1;\n  var gamma = 1;\n  var rle = false;\n\n  for (var i = 0; i < 20; i++) {\n    var line = readLine();\n    var match;\n\n    if (match = line.match(radiancePattern)) ; else if (match = line.match(formatPattern)) {\n      rle = true;\n    } else if (match = line.match(exposurePattern)) {\n      exposure = Number(match[1]);\n    } else if (match = line.match(commentPattern)) ; else if (match = line.match(widthHeightPattern)) {\n      height = Number(match[1]);\n      width = Number(match[2]);\n      break;\n    }\n  }\n\n  if (!rle) {\n    throw new Error(\"File is not run length encoded!\");\n  }\n\n  var data = new Uint8Array(width * height * 4);\n  var scanline_width = width;\n  var num_scanlines = height;\n  readPixelsRawRLE(buffer, data, 0, fileOffset, scanline_width, num_scanlines); //TODO: Should be Float16\n\n  var floatData = new Float32Array(width * height * 4);\n\n  for (var offset = 0; offset < data.length; offset += 4) {\n    var r = data[offset + 0] / 255;\n    var g = data[offset + 1] / 255;\n    var b = data[offset + 2] / 255;\n    var e = data[offset + 3];\n    var f = Math.pow(2.0, e - 128.0);\n    r *= f;\n    g *= f;\n    b *= f;\n    var floatOffset = offset;\n    floatData[floatOffset + 0] = r;\n    floatData[floatOffset + 1] = g;\n    floatData[floatOffset + 2] = b;\n    floatData[floatOffset + 3] = 1.0;\n  }\n\n  return {\n    shape: [width, height],\n    exposure: exposure,\n    gamma: gamma,\n    data: floatData\n  };\n}\n\nmodule.exports = parseHdr;\n\n/***/ }),\n\n/***/ \"./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js\":\n/*!********************************************************************!*\\\n  !*** ./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js ***!\n  \\********************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n\nmodule.exports = typeof Promise === 'function' ? Promise : __webpack_require__(/*! pinkie */ \"./node_modules/_pinkie@2.0.4@pinkie/index.js\");\n\n/***/ }),\n\n/***/ \"./node_modules/_pinkie@2.0.4@pinkie/index.js\":\n/*!****************************************************!*\\\n  !*** ./node_modules/_pinkie@2.0.4@pinkie/index.js ***!\n  \\****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n/* WEBPACK VAR INJECTION */(function(global, setImmediate) {\n\nvar PENDING = 'pending';\nvar SETTLED = 'settled';\nvar FULFILLED = 'fulfilled';\nvar REJECTED = 'rejected';\n\nvar NOOP = function NOOP() {};\n\nvar isNode = typeof global !== 'undefined' && typeof global.process !== 'undefined' && typeof global.process.emit === 'function';\nvar asyncSetTimer = typeof setImmediate === 'undefined' ? setTimeout : setImmediate;\nvar asyncQueue = [];\nvar asyncTimer;\n\nfunction asyncFlush() {\n  // run promise callbacks\n  for (var i = 0; i < asyncQueue.length; i++) {\n    asyncQueue[i][0](asyncQueue[i][1]);\n  } // reset async asyncQueue\n\n\n  asyncQueue = [];\n  asyncTimer = false;\n}\n\nfunction asyncCall(callback, arg) {\n  asyncQueue.push([callback, arg]);\n\n  if (!asyncTimer) {\n    asyncTimer = true;\n    asyncSetTimer(asyncFlush, 0);\n  }\n}\n\nfunction invokeResolver(resolver, promise) {\n  function resolvePromise(value) {\n    resolve(promise, value);\n  }\n\n  function rejectPromise(reason) {\n    reject(promise, reason);\n  }\n\n  try {\n    resolver(resolvePromise, rejectPromise);\n  } catch (e) {\n    rejectPromise(e);\n  }\n}\n\nfunction invokeCallback(subscriber) {\n  var owner = subscriber.owner;\n  var settled = owner._state;\n  var value = owner._data;\n  var callback = subscriber[settled];\n  var promise = subscriber.then;\n\n  if (typeof callback === 'function') {\n    settled = FULFILLED;\n\n    try {\n      value = callback(value);\n    } catch (e) {\n      reject(promise, e);\n    }\n  }\n\n  if (!handleThenable(promise, value)) {\n    if (settled === FULFILLED) {\n      resolve(promise, value);\n    }\n\n    if (settled === REJECTED) {\n      reject(promise, value);\n    }\n  }\n}\n\nfunction handleThenable(promise, value) {\n  var resolved;\n\n  try {\n    if (promise === value) {\n      throw new TypeError('A promises callback cannot return that same promise.');\n    }\n\n    if (value && (typeof value === 'function' || typeof value === 'object')) {\n      // then should be retrieved only once\n      var then = value.then;\n\n      if (typeof then === 'function') {\n        then.call(value, function (val) {\n          if (!resolved) {\n            resolved = true;\n\n            if (value === val) {\n              fulfill(promise, val);\n            } else {\n              resolve(promise, val);\n            }\n          }\n        }, function (reason) {\n          if (!resolved) {\n            resolved = true;\n            reject(promise, reason);\n          }\n        });\n        return true;\n      }\n    }\n  } catch (e) {\n    if (!resolved) {\n      reject(promise, e);\n    }\n\n    return true;\n  }\n\n  return false;\n}\n\nfunction resolve(promise, value) {\n  if (promise === value || !handleThenable(promise, value)) {\n    fulfill(promise, value);\n  }\n}\n\nfunction fulfill(promise, value) {\n  if (promise._state === PENDING) {\n    promise._state = SETTLED;\n    promise._data = value;\n    asyncCall(publishFulfillment, promise);\n  }\n}\n\nfunction reject(promise, reason) {\n  if (promise._state === PENDING) {\n    promise._state = SETTLED;\n    promise._data = reason;\n    asyncCall(publishRejection, promise);\n  }\n}\n\nfunction publish(promise) {\n  promise._then = promise._then.forEach(invokeCallback);\n}\n\nfunction publishFulfillment(promise) {\n  promise._state = FULFILLED;\n  publish(promise);\n}\n\nfunction publishRejection(promise) {\n  promise._state = REJECTED;\n  publish(promise);\n\n  if (!promise._handled && isNode) {\n    global.process.emit('unhandledRejection', promise._data, promise);\n  }\n}\n\nfunction notifyRejectionHandled(promise) {\n  global.process.emit('rejectionHandled', promise);\n}\n/**\n * @class\n */\n\n\nfunction Promise(resolver) {\n  if (typeof resolver !== 'function') {\n    throw new TypeError('Promise resolver ' + resolver + ' is not a function');\n  }\n\n  if (this instanceof Promise === false) {\n    throw new TypeError('Failed to construct \\'Promise\\': Please use the \\'new\\' operator, this object constructor cannot be called as a function.');\n  }\n\n  this._then = [];\n  invokeResolver(resolver, this);\n}\n\nPromise.prototype = {\n  constructor: Promise,\n  _state: PENDING,\n  _then: null,\n  _data: undefined,\n  _handled: false,\n  then: function then(onFulfillment, onRejection) {\n    var subscriber = {\n      owner: this,\n      then: new this.constructor(NOOP),\n      fulfilled: onFulfillment,\n      rejected: onRejection\n    };\n\n    if ((onRejection || onFulfillment) && !this._handled) {\n      this._handled = true;\n\n      if (this._state === REJECTED && isNode) {\n        asyncCall(notifyRejectionHandled, this);\n      }\n    }\n\n    if (this._state === FULFILLED || this._state === REJECTED) {\n      // already resolved, call callback async\n      asyncCall(invokeCallback, subscriber);\n    } else {\n      // subscribe\n      this._then.push(subscriber);\n    }\n\n    return subscriber.then;\n  },\n  \"catch\": function _catch(onRejection) {\n    return this.then(null, onRejection);\n  }\n};\n\nPromise.all = function (promises) {\n  if (!Array.isArray(promises)) {\n    throw new TypeError('You must pass an array to Promise.all().');\n  }\n\n  return new Promise(function (resolve, reject) {\n    var results = [];\n    var remaining = 0;\n\n    function resolver(index) {\n      remaining++;\n      return function (value) {\n        results[index] = value;\n\n        if (! --remaining) {\n          resolve(results);\n        }\n      };\n    }\n\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n\n      if (promise && typeof promise.then === 'function') {\n        promise.then(resolver(i), reject);\n      } else {\n        results[i] = promise;\n      }\n    }\n\n    if (!remaining) {\n      resolve(results);\n    }\n  });\n};\n\nPromise.race = function (promises) {\n  if (!Array.isArray(promises)) {\n    throw new TypeError('You must pass an array to Promise.race().');\n  }\n\n  return new Promise(function (resolve, reject) {\n    for (var i = 0, promise; i < promises.length; i++) {\n      promise = promises[i];\n\n      if (promise && typeof promise.then === 'function') {\n        promise.then(resolve, reject);\n      } else {\n        resolve(promise);\n      }\n    }\n  });\n};\n\nPromise.resolve = function (value) {\n  if (value && typeof value === 'object' && value.constructor === Promise) {\n    return value;\n  }\n\n  return new Promise(function (resolve) {\n    resolve(value);\n  });\n};\n\nPromise.reject = function (reason) {\n  return new Promise(function (resolve, reject) {\n    reject(reason);\n  });\n};\n\nmodule.exports = Promise;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../_webpack@4.44.2@webpack/buildin/global.js */ \"./node_modules/_webpack@4.44.2@webpack/buildin/global.js\"), __webpack_require__(/*! ./../_timers-browserify@2.0.12@timers-browserify/main.js */ \"./node_modules/_timers-browserify@2.0.12@timers-browserify/main.js\").setImmediate));\n\n/***/ }),\n\n/***/ \"./node_modules/_process@0.11.10@process/browser.js\":\n/*!**********************************************************!*\\\n  !*** ./node_modules/_process@0.11.10@process/browser.js ***!\n  \\**********************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\n// shim for using process in browser\nvar process = module.exports = {}; // cached from whatever global is present so that test runners that stub it\n// don't break things.  But we need to wrap it in a try catch in case it is\n// wrapped in strict mode code which doesn't define any globals.  It's inside a\n// function because try/catches deoptimize in certain engines.\n\nvar cachedSetTimeout;\nvar cachedClearTimeout;\n\nfunction defaultSetTimout() {\n  throw new Error('setTimeout has not been defined');\n}\n\nfunction defaultClearTimeout() {\n  throw new Error('clearTimeout has not been defined');\n}\n\n(function () {\n  try {\n    if (typeof setTimeout === 'function') {\n      cachedSetTimeout = setTimeout;\n    } else {\n      cachedSetTimeout = defaultSetTimout;\n    }\n  } catch (e) {\n    cachedSetTimeout = defaultSetTimout;\n  }\n\n  try {\n    if (typeof clearTimeout === 'function') {\n      cachedClearTimeout = clearTimeout;\n    } else {\n      cachedClearTimeout = defaultClearTimeout;\n    }\n  } catch (e) {\n    cachedClearTimeout = defaultClearTimeout;\n  }\n})();\n\nfunction runTimeout(fun) {\n  if (cachedSetTimeout === setTimeout) {\n    //normal enviroments in sane situations\n    return setTimeout(fun, 0);\n  } // if setTimeout wasn't available but was latter defined\n\n\n  if ((cachedSetTimeout === defaultSetTimout || !cachedSetTimeout) && setTimeout) {\n    cachedSetTimeout = setTimeout;\n    return setTimeout(fun, 0);\n  }\n\n  try {\n    // when when somebody has screwed with setTimeout but no I.E. maddness\n    return cachedSetTimeout(fun, 0);\n  } catch (e) {\n    try {\n      // When we are in I.E. but the script has been evaled so I.E. doesn't trust the global object when called normally\n      return cachedSetTimeout.call(null, fun, 0);\n    } catch (e) {\n      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error\n      return cachedSetTimeout.call(this, fun, 0);\n    }\n  }\n}\n\nfunction runClearTimeout(marker) {\n  if (cachedClearTimeout === clearTimeout) {\n    //normal enviroments in sane situations\n    return clearTimeout(marker);\n  } // if clearTimeout wasn't available but was latter defined\n\n\n  if ((cachedClearTimeout === defaultClearTimeout || !cachedClearTimeout) && clearTimeout) {\n    cachedClearTimeout = clearTimeout;\n    return clearTimeout(marker);\n  }\n\n  try {\n    // when when somebody has screwed with setTimeout but no I.E. maddness\n    return cachedClearTimeout(marker);\n  } catch (e) {\n    try {\n      // When we are in I.E. but the script has been evaled so I.E. doesn't  trust the global object when called normally\n      return cachedClearTimeout.call(null, marker);\n    } catch (e) {\n      // same as above but when it's a version of I.E. that must have the global object for 'this', hopfully our context correct otherwise it will throw a global error.\n      // Some versions of I.E. have different rules for clearTimeout vs setTimeout\n      return cachedClearTimeout.call(this, marker);\n    }\n  }\n}\n\nvar queue = [];\nvar draining = false;\nvar currentQueue;\nvar queueIndex = -1;\n\nfunction cleanUpNextTick() {\n  if (!draining || !currentQueue) {\n    return;\n  }\n\n  draining = false;\n\n  if (currentQueue.length) {\n    queue = currentQueue.concat(queue);\n  } else {\n    queueIndex = -1;\n  }\n\n  if (queue.length) {\n    drainQueue();\n  }\n}\n\nfunction drainQueue() {\n  if (draining) {\n    return;\n  }\n\n  var timeout = runTimeout(cleanUpNextTick);\n  draining = true;\n  var len = queue.length;\n\n  while (len) {\n    currentQueue = queue;\n    queue = [];\n\n    while (++queueIndex < len) {\n      if (currentQueue) {\n        currentQueue[queueIndex].run();\n      }\n    }\n\n    queueIndex = -1;\n    len = queue.length;\n  }\n\n  currentQueue = null;\n  draining = false;\n  runClearTimeout(timeout);\n}\n\nprocess.nextTick = function (fun) {\n  var args = new Array(arguments.length - 1);\n\n  if (arguments.length > 1) {\n    for (var i = 1; i < arguments.length; i++) {\n      args[i - 1] = arguments[i];\n    }\n  }\n\n  queue.push(new Item(fun, args));\n\n  if (queue.length === 1 && !draining) {\n    runTimeout(drainQueue);\n  }\n}; // v8 likes predictible objects\n\n\nfunction Item(fun, array) {\n  this.fun = fun;\n  this.array = array;\n}\n\nItem.prototype.run = function () {\n  this.fun.apply(null, this.array);\n};\n\nprocess.title = 'browser';\nprocess.browser = true;\nprocess.env = {};\nprocess.argv = [];\nprocess.version = ''; // empty string to avoid regexp issues\n\nprocess.versions = {};\n\nfunction noop() {}\n\nprocess.on = noop;\nprocess.addListener = noop;\nprocess.once = noop;\nprocess.off = noop;\nprocess.removeListener = noop;\nprocess.removeAllListeners = noop;\nprocess.emit = noop;\nprocess.prependListener = noop;\nprocess.prependOnceListener = noop;\n\nprocess.listeners = function (name) {\n  return [];\n};\n\nprocess.binding = function (name) {\n  throw new Error('process.binding is not supported');\n};\n\nprocess.cwd = function () {\n  return '/';\n};\n\nprocess.chdir = function (dir) {\n  throw new Error('process.chdir is not supported');\n};\n\nprocess.umask = function () {\n  return 0;\n};\n\n/***/ }),\n\n/***/ \"./node_modules/_ray-3d@1.1.1@ray-3d/index.js\":\n/*!****************************************************!*\\\n  !*** ./node_modules/_ray-3d@1.1.1@ray-3d/index.js ***!\n  \\****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar intersectRayTriangle = __webpack_require__(/*! ray-triangle-intersection */ \"./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js\");\n\nvar intersectRayPlane = __webpack_require__(/*! ray-plane-intersection */ \"./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js\");\n\nvar intersectRaySphere = __webpack_require__(/*! ray-sphere-intersection */ \"./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js\");\n\nvar intersectRayBox = __webpack_require__(/*! ray-aabb-intersection */ \"./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js\");\n\nvar copy3 = __webpack_require__(/*! gl-vec3/copy */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js\");\n\nvar tmpTriangle = [[0, 0, 0], [0, 0, 0], [0, 0, 0]];\nvar tmp3 = [0, 0, 0];\nmodule.exports = Ray;\n\nfunction Ray(origin, direction) {\n  this.origin = origin || [0, 0, 0];\n  this.direction = direction || [0, 0, -1];\n}\n\nRay.prototype.set = function (origin, direction) {\n  this.origin = origin;\n  this.direction = direction;\n};\n\nRay.prototype.copy = function (other) {\n  copy3(this.origin, other.origin);\n  copy3(this.direction, other.direction);\n};\n\nRay.prototype.clone = function () {\n  var other = new Ray();\n  other.copy(this);\n  return other;\n};\n\nRay.prototype.intersectsSphere = function (center, radius) {\n  return intersectRaySphere(tmp3, this.origin, this.direction, center, radius);\n};\n\nRay.prototype.intersectsPlane = function (normal, distance) {\n  return intersectRayPlane(tmp3, this.origin, this.direction, normal, distance);\n};\n\nRay.prototype.intersectsTriangle = function (triangle) {\n  return intersectRayTriangle(tmp3, this.origin, this.direction, triangle);\n};\n\nRay.prototype.intersectsBox = function (aabb) {\n  return intersectRayBox(tmp3, this.origin, this.direction, aabb);\n};\n\nRay.prototype.intersectsTriangleCell = function (cell, positions) {\n  var a = cell[0],\n      b = cell[1],\n      c = cell[2];\n  tmpTriangle[0] = positions[a];\n  tmpTriangle[1] = positions[b];\n  tmpTriangle[2] = positions[c];\n  return this.intersectsTriangle(tmpTriangle);\n};\n\n/***/ }),\n\n/***/ \"./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js\":\n/*!**********************************************************************************!*\\\n  !*** ./node_modules/_ray-aabb-intersection@1.0.1@ray-aabb-intersection/index.js ***!\n  \\**********************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = intersection;\nmodule.exports.distance = distance;\n\nfunction intersection(out, ro, rd, aabb) {\n  var d = distance(ro, rd, aabb);\n\n  if (d === Infinity) {\n    out = null;\n  } else {\n    out = out || [];\n\n    for (var i = 0; i < ro.length; i++) {\n      out[i] = ro[i] + rd[i] * d;\n    }\n  }\n\n  return out;\n}\n\nfunction distance(ro, rd, aabb) {\n  var dims = ro.length;\n  var lo = -Infinity;\n  var hi = +Infinity;\n\n  for (var i = 0; i < dims; i++) {\n    var dimLo = (aabb[0][i] - ro[i]) / rd[i];\n    var dimHi = (aabb[1][i] - ro[i]) / rd[i];\n\n    if (dimLo > dimHi) {\n      var tmp = dimLo;\n      dimLo = dimHi;\n      dimHi = tmp;\n    }\n\n    if (dimHi < lo || dimLo > hi) {\n      return Infinity;\n    }\n\n    if (dimLo > lo) lo = dimLo;\n    if (dimHi < hi) hi = dimHi;\n  }\n\n  return lo > hi ? Infinity : lo;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js\":\n/*!************************************************************************************!*\\\n  !*** ./node_modules/_ray-plane-intersection@1.0.0@ray-plane-intersection/index.js ***!\n  \\************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar dot = __webpack_require__(/*! gl-vec3/dot */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js\");\n\nvar add = __webpack_require__(/*! gl-vec3/add */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js\");\n\nvar scale = __webpack_require__(/*! gl-vec3/scale */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js\");\n\nvar copy = __webpack_require__(/*! gl-vec3/copy */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/copy.js\");\n\nmodule.exports = intersectRayPlane;\nvar v0 = [0, 0, 0];\n\nfunction intersectRayPlane(out, origin, direction, normal, dist) {\n  var denom = dot(direction, normal);\n\n  if (denom !== 0) {\n    var t = -(dot(origin, normal) + dist) / denom;\n\n    if (t < 0) {\n      return null;\n    }\n\n    scale(v0, direction, t);\n    return add(out, origin, v0);\n  } else if (dot(normal, origin) + dist === 0) {\n    return copy(out, origin);\n  } else {\n    return null;\n  }\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js\":\n/*!**************************************************************************************!*\\\n  !*** ./node_modules/_ray-sphere-intersection@1.0.0@ray-sphere-intersection/index.js ***!\n  \\**************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar squaredDist = __webpack_require__(/*! gl-vec3/squaredDistance */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/squaredDistance.js\");\n\nvar dot = __webpack_require__(/*! gl-vec3/dot */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js\");\n\nvar sub = __webpack_require__(/*! gl-vec3/subtract */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js\");\n\nvar scaleAndAdd = __webpack_require__(/*! gl-vec3/scaleAndAdd */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/scaleAndAdd.js\");\n\nvar scale = __webpack_require__(/*! gl-vec3/scale */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/scale.js\");\n\nvar add = __webpack_require__(/*! gl-vec3/add */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/add.js\");\n\nvar tmp = [0, 0, 0];\nmodule.exports = intersectRaySphere;\n\nfunction intersectRaySphere(out, origin, direction, center, radius) {\n  sub(tmp, center, origin);\n  var len = dot(direction, tmp);\n\n  if (len < 0) {\n    // sphere is behind ray\n    return null;\n  }\n\n  scaleAndAdd(tmp, origin, direction, len);\n  var dSq = squaredDist(center, tmp);\n  var rSq = radius * radius;\n\n  if (dSq > rSq) {\n    return null;\n  }\n\n  scale(out, direction, len - Math.sqrt(rSq - dSq));\n  return add(out, out, origin);\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js\":\n/*!******************************************************************************************!*\\\n  !*** ./node_modules/_ray-triangle-intersection@1.0.3@ray-triangle-intersection/index.js ***!\n  \\******************************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nvar cross = __webpack_require__(/*! gl-vec3/cross */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/cross.js\");\n\nvar dot = __webpack_require__(/*! gl-vec3/dot */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/dot.js\");\n\nvar sub = __webpack_require__(/*! gl-vec3/subtract */ \"./node_modules/_gl-vec3@1.1.3@gl-vec3/subtract.js\");\n\nvar EPSILON = 0.000001;\nvar edge1 = [0, 0, 0];\nvar edge2 = [0, 0, 0];\nvar tvec = [0, 0, 0];\nvar pvec = [0, 0, 0];\nvar qvec = [0, 0, 0];\nmodule.exports = intersectTriangle;\n\nfunction intersectTriangle(out, pt, dir, tri) {\n  sub(edge1, tri[1], tri[0]);\n  sub(edge2, tri[2], tri[0]);\n  cross(pvec, dir, edge2);\n  var det = dot(edge1, pvec);\n  if (det < EPSILON) return null;\n  sub(tvec, pt, tri[0]);\n  var u = dot(tvec, pvec);\n  if (u < 0 || u > det) return null;\n  cross(qvec, tvec, edge1);\n  var v = dot(dir, qvec);\n  if (v < 0 || u + v > det) return null;\n  var t = dot(edge2, qvec) / det;\n  out[0] = pt[0] + t * dir[0];\n  out[1] = pt[1] + t * dir[1];\n  out[2] = pt[2] + t * dir[2];\n  return out;\n}\n\n/***/ }),\n\n/***/ \"./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js\":\n/*!***********************************************************************!*\\\n  !*** ./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js ***!\n  \\***********************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global, process) {(function (global, undefined$1) {\n\n  if (global.setImmediate) {\n    return;\n  }\n\n  var nextHandle = 1; // Spec says greater than zero\n\n  var tasksByHandle = {};\n  var currentlyRunningATask = false;\n  var doc = global.document;\n  var registerImmediate;\n\n  function setImmediate(callback) {\n    // Callback can either be a function or a string\n    if (typeof callback !== \"function\") {\n      callback = new Function(\"\" + callback);\n    } // Copy function arguments\n\n\n    var args = new Array(arguments.length - 1);\n\n    for (var i = 0; i < args.length; i++) {\n      args[i] = arguments[i + 1];\n    } // Store and register the task\n\n\n    var task = {\n      callback: callback,\n      args: args\n    };\n    tasksByHandle[nextHandle] = task;\n    registerImmediate(nextHandle);\n    return nextHandle++;\n  }\n\n  function clearImmediate(handle) {\n    delete tasksByHandle[handle];\n  }\n\n  function run(task) {\n    var callback = task.callback;\n    var args = task.args;\n\n    switch (args.length) {\n      case 0:\n        callback();\n        break;\n\n      case 1:\n        callback(args[0]);\n        break;\n\n      case 2:\n        callback(args[0], args[1]);\n        break;\n\n      case 3:\n        callback(args[0], args[1], args[2]);\n        break;\n\n      default:\n        callback.apply(undefined$1, args);\n        break;\n    }\n  }\n\n  function runIfPresent(handle) {\n    // From the spec: \"Wait until any invocations of this algorithm started before this one have completed.\"\n    // So if we're currently running a task, we'll need to delay this invocation.\n    if (currentlyRunningATask) {\n      // Delay by doing a setTimeout. setImmediate was tried instead, but in Firefox 7 it generated a\n      // \"too much recursion\" error.\n      setTimeout(runIfPresent, 0, handle);\n    } else {\n      var task = tasksByHandle[handle];\n\n      if (task) {\n        currentlyRunningATask = true;\n\n        try {\n          run(task);\n        } finally {\n          clearImmediate(handle);\n          currentlyRunningATask = false;\n        }\n      }\n    }\n  }\n\n  function installNextTickImplementation() {\n    registerImmediate = function registerImmediate(handle) {\n      process.nextTick(function () {\n        runIfPresent(handle);\n      });\n    };\n  }\n\n  function canUsePostMessage() {\n    // The test against `importScripts` prevents this implementation from being installed inside a web worker,\n    // where `global.postMessage` means something completely different and can't be used for this purpose.\n    if (global.postMessage && !global.importScripts) {\n      var postMessageIsAsynchronous = true;\n      var oldOnMessage = global.onmessage;\n\n      global.onmessage = function () {\n        postMessageIsAsynchronous = false;\n      };\n\n      global.postMessage(\"\", \"*\");\n      global.onmessage = oldOnMessage;\n      return postMessageIsAsynchronous;\n    }\n  }\n\n  function installPostMessageImplementation() {\n    // Installs an event handler on `global` for the `message` event: see\n    // * https://developer.mozilla.org/en/DOM/window.postMessage\n    // * http://www.whatwg.org/specs/web-apps/current-work/multipage/comms.html#crossDocumentMessages\n    var messagePrefix = \"setImmediate$\" + Math.random() + \"$\";\n\n    var onGlobalMessage = function onGlobalMessage(event) {\n      if (event.source === global && typeof event.data === \"string\" && event.data.indexOf(messagePrefix) === 0) {\n        runIfPresent(+event.data.slice(messagePrefix.length));\n      }\n    };\n\n    if (global.addEventListener) {\n      global.addEventListener(\"message\", onGlobalMessage, false);\n    } else {\n      global.attachEvent(\"onmessage\", onGlobalMessage);\n    }\n\n    registerImmediate = function registerImmediate(handle) {\n      global.postMessage(messagePrefix + handle, \"*\");\n    };\n  }\n\n  function installMessageChannelImplementation() {\n    var channel = new MessageChannel();\n\n    channel.port1.onmessage = function (event) {\n      var handle = event.data;\n      runIfPresent(handle);\n    };\n\n    registerImmediate = function registerImmediate(handle) {\n      channel.port2.postMessage(handle);\n    };\n  }\n\n  function installReadyStateChangeImplementation() {\n    var html = doc.documentElement;\n\n    registerImmediate = function registerImmediate(handle) {\n      // Create a <script> element; its readystatechange event will be fired asynchronously once it is inserted\n      // into the document. Do so, thus queuing up the task. Remember to clean up once it's been called.\n      var script = doc.createElement(\"script\");\n\n      script.onreadystatechange = function () {\n        runIfPresent(handle);\n        script.onreadystatechange = null;\n        html.removeChild(script);\n        script = null;\n      };\n\n      html.appendChild(script);\n    };\n  }\n\n  function installSetTimeoutImplementation() {\n    registerImmediate = function registerImmediate(handle) {\n      setTimeout(runIfPresent, 0, handle);\n    };\n  } // If supported, we should attach to the prototype of global, since that is where setTimeout et al. live.\n\n\n  var attachTo = Object.getPrototypeOf && Object.getPrototypeOf(global);\n  attachTo = attachTo && attachTo.setTimeout ? attachTo : global; // Don't get fooled by e.g. browserify environments.\n\n  if ({}.toString.call(global.process) === \"[object process]\") {\n    // For Node.js before 0.9\n    installNextTickImplementation();\n  } else if (canUsePostMessage()) {\n    // For non-IE10 modern browsers\n    installPostMessageImplementation();\n  } else if (global.MessageChannel) {\n    // For web workers, where supported\n    installMessageChannelImplementation();\n  } else if (doc && \"onreadystatechange\" in doc.createElement(\"script\")) {\n    // For IE 6–8\n    installReadyStateChangeImplementation();\n  } else {\n    // For older browsers\n    installSetTimeoutImplementation();\n  }\n\n  attachTo.setImmediate = setImmediate;\n  attachTo.clearImmediate = clearImmediate;\n})(typeof self === \"undefined\" ? typeof global === \"undefined\" ? this : global : self);\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../_webpack@4.44.2@webpack/buildin/global.js */ \"./node_modules/_webpack@4.44.2@webpack/buildin/global.js\"), __webpack_require__(/*! ./../_process@0.11.10@process/browser.js */ \"./node_modules/_process@0.11.10@process/browser.js\")));\n\n/***/ }),\n\n/***/ \"./node_modules/_timers-browserify@2.0.12@timers-browserify/main.js\":\n/*!**************************************************************************!*\\\n  !*** ./node_modules/_timers-browserify@2.0.12@timers-browserify/main.js ***!\n  \\**************************************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n/* WEBPACK VAR INJECTION */(function(global) {var scope = typeof global !== \"undefined\" && global || typeof self !== \"undefined\" && self || window;\nvar apply = Function.prototype.apply; // DOM APIs, for completeness\n\nexports.setTimeout = function () {\n  return new Timeout(apply.call(setTimeout, scope, arguments), clearTimeout);\n};\n\nexports.setInterval = function () {\n  return new Timeout(apply.call(setInterval, scope, arguments), clearInterval);\n};\n\nexports.clearTimeout = exports.clearInterval = function (timeout) {\n  if (timeout) {\n    timeout.close();\n  }\n};\n\nfunction Timeout(id, clearFn) {\n  this._id = id;\n  this._clearFn = clearFn;\n}\n\nTimeout.prototype.unref = Timeout.prototype.ref = function () {};\n\nTimeout.prototype.close = function () {\n  this._clearFn.call(scope, this._id);\n}; // Does not start the time, just sets up the members needed.\n\n\nexports.enroll = function (item, msecs) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = msecs;\n};\n\nexports.unenroll = function (item) {\n  clearTimeout(item._idleTimeoutId);\n  item._idleTimeout = -1;\n};\n\nexports._unrefActive = exports.active = function (item) {\n  clearTimeout(item._idleTimeoutId);\n  var msecs = item._idleTimeout;\n\n  if (msecs >= 0) {\n    item._idleTimeoutId = setTimeout(function onTimeout() {\n      if (item._onTimeout) item._onTimeout();\n    }, msecs);\n  }\n}; // setimmediate attaches itself to the global object\n\n\n__webpack_require__(/*! setimmediate */ \"./node_modules/_setimmediate@1.0.5@setimmediate/setImmediate.js\"); // On some exotic environments, it's not clear which object `setimmediate` was\n// able to install onto.  Search each possibility in the same order as the\n// `setimmediate` library.\n\n\nexports.setImmediate = typeof self !== \"undefined\" && self.setImmediate || typeof global !== \"undefined\" && global.setImmediate || this && this.setImmediate;\nexports.clearImmediate = typeof self !== \"undefined\" && self.clearImmediate || typeof global !== \"undefined\" && global.clearImmediate || this && this.clearImmediate;\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../_webpack@4.44.2@webpack/buildin/global.js */ \"./node_modules/_webpack@4.44.2@webpack/buildin/global.js\")));\n\n/***/ }),\n\n/***/ \"./node_modules/_webpack@4.44.2@webpack/buildin/global.js\":\n/*!***********************************!*\\\n  !*** (webpack)/buildin/global.js ***!\n  \\***********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nvar g; // This works in non-strict mode\n\ng = function () {\n  return this;\n}();\n\ntry {\n  // This works if eval is allowed (see CSP)\n  g = g || new Function(\"return this\")();\n} catch (e) {\n  // This works if the window reference is available\n  if (typeof window === \"object\") g = window;\n} // g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\n\nmodule.exports = g;\n\n/***/ }),\n\n/***/ \"./src/Hilo3d.js\":\n/*!*************************************!*\\\n  !*** ./src/Hilo3d.js + 100 modules ***!\n  \\*************************************/\n/*! exports provided: util, GLTFExtensions, Class, EventMixin, Fog, Mesh, Node, SkinedMesh, Skeleton, Stage, Tween, version, BoxGeometry, Geometry, GeometryData, MorphGeometry, PlaneGeometry, SphereGeometry, Camera, PerspectiveCamera, OrthographicCamera, Buffer, capabilities, extensions, Framebuffer, glType, logGLResource, Program, RenderInfo, RenderList, VertexArrayObject, WebGLRenderer, WebGLResourceManager, WebGLState, BasicLoader, CubeTextureLoader, GLTFLoader, GLTFParser, AliAMCExtension, HDRLoader, KTXLoader, LoadCache, LoadQueue, ShaderMaterialLoader, TextureLoader, Loader, Texture, LazyTexture, CubeTexture, DataTexture, Shader, BasicMaterial, GeometryMaterial, Material, PBRMaterial, semantic, ShaderMaterial, AxisHelper, AxisNetHelper, CameraHelper, AmbientLight, AreaLight, DirectionalLight, CubeLightShadow, Light, LightManager, LightShadow, PointLight, SpotLight, Animation, AnimationStates, MeshPicker, Ticker, log, Cache, browser, WebGLSupport, constants, Color, Euler, EulerNotifier, Frustum, math, Matrix3, Matrix4, Matrix4Notifier, Plane, Quaternion, Ray, Sphere, SphericalHarmonics3, Vector2, Vector3, Vector3Notifier, Vector4 */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_amc@1.0.6@amc/build/amd.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_gl-constants@1.0.0@gl-constants/1.0/index.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_gl-extensions-constants@1.0.0@gl-extensions-constants/index.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/core/Class.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/event/EventMixin.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/tween/Ease.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/tween/Tween.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/util/Ticker.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_hilojs@2.0.2@hilojs/util/browser.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/_ray-3d@1.1.1@ray-3d/index.js (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/basic.frag (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/basic.vert (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/geometry.frag (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/pbr.frag (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/screen.frag (<- Module is not an ECMAScript module) */\n/*! ModuleConcatenation bailout: Cannot concat with ./src/shader/screen.vert (<- Module is not an ECMAScript module) */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n// ESM COMPAT FLAG\n__webpack_require__.r(__webpack_exports__);\n\n// EXPORTS\n__webpack_require__.d(__webpack_exports__, \"util\", function() { return /* reexport */ util_namespaceObject; });\n__webpack_require__.d(__webpack_exports__, \"GLTFExtensions\", function() { return /* reexport */ GLTFExtensions_namespaceObject; });\n__webpack_require__.d(__webpack_exports__, \"Class\", function() { return /* reexport */ core_Class; });\n__webpack_require__.d(__webpack_exports__, \"EventMixin\", function() { return /* reexport */ core_EventMixin; });\n__webpack_require__.d(__webpack_exports__, \"Fog\", function() { return /* reexport */ core_Fog; });\n__webpack_require__.d(__webpack_exports__, \"Mesh\", function() { return /* reexport */ core_Mesh; });\n__webpack_require__.d(__webpack_exports__, \"Node\", function() { return /* reexport */ core_Node; });\n__webpack_require__.d(__webpack_exports__, \"SkinedMesh\", function() { return /* reexport */ core_SkinedMesh; });\n__webpack_require__.d(__webpack_exports__, \"Skeleton\", function() { return /* reexport */ core_Skeleton; });\n__webpack_require__.d(__webpack_exports__, \"Stage\", function() { return /* reexport */ core_Stage; });\n__webpack_require__.d(__webpack_exports__, \"Tween\", function() { return /* reexport */ core_Tween; });\n__webpack_require__.d(__webpack_exports__, \"version\", function() { return /* reexport */ core_version; });\n__webpack_require__.d(__webpack_exports__, \"BoxGeometry\", function() { return /* reexport */ geometry_BoxGeometry; });\n__webpack_require__.d(__webpack_exports__, \"Geometry\", function() { return /* reexport */ geometry_Geometry; });\n__webpack_require__.d(__webpack_exports__, \"GeometryData\", function() { return /* reexport */ geometry_GeometryData; });\n__webpack_require__.d(__webpack_exports__, \"MorphGeometry\", function() { return /* reexport */ geometry_MorphGeometry; });\n__webpack_require__.d(__webpack_exports__, \"PlaneGeometry\", function() { return /* reexport */ geometry_PlaneGeometry; });\n__webpack_require__.d(__webpack_exports__, \"SphereGeometry\", function() { return /* reexport */ geometry_SphereGeometry; });\n__webpack_require__.d(__webpack_exports__, \"Camera\", function() { return /* reexport */ camera_Camera; });\n__webpack_require__.d(__webpack_exports__, \"PerspectiveCamera\", function() { return /* reexport */ camera_PerspectiveCamera; });\n__webpack_require__.d(__webpack_exports__, \"OrthographicCamera\", function() { return /* reexport */ camera_OrthographicCamera; });\n__webpack_require__.d(__webpack_exports__, \"Buffer\", function() { return /* reexport */ renderer_Buffer; });\n__webpack_require__.d(__webpack_exports__, \"capabilities\", function() { return /* reexport */ renderer_capabilities; });\n__webpack_require__.d(__webpack_exports__, \"extensions\", function() { return /* reexport */ renderer_extensions; });\n__webpack_require__.d(__webpack_exports__, \"Framebuffer\", function() { return /* reexport */ renderer_Framebuffer; });\n__webpack_require__.d(__webpack_exports__, \"glType\", function() { return /* reexport */ renderer_glType; });\n__webpack_require__.d(__webpack_exports__, \"logGLResource\", function() { return /* reexport */ renderer_logGLResource; });\n__webpack_require__.d(__webpack_exports__, \"Program\", function() { return /* reexport */ renderer_Program; });\n__webpack_require__.d(__webpack_exports__, \"RenderInfo\", function() { return /* reexport */ renderer_RenderInfo; });\n__webpack_require__.d(__webpack_exports__, \"RenderList\", function() { return /* reexport */ renderer_RenderList; });\n__webpack_require__.d(__webpack_exports__, \"VertexArrayObject\", function() { return /* reexport */ renderer_VertexArrayObject; });\n__webpack_require__.d(__webpack_exports__, \"WebGLRenderer\", function() { return /* reexport */ renderer_WebGLRenderer; });\n__webpack_require__.d(__webpack_exports__, \"WebGLResourceManager\", function() { return /* reexport */ renderer_WebGLResourceManager; });\n__webpack_require__.d(__webpack_exports__, \"WebGLState\", function() { return /* reexport */ renderer_WebGLState; });\n__webpack_require__.d(__webpack_exports__, \"BasicLoader\", function() { return /* reexport */ loader_BasicLoader; });\n__webpack_require__.d(__webpack_exports__, \"CubeTextureLoader\", function() { return /* reexport */ loader_CubeTextureLoader; });\n__webpack_require__.d(__webpack_exports__, \"GLTFLoader\", function() { return /* reexport */ loader_GLTFLoader; });\n__webpack_require__.d(__webpack_exports__, \"GLTFParser\", function() { return /* reexport */ loader_GLTFParser; });\n__webpack_require__.d(__webpack_exports__, \"AliAMCExtension\", function() { return /* reexport */ loader_AliAMCExtension; });\n__webpack_require__.d(__webpack_exports__, \"HDRLoader\", function() { return /* reexport */ loader_HDRLoader; });\n__webpack_require__.d(__webpack_exports__, \"KTXLoader\", function() { return /* reexport */ loader_KTXLoader; });\n__webpack_require__.d(__webpack_exports__, \"LoadCache\", function() { return /* reexport */ loader_LoadCache; });\n__webpack_require__.d(__webpack_exports__, \"LoadQueue\", function() { return /* reexport */ loader_LoadQueue; });\n__webpack_require__.d(__webpack_exports__, \"ShaderMaterialLoader\", function() { return /* reexport */ loader_ShaderMaterialLoader; });\n__webpack_require__.d(__webpack_exports__, \"TextureLoader\", function() { return /* reexport */ loader_TextureLoader; });\n__webpack_require__.d(__webpack_exports__, \"Loader\", function() { return /* reexport */ loader_Loader; });\n__webpack_require__.d(__webpack_exports__, \"Texture\", function() { return /* reexport */ texture_Texture; });\n__webpack_require__.d(__webpack_exports__, \"LazyTexture\", function() { return /* reexport */ texture_LazyTexture; });\n__webpack_require__.d(__webpack_exports__, \"CubeTexture\", function() { return /* reexport */ texture_CubeTexture; });\n__webpack_require__.d(__webpack_exports__, \"DataTexture\", function() { return /* reexport */ texture_DataTexture; });\n__webpack_require__.d(__webpack_exports__, \"Shader\", function() { return /* reexport */ shader_Shader; });\n__webpack_require__.d(__webpack_exports__, \"BasicMaterial\", function() { return /* reexport */ material_BasicMaterial; });\n__webpack_require__.d(__webpack_exports__, \"GeometryMaterial\", function() { return /* reexport */ material_GeometryMaterial; });\n__webpack_require__.d(__webpack_exports__, \"Material\", function() { return /* reexport */ material_Material; });\n__webpack_require__.d(__webpack_exports__, \"PBRMaterial\", function() { return /* reexport */ material_PBRMaterial; });\n__webpack_require__.d(__webpack_exports__, \"semantic\", function() { return /* reexport */ material_semantic; });\n__webpack_require__.d(__webpack_exports__, \"ShaderMaterial\", function() { return /* reexport */ material_ShaderMaterial; });\n__webpack_require__.d(__webpack_exports__, \"AxisHelper\", function() { return /* reexport */ helper_AxisHelper; });\n__webpack_require__.d(__webpack_exports__, \"AxisNetHelper\", function() { return /* reexport */ helper_AxisNetHelper; });\n__webpack_require__.d(__webpack_exports__, \"CameraHelper\", function() { return /* reexport */ helper_CameraHelper; });\n__webpack_require__.d(__webpack_exports__, \"AmbientLight\", function() { return /* reexport */ light_AmbientLight; });\n__webpack_require__.d(__webpack_exports__, \"AreaLight\", function() { return /* reexport */ light_AreaLight; });\n__webpack_require__.d(__webpack_exports__, \"DirectionalLight\", function() { return /* reexport */ light_DirectionalLight; });\n__webpack_require__.d(__webpack_exports__, \"CubeLightShadow\", function() { return /* reexport */ light_CubeLightShadow; });\n__webpack_require__.d(__webpack_exports__, \"Light\", function() { return /* reexport */ light_Light; });\n__webpack_require__.d(__webpack_exports__, \"LightManager\", function() { return /* reexport */ light_LightManager; });\n__webpack_require__.d(__webpack_exports__, \"LightShadow\", function() { return /* reexport */ light_LightShadow; });\n__webpack_require__.d(__webpack_exports__, \"PointLight\", function() { return /* reexport */ light_PointLight; });\n__webpack_require__.d(__webpack_exports__, \"SpotLight\", function() { return /* reexport */ light_SpotLight; });\n__webpack_require__.d(__webpack_exports__, \"Animation\", function() { return /* reexport */ animation_Animation; });\n__webpack_require__.d(__webpack_exports__, \"AnimationStates\", function() { return /* reexport */ animation_AnimationStates; });\n__webpack_require__.d(__webpack_exports__, \"MeshPicker\", function() { return /* reexport */ utils_MeshPicker; });\n__webpack_require__.d(__webpack_exports__, \"Ticker\", function() { return /* reexport */ utils_Ticker; });\n__webpack_require__.d(__webpack_exports__, \"log\", function() { return /* reexport */ utils_log; });\n__webpack_require__.d(__webpack_exports__, \"Cache\", function() { return /* reexport */ utils_Cache; });\n__webpack_require__.d(__webpack_exports__, \"browser\", function() { return /* reexport */ utils_browser; });\n__webpack_require__.d(__webpack_exports__, \"WebGLSupport\", function() { return /* reexport */ utils_WebGLSupport; });\n__webpack_require__.d(__webpack_exports__, \"constants\", function() { return /* reexport */ src_constants; });\n__webpack_require__.d(__webpack_exports__, \"Color\", function() { return /* reexport */ math_Color; });\n__webpack_require__.d(__webpack_exports__, \"Euler\", function() { return /* reexport */ math_Euler; });\n__webpack_require__.d(__webpack_exports__, \"EulerNotifier\", function() { return /* reexport */ math_EulerNotifier; });\n__webpack_require__.d(__webpack_exports__, \"Frustum\", function() { return /* reexport */ math_Frustum; });\n__webpack_require__.d(__webpack_exports__, \"math\", function() { return /* reexport */ math_math; });\n__webpack_require__.d(__webpack_exports__, \"Matrix3\", function() { return /* reexport */ math_Matrix3; });\n__webpack_require__.d(__webpack_exports__, \"Matrix4\", function() { return /* reexport */ math_Matrix4; });\n__webpack_require__.d(__webpack_exports__, \"Matrix4Notifier\", function() { return /* reexport */ math_Matrix4Notifier; });\n__webpack_require__.d(__webpack_exports__, \"Plane\", function() { return /* reexport */ math_Plane; });\n__webpack_require__.d(__webpack_exports__, \"Quaternion\", function() { return /* reexport */ math_Quaternion; });\n__webpack_require__.d(__webpack_exports__, \"Ray\", function() { return /* reexport */ math_Ray; });\n__webpack_require__.d(__webpack_exports__, \"Sphere\", function() { return /* reexport */ math_Sphere; });\n__webpack_require__.d(__webpack_exports__, \"SphericalHarmonics3\", function() { return /* reexport */ math_SphericalHarmonics3; });\n__webpack_require__.d(__webpack_exports__, \"Vector2\", function() { return /* reexport */ math_Vector2; });\n__webpack_require__.d(__webpack_exports__, \"Vector3\", function() { return /* reexport */ math_Vector3; });\n__webpack_require__.d(__webpack_exports__, \"Vector3Notifier\", function() { return /* reexport */ math_Vector3Notifier; });\n__webpack_require__.d(__webpack_exports__, \"Vector4\", function() { return /* reexport */ math_Vector4; });\n\n// NAMESPACE OBJECT: ./src/constants/Hilo.js\nvar Hilo_namespaceObject = {};\n__webpack_require__.r(Hilo_namespaceObject);\n__webpack_require__.d(Hilo_namespaceObject, \"POSITION\", function() { return POSITION; });\n__webpack_require__.d(Hilo_namespaceObject, \"NORMAL\", function() { return NORMAL; });\n__webpack_require__.d(Hilo_namespaceObject, \"DEPTH\", function() { return DEPTH; });\n__webpack_require__.d(Hilo_namespaceObject, \"DISTANCE\", function() { return DISTANCE; });\n\n// NAMESPACE OBJECT: ./src/utils/util.js\nvar util_namespaceObject = {};\n__webpack_require__.r(util_namespaceObject);\n__webpack_require__.d(util_namespaceObject, \"each\", function() { return util_each; });\n__webpack_require__.d(util_namespaceObject, \"getRelativePath\", function() { return getRelativePath; });\n__webpack_require__.d(util_namespaceObject, \"convertUint8ArrayToString\", function() { return convertUint8ArrayToString; });\n__webpack_require__.d(util_namespaceObject, \"getExtension\", function() { return getExtension; });\n__webpack_require__.d(util_namespaceObject, \"getIndexFromSortedArray\", function() { return getIndexFromSortedArray; });\n__webpack_require__.d(util_namespaceObject, \"insertToSortedArray\", function() { return insertToSortedArray; });\n__webpack_require__.d(util_namespaceObject, \"padLeft\", function() { return padLeft; });\n__webpack_require__.d(util_namespaceObject, \"getTypedArrayClass\", function() { return getTypedArrayClass; });\n__webpack_require__.d(util_namespaceObject, \"copyArrayData\", function() { return copyArrayData; });\n__webpack_require__.d(util_namespaceObject, \"isStrOrNumber\", function() { return isStrOrNumber; });\n__webpack_require__.d(util_namespaceObject, \"getTypedArrayGLType\", function() { return getTypedArrayGLType; });\n__webpack_require__.d(util_namespaceObject, \"getBlobUrl\", function() { return getBlobUrl; });\n__webpack_require__.d(util_namespaceObject, \"isBlobUrl\", function() { return isBlobUrl; });\n__webpack_require__.d(util_namespaceObject, \"revokeBlobUrl\", function() { return revokeBlobUrl; });\n__webpack_require__.d(util_namespaceObject, \"isArrayLike\", function() { return isArrayLike; });\n__webpack_require__.d(util_namespaceObject, \"getElementRect\", function() { return getElementRect; });\n__webpack_require__.d(util_namespaceObject, \"serialRun\", function() { return serialRun; });\n__webpack_require__.d(util_namespaceObject, \"hasOwnProperty\", function() { return util_hasOwnProperty; });\n\n// NAMESPACE OBJECT: ./src/loader/GLTFExtensions.js\nvar GLTFExtensions_namespaceObject = {};\n__webpack_require__.r(GLTFExtensions_namespaceObject);\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"ALI_amc_mesh_compression\", function() { return loader_AliAMCExtension; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"WEB3D_quantized_attributes\", function() { return WEB3D_quantized_attributes; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"HILO_animation_clips\", function() { return HILO_animation_clips; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"ALI_animation_clips\", function() { return ALI_animation_clips; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"ALI_bounding_box\", function() { return ALI_bounding_box; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"KHR_materials_pbrSpecularGlossiness\", function() { return KHR_materials_pbrSpecularGlossiness; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"KHR_lights_punctual\", function() { return KHR_lights_punctual; });\n__webpack_require__.d(GLTFExtensions_namespaceObject, \"KHR_techniques_webgl\", function() { return GLTFExtensions_KHR_techniques_webgl; });\n\n// CONCATENATED MODULE: ./src/utils/log.js\n/* eslint prefer-spread: \"off\", prefer-rest-params:\"off\" */\nvar cache = {};\nvar LEVEL_NONE = 0;\nvar LEVEL_LOG = 1;\nvar LEVEL_WARN = 2;\nvar LEVEL_ERROR = 4;\n/**\n * 向 Web 控制台输出一条消息，可以通过设置等级过滤输出的消息。\n * @namespace\n * @type {Object}\n * @name log\n * @example\n * Hilo3d.log.level = Hilo3d.log.LEVEL_LOG | Hilo3d.log.LEVEL_ERROR;\n * Hilo3d.log.error(\"ERROR!\");\n */\n\nvar log = {\n  _cache: cache,\n\n  /**\n   * log级别\n   * @type {Number}\n   * @default LEVEL_LOG | LEVEL_WARN | LEVEL_ERROR\n   */\n  level: LEVEL_LOG | LEVEL_WARN | LEVEL_ERROR,\n\n  /**\n   * 不显示任何\n   * @readOnly\n   * @type {Number}\n   * @default 0\n   */\n  LEVEL_NONE: LEVEL_NONE,\n\n  /**\n   * 显示 log\n   * @readOnly\n   * @type {Number}\n   * @default 1\n   */\n  LEVEL_LOG: LEVEL_LOG,\n\n  /**\n   * 显示 warn\n   * @readOnly\n   * @type {Number}\n   * @default 2\n   */\n  LEVEL_WARN: LEVEL_WARN,\n\n  /**\n   * 显示 error\n   * @readOnly\n   * @type {Number}\n   * @default 4\n   */\n  LEVEL_ERROR: LEVEL_ERROR,\n\n  /**\n   * log，等同 console.log\n   * @return {log} this\n   */\n  log: function log() {\n    var console = this.console;\n\n    if (this.level & LEVEL_LOG) {\n      console.log.apply(console, arguments);\n    }\n\n    return this;\n  },\n\n  /**\n   * warn，等同 console.warn\n   * @return {log} this\n   */\n  warn: function warn() {\n    var console = this.console;\n\n    if (this.level & LEVEL_WARN) {\n      console.warn.apply(console, arguments);\n    }\n\n    return this;\n  },\n\n  /**\n   * error，等同 console.error\n   * @return {log} this\n   */\n  error: function error() {\n    var console = this.console;\n\n    if (this.level & LEVEL_ERROR) {\n      console.error.apply(console, arguments);\n    }\n\n    return this;\n  },\n\n  /**\n   * logOnce 相同 id 只 log 一次\n   * @param {String} id\n   * @return {log} this\n   */\n  logOnce: function logOnce(id) {\n    if (!cache['log_' + id]) {\n      cache['log_' + id] = true;\n      this.log.apply(this, Array.prototype.slice.call(arguments, 1));\n    }\n\n    return this;\n  },\n\n  /**\n   * warnOnce  相同 id 只 once 一次\n   * @param {String} id\n   * @return {log} this\n   */\n  warnOnce: function warnOnce(id) {\n    if (!cache['warn_' + id]) {\n      cache['warn_' + id] = true;\n      this.warn.apply(this, Array.prototype.slice.call(arguments, 1));\n    }\n\n    return this;\n  },\n\n  /**\n   * errorOnce 相同 id 只 error 一次\n   * @param {String} id\n   * @return {log} this\n   */\n  errorOnce: function errorOnce(id) {\n    if (!cache['error_' + id]) {\n      cache['error_' + id] = true;\n      this.error.apply(this, Array.prototype.slice.call(arguments, 1));\n    }\n\n    return this;\n  },\n  _console: console,\n\n  /**\n   * @private\n   * @type {Object}\n   */\n  get console() {\n    return this._console;\n  },\n\n  set console(value) {\n    this._console = value;\n  }\n\n};\n/* harmony default export */ var utils_log = (log);\n// EXTERNAL MODULE: ./node_modules/_gl-constants@1.0.0@gl-constants/1.0/index.js\nvar _1_0 = __webpack_require__(\"./node_modules/_gl-constants@1.0.0@gl-constants/1.0/index.js\");\nvar _1_0_default = /*#__PURE__*/__webpack_require__.n(_1_0);\n\n// CONCATENATED MODULE: ./src/constants/webgl.js\n\n/* harmony default export */ var webgl = (_1_0_default.a);\n// EXTERNAL MODULE: ./node_modules/_gl-extensions-constants@1.0.0@gl-extensions-constants/index.js\nvar _gl_extensions_constants_1_0_0_gl_extensions_constants = __webpack_require__(\"./node_modules/_gl-extensions-constants@1.0.0@gl-extensions-constants/index.js\");\nvar _gl_extensions_constants_1_0_0_gl_extensions_constants_default = /*#__PURE__*/__webpack_require__.n(_gl_extensions_constants_1_0_0_gl_extensions_constants);\n\n// CONCATENATED MODULE: ./src/constants/webglExtensions.js\n\n/* harmony default export */ var webglExtensions = (_gl_extensions_constants_1_0_0_gl_extensions_constants_default.a);\n// CONCATENATED MODULE: ./src/constants/Hilo.js\n// vertexType\nvar POSITION = 'POSITION';\nvar NORMAL = 'NORMAL';\nvar DEPTH = 'DEPTH';\nvar DISTANCE = 'DISTANCE';\n// CONCATENATED MODULE: ./src/constants/index.js\n\n\n\n/**\n * WebGL, WebGL extensions 枚举值\n * @constant\n * @type {Object}\n * @example\n * Hilo3d.constants.LINEAR_MIPMAP_NEAREST\n */\n\nvar constants = {\n  webgl: webgl,\n  webglExtensions: webglExtensions,\n  Hilo: Hilo_namespaceObject\n};\nObject.assign(constants, webgl, webglExtensions, Hilo_namespaceObject);\n/* harmony default export */ var src_constants = (constants);\n// CONCATENATED MODULE: ./src/utils/util.js\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n\n\nvar BYTE = src_constants.BYTE,\n    UNSIGNED_BYTE = src_constants.UNSIGNED_BYTE,\n    SHORT = src_constants.SHORT,\n    UNSIGNED_SHORT = src_constants.UNSIGNED_SHORT,\n    UNSIGNED_INT = src_constants.UNSIGNED_INT,\n    FLOAT = src_constants.FLOAT;\n\nfunction getRelativePath(basePath, path) {\n  if (/^(?:http|blob|data:|\\/)/.test(path)) {\n    return path;\n  }\n\n  basePath = basePath.replace(/\\/[^/]*?$/, '').split('/');\n  path = path.split('/');\n  var i;\n\n  for (i = 0; i < path.length; i++) {\n    var p = path[i];\n\n    if (p === '..') {\n      basePath.pop();\n    } else if (p !== '.') {\n      break;\n    }\n  }\n\n  return basePath.join('/') + '/' + path.slice(i).join('/');\n}\n\nvar utf8Decoder;\n\nfunction convertUint8ArrayToString(array, isUTF8) {\n  if (window.TextDecoder) {\n    if (!utf8Decoder) {\n      utf8Decoder = new TextDecoder('utf-8');\n    }\n\n    if (!(array instanceof Uint8Array)) {\n      array = new Uint8Array(array);\n    }\n\n    return utf8Decoder.decode(array);\n  }\n\n  var str = '';\n\n  for (var i = 0; i < array.length; i++) {\n    str += String.fromCharCode(array[i]);\n  }\n\n  if (isUTF8) {\n    // utf8 str fix\n    // https://developer.mozilla.org/zh-CN/docs/Web/API/WindowBase64/btoa\n    str = decodeURIComponent(escape(str));\n  }\n\n  return str;\n}\n\nfunction getExtension(url) {\n  var extRegExp = /\\/?[^/]+\\.(\\w+)(\\?\\S+)?$/i;\n  var match = String(url).match(extRegExp);\n  return match && match[1].toLowerCase() || null;\n}\n\nfunction util_each(obj, fn) {\n  if (!obj) {\n    return;\n  }\n\n  if (Array.isArray(obj)) {\n    obj.forEach(fn);\n  } else {\n    Object.keys(obj).forEach(function (key) {\n      fn(obj[key], key);\n    });\n  }\n}\n\nfunction getIndexFromSortedArray(array, value, compareFn) {\n  if (!array || !array.length) {\n    return [0, 0];\n  }\n\n  var len = array.length;\n  var low = 0;\n  var high = len - 1;\n\n  while (low <= high) {\n    var mid = low + high >> 1;\n    var diff = compareFn(array[mid], value);\n\n    if (diff === 0) {\n      return [mid, mid];\n    }\n\n    if (diff < 0) {\n      low = mid + 1;\n    } else {\n      high = mid - 1;\n    }\n  }\n\n  if (low > high) {\n    return [high, low];\n  }\n\n  return [low, high];\n}\n\nfunction insertToSortedArray(array, item, compareFn) {\n  var indices = getIndexFromSortedArray(array, item, compareFn);\n  array.splice(indices[1], 0, item);\n}\n\nfunction padLeft(str, len, _char) {\n  if (len <= str.length) {\n    return str;\n  }\n\n  return new Array(len - str.length + 1).join(_char || '0') + str;\n}\n\nfunction getTypedArrayGLType(array) {\n  if (array instanceof Float32Array) {\n    return FLOAT;\n  }\n\n  if (array instanceof Int8Array) {\n    return BYTE;\n  }\n\n  if (array instanceof Uint8Array) {\n    return UNSIGNED_BYTE;\n  }\n\n  if (array instanceof Int16Array) {\n    return SHORT;\n  }\n\n  if (array instanceof Uint16Array) {\n    return UNSIGNED_SHORT;\n  }\n\n  if (array instanceof Uint32Array) {\n    return UNSIGNED_INT;\n  }\n\n  return FLOAT;\n}\n\nvar getTypedArrayClass = function () {\n  var _TypedArrayClassMap;\n\n  var TypedArrayClassMap = (_TypedArrayClassMap = {}, _defineProperty(_TypedArrayClassMap, BYTE, Int8Array), _defineProperty(_TypedArrayClassMap, UNSIGNED_BYTE, Uint8Array), _defineProperty(_TypedArrayClassMap, SHORT, Int16Array), _defineProperty(_TypedArrayClassMap, UNSIGNED_SHORT, Uint16Array), _defineProperty(_TypedArrayClassMap, UNSIGNED_INT, Uint32Array), _defineProperty(_TypedArrayClassMap, FLOAT, Float32Array), _TypedArrayClassMap);\n  return function (type) {\n    return TypedArrayClassMap[type] || Float32Array;\n  };\n}();\n\nfunction copyArrayData(destArr, srcArr, destIdx, srcIdx, count) {\n  if (!destArr || !srcArr) {\n    return;\n  }\n\n  if (srcArr.isGeometryData) {\n    srcArr = srcArr.data;\n  }\n\n  for (var i = 0; i < count; i++) {\n    destArr[destIdx + i] = srcArr[srcIdx + i];\n  }\n}\n\nfunction isStrOrNumber(d) {\n  return typeof d === 'string' || typeof d === 'number';\n}\n\nfunction isBlobUrl(url) {\n  return /^blob:/.test(url);\n}\n\nfunction revokeBlobUrl(blobUrl) {\n  if (window.URL) {\n    URL.revokeObjectURL(blobUrl);\n  }\n}\n\nfunction getBlobUrl(mimeType, data) {\n  if (data instanceof ArrayBuffer) {\n    data = new Uint8Array(data);\n  }\n\n  if (window.Blob && window.URL) {\n    try {\n      var blob = new Blob([data], {\n        type: mimeType\n      });\n      var blobUrl = window.URL.createObjectURL(blob);\n      return blobUrl;\n    } catch (err) {\n      utils_log.warn('new Blob error', mimeType);\n    }\n  }\n\n  return \"data:\".concat(mimeType, \";base64,\").concat(btoa(convertUint8ArrayToString(data)));\n}\n\nfunction isArrayLike(obj) {\n  return Array.isArray(obj) || obj.BYTES_PER_ELEMENT || obj.length;\n}\n\nfunction getElementRect(elem) {\n  var docElem = document.documentElement;\n  var bounds;\n\n  try {\n    // this fails if it's a disconnected DOM node\n    bounds = elem.getBoundingClientRect();\n  } catch (e) {\n    bounds = {\n      top: elem.offsetTop,\n      left: elem.offsetLeft,\n      right: elem.offsetLeft + elem.offsetWidth,\n      bottom: elem.offsetTop + elem.offsetHeight\n    };\n  }\n\n  var offsetX = (window.pageXOffset || docElem.scrollLeft) - (docElem.clientLeft || 0) || 0;\n  var offsetY = (window.pageYOffset || docElem.scrollTop) - (docElem.clientTop || 0) || 0;\n  var styles = window.getComputedStyle ? getComputedStyle(elem) : elem.currentStyle;\n  var parseIntFn = parseInt;\n  var padLeft = parseIntFn(styles.paddingLeft) + parseIntFn(styles.borderLeftWidth) || 0;\n  var padTop = parseIntFn(styles.paddingTop) + parseIntFn(styles.borderTopWidth) || 0;\n  var padRight = parseIntFn(styles.paddingRight) + parseIntFn(styles.borderRightWidth) || 0;\n  var padBottom = parseIntFn(styles.paddingBottom) + parseIntFn(styles.borderBottomWidth) || 0;\n  var top = bounds.top || 0;\n  var left = bounds.left || 0;\n  var right = bounds.right || 0;\n  var bottom = bounds.bottom || 0;\n  return {\n    left: left + offsetX + padLeft,\n    top: top + offsetY + padTop,\n    width: right - padRight - left - padLeft,\n    height: bottom - padBottom - top - padTop\n  };\n}\n\nfunction serialRun() {\n  var data = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var fn = arguments.length > 1 ? arguments[1] : undefined;\n\n  if (!Array.isArray(data)) {\n    data = Object.values(data);\n  }\n\n  return data.reduce(function (seq, d, i) {\n    return seq.then(function () {\n      return fn(d, i);\n    });\n  }, Promise.resolve());\n}\n\nfunction util_hasOwnProperty(obj, name) {\n  return Object.prototype.hasOwnProperty.call(obj, name);\n}\n\n\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\nvar Class = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/core/Class.js\");\nvar Class_default = /*#__PURE__*/__webpack_require__.n(Class);\n\n// CONCATENATED MODULE: ./src/core/Class.js\n\n/**\n * Class是提供类的创建的辅助工具。\n * @namespace  Class\n * @see {@link https://hiloteam.github.io/Hilo/docs/api-zh/symbols/Class.html}\n */\n\n/* harmony default export */ var core_Class = (Class_default.a);\n/**\n * @memberOf Class\n * @method create\n * @param {Object} params 类属性\n * @param {Object} [params.Statics] 静态属性\n * @param {Object} [params.Extends] 继承\n * @param {Object} [params.Mixes] mixes\n * @param {Function} [params.constructor] 构造函数\n * @param {any} [params.[value:string]] 其它属性\n */\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/event/EventMixin.js\nvar EventMixin = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/event/EventMixin.js\");\nvar EventMixin_default = /*#__PURE__*/__webpack_require__.n(EventMixin);\n\n// CONCATENATED MODULE: ./src/core/EventMixin.js\n\n/**\n * EventMixin是一个包含事件相关功能的mixin。可以通过 Object.assign(target, EventMixin) 来为target增加事件功能。\n * @class EventMixin\n * @see {@link https://hiloteam.github.io/Hilo/docs/api-zh/symbols/EventMixin.html}\n */\n\n/* harmony default export */ var core_EventMixin = (EventMixin_default.a);\n/**\n * 增加一个事件监听。\n * @name EventMixin#on\n * @function\n * @param {String} type 要监听的事件类型。\n * @param {EventMixinCallback} listener 事件监听回调函数。\n * @param {Boolean} [once] 是否是一次性监听，即回调函数响应一次后即删除，不再响应。\n * @returns {any} 对象本身。链式调用支持。\n */\n\n/**\n * 删除一个事件监听。如果不传入任何参数，则删除所有的事件监听；如果不传入第二个参数，则删除指定类型的所有事件监听。\n * @name EventMixin#off\n * @function\n * @param {String} [type] 要删除监听的事件类型。\n * @param {EventMixinCallback} [listener] 要删除监听的回调函数。\n * @returns {any} 对象本身。链式调用支持。\n*/\n\n/**\n * 发送事件。当第一个参数类型为Object时，则把它作为一个整体事件对象。\n * @name EventMixin#fire\n * @function\n * @param {String|EventObject} [type] 要发送的事件类型或者一个事件对象。\n * @param {Object} [detail] 要发送的事件的具体信息，即事件随带参数。\n * @returns {Boolean} 是否成功调度事件。\n */\n\n/**\n * 事件对象\n * @interface EventObject\n * @property {String} type 事件类型\n * @property {any} [detail=null] 事件数据\n */\n\n/**\n * @callback EventMixinCallback\n * @param {Object} [e] 事件对象\n * @param {String} e.type 事件类型\n * @param {Object} e.detail 事件数据\n * @param {Object} e.target 事件触发对象\n * @param {Date} e.timeStamp 时间戳\n */\n// EXTERNAL MODULE: ./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js\nvar gl_matrix_min = __webpack_require__(\"./node_modules/_gl-matrix@2.8.1@gl-matrix/dist/gl-matrix-min.js\");\n\n// CONCATENATED MODULE: ./src/math/Vector3.js\n\n\n/**\n * 三维向量\n * @class\n */\n\nvar Vector3 = core_Class.create(\n/** @lends Vector3.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Vector3\n   */\n  className: 'Vector3',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isVector3: true,\n\n  /**\n   * Creates a new empty vec3\n   * @param {Number} [x=0] X component\n   * @param {Number} [y=0] Y component\n   * @param {Number} [z=0] Z component\n   * @constructs\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"vec3\"].fromValues(x, y, z);\n  },\n\n  /**\n   * Copy the values from one vec3 to this\n   * @param  {Vector3} m the source vector\n   * @return {Vector3} this\n   */\n  copy: function copy(v) {\n    gl_matrix_min[\"vec3\"].copy(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a new vec3 initialized with values from this vec3\n   * @return {Vector3} a new Vector3\n   */\n  clone: function clone() {\n    var elements = this.elements;\n    return new this.constructor(elements[0], elements[1], elements[2]);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    array[0 + offset] = elements[0];\n    array[1 + offset] = elements[1];\n    array[2 + offset] = elements[2];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Vector3} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    elements[0] = array[offset + 0];\n    elements[1] = array[offset + 1];\n    elements[2] = array[offset + 2];\n    return this;\n  },\n\n  /**\n   * Set the components of a vec3 to the given values\n   * @param {Number} x X component\n   * @param {Number} y Y component\n   * @param {Number} z Z component\n   * @returns {Vector3} this\n   */\n  set: function set(x, y, z) {\n    gl_matrix_min[\"vec3\"].set(this.elements, x, y, z);\n    return this;\n  },\n\n  /**\n   * Adds two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的和\n   * @returns {Vector3} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].add(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Subtracts vector b from vector a\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的差\n   * @returns {Vector3} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].subtract(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Multiplies two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的积\n   * @returns {Vector3} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].multiply(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Divides two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的商\n   * @returns {Vector3} this\n   */\n  divide: function divide(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].divide(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.ceil the components of this\n   * @returns {Vector3} this\n   */\n  ceil: function ceil() {\n    gl_matrix_min[\"vec3\"].ceil(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Math.floor the components of this\n   * @returns {Vector3} this\n   */\n  floor: function floor() {\n    gl_matrix_min[\"vec3\"].floor(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the minimum of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector3} this\n   */\n  min: function min(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].min(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Returns the maximum of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b]  如果不传，计算 this 和 a 的结果\n   * @returns {Vector3} this\n   */\n  max: function max(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].max(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.round the components of this\n   * @returns {Vector3} this\n   */\n  round: function round() {\n    gl_matrix_min[\"vec3\"].round(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Scales this by a scalar number\n   * @param  {Number} scale amount to scale the vector by\n   * @returns {Vector3} this\n   */\n  scale: function scale(_scale) {\n    gl_matrix_min[\"vec3\"].scale(this.elements, this.elements, _scale);\n    return this;\n  },\n\n  /**\n   * Adds two vec3's after scaling the second vector by a scalar value\n   * @param  {Number} scale the amount to scale the second vector by before adding\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector3} this\n   */\n  scaleAndAdd: function scaleAndAdd(scale, a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].scaleAndAdd(this.elements, a.elements, b.elements, scale);\n    return this;\n  },\n\n  /**\n   * Calculates the euclidian distance between two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} distance between a and b\n   */\n  distance: function distance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].distance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the squared euclidian distance between two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} squared distance between a and b\n   */\n  squaredDistance: function squaredDistance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].squaredDistance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the length of this\n   * @return {Number} length of this\n   */\n  length: function length() {\n    return gl_matrix_min[\"vec3\"].length(this.elements);\n  },\n\n  /**\n   * Calculates the squared length of this\n   * @return {Number} squared length of this\n   */\n  squaredLength: function squaredLength() {\n    return gl_matrix_min[\"vec3\"].squaredLength(this.elements);\n  },\n\n  /**\n   * Negates the components of this\n   * @returns {Vector3} this\n   */\n  negate: function negate() {\n    gl_matrix_min[\"vec3\"].negate(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the inverse of the components of a vec3\n   * @param  {Vector3} [a=this]\n   * @returns {Vector3} this\n   */\n  inverse: function inverse(a) {\n    if (!a) {\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].inverse(this.elements, a.elements);\n    return this;\n  },\n\n  /**\n   * Normalize this\n   * @returns {Vector3} this\n   */\n  normalize: function normalize() {\n    gl_matrix_min[\"vec3\"].normalize(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the dot product of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  product of a and b\n   */\n  dot: function dot(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].dot(a.elements, b.elements);\n  },\n\n  /**\n   * Computes the cross product of two vec3's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  cross product of a and b\n   */\n  cross: function cross(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].cross(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Performs a linear interpolation between two vec3's\n   * @param  {Vector3} v\n   * @param  {Number} t interpolation amount between the two vectors\n   * @returns {Vector3} this\n   */\n  lerp: function lerp(v, t) {\n    gl_matrix_min[\"vec3\"].lerp(this.elements, this.elements, v.elements, t);\n    return this;\n  },\n\n  /**\n   * Performs a hermite interpolation with two control points\n   * @param  {Vector3} a\n   * @param  {Vector3} b\n   * @param  {Vector3} c\n   * @param  {Vector3} d\n   * @param  {Number} t interpolation amount between the two inputs\n   * @return {Vector3} this\n   */\n  hermite: function hermite(a, b, c, d, t) {\n    gl_matrix_min[\"vec3\"].hermite(this.elements, a.elements, b.elements, c.elements, d.elements, t);\n    return this;\n  },\n\n  /**\n   * Performs a bezier interpolation with two control points\n   * @param  {Vector3} a\n   * @param  {Vector3} b\n   * @param  {Vector3} c\n   * @param  {Vector3} d\n   * @param  {Number} t interpolation amount between the two inputs\n   * @return {Vector3} this\n   */\n  bezier: function bezier(a, b, c, d, t) {\n    gl_matrix_min[\"vec3\"].bezier(this.elements, a.elements, b.elements, c.elements, d.elements, t);\n    return this;\n  },\n\n  /**\n   * Generates a random vector with the given scale\n   * @param  {Number} [scale=1] Length of the resulting vector. If ommitted, a unit vector will be returned\n   * @returns {Vector3} this\n   */\n  random: function random(scale) {\n    gl_matrix_min[\"vec3\"].random(this.elements, scale);\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a mat3\n   * @param  {Matrix3} m matrix to transform with\n   * @returns {Vector3} this\n   */\n  transformMat3: function transformMat3(m) {\n    gl_matrix_min[\"vec3\"].transformMat3(this.elements, this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector3} this\n   */\n  transformMat4: function transformMat4(m) {\n    gl_matrix_min[\"vec3\"].transformMat4(this.elements, this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 direction with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector3} this\n   */\n  transformDirection: function transformDirection(m) {\n    var elements = this.elements;\n    var mElements = m.elements;\n    var x = elements[0];\n    var y = elements[1];\n    var z = elements[2];\n    elements[0] = x * mElements[0] + y * mElements[4] + z * mElements[8];\n    elements[1] = x * mElements[1] + y * mElements[5] + z * mElements[9];\n    elements[2] = x * mElements[2] + y * mElements[6] + z * mElements[10];\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a quat\n   * @param  {Quaternion} q quaternion to transform with\n   * @returns {Vector3} this\n   */\n  transformQuat: function transformQuat(q) {\n    gl_matrix_min[\"vec3\"].transformQuat(this.elements, this.elements, q.elements);\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the x-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateX: function rotateX(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateX(this.elements, this.elements, origin.elements, rotation);\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the y-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateY: function rotateY(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateY(this.elements, this.elements, origin.elements, rotation);\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the z-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateZ: function rotateZ(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateZ(this.elements, this.elements, origin.elements, rotation);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the vectors have approximately the same elements in the same position.\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * X component\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n    }\n  },\n\n  /**\n   * Y component\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n    }\n  },\n\n  /**\n   * Z component\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n    }\n  }\n});\n/**\n * Alias for {@link Vector3#subtract}\n * @function\n */\n\nVector3.prototype.sub = Vector3.prototype.subtract;\n/**\n * Alias for {@link Vector3#multiply}\n * @function\n */\n\nVector3.prototype.mul = Vector3.prototype.multiply;\n/**\n * Alias for {@link Vector3#divide}\n * @function\n */\n\nVector3.prototype.div = Vector3.prototype.divide;\n/**\n * Alias for {@link Vector3#distance}\n * @function\n */\n\nVector3.prototype.dist = Vector3.prototype.distance;\n/**\n * Alias for {@link Vector3#squaredDistance}\n * @function\n */\n\nVector3.prototype.sqrDist = Vector3.prototype.squaredDistance;\n/**\n * Alias for {@link Vector3#length}\n * @function\n */\n\nVector3.prototype.len = Vector3.prototype.length;\n/**\n * Alias for {@link Vector3#squaredLength}\n * @function\n */\n\nVector3.prototype.sqrLen = Vector3.prototype.squaredLength;\n/* harmony default export */ var math_Vector3 = (Vector3);\n// CONCATENATED MODULE: ./src/math/Matrix3.js\n\n\n/**\n * 3x3 矩阵\n * @class\n */\n\nvar Matrix3 = core_Class.create(\n/** @lends Matrix3.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Matrix3\n   */\n  className: 'Matrix3',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isMatrix3: true,\n\n  /**\n   * Creates a new identity mat3\n   * @constructs\n   */\n  constructor: function constructor() {\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"mat3\"].create();\n  },\n\n  /**\n   * Copy the values from one mat3 to this\n   * @param  {Matrix3} m the source matrix\n   * @return {Matrix3} this\n   */\n  copy: function copy(m) {\n    gl_matrix_min[\"mat3\"].copy(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Creates a new mat3 initialized with values from this matrix\n   * @return {Matrix3} a new Matrix3\n   */\n  clone: function clone() {\n    var m = new this.constructor();\n    gl_matrix_min[\"mat3\"].copy(m.elements, this.elements);\n    return m;\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n\n    for (var i = 0; i < 9; i++) {\n      array[offset + i] = elements[i];\n    }\n\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Matrix3} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n\n    for (var i = 0; i < 9; i++) {\n      elements[i] = array[offset + i];\n    }\n\n    return this;\n  },\n\n  /**\n   * Set the components of a mat3 to the given values\n   * @param {Number} m00\n   * @param {Number} m01\n   * @param {Number} m02\n   * @param {Number} m10\n   * @param {Number} m11\n   * @param {Number} m12\n   * @param {Number} m20\n   * @param {Number} m21\n   * @param {Number} m22\n   * @return {Matrix3} this\n   */\n  set: function set(m00, m01, m02, m10, m11, m12, m20, m21, m22) {\n    gl_matrix_min[\"mat3\"].set(this.elements, m00, m01, m02, m10, m11, m12, m20, m21, m22);\n    return this;\n  },\n\n  /**\n   * Set this to the identity matrix\n   * @return {Matrix3} this\n   */\n  identity: function identity() {\n    gl_matrix_min[\"mat3\"].identity(this.elements);\n    return this;\n  },\n\n  /**\n   * Transpose the values of this\n   * @return {Matrix3} this\n   */\n  transpose: function transpose() {\n    gl_matrix_min[\"mat3\"].transpose(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * invert a matrix\n   * @param  {Matrix3} [m = this]\n   * @return {Matrix3} this\n   */\n  invert: function invert() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat3\"].invert(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the adjugate of a mat3\n   * @param  {Matrix3} [m=this]\n   * @return {Matrix3} this\n   */\n  adjoint: function adjoint() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat3\"].adjoint(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the determinant of this\n   * @return {Number}\n   */\n  determinant: function determinant() {\n    return gl_matrix_min[\"mat3\"].determinant(this.elements);\n  },\n\n  /**\n   * Multiplies two matrix3's\n   * @param  {Matrix3} a\n   * @param  {Matrix3} [b] 如果不传，计算 this 和 a 的乘积\n   * @return {Matrix3} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat3\"].multiply(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * 左乘\n   * @param  {Matrix3} m\n   * @return {Matrix3}  this\n   */\n  premultiply: function premultiply(m) {\n    this.multiply(m, this);\n    return this;\n  },\n\n  /**\n   * Translate this by the given vector\n   * @param  {Vector2} v vector to translate by\n   * @return {Matrix3} this\n   */\n  translate: function translate(v) {\n    gl_matrix_min[\"mat3\"].translate(this.elements, this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle\n   * @param  {Number} rad the angle to rotate the matrix by\n   * @return {Matrix3} this\n   */\n  rotate: function rotate(rad) {\n    gl_matrix_min[\"mat3\"].rotate(this.elements, this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Scales the mat3 by the dimensions in the given vec2\n   * @param  {Vector2} v the vec2 to scale the matrix by\n   * @return {Matrix3} this\n   */\n  scale: function scale(v) {\n    gl_matrix_min[\"mat3\"].scale(this.elements, this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector translation\n   * @param  {Vector2} v Translation vector\n   * @return {Matrix3} this\n   */\n  fromTranslation: function fromTranslation(v) {\n    gl_matrix_min[\"mat3\"].fromTranslation(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a given angle\n   * @param  {Number} rad the angle to rotate the matrix by\n   * @return {Matrix3} this\n   */\n  fromRotation: function fromRotation(rad) {\n    gl_matrix_min[\"mat3\"].fromRotation(this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector scaling\n   * @param  {Vector2} v Scaling vector\n   * @return {Matrix3} this\n   */\n  fromScaling: function fromScaling(v) {\n    gl_matrix_min[\"mat3\"].fromScaling(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Calculates a 3x3 matrix from the given quaternion\n   * @param  {Quaternion} q Quaternion to create matrix from\n   * @return {Matrix3} this\n   */\n  fromQuat: function fromQuat(q) {\n    gl_matrix_min[\"mat3\"].fromQuat(this.elements, q.elements);\n    return this;\n  },\n\n  /**\n   * Calculates a 3x3 normal matrix (transpose inverse) from the 4x4 matrix\n   * @param  {Matrix4} m Mat4 to derive the normal matrix from\n   * @return {Matrix3} this\n   */\n  normalFromMat4: function normalFromMat4(m) {\n    gl_matrix_min[\"mat3\"].normalFromMat4(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Copies the upper-left 3x3 values into the given mat3.\n   * @param  {Matrix4} m the source 4x4 matrix\n   * @return {Matrix3} this\n   */\n  fromMat4: function fromMat4(m) {\n    gl_matrix_min[\"mat3\"].fromMat4(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Returns Frobenius norm of this\n   * @return {Number} Frobenius norm\n   */\n  frob: function frob() {\n    return gl_matrix_min[\"mat3\"].frob(this.elements);\n  },\n\n  /**\n   * Adds two mat3's\n   * @param {Matrix3} a\n   * @param {Matrix3} [b] 如果不传，计算 this 和 a 的和\n   * @return {Matrix4} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat3\"].add(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Subtracts matrix b from matrix a\n   * @param {Matrix3} a\n   * @param {Matrix3} [b] 如果不传，计算 this 和 a 的差\n   * @return {Matrix4} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat3\"].subtract(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n   * @param {Matrix3} a\n   * @param {Matrix3} [b] 如果不传，比较 this 和 a 是否相等\n   * @return {Boolean}\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat3\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the matrices have approximately the same elements in the same position.\n   * @param {Matrix3} a\n   * @param {Matrix3} [b] 如果不传，比较 this 和 a 是否近似相等\n   * @return {Boolean}\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat3\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * fromRotationTranslationScale\n   * @param  {Number} r rad angle\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} scaleX\n   * @param  {Number} scaleY\n   * @return {Matrix3}\n   */\n  fromRotationTranslationScale: function fromRotationTranslationScale(rotation, x, y, scaleX, scaleY) {\n    var cos = Math.cos(rotation);\n    var sin = Math.sin(rotation);\n    this.set(scaleX * cos, -scaleY * sin, 0, scaleX * sin, scaleY * cos, 0, x, y, 1);\n    return this;\n  }\n});\n/**\n * Alias for {@link Matrix3#subtract}\n * @function\n */\n\nMatrix3.prototype.sub = Matrix3.prototype.subtract;\n/**\n * Alias for {@link Matrix3#multiply}\n * @function\n */\n\nMatrix3.prototype.mul = Matrix3.prototype.multiply;\n/* harmony default export */ var math_Matrix3 = (Matrix3);\n// CONCATENATED MODULE: ./src/math/Quaternion.js\n\n\n\n\nvar tempMat3 = new math_Matrix3();\n/**\n * @class\n * @mixes EventMixin\n * @fires update 数据更新事件\n */\n\nvar Quaternion = core_Class.create(\n/** @lends Quaternion.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * 类名\n   * @type {String}\n   * @default Quaternion\n   */\n  className: 'Quaternion',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isQuaternion: true,\n\n  /**\n   * Creates a new identity quat\n   * @constructs\n   * @param  {Number} [x=0] X component\n   * @param  {Number} [y=0] Y component\n   * @param  {Number} [z=0] Z component\n   * @param  {Number} [w=1] W component\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var w = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    this.elements = gl_matrix_min[\"quat\"].fromValues(x, y, z, w);\n  },\n\n  /**\n   * Copy the values from one quat to this\n   * @param  {Quaternion} q\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  copy: function copy(q, dontFireEvent) {\n    gl_matrix_min[\"quat\"].copy(this.elements, q.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Creates a new quat initialized with values from an existing quaternion\n   * @return {Quaternion} a new quaternion\n   */\n  clone: function clone() {\n    var el = this.elements;\n    return new this.constructor(el[0], el[1], el[2], el[3]);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var el = this.elements;\n    array[offset] = el[0];\n    array[offset + 1] = el[1];\n    array[offset + 2] = el[2];\n    array[offset + 3] = el[3];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @param {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var dontFireEvent = arguments.length > 2 ? arguments[2] : undefined;\n    var el = this.elements;\n    el[0] = array[offset];\n    el[1] = array[offset + 1];\n    el[2] = array[offset + 2];\n    el[3] = array[offset + 3];\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Set the components of a quat to the given values\n   * @param {Number} x  X component\n   * @param {Number} y  Y component\n   * @param {Number} z  Z component\n   * @param {Number} w  W component\n   * @param {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  set: function set(x, y, z, w, dontFireEvent) {\n    gl_matrix_min[\"quat\"].set(this.elements, x, y, z, w);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Set this to the identity quaternion\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  identity: function identity(dontFireEvent) {\n    gl_matrix_min[\"quat\"].identity(this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Sets a quaternion to represent the shortest rotation from one\n   * vector to another.\n   * @param  {Vector3} a the initial vector\n   * @param  {Vector3} b the destination vector\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  rotationTo: function rotationTo(a, b, dontFireEvent) {\n    gl_matrix_min[\"quat\"].rotationTo(this.elements, a.elements, b.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Sets the specified quaternion with values corresponding to the given\n   * axes. Each axis is a vec3 and is expected to be unit length and\n   * perpendicular to all other specified axes.\n   *\n   * @param {Vector3} view  the vector representing the viewing direction\n   * @param {Vector3} right the vector representing the local \"right\" direction\n   * @param {Vector3} up    the vector representing the local \"up\" direction\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  setAxes: function setAxes(view, right, up, dontFireEvent) {\n    gl_matrix_min[\"quat\"].setAxes(this.elements, view.elements, right.elements, up.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Sets a quat from the given angle and rotation axis,\n   * then returns it.\n   * @param {Vector3} axis the axis around which to rotate\n   * @param {Number} rad the angle in radians\n   * @param {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  setAxisAngle: function setAxisAngle(axis, rad, dontFireEvent) {\n    gl_matrix_min[\"quat\"].setAxisAngle(this.elements, axis.elements, rad);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Gets the rotation axis and angle for a given\n   *  quaternion. If a quaternion is created with\n   *  setAxisAngle, this method will return the same\n   *  values as providied in the original parameter list\n   *  OR functionally equivalent values.\n   * Example: The quaternion formed by axis [0, 0, 1] and\n   *  angle -90 is the same as the quaternion formed by\n   *  [0, 0, 1] and 270. This method favors the latter.\n   * @param  {Vector3} out_axis  Vector receiving the axis of rotation\n   * @return {Number} Angle, in radians, of the rotation\n   */\n  getAxisAngle: function getAxisAngle(axis) {\n    return gl_matrix_min[\"quat\"].getAxisAngle(axis.elements, this.elements);\n  },\n\n  /**\n   * Adds two quat's\n   * @param {Quaternion} q\n   * @param {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  add: function add(q, dontFireEvent) {\n    gl_matrix_min[\"quat\"].add(this.elements, this.elements, q.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Multiplies two quat's\n   * @param  {Quaternion} q\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  multiply: function multiply(q, dontFireEvent) {\n    gl_matrix_min[\"quat\"].multiply(this.elements, this.elements, q.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * premultiply the quat\n   * @param  {Quaternion} q\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  premultiply: function premultiply(q, dontFireEvent) {\n    gl_matrix_min[\"quat\"].multiply(this.elements, q.elements, this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Scales a quat by a scalar number\n   * @param  {Vector3} scale the vector to scale\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  scale: function scale(_scale, dontFireEvent) {\n    gl_matrix_min[\"quat\"].scale(this.elements, this.elements, _scale);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Rotates a quaternion by the given angle about the X axis\n   * @param  {Number} rad angle (in radians) to rotate\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  rotateX: function rotateX(rad, dontFireEvent) {\n    gl_matrix_min[\"quat\"].rotateX(this.elements, this.elements, rad);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Rotates a quaternion by the given angle about the Y axis\n   * @param  {Number} rad angle (in radians) to rotate\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  rotateY: function rotateY(rad, dontFireEvent) {\n    gl_matrix_min[\"quat\"].rotateY(this.elements, this.elements, rad);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Rotates a quaternion by the given angle about the Z axis\n   * @param  {Number} rad angle (in radians) to rotate\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  rotateZ: function rotateZ(rad, dontFireEvent) {\n    gl_matrix_min[\"quat\"].rotateZ(this.elements, this.elements, rad);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates the W component of a quat from the X, Y, and Z components.\n   * Assumes that quaternion is 1 unit in length.\n   * Any existing W component will be ignored.\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @returns {Quaternion} this\n   */\n  calculateW: function calculateW(dontFireEvent) {\n    gl_matrix_min[\"quat\"].calculateW(this.elements, this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates the dot product of two quat's\n   * @param  {Quaternion} q\n   * @return {Number} dot product of two quat's\n   */\n  dot: function dot(q) {\n    return gl_matrix_min[\"quat\"].dot(this.elements, q.elements);\n  },\n\n  /**\n   * Performs a linear interpolation between two quat's\n   * @param  {Quaternion} q\n   * @param  {Number} t interpolation amount between the two inputs\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  lerp: function lerp(q, t, dontFireEvent) {\n    gl_matrix_min[\"quat\"].lerp(this.elements, this.elements, q.elements, t);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Performs a spherical linear interpolation between two quat\n   * @param  {Quaternion} q\n   * @param  {Number} t interpolation amount between the two inputs\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  slerp: function slerp(q, t, dontFireEvent) {\n    gl_matrix_min[\"quat\"].slerp(this.elements, this.elements, q.elements, t);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Performs a spherical linear interpolation with two control points\n   * @param  {Quaternion} qa\n   * @param  {Quaternion} qb\n   * @param  {Quaternion} qc\n   * @param  {Quaternion} qd\n   * @param  {Number} t interpolation amount\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  sqlerp: function sqlerp(qa, qb, qc, qd, t, dontFireEvent) {\n    gl_matrix_min[\"quat\"].sqlerp(this.elements, qa.elements, qb.elements, qc.elements, qd.elements, t);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates the inverse of a quat\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  invert: function invert(dontFireEvent) {\n    gl_matrix_min[\"quat\"].invert(this.elements, this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates the conjugate of a quat\n   * If the quaternion is normalized, this function is faster than quat.inverse and produces the same result.\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  conjugate: function conjugate(dontFireEvent) {\n    gl_matrix_min[\"quat\"].conjugate(this.elements, this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates the length of a quat\n   * @return {Number} length of this\n   */\n  length: function length() {\n    return gl_matrix_min[\"quat\"].length(this.elements);\n  },\n\n  /**\n   * Calculates the squared length of a quat\n   * @return {Number} squared length of this\n   */\n  squaredLength: function squaredLength() {\n    return gl_matrix_min[\"quat\"].squaredLength(this.elements);\n  },\n\n  /**\n   * Normalize this\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  normalize: function normalize(dontFireEvent) {\n    gl_matrix_min[\"quat\"].normalize(this.elements, this.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Creates a quaternion from the given 3x3 rotation matrix.\n   *\n   * NOTE: The resultant quaternion is not normalized, so you should be sure\n   * to renormalize the quaternion yourself where necessary.\n   *\n   * @param {Matrix3} m rotation matrix\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  fromMat3: function fromMat3(mat, dontFireEvent) {\n    gl_matrix_min[\"quat\"].fromMat3(this.elements, mat.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Creates a quaternion from the given 3x3 rotation matrix.\n   *\n   * NOTE: The resultant quaternion is not normalized, so you should be sure\n   * to renormalize the quaternion yourself where necessary.\n   *\n   * @param {Matrix4} m rotation matrix\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  fromMat4: function fromMat4(mat, dontFireEvent) {\n    tempMat3.fromMat4(mat);\n    this.fromMat3(tempMat3, dontFireEvent);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the quaternions have exactly the same elements in the same position (when compared with ===)\n   * @param  {Quaternion} q\n   * @return {Boolean}\n   */\n  exactEquals: function exactEquals(q) {\n    return gl_matrix_min[\"quat\"].exactEquals(this.elements, q.elements);\n  },\n\n  /**\n   * Returns whether or not the quaternions have approximately the same elements in the same position.\n   * @param  {Quaternion} q\n   * @return {Boolean}\n   */\n  equals: function equals(q) {\n    return gl_matrix_min[\"quat\"].equals(this.elements, q.elements);\n  },\n\n  /**\n   * Creates a quaternion from the given euler.\n   * @param  {Euler} euler\n   * @param  {Boolean} [dontFireEvent=false] wether or not don`t fire change event.\n   * @return {Quaternion} this\n   */\n  fromEuler: function fromEuler(euler, dontFireEvent) {\n    // Based on https://github.com/mrdoob/three.js/blob/dev/src/math/Quaternion.js#L200\n    // quat.fromEuler(this.elements, euler.x, euler.y, euler.z);\n    var x = euler.x * .5;\n    var y = euler.y * .5;\n    var z = euler.z * .5;\n    var order = euler.order || 'ZYX';\n    var sx = Math.sin(x);\n    var cx = Math.cos(x);\n    var sy = Math.sin(y);\n    var cy = Math.cos(y);\n    var sz = Math.sin(z);\n    var cz = Math.cos(z);\n    var out = this.elements;\n\n    if (order === 'XYZ') {\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n    } else if (order === 'YXZ') {\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n    } else if (order === 'ZXY') {\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n    } else if (order === 'ZYX') {\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n    } else if (order === 'YZX') {\n      out[0] = sx * cy * cz + cx * sy * sz;\n      out[1] = cx * sy * cz + sx * cy * sz;\n      out[2] = cx * cy * sz - sx * sy * cz;\n      out[3] = cx * cy * cz - sx * sy * sz;\n    } else if (order === 'XZY') {\n      out[0] = sx * cy * cz - cx * sy * sz;\n      out[1] = cx * sy * cz - sx * cy * sz;\n      out[2] = cx * cy * sz + sx * sy * cz;\n      out[3] = cx * cy * cz + sx * sy * sz;\n    }\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * X component\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * Y component\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * Z component\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * W component\n   * @type {Number}\n   */\n  w: {\n    get: function get() {\n      return this.elements[3];\n    },\n    set: function set(value) {\n      this.elements[3] = value;\n      this.fire('update');\n    }\n  }\n});\n/**\n * Alias for {@link Quaternion#multiply}\n * @function\n */\n\nQuaternion.prototype.mul = Quaternion.prototype.multiply;\n/**\n * Alias for {@link Quaternion#length}\n * @function\n */\n\nQuaternion.prototype.len = Quaternion.prototype.length;\n/**\n * Alias for {@link Quaternion#squaredLength}\n * @function\n */\n\nQuaternion.prototype.sqrLen = Quaternion.prototype.squaredLength;\n/* harmony default export */ var math_Quaternion = (Quaternion);\n// CONCATENATED MODULE: ./src/math/Matrix4.js\n\n\n\n\nvar tempMatrix4;\nvar tempVector3 = new math_Vector3();\nvar tempVector32 = new math_Vector3();\n/**\n * 4x4 矩阵\n * @class\n */\n\nvar Matrix4 = core_Class.create(\n/** @lends Matrix4.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Matrix4\n   */\n  className: 'Matrix4',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isMatrix4: true,\n\n  /**\n   * Creates a new identity mat4\n   * @constructs\n   */\n  constructor: function constructor() {\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"mat4\"].create();\n  },\n\n  /**\n   * Copy the values from one mat4 to this\n   * @param  {Matrix4} m the source matrix\n   * @return {Matrix4} this\n   */\n  copy: function copy(m) {\n    gl_matrix_min[\"mat4\"].copy(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Creates a new mat4 initialized with values from this matrix\n   * @return {Matrix4} a new Matrix4\n   */\n  clone: function clone() {\n    var m = new this.constructor();\n    gl_matrix_min[\"mat4\"].copy(m.elements, this.elements);\n    return m;\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n\n    for (var i = 0; i < 16; i++) {\n      array[offset + i] = elements[i];\n    }\n\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Matrix4} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n\n    for (var i = 0; i < 16; i++) {\n      elements[i] = array[offset + i];\n    }\n\n    return this;\n  },\n\n  /**\n   * Set the components of a mat3 to the given values\n   * @param {Number} m00\n   * @param {Number} m01\n   * @param {Number} m02\n   * @param {Number} m03\n   * @param {Number} m10\n   * @param {Number} m11\n   * @param {Number} m12\n   * @param {Number} m13\n   * @param {Number} m20\n   * @param {Number} m21\n   * @param {Number} m22\n   * @param {Number} m23\n   * @param {Number} m30\n   * @param {Number} m31\n   * @param {Number} m32\n   * @param {Number} m33\n   * @return {Matrix4} this\n   */\n  set: function set(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    gl_matrix_min[\"mat4\"].set(this.elements, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\n    return this;\n  },\n\n  /**\n   * Set this to the identity matrix\n   * @return {Matrix4} this\n   */\n  identity: function identity() {\n    gl_matrix_min[\"mat4\"].identity(this.elements);\n    return this;\n  },\n\n  /**\n   * Transpose the values of this\n   * @return {Matrix4} this\n   */\n  transpose: function transpose() {\n    gl_matrix_min[\"mat4\"].transpose(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * invert a matrix\n   * @param {Matrix4} [m=this]\n   * @return {Matrix4} this\n   */\n  invert: function invert() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat4\"].invert(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the adjugate of a mat4\n   * @param {Matrix4} [m=this]\n   * @return {Matrix4} this\n   */\n  adjoint: function adjoint() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat4\"].adjoint(this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the determinant of this\n   * @return {Matrix4} this\n   */\n  determinant: function determinant() {\n    return gl_matrix_min[\"mat4\"].determinant(this.elements);\n  },\n\n  /**\n   * Multiplies two matrix4's\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，计算 this 和 a 的乘积\n   * @return {Matrix4} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].multiply(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * 左乘\n   * @param {Matrix4} m\n   * @return {Matrix4} this\n   */\n  premultiply: function premultiply(m) {\n    this.multiply(m, this);\n    return this;\n  },\n\n  /**\n   * Translate this by the given vector\n   * @param {Vector3} v vector to translate by\n   * @return {Matrix4} this\n   */\n  translate: function translate(v) {\n    gl_matrix_min[\"mat4\"].translate(this.elements, this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Scales the mat3 by the dimensions in the given vec2\n   * @param {Vector3} v the vec3 to scale the matrix by\n   * @return {Matrix4} this\n   */\n  scale: function scale(v) {\n    gl_matrix_min[\"mat4\"].scale(this.elements, this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle\n   * @param {Number} rad the angle to rotate the matrix by\n   * @param {Vector3} axis the axis to rotate around\n   * @return {Matrix4} this\n   */\n  rotate: function rotate(rad, axis) {\n    gl_matrix_min[\"mat4\"].rotate(this.elements, this.elements, rad, axis.elements);\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the X axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  rotateX: function rotateX(rad) {\n    gl_matrix_min[\"mat4\"].rotateX(this.elements, this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the Y axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  rotateY: function rotateY(rad) {\n    gl_matrix_min[\"mat4\"].rotateY(this.elements, this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the Z axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  rotateZ: function rotateZ(rad) {\n    gl_matrix_min[\"mat4\"].rotateZ(this.elements, this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector translation\n   * @param {Vector3} transition Translation vector\n   * @return {Matrix4} this\n   */\n  fromTranslation: function fromTranslation(v) {\n    gl_matrix_min[\"mat4\"].fromTranslation(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector scaling\n   * @param  {Vector3} v Scaling vector\n   * @return {Matrix4} this\n   */\n  fromScaling: function fromScaling(v) {\n    gl_matrix_min[\"mat4\"].fromScaling(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a given angle around a given axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @param {Vector3} axis the axis to rotate around\n   * @return {Matrix4} this\n   */\n  fromRotation: function fromRotation(rad, axis) {\n    gl_matrix_min[\"mat4\"].fromRotation(this.elements, rad, axis.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the X axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  fromXRotation: function fromXRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromXRotation(this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the Y axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  fromYRotation: function fromYRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromYRotation(this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the Z axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4} this\n   */\n  fromZRotation: function fromZRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromZRotation(this.elements, rad);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation and vector translation\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @return {Matrix4} this\n   */\n  fromRotationTranslation: function fromRotationTranslation(q, v) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslation(this.elements, q.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Returns the translation vector component of a transformation\n   *  matrix. If a matrix is built with fromRotationTranslation,\n   *  the returned vector will be the same as the translation vector\n   *  originally supplied.\n   * @param  {Vector3} [out=new Vector3] Vector to receive translation component\n   * @return {Vector3} out\n   */\n  getTranslation: function getTranslation() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Vector3();\n    gl_matrix_min[\"mat4\"].getTranslation(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Returns the scaling factor component of a transformation\n   *  matrix. If a matrix is built with fromRotationTranslationScale\n   *  with a normalized Quaternion paramter, the returned vector will be\n   *  the same as the scaling vector\n   *  originally supplied.\n   * @param  {Vector3} [out=new Vector3] Vector to receive scaling factor component\n   * @return {Vector3} out\n   */\n  getScaling: function getScaling() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Vector3();\n    gl_matrix_min[\"mat4\"].getScaling(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Returns a quaternion representing the rotational component\n   *  of a transformation matrix. If a matrix is built with\n   *  fromRotationTranslation, the returned quaternion will be the\n   *  same as the quaternion originally supplied.\n   * @param {Quaternion} out Quaternion to receive the rotation component\n   * @return {Quaternion} out\n   */\n  getRotation: function getRotation() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Quaternion();\n    gl_matrix_min[\"mat4\"].getRotation(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation, vector translation and vector scale\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @param  {Vector3} s Scaling vector\n   * @return {Matrix4} this\n   */\n  fromRotationTranslationScale: function fromRotationTranslationScale(q, v, s) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslationScale(this.elements, q.elements, v.elements, s.elements);\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @param  {Vector3} s Scaling vector\n   * @param  {Vector3} o The origin vector around which to scale and rotate\n   * @return {Matrix4} this\n   */\n  fromRotationTranslationScaleOrigin: function fromRotationTranslationScaleOrigin(q, v, s, o) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslationScaleOrigin(this.elements, q.elements, v.elements, s.elements, o.elements);\n    return this;\n  },\n\n  /**\n   * Calculates a 4x4 matrix from the given quaternion\n   * @param {Quaternion} q Quaternion to create matrix from\n   * @return {Matrix4} this\n   */\n  fromQuat: function fromQuat(q) {\n    gl_matrix_min[\"mat4\"].fromQuat(this.elements, q.elements);\n    return this;\n  },\n\n  /**\n   * Generates a frustum matrix with the given bounds\n   * @param  {Number} left  Left bound of the frustum\n   * @param  {Number} right Right bound of the frustum\n   * @param  {Number} bottom Bottom bound of the frustum\n   * @param  {Number} top Top bound of the frustum\n   * @param  {Number} near Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4} this\n   */\n  frustum: function frustum(left, right, bottom, top, near, far) {\n    gl_matrix_min[\"mat4\"].frustum(this.elements, left, right, bottom, top, near, far);\n    return this;\n  },\n\n  /**\n   * Generates a perspective projection matrix with the given bounds\n   * @param {Number} fovy Vertical field of view in radians\n   * @param {Number} aspect Aspect ratio. typically viewport width/height\n   * @param {Number} near Near bound of the frustum\n   * @param {Number} far Far bound of the frustum\n   * @return {Matrix4} this\n   */\n  perspective: function perspective(fovy, aspect, near, far) {\n    gl_matrix_min[\"mat4\"].perspective(this.elements, fovy, aspect, near, far);\n    return this;\n  },\n\n  /**\n   * Generates a perspective projection matrix with the given field of view.\n   * @param  {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n   * @param  {Number} Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4} this\n   */\n  perspectiveFromFieldOfView: function perspectiveFromFieldOfView(fov, near, far) {\n    gl_matrix_min[\"mat4\"].perspectiveFromFieldOfView(this.elements, fov, near, far);\n    return this;\n  },\n\n  /**\n   * Generates a orthogonal projection matrix with the given bounds\n   * @param  {Number} left  Left bound of the frustum\n   * @param  {Number} right Right bound of the frustum\n   * @param  {Number} bottom Bottom bound of the frustum\n   * @param  {Number} top Top bound of the frustum\n   * @param  {Number} near Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4} this\n   */\n  ortho: function ortho(left, right, bottom, top, near, far) {\n    gl_matrix_min[\"mat4\"].ortho(this.elements, left, right, bottom, top, near, far);\n    return this;\n  },\n\n  /**\n   * Generates a look-at matrix with the given eye position, focal point, and up axis\n   * @param  {XYZObject} eye Position of the viewer\n   * @param  {XYZObject} center Point the viewer is looking at\n   * @param  {Vector3} up pointing up\n   * @return {Matrix4} this\n   */\n  lookAt: function lookAt(eye, center, up) {\n    if (!eye.isVector3) {\n      eye = tempVector3.set(eye.x, eye.y, eye.z);\n    }\n\n    if (!center.isVector3) {\n      center = tempVector32.set(center.x, center.y, center.z);\n    }\n\n    gl_matrix_min[\"mat4\"].lookAt(this.elements, eye.elements, center.elements, up.elements);\n    return this;\n  },\n\n  /**\n   * Generates a matrix that makes something look at something else.\n   * @param  {XYZObject} eye Position of the viewer\n   * @param  {XYZObject} Point the viewer is looking at\n   * @param  {Vector3} up pointing up\n   * @return {Matrix4} this\n   */\n  targetTo: function targetTo(eye, target, up) {\n    if (!eye.isVector3) {\n      eye = tempVector3.set(eye.x, eye.y, eye.z);\n    }\n\n    if (!target.isVector3) {\n      target = tempVector32.set(target.x, target.y, target.z);\n    } // mat4.targetTo(this.elements, eye.elements, target.elements, up.elements);\n\n\n    eye = eye.elements;\n    target = target.elements;\n    up = up.elements;\n    var out = this.elements;\n    var eyex = eye[0];\n    var eyey = eye[1];\n    var eyez = eye[2];\n    var upx = up[0];\n    var upy = up[1];\n    var upz = up[2];\n    var z0 = eyex - target[0];\n    var z1 = eyey - target[1];\n    var z2 = eyez - target[2];\n    var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      z0 *= len;\n      z1 *= len;\n      z2 *= len;\n    } else {\n      z2 = 1;\n    }\n\n    var x0 = upy * z2 - upz * z1;\n    var x1 = upz * z0 - upx * z2;\n    var x2 = upx * z1 - upy * z0;\n    len = x0 * x0 + x1 * x1 + x2 * x2;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      x0 *= len;\n      x1 *= len;\n      x2 *= len;\n    } else {\n      upx += 0.0000001;\n      x0 = upy * z2 - upz * z1;\n      x1 = upz * z0 - upx * z2;\n      x2 = upx * z1 - upy * z0;\n      len = x0 * x0 + x1 * x1 + x2 * x2;\n      len = 1 / Math.sqrt(len);\n      x0 *= len;\n      x1 *= len;\n      x2 *= len;\n    }\n\n    out[0] = x0;\n    out[1] = x1;\n    out[2] = x2;\n    out[3] = 0;\n    out[4] = z1 * x2 - z2 * x1;\n    out[5] = z2 * x0 - z0 * x2;\n    out[6] = z0 * x1 - z1 * x0;\n    out[7] = 0;\n    out[8] = z0;\n    out[9] = z1;\n    out[10] = z2;\n    out[11] = 0;\n    out[12] = eyex;\n    out[13] = eyey;\n    out[14] = eyez;\n    out[15] = 1;\n    return this;\n  },\n\n  /**\n   * Returns Frobenius norm of a mat4\n   * @return {Number} Frobenius norm\n   */\n  frob: function frob() {\n    return gl_matrix_min[\"mat4\"].frob(this.elements);\n  },\n\n  /**\n   * Adds two mat4's\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，计算 this 和 a 的和\n   * @return {Matrix4} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].add(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Subtracts matrix b from matrix a\n   * @param {Matrix4} a\n   * @param {Matrix4} [b]  如果不传，计算 this 和 a 的差\n   * @return {Matrix4} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].subtract(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，比较 this 和 a 是否相等\n   * @return {Boolean}\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat4\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the matrices have approximately the same elements in the same position.\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，比较 this 和 a 是否近似相等\n   * @return {Boolean}\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat4\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * compose\n   * @param  {Quaternion} q quaternion\n   * @param  {Vector3} v position\n   * @param  {Vector3} s scale\n   * @param  {Vector3} p [pivot]\n   * @return {Matrix4}  this\n   */\n  compose: function compose(q, v, s, p) {\n    if (p) {\n      this.fromRotationTranslationScaleOrigin(q, v, s, p);\n    } else {\n      this.fromRotationTranslationScale(q, v, s);\n    }\n\n    return this;\n  },\n\n  /**\n   * decompose\n   * @param  {Quaternion} q quaternion\n   * @param  {Vector3} v position\n   * @param  {Vector3} s scale\n   * @param  {Vector3} p [pivot]\n   * @return {Matrix4}  this\n   */\n  decompose: function decompose(q, v, s, p) {\n    this.getScaling(s);\n    this.getTranslation(v);\n\n    if (!tempMatrix4) {\n      tempMatrix4 = new Matrix4();\n    }\n\n    var det = this.determinant();\n    if (det < 0) s.x *= -1;\n    tempMatrix4.copy(this);\n    tempVector3.inverse(s);\n    tempMatrix4.scale(tempVector3);\n    q.fromMat4(tempMatrix4);\n\n    if (p) {\n      p.set(0, 0, 0);\n    }\n\n    return this;\n  }\n});\n/**\n * Alias for {@link Matrix4#subtract}\n * @function\n */\n\nMatrix4.prototype.sub = Matrix4.prototype.subtract;\n/**\n * Alias for {@link Matrix4#multiply}\n * @function\n */\n\nMatrix4.prototype.mul = Matrix4.prototype.multiply;\n/* harmony default export */ var math_Matrix4 = (Matrix4);\n/**\n * 含x, y, z属性的对象\n * @typedef {object} XYZObject\n * @property {Number} x\n * @property {Number} y\n * @property {Number} z\n */\n// CONCATENATED MODULE: ./src/math/Matrix4Notifier.js\n\n\n\n\n\n\nvar Matrix4Notifier_tempMatrix4;\nvar Matrix4Notifier_tempVector3 = new math_Vector3();\nvar Matrix4Notifier_tempVector32 = new math_Vector3();\n/**\n * 4x4 矩阵, 数据改变会发送事件\n * @class\n * @extends {Matrix4}\n */\n\nvar Matrix4Notifier = core_Class.create(\n/** @lends Matrix4Notifier.prototype */\n{\n  Mixes: core_EventMixin,\n  Extends: math_Matrix4,\n\n  /**\n   * 类名\n   * @type {String}\n   * @default Matrix4Notifier\n   */\n  className: 'Matrix4Notifier',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isMatrix4Notifier: true,\n\n  /**\n   * Creates a new identity mat4\n   * @constructs\n   */\n  constructor: function constructor() {\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"mat4\"].create();\n  },\n\n  /**\n   * Copy the values from one mat4 to this\n   * @param  {Matrix4} m the source matrix\n   * @return {Matrix4Notifier} this\n   */\n  copy: function copy(m) {\n    gl_matrix_min[\"mat4\"].copy(this.elements, m.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Matrix4Notifier} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n\n    for (var i = 0; i < 16; i++) {\n      elements[i] = array[offset + i];\n    }\n\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Set the components of a mat3 to the given values\n   * @param {Number} m00\n   * @param {Number} m01\n   * @param {Number} m02\n   * @param {Number} m03\n   * @param {Number} m10\n   * @param {Number} m11\n   * @param {Number} m12\n   * @param {Number} m13\n   * @param {Number} m20\n   * @param {Number} m21\n   * @param {Number} m22\n   * @param {Number} m23\n   * @param {Number} m30\n   * @param {Number} m31\n   * @param {Number} m32\n   * @param {Number} m33\n   * @return {Matrix4Notifier} this\n   */\n  set: function set(m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33) {\n    gl_matrix_min[\"mat4\"].set(this.elements, m00, m01, m02, m03, m10, m11, m12, m13, m20, m21, m22, m23, m30, m31, m32, m33);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Set this to the identity matrix\n   * @return {Matrix4Notifier} this\n   */\n  identity: function identity() {\n    gl_matrix_min[\"mat4\"].identity(this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Transpose the values of this\n   * @return {Matrix4Notifier} this\n   */\n  transpose: function transpose() {\n    gl_matrix_min[\"mat4\"].transpose(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * invert a matrix\n   * @param {Matrix4} [m=this]\n   * @return {Matrix4Notifier} this\n   */\n  invert: function invert() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat4\"].invert(this.elements, m.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Calculates the adjugate of a mat4\n   * @param {Matrix4} [m=this]\n   * @return {Matrix4Notifier} this\n   */\n  adjoint: function adjoint() {\n    var m = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this;\n    gl_matrix_min[\"mat4\"].adjoint(this.elements, m.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Calculates the determinant of this\n   * @return {Matrix4Notifier} this\n   */\n  determinant: function determinant() {\n    return gl_matrix_min[\"mat4\"].determinant(this.elements);\n  },\n\n  /**\n   * Multiplies two matrix4's\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，计算 this 和 a 的乘积\n   * @return {Matrix4Notifier} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].multiply(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * 左乘\n   * @param {Matrix4} m\n   * @return {Matrix4Notifier} this\n   */\n  premultiply: function premultiply(m) {\n    this.multiply(m, this);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Translate this by the given vector\n   * @param {Vector3} v vector to translate by\n   * @return {Matrix4Notifier} this\n   */\n  translate: function translate(v) {\n    gl_matrix_min[\"mat4\"].translate(this.elements, this.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Scales the mat3 by the dimensions in the given vec2\n   * @param {Vector3} v the vec3 to scale the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  scale: function scale(v) {\n    gl_matrix_min[\"mat4\"].scale(this.elements, this.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle\n   * @param {Number} rad the angle to rotate the matrix by\n   * @param {Vector3} axis the axis to rotate around\n   * @return {Matrix4Notifier} this\n   */\n  rotate: function rotate(rad, axis) {\n    gl_matrix_min[\"mat4\"].rotate(this.elements, this.elements, rad, axis.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the X axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  rotateX: function rotateX(rad) {\n    gl_matrix_min[\"mat4\"].rotateX(this.elements, this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the Y axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  rotateY: function rotateY(rad) {\n    gl_matrix_min[\"mat4\"].rotateY(this.elements, this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotates this by the given angle around the Z axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  rotateZ: function rotateZ(rad) {\n    gl_matrix_min[\"mat4\"].rotateZ(this.elements, this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector translation\n   * @param {Vector3} transition Translation vector\n   * @return {Matrix4Notifier} this\n   */\n  fromTranslation: function fromTranslation(v) {\n    gl_matrix_min[\"mat4\"].fromTranslation(this.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a vector scaling\n   * @param  {Vector3} v Scaling vector\n   * @return {Matrix4Notifier} this\n   */\n  fromScaling: function fromScaling(v) {\n    gl_matrix_min[\"mat4\"].fromScaling(this.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a given angle around a given axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @param {Vector3} axis the axis to rotate around\n   * @return {Matrix4Notifier} this\n   */\n  fromRotation: function fromRotation(rad, axis) {\n    gl_matrix_min[\"mat4\"].fromRotation(this.elements, rad, axis.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the X axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  fromXRotation: function fromXRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromXRotation(this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the Y axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  fromYRotation: function fromYRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromYRotation(this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from the given angle around the Z axis\n   * @param {Number} rad the angle to rotate the matrix by\n   * @return {Matrix4Notifier} this\n   */\n  fromZRotation: function fromZRotation(rad) {\n    gl_matrix_min[\"mat4\"].fromZRotation(this.elements, rad);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation and vector translation\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @return {Matrix4Notifier} this\n   */\n  fromRotationTranslation: function fromRotationTranslation(q, v) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslation(this.elements, q.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns the translation vector component of a transformation\n   *  matrix. If a matrix is built with fromRotationTranslation,\n   *  the returned vector will be the same as the translation vector\n   *  originally supplied.\n   * @param  {Vector3} [out=new Vector3] Vector to receive translation component\n   * @return {Vector3} out\n   */\n  getTranslation: function getTranslation() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Vector3();\n    gl_matrix_min[\"mat4\"].getTranslation(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Returns the scaling factor component of a transformation\n   *  matrix. If a matrix is built with fromRotationTranslationScale\n   *  with a normalized Quaternion paramter, the returned vector will be\n   *  the same as the scaling vector\n   *  originally supplied.\n   * @param  {Vector3} [out=new Vector3] Vector to receive scaling factor component\n   * @return {Vector3} out\n   */\n  getScaling: function getScaling() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Vector3();\n    gl_matrix_min[\"mat4\"].getScaling(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Returns a quaternion representing the rotational component\n   *  of a transformation matrix. If a matrix is built with\n   *  fromRotationTranslation, the returned quaternion will be the\n   *  same as the quaternion originally supplied.\n   * @param {Quaternion} out Quaternion to receive the rotation component\n   * @return {Quaternion} out\n   */\n  getRotation: function getRotation() {\n    var out = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Quaternion();\n    gl_matrix_min[\"mat4\"].getRotation(out.elements, this.elements);\n    return out;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation, vector translation and vector scale\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @param  {Vector3} s Scaling vector\n   * @return {Matrix4Notifier} this\n   */\n  fromRotationTranslationScale: function fromRotationTranslationScale(q, v, s) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslationScale(this.elements, q.elements, v.elements, s.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a matrix from a quaternion rotation, vector translation and vector scale, rotating and scaling around the given origin\n   * @param  {Quaternion} q Rotation quaternion\n   * @param  {Vector3} v Translation vector\n   * @param  {Vector3} s Scaling vector\n   * @param  {Vector3} o The origin vector around which to scale and rotate\n   * @param  {Boolean} [dontFireEvent=false] dontFireEvent\n   * @return {Matrix4Notifier} this\n   */\n  fromRotationTranslationScaleOrigin: function fromRotationTranslationScaleOrigin(q, v, s, o, dontFireEvent) {\n    gl_matrix_min[\"mat4\"].fromRotationTranslationScaleOrigin(this.elements, q.elements, v.elements, s.elements, o.elements);\n\n    if (!dontFireEvent) {\n      this.fire('update');\n    }\n\n    return this;\n  },\n\n  /**\n   * Calculates a 4x4 matrix from the given quaternion\n   * @param {Quaternion} q Quaternion to create matrix from\n   * @return {Matrix4Notifier} this\n   */\n  fromQuat: function fromQuat(q) {\n    gl_matrix_min[\"mat4\"].fromQuat(this.elements, q.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a frustum matrix with the given bounds\n   * @param  {Number} left  Left bound of the frustum\n   * @param  {Number} right Right bound of the frustum\n   * @param  {Number} bottom Bottom bound of the frustum\n   * @param  {Number} top Top bound of the frustum\n   * @param  {Number} near Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4Notifier} this\n   */\n  frustum: function frustum(left, right, bottom, top, near, far) {\n    gl_matrix_min[\"mat4\"].frustum(this.elements, left, right, bottom, top, near, far);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a perspective projection matrix with the given bounds\n   * @param {Number} fovy Vertical field of view in radians\n   * @param {Number} aspect Aspect ratio. typically viewport width/height\n   * @param {Number} near Near bound of the frustum\n   * @param {Number} far Far bound of the frustum\n   * @return {Matrix4Notifier} this\n   */\n  perspective: function perspective(fovy, aspect, near, far) {\n    gl_matrix_min[\"mat4\"].perspective(this.elements, fovy, aspect, near, far);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a perspective projection matrix with the given field of view.\n   * @param  {Object} fov Object containing the following values: upDegrees, downDegrees, leftDegrees, rightDegrees\n   * @param  {Number} Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4Notifier} this\n   */\n  perspectiveFromFieldOfView: function perspectiveFromFieldOfView(fov, near, far) {\n    gl_matrix_min[\"mat4\"].perspectiveFromFieldOfView(this.elements, fov, near, far);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a orthogonal projection matrix with the given bounds\n   * @param  {Number} left  Left bound of the frustum\n   * @param  {Number} right Right bound of the frustum\n   * @param  {Number} bottom Bottom bound of the frustum\n   * @param  {Number} top Top bound of the frustum\n   * @param  {Number} near Near bound of the frustum\n   * @param  {Number} far Far bound of the frustum\n   * @return {Matrix4Notifier} this\n   */\n  ortho: function ortho(left, right, bottom, top, near, far) {\n    gl_matrix_min[\"mat4\"].ortho(this.elements, left, right, bottom, top, near, far);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a look-at matrix with the given eye position, focal point, and up axis\n   * @param  {XYZObject} eye Position of the viewer\n   * @param  {XYZObject} center Point the viewer is looking at\n   * @param  {Vector3} up pointing up\n   * @return {Matrix4Notifier} this\n   */\n  lookAt: function lookAt(eye, center, up) {\n    if (!eye.isVector3) {\n      eye = Matrix4Notifier_tempVector3.set(eye.x, eye.y, eye.z);\n    }\n\n    if (!center.isVector3) {\n      center = Matrix4Notifier_tempVector32.set(center.x, center.y, center.z);\n    }\n\n    gl_matrix_min[\"mat4\"].lookAt(this.elements, eye.elements, center.elements, up.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a matrix that makes something look at something else.\n   * @param  {XYZObject} eye Position of the viewer\n   * @param  {XYZObject} Point the viewer is looking at\n   * @param  {Vector3} up pointing up\n   * @return {Matrix4Notifier} this\n   */\n  targetTo: function targetTo(eye, target, up) {\n    if (!eye.isVector3) {\n      eye = Matrix4Notifier_tempVector3.set(eye.x, eye.y, eye.z);\n    }\n\n    if (!target.isVector3) {\n      target = Matrix4Notifier_tempVector32.set(target.x, target.y, target.z);\n    } // mat4.targetTo(this.elements, eye.elements, target.elements, up.elements);\n\n\n    eye = eye.elements;\n    target = target.elements;\n    up = up.elements;\n    var out = this.elements;\n    var eyex = eye[0];\n    var eyey = eye[1];\n    var eyez = eye[2];\n    var upx = up[0];\n    var upy = up[1];\n    var upz = up[2];\n    var z0 = eyex - target[0];\n    var z1 = eyey - target[1];\n    var z2 = eyez - target[2];\n    var len = z0 * z0 + z1 * z1 + z2 * z2;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      z0 *= len;\n      z1 *= len;\n      z2 *= len;\n    } else {\n      z2 = 1;\n    }\n\n    var x0 = upy * z2 - upz * z1;\n    var x1 = upz * z0 - upx * z2;\n    var x2 = upx * z1 - upy * z0;\n    len = x0 * x0 + x1 * x1 + x2 * x2;\n\n    if (len > 0) {\n      len = 1 / Math.sqrt(len);\n      x0 *= len;\n      x1 *= len;\n      x2 *= len;\n    } else {\n      upx += 0.0000001;\n      x0 = upy * z2 - upz * z1;\n      x1 = upz * z0 - upx * z2;\n      x2 = upx * z1 - upy * z0;\n      len = x0 * x0 + x1 * x1 + x2 * x2;\n      len = 1 / Math.sqrt(len);\n      x0 *= len;\n      x1 *= len;\n      x2 *= len;\n    }\n\n    out[0] = x0;\n    out[1] = x1;\n    out[2] = x2;\n    out[3] = 0;\n    out[4] = z1 * x2 - z2 * x1;\n    out[5] = z2 * x0 - z0 * x2;\n    out[6] = z0 * x1 - z1 * x0;\n    out[7] = 0;\n    out[8] = z0;\n    out[9] = z1;\n    out[10] = z2;\n    out[11] = 0;\n    out[12] = eyex;\n    out[13] = eyey;\n    out[14] = eyez;\n    out[15] = 1;\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns Frobenius norm of a mat4\n   * @return {Number} Frobenius norm\n   */\n  frob: function frob() {\n    return gl_matrix_min[\"mat4\"].frob(this.elements);\n  },\n\n  /**\n   * Adds two mat4's\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，计算 this 和 a 的和\n   * @return {Matrix4} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].add(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Subtracts matrix b from matrix a\n   * @param {Matrix4} a\n   * @param {Matrix4} [b]  如果不传，计算 this 和 a 的差\n   * @return {Matrix4} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"mat4\"].subtract(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns whether or not the matrices have exactly the same elements in the same position (when compared with ===)\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，比较 this 和 a 是否相等\n   * @return {Boolean}\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat4\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the matrices have approximately the same elements in the same position.\n   * @param {Matrix4} a\n   * @param {Matrix4} [b] 如果不传，比较 this 和 a 是否近似相等\n   * @return {Boolean}\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"mat4\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * compose\n   * @param  {Quaternion} q quaternion\n   * @param  {Vector3} v position\n   * @param  {Vector3} s scale\n   * @param  {Vector3} p [pivot]\n   * @return {Matrix4Notifier}  this\n   */\n  compose: function compose(q, v, s, p) {\n    if (p) {\n      this.fromRotationTranslationScaleOrigin(q, v, s, p);\n    } else {\n      this.fromRotationTranslationScale(q, v, s);\n    }\n\n    return this;\n  },\n\n  /**\n   * decompose\n   * @param  {Quaternion} q quaternion\n   * @param  {Vector3} v position\n   * @param  {Vector3} s scale\n   * @param  {Vector3} p [pivot]\n   * @return {Matrix4Notifier}  this\n   */\n  decompose: function decompose(q, v, s, p) {\n    this.getScaling(s);\n    this.getTranslation(v);\n\n    if (!Matrix4Notifier_tempMatrix4) {\n      Matrix4Notifier_tempMatrix4 = new math_Matrix4();\n    }\n\n    var det = this.determinant();\n    if (det < 0) s.x *= -1;\n    Matrix4Notifier_tempMatrix4.copy(this);\n    Matrix4Notifier_tempVector3.inverse(s);\n    Matrix4Notifier_tempMatrix4.scale(Matrix4Notifier_tempVector3);\n    q.fromMat4(Matrix4Notifier_tempMatrix4);\n\n    if (p) {\n      p.set(0, 0, 0);\n    }\n\n    return this;\n  }\n});\n/* harmony default export */ var math_Matrix4Notifier = (Matrix4Notifier);\n// CONCATENATED MODULE: ./src/math/Vector3Notifier.js\n\n\n\n\n/**\n * 三维向量, 数据改变会发送事件\n * @class\n * @mixes EventMixin\n * @extends Vector3\n * @fires update 数据更新事件\n */\n\nvar Vector3Notifier = core_Class.create(\n/** @lends Vector3Notifier.prototype */\n{\n  Mixes: core_EventMixin,\n  Extends: math_Vector3,\n\n  /**\n   * 类名  notify\n   * @type {String}\n   * @default Vector3Notifier\n   */\n  className: 'Vector3Notifier',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isVector3Notifier: true,\n\n  /**\n   * Creates a new empty vec3\n   * @param {Number} [x=0] X component\n   * @param {Number} [y=0] Y component\n   * @param {Number} [z=0] Z component\n   * @constructs\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"vec3\"].fromValues(x, y, z);\n  },\n\n  /**\n   * Copy the values from one vec3 to this\n   * @param  {Vector3} m the source vector\n   * @return {Vector3} this\n   */\n  copy: function copy(v) {\n    gl_matrix_min[\"vec3\"].copy(this.elements, v.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Creates a new vec3 initialized with values from this vec3\n   * @return {Vector3} a new Vector3\n   */\n  clone: function clone() {\n    var elements = this.elements;\n    return new this.constructor(elements[0], elements[1], elements[2]);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    array[0 + offset] = elements[0];\n    array[1 + offset] = elements[1];\n    array[2 + offset] = elements[2];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Vector3} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    elements[0] = array[offset + 0];\n    elements[1] = array[offset + 1];\n    elements[2] = array[offset + 2];\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Set the components of a vec3 to the given values\n   * @param {Number} x X component\n   * @param {Number} y Y component\n   * @param {Number} z Z component\n   * @returns {Vector3Notifier} this\n   */\n  set: function set(x, y, z) {\n    gl_matrix_min[\"vec3\"].set(this.elements, x, y, z);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Adds two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的和\n   * @returns {Vector3Notifier} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].add(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Subtracts vector b from vector a\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的差\n   * @returns {Vector3Notifier} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].subtract(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Multiplies two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的积\n   * @returns {Vector3Notifier} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].multiply(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Divides two vec3's\n   * @param {Vector3} a\n   * @param {Vector3} [b] 如果不传，计算 this 和 a 的商\n   * @returns {Vector3Notifier} this\n   */\n  divide: function divide(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].divide(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Math.ceil the components of this\n   * @returns {Vector3Notifier} this\n   */\n  ceil: function ceil() {\n    gl_matrix_min[\"vec3\"].ceil(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Math.floor the components of this\n   * @returns {Vector3Notifier} this\n   */\n  floor: function floor() {\n    gl_matrix_min[\"vec3\"].floor(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns the minimum of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector3Notifier} this\n   */\n  min: function min(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].min(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns the maximum of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b]  如果不传，计算 this 和 a 的结果\n   * @returns {Vector3Notifier} this\n   */\n  max: function max(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].max(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Math.round the components of this\n   * @returns {Vector3Notifier} this\n   */\n  round: function round() {\n    gl_matrix_min[\"vec3\"].round(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Scales this by a scalar number\n   * @param  {Number} scale amount to scale the vector by\n   * @returns {Vector3Notifier} this\n   */\n  scale: function scale(_scale) {\n    gl_matrix_min[\"vec3\"].scale(this.elements, this.elements, _scale);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Adds two vec3's after scaling the second vector by a scalar value\n   * @param  {Number} scale the amount to scale the second vector by before adding\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector3Notifier} this\n   */\n  scaleAndAdd: function scaleAndAdd(scale, a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].scaleAndAdd(this.elements, a.elements, b.elements, scale);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Calculates the euclidian distance between two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} distance between a and b\n   */\n  distance: function distance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].distance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the squared euclidian distance between two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} squared distance between a and b\n   */\n  squaredDistance: function squaredDistance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].squaredDistance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the length of this\n   * @return {Number} length of this\n   */\n  length: function length() {\n    return gl_matrix_min[\"vec3\"].length(this.elements);\n  },\n\n  /**\n   * Calculates the squared length of this\n   * @return {Number} squared length of this\n   */\n  squaredLength: function squaredLength() {\n    return gl_matrix_min[\"vec3\"].squaredLength(this.elements);\n  },\n\n  /**\n   * Negates the components of this\n   * @returns {Vector3Notifier} this\n   */\n  negate: function negate() {\n    gl_matrix_min[\"vec3\"].negate(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns the inverse of the components of a vec3\n   * @param  {Vector3} [a=this]\n   * @returns {Vector3Notifier} this\n   */\n  inverse: function inverse(a) {\n    if (!a) {\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].inverse(this.elements, a.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Normalize this\n   * @returns {Vector3Notifier} this\n   */\n  normalize: function normalize() {\n    gl_matrix_min[\"vec3\"].normalize(this.elements, this.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Calculates the dot product of two vec3's\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  product of a and b\n   */\n  dot: function dot(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].dot(a.elements, b.elements);\n  },\n\n  /**\n   * Computes the cross product of two vec3's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  cross product of a and b\n   */\n  cross: function cross(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec3\"].cross(this.elements, a.elements, b.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Performs a linear interpolation between two vec3's\n   * @param  {Vector3} v\n   * @param  {Number} t interpolation amount between the two vectors\n   * @returns {Vector3Notifier} this\n   */\n  lerp: function lerp(v, t) {\n    gl_matrix_min[\"vec3\"].lerp(this.elements, this.elements, v.elements, t);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Performs a hermite interpolation with two control points\n   * @param  {Vector3} a\n   * @param  {Vector3} b\n   * @param  {Vector3} c\n   * @param  {Vector3} d\n   * @param  {Number} t interpolation amount between the two inputs\n   * @return {Vector3} this\n   */\n  hermite: function hermite(a, b, c, d, t) {\n    gl_matrix_min[\"vec3\"].hermite(this.elements, a.elements, b.elements, c.elements, d.elements, t);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Performs a bezier interpolation with two control points\n   * @param  {Vector3} a\n   * @param  {Vector3} b\n   * @param  {Vector3} c\n   * @param  {Vector3} d\n   * @param  {Number} t interpolation amount between the two inputs\n   * @return {Vector3} this\n   */\n  bezier: function bezier(a, b, c, d, t) {\n    gl_matrix_min[\"vec3\"].bezier(this.elements, a.elements, b.elements, c.elements, d.elements, t);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Generates a random vector with the given scale\n   * @param  {Number} [scale=1] Length of the resulting vector. If ommitted, a unit vector will be returned\n   * @returns {Vector3Notifier} this\n   */\n  random: function random(scale) {\n    gl_matrix_min[\"vec3\"].random(this.elements, scale);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a mat3\n   * @param  {Matrix3} m matrix to transform with\n   * @returns {Vector3Notifier} this\n   */\n  transformMat3: function transformMat3(m) {\n    gl_matrix_min[\"vec3\"].transformMat3(this.elements, this.elements, m.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector3Notifier} this\n   */\n  transformMat4: function transformMat4(m) {\n    gl_matrix_min[\"vec3\"].transformMat4(this.elements, this.elements, m.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 direction with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector3Notifier} this\n   */\n  transformDirection: function transformDirection(m) {\n    var elements = this.elements;\n    var mElements = m.elements;\n    var x = elements[0];\n    var y = elements[1];\n    var z = elements[2];\n    elements[0] = x * mElements[0] + y * mElements[4] + z * mElements[8];\n    elements[1] = x * mElements[1] + y * mElements[5] + z * mElements[9];\n    elements[2] = x * mElements[2] + y * mElements[6] + z * mElements[10];\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Transforms the vec3 with a quat\n   * @param  {Quaternion} q quaternion to transform with\n   * @returns {Vector3Notifier} this\n   */\n  transformQuat: function transformQuat(q) {\n    gl_matrix_min[\"vec3\"].transformQuat(this.elements, this.elements, q.elements);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the x-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateX: function rotateX(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateX(this.elements, this.elements, origin.elements, rotation);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the y-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateY: function rotateY(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateY(this.elements, this.elements, origin.elements, rotation);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Rotate this 3D vector around the z-axis\n   * @param  {Vector3} origin The origin of the rotation\n   * @param  {Number} rotation The angle of rotation\n   * @return {Vector3} this\n   */\n  rotateZ: function rotateZ(origin, rotation) {\n    gl_matrix_min[\"vec3\"].rotateZ(this.elements, this.elements, origin.elements, rotation);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the vectors have approximately the same elements in the same position.\n   * @param  {Vector3} a\n   * @param  {Vector3} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec3\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * X component\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * Y component\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * Z component\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n      this.fire('update');\n    }\n  }\n});\n/* harmony default export */ var math_Vector3Notifier = (Vector3Notifier);\n// CONCATENATED MODULE: ./src/math/math.js\n/**\n * @namespace math\n * @type {Object}\n */\nvar math = {\n  /**\n   * 角度值转弧度值\n   * @type {Number}\n   */\n  DEG2RAD: Math.PI / 180,\n\n  /**\n   * 弧度值转角度值\n   * @type {Number}\n   */\n  RAD2DEG: 180 / Math.PI,\n\n  /**\n   * 生成唯一ID\n   * @function\n   * @param  {String} [prefix=''] ID前缀\n   * @return {String} ID\n   */\n  generateUUID: function () {\n    var uid = 0;\n    return function (prefix) {\n      var id = ++uid;\n\n      if (prefix) {\n        id = prefix + '_' + id;\n      } else {\n        id += '';\n      }\n\n      return id;\n    };\n  }(),\n\n  /**\n   * 截取\n   * @param  {Number} value 值\n   * @param  {Number} min 最小值\n   * @param  {Number} max 最大值\n   * @return {Number}\n   */\n  clamp: function clamp(value, min, max) {\n    return Math.max(min, Math.min(max, value));\n  },\n\n  /**\n   * 角度值转换成弧度值\n   * @param  {Number} deg 角度值\n   * @return {Number} 弧度值\n   */\n  degToRad: function degToRad(deg) {\n    return deg * this.DEG2RAD;\n  },\n\n  /**\n   * 弧度值转换成角度值\n   * @param  {Number} rad 弧度值\n   * @return {Number} 角度值\n   */\n  radToDeg: function radToDeg(rad) {\n    return rad * this.RAD2DEG;\n  },\n\n  /**\n   * 是否是 2 的指数值\n   * @param  {Number}  value\n   * @return {Boolean}\n   */\n  isPowerOfTwo: function isPowerOfTwo(value) {\n    return (value & value - 1) === 0 && value !== 0;\n  },\n\n  /**\n   * 最近的 2 的指数值\n   * @param  {Number} value\n   * @return {Number}\n   */\n  nearestPowerOfTwo: function nearestPowerOfTwo(value) {\n    return Math.pow(2, Math.round(Math.log(value) / Math.LN2));\n  },\n\n  /**\n   * 下一个的 2 的指数值\n   * @param  {Number} value\n   * @return {Number}\n   */\n  nextPowerOfTwo: function nextPowerOfTwo(value) {\n    value--;\n    value |= value >> 1;\n    value |= value >> 2;\n    value |= value >> 4;\n    value |= value >> 8;\n    value |= value >> 16;\n    value++;\n    return value;\n  }\n};\n/* harmony default export */ var math_math = (math);\n// CONCATENATED MODULE: ./src/math/Euler.js\n\n\n\n\nvar tempMatrix = new math_Matrix4();\nvar DEG2RAD = math_math.DEG2RAD;\nvar RAD2DEG = math_math.RAD2DEG;\n/**\n * @class\n */\n\nvar Euler = core_Class.create(\n/** @lends Euler.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Euler\n   */\n  className: 'Euler',\n\n  /**\n   * @type {boolean}\n   * @default true\n   */\n  isEuler: true,\n\n  /**\n   * 旋转顺序，默认为 ZYX\n   * @type {string}\n   * @default 'ZYX'\n   */\n  order: 'ZYX',\n\n  /**\n   * @constructs\n   * @param  {Number} [x=0]  角度 X, 弧度制\n   * @param  {Number} [y=0]  角度 Y, 弧度制\n   * @param  {Number} [z=0]  角度 Z, 弧度制\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    this.elements = new Float32Array([x, y, z]);\n    this.updateDegrees();\n  },\n\n  /**\n   * 克隆\n   * @return {Euler}\n   */\n  clone: function clone() {\n    var euler = new this.constructor();\n    euler.copy(this);\n    return euler;\n  },\n\n  /**\n   * 复制\n   * @param  {Euler} euler\n   * @return {Euler} this\n   */\n  copy: function copy(euler) {\n    this.elements[0] = euler.x;\n    this.elements[1] = euler.y;\n    this.elements[2] = euler.z;\n    this.order = euler.order;\n    this.updateDegrees();\n    return this;\n  },\n\n  /**\n   * Set the components of a euler to the given values\n   * @param {Number} x x 轴旋转角度, 弧度制\n   * @param {Number} y y 轴旋转角度, 弧度制\n   * @param {Number} z z 轴旋转角度, 弧度制\n   * @return {Euler} this\n   */\n  set: function set(x, y, z) {\n    this.elements[0] = x;\n    this.elements[1] = y;\n    this.elements[2] = z;\n    this.updateDegrees();\n    return this;\n  },\n\n  /**\n   * 设置角度\n   * @param {Number} degX x 轴旋转角度, 角度制\n   * @param {Number} degY y 轴旋转角度, 角度制\n   * @param {Number} degZ z 轴旋转角度, 角度制\n   * @return {Euler} this\n   */\n  setDegree: function setDegree(degX, degY, degZ) {\n    this._degX = degX;\n    this._degY = degY;\n    this._degZ = degZ;\n    this.updateRadians();\n    return this;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Euler} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    this.elements[0] = array[offset];\n    this.elements[1] = array[offset + 1];\n    this.elements[2] = array[offset + 2];\n    this.updateDegrees();\n    return this;\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    array[offset] = this.elements[0];\n    array[offset + 1] = this.elements[0 + 1];\n    array[offset + 2] = this.elements[0 + 2];\n    return array;\n  },\n\n  /**\n   * Creates a euler from the given 4x4 rotation matrix.\n   * @param {Matrix4} mat rotation matrix\n   * @param {string} [order=this.order] 旋转顺序，默认为当前Euler实例的order\n   * @return {Euler} this\n   */\n  fromMat4: function fromMat4(mat, order) {\n    // Based on https://github.com/mrdoob/three.js/blob/dev/src/math/Euler.js#L133\n    var elements = mat.elements;\n    var m11 = elements[0];\n    var m21 = elements[1];\n    var m31 = elements[2];\n    var m12 = elements[4];\n    var m22 = elements[5];\n    var m32 = elements[6];\n    var m13 = elements[8];\n    var m23 = elements[9];\n    var m33 = elements[10];\n    order = order || this.order;\n    this.order = order;\n    var clamp = math_math.clamp;\n\n    if (order === 'XYZ') {\n      this.elements[1] = Math.asin(clamp(m13, -1, 1));\n\n      if (Math.abs(m13) < 0.99999) {\n        this.elements[0] = Math.atan2(-m23, m33);\n        this.elements[2] = Math.atan2(-m12, m11);\n      } else {\n        this.elements[0] = Math.atan2(m32, m22);\n        this.elements[2] = 0;\n      }\n    } else if (order === 'YXZ') {\n      this.elements[0] = Math.asin(-clamp(m23, -1, 1));\n\n      if (Math.abs(m23) < 0.99999) {\n        this.elements[1] = Math.atan2(m13, m33);\n        this.elements[2] = Math.atan2(m21, m22);\n      } else {\n        this.elements[1] = Math.atan2(-m31, m11);\n        this.elements[2] = 0;\n      }\n    } else if (order === 'ZXY') {\n      this.elements[0] = Math.asin(clamp(m32, -1, 1));\n\n      if (Math.abs(m32) < 0.99999) {\n        this.elements[1] = Math.atan2(-m31, m33);\n        this.elements[2] = Math.atan2(-m12, m22);\n      } else {\n        this.elements[1] = 0;\n        this.elements[2] = Math.atan2(m21, m11);\n      }\n    } else if (order === 'ZYX') {\n      this.elements[1] = Math.asin(-clamp(m31, -1, 1));\n\n      if (Math.abs(m31) < 0.99999) {\n        this.elements[0] = Math.atan2(m32, m33);\n        this.elements[2] = Math.atan2(m21, m11);\n      } else {\n        this.elements[0] = 0;\n        this.elements[2] = Math.atan2(-m12, m22);\n      }\n    } else if (order === 'YZX') {\n      this.elements[2] = Math.asin(clamp(m21, -1, 1));\n\n      if (Math.abs(m21) < 0.99999) {\n        this.elements[0] = Math.atan2(-m23, m22);\n        this.elements[1] = Math.atan2(-m31, m11);\n      } else {\n        this.elements[0] = 0;\n        this.elements[1] = Math.atan2(m13, m33);\n      }\n    } else if (order === 'XZY') {\n      this.elements[2] = Math.asin(-clamp(m12, -1, 1));\n\n      if (Math.abs(m12) < 0.99999) {\n        this.elements[0] = Math.atan2(m32, m22);\n        this.elements[1] = Math.atan2(m13, m11);\n      } else {\n        this.elements[0] = Math.atan2(-m23, m33);\n        this.elements[1] = 0;\n      }\n    } else {\n      utils_log.warn('Euler fromMat4() unsupported order: ' + order);\n    }\n\n    this.updateDegrees();\n    return this;\n  },\n\n  /**\n   * Creates a euler from the given quat.\n   * @param  {Quaternion} quat\n   * @param  {String} [order=this.order] 旋转顺序，默认为当前Euler实例的order\n   * @return {Euler} this\n   */\n  fromQuat: function fromQuat(quat, order) {\n    tempMatrix.fromQuat(quat);\n    return this.fromMat4(tempMatrix, order);\n  },\n  updateDegrees: function updateDegrees() {\n    this._degX = this.elements[0] * RAD2DEG;\n    this._degY = this.elements[1] * RAD2DEG;\n    this._degZ = this.elements[2] * RAD2DEG;\n    return this;\n  },\n  updateRadians: function updateRadians() {\n    this.elements[0] = this._degX * DEG2RAD;\n    this.elements[1] = this._degY * DEG2RAD;\n    this.elements[2] = this._degZ * DEG2RAD;\n    return this;\n  },\n\n  /**\n   * 角度 X, 角度制\n   * @type {Number}\n   */\n  degX: {\n    get: function get() {\n      return this._degX;\n    },\n    set: function set(value) {\n      this._degX = value;\n      this.elements[0] = value * DEG2RAD;\n    }\n  },\n\n  /**\n   * 角度 Y, 角度制\n   * @type {Number}\n   */\n  degY: {\n    get: function get() {\n      return this._degY;\n    },\n    set: function set(value) {\n      this._degY = value;\n      this.elements[1] = value * DEG2RAD;\n    }\n  },\n\n  /**\n   * 角度 Z, 角度制\n   * @type {Number}\n   */\n  degZ: {\n    get: function get() {\n      return this._degZ;\n    },\n    set: function set(value) {\n      this._degZ = value;\n      this.elements[2] = value * DEG2RAD;\n    }\n  },\n\n  /**\n   * 角度 X, 弧度制\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n      this._degX = value * RAD2DEG;\n    }\n  },\n\n  /**\n   * 角度 Y, 弧度制\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n      this._degY = value * RAD2DEG;\n    }\n  },\n\n  /**\n   * 角度 Z, 弧度制\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n      this._degZ = value * RAD2DEG;\n    }\n  }\n});\n/* harmony default export */ var math_Euler = (Euler);\n// CONCATENATED MODULE: ./src/math/EulerNotifier.js\n\n\n\n\nvar EulerNotifier_DEG2RAD = math_math.DEG2RAD;\nvar EulerNotifier_RAD2DEG = math_math.RAD2DEG;\n/**\n * 欧拉角, 数据改变会发送事件\n * @class\n * @mixes EventMixin\n * @extends Euler\n * @fires update 数据更新事件\n */\n\nvar EulerNotifier = core_Class.create(\n/** @lends EulerNotifier.prototype */\n{\n  Mixes: core_EventMixin,\n  Extends: math_Euler,\n\n  /**\n   * 类名\n   * @type {String}\n   * @default EulerNotifier\n   */\n  className: 'EulerNotifier',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isEulerNotifier: true,\n\n  /**\n   * @constructs\n   * @param  {Number} [x=0]  角度 X, 弧度制\n   * @param  {Number} [y=0]  角度 Y, 弧度制\n   * @param  {Number} [z=0]  角度 Z, 弧度制\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    math_Euler.call(this, x, y, z);\n  },\n  updateDegrees: function updateDegrees() {\n    EulerNotifier.superclass.updateDegrees.call(this);\n    this.fire('update');\n    return this;\n  },\n  updateRadians: function updateRadians() {\n    EulerNotifier.superclass.updateRadians.call(this);\n    this.fire('update');\n    return this;\n  },\n\n  /**\n   * 角度 X, 角度制\n   * @type {Number}\n   */\n  degX: {\n    get: function get() {\n      return this._degX;\n    },\n    set: function set(value) {\n      this._degX = value;\n      this.elements[0] = value * EulerNotifier_DEG2RAD;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * 角度 Y, 角度制\n   * @type {Number}\n   */\n  degY: {\n    get: function get() {\n      return this._degY;\n    },\n    set: function set(value) {\n      this._degY = value;\n      this.elements[1] = value * EulerNotifier_DEG2RAD;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * 角度 Z, 角度制\n   * @type {Number}\n   */\n  degZ: {\n    get: function get() {\n      return this._degZ;\n    },\n    set: function set(value) {\n      this._degZ = value;\n      this.elements[2] = value * EulerNotifier_DEG2RAD;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * 角度 X, 弧度制\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n      this._degX = value * EulerNotifier_RAD2DEG;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * 角度 Y, 弧度制\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n      this._degY = value * EulerNotifier_RAD2DEG;\n      this.fire('update');\n    }\n  },\n\n  /**\n   * 角度 Z, 弧度制\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n      this._degZ = value * EulerNotifier_RAD2DEG;\n      this.fire('update');\n    }\n  }\n});\n/* harmony default export */ var math_EulerNotifier = (EulerNotifier);\n// CONCATENATED MODULE: ./src/core/Node.js\n\n\n\n\n\n\n\n\n\n\nvar defaultUp = new math_Vector3(0, 1, 0);\nvar Node_tempMatrix4 = new math_Matrix4();\nvar TRAVERSE_STOP_NONE = false;\nvar TRAVERSE_STOP_CHILDREN = 1;\nvar TRAVERSE_STOP_ALL = true;\n/**\n * 节点，3D场景中的元素，是大部分类的基类\n * @class\n * @mixes EventMixin\n * @example\n * const node = new Hilo3d.Node({\n *     name:'test',\n *     x:100,\n *     rotationX:30,\n *     onUpdate(){\n *         this.rotationY ++;\n *     }\n * });\n * node.scaleX = 0.3;\n * stage.addChild(node);\n */\n\nvar Node = core_Class.create(\n/** @lends Node.prototype */\n{\n  Statics: {\n    /**\n     * traverse callback 返回值，执行后不暂停 traverse\n     * @memberOf Node\n     * @type {any}\n     */\n    TRAVERSE_STOP_NONE: TRAVERSE_STOP_NONE,\n\n    /**\n     * traverse callback 返回值，执行后暂停子元素 traverse\n     * @memberOf Node\n     * @type {any}\n     */\n    TRAVERSE_STOP_CHILDREN: TRAVERSE_STOP_CHILDREN,\n\n    /**\n     * traverse callback 返回值，执行后暂停所有 traverse\n     * @memberOf Node\n     * @type {any}\n     */\n    TRAVERSE_STOP_ALL: TRAVERSE_STOP_ALL\n  },\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isNode: true,\n\n  /**\n   * @default Node\n   * @type {string}\n   */\n  className: 'Node',\n\n  /**\n   * Node 的名字，可以通过 getChildByName 查找\n   * @type {string}\n   */\n  name: '',\n\n  /**\n   * 动画\n   * @type {Animation}\n   * @default null\n   */\n  anim: null,\n\n  /**\n   * animation 查找 id\n   * @type {String}\n   * @default ''\n   */\n  animationId: '',\n\n  /**\n   * 骨骼名称\n   * @type {String}\n   * @default ''\n   */\n  jointName: '',\n\n  /**\n   * 是否自动更新世界矩阵\n   * @default true\n   * @type {boolean}\n   */\n  autoUpdateWorldMatrix: true,\n\n  /**\n   * 是否自动更新子元素世界矩阵\n   * @default true\n   * @type {boolean}\n   */\n  autoUpdateChildWorldMatrix: true,\n\n  /**\n   * 父节点\n   * @default null\n   * @type {Node}\n   */\n  parent: null,\n  _quatDirty: false,\n  _matrixDirty: false,\n\n  /**\n   * 每次更新的时候是否调用子节点的 onUpdate 方法\n   * @default true\n   * @type {boolean}\n   */\n  needCallChildUpdate: true,\n\n  /**\n   * 节点是否显示\n   * @default true\n   * @type {boolean}\n   */\n  visible: true,\n\n  /**\n   * 可视对象是否接受交互事件。默认为接受交互事件，即true。\n   * @default true\n   * @type {Boolean}\n   */\n  pointerEnabled: true,\n\n  /**\n   * 子元素是否接受交互事件。\n   * @default true\n   * @type {Boolean}\n   */\n  pointerChildren: true,\n\n  /**\n   * 是否用鼠标指针\n   * @default false\n   * @type {Boolean}\n   */\n  useHandCursor: false,\n\n  /**\n   * 是否强制使用父元素 worldMatrix，供高级开发者使用\n   * @private\n   * @type {Boolean}\n   */\n  __forceUseParentWorldMatrix: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    var _this = this;\n\n    /**\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * 元素的up向量\n     * @type {Vector3}\n     */\n\n    this.up = defaultUp.clone();\n    /**\n     * 元素直接点数组\n     * @type {Node[]}\n     */\n\n    this.children = [];\n    /**\n     * 元素的世界矩阵\n     * @type {Matrix4}\n     */\n\n    this.worldMatrix = new math_Matrix4();\n    this._matrix = new math_Matrix4Notifier();\n    this._position = new math_Vector3Notifier(0, 0, 0);\n    this._scale = new math_Vector3Notifier(1, 1, 1);\n    this._pivot = new math_Vector3Notifier(0, 0, 0);\n    this._rotation = new math_EulerNotifier();\n    this._quaternion = new math_Quaternion();\n\n    this._matrix.on('update', function () {\n      _this._onMatrixUpdate();\n    });\n\n    this._position.on('update', function () {\n      _this._onPositionUpdate();\n    });\n\n    this._scale.on('update', function () {\n      _this._onScaleUpdate();\n    });\n\n    this._pivot.on('update', function () {\n      _this._onPivotUpdate();\n    });\n\n    this._rotation.on('update', function () {\n      _this._onRotationUpdate();\n    });\n\n    this._quaternion.on('update', function () {\n      _this._onQuaternionUpdate();\n    });\n\n    Object.assign(this, params);\n  },\n\n  /**\n   * @param {boolean} [isChild=false] 是否子节点，子节点不会处理动画及骨骼Mesh，即如果有动画将共享\n   * @return {Node} 返回clone的Node\n   */\n  clone: function clone(isChild) {\n    var node = new this.constructor();\n    node.name = this.name;\n    node.jointName = this.jointName;\n    node.animationId = this.animationId;\n    node.setPosition(this.x, this.y, this.z);\n    node.setScale(this.scaleX, this.scaleY, this.scaleZ);\n    node.setRotation(this.rotationX, this.rotationY, this.rotationZ);\n    this.children.forEach(function (child) {\n      node.addChild(child.clone(true));\n    });\n\n    if (!isChild) {\n      if (this.anim) {\n        node.anim = this.anim.clone(node);\n      }\n\n      node.resetSkinedMeshRootNode();\n    }\n\n    return node;\n  },\n\n  /**\n   * 设置节点的动画，这个需要是模型的根节点\n   * @param {Animation} anim 动画实例\n   * @return {Node} this\n   */\n  setAnim: function setAnim(anim) {\n    this.anim = anim;\n    anim.rootNode = this;\n    return this;\n  },\n\n  /**\n   * 重置子孙元素中 SkinedMesh 的根节点为当前元素\n   */\n  resetSkinedMeshRootNode: function resetSkinedMeshRootNode() {\n    var _this2 = this;\n\n    this.traverse(function (mesh) {\n      if (mesh.isSkinedMesh && mesh.skeleton) {\n        mesh.skeleton.rootNode = _this2;\n      }\n    }, true);\n  },\n\n  /**\n   * 将所以子孙元素放到一个对象中，对象key为元素的name，value为该元素\n   * @return {Object} 返回获取的对象\n   */\n  getChildrenNameMap: function getChildrenNameMap() {\n    var map = {};\n    this.traverse(function (child) {\n      map[child.name] = child; // fix smd animation bug\n\n      var originName = child._originName;\n\n      if (originName !== undefined && !map[originName]) {\n        map[originName] = child;\n      }\n    }, true);\n    return map;\n  },\n\n  /**\n   * 添加一个子元素\n   * @param {Node} child 需要添加的子元素\n   * @return {Node} this\n   */\n  addChild: function addChild(child) {\n    if (child.parent) {\n      child.removeFromParent();\n    }\n\n    child.parent = this;\n    this.children.push(child);\n    return this;\n  },\n\n  /**\n   * 移除指定的子元素\n   * @param {Node} child 需要移除的元素\n   * @return {Node} this\n   */\n  removeChild: function removeChild(child) {\n    var index = this.children.indexOf(child);\n\n    if (index > -1) {\n      this.children.splice(index, 1);\n      child.parent = null;\n    }\n\n    return this;\n  },\n\n  /**\n   * 将当前元素添加到某个父元素的子元素中\n   * @param {Node} parent 需要添加到的父元素\n   * @return {Node} this\n   */\n  addTo: function addTo(parent) {\n    parent.addChild(this);\n    return this;\n  },\n\n  /**\n   * 将当前元素从其父元素中移除\n   * @return {Node} this\n   */\n  removeFromParent: function removeFromParent() {\n    if (this.parent) {\n      this.parent.removeChild(this);\n    }\n\n    return this;\n  },\n\n  /**\n   * 更新本地矩阵\n   * @return {Node} this\n   */\n  updateMatrix: function updateMatrix() {\n    if (this._matrixDirty) {\n      this._matrixDirty = false;\n      this.matrixVersion++;\n\n      this._matrix.fromRotationTranslationScaleOrigin(this.quaternion, this._position, this._scale, this._pivot, true);\n    }\n\n    return this;\n  },\n\n  /**\n   * 更新四元数\n   * @return {Node} this\n   */\n  updateQuaternion: function updateQuaternion() {\n    if (this._quatDirty) {\n      this._quatDirty = false;\n\n      this._quaternion.fromEuler(this._rotation, true);\n    }\n\n    return this;\n  },\n\n  /**\n   * 更新transform属性\n   * @return {Node} this\n   */\n  updateTransform: function updateTransform() {\n    this._matrix.decompose(this._quaternion, this._position, this._scale, this._pivot);\n\n    this._onQuaternionUpdate();\n\n    this._matrixDirty = false;\n    return this;\n  },\n\n  /**\n   * 更新世界矩阵\n   * @param  {Boolean} [force=true] 是否强制更新\n   * @return {Node} this\n   */\n  updateMatrixWorld: function updateMatrixWorld(force) {\n    this.traverse(function (node) {\n      if (node.autoUpdateWorldMatrix || force) {\n        if (node.parent) {\n          if (!node.__forceUseParentWorldMatrix) {\n            node.worldMatrix.multiply(node.parent.worldMatrix, node.matrix);\n          } else {\n            node.worldMatrix.copy(node.parent.worldMatrix);\n          }\n        } else {\n          node.worldMatrix.copy(node.matrix);\n        }\n      }\n\n      if (!node.autoUpdateChildWorldMatrix && !force) {\n        return TRAVERSE_STOP_CHILDREN;\n      }\n\n      return TRAVERSE_STOP_NONE;\n    });\n    return this;\n  },\n\n  /**\n   * 获取当前元素相对于指定元素的矩阵\n   * @param {Node} [ancestor] 相对于的元素，需要是当前元素的祖先元素，不传表示获取世界矩阵\n   * @return {Matrix4} 返回获取的矩阵\n   */\n  getConcatenatedMatrix: function getConcatenatedMatrix(ancestor) {\n    var mtx = new math_Matrix4();\n\n    for (var o = this; o && o !== ancestor; o = o.parent) {\n      mtx.multiply(o.matrix, mtx);\n    }\n\n    return mtx;\n  },\n\n  /**\n   * _traverse\n   * @private\n   * @param  {NodeTraverseCallback} callback\n   * @param  {Boolean}  onlyChild\n   * @return {Enum}  TRAVERSE_STOP_ALL, TRAVERSE_STOP_CHILDREN, TRAVERSE_STOP_NONE\n   */\n  _traverse: function _traverse(callback, onlyChild) {\n    if (!onlyChild) {\n      var res = callback(this);\n\n      if (res) {\n        return res;\n      }\n    }\n\n    var children = this.children;\n\n    for (var i = 0, l = children.length; i < l; i++) {\n      var _res = children[i]._traverse(callback, false);\n\n      if (_res === TRAVERSE_STOP_ALL) {\n        return _res;\n      }\n    }\n\n    return TRAVERSE_STOP_NONE;\n  },\n\n  /**\n   * 遍历当前元素的子孙元素\n   * @param {NodeTraverseCallback} callback 每个元素都会调用这个函数处理\n   * @param {Boolean} [onlyChild=false] 是否只遍历子元素\n   * @return {Node} this\n   */\n  traverse: function traverse(callback) {\n    var onlyChild = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    this._traverse(callback, onlyChild);\n\n    return this;\n  },\n\n  /**\n   * 遍历当前元素的子孙元素(广度优先)\n   * @param {NodeTraverseCallback} callback 每个元素都会调用这个函数处理\n   * @param {Boolean} [onlyChild=false] 是否只遍历子元素\n   * @return {Node} this\n   */\n  traverseBFS: function traverseBFS(callback) {\n    var onlyChild = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var currentQueue;\n    var nextQueue;\n\n    if (!onlyChild) {\n      nextQueue = [this];\n    } else {\n      nextQueue = this.children;\n    }\n\n    while (nextQueue.length) {\n      currentQueue = nextQueue;\n      nextQueue = [];\n\n      for (var i = 0, l = currentQueue.length; i < l; i++) {\n        var child = currentQueue[i];\n        var res = callback(child);\n\n        if (!res) {\n          nextQueue = nextQueue.concat(child.children);\n        } else if (res === TRAVERSE_STOP_ALL) {\n          return this;\n        }\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * 根据函数来获取一个子孙元素(广度优先)\n   * @param {NodeGetChildByCallback} fn 判读函数\n   * @return {Node|null} 返回获取到的子孙元素\n   */\n  getChildByFnBFS: function getChildByFnBFS(fn) {\n    var result = null;\n    this.traverseBFS(function (child) {\n      if (fn(child)) {\n        result = child;\n        return TRAVERSE_STOP_ALL;\n      }\n\n      return TRAVERSE_STOP_NONE;\n    }, true);\n    return result;\n  },\n\n  /**\n   * 根据 name path 来获取子孙元素\n   * @param  {String[]} path 名字数组, e.g., getChildByNamePath(['a', 'b', 'c'])\n   * @return {Node|null} 返回获取到的子孙元素\n   */\n  getChildByNamePath: function getChildByNamePath(path) {\n    var currentNode = this;\n\n    var _loop = function _loop(i, l) {\n      var name = path[i];\n      var node = currentNode.getChildByFnBFS(function (child) {\n        return child.name === name;\n      });\n\n      if (node) {\n        currentNode = node;\n      } else {\n        return {\n          v: null\n        };\n      }\n    };\n\n    for (var i = 0, l = path.length; i < l; i++) {\n      var _ret = _loop(i);\n\n      if (typeof _ret === \"object\") return _ret.v;\n    }\n\n    return currentNode;\n  },\n\n  /**\n   * 遍历调用子孙元素onUpdate方法\n   * @param  {Number} dt\n   * @return {Node} this\n   */\n  traverseUpdate: function traverseUpdate(dt) {\n    this.traverse(function (node) {\n      if (node.onUpdate) {\n        node.onUpdate(dt);\n      }\n\n      if (!node.needCallChildUpdate) {\n        return TRAVERSE_STOP_CHILDREN;\n      }\n\n      return TRAVERSE_STOP_NONE;\n    });\n    return this;\n  },\n\n  /**\n   * 根据函数来获取一个子孙元素\n   * @param {NodeGetChildByCallback} fn 判读函数\n   * @return {Node|null} 返回获取到的子孙元素\n   */\n  getChildByFn: function getChildByFn(fn) {\n    var result = null;\n    this.traverse(function (child) {\n      if (fn(child)) {\n        result = child;\n        return TRAVERSE_STOP_ALL;\n      }\n\n      return TRAVERSE_STOP_NONE;\n    }, true);\n    return result;\n  },\n\n  /**\n   * 根据函数来获取匹配的所有子孙元素\n   * @param {NodeGetChildByCallback} fn 判读函数\n   * @return {Node[]} 返回获取到的子孙元素\n   */\n  getChildrenByFn: function getChildrenByFn(fn) {\n    var result = [];\n    this.traverse(function (child) {\n      if (fn(child)) {\n        result.push(child);\n      }\n    }, true);\n    return result;\n  },\n\n  /**\n   * 获取指定name的首个子孙元素\n   * @param {string} name 元素name\n   * @return {Node|null} 获取的元素\n   */\n  getChildByName: function getChildByName(name) {\n    return this.getChildByFn(function (child) {\n      return child.name === name;\n    });\n  },\n\n  /**\n   * 获取指定name的所有子孙元素\n   * @param {string} name 元素name\n   * @return {Node[]} 获取的元素数组\n   */\n  getChildrenByName: function getChildrenByName(name) {\n    return this.getChildrenByFn(function (child) {\n      return child.name === name;\n    });\n  },\n\n  /**\n   * 获取指定id的子孙元素\n   * @param {string} id 元素id\n   * @return {Node|null} 获取的元素\n   */\n  getChildById: function getChildById(id) {\n    return this.getChildByFn(function (child) {\n      return child.id === id;\n    });\n  },\n\n  /**\n   * 获取指定类名的所有子孙元素\n   * @param {string} className 类名\n   * @return {Node[]} 获取的元素数组\n   */\n  getChildrenByClassName: function getChildrenByClassName(className) {\n    return this.getChildrenByFn(function (child) {\n      return child.className === className;\n    });\n  },\n\n  /**\n   * 获取指定基类名的所有子孙元素\n   * @param {string} className 类名\n   * @return {Node[]} 获取的元素数组\n   */\n  getChildrenByBaseClassName: function getChildrenByBaseClassName(className) {\n    return this.getChildrenByFn(function (child) {\n      return child['is' + className];\n    });\n  },\n\n  /**\n   * 设置元素的缩放比例\n   * @param {number} x X缩放比例\n   * @param {number} y Y缩放比例\n   * @param {number} z Z缩放比例\n   * @return {Node} this\n   */\n  setScale: function setScale(x) {\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : x;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : y;\n\n    this._scale.set(x, y, z);\n\n    return this;\n  },\n\n  /**\n   * 设置元素的位置\n   * @param {number} x X方向位置\n   * @param {number} y Y方向位置\n   * @param {number} z Z方向位置\n   * @return {Node} this\n   */\n  setPosition: function setPosition(x, y, z) {\n    this._position.set(x, y, z);\n\n    return this;\n  },\n\n  /**\n   * 设置元素的旋转\n   * @param {number} x X轴旋转角度, 角度制\n   * @param {number} y Y轴旋转角度, 角度制\n   * @param {number} z Z轴旋转角度, 角度制\n   * @return {Node} this\n   */\n  setRotation: function setRotation(x, y, z) {\n    this._rotation.setDegree(x, y, z);\n\n    return this;\n  },\n\n  /**\n   * 设置中心点\n   * @param {Number} x 中心点x\n   * @param {Number} y 中心点y\n   * @param {Number} z 中心点z\n   * @return {Node} this\n   */\n  setPivot: function setPivot(x, y, z) {\n    this._pivot.set(x, y, z);\n\n    return this;\n  },\n\n  /**\n   * 改变元素的朝向\n   * @param {Node|Object|Vector3} node 需要朝向的元素，或者坐标\n   * @return {Node} this\n   */\n  lookAt: function lookAt(node) {\n    if (this.isCamera) {\n      Node_tempMatrix4.targetTo(this, node, this.up);\n    } else {\n      Node_tempMatrix4.targetTo(node, this, this.up);\n    }\n\n    this._quaternion.fromMat4(Node_tempMatrix4);\n\n    return this;\n  },\n\n  /**\n   * raycast\n   * @param  {Ray} ray\n   * @param {Boolean} [sort=false] 是否按距离排序\n   * @param {Boolean} [eventMode=false] 是否事件模式\n   * @return {raycastInfo[]|null}\n   */\n  raycast: function raycast(ray) {\n    var _this3 = this;\n\n    var sort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var eventMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n\n    if (!this.visible) {\n      return null;\n    }\n\n    var resArray = [];\n    this.traverse(function (child) {\n      if (eventMode && !child.pointerEnabled) {\n        return TRAVERSE_STOP_CHILDREN;\n      }\n\n      if (child.isMesh) {\n        var res = child.raycast(ray, false);\n\n        if (res) {\n          resArray = resArray.concat(res.map(function (point) {\n            return {\n              mesh: child,\n              point: point\n            };\n          }));\n        }\n      }\n\n      if (eventMode && !_this3.pointerChildren) {\n        return TRAVERSE_STOP_CHILDREN;\n      }\n\n      return false;\n    });\n\n    if (resArray.length) {\n      if (sort) {\n        ray.sortPoints(resArray, 'point');\n      }\n\n      return resArray;\n    }\n\n    return null;\n  },\n\n  /**\n   * 元素的矩阵\n   * @type {Matrix4Notifier}\n   * @readOnly\n   */\n  matrix: {\n    get: function get() {\n      this.updateMatrix();\n      return this._matrix;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.matrix.set', 'node.matrix is readOnly.Use node.matrix.copy instead.');\n\n      this._matrix.copy(value);\n    }\n  },\n\n  /**\n   * 位置\n   * @type {Vector3Notifier}\n   * @readOnly\n   */\n  position: {\n    get: function get() {\n      return this._position;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.position.set', 'node.position is readOnly.Use node.position.copy instead.');\n\n      this._position.copy(value);\n    }\n  },\n\n  /**\n   * x轴坐标\n   * @type {number}\n   */\n  x: {\n    get: function get() {\n      return this._position.elements[0];\n    },\n    set: function set(value) {\n      this._position.elements[0] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * y轴坐标\n   * @type {number}\n   */\n  y: {\n    get: function get() {\n      return this._position.elements[1];\n    },\n    set: function set(value) {\n      this._position.elements[1] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * z轴坐标\n   * @type {number}\n   */\n  z: {\n    get: function get() {\n      return this._position.elements[2];\n    },\n    set: function set(value) {\n      this._position.elements[2] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 缩放\n   * @type {Vector3Notifier}\n   * @readOnly\n   */\n  scale: {\n    get: function get() {\n      return this._scale;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.scale.set', 'node.scale is readOnly.Use node.scale.copy instead.');\n\n      this._scale.copy(value);\n    }\n  },\n\n  /**\n   * 缩放比例x\n   * @type {number}\n   */\n  scaleX: {\n    get: function get() {\n      return this._scale.elements[0];\n    },\n    set: function set(value) {\n      this._scale.elements[0] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 缩放比例y\n   * @type {number}\n   */\n  scaleY: {\n    get: function get() {\n      return this._scale.elements[1];\n    },\n    set: function set(value) {\n      this._scale.elements[1] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 缩放比例z\n   * @type {number}\n   */\n  scaleZ: {\n    get: function get() {\n      return this._scale.elements[2];\n    },\n    set: function set(value) {\n      this._scale.elements[2] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 中心点\n   * @type {Vector3Notifier}\n   * @readOnly\n   */\n  pivot: {\n    get: function get() {\n      return this._pivot;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.pivot.set', 'node.pivot is readOnly.Use node.pivot.copy instead.');\n\n      this._pivot.copy(value);\n    }\n  },\n\n  /**\n   * 中心点x\n   * @type {Number}\n   */\n  pivotX: {\n    get: function get() {\n      return this._pivot.elements[0];\n    },\n    set: function set(value) {\n      this._pivot.elements[0] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 中心点y\n   * @type {Number}\n   */\n  pivotY: {\n    get: function get() {\n      return this._pivot.elements[1];\n    },\n    set: function set(value) {\n      this._pivot.elements[1] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 中心点z\n   * @type {Number}\n   */\n  pivotZ: {\n    get: function get() {\n      return this._pivot.elements[2];\n    },\n    set: function set(value) {\n      this._pivot.elements[2] = value;\n      this._matrixDirty = true;\n    }\n  },\n\n  /**\n   * 欧拉角\n   * @type {EulerNotifier}\n   * @readOnly\n   */\n  rotation: {\n    get: function get() {\n      return this._rotation;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.rotation.set', 'node.rotation is readOnly.Use node.rotation.copy instead.');\n\n      this._rotation.copy(value);\n    }\n  },\n\n  /**\n   * 旋转角度 x, 角度制\n   * @type {number}\n   */\n  rotationX: {\n    get: function get() {\n      return this._rotation.degX;\n    },\n    set: function set(value) {\n      this._rotation.degX = value;\n    }\n  },\n\n  /**\n   * 旋转角度 y, 角度制\n   * @type {number}\n   */\n  rotationY: {\n    get: function get() {\n      return this._rotation.degY;\n    },\n    set: function set(value) {\n      this._rotation.degY = value;\n    }\n  },\n\n  /**\n   * 旋转角度 z, 角度制\n   * @type {number}\n   */\n  rotationZ: {\n    get: function get() {\n      return this._rotation.degZ;\n    },\n    set: function set(value) {\n      this._rotation.degZ = value;\n    }\n  },\n\n  /**\n   * 四元数角度\n   * @type {Quaternion}\n   */\n  quaternion: {\n    get: function get() {\n      this.updateQuaternion();\n      return this._quaternion;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Node.quaternion.set', 'node.quaternion is readOnly.Use node.quaternion.copy instead.');\n\n      this._quaternion.copy(value);\n    }\n  },\n  matrixVersion: 0,\n\n  /**\n   * 获取元素的包围盒信息\n   *\n   * @param {Node} [parent] 元素相对于哪个祖先元素的包围盒，不传表示世界\n   * @param {Matrix4} [currentMatrix] 当前计算的矩阵\n   * @param {Bounds} [bounds] 当前计算的包围盒信息\n   * @return {Bounds} 返回计算的包围盒信息\n   */\n  getBounds: function getBounds(parent, currentMatrix, bounds) {\n    if (!currentMatrix) {\n      currentMatrix = this.getConcatenatedMatrix(parent);\n    } else {\n      currentMatrix.multiply(this.matrix);\n    }\n\n    this.children.forEach(function (child) {\n      bounds = child.getBounds(null, currentMatrix.clone(), bounds);\n    });\n\n    if (this.isMesh) {\n      bounds = this.geometry.getBounds(currentMatrix, bounds);\n    }\n\n    return bounds;\n  },\n\n  /**\n   * 冒泡鼠标事件\n   * @param {Object} event\n   * @private\n   */\n  _fireMouseEvent: function _fireMouseEvent(event) {\n    event.eventCurrentTarget = this;\n    this.fire(event); // 处理mouseover事件 mouseover不需要阻止冒泡\n    // handle mouseover event, mouseover needn't stop propagation.\n\n    if (event.type === 'mousemove') {\n      if (!this.__mouseOver) {\n        this.__mouseOver = true;\n        var overEvent = Object.assign({}, event);\n        overEvent.type = 'mouseover';\n        this.fire(overEvent);\n      }\n    } else if (event.type === 'mouseout') {\n      this.__mouseOver = false;\n    } // 向上冒泡\n    // handle event propagation\n\n\n    var parent = this.parent;\n\n    if (!event._stopped && !event._stopPropagationed && parent) {\n      parent._fireMouseEvent(event);\n    }\n  },\n\n  /**\n   * 销毁 Node 资源\n   * @param {WebGLRenderer} [renderer] stage时可以不传\n   * @param {Boolean} [destroyTextures=false] 是否销毁材质的贴图，默认不销毁\n   * @return {Node} this\n   */\n  destroy: function destroy(renderer) {\n    var destroyTextures = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var nodes = this.getChildrenByBaseClassName('Node');\n    this.off();\n    nodes.forEach(function (node) {\n      if (node.isMesh) {\n        node.destroy(renderer, destroyTextures);\n      } else {\n        node.off();\n        node.removeFromParent();\n      }\n    });\n    this.removeFromParent();\n    return this;\n  },\n  _onMatrixUpdate: function _onMatrixUpdate() {\n    this.matrixVersion++;\n    this.updateTransform();\n  },\n  _onPositionUpdate: function _onPositionUpdate() {\n    this._matrixDirty = true;\n  },\n  _onScaleUpdate: function _onScaleUpdate() {\n    this._matrixDirty = true;\n  },\n  _onPivotUpdate: function _onPivotUpdate() {\n    this._matrixDirty = true;\n  },\n  _onRotationUpdate: function _onRotationUpdate() {\n    this._quatDirty = true;\n    this._matrixDirty = true;\n  },\n  _onQuaternionUpdate: function _onQuaternionUpdate() {\n    this._rotation.fromQuat(this._quaternion);\n\n    this._quatDirty = false;\n  }\n});\n/* harmony default export */ var core_Node = (Node);\n/**\n * 包围盒信息\n * @typedef {object} Bounds\n * @property {number} x 包围盒中心的X坐标\n * @property {number} y 包围盒中心的Y坐标\n * @property {number} z 包围盒中心的Z坐标\n * @property {number} width 包围盒的宽度\n * @property {number} height 包围盒的高度\n * @property {number} depth 包围盒的深度\n * @property {number} xMin X轴的最小值\n * @property {number} xMax X轴的最大值\n * @property {number} yMin Y轴的最小值\n * @property {number} yMax Y轴的最大值\n * @property {number} zMin Z轴的最小值\n * @property {number} zMax Z轴的最大值\n */\n\n/**\n * 碰撞信息\n * @typedef {object} raycastInfo\n * @property {Mesh} mesh 碰撞的 mesh\n * @property {Vector3} point 碰撞得点\n */\n\n/**\n * Node traverse 回调\n * @callback NodeTraverseCallback\n * @param {Node} node\n * @return {any} Node.TRAVERSE_STOP_NONE | Node.TRAVERSE_STOP_CHILDREN | Node.TRAVERSE_STOP_ALL\n */\n\n/**\n * Node getChildByCallback 回调\n * @callback NodeGetChildByCallback\n * @param {Node} node\n * @return {boolean}\n */\n// CONCATENATED MODULE: ./src/math/Vector4.js\n\n\n/**\n * 四维向量\n * @class\n */\n\nvar Vector4 = core_Class.create(\n/** @lends Vector4.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Vector4\n   */\n  className: 'Vector4',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isVector4: true,\n\n  /**\n   * Creates a new empty vec4\n   * @param {Number} [x=0] X component\n   * @param {Number} [y=0] Y component\n   * @param {Number} [z=0] Z component\n   * @param {Number} [w=0] W component\n   * @constructs\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var w = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"vec4\"].fromValues(x, y, z, w);\n  },\n\n  /**\n   * Copy the values from one vec4 to this\n   * @param  {Vector4} m the source vector\n   * @return {Vector4} this\n   */\n  copy: function copy(v) {\n    gl_matrix_min[\"vec4\"].copy(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a new vec4 initialized with values from this vector\n   * @return {Vector4} a new Vector4\n   */\n  clone: function clone() {\n    var elements = this.elements;\n    return new this.constructor(elements[0], elements[1], elements[2], elements[3]);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    array[0 + offset] = elements[0];\n    array[1 + offset] = elements[1];\n    array[2 + offset] = elements[2];\n    array[3 + offset] = elements[3];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {this}\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    elements[0] = array[offset + 0];\n    elements[1] = array[offset + 1];\n    elements[2] = array[offset + 2];\n    elements[3] = array[offset + 3];\n    return this;\n  },\n\n  /**\n   * Set the components of a vec4 to the given values\n   * @param {Number} x X component\n   * @param {Number} y Y component\n   * @param {Number} z Z component\n   * @param {Number} w W component\n   * @returns {Vector4} this\n   */\n  set: function set(x, y, z, w) {\n    gl_matrix_min[\"vec4\"].set(this.elements, x, y, z, w);\n    return this;\n  },\n\n  /**\n   * Adds two vec4's\n   * @param {Vector4} a\n   * @param {Vector4} [b] 如果不传，计算 this 和 a 的和\n   * @returns {Vector4} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].add(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Subtracts vector b from vector a\n   * @param {Vector4} a\n   * @param {Vector4} [b] 如果不传，计算 this 和 a 的差\n   * @returns {Vector4} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].subtract(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Multiplies two vec4's\n   * @param {Vector4} a\n   * @param {Vector4} [b] 如果不传，计算 this 和 a 的积\n   * @returns {Vector4} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].multiply(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Divides two vec4's\n   * @param {Vector4} a\n   * @param {Vector4} [b] 如果不传，计算 this 和 a 的商\n   * @returns {Vector4} this\n   */\n  divide: function divide(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].divide(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.ceil the components of this\n   * @returns {Vector4} this\n   */\n  ceil: function ceil() {\n    gl_matrix_min[\"vec4\"].ceil(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Math.floor the components of this\n   * @returns {Vector4} this\n   */\n  floor: function floor() {\n    gl_matrix_min[\"vec4\"].floor(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the minimum of two vec4's\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector4} this\n   */\n  min: function min(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].min(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Returns the maximum of two vec4's\n   * @param  {Vector4} a\n   * @param  {Vector4} [b]  如果不传，计算 this 和 a 的结果\n   * @returns {Vector4} this\n   */\n  max: function max(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].max(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.round the components of this\n   * @returns {Vector4} this\n   */\n  round: function round() {\n    gl_matrix_min[\"vec4\"].round(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Scales this by a scalar number\n   * @param  {Number} scale amount to scale the vector by\n   * @returns {Vector4} this\n   */\n  scale: function scale(_scale) {\n    gl_matrix_min[\"vec4\"].scale(this.elements, this.elements, _scale);\n    return this;\n  },\n\n  /**\n   * Adds two vec4's after scaling the second vector by a scalar value\n   * @param  {Number} scale the amount to scale the second vector by before adding\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector4} this\n   */\n  scaleAndAdd: function scaleAndAdd(scale, a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].scaleAndAdd(this.elements, a.elements, b.elements, scale);\n    return this;\n  },\n\n  /**\n   * Calculates the euclidian distance between two vec4's\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} distance between a and b\n   */\n  distance: function distance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec4\"].distance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the squared euclidian distance between two vec4's\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} squared distance between a and b\n   */\n  squaredDistance: function squaredDistance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec4\"].squaredDistance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the length of this\n   * @return {Number} length of this\n   */\n  length: function length() {\n    return gl_matrix_min[\"vec4\"].length(this.elements);\n  },\n\n  /**\n   * Calculates the squared length of this\n   * @return {Number} squared length of this\n   */\n  squaredLength: function squaredLength() {\n    return gl_matrix_min[\"vec4\"].squaredLength(this.elements);\n  },\n\n  /**\n   * Negates the components of this\n   * @returns {Vector4} this\n   */\n  negate: function negate() {\n    gl_matrix_min[\"vec4\"].negate(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the inverse of the components of a vec4\n   * @param  {Vector4} [a=this]\n   * @returns {Vector4} this\n   */\n  inverse: function inverse(a) {\n    if (!a) {\n      a = this;\n    }\n\n    gl_matrix_min[\"vec4\"].inverse(this.elements, a.elements);\n    return this;\n  },\n\n  /**\n   * Normalize this\n   * @returns {Vector4} this\n   */\n  normalize: function normalize() {\n    gl_matrix_min[\"vec4\"].normalize(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the dot product of two vec4's\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  product of a and b\n   */\n  dot: function dot(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec4\"].dot(a.elements, b.elements);\n  },\n\n  /**\n   * Performs a linear interpolation between two vec4's\n   * @param  {Vector4} v\n   * @param  {Number} t interpolation amount between the two vectors\n   * @returns {Vector4} this\n   */\n  lerp: function lerp(v, t) {\n    gl_matrix_min[\"vec4\"].lerp(this.elements, this.elements, v.elements, t);\n    return this;\n  },\n\n  /**\n   * Generates a random vector with the given scale\n   * @param  {Number} [scale=1] Length of the resulting vector. If ommitted, a unit vector will be returned\n   * @returns {Vector4} this\n   */\n  random: function random(scale) {\n    scale = scale || 1;\n    this.elements[0] = Math.random();\n    this.elements[1] = Math.random();\n    this.elements[2] = Math.random();\n    this.elements[3] = Math.random();\n    this.normalize();\n    this.scale(scale);\n    return this;\n  },\n\n  /**\n   * Transforms the vec4 with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector4} this\n   */\n  transformMat4: function transformMat4(m) {\n    gl_matrix_min[\"vec4\"].transformMat4(this.elements, this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Transforms the vec4 with a quat\n   * @param  {Quaternion} q quaternion to transform with\n   * @returns {Vector4} this\n   */\n  transformQuat: function transformQuat(q) {\n    gl_matrix_min[\"vec4\"].transformQuat(this.elements, this.elements, q.elements);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec4\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the vectors have approximately the same elements in the same position.\n   * @param  {Vector4} a\n   * @param  {Vector4} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec4\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * X component\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n    }\n  },\n\n  /**\n   * Y component\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n    }\n  },\n\n  /**\n   * Z component\n   * @type {Number}\n   */\n  z: {\n    get: function get() {\n      return this.elements[2];\n    },\n    set: function set(value) {\n      this.elements[2] = value;\n    }\n  },\n\n  /**\n   * W component\n   * @type {Number}\n   */\n  w: {\n    get: function get() {\n      return this.elements[3];\n    },\n    set: function set(value) {\n      this.elements[3] = value;\n    }\n  }\n});\n/**\n * Alias for {@link Vector4#subtract}\n * @function\n */\n\nVector4.prototype.sub = Vector4.prototype.subtract;\n/**\n * Alias for {@link Vector4#multiply}\n * @function\n */\n\nVector4.prototype.mul = Vector4.prototype.multiply;\n/**\n * Alias for {@link Vector4#divide}\n * @function\n */\n\nVector4.prototype.div = Vector4.prototype.divide;\n/**\n * Alias for {@link Vector4#distance}\n * @function\n */\n\nVector4.prototype.dist = Vector4.prototype.distance;\n/**\n * Alias for {@link Vector4#squaredDistance}\n * @function\n */\n\nVector4.prototype.sqrDist = Vector4.prototype.squaredDistance;\n/**\n * Alias for {@link Vector4#length}\n * @function\n */\n\nVector4.prototype.len = Vector4.prototype.length;\n/**\n * Alias for {@link Vector4#squaredLength}\n * @function\n */\n\nVector4.prototype.sqrLen = Vector4.prototype.squaredLength;\n/* harmony default export */ var math_Vector4 = (Vector4);\n// CONCATENATED MODULE: ./src/math/Color.js\n\n\n\n/**\n * 颜色类\n * @class\n * @extends Vector4\n */\n\nvar Color = core_Class.create(\n/** @lends Color.prototype */\n{\n  Extends: math_Vector4,\n\n  /**\n   * 类名\n   * @type {String}\n   * @default Color\n   */\n  className: 'Color',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isColor: true,\n\n  /**\n   * r\n   * @type {Number}\n   */\n  r: {\n    get: function get() {\n      return this.x;\n    },\n    set: function set(v) {\n      this.x = v;\n    }\n  },\n\n  /**\n   * g\n   * @type {Number}\n   */\n  g: {\n    get: function get() {\n      return this.y;\n    },\n    set: function set(v) {\n      this.y = v;\n    }\n  },\n\n  /**\n   * b\n   * @type {Number}\n   */\n  b: {\n    get: function get() {\n      return this.z;\n    },\n    set: function set(v) {\n      this.z = v;\n    }\n  },\n\n  /**\n   * a\n   * @type {Number}\n   */\n  a: {\n    get: function get() {\n      return this.w;\n    },\n    set: function set(v) {\n      this.w = v;\n    }\n  },\n\n  /**\n   * @constructs\n   * @param  {Number} [r=1]\n   * @param  {Number} [g=1]\n   * @param  {Number} [b=1]\n   * @param  {Number} [a=1]\n   */\n  constructor: function constructor() {\n    var r = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    var g = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    var b = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var a = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    Color.superclass.constructor.call(this, r, g, b, a);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 转换到的数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toRGBArray: function toRGBArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var el = this.elements;\n    array[offset] = el[0];\n    array[offset + 1] = el[1];\n    array[offset + 2] = el[2];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Color}\n   */\n  fromUintArray: function fromUintArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    this.elements[0] = array[offset] / 255;\n    this.elements[1] = array[offset + 1] / 255;\n    this.elements[2] = array[offset + 2] / 255;\n    this.elements[3] = array[offset + 3] / 255;\n    return this;\n  },\n\n  /**\n   * 从十六进制值赋值\n   * @param  {String|Number} hex 颜色的十六进制值，可以以下形式：\"#ff9966\", \"ff9966\", \"#f96\", \"f96\", 0xff9966\n   * @return {Color}\n   */\n  fromHEX: function fromHEX(hex) {\n    if (typeof hex === 'number') {\n      hex = padLeft(hex.toString(16), 6);\n    } else {\n      if (hex[0] === '#') {\n        hex = hex.slice(1);\n      }\n\n      if (hex.length === 3) {\n        hex = hex.replace(/(\\w)/g, '$1$1');\n      }\n    }\n\n    this.elements[0] = parseInt(hex.slice(0, 2), 16) / 255;\n    this.elements[1] = parseInt(hex.slice(2, 4), 16) / 255;\n    this.elements[2] = parseInt(hex.slice(4, 6), 16) / 255;\n    return this;\n  },\n\n  /**\n   * 转16进制\n   * @return {String}\n   */\n  toHEX: function toHEX() {\n    var hex = '';\n\n    for (var i = 0; i < 3; i++) {\n      hex += padLeft(Math.floor(this.elements[i] * 255).toString(16), 2);\n    }\n\n    return hex;\n  }\n});\n/* harmony default export */ var math_Color = (Color);\n// CONCATENATED MODULE: ./src/light/Light.js\n\n\n\nvar tempColor = new math_Color();\n/**\n * 灯光基础类\n * @class\n * @extends Node\n */\n\nvar Light = core_Class.create(\n/** @lends Light.prototype */\n{\n  Extends: core_Node,\n  isLight: true,\n  className: 'Light',\n\n  /**\n   * 光强度\n   * @type {Number}\n   * @default 1\n   */\n  amount: 1,\n\n  /**\n   * 是否开启灯光\n   * @type {Boolean}\n   * @default true\n   */\n  enabled: true,\n\n  /**\n   * 光常量衰减值, PointLight 和 SpotLight 时生效\n   * @type {Number}\n   * @default 1\n   */\n  constantAttenuation: 1,\n\n  /**\n   * 光线性衰减值, PointLight 和 SpotLight 时生效\n   * @type {Number}\n   * @default 0\n   */\n  linearAttenuation: 0,\n\n  /**\n   * 光二次衰减值, PointLight 和 SpotLight 时生效\n   * @type {Number}\n   * @default 0\n   */\n  quadraticAttenuation: 0,\n  _range: 0,\n\n  /**\n   * 光照范围, PointLight 和 SpotLight 时生效, 0 时代表光照范围无限大。\n   * @type {Number}\n   * @default 0\n   */\n  range: {\n    get: function get() {\n      return this._range;\n    },\n    set: function set(value) {\n      this.constantAttenuation = 1;\n\n      if (value <= 0) {\n        this.linearAttenuation = 0;\n        this.quadraticAttenuation = 0;\n      } else {\n        this.linearAttenuation = 4.5 / value;\n        this.quadraticAttenuation = 75 / (value * value);\n      }\n\n      this._range = value;\n    }\n  },\n\n  /**\n   * 阴影生成参数，默认不生成阴影\n   * @default null\n   * @type {object}\n   * @property {boolean} [debug=false] 是否显示生成的阴影贴图\n   * @property {number} [width=render.width] 阴影贴图的宽，默认为画布宽\n   * @property {number} [height=render.height] 阴影贴图的高，默认为画布高\n   * @property {number} [maxBias=0.05] depth最大差值，实际的bias为max(maxBias * (1 - dot(normal, lightDir)), minBias)\n   * @property {number} [minBias=0.005] depth最小差值\n   * @property {Object} [cameraInfo=null] 阴影摄像机信息，没有会根据当前相机自动计算\n   */\n  shadow: null,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    /**\n     * 灯光颜色\n     * @default new Color(1, 1, 1)\n     * @type {Color}\n     */\n    this.color = new math_Color(1, 1, 1);\n    Light.superclass.constructor.call(this, params);\n  },\n\n  /**\n   * 获取光范围信息, PointLight 和 SpotLight 时生效\n   * @param  {Array} out  信息接受数组\n   * @param  {Number} offset 偏移值\n   */\n  toInfoArray: function toInfoArray(out, offset) {\n    out[offset + 0] = this.constantAttenuation;\n    out[offset + 1] = this.linearAttenuation;\n    out[offset + 2] = this.quadraticAttenuation;\n    return this;\n  },\n  getRealColor: function getRealColor() {\n    return tempColor.copy(this.color).scale(this.amount);\n  },\n\n  /**\n   * 生成阴影贴图，支持阴影的子类需要重写\n   * @param  {WebGLRenderer} renderer\n   * @param  {Camera} camera\n   */\n  createShadowMap: function createShadowMap(renderer, camera) {// eslint-disable-line no-unused-vars\n  }\n});\n/* harmony default export */ var light_Light = (Light);\n// CONCATENATED MODULE: ./src/math/Plane.js\n\n\n/**\n * 平面\n * @class\n */\n\nvar Plane = core_Class.create(\n/** @lends Plane.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Plane\n   */\n  className: 'Plane',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isPlane: true,\n\n  /**\n   * @constructs\n   * @param  {Vector3} [normal=new Vector3]   法线\n   * @param  {Number}  [distance=0] 距离\n   */\n  constructor: function constructor() {\n    var normal = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Vector3();\n    var distance = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    this.normal = normal;\n    this.distance = distance;\n  },\n\n  /**\n   * Copy the values from one plane to this\n   * @param  {Plane} m the source plane\n   * @return {Plane} this\n   */\n  copy: function copy(plane) {\n    this.normal.copy(plane.normal);\n    this.distance = plane.distance;\n    return this;\n  },\n\n  /**\n   * Creates a new plane initialized with values from this plane\n   * @return {Plane} a new Plane\n   */\n  clone: function clone() {\n    return new this.constructor(this.normal.clone(), this.distance);\n  },\n\n  /**\n   * [set description]\n   * @param {Number} x 法线 x\n   * @param {Number} y 法线 y\n   * @param {Number} z 法线 z\n   * @param {Number} w 距离\n   * @return {Plane} this\n   */\n  set: function set(x, y, z, w) {\n    this.normal.set(x, y, z);\n    this.distance = w;\n    return this;\n  },\n\n  /**\n   * 归一化\n   * @return {Plane} this\n   */\n  normalize: function normalize() {\n    var inverseNormalLength = 1.0 / this.normal.length();\n    this.normal.scale(inverseNormalLength);\n    this.distance *= inverseNormalLength;\n    return this;\n  },\n\n  /**\n   * 与点的距离\n   * @param  {Vector3} point\n   * @return {Number}\n   */\n  distanceToPoint: function distanceToPoint(point) {\n    return this.normal.dot(point) + this.distance;\n  },\n\n  /**\n   * 投影点\n   * @param  {Vector3} point\n   * @return {Vector3}\n   */\n  projectPoint: function projectPoint(point) {\n    return new math_Vector3().copy(this.normal).scale(-this.distanceToPoint(point)).add(point);\n  }\n});\n/* harmony default export */ var math_Plane = (Plane);\n// CONCATENATED MODULE: ./src/math/Frustum.js\n\n\n/**\n * 平截头体\n * @class\n */\n\nvar Frustum = core_Class.create(\n/** @lends Frustum.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Frustum\n   */\n  className: 'Frustum',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isFrustum: true,\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    this.planes = [];\n    var num = 6;\n\n    while (num--) {\n      this.planes.push(new math_Plane());\n    }\n  },\n\n  /**\n   * Copy the values from one frustum to this\n   * @param  {Frustum} m the source frustum\n   * @return {Frustum} this\n   */\n  copy: function copy(frustum) {\n    var planes = frustum.planes;\n    this.planes.forEach(function (plane, index) {\n      plane.copy(planes[index]);\n    });\n    return this;\n  },\n\n  /**\n   * Creates a new frustum initialized with values from this frustum\n   * @return {Frustum} a new Frustum\n   */\n  clone: function clone() {\n    var frustum = new this.constructor();\n    frustum.copy(this);\n    return frustum;\n  },\n\n  /**\n   * fromMatrix\n   * @param  {Matrix4} mat\n   * @return {Frustum}  this\n   */\n  fromMatrix: function fromMatrix(mat) {\n    // Based on https://github.com/mrdoob/three.js/blob/dev/src/math/Frustum.js#L63\n    var planes = this.planes;\n    var me = mat.elements;\n    var me0 = me[0];\n    var me1 = me[1];\n    var me2 = me[2];\n    var me3 = me[3];\n    var me4 = me[4];\n    var me5 = me[5];\n    var me6 = me[6];\n    var me7 = me[7];\n    var me8 = me[8];\n    var me9 = me[9];\n    var me10 = me[10];\n    var me11 = me[11];\n    var me12 = me[12];\n    var me13 = me[13];\n    var me14 = me[14];\n    var me15 = me[15];\n    planes[0].set(me3 - me0, me7 - me4, me11 - me8, me15 - me12).normalize();\n    planes[1].set(me3 + me0, me7 + me4, me11 + me8, me15 + me12).normalize();\n    planes[2].set(me3 + me1, me7 + me5, me11 + me9, me15 + me13).normalize();\n    planes[3].set(me3 - me1, me7 - me5, me11 - me9, me15 - me13).normalize();\n    planes[4].set(me3 - me2, me7 - me6, me11 - me10, me15 - me14).normalize();\n    planes[5].set(me3 + me2, me7 + me6, me11 + me10, me15 + me14).normalize();\n    return this;\n  },\n\n  /**\n   * 与球体相交\n   * @param  {Sphere} sphere\n   * @return {Boolean} 是否相交\n   */\n  intersectsSphere: function intersectsSphere(sphere) {\n    var planes = this.planes;\n    var center = sphere.center;\n    var negRadius = -sphere.radius;\n\n    for (var i = 0; i < 6; i++) {\n      var distance = planes[i].distanceToPoint(center);\n\n      if (distance < negRadius) {\n        return false;\n      }\n    }\n\n    return true;\n  }\n});\n/* harmony default export */ var math_Frustum = (Frustum);\n// CONCATENATED MODULE: ./src/camera/Camera.js\n\n\n\n\nvar Camera_tempMatrix4 = new math_Matrix4();\n/**\n * 摄像机\n * @class\n * @extends Node\n */\n\nvar Camera = core_Class.create(\n/** @lends Camera.prototype */\n{\n  Extends: core_Node,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isCamera: true,\n\n  /**\n   * @default Camera\n   * @type {string}\n   */\n  className: 'Camera',\n\n  /**\n   * 是否需要更新投影矩阵\n   * @private\n   * @default true\n   * @type {Boolean}\n   */\n  _needUpdateProjectionMatrix: true,\n  _isGeometryDirty: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    /**\n     * 相对于摄像头的矩阵\n     * @type {Matrix4}\n     */\n    this.viewMatrix = new math_Matrix4();\n    /**\n     * 投影矩阵\n     * @type {Matrix4}\n     */\n\n    this.projectionMatrix = new math_Matrix4();\n    /**\n     * View 联结投影矩阵\n     * @type {Matrix4}\n     */\n\n    this.viewProjectionMatrix = new math_Matrix4();\n    this._frustum = new math_Frustum();\n    Camera.superclass.constructor.call(this, params);\n  },\n\n  /**\n   * 更新viewMatrix\n   * @return {Camera} this\n   */\n  updateViewMatrix: function updateViewMatrix() {\n    this.updateMatrixWorld(true);\n    this.viewMatrix.invert(this.worldMatrix);\n    return this;\n  },\n\n  /**\n   * 更新投影矩阵，子类必须重载这个方法\n   */\n  updateProjectionMatrix: function updateProjectionMatrix() {},\n\n  /**\n   * 获取几何体，子类必须重写\n   * @param  {Boolean} forceUpdate 是否强制更新\n   * @return {Geometry}\n   */\n  getGeometry: function getGeometry(forceUpdate) {// eslint-disable-line no-unused-vars\n  },\n\n  /**\n   * 更新viewProjectionMatrix\n   * @return {Camera} this\n   */\n  updateViewProjectionMatrix: function updateViewProjectionMatrix() {\n    if (this._needUpdateProjectionMatrix) {\n      this.updateProjectionMatrix();\n      this._needUpdateProjectionMatrix = false;\n    }\n\n    this.updateViewMatrix();\n    this.viewProjectionMatrix.multiply(this.projectionMatrix, this.viewMatrix);\n    this.updateFrustum(this.viewProjectionMatrix);\n    return this;\n  },\n\n  /**\n   * 获取元素相对于当前Camera的矩阵\n   * @param {Node} node 目标元素\n   * @param {Matrix4} [out] 传递将在这个矩阵上做计算，不传将创建一个新的 Matrix4\n   * @return {Matrix4} 返回获取的矩阵\n   */\n  getModelViewMatrix: function getModelViewMatrix(node, out) {\n    out = out || new math_Matrix4();\n    out.multiply(this.viewMatrix, node.worldMatrix);\n    return out;\n  },\n\n  /**\n   * 获取元素的投影矩阵\n   * @param {Node} node 目标元素\n   * @param {Matrix4} [out] 传递将在这个矩阵上做计算，不传将创建一个新的 Matrix4\n   * @return {Matrix4} 返回获取的矩阵\n   */\n  getModelProjectionMatrix: function getModelProjectionMatrix(node, out) {\n    out = out || new math_Matrix4();\n    out.multiply(this.viewProjectionMatrix, node.worldMatrix);\n    return out;\n  },\n\n  /**\n   * 获取世界坐标系(三维)中一个点在画布(二维)上的位置\n   * @param {Vector3} vector 点坐标\n   * @param {number} [width] 画布宽，不传的话返回-1~1\n   * @param {number} [height] 画布高，不传的话返回-1~1\n   * @return {Vector3} 返回获取的坐标位置，如 { x: 0, y: 0 }\n   */\n  projectVector: function projectVector(vector, width, height) {\n    var result = vector.clone();\n    result.transformMat4(this.viewProjectionMatrix);\n\n    if (width && height) {\n      result.x = (result.x + 1) / 2 * width;\n      result.y = height - (result.y + 1) / 2 * height;\n    }\n\n    return result;\n  },\n\n  /**\n   * 屏幕坐标转换世界坐标系\n   * @param {Vector3} vector 点坐标\n   * @param {number} [width] 画布宽，传的话vector会认为是屏幕坐标\n   * @param {number} [height] 画布高，传的话vector会认为是屏幕坐标\n   * @return {Vector3} 返回世界坐标系(三维)中一个点\n   */\n  unprojectVector: function unprojectVector(vector, width, height) {\n    var result = vector.clone();\n\n    if (width && height) {\n      result.x = result.x / width * 2 - 1;\n      result.y = 1 - result.y / height * 2;\n    }\n\n    Camera_tempMatrix4.invert(this.viewProjectionMatrix);\n    result.transformMat4(Camera_tempMatrix4);\n    return result;\n  },\n\n  /**\n   * point是否摄像机可见\n   * @param  {Vector3}  point\n   * @return {Boolean}\n   */\n  isPointVisible: function isPointVisible(point) {\n    var isPointInFrustum = this._frustum.intersectsSphere({\n      center: point,\n      radius: 0\n    });\n\n    if (isPointInFrustum) {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * mesh 是否摄像机可见\n   * @param  {Mesh}  mesh\n   * @return {Boolean}\n   */\n  isMeshVisible: function isMeshVisible(mesh) {\n    var geometry = mesh.geometry;\n\n    if (geometry) {\n      var sphere = geometry.getSphereBounds(mesh.worldMatrix);\n\n      if (this._frustum.intersectsSphere(sphere)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * 更新 frustum\n   * @param  {Matrix4} matrix\n   * @return {Camera} this\n   */\n  updateFrustum: function updateFrustum(matrix) {\n    this._frustum.fromMatrix(matrix);\n\n    return this;\n  }\n});\n/* harmony default export */ var camera_Camera = (Camera);\n// CONCATENATED MODULE: ./src/math/Vector2.js\n\n\n/**\n * 二维向量\n * @class\n */\n\nvar Vector2 = core_Class.create(\n/** @lends Vector2.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Vector2\n   */\n  className: 'Vector2',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isVector2: true,\n\n  /**\n   * Creates a new empty vec2\n   * @param {Number} [x=0] X component\n   * @param {Number} [y=0] Y component\n   * @constructs\n   */\n  constructor: function constructor() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n\n    /**\n     * 数据\n     * @type {Float32Array}\n     */\n    this.elements = gl_matrix_min[\"vec2\"].fromValues(x, y);\n  },\n\n  /**\n   * Copy the values from one vec2 to this\n   * @param  {Vector2} m the source vector\n   * @return {Vector2} this\n   */\n  copy: function copy(v) {\n    gl_matrix_min[\"vec2\"].copy(this.elements, v.elements);\n    return this;\n  },\n\n  /**\n   * Creates a new vec2 initialized with values from this vector\n   * @return {Vector2} a new Vector2\n   */\n  clone: function clone() {\n    var elements = this.elements;\n    return new this.constructor(elements[0], elements[1]);\n  },\n\n  /**\n   * 转换到数组\n   * @param  {Array}  [array=[]] 数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Array}\n   */\n  toArray: function toArray() {\n    var array = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    array[0 + offset] = elements[0];\n    array[1 + offset] = elements[1];\n    return array;\n  },\n\n  /**\n   * 从数组赋值\n   * @param  {Array} array  数组\n   * @param  {Number} [offset=0] 数组偏移值\n   * @return {Vector2} this\n   */\n  fromArray: function fromArray(array) {\n    var offset = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var elements = this.elements;\n    elements[0] = array[offset + 0];\n    elements[1] = array[offset + 1];\n    return this;\n  },\n\n  /**\n   * Set the components of a vec4 to the given values\n   * @param {Number} x X component\n   * @param {Number} y Y component\n   * @returns {Vector2} this\n   */\n  set: function set(x, y) {\n    gl_matrix_min[\"vec2\"].set(this.elements, x, y);\n    return this;\n  },\n\n  /**\n   * Adds two vec2's\n   * @param {Vector2} a\n   * @param {Vector2} [b] 如果不传，计算 this 和 a 的和\n   * @returns {Vector2} this\n   */\n  add: function add(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].add(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Subtracts vector b from vector a\n   * @param {Vector2} a\n   * @param {Vector2} [b] 如果不传，计算 this 和 a 的差\n   * @returns {Vector2} this\n   */\n  subtract: function subtract(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].subtract(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Multiplies two vec2's\n   * @param {Vector2} a\n   * @param {Vector2} [b] 如果不传，计算 this 和 a 的积\n   * @returns {Vector2} this\n   */\n  multiply: function multiply(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].multiply(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Divides two vec2's\n   * @param {Vector2} a\n   * @param {Vector2} [b] 如果不传，计算 this 和 a 的商\n   * @returns {Vector2} this\n   */\n  divide: function divide(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].divide(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.ceil the components of this\n   * @returns {Vector2} this\n   */\n  ceil: function ceil() {\n    gl_matrix_min[\"vec2\"].ceil(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Math.floor the components of this\n   * @returns {Vector2} this\n   */\n  floor: function floor() {\n    gl_matrix_min[\"vec2\"].floor(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the minimum of two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector2} this\n   */\n  min: function min(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].min(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Returns the maximum of two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b]  如果不传，计算 this 和 a 的结果\n   * @returns {Vector2} this\n   */\n  max: function max(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].max(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Math.round the components of this\n   * @returns {Vector2} this\n   */\n  round: function round() {\n    gl_matrix_min[\"vec2\"].round(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Scales this by a scalar number\n   * @param  {Number} scale amount to scale the vector by\n   * @returns {Vector2} this\n   */\n  scale: function scale(_scale) {\n    gl_matrix_min[\"vec2\"].scale(this.elements, this.elements, _scale);\n    return this;\n  },\n\n  /**\n   * Adds two vec2's after scaling the second vector by a scalar value\n   * @param  {Number} scale the amount to scale the second vector by before adding\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @returns {Vector2} this\n   */\n  scaleAndAdd: function scaleAndAdd(scale, a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].scaleAndAdd(this.elements, a.elements, b.elements, scale);\n    return this;\n  },\n\n  /**\n   * Calculates the euclidian distance between two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} distance between a and b\n   */\n  distance: function distance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec2\"].distance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the squared euclidian distance between two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number} squared distance between a and b\n   */\n  squaredDistance: function squaredDistance(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec2\"].squaredDistance(a.elements, b.elements);\n  },\n\n  /**\n   * Calculates the length of this\n   * @return {Number} length of this\n   */\n  length: function length() {\n    return gl_matrix_min[\"vec2\"].length(this.elements);\n  },\n\n  /**\n   * Calculates the squared length of this\n   * @return {Number} squared length of this\n   */\n  squaredLength: function squaredLength() {\n    return gl_matrix_min[\"vec2\"].squaredLength(this.elements);\n  },\n\n  /**\n   * Negates the components of this\n   * @returns {Vector2} this\n   */\n  negate: function negate() {\n    gl_matrix_min[\"vec2\"].negate(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Returns the inverse of the components of a vec2\n   * @param  {Vector2} [a=this]\n   * @returns {Vector2} this\n   */\n  inverse: function inverse(a) {\n    if (!a) {\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].inverse(this.elements, a.elements);\n    return this;\n  },\n\n  /**\n   * Normalize this\n   * @returns {Vector2} this\n   */\n  normalize: function normalize() {\n    gl_matrix_min[\"vec2\"].normalize(this.elements, this.elements);\n    return this;\n  },\n\n  /**\n   * Calculates the dot product of two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  product of a and b\n   */\n  dot: function dot(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec2\"].dot(a.elements, b.elements);\n  },\n\n  /**\n   * Computes the cross product of two vec2's\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Number}  cross product of a and b\n   */\n  cross: function cross(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    gl_matrix_min[\"vec2\"].cross(this.elements, a.elements, b.elements);\n    return this;\n  },\n\n  /**\n   * Performs a linear interpolation between two vec2's\n   * @param  {Vector2} v\n   * @param  {Number} t interpolation amount between the two vectors\n   * @returns {Vector2} this\n   */\n  lerp: function lerp(v, t) {\n    gl_matrix_min[\"vec2\"].lerp(this.elements, this.elements, v.elements, t);\n    return this;\n  },\n\n  /**\n   * Generates a random vector with the given scale\n   * @param  {Number} [scale=1] Length of the resulting vector. If ommitted, a unit vector will be returned\n   * @returns {Vector2} this\n   */\n  random: function random(scale) {\n    gl_matrix_min[\"vec2\"].random(this.elements, scale);\n    return this;\n  },\n\n  /**\n   * Transforms the vec2 with a mat3\n   * @param  {Matrix3} m matrix to transform with\n   * @returns {Vector2} this\n   */\n  transformMat3: function transformMat3(m) {\n    gl_matrix_min[\"vec2\"].transformMat3(this.elements, this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Transforms the vec2 with a mat4\n   * @param  {Matrix4} m matrix to transform with\n   * @returns {Vector2} this\n   */\n  transformMat4: function transformMat4(m) {\n    gl_matrix_min[\"vec2\"].transformMat4(this.elements, this.elements, m.elements);\n    return this;\n  },\n\n  /**\n   * Returns whether or not the vectors have exactly the same elements in the same position (when compared with ===)\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  exactEquals: function exactEquals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec2\"].exactEquals(a.elements, b.elements);\n  },\n\n  /**\n   * Returns whether or not the vectors have approximately the same elements in the same position.\n   * @param  {Vector2} a\n   * @param  {Vector2} [b] 如果不传，计算 this 和 a 的结果\n   * @return {Boolean} True if the vectors are equal, false otherwise.\n   */\n  equals: function equals(a, b) {\n    if (!b) {\n      b = a;\n      a = this;\n    }\n\n    return gl_matrix_min[\"vec2\"].equals(a.elements, b.elements);\n  },\n\n  /**\n   * X component\n   * @type {Number}\n   */\n  x: {\n    get: function get() {\n      return this.elements[0];\n    },\n    set: function set(value) {\n      this.elements[0] = value;\n    }\n  },\n\n  /**\n   * Y component\n   * @type {Number}\n   */\n  y: {\n    get: function get() {\n      return this.elements[1];\n    },\n    set: function set(value) {\n      this.elements[1] = value;\n    }\n  }\n});\n/**\n * Alias for {@link Vector2#subtract}\n * @function\n */\n\nVector2.prototype.sub = Vector2.prototype.subtract;\n/**\n * Alias for {@link Vector2#multiply}\n * @function\n */\n\nVector2.prototype.mul = Vector2.prototype.multiply;\n/**\n * Alias for {@link Vector2#divide}\n * @function\n */\n\nVector2.prototype.div = Vector2.prototype.divide;\n/**\n * Alias for {@link Vector2#distance}\n * @function\n */\n\nVector2.prototype.dist = Vector2.prototype.distance;\n/**\n * Alias for {@link Vector2#squaredDistance}\n * @function\n */\n\nVector2.prototype.sqrDist = Vector2.prototype.squaredDistance;\n/**\n * Alias for {@link Vector2#length}\n * @function\n */\n\nVector2.prototype.len = Vector2.prototype.length;\n/**\n * Alias for {@link Vector2#squaredLength}\n * @function\n */\n\nVector2.prototype.sqrLen = Vector2.prototype.squaredLength;\n/* harmony default export */ var math_Vector2 = (Vector2);\n// CONCATENATED MODULE: ./src/math/Sphere.js\n\n\nvar Sphere_tempVector3 = new math_Vector3();\nvar Sphere = core_Class.create(\n/** @lends Sphere.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Sphere\n   */\n  className: 'Sphere',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isSphere: true,\n\n  /**\n   * 半径\n   * @type {Number}\n   * @default 0\n   */\n  radius: 0,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    Object.assign(this, params);\n\n    if (!this.center) {\n      this.center = new math_Vector3(0, 0, 0);\n    }\n  },\n\n  /**\n   * 克隆\n   * @return {Sphere}\n   */\n  clone: function clone() {\n    var sphere = new this.constructor();\n    sphere.copy(this);\n    return sphere;\n  },\n\n  /**\n   * 复制\n   * @param  {Sphere} sphere\n   * @return {Sphere} this\n   */\n  copy: function copy(sphere) {\n    this.center.copy(sphere.center);\n    this.radius = sphere.radius;\n    return this;\n  },\n\n  /**\n   * 从点生成\n   * @param  {Array} points\n   * @return {Sphere} this\n   */\n  fromPoints: function fromPoints(points) {\n    var center = this.center;\n    var maxSquaredRadius = 0;\n\n    for (var i = 0; i < points.length; i += 3) {\n      var x = points[i] - center.x;\n      var y = points[i + 1] - center.y;\n      var z = points[i + 2] - center.z;\n      maxSquaredRadius = Math.max(x * x + y * y + z * z, maxSquaredRadius);\n    }\n\n    this.radius = Math.sqrt(maxSquaredRadius);\n    return this;\n  },\n\n  /**\n   * 从点生成\n   * @param  {GeometryData} geometryData\n   * @return {Sphere} this\n   */\n  fromGeometryData: function fromGeometryData(geometryData) {\n    var center = this.center;\n    var maxSquaredRadius = 0;\n    geometryData.traverse(function (vertexData) {\n      var x = vertexData.x - center.x;\n      var y = vertexData.y - center.y;\n      var z = vertexData.z - center.z;\n      maxSquaredRadius = Math.max(x * x + y * y + z * z, maxSquaredRadius);\n    });\n    this.radius = Math.sqrt(maxSquaredRadius);\n    return this;\n  },\n\n  /**\n   * transformMat4\n   * @param  {Matrix4} mat4\n   * @return {Sphere} this\n   */\n  transformMat4: function transformMat4(mat4) {\n    this.center.transformMat4(mat4);\n    var scale = mat4.getScaling(Sphere_tempVector3);\n    this.radius *= Math.max(scale.x, scale.y, scale.z);\n    return this;\n  }\n});\n/* harmony default export */ var math_Sphere = (Sphere);\n// CONCATENATED MODULE: ./src/geometry/GeometryData.js\n\n\n\n\n\n\n\n\nvar sizeVectorMap = {\n  2: new math_Vector2(),\n  3: new math_Vector3(),\n  4: new math_Vector4(),\n  16: new math_Matrix4()\n};\n/**\n * geometry vertex data\n * @class\n */\n\nvar GeometryData = core_Class.create(\n/** @lends GeometryData.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @readOnly\n   * @default GeometryData\n   */\n  className: 'GeometryData',\n\n  /**\n   * isGeometryData\n   * @type {Boolean}\n   * @readOnly\n   * @default true\n   */\n  isGeometryData: true,\n\n  /**\n   * The number of components per vertex attribute.Must be 1, 2, 3, or 4.\n   * @type {Number}\n   */\n  size: undefined,\n\n  /**\n   * Whether integer data values should be normalized when being casted to a float.\n   * @type {Boolean}\n   * @default false\n   */\n  normalized: false,\n\n  /**\n   * The data type of each component in the array.\n   * @type {GLenum}\n   */\n  type: undefined,\n  _isSubDirty: false,\n  _isAllDirty: false,\n\n  /**\n   * @type {Boolean}\n   * @default false\n   */\n  isDirty: {\n    get: function get() {\n      return this._isSubDirty || this._isAllDirty;\n    },\n    set: function set(value) {\n      this._isAllDirty = value;\n\n      if (value === false) {\n        this.clearSubData();\n      }\n    }\n  },\n\n  /**\n   * @type {String}\n   */\n  bufferViewId: undefined,\n\n  /**\n   * glBuffer\n   * @type {Buffer}\n   */\n  glBuffer: null,\n\n  /**\n   * @constructs\n   * @param  {TypedArray} data  数据\n   * @param  {Number} size The number of components per vertex attribute.Must be 1, 2, 3, or 4.\n   * @param  {Object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(data, size, params) {\n    /**\n     * id\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * @type {TypedArray}\n     */\n\n    this.data = data;\n    this.size = size;\n    Object.assign(this, params);\n\n    if (!this.bufferViewId) {\n      this.bufferViewId = this.id;\n    }\n\n    if (!this.size) {\n      utils_log.warn('GeometryData.constructor: geometryData must set size!', this);\n    }\n  },\n  _stride: 0,\n\n  /**\n   * The offset in bytes between the beginning of consecutive vertex attributes.\n   * @type {Number}\n   * @default this.size\n   */\n  stride: {\n    get: function get() {\n      return this._stride;\n    },\n    set: function set(value) {\n      this._stride = value;\n      this.strideSize = value === 0 ? 0 : value / this.data.BYTES_PER_ELEMENT;\n    }\n  },\n  strideSize: 0,\n  _offset: 0,\n\n  /**\n   * An offset in bytes of the first component in the vertex attribute array. Must be a multiple of type.\n   * @type {Number}\n   * @default 0\n   */\n  offset: {\n    get: function get() {\n      return this._offset;\n    },\n    set: function set(value) {\n      this._offset = value;\n      this.offsetSize = value / this.data.BYTES_PER_ELEMENT;\n    }\n  },\n  offsetSize: 0,\n\n  /**\n   * @type {TypedArray}\n   */\n  data: {\n    set: function set(data) {\n      if (data) {\n        this._data = data;\n        this.type = getTypedArrayGLType(data);\n        this.stride = this._stride;\n        this.offset = this._offset;\n        this._isAllDirty = true;\n      }\n    },\n    get: function get() {\n      return this._data;\n    }\n  },\n\n  /**\n   * @type {Number}\n   * @readOnly\n   */\n  length: {\n    get: function get() {\n      return this._data.length;\n    }\n  },\n\n  /**\n   * @type {Number}\n   * @readOnly\n   */\n  realLength: {\n    get: function get() {\n      if (this.strideSize === 0) {\n        return this._data.length;\n      }\n\n      return this._data.length / this.strideSize * this.size;\n    }\n  },\n\n  /**\n   * 获取数据大小，单位为字节\n   * @return {number} 数据大小\n   */\n  getByteLength: function getByteLength() {\n    return this._data.BYTES_PER_ELEMENT * this.realLength;\n  },\n\n  /**\n   * @type {Number}\n   * @readOnly\n   */\n  count: {\n    get: function get() {\n      if (this.strideSize === 0) {\n        return this._data.length / this.size;\n      }\n\n      return this._data.length / this.strideSize;\n    }\n  },\n\n  /**\n   * 更新部分数据\n   * @param {Number} offset 偏移index\n   * @param {TypedArray} data 数据\n   */\n  setSubData: function setSubData(offset, data) {\n    this._isSubDirty = true;\n    this.data.set(data, offset);\n\n    if (!this.subDataList) {\n      this.subDataList = [];\n    }\n\n    var byteOffset = data.BYTES_PER_ELEMENT * offset;\n    this.subDataList.push({\n      byteOffset: byteOffset,\n      data: data\n    });\n  },\n\n  /**\n   * 清除 subData\n   */\n  clearSubData: function clearSubData() {\n    if (this.subDataList) {\n      this.subDataList.length = 0;\n    }\n\n    this._isSubDirty = false;\n  },\n\n  /**\n   * clone\n   * @return {GeometryData}\n   */\n  clone: function clone() {\n    var res = new GeometryData(null, 1);\n    res.copy(this);\n    return res;\n  },\n\n  /**\n   * copy\n   * @param  {GeometryData} geometryData\n   */\n  copy: function copy(geometryData) {\n    var data = geometryData.data;\n    this.data = new data.constructor(data);\n    this.size = geometryData.size;\n    this.stride = geometryData.stride;\n    this.normalized = geometryData.normalized;\n    this.type = geometryData.type;\n    this.offset = geometryData.offset;\n  },\n\n  /**\n   * 获取偏移值\n   * @param  {Number} index\n   * @return {Number}\n   */\n  getOffset: function getOffset(index) {\n    var strideSize = this.strideSize;\n\n    if (strideSize === 0) {\n      return index * this.size;\n    }\n\n    return index * strideSize + this.offsetSize;\n  },\n\n  /**\n   * Get the value by index.\n   * Please note that it will return the same reference for performance reasons. If you want to get a copy, use #getCopy instead.\n   * @param  {Number} index\n   * @return {Number|Vector2|Vector3|Vector4}\n   */\n  get: function get(index) {\n    var offset = this.getOffset(index);\n    return this.getByOffset(offset);\n  },\n\n  /**\n   * Get the value by index.\n   * It will return a copy of value.\n   * @param  {Number} index\n   * @return {Number|Vector2|Vector3|Vector4}\n   */\n  getCopy: function getCopy(index) {\n    return this.get(index).clone();\n  },\n\n  /**\n   * 设置值\n   * @param {Number} index\n   * @param {Number|Vector2|Vector3|Vector4} value\n   */\n  set: function set(index, value) {\n    var offset = this.getOffset(index);\n    this.setByOffset(offset, value);\n    return offset;\n  },\n\n  /**\n   * 根据 offset 获取值\n   * @param  {Number} offset\n   * @return {Number|Vector2|Vector3|Vector4}\n   */\n  getByOffset: function getByOffset(offset) {\n    var size = this.size;\n\n    if (size > 1) {\n      var tempVector = sizeVectorMap[size];\n      return tempVector.fromArray(this._data, offset);\n    }\n\n    return this._data[offset];\n  },\n\n  /**\n   * 根据 offset 设置值\n   * @param {Number} offset\n   * @param {Number|Vector2|Vector3|Vector4} value\n   */\n  setByOffset: function setByOffset(offset, value) {\n    var size = this.size;\n    var data = this._data;\n\n    if (size > 1) {\n      value.toArray(data, offset);\n    } else {\n      data[offset] = value;\n    }\n\n    this._isAllDirty = true;\n  },\n\n  /**\n   * 按 index 遍历\n   * @param  {GeometryDataTraverseCallback} callback\n   * @return {Boolean}\n   */\n  traverse: function traverse(callback) {\n    var count = this.count;\n\n    for (var index = 0; index < count; index++) {\n      var offset = this.getOffset(index);\n      var attribute = this.getByOffset(offset);\n\n      if (callback(attribute, index, offset)) {\n        return true;\n      }\n    }\n\n    return false;\n  },\n\n  /**\n   * 按 Component 遍历 Component\n   * @param  {GeometryDataTraverseByComponentCallback} callback\n   * @return {Boolean}\n   */\n  traverseByComponent: function traverseByComponent(callback) {\n    var count = this.count;\n    var size = this.size;\n    var data = this._data;\n\n    for (var index = 0; index < count; index++) {\n      var offset = this.getOffset(index);\n      var componentIndex = index * size;\n\n      for (var i = 0; i < size; i++) {\n        var componentOffset = offset + i;\n\n        if (callback(data[componentOffset], componentIndex + i, componentOffset)) {\n          return true;\n        }\n      }\n    }\n\n    return false;\n  },\n  merge: function merge(geometryData, transform) {\n    if (geometryData.type !== this.type || geometryData.size !== this.size) {\n      utils_log.warn('geometryData type or size not same, cannot merge!', this, geometryData);\n      return this;\n    }\n\n    var DataClass = getTypedArrayClass(this.type);\n    var length0 = this.realLength;\n    var length1 = geometryData.realLength;\n    var newData = new DataClass(length0 + length1);\n    this.traverseByComponent(function (data, index) {\n      newData[index] = data;\n    });\n    geometryData.traverseByComponent(function (data, index) {\n      if (transform) {\n        data = transform(data, index);\n      }\n\n      newData[length0 + index] = data;\n    });\n    this.stride = 0;\n    this.offset = 0;\n    this.data = newData;\n    return this;\n  }\n});\n/* harmony default export */ var geometry_GeometryData = (GeometryData);\n/**\n * @callback GeometryDataTraverseCallback\n * @param {Number|Vector2|Vector3|Vector4} attribute\n * @param {Number} index\n * @param {Number} offset\n */\n\n/**\n * @callback GeometryDataTraverseByComponentCallback\n * @param {Number} component\n * @param {Number} index\n * @param {Number} offset\n */\n// CONCATENATED MODULE: ./src/geometry/Geometry.js\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar TRIANGLES = src_constants.TRIANGLES,\n    LINES = src_constants.LINES,\n    FRONT = src_constants.FRONT,\n    BACK = src_constants.BACK,\n    FRONT_AND_BACK = src_constants.FRONT_AND_BACK;\nvar tempVector31 = new math_Vector3();\nvar Geometry_tempVector32 = new math_Vector3();\nvar tempVector33 = new math_Vector3();\nvar tempVector41 = new math_Vector4();\nvar tempVector21 = new math_Vector2();\nvar tempVector22 = new math_Vector2();\nvar tempVector23 = new math_Vector2();\nvar tempMatrix3 = new math_Matrix3();\nvar Geometry_tempMatrix4 = new math_Matrix4();\nvar tempQuaternion = new math_Quaternion();\n/**\n * 几何体\n * @class\n * @example\n * const geometry = new Hilo3d.Geometry();\n * geometry.addFace([-0.5, -0.289, 0], [0.5, -0.289, 0], [0, 0.577, 0]);\n */\n\nvar Geometry = core_Class.create(\n/** @lends Geometry.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isGeometry: true,\n\n  /**\n   * @default Geometry\n   * @type {string}\n   */\n  className: 'Geometry',\n\n  /**\n   * 顶点数据\n   * @default null\n   * @type {GeometryData}\n   */\n  vertices: null,\n\n  /**\n   * uv 数据\n   * @default null\n   * @type {GeometryData}\n   */\n  uvs: null,\n\n  /**\n   * uv1 数据\n   * @default null\n   * @type {GeometryData}\n   */\n  uvs1: null,\n\n  /**\n   * color 数据\n   * @default null\n   * @type {GeometryData}\n   */\n  colors: null,\n\n  /**\n   * 顶点索引数据\n   * @default null\n   * @type {GeometryData}\n   */\n  indices: null,\n\n  /**\n   * 骨骼索引\n   * @default null\n   * @type {GeometryData}\n   */\n  skinIndices: null,\n\n  /**\n   * 骨骼权重数据\n   * @default null\n   * @type {GeometryData}\n   */\n  skinWeights: null,\n\n  /**\n   * 绘制模式\n   * @default TRIANGLES\n   * @type {number}\n   */\n  mode: TRIANGLES,\n\n  /**\n   * 是否是静态\n   * @type {Boolean}\n   * @default true\n   */\n  isStatic: true,\n\n  /**\n   * 是否需要更新\n   * @type {Boolean}\n   * @default true\n   */\n  isDirty: true,\n\n  /**\n   * 使用 aabb 碰撞检测\n   * @type {Boolean}\n   */\n  useAABBRaycast: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    /**\n     * id\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    Object.assign(this, params);\n    this.currentVerticesCount = 0;\n    this.currentIndicesCount = 0;\n  },\n  _needUpdateNormals: false,\n\n  /**\n   * 法向量数据，如果没有的话会自动生成\n   * @default null\n   * @type {GeometryData}\n   */\n  normals: {\n    get: function get() {\n      if (this._needUpdateNormals || !this._normals) {\n        this.calculateNormals();\n      }\n\n      return this._normals;\n    },\n    set: function set(data) {\n      this._normals = data;\n      this._needUpdateNormals = false;\n    }\n  },\n  calculateNormals: function calculateNormals() {\n    var vertices = this.vertices;\n\n    if (!vertices) {\n      utils_log.warnOnce('geometry.calculateNormals', 'geometry.calculateNormals error:no vertices data.');\n      return;\n    }\n\n    if (!this._normals) {\n      this._normals = new geometry_GeometryData(new Float32Array(vertices.realLength), 3);\n    }\n\n    var normals = this._normals;\n    var indices;\n\n    if (this.indices) {\n      indices = this.indices.data;\n    } else {\n      var len = vertices.length / 3;\n      indices = new Array(len);\n\n      for (var i = 0; i < len; i++) {\n        indices[i] = i;\n      }\n    }\n\n    var idx = 0;\n    var verticesInFaceCountList = new Uint8Array(vertices.count);\n\n    for (var _i = 0; _i < indices.length; _i += 3) {\n      idx = indices[_i];\n      tempVector31.copy(vertices.get(idx));\n      idx = indices[_i + 1];\n      Geometry_tempVector32.copy(vertices.get(idx));\n      idx = indices[_i + 2];\n      tempVector33.copy(vertices.get(idx));\n      Geometry_tempVector32.sub(tempVector31);\n      tempVector33.sub(tempVector31);\n      Geometry_tempVector32.cross(tempVector33);\n\n      for (var j = 0; j < 3; j++) {\n        idx = indices[_i + j];\n\n        if (verticesInFaceCountList[idx]) {\n          var oldNormal = normals.get(idx);\n          oldNormal.scale(verticesInFaceCountList[idx]);\n          oldNormal.add(Geometry_tempVector32);\n          oldNormal.scale(1 / (verticesInFaceCountList[idx] + 1));\n          normals.set(idx, oldNormal);\n        } else {\n          normals.set(idx, Geometry_tempVector32);\n        }\n\n        verticesInFaceCountList[idx]++;\n      }\n    }\n\n    this.isDirty = true;\n    this._needUpdateNormals = false;\n  },\n\n  /**\n   * 切线向量数据，如果没有的话会自动生成\n   * @default null\n   * @type {GeometryData}\n   */\n  tangents: {\n    get: function get() {\n      if (!this._tangents) {\n        this.calculateTangents(this.uvs, '_tangents');\n      }\n\n      return this._tangents;\n    },\n    set: function set(data) {\n      this._tangents = data;\n    }\n  },\n\n  /**\n   * 切线向量数据，如果没有的话会自动生成\n   * @default null\n   * @type {GeometryData}\n   */\n  tangents1: {\n    get: function get() {\n      if (!this._tangents1) {\n        this.calculateTangents(this.uvs1, '_tangents1');\n      }\n\n      return this._tangents1;\n    },\n    set: function set(data) {\n      this._tangents1 = data;\n    }\n  },\n  calculateTangents: function calculateTangents(uvs, tangentsName) {\n    var vertices = this.vertices;\n\n    if (!vertices) {\n      utils_log.warnOnce('geometry.calculateTangents', 'geometry.calculateTangents error:no vertices data.');\n      return;\n    }\n\n    if (!this[tangentsName]) {\n      this[tangentsName] = new geometry_GeometryData(new Float32Array(vertices.count * 4), 4);\n    }\n\n    var tangents = this[tangentsName];\n    var indices;\n\n    if (this.indices) {\n      indices = this.indices.data;\n    } else {\n      var len = vertices.length / 3;\n      indices = new Array(len);\n\n      for (var i = 0; i < len; i++) {\n        indices[i] = i;\n      }\n    }\n\n    var idx = 0;\n\n    for (var _i2 = 0; _i2 < indices.length; _i2 += 3) {\n      idx = indices[_i2];\n      tempVector31.copy(vertices.get(idx));\n      tempVector21.copy(uvs.get(idx));\n      idx = indices[_i2 + 1];\n      Geometry_tempVector32.copy(vertices.get(idx));\n      tempVector22.copy(uvs.get(idx));\n      idx = indices[_i2 + 2];\n      tempVector33.copy(vertices.get(idx));\n      tempVector23.copy(uvs.get(idx)); // eage1\n\n      Geometry_tempVector32.sub(tempVector31); // eage2\n\n      tempVector33.sub(tempVector31); // deltauv1\n\n      tempVector22.sub(tempVector21); // deltauv2\n\n      tempVector23.sub(tempVector21);\n      var f = 1 / (tempVector22.x * tempVector23.y - tempVector23.x * tempVector22.y);\n\n      if (!Number.isFinite(f)) {\n        tempVector31.x = 0;\n        tempVector31.y = 0;\n        tempVector31.z = 1;\n      } else {\n        tempVector31.x = f * (tempVector23.y * Geometry_tempVector32.x - tempVector22.y * tempVector33.x);\n        tempVector31.y = f * (tempVector23.y * Geometry_tempVector32.y - tempVector22.y * tempVector33.y);\n        tempVector31.z = f * (tempVector23.y * Geometry_tempVector32.z - tempVector22.y * tempVector33.z);\n      }\n\n      tempVector41.set(tempVector31.x, tempVector31.y, tempVector31.z, 1);\n      tangents.set(indices[_i2], tempVector41);\n      tangents.set(indices[_i2 + 1], tempVector41);\n      tangents.set(indices[_i2 + 2], tempVector41);\n    }\n\n    this.isDirty = true;\n  },\n\n  /**\n   * 将三角形模式转换为线框模式，即 Material 中的 wireframe\n   */\n  convertToLinesMode: function convertToLinesMode() {\n    if (this.mode !== TRIANGLES) {\n      utils_log.warn('Only support convert triangles to lines mode!');\n      return;\n    }\n\n    if (!this.indices) {\n      utils_log.warn('Has no indices!');\n      return;\n    }\n\n    var newIndices = new Uint16Array(this.indices.length * 2);\n    var data = this.indices.data;\n\n    for (var i = 0; i < data.length; i += 3) {\n      newIndices[i * 2] = data[i]; // A\n\n      newIndices[i * 2 + 1] = data[i + 1]; // B\n\n      newIndices[i * 2 + 2] = data[i + 1]; // B\n\n      newIndices[i * 2 + 3] = data[i + 2]; // C\n\n      newIndices[i * 2 + 4] = data[i + 2]; // C\n\n      newIndices[i * 2 + 5] = data[i]; // A\n    }\n\n    this.indices.data = newIndices;\n    this.mode = LINES;\n  },\n\n  /**\n   * 平移\n   * @param  {Number} [x=0]\n   * @param  {Number} [y=0]\n   * @param  {Number} [z=0]\n   * @return {Geometry} this\n   */\n  translate: function translate() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    this.transformMat4(Geometry_tempMatrix4.fromTranslation(tempVector31.set(x, y, z)));\n    return this;\n  },\n\n  /**\n   * 缩放\n   * @param  {Number} [x=1]\n   * @param  {Number} [y=1]\n   * @param  {Number} [z=1]\n   * @return {Geometry} this\n   */\n  scale: function scale() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 1;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    this.transformMat4(Geometry_tempMatrix4.fromScaling(tempVector31.set(x, y, z)));\n    return this;\n  },\n\n  /**\n   * 旋转\n   * @param  {Number} [x=0] 旋转角度x\n   * @param  {Number} [y=0] 旋转角度y\n   * @param  {Number} [z=0] 旋转角度z\n   * @return {Geometry} this\n   */\n  rotate: function rotate() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var z = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    this.transformMat4(Geometry_tempMatrix4.fromQuat(tempQuaternion.fromEuler({\n      x: x * math_math.DEG2RAD,\n      y: y * math_math.DEG2RAD,\n      z: z * math_math.DEG2RAD\n    })));\n    return this;\n  },\n\n  /**\n   * Transforms the geometry with a mat4.\n   * @param  {Matrix4} mat4\n   * @return {Geometry} this\n   */\n  transformMat4: function transformMat4(mat4) {\n    var vertices = this.vertices;\n\n    if (vertices) {\n      vertices.traverse(function (vertex, index, offset) {\n        vertices.setByOffset(offset, vertex.transformMat4(mat4));\n      });\n    }\n\n    tempMatrix3.normalFromMat4(mat4);\n\n    if (this._normals) {\n      var normals = this.normals;\n      normals.traverse(function (vertex, index, offset) {\n        normals.setByOffset(offset, vertex.transformMat3(tempMatrix3).normalize());\n      });\n    }\n\n    if (this._tangents) {\n      var tangents = this.tangents;\n      tangents.traverse(function (vertex, index, offset) {\n        tangents.setByOffset(offset, vertex.transformMat3(tempMatrix3).normalize());\n      });\n    }\n\n    this.isDirty = true;\n    return this;\n  },\n\n  /**\n   * 合并两个 geometry\n   * @param  {Geometry} geometry\n   * @param  {Matrix4} [matrix=null] 合并的矩阵\n   * @return {Geometry} this\n   */\n  merge: function merge(geometry, matrix) {\n    var vertices = geometry.vertices;\n\n    if (vertices && this.vertices) {\n      var count = this.vertices.count;\n\n      if (matrix) {\n        vertices = geometry.vertices.clone();\n        vertices.traverse(function (vertex, index, offset) {\n          vertices.setByOffset(offset, vertex.transformMat4(matrix));\n        });\n      }\n\n      this.vertices.merge(vertices);\n\n      if (this.indices && geometry.indices) {\n        this.indices.merge(geometry.indices, function (data) {\n          return data + count;\n        });\n      } else {\n        this.indices = null;\n      }\n    }\n\n    if (this.uvs && geometry.uvs) {\n      this.uvs.merge(geometry.uvs);\n    } else {\n      this.uvs = null;\n    }\n\n    if (this.uvs1 && geometry.uvs1) {\n      this.uvs1.merge(geometry.uvs1);\n    } else {\n      this.uvs1 = null;\n    }\n\n    if (this.colors && geometry.colors) {\n      this.colors.merge(geometry.colors);\n    } else {\n      this.colors = null;\n    }\n\n    if (this._normals) {\n      this._normals = null;\n    }\n\n    if (this._tangents) {\n      this._tangents = null;\n    }\n\n    if (this._tangents1) {\n      this._tangents1 = null;\n    }\n\n    this.isDirty = true;\n    return this;\n  },\n  ensureData: function ensureData(name, size, total, TypedArray) {\n    var geometryData = this[name];\n\n    if (!geometryData || total > geometryData.length) {\n      var newData = new TypedArray(total);\n\n      if (geometryData) {\n        newData.set(geometryData.data);\n        geometryData.data = newData;\n      } else {\n        this[name] = new geometry_GeometryData(newData, size);\n      }\n    }\n  },\n\n  /**\n   * 添加顶点\n   * @param {...number[]} points 顶点坐标，如 addPoints([x, y, z], [x, y, z])\n   */\n  addPoints: function addPoints() {\n    var _this = this;\n\n    var points = [].slice.call(arguments);\n    var total = (this.currentVerticesCount + points.length) * 3;\n    this.ensureData('vertices', 3, total, Float32Array);\n    var data = this.vertices.data;\n    points.forEach(function (point) {\n      var start = _this.currentVerticesCount++ * 3;\n      data[start] = point[0];\n      data[start + 1] = point[1];\n      data[start + 2] = point[2];\n    });\n    return this.currentVerticesCount - points.length;\n  },\n\n  /**\n   * 添加顶点索引\n   * @param {...number} indices 顶点索引，如 addIndices(0, 1, 2)\n   */\n  addIndices: function addIndices() {\n    var _this2 = this;\n\n    var indices = [].slice.call(arguments);\n    var total = this.currentIndicesCount + indices.length;\n    this.ensureData('indices', 1, total, Uint16Array);\n    var data = this.indices.data;\n    indices.forEach(function (idx) {\n      data[_this2.currentIndicesCount++] = idx;\n    });\n    this._needUpdateNormals = true;\n  },\n\n  /**\n   * 添加一条线\n   * @param {number[]} p1 起点坐标，如 [x, y, z]\n   * @param {number[]} p2 终点坐标\n   */\n  addLine: function addLine(p1, p2) {\n    var start = this.addPoints(p1, p2);\n    this.addIndices(start, start + 1);\n  },\n\n  /**\n   * 添加一个三角形 ABC\n   * @param {number[]} p1 点A，如 [x, y, z]\n   * @param {number[]} p2 点B\n   * @param {number[]} p3 点C\n   */\n  addFace: function addFace(p1, p2, p3) {\n    var start = this.addPoints(p1, p2, p3);\n    this.addIndices(start, start + 1, start + 2);\n  },\n\n  /**\n   * 添加一个矩形 ABCD\n   * @param {number[]} p1 点A，如 [x, y, z]\n   * @param {number[]} p2 点B\n   * @param {number[]} p3 点C\n   * @param {number[]} p4 点D\n   */\n  addRect: function addRect(p1, p2, p3, p4) {\n    var start = this.addPoints(p1, p2, p3, p4); // 0 1 2 & 0 2 3 make a rect\n\n    this.addIndices(start, start + 1, start + 2, start, start + 2, start + 3);\n  },\n\n  /**\n   * 设置顶点对应的uv坐标\n   * @param {number} start 开始的顶点索引\n   * @param {number[][]} uvs uv坐标数据，如 [[0, 0], [1, 0]]\n   */\n  setVertexUV: function setVertexUV(start, uvs) {\n    this.ensureData('uvs', 2, this.vertices.length / 3 * 2, Float32Array);\n    var data = this.uvs.data;\n\n    for (var i = 0; i < uvs.length; i++) {\n      data[start + i * 2] = uvs[i][0];\n      data[start + i * 2 + 1] = uvs[i][1];\n    }\n  },\n\n  /**\n   * 设置三角形ABC的uv\n   * @param {number} start 开始的顶点索引\n   * @param {number[]} p1 点A的uv，如 [0, 0]\n   * @param {number[]} p2 点B的uv\n   * @param {number[]} p3 点C的uv\n   */\n  setFaceUV: function setFaceUV(start, p1, p2, p3) {\n    this.setVertexUV(start, [p1, p2, p3]);\n  },\n\n  /**\n   * 设置矩形ABCD的uv\n   * @param {number} start 开始的顶点索引\n   * @param {number[]} p1 点A的uv，如 [0, 0]\n   * @param {number[]} p2 点B的uv\n   * @param {number[]} p3 点C的uv\n   * @param {number[]} p4 点D的uv\n   */\n  setRectUV: function setRectUV(start, p1, p2, p3, p4) {\n    this.setVertexUV(start, [p1, p2, p3, p4]);\n  },\n\n  /**\n   * 获取指定matrix变化后的包围盒数据\n   *\n   * @param {Matrix4} [matrix=null] matrix 需要变换的矩阵\n   * @param {Bounds} [bounds=null] 包围盒数据，传入的话会改变他\n   * @return {Bounds} 包围盒数据\n   */\n  getBounds: function getBounds(matrix, bounds) {\n    if (!bounds) {\n      bounds = {\n        xMin: Infinity,\n        xMax: -Infinity,\n        yMin: Infinity,\n        yMax: -Infinity,\n        zMin: Infinity,\n        zMax: -Infinity\n      };\n    }\n\n    var vertices = this.vertices;\n\n    if (!vertices) {\n      utils_log.warnOnce('geometry.getBounds', 'geometry has no vertices data, geometry.getBounds will return Infinity bounds.');\n      return bounds;\n    }\n\n    vertices.traverse(function (vertexData) {\n      if (matrix) {\n        vertexData.transformMat4(matrix);\n      }\n\n      bounds.xMax = Math.max(bounds.xMax, vertexData.x);\n      bounds.yMax = Math.max(bounds.yMax, vertexData.y);\n      bounds.zMax = Math.max(bounds.zMax, vertexData.z);\n      bounds.xMin = Math.min(bounds.xMin, vertexData.x);\n      bounds.yMin = Math.min(bounds.yMin, vertexData.y);\n      bounds.zMin = Math.min(bounds.zMin, vertexData.z);\n    });\n    bounds.width = bounds.xMax - bounds.xMin;\n    bounds.height = bounds.yMax - bounds.yMin;\n    bounds.depth = bounds.zMax - bounds.zMin;\n    bounds.x = (bounds.xMin + bounds.xMax) / 2;\n    bounds.y = (bounds.yMin + bounds.yMax) / 2;\n    bounds.z = (bounds.zMin + bounds.zMax) / 2;\n    return bounds;\n  },\n\n  /**\n   * 获取本地包围盒\n   * @param  {Boolean} [force=false] 是否强制刷新\n   * @return {Bounds}\n   */\n  getLocalBounds: function getLocalBounds() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (!this._localBounds || force) {\n      this._localBounds = this.getBounds();\n    }\n\n    return this._localBounds;\n  },\n\n  /**\n   * 获取球面包围盒\n   * @param  {Matrix4} matrix\n   * @return {Sphere}\n   */\n  getSphereBounds: function getSphereBounds(matrix) {\n    if (!this._sphereBounds) {\n      this._sphereBounds = new math_Sphere();\n    }\n\n    var sphereBounds = this._sphereBounds;\n    sphereBounds.copy(this.getLocalSphereBounds());\n\n    if (matrix) {\n      sphereBounds.transformMat4(matrix);\n    }\n\n    return sphereBounds;\n  },\n\n  /**\n   * 获取本地球面包围盒\n   * @param  {Boolean} [force=false] 是否强制刷新\n   * @return {Sphere}\n   */\n  getLocalSphereBounds: function getLocalSphereBounds() {\n    var force = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : false;\n\n    if (!this._localSphereBounds || force) {\n      var localBounds = this.getLocalBounds(force);\n      var sphere = new math_Sphere({\n        center: new math_Vector3(localBounds.x, localBounds.y, localBounds.z)\n      });\n      var vertices = this.vertices;\n\n      if (vertices) {\n        sphere.fromGeometryData(vertices);\n      } else {\n        utils_log.warnOnce('geometry.getLocalSphereBounds', 'geometry has no vertices data, geometry.getLocalSphereBounds will return Infinity bounds.');\n        sphere.radius = Infinity;\n      }\n\n      this._localSphereBounds = sphere;\n    }\n\n    return this._localSphereBounds;\n  },\n\n  /**\n   * 将 Geometry 转换成无 indices\n   * @param {number} [verticesItemLen=3] 转换结果的顶点数据的位数(3 or 4)，如果为4会补1\n   */\n  convertToNoIndices: function convertToNoIndices() {\n    var verticesItemLen = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 3;\n\n    if (this.mode !== TRIANGLES) {\n      utils_log.warn('Only support convert triangles to lines mode!');\n      return;\n    }\n\n    if (!this.indices) {\n      utils_log.warn('Has no indices!');\n      return;\n    }\n\n    var indices = this.indices.data;\n    var indicesLen = indices.length;\n    var vertices = new Float32Array(indicesLen * verticesItemLen);\n    var uvs = this.uvs ? new Float32Array(indicesLen * 2) : null;\n    var normals = new Float32Array(indicesLen * 3);\n    var colors = this.colors ? new Float32Array(this.colors.size * indicesLen) : null;\n    var skinIndices = this.skinIndices ? new Float32Array(indicesLen * 4) : null;\n    var skinWeights = this.skinWeights ? new Float32Array(indicesLen * 4) : null;\n\n    for (var i = 0; i < indicesLen; i++) {\n      var idx = indices[i];\n      copyArrayData(vertices, this.vertices, i * verticesItemLen, idx * 3, 3);\n\n      if (verticesItemLen === 4) {\n        vertices[i * 4 + 3] = 1;\n      }\n\n      copyArrayData(uvs, this.uvs, i * 2, idx * 2, 2);\n      copyArrayData(normals, this.normals, i * 3, idx * 3, 3);\n      copyArrayData(skinIndices, this.skinIndices, i * 4, idx * 4, 4);\n      copyArrayData(skinWeights, this.skinWeights, i * 4, idx * 4, 4);\n\n      if (this.colors) {\n        copyArrayData(colors, this.colors, i * this.colors.size, idx * this.colors.size, this.colors.size);\n      }\n    }\n\n    delete this.indices;\n    this.vertices.data = vertices;\n\n    if (this.uvs) {\n      this.uvs.data = uvs;\n    }\n\n    if (this.normals) {\n      this.normals.data = normals;\n    }\n\n    if (this.colors) {\n      this.colors.data = colors;\n    }\n\n    if (this.skinIndices) {\n      this.skinIndices.data = skinIndices;\n    }\n\n    if (this.skinWeights) {\n      this.skinWeights.data = skinWeights;\n    }\n  },\n\n  /**\n   * clone当前Geometry\n   * @return {Geometry} 返回clone的Geometry\n   */\n  clone: function clone() {\n    var geometry = new this.constructor({\n      mode: this.mode\n    });\n\n    if (this.vertices) {\n      geometry.vertices = this.vertices.clone();\n    }\n\n    if (this.uvs) {\n      geometry.uvs = this.uvs.clone();\n    }\n\n    if (this.uvs1) {\n      geometry.uvs1 = this.uvs1.clone();\n    }\n\n    if (this.colors) {\n      geometry.colors = this.colors.clone();\n    }\n\n    if (this.indices) {\n      geometry.indices = this.indices.clone();\n    }\n\n    if (this.skinWeights) {\n      geometry.skinWeights = this.skinWeights.clone();\n    }\n\n    if (this.skinIndices) {\n      geometry.skinIndices = this.skinIndices.clone();\n    }\n\n    if (this._normals) {\n      geometry._normals = this._normals.clone();\n    }\n\n    if (this._tangents) {\n      geometry._tangents = this._tangents.clone();\n    }\n\n    if (this._tangents1) {\n      geometry._tangents1 = this._tangents1.clone();\n    }\n\n    if (this.positionDecodeMat) {\n      geometry.positionDecodeMat = this.positionDecodeMat;\n    }\n\n    if (this.uvDecodeMat) {\n      geometry.uvDecodeMat = this.uvDecodeMat;\n    }\n\n    if (this.uv1DecodeMat) {\n      geometry.uv1DecodeMat = this.uv1DecodeMat;\n    }\n\n    if (this.normalDecodeMat) {\n      geometry.normalDecodeMat = this.normalDecodeMat;\n    }\n\n    return geometry;\n  },\n\n  /**\n   * 检测 aabb 碰撞\n   * @param  {Ray} ray\n   * @return {Vector3[]|null}\n   */\n  _aabbRaycast: function _aabbRaycast(ray) {\n    var bounds = this.getLocalBounds();\n    var res = ray.intersectsBox([[bounds.xMin, bounds.yMin, bounds.zMin], [bounds.xMax, bounds.yMax, bounds.zMax]]);\n\n    if (res) {\n      return [res];\n    }\n\n    return null;\n  },\n\n  /**\n   * _raycast，子类可覆盖实现\n   * @param  {Ray} ray\n   * @param  {GLenum} side\n   * @return {Vector3[]|null}\n   */\n  _raycast: function _raycast(ray, side) {\n    // TODO:optimize\n    var vertices = this.vertices;\n\n    if (!vertices) {\n      return null;\n    }\n\n    var indices = this.indices;\n    var triangle = [];\n    var resArray = [];\n    var len;\n\n    if (indices) {\n      len = indices.realLength;\n    } else {\n      len = vertices.realLength / 3;\n    }\n\n    for (var i = 0; i < len; i += 3) {\n      var idx = indices ? indices.get(i) : i;\n      tempVector31.copy(vertices.get(idx));\n      idx = indices ? indices.get(i + 1) : i + 1;\n      Geometry_tempVector32.copy(vertices.get(idx));\n      idx = indices ? indices.get(i + 2) : i + 2;\n      tempVector33.copy(vertices.get(idx));\n      var res = void 0;\n\n      if (side === FRONT) {\n        triangle[0] = tempVector31.elements;\n        triangle[1] = Geometry_tempVector32.elements;\n        triangle[2] = tempVector33.elements;\n        res = ray.intersectsTriangle(triangle);\n      } else if (side === BACK) {\n        triangle[1] = tempVector31.elements;\n        triangle[0] = Geometry_tempVector32.elements;\n        triangle[2] = tempVector33.elements;\n        res = ray.intersectsTriangle(triangle);\n      } else if (side === FRONT_AND_BACK) {\n        triangle[0] = tempVector31.elements;\n        triangle[1] = Geometry_tempVector32.elements;\n        triangle[2] = tempVector33.elements;\n        res = ray.intersectsTriangle(triangle);\n\n        if (!res) {\n          triangle[1] = tempVector31.elements;\n          triangle[0] = Geometry_tempVector32.elements;\n          triangle[2] = tempVector33.elements;\n          res = ray.intersectsTriangle(triangle);\n        }\n      }\n\n      if (res) {\n        resArray.push(res);\n      }\n    }\n\n    return resArray.length ? resArray : null;\n  },\n\n  /**\n   * raycast\n   * @param  {Ray} ray\n   * @param  {GLenum} side\n   * @param {Boolean} [sort=true] 是否按距离排序\n   * @return {Vector3[]|null}\n   */\n  raycast: function raycast(ray, side) {\n    var sort = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : true;\n    var res;\n\n    if (this.useAABBRaycast) {\n      res = this._aabbRaycast(ray);\n    } else {\n      res = this._raycast(ray, side);\n    }\n\n    if (res && sort) {\n      ray.sortPoints(res);\n    }\n\n    return res;\n  },\n  getRenderOption: function getRenderOption() {\n    var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n    if (this.positionDecodeMat) {\n      opt.QUANTIZED = 1;\n      opt.POSITION_QUANTIZED = 1;\n    }\n\n    if (this.normalDecodeMat) {\n      opt.QUANTIZED = 1;\n      opt.NORMAL_QUANTIZED = 1;\n    }\n\n    if (this.uvDecodeMat) {\n      opt.QUANTIZED = 1;\n      opt.UV_QUANTIZED = 1;\n    }\n\n    if (this.uv1DecodeMat) {\n      opt.QUANTIZED = 1;\n      opt.UV1_QUANTIZED = 1;\n    }\n\n    if (this.colors) {\n      opt.HAS_COLOR = 1;\n      opt.COLOR_SIZE = this.colors.size;\n    }\n\n    return opt;\n  },\n  getShaderKey: function getShaderKey() {\n    if (this._shaderKey === undefined) {\n      this._shaderKey = 'geometry';\n\n      if (this.isMorphGeometry) {\n        this._shaderKey += \"_id_\".concat(this.id);\n      } else {\n        if (this.colors) {\n          this._shaderKey += '_colors';\n        }\n\n        if (this.positionDecodeMat) {\n          this._shaderKey += 'positionDecodeMat';\n        }\n      }\n    }\n\n    return this._shaderKey;\n  },\n\n  /**\n   * 获取数据的内存大小，只处理顶点数据，单位为字节\n   * @return {number} 内存占用大小\n   */\n  getSize: function getSize() {\n    var sum = 0;\n\n    for (var key in this) {\n      if (util_hasOwnProperty(this, key) && this[key] && this[key].isGeometryData) {\n        sum += this[key].getByteLength();\n      }\n    }\n\n    return sum;\n  },\n\n  /**\n   * @deprecated\n   * @return {Geometry} this\n   */\n  destroy: function destroy() {\n    utils_log.warn('Geometry.destroy has been deprecated, use mesh.destroy(renderer) instead.');\n  }\n});\n/* harmony default export */ var geometry_Geometry = (Geometry);\n// CONCATENATED MODULE: ./src/camera/PerspectiveCamera.js\n\n\n\n\n/**\n * 透视投影摄像机\n * @class\n * @extends Camera\n */\n\nvar PerspectiveCamera = core_Class.create(\n/** @lends PerspectiveCamera.prototype */\n{\n  Extends: camera_Camera,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isPerspectiveCamera: true,\n\n  /**\n   * @default PerspectiveCamera\n   * @type {string}\n   */\n  className: 'PerspectiveCamera',\n  _near: 0.1,\n\n  /**\n   * 相机视锥体近平面z\n   * @default 0.1\n   * @type {number}\n   */\n  near: {\n    get: function get() {\n      return this._near;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._near = value;\n    }\n  },\n  _far: null,\n\n  /**\n   * 相机视锥体远平面z，null 时为无限远\n   * @default null\n   * @type {number}\n   */\n  far: {\n    get: function get() {\n      return this._far;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._far = value;\n    }\n  },\n  _fov: 50,\n\n  /**\n   * 相机视野大小，角度制\n   * @default 50\n   * @type {number}\n   */\n  fov: {\n    get: function get() {\n      return this._fov;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._fov = value;\n    }\n  },\n  _aspect: 1,\n\n  /**\n   * 宽高比\n   * @default 1\n   * @type {number}\n   */\n  aspect: {\n    get: function get() {\n      return this._aspect;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._aspect = value;\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {number} [params.fov=50] 相机视野大小，角度制\n   * @param {number} [params.near=0.1] 相机视锥体近平面z\n   * @param {number} [params.far=null] 相机视锥体远平面z，null 时为无限远\n   * @param {number} [params.aspect=1] 宽高比\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    PerspectiveCamera.superclass.constructor.call(this, params);\n    this.updateProjectionMatrix();\n  },\n\n  /**\n   * 更新投影矩阵\n   */\n  updateProjectionMatrix: function updateProjectionMatrix() {\n    // this.projectionMatrix.perspective(math.degToRad(this.fov), this.aspect, this.near, this.far);\n    var elements = this.projectionMatrix.elements;\n    var near = this.near,\n        far = this.far,\n        aspect = this.aspect,\n        fov = this.fov;\n    var f = 1 / Math.tan(0.5 * math_math.degToRad(fov));\n    elements[0] = f / aspect;\n    elements[5] = f;\n    elements[11] = -1;\n    elements[15] = 0;\n\n    if (far) {\n      var nf = 1 / (near - far);\n      elements[10] = (near + far) * nf;\n      elements[14] = 2 * far * near * nf;\n    } else {\n      elements[10] = -1;\n      elements[14] = -2 * near;\n    }\n  },\n  getGeometry: function getGeometry(forceUpdate) {\n    if (forceUpdate || !this._geometry || this._isGeometryDirty) {\n      this._isGeometryDirty = false;\n      var geometry = new geometry_Geometry();\n      var tan = Math.tan(this.fov / 2 * Math.PI / 180);\n      var near = this.near;\n      var far = this.far;\n      var vNear = near * tan;\n      var vFar = far * tan;\n      var hNear = this.aspect * vNear;\n      var hFar = this.aspect * vFar;\n      var p1 = [-hNear, -vNear, -near];\n      var p2 = [hNear, -vNear, -near];\n      var p3 = [hNear, vNear, -near];\n      var p4 = [-hNear, vNear, -near];\n      var p5 = [-hFar, -vFar, -far];\n      var p6 = [hFar, -vFar, -far];\n      var p7 = [hFar, vFar, -far];\n      var p8 = [-hFar, vFar, -far];\n      geometry.addRect(p5, p6, p7, p8); // front\n\n      geometry.addRect(p6, p2, p3, p7); // right\n\n      geometry.addRect(p2, p1, p4, p3); // back\n\n      geometry.addRect(p1, p5, p8, p4); // left\n\n      geometry.addRect(p8, p7, p3, p4); // top\n\n      geometry.addRect(p1, p2, p6, p5); // bottom\n\n      this._geometry = geometry;\n    }\n\n    return this._geometry;\n  }\n});\n/* harmony default export */ var camera_PerspectiveCamera = (PerspectiveCamera);\n// CONCATENATED MODULE: ./src/utils/Cache.js\n\n/**\n * 缓存类\n * @class\n * @example\n * const cache = new Hilo3d.Cache();\n * cache.add('id1', {a:1});\n * cache.get('id1');\n * cache.remove('id1');\n */\n\nvar Cache = core_Class.create(\n/** @lends Cache.prototype */\n{\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    this._cache = {};\n  },\n\n  /**\n   * 获取对象\n   * @param  {String} id\n   * @return {Object}\n   */\n  get: function get(id) {\n    return this._cache[id];\n  },\n\n  /**\n   * 获取对象\n   * @param {Object} obj\n   * @return {Object} [description]\n   */\n  getObject: function getObject(obj) {\n    return this._cache[obj.__cacheId];\n  },\n\n  /**\n   * 增加对象\n   * @param {String} id\n   * @param {Object} obj\n   */\n  add: function add(id, obj) {\n    if (typeof obj === 'object') {\n      obj.__cacheId = id;\n    }\n\n    this._cache[id] = obj;\n  },\n\n  /**\n   * 移除对象\n   * @param {String} id\n   */\n  remove: function remove(id) {\n    delete this._cache[id];\n  },\n\n  /**\n   * 移除对象\n   * @param {Object} obj\n   */\n  removeObject: function removeObject(obj) {\n    delete this._cache[obj.__cacheId];\n  },\n\n  /**\n   * 移除所有对象\n   */\n  removeAll: function removeAll() {\n    this._cache = {};\n  },\n\n  /**\n   * 遍历所有缓存\n   * @param  {Function} callback\n   */\n  each: function each(callback) {\n    var cache = this._cache;\n\n    for (var id in cache) {\n      callback(cache[id], id);\n    }\n  }\n});\n/* harmony default export */ var utils_Cache = (Cache);\n// CONCATENATED MODULE: ./src/renderer/extensions.js\n/**\n * WebGL 扩展\n * @namespace extensions\n * @type {Object}\n * @description WebGL 扩展管理，默认开启的扩展有：ANGLE_instanced_arrays, OES_vertex_array_object, OES_texture_float, WEBGL_lose_context, OES_element_index_uint, EXT_shader_texture_lod\n */\nvar extensions_extensions = {\n  /**\n   * ANGLE_instanced_arrays扩展\n   * @type {ANGLEInstancedArrays}\n   */\n  instanced: undefined,\n\n  /**\n   * OES_vertex_array_object扩展\n   * @type {OESVertexArrayObject}\n   */\n  vao: undefined,\n\n  /**\n   * OES_texture_float扩展\n   * @type {OESTextureFloat}\n   */\n  texFloat: undefined,\n\n  /**\n   * WEBGL_lose_context扩展\n   * @type {WebGLLoseContext}\n   */\n  loseContext: undefined,\n\n  /**\n   * EXT_texture_filter_anisotropic\n   * @type {EXTTextureFilterAnisotropic}\n   */\n  textureFilterAnisotropic: undefined,\n  _usedExtensions: {},\n  _disabledExtensions: {},\n\n  /**\n   * 初始化\n   * @param {WebGLRenderingContext} gl\n   */\n  init: function init(gl) {\n    this.reset(gl);\n  },\n\n  /**\n   * 重置扩展\n   * @param {WebGLRenderingContext} gl\n   */\n  reset: function reset(gl) {\n    this.gl = gl;\n    var usedExtensions = this._usedExtensions;\n\n    for (var name in usedExtensions) {\n      var alias = usedExtensions[name];\n      this[alias] = undefined;\n      this.get(name, alias);\n    }\n  },\n\n  /**\n   * 使用扩展\n   * @param  {String} name 扩展名称\n   * @param {String} [alias=name] 别名，默认和 name 相同\n   */\n  use: function use(name) {\n    var alias = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : name;\n\n    if (this.gl) {\n      this.get(name, alias);\n    } else {\n      this._usedExtensions[name] = alias;\n    }\n  },\n\n  /**\n   * 获取扩展，如果不支持返回 null，必须在 Renderer 初始化完后用\n   * @param  {String} name 扩展名称\n   * @param {String} [alias=name] 别名，默认和 name 相同\n   * @return {Object|null}\n   */\n  get: function get(name) {\n    var alias = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : name;\n\n    if (this._disabledExtensions[name]) {\n      return null;\n    }\n\n    var ext = this[alias];\n\n    if (ext === undefined) {\n      ext = this._getExtension(name);\n      this[alias] = ext;\n    }\n\n    return ext;\n  },\n\n  /**\n   * 禁止扩展\n   * @param  {String} name 扩展名称\n   */\n  disable: function disable(name) {\n    this._disabledExtensions[name] = true;\n  },\n\n  /**\n   * 开启扩展\n   * @param  {String} name 扩展名称\n   */\n  enable: function enable(name) {\n    this._disabledExtensions[name] = false;\n  },\n  _getExtension: function _getExtension(name) {\n    var gl = this.gl;\n\n    if (gl && gl.getExtension) {\n      return gl.getExtension(name) || gl.getExtension('WEBKIT_' + name) || gl.getExtension('MOZ_' + name) || null;\n    }\n\n    return null;\n  }\n};\nextensions_extensions.use('ANGLE_instanced_arrays', 'instanced');\nextensions_extensions.use('OES_vertex_array_object', 'vao');\nextensions_extensions.use('OES_texture_float', 'texFloat');\nextensions_extensions.use('WEBGL_lose_context', 'loseContext');\nextensions_extensions.use('OES_element_index_uint', 'uintIndices');\nextensions_extensions.use('EXT_shader_texture_lod', 'shaderTextureLod');\nextensions_extensions.use('EXT_texture_filter_anisotropic', 'textureFilterAnisotropic');\n/* harmony default export */ var renderer_extensions = (extensions_extensions);\n/**\n * @typedef {any} ANGLEInstancedArrays\n */\n\n/**\n * @typedef {any} OESVertexArrayObject\n */\n\n/**\n * @typedef {any} OESTextureFloat\n */\n\n/**\n * @typedef {any} WebGLLoseContext\n */\n\n/**\n * @typedef {any} EXTTextureFilterAnisotropic\n */\n// CONCATENATED MODULE: ./src/renderer/capabilities.js\n\n/**\n * WebGL 能力\n * @namespace capabilities\n * @type {Object}\n */\n\nvar capabilities = {\n  /**\n   * 最大纹理数量\n   * @type {Number}\n   */\n  MAX_TEXTURE_INDEX: null,\n\n  /**\n   * 最高着色器精度, 可以是以下值：highp, mediump, lowp\n   * @type {String}\n   */\n  MAX_PRECISION: null,\n\n  /**\n   * 最高顶点着色器精度, 可以是以下值：highp, mediump, lowp\n   * @type {String}\n   */\n  MAX_VERTEX_PRECISION: null,\n\n  /**\n   * 最高片段着色器精度, 可以是以下值：highp, mediump, lowp\n   * @type {String}\n   */\n  MAX_FRAGMENT_PRECISION: null,\n\n  /**\n   * 顶点浮点数纹理\n   * @type {Boolean}\n   */\n  VERTEX_TEXTURE_FLOAT: null,\n\n  /**\n   * 片段浮点数纹理\n   * @type {Boolean}\n   */\n  FRAGMENT_TEXTURE_FLOAT: null,\n\n  /**\n   * MAX_TEXTURE_MAX_ANISOTROPY\n   * @type {Number}\n   */\n  MAX_TEXTURE_MAX_ANISOTROPY: 1,\n\n  /**\n   * 初始化\n   * @param {WebGLRenderingContext} gl\n   */\n  init: function init(gl) {\n    var _this = this;\n\n    this.gl = gl;\n    var arr = ['MAX_RENDERBUFFER_SIZE', 'MAX_COMBINED_TEXTURE_IMAGE_UNITS', 'MAX_CUBE_MAP_TEXTURE_SIZE', 'MAX_FRAGMENT_UNIFORM_VECTORS', 'MAX_TEXTURE_IMAGE_UNITS', 'MAX_TEXTURE_SIZE', 'MAX_VARYING_VECTORS', 'MAX_VERTEX_ATTRIBS', 'MAX_VERTEX_TEXTURE_IMAGE_UNITS', 'MAX_VERTEX_UNIFORM_VECTORS', 'MAX_COMBINED_TEXTURE_IMAGE_UNITS'];\n    arr.forEach(function (name) {\n      _this.get(name);\n    });\n    this.MAX_TEXTURE_INDEX = this.MAX_COMBINED_TEXTURE_IMAGE_UNITS - 1;\n    this.MAX_VERTEX_PRECISION = this._getMaxSupportPrecision(gl.VERTEX_SHADER);\n    this.MAX_FRAGMENT_PRECISION = this._getMaxSupportPrecision(gl.FRAGMENT_SHADER);\n    this.MAX_PRECISION = this.getMaxPrecision(this.MAX_FRAGMENT_PRECISION, this.MAX_VERTEX_PRECISION);\n    this.VERTEX_TEXTURE_FLOAT = !!renderer_extensions.texFloat && this.MAX_VERTEX_TEXTURE_IMAGE_UNITS > 0;\n    this.FRAGMENT_TEXTURE_FLOAT = !!renderer_extensions.texFloat;\n    this.EXT_FRAG_DEPTH = renderer_extensions.get('EXT_frag_depth');\n    this.SHADER_TEXTURE_LOD = !!renderer_extensions.shaderTextureLod;\n\n    if (renderer_extensions.textureFilterAnisotropic) {\n      this.MAX_TEXTURE_MAX_ANISOTROPY = gl.getParameter(renderer_extensions.textureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\n    }\n  },\n\n  /**\n   * 获取 WebGL 能力\n   * @param  {String} name\n   * @return {Number|String}\n   */\n  get: function get(name) {\n    var gl = this.gl;\n    var value = this[name];\n\n    if (value === undefined) {\n      value = this[name] = gl.getParameter(gl[name]);\n    }\n\n    return value;\n  },\n  _getMaxSupportPrecision: function _getMaxSupportPrecision(shaderType) {\n    var gl = this.gl;\n    var maxPrecision = 'lowp';\n\n    if (gl.getShaderPrecisionFormat) {\n      var precisions = [{\n        name: 'highp',\n        type: gl.HIGH_FLOAT\n      }, {\n        name: 'mediump',\n        type: gl.MEDIUM_FLOAT\n      }];\n\n      for (var i = 0; i < precisions.length; i++) {\n        var precision = precisions[i];\n        var precisionFormat = gl.getShaderPrecisionFormat(shaderType, precision.type) || {};\n\n        if (precisionFormat.precision > 0) {\n          maxPrecision = precision.name;\n          break;\n        }\n      }\n    } else {\n      maxPrecision = 'mediump';\n    }\n\n    return maxPrecision;\n  },\n\n  /**\n   * 获取最大支持精度\n   * @param  {String} a\n   * @param  {String} b\n   * @return {String}\n   */\n  getMaxPrecision: function getMaxPrecision(a, b) {\n    if (a === 'highp' || a === 'mediump' && b === 'lowp') {\n      return b;\n    }\n\n    return a;\n  }\n};\n/* harmony default export */ var renderer_capabilities = (capabilities);\n// EXTERNAL MODULE: ./src/shader/basic.frag\nvar basic = __webpack_require__(\"./src/shader/basic.frag\");\nvar basic_default = /*#__PURE__*/__webpack_require__.n(basic);\n\n// EXTERNAL MODULE: ./src/shader/basic.vert\nvar shader_basic = __webpack_require__(\"./src/shader/basic.vert\");\nvar shader_basic_default = /*#__PURE__*/__webpack_require__.n(shader_basic);\n\n// EXTERNAL MODULE: ./src/shader/geometry.frag\nvar shader_geometry = __webpack_require__(\"./src/shader/geometry.frag\");\nvar geometry_default = /*#__PURE__*/__webpack_require__.n(shader_geometry);\n\n// EXTERNAL MODULE: ./src/shader/pbr.frag\nvar pbr = __webpack_require__(\"./src/shader/pbr.frag\");\nvar pbr_default = /*#__PURE__*/__webpack_require__.n(pbr);\n\n// CONCATENATED MODULE: ./src/shader/Shader.js\n/* eslint global-require: \"off\" */\n\n\n\n\n\n\n\n\nvar Shader_cache = new utils_Cache();\nvar headerCache = new utils_Cache();\nvar CUSTUM_OPTION_PREFIX = 'HILO_CUSTUM_OPTION_';\n/**\n * Shader类\n * @class\n */\n\nvar Shader = core_Class.create(\n/** @lends Shader.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isShader: true,\n\n  /**\n   * @default Shader\n   * @type {string}\n   */\n  className: 'Shader',\n\n  /**\n   * vs 顶点代码\n   * @default ''·\n   * @type {String}\n   */\n  vs: '',\n\n  /**\n   * vs 片段代码\n   * @default ''\n   * @type {String}\n   */\n  fs: '',\n  Statics:\n  /** @lends Shader */\n  {\n    commonOptions: {},\n\n    /**\n     * 内部的所有shader块字符串，可以用来拼接glsl代码\n     * @type {Object}\n     */\n    shaders: {\n      'chunk/baseDefine.glsl': __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\"),\n      'chunk/color.frag': __webpack_require__(/*! ./chunk/color.frag */ \"./src/shader/chunk/color.frag\"),\n      'chunk/color.vert': __webpack_require__(/*! ./chunk/color.vert */ \"./src/shader/chunk/color.vert\"),\n      'chunk/color_main.vert': __webpack_require__(/*! ./chunk/color_main.vert */ \"./src/shader/chunk/color_main.vert\"),\n      'chunk/diffuse.frag': __webpack_require__(/*! ./chunk/diffuse.frag */ \"./src/shader/chunk/diffuse.frag\"),\n      'chunk/diffuse_main.frag': __webpack_require__(/*! ./chunk/diffuse_main.frag */ \"./src/shader/chunk/diffuse_main.frag\"),\n      'chunk/extensions.frag': __webpack_require__(/*! ./chunk/extensions.frag */ \"./src/shader/chunk/extensions.frag\"),\n      'chunk/extensions.vert': __webpack_require__(/*! ./chunk/extensions.vert */ \"./src/shader/chunk/extensions.vert\"),\n      'chunk/fog.frag': __webpack_require__(/*! ./chunk/fog.frag */ \"./src/shader/chunk/fog.frag\"),\n      'chunk/fog_main.frag': __webpack_require__(/*! ./chunk/fog_main.frag */ \"./src/shader/chunk/fog_main.frag\"),\n      'chunk/frag_color.frag': __webpack_require__(/*! ./chunk/frag_color.frag */ \"./src/shader/chunk/frag_color.frag\"),\n      'chunk/joint.vert': __webpack_require__(/*! ./chunk/joint.vert */ \"./src/shader/chunk/joint.vert\"),\n      'chunk/joint_main.vert': __webpack_require__(/*! ./chunk/joint_main.vert */ \"./src/shader/chunk/joint_main.vert\"),\n      'chunk/light.frag': __webpack_require__(/*! ./chunk/light.frag */ \"./src/shader/chunk/light.frag\"),\n      'chunk/lightFog.frag': __webpack_require__(/*! ./chunk/lightFog.frag */ \"./src/shader/chunk/lightFog.frag\"),\n      'chunk/lightFog.vert': __webpack_require__(/*! ./chunk/lightFog.vert */ \"./src/shader/chunk/lightFog.vert\"),\n      'chunk/lightFog_main.frag': __webpack_require__(/*! ./chunk/lightFog_main.frag */ \"./src/shader/chunk/lightFog_main.frag\"),\n      'chunk/lightFog_main.vert': __webpack_require__(/*! ./chunk/lightFog_main.vert */ \"./src/shader/chunk/lightFog_main.vert\"),\n      'chunk/logDepth.frag': __webpack_require__(/*! ./chunk/logDepth.frag */ \"./src/shader/chunk/logDepth.frag\"),\n      'chunk/logDepth_main.frag': __webpack_require__(/*! ./chunk/logDepth_main.frag */ \"./src/shader/chunk/logDepth_main.frag\"),\n      'chunk/logDepth.vert': __webpack_require__(/*! ./chunk/logDepth.vert */ \"./src/shader/chunk/logDepth.vert\"),\n      'chunk/logDepth_main.vert': __webpack_require__(/*! ./chunk/logDepth_main.vert */ \"./src/shader/chunk/logDepth_main.vert\"),\n      'chunk/morph.vert': __webpack_require__(/*! ./chunk/morph.vert */ \"./src/shader/chunk/morph.vert\"),\n      'chunk/morph_main.vert': __webpack_require__(/*! ./chunk/morph_main.vert */ \"./src/shader/chunk/morph_main.vert\"),\n      'chunk/normal.frag': __webpack_require__(/*! ./chunk/normal.frag */ \"./src/shader/chunk/normal.frag\"),\n      'chunk/normal.vert': __webpack_require__(/*! ./chunk/normal.vert */ \"./src/shader/chunk/normal.vert\"),\n      'chunk/normal_main.frag': __webpack_require__(/*! ./chunk/normal_main.frag */ \"./src/shader/chunk/normal_main.frag\"),\n      'chunk/normal_main.vert': __webpack_require__(/*! ./chunk/normal_main.vert */ \"./src/shader/chunk/normal_main.vert\"),\n      'chunk/pbr.frag': __webpack_require__(/*! ./chunk/pbr.frag */ \"./src/shader/chunk/pbr.frag\"),\n      'chunk/pbr_main.frag': __webpack_require__(/*! ./chunk/pbr_main.frag */ \"./src/shader/chunk/pbr_main.frag\"),\n      'chunk/phong.frag': __webpack_require__(/*! ./chunk/phong.frag */ \"./src/shader/chunk/phong.frag\"),\n      'chunk/phong_main.frag': __webpack_require__(/*! ./chunk/phong_main.frag */ \"./src/shader/chunk/phong_main.frag\"),\n      'chunk/precision.frag': __webpack_require__(/*! ./chunk/precision.frag */ \"./src/shader/chunk/precision.frag\"),\n      'chunk/precision.vert': __webpack_require__(/*! ./chunk/precision.vert */ \"./src/shader/chunk/precision.vert\"),\n      'chunk/transparency.frag': __webpack_require__(/*! ./chunk/transparency.frag */ \"./src/shader/chunk/transparency.frag\"),\n      'chunk/transparency_main.frag': __webpack_require__(/*! ./chunk/transparency_main.frag */ \"./src/shader/chunk/transparency_main.frag\"),\n      'chunk/unQuantize.vert': __webpack_require__(/*! ./chunk/unQuantize.vert */ \"./src/shader/chunk/unQuantize.vert\"),\n      'chunk/unQuantize_main.vert': __webpack_require__(/*! ./chunk/unQuantize_main.vert */ \"./src/shader/chunk/unQuantize_main.vert\"),\n      'chunk/uv.frag': __webpack_require__(/*! ./chunk/uv.frag */ \"./src/shader/chunk/uv.frag\"),\n      'chunk/uv.vert': __webpack_require__(/*! ./chunk/uv.vert */ \"./src/shader/chunk/uv.vert\"),\n      'chunk/uv_main.vert': __webpack_require__(/*! ./chunk/uv_main.vert */ \"./src/shader/chunk/uv_main.vert\"),\n      'method/encoding.glsl': __webpack_require__(/*! ./method/encoding.glsl */ \"./src/shader/method/encoding.glsl\"),\n      'method/getDiffuse.glsl': __webpack_require__(/*! ./method/getDiffuse.glsl */ \"./src/shader/method/getDiffuse.glsl\"),\n      'method/getLightAttenuation.glsl': __webpack_require__(/*! ./method/getLightAttenuation.glsl */ \"./src/shader/method/getLightAttenuation.glsl\"),\n      'method/getShadow.glsl': __webpack_require__(/*! ./method/getShadow.glsl */ \"./src/shader/method/getShadow.glsl\"),\n      'method/getSpecular.glsl': __webpack_require__(/*! ./method/getSpecular.glsl */ \"./src/shader/method/getSpecular.glsl\"),\n      'method/packFloat.glsl': __webpack_require__(/*! ./method/packFloat.glsl */ \"./src/shader/method/packFloat.glsl\"),\n      'method/textureEnvMap.glsl': __webpack_require__(/*! ./method/textureEnvMap.glsl */ \"./src/shader/method/textureEnvMap.glsl\"),\n      'method/transpose.glsl': __webpack_require__(/*! ./method/transpose.glsl */ \"./src/shader/method/transpose.glsl\"),\n      'method/unpackFloat.glsl': __webpack_require__(/*! ./method/unpackFloat.glsl */ \"./src/shader/method/unpackFloat.glsl\"),\n      'basic.frag': __webpack_require__(/*! ./basic.frag */ \"./src/shader/basic.frag\"),\n      'basic.vert': __webpack_require__(/*! ./basic.vert */ \"./src/shader/basic.vert\"),\n      'geometry.frag': __webpack_require__(/*! ./geometry.frag */ \"./src/shader/geometry.frag\"),\n      'pbr.frag': __webpack_require__(/*! ./pbr.frag */ \"./src/shader/pbr.frag\"),\n      'screen.frag': __webpack_require__(/*! ./screen.frag */ \"./src/shader/screen.frag\"),\n      'screen.vert': __webpack_require__(/*! ./screen.vert */ \"./src/shader/screen.vert\")\n    },\n\n    /**\n     * 初始化\n     * @param  {WebGLRenderer} renderer\n     */\n    init: function init(renderer) {\n      this.renderer = renderer;\n      this.commonHeader = this._getCommonHeader(this.renderer);\n    },\n\n    /**\n     * Shader 缓存\n     * @readOnly\n     * @type {Cache}\n     */\n    cache: {\n      get: function get() {\n        return Shader_cache;\n      }\n    },\n\n    /**\n     * Shader header缓存，一般不用管\n     * @readOnly\n     * @type {Cache}\n     */\n    headerCache: {\n      get: function get() {\n        return headerCache;\n      }\n    },\n\n    /**\n     * 重置\n     */\n    reset: function reset(gl) {\n      // eslint-disable-line no-unused-vars\n      Shader_cache.removeAll();\n    },\n\n    /**\n     * 获取header缓存的key\n     * @param {Mesh} mesh mesh\n     * @param {Material} material 材质\n     * @param {LightManager} lightManager lightManager\n     * @param {Fog} fog fog\n     * @param {Boolean} useLogDepth 是否使用对数深度\n     * @return {string}\n     */\n    getHeaderKey: function getHeaderKey(mesh, material, lightManager, fog, useLogDepth) {\n      var headerKey = 'header_' + material.id + '_' + lightManager.lightInfo.uid;\n\n      if (mesh.isSkinedMesh) {\n        headerKey += '_joint' + mesh.skeleton.jointCount;\n      }\n\n      if (fog) {\n        headerKey += '_fog_' + fog.mode;\n      }\n\n      headerKey += '_' + mesh.geometry.getShaderKey();\n\n      if (useLogDepth) {\n        headerKey += '_fogDepth';\n      }\n\n      return headerKey;\n    },\n\n    /**\n     * 获取header\n     * @param {Mesh} mesh\n     * @param {Material} material\n     * @param {LightManager} lightManager\n     * @param {Fog} fog\n     * @return {String}\n     */\n    getHeader: function getHeader(mesh, material, lightManager, fog, useLogDepth) {\n      var headerKey = this.getHeaderKey(mesh, material, lightManager, fog);\n      var header = headerCache.get(headerKey);\n\n      if (!header || material.isDirty) {\n        var headers = {};\n        Object.assign(headers, this.commonOptions);\n        var lightType = material.lightType;\n\n        if (lightType && lightType !== 'NONE') {\n          lightManager.getRenderOption(headers);\n        }\n\n        material.getRenderOption(headers);\n        mesh.getRenderOption(headers);\n\n        if (fog) {\n          headers.HAS_FOG = 1;\n          fog.getRenderOption(headers);\n        }\n\n        if (useLogDepth) {\n          headers.USE_LOG_DEPTH = 1;\n\n          if (renderer_capabilities.EXT_FRAG_DEPTH) {\n            headers.USE_EXT_FRAG_DEPTH = 1;\n          }\n        }\n\n        if (headers.HAS_NORMAL && headers.NORMAL_MAP) {\n          headers.HAS_TANGENT = 1;\n        }\n\n        if (!headers.RECEIVE_SHADOWS) {\n          delete headers.DIRECTIONAL_LIGHTS_SMC;\n          delete headers.SPOT_LIGHTS_SMC;\n          delete headers.POINT_LIGHTS_SMC;\n        }\n\n        header = \"#define SHADER_NAME \".concat(material.className, \"\\n\");\n        header += Object.keys(headers).map(function (name) {\n          if (name.indexOf(CUSTUM_OPTION_PREFIX) > -1) {\n            return \"#define \".concat(name.replace(CUSTUM_OPTION_PREFIX, ''), \" \").concat(headers[name]);\n          }\n\n          return \"#define HILO_\".concat(name, \" \").concat(headers[name]);\n        }).join('\\n') + '\\n';\n        headerCache.add(headerKey, header);\n      }\n\n      return header;\n    },\n    _getCommonHeader: function _getCommonHeader(renderer) {\n      var vertexPrecision = renderer_capabilities.getMaxPrecision(renderer_capabilities.MAX_VERTEX_PRECISION, renderer.vertexPrecision);\n      var fragmentPrecision = renderer_capabilities.getMaxPrecision(renderer_capabilities.MAX_FRAGMENT_PRECISION, renderer.fragmentPrecision);\n      var precision = renderer_capabilities.getMaxPrecision(vertexPrecision, fragmentPrecision);\n      return \"\\n#define HILO_MAX_PRECISION \".concat(precision, \"\\n#define HILO_MAX_VERTEX_PRECISION \").concat(vertexPrecision, \"\\n#define HILO_MAX_FRAGMENT_PRECISION \").concat(fragmentPrecision, \"\\n\");\n    },\n\n    /**\n     * 获取 shader\n     * @param {Mesh} mesh\n     * @param {Material} material\n     * @param {Boolean} isUseInstance\n     * @param {LightManager} lightManager\n     * @param {Fog} fog\n     * @param {Boolean} useLogDepth\n     * @return {Shader}\n     */\n    getShader: function getShader(mesh, material, isUseInstance, lightManager, fog, useLogDepth) {\n      var header = this.getHeader(mesh, material, lightManager, fog, useLogDepth);\n\n      if (material.isBasicMaterial || material.isPBRMaterial) {\n        return this.getBasicShader(material, isUseInstance, header);\n      }\n\n      if (material.isShaderMaterial) {\n        return this.getCustomShader(material.vs, material.fs, header, material.shaderCacheId || material.id, material.useHeaderCache);\n      }\n\n      return null;\n    },\n\n    /**\n     * 获取基础 shader\n     * @param  {Material}  material\n     * @param  {Boolean} isUseInstance\n     * @param  {LightManager}  lightManager\n     * @param  {Fog}  fog\n     * @return {Shader}\n     */\n    getBasicShader: function getBasicShader(material, isUseInstance, header) {\n      var instancedUniforms = '';\n\n      if (isUseInstance) {\n        instancedUniforms = material.getInstancedUniforms().map(function (x) {\n          return x.name;\n        });\n        instancedUniforms = instancedUniforms.join('|');\n      }\n\n      var key = material.className + ':' + instancedUniforms;\n\n      if (material.onBeforeCompile) {\n        key += ':' + (material.shaderCacheId || material.id);\n      }\n\n      var shader = Shader_cache.get(key);\n\n      if (!shader) {\n        var fs = '';\n        var vs = shader_basic_default.a;\n\n        if (material.isBasicMaterial) {\n          if (material.isGeometryMaterial) {\n            fs += geometry_default.a;\n          } else {\n            fs += basic_default.a;\n          }\n        } else if (material.isPBRMaterial) {\n          fs += pbr_default.a;\n        }\n\n        if (material.onBeforeCompile) {\n          var newCode = material.onBeforeCompile(vs, fs);\n          fs = newCode.fs;\n          vs = newCode.vs;\n        }\n\n        if (instancedUniforms) {\n          var instancedUniformsReg = new RegExp(\"^\\\\s*uniform\\\\s+(\\\\w+)\\\\s+(\".concat(instancedUniforms, \");\"), 'gm');\n          vs = vs.replace(instancedUniformsReg, 'attribute $1 $2;');\n        }\n\n        shader = this.getCustomShader(vs, fs, header, key, true);\n      }\n\n      if (shader) {\n        var shaderNumId = this._getNumId(shader);\n\n        if (shaderNumId !== null) {\n          material._shaderNumId = shaderNumId;\n        }\n      }\n\n      return shader;\n    },\n    _getNumId: function _getNumId(obj) {\n      var id = obj.id;\n      var res = id.match(/_(\\d+)/);\n\n      if (res && res[1]) {\n        return parseInt(res[1], 10);\n      }\n\n      return null;\n    },\n\n    /**\n     * 获取自定义shader\n     * @param  {String} vs 顶点代码\n     * @param  {String} fs 片段代码\n     * @param  {String} [cacheKey] 如果有，会以此值缓存 shader\n     * @param  {String} [useHeaderCache=false] 如果cacheKey和useHeaderCache同时存在，使用 cacheKey+useHeaderCache缓存 shader\n     * @return {Shader}\n     */\n    getCustomShader: function getCustomShader(vs, fs, header, cacheKey, useHeaderCache) {\n      var commonHeader = this.commonHeader;\n      var shader;\n\n      if (cacheKey) {\n        if (useHeaderCache) {\n          cacheKey += ':' + header;\n        }\n\n        shader = Shader_cache.get(cacheKey);\n      }\n\n      if (!shader) {\n        shader = new Shader({\n          vs: commonHeader + header + vs,\n          fs: commonHeader + header + fs\n        });\n\n        if (cacheKey) {\n          Shader_cache.add(cacheKey, shader);\n        }\n      }\n\n      return shader;\n    }\n  },\n\n  /**\n   * 是否始终使用\n   * @default true\n   * @type {Boolean}\n   */\n  alwaysUse: false,\n\n  /**\n   * @constructs\n   * @param  {Object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    this.id = math_math.generateUUID(this.className);\n    Object.assign(this, params);\n  },\n\n  /**\n   * 没有被引用时销毁资源\n   * @param  {WebGLRenderer} renderer\n   * @return {Shader} this\n   */\n  destroyIfNoRef: function destroyIfNoRef(renderer) {\n    var resourceManager = renderer.resourceManager;\n    resourceManager.destroyIfNoRef(this);\n    return this;\n  },\n\n  /**\n   * 销毁资源\n   * @return {Shader} this\n   */\n  destroy: function destroy() {\n    if (this._isDestroyed) {\n      return this;\n    }\n\n    Shader_cache.removeObject(this);\n    this._isDestroyed = true;\n    return this;\n  }\n});\n/* harmony default export */ var shader_Shader = (Shader);\n// EXTERNAL MODULE: ./src/shader/screen.vert\nvar screen = __webpack_require__(\"./src/shader/screen.vert\");\nvar screen_default = /*#__PURE__*/__webpack_require__.n(screen);\n\n// EXTERNAL MODULE: ./src/shader/screen.frag\nvar shader_screen = __webpack_require__(\"./src/shader/screen.frag\");\nvar shader_screen_default = /*#__PURE__*/__webpack_require__.n(shader_screen);\n\n// CONCATENATED MODULE: ./src/renderer/glType.js\nvar DATA_TYPES = [{\n  name: 'FLOAT',\n  byteSize: 4,\n  uniformFuncName: 'uniform1f',\n  type: 'Scalar',\n  size: 1\n}, {\n  name: 'FLOAT_VEC2',\n  byteSize: 8,\n  uniformFuncName: 'uniform2f',\n  type: 'Vector',\n  size: 2\n}, {\n  name: 'FLOAT_VEC3',\n  byteSize: 12,\n  uniformFuncName: 'uniform3f',\n  type: 'Vector',\n  size: 3\n}, {\n  name: 'FLOAT_VEC4',\n  byteSize: 16,\n  uniformFuncName: 'uniform4f',\n  type: 'Vector',\n  size: 4\n}, {\n  name: 'FLOAT_MAT2',\n  byteSize: 16,\n  uniformFuncName: 'uniformMatrix2fv',\n  type: 'Matrix',\n  size: 4\n}, {\n  name: 'FLOAT_MAT3',\n  byteSize: 36,\n  uniformFuncName: 'uniformMatrix3fv',\n  type: 'Matrix',\n  size: 9\n}, {\n  name: 'FLOAT_MAT4',\n  byteSize: 64,\n  uniformFuncName: 'uniformMatrix4fv',\n  type: 'Matrix',\n  size: 16\n}, {\n  name: 'INT',\n  byteSize: 4,\n  uniformFuncName: 'uniform1i',\n  type: 'Scalar',\n  size: 1\n}, {\n  name: 'INT_VEC2',\n  byteSize: 8,\n  uniformFuncName: 'uniform2i',\n  type: 'Vector',\n  size: 2\n}, {\n  name: 'INT_VEC3',\n  byteSize: 12,\n  uniformFuncName: 'uniform3i',\n  type: 'Vector',\n  size: 3\n}, {\n  name: 'INT_VEC4',\n  byteSize: 16,\n  uniformFuncName: 'uniform4i',\n  type: 'Vector',\n  size: 4\n}, {\n  name: 'BOOL',\n  byteSize: 4,\n  uniformFuncName: 'uniform1i',\n  type: 'Scalar',\n  size: 1\n}, {\n  name: 'BOOL_VEC2',\n  byteSize: 8,\n  uniformFuncName: 'uniform2i',\n  type: 'Vector',\n  size: 2\n}, {\n  name: 'BOOL_VEC3',\n  byteSize: 12,\n  uniformFuncName: 'uniform3i',\n  type: 'Vector',\n  size: 3\n}, {\n  name: 'BOOL_VEC4',\n  byteSize: 16,\n  uniformFuncName: 'uniform4i',\n  type: 'Vector',\n  size: 4\n}, {\n  name: 'SAMPLER_2D',\n  byteSize: 4,\n  uniformFuncName: 'uniform1i',\n  type: 'Scalar',\n  size: 1\n}, {\n  name: 'SAMPLER_CUBE',\n  byteSize: 4,\n  uniformFuncName: 'uniform1i',\n  type: 'Scalar',\n  size: 1\n}];\nvar DATA_DICT = {};\n/**\n * @namespace glType\n * @type {Object}\n */\n\nvar glType = {\n  dict: DATA_DICT,\n\n  /**\n   * init\n   * @param  {WebGLRenderingContext} gl\n   */\n  init: function init(gl) {\n    DATA_TYPES.forEach(function (dataType) {\n      var name = dataType.name;\n      var uniform;\n      var uniformArray;\n      var uniformFuncName = dataType.uniformFuncName;\n      var uniformArrayFuncName = uniformFuncName + 'v';\n\n      if (dataType.type === 'Matrix') {\n        uniform = uniformArray = function uniformArray(location, value) {\n          if (value === undefined) {\n            return;\n          }\n\n          gl[uniformFuncName](location, false, value);\n        };\n      } else {\n        uniform = function uniform(location, value) {\n          if (value === undefined) {\n            return;\n          }\n\n          gl[uniformFuncName](location, value);\n        };\n\n        uniformArray = function uniformArray(location, value) {\n          gl[uniformArrayFuncName](location, value);\n        };\n      }\n\n      DATA_DICT[gl[name]] = Object.assign(dataType, {\n        glValue: gl[name],\n        uniform: uniform,\n        uniformArray: uniformArray\n      });\n    });\n  },\n\n  /**\n   * 获取信息\n   * @param  {GLenum} type\n   * @return {glTypeInfo}\n   */\n  get: function get(type) {\n    return DATA_DICT[type];\n  }\n};\n/* harmony default export */ var renderer_glType = (glType);\n/**\n * @typedef {Object} glTypeInfo\n * @property {String} name 名字，e.g. FLOAT_VEC2\n * @property {Number} byteSize 字节大小\n * @property {String} uniformFuncName uniform方法名字，e.g. uniform3f\n * @property {String} type 类型，可以是 Scalar, Vector, Matrix\n * @property {Number} size 数量\n * @property {GLenum} glValue gl enum值\n * @property {function} uniform uniform单个值方法\n * @property {function} uniformArray uniform多个值方法\n */\n// CONCATENATED MODULE: ./src/renderer/Program.js\n\n\n\n\n\n\n\nvar Program_cache = new utils_Cache();\n/**\n * @class\n */\n\nvar Program = core_Class.create(\n/** @lends Program.prototype */\n{\n  Statics:\n  /** @lends Program */\n  {\n    /**\n     * 缓存\n     * @readOnly\n     * @return {Cache}\n     */\n    cache: {\n      get: function get() {\n        return Program_cache;\n      }\n    },\n\n    /**\n     * 重置缓存\n     */\n    reset: function reset(gl) {\n      // eslint-disable-line no-unused-vars\n      Program_cache.each(function (program) {\n        program.destroy();\n      });\n    },\n\n    /**\n     * 获取程序\n     * @param  {Shader} shader\n     * @param  {WebGLState} state\n     * @param  {Boolean} [ignoreError=false]\n     * @return {Program}\n     */\n    getProgram: function getProgram(shader, state) {\n      var ignoreError = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n      var id = shader.id;\n      var program = Program_cache.get(id);\n\n      if (!program) {\n        program = new Program({\n          state: state,\n          vertexShader: shader.vs,\n          fragShader: shader.fs,\n          ignoreError: ignoreError\n        });\n        Program_cache.add(id, program);\n      }\n\n      return program;\n    },\n\n    /**\n     * 获取空白程序\n     * @param  {WebGLState} state\n     * @return {Program}\n     */\n    getBlankProgram: function getBlankProgram(state) {\n      var shader = shader_Shader.getCustomShader('void main(){}', 'precision HILO_MAX_FRAGMENT_PRECISION float;void main(){gl_FragColor = vec4(0.0);}', '', '__hiloBlankShader');\n      return this.getProgram(shader, state, true);\n    }\n  },\n\n  /**\n   * @default Program\n   * @type {String}\n   */\n  className: 'Program',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isProgram: true,\n\n  /**\n   * 片段代码\n   * @type {String}\n   * @default ''\n   */\n  fragShader: '',\n\n  /**\n   * 顶点代码\n   * @type {String}\n   * @default ''\n   */\n  vertexShader: '',\n\n  /**\n   * attribute 集合\n   * @type {Object}\n   * @default null\n   */\n  attributes: null,\n\n  /**\n   * uniform 集合\n   * @type {Object}\n   * @default null\n   */\n  uniforms: null,\n\n  /**\n   * program\n   * @type {WebGLProgram}\n   * @default null\n   */\n  program: null,\n\n  /**\n   * gl\n   * @type {WebGLRenderingContext}\n   */\n  gl: null,\n\n  /**\n   * webglState\n   * @type {WebGLState}\n   * @default null\n   */\n  state: null,\n\n  /**\n   * 是否始终使用\n   * @default true\n   * @type {Boolean}\n   */\n  alwaysUse: false,\n\n  /**\n   * @constructs\n   * @param  {Object} [params] 初始化参数，所有params都会复制到实例上\n   * @param  {WebGLState} params.state WebGL state\n   */\n  constructor: function constructor(params) {\n    /**\n     * id\n     * @type {String}\n     */\n    this.id = math_math.generateUUID(this.className);\n    Object.assign(this, params);\n    this._dict = {};\n    this.attributes = {};\n    this.uniforms = {};\n    this.gl = this.state.gl;\n    this.program = this.createProgram();\n\n    if (this.program) {\n      this.initAttributes();\n      this.initUniforms();\n      return this;\n    }\n\n    if (this.ignoreError) {\n      return this;\n    }\n\n    return Program.getBlankProgram(params.state);\n  },\n\n  /**\n   * 生成 program\n   * @return {WebGLProgram}\n   */\n  createProgram: function createProgram() {\n    var gl = this.gl;\n    var program = gl.createProgram();\n    var vertexShader = this.createShader(gl.VERTEX_SHADER, this.vertexShader);\n    var fragShader = this.createShader(gl.FRAGMENT_SHADER, this.fragShader);\n\n    if (vertexShader && fragShader) {\n      gl.attachShader(program, vertexShader);\n      gl.attachShader(program, fragShader);\n      gl.linkProgram(program);\n      gl.deleteShader(vertexShader);\n      gl.deleteShader(fragShader);\n\n      if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        var error = gl.getProgramInfoLog(program);\n        utils_log.error('compileProgramError: ' + error, this);\n        gl.deleteProgram(program);\n        return null;\n      }\n\n      return program;\n    }\n\n    return null;\n  },\n\n  /**\n   * 使用 program\n   */\n  useProgram: function useProgram() {\n    this.state.useProgram(this.program);\n  },\n\n  /**\n   * 生成 shader\n   * @param  {Number} shaderType\n   * @param  {String} code\n   * @return {WebGLShader}\n   */\n  createShader: function createShader(shaderType, code) {\n    var gl = this.gl;\n    var shader = gl.createShader(shaderType);\n    gl.shaderSource(shader, code);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n      var error = gl.getShaderInfoLog(shader);\n      utils_log.error('compileShaderError: ' + error, code.split('\\n').map(function (line, index) {\n        return \"\".concat(index + 1, \" \").concat(line);\n      }).join('\\n'));\n      return null;\n    }\n\n    return shader;\n  },\n\n  /**\n   * 初始化 attribute 信息\n   */\n  initAttributes: function initAttributes() {\n    var _this = this;\n\n    var gl = this.gl;\n    var program = this.program;\n    var num = gl.getProgramParameter(program, gl.ACTIVE_ATTRIBUTES);\n    var instancedExtension = renderer_extensions.instanced;\n\n    var _loop = function _loop(i) {\n      var _gl$getActiveAttrib = gl.getActiveAttrib(program, i),\n          name = _gl$getActiveAttrib.name,\n          type = _gl$getActiveAttrib.type,\n          size = _gl$getActiveAttrib.size;\n\n      var location = gl.getAttribLocation(program, name);\n      var glTypeInfo = renderer_glType.get(type);\n\n      var pointer = function pointer(_ref) {\n        var _ref$type = _ref.type,\n            type = _ref$type === void 0 ? gl.FLOAT : _ref$type,\n            _ref$normalized = _ref.normalized,\n            normalized = _ref$normalized === void 0 ? false : _ref$normalized,\n            _ref$stride = _ref.stride,\n            stride = _ref$stride === void 0 ? 0 : _ref$stride,\n            _ref$offset = _ref.offset,\n            offset = _ref$offset === void 0 ? 0 : _ref$offset;\n        gl.vertexAttribPointer(location, glTypeInfo.size, type, normalized, stride, offset);\n      };\n\n      var enable = function enable() {\n        gl.enableVertexAttribArray(location);\n      };\n\n      var divisor = function divisor() {};\n\n      var addTo = function addTo(array, data) {\n        array[location] = data;\n      };\n\n      if (instancedExtension) {\n        divisor = function divisor() {\n          var d = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n          instancedExtension.vertexAttribDivisorANGLE(location, d);\n        };\n      }\n\n      if (glTypeInfo.type === 'Matrix') {\n        var matrixStride = glTypeInfo.byteSize;\n        var _size = glTypeInfo.size;\n        var matSize = Math.sqrt(_size);\n        var vectorByteSize = matSize * 4;\n\n        var each = function each(callback) {\n          for (var _i = 0; _i < matSize; _i++) {\n            callback(location + _i, _i);\n          }\n        };\n\n        pointer = function pointer(_ref2) {\n          var _ref2$type = _ref2.type,\n              type = _ref2$type === void 0 ? gl.FLOAT : _ref2$type,\n              _ref2$normalized = _ref2.normalized,\n              normalized = _ref2$normalized === void 0 ? false : _ref2$normalized,\n              _ref2$stride = _ref2.stride,\n              stride = _ref2$stride === void 0 ? 0 : _ref2$stride,\n              _ref2$offset = _ref2.offset,\n              offset = _ref2$offset === void 0 ? 0 : _ref2$offset;\n          var realStride;\n\n          if (stride === 0) {\n            realStride = matrixStride;\n          } else {\n            realStride = stride;\n          }\n\n          each(function (location, i) {\n            gl.vertexAttribPointer(location, matSize, type, normalized, realStride, offset + vectorByteSize * i);\n          });\n        };\n\n        enable = function enable() {\n          each(function (location) {\n            gl.enableVertexAttribArray(location);\n          });\n        };\n\n        addTo = function addTo(array, data) {\n          each(function (location) {\n            array[location] = data;\n          });\n        };\n\n        if (instancedExtension) {\n          divisor = function divisor() {\n            var d = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n            each(function (location) {\n              instancedExtension.vertexAttribDivisorANGLE(location, d);\n            });\n          };\n        }\n      }\n\n      _this.attributes[name] = {\n        name: name,\n        location: location,\n        type: type,\n        size: size,\n        glTypeInfo: glTypeInfo,\n        pointer: pointer,\n        enable: enable,\n        divisor: divisor,\n        addTo: addTo\n      };\n    };\n\n    for (var i = 0; i < num; i++) {\n      _loop(i);\n    }\n  },\n\n  /**\n   * 初始化 uniform 信息\n   */\n  initUniforms: function initUniforms() {\n    var _this2 = this;\n\n    var gl = this.gl;\n    var program = this.program;\n    var num = gl.getProgramParameter(program, gl.ACTIVE_UNIFORMS);\n    var textureIndex = 0;\n\n    var _loop2 = function _loop2(i) {\n      var _gl$getActiveUniform = gl.getActiveUniform(program, i),\n          name = _gl$getActiveUniform.name,\n          size = _gl$getActiveUniform.size,\n          type = _gl$getActiveUniform.type;\n\n      name = name.replace(/\\[0\\]$/, '');\n      var location = gl.getUniformLocation(program, name);\n      var glTypeInfo = renderer_glType.get(type);\n      var uniformArray = glTypeInfo.uniformArray,\n          uniform = glTypeInfo.uniform;\n      _this2.uniforms[name] = {\n        name: name,\n        location: location,\n        type: type,\n        size: size,\n        glTypeInfo: glTypeInfo\n      };\n\n      if (type === gl.SAMPLER_2D || type === gl.SAMPLER_CUBE) {\n        _this2.uniforms[name].textureIndex = textureIndex;\n        textureIndex += size;\n      }\n\n      Object.defineProperty(_this2, name, {\n        set: glTypeInfo.size > 1 || size > 1 ? function (value) {\n          uniformArray(location, value);\n        } : function (value) {\n          if (_this2._dict[name] !== value) {\n            _this2._dict[name] = value;\n            uniform(location, value);\n          }\n        }\n      });\n    };\n\n    for (var i = 0; i < num; i++) {\n      _loop2(i);\n    }\n  },\n\n  /**\n   * 没有被引用时销毁资源\n   * @param  {WebGLRenderer} renderer\n   * @return {Program} this\n   */\n  destroyIfNoRef: function destroyIfNoRef(renderer) {\n    var resourceManager = renderer.resourceManager;\n    resourceManager.destroyIfNoRef(this);\n    return this;\n  },\n\n  /**\n   * 销毁资源\n   * @return {Program} this\n   */\n  destroy: function destroy() {\n    if (this._isDestroyed) {\n      return this;\n    }\n\n    this.gl.deleteProgram(this.program);\n    this.uniforms = null;\n    this.attributes = null;\n    this.program = null;\n    this.gl = null;\n    this.state = null;\n    this._dict = null;\n    Program_cache.removeObject(this);\n    this._isDestroyed = true;\n    return this;\n  }\n});\n/* harmony default export */ var renderer_Program = (Program);\n// CONCATENATED MODULE: ./src/renderer/Buffer.js\n/* eslint no-buffer-constructor: \"off\" */\n\n\n\n\nvar ARRAY_BUFFER = src_constants.ARRAY_BUFFER,\n    ELEMENT_ARRAY_BUFFER = src_constants.ELEMENT_ARRAY_BUFFER,\n    STATIC_DRAW = src_constants.STATIC_DRAW;\nvar Buffer_cache = new utils_Cache();\n/**\n * 缓冲\n * @class\n */\n\nvar Buffer = core_Class.create(\n/** @lends Buffer.prototype */\n{\n  Statics:\n  /** @lends Buffer */\n  {\n    /**\n     * 缓存\n     * @readOnly\n     * @return {Cache}\n     */\n    cache: {\n      get: function get() {\n        return Buffer_cache;\n      }\n    },\n\n    /**\n     * 重置缓存\n     */\n    reset: function reset(gl) {\n      // eslint-disable-line no-unused-vars\n      Buffer_cache.each(function (buffer) {\n        buffer.destroy();\n      });\n    },\n\n    /**\n     * 生成顶点缓冲\n     * @param  {WebGLRenderingContext} gl\n     * @param  {GeometryData} geometryData\n     * @param  {GLenum} [usage = STATIC_DRAW]\n     * @return {Buffer}\n     */\n    createVertexBuffer: function createVertexBuffer(gl, geometryData) {\n      var usage = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : STATIC_DRAW;\n      return this.createBuffer(gl, ARRAY_BUFFER, geometryData, usage);\n    },\n    createBuffer: function createBuffer(gl, target, geometryData, usage) {\n      var id = geometryData.bufferViewId;\n      var buffer = Buffer_cache.get(id);\n\n      if (buffer) {\n        return buffer;\n      }\n\n      geometryData.isDirty = false;\n      buffer = new Buffer(gl, target, geometryData.data, usage);\n      Buffer_cache.add(id, buffer);\n      return buffer;\n    },\n\n    /**\n     * 生成索引缓冲\n     * @param  {WebGLRenderingContext} gl\n     * @param  {GeometryData} geometryData\n     * @param  {GLenum} [usage = STATIC_DRAW]\n     * @return {Buffer}\n     */\n    createIndexBuffer: function createIndexBuffer(gl, geometryData) {\n      var usage = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : STATIC_DRAW;\n      return this.createBuffer(gl, ELEMENT_ARRAY_BUFFER, geometryData, usage);\n    }\n  },\n\n  /**\n   * @default Buffer\n   * @type {String}\n   */\n  className: 'Buffer',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isBuffer: true,\n\n  /**\n   * @constructs\n   * @param  {WebGLRenderingContext} gl\n   * @param  {GLenum} [target = ARRAY_BUFFER]\n   * @param  {TypedArray} [data = null]\n   * @param  {GLenum} [usage = STATIC_DRAW]\n   */\n  constructor: function constructor(gl) {\n    var target = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : ARRAY_BUFFER;\n    var data = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n    var usage = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : STATIC_DRAW;\n\n    /**\n     * id\n     * @type {String}\n     */\n    this.id = math_math.generateUUID(this.className);\n    this.gl = gl;\n    /**\n     * target\n     * @type {GLenum}\n     */\n\n    this.target = target;\n    /**\n     * usage\n     * @type {GLenum}\n     */\n\n    this.usage = usage;\n    /**\n     * buffer\n     * @type {WebGLBuffer}\n     */\n\n    this.buffer = gl.createBuffer();\n\n    if (data) {\n      this.bufferData(data);\n    }\n  },\n\n  /**\n   * 绑定\n   * @return {Buffer} this\n   */\n  bind: function bind() {\n    this.gl.bindBuffer(this.target, this.buffer);\n    return this;\n  },\n\n  /**\n   * 上传数据\n   * @param  {TypedArray} data\n   * @return {Buffer} this\n   */\n  bufferData: function bufferData(data) {\n    var gl = this.gl,\n        target = this.target,\n        usage = this.usage;\n    this.bind();\n    gl.bufferData(target, data, usage);\n    this.data = data;\n    return this;\n  },\n\n  /**\n   * 上传部分数据\n   * @param  {Number} byteOffset\n   * @param  {TypedArray} data\n   * @param  {Boolean} [isBinding=false]\n   * @return {Buffer} this\n   */\n  bufferSubData: function bufferSubData(byteOffset, data) {\n    var isBinding = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var gl = this.gl,\n        target = this.target;\n\n    if (!isBinding) {\n      this.bind();\n    }\n\n    gl.bufferSubData(target, byteOffset, data);\n    return this;\n  },\n\n  /**\n   * @param  {GeometryData} geometryData\n   * @return {Buffer} this\n   */\n  uploadGeometryData: function uploadGeometryData(geometryData) {\n    var _this = this;\n\n    var subDataList = geometryData.subDataList;\n\n    if (!this.data || this.data.byteLength < geometryData.data.byteLength || geometryData._isAllDirty === true) {\n      this.bufferData(geometryData.data);\n    } else if (subDataList && subDataList.length) {\n      this.bind();\n      subDataList.forEach(function (subData) {\n        _this.bufferSubData(subData.byteOffset, subData.data, true);\n      });\n    } else {\n      this.bufferData(geometryData.data);\n    }\n\n    geometryData.isDirty = false;\n    return this;\n  },\n\n  /**\n   * 没有被引用时销毁资源\n   * @param  {WebGLRenderer} renderer\n   * @return {Buffer} this\n   */\n  destroyIfNoRef: function destroyIfNoRef(renderer) {\n    var resourceManager = renderer.resourceManager;\n    resourceManager.destroyIfNoRef(this);\n    return this;\n  },\n\n  /**\n   * 销毁资源\n   * @return {Buffer} this\n   */\n  destroy: function destroy() {\n    if (this._isDestroyed) {\n      return this;\n    }\n\n    this.gl.deleteBuffer(this.buffer);\n    this.data = null;\n    Buffer_cache.removeObject(this);\n    this._isDestroyed = true;\n    return this;\n  }\n});\n/* harmony default export */ var renderer_Buffer = (Buffer);\n// CONCATENATED MODULE: ./src/utils/bufferUtil.js\nvar cachedBuffer = new ArrayBuffer(1);\nvar bufferUtil = {\n  getTypedArray: function getTypedArray(constructor, length) {\n    this._updateBuffer(length * constructor.BYTES_PER_ELEMENT);\n\n    return new constructor(cachedBuffer, 0, length);\n  },\n  fillArrayData: function fillArrayData(typedArray, data) {\n    var offset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n\n    for (var i = 0, l = data.length; i < l; i++) {\n      typedArray[offset + i] = data[i];\n    }\n  },\n  _updateBuffer: function _updateBuffer(byteSize) {\n    if (cachedBuffer.byteLength < byteSize) {\n      cachedBuffer = new ArrayBuffer(byteSize * 2);\n    }\n  }\n};\n/* harmony default export */ var utils_bufferUtil = (bufferUtil);\n// CONCATENATED MODULE: ./src/renderer/VertexArrayObject.js\n\n\n\n\n\n\n\n\nvar VertexArrayObject_TRIANGLES = src_constants.TRIANGLES;\nvar globalStates = [];\nvar currentVao = null;\nvar VertexArrayObject_cache = new utils_Cache();\n/**\n * VAO\n * @class\n */\n\nvar VertexArrayObject = core_Class.create(\n/** @lends VertexArrayObject.prototype */\n{\n  Statics: {\n    /**\n     * 缓存\n     * @readOnly\n     * @memberOf VertexArrayObject\n     * @return {Cache}\n     */\n    cache: {\n      get: function get() {\n        return VertexArrayObject_cache;\n      }\n    },\n\n    /**\n     * 获取 vao\n     * @memberOf VertexArrayObject\n     * @param  {WebGLRenderingContext} gl\n     * @param  {String} id  缓存id\n     * @param  {Object} params\n     * @return {VertexArrayObject}\n     */\n    getVao: function getVao(gl, id, params) {\n      var vao = VertexArrayObject_cache.get(id);\n\n      if (!vao) {\n        vao = new VertexArrayObject(gl, id, params);\n        VertexArrayObject_cache.add(id, vao);\n      } else if (params.mode && params.mode !== vao.mode) {\n        // for geometry.mode change\n        vao.mode = params.mode;\n      }\n\n      return vao;\n    },\n\n    /**\n     * 重置所有vao\n     * @memberOf VertexArrayObject\n     * @param  {WebGLRenderingContext} gl\n     */\n    reset: function reset(gl) {\n      // eslint-disable-line no-unused-vars\n      currentVao = null;\n      globalStates = [];\n      this.bindSystemVao();\n      VertexArrayObject_cache.each(function (vao) {\n        vao.destroy(gl);\n      });\n    },\n\n    /**\n     * 绑定系统vao\n     * @memberOf VertexArrayObject\n     */\n    bindSystemVao: function bindSystemVao() {\n      if (renderer_extensions.vao) {\n        renderer_extensions.vao.bindVertexArrayOES(null);\n      }\n\n      currentVao = null;\n    }\n  },\n\n  /**\n   * @default VertexArrayObject\n   * @type {String}\n   */\n  className: 'VertexArrayObject',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isVertexArrayObject: true,\n\n  /**\n   * 顶点数量\n   * @type {Number}\n   * @private\n   */\n  vertexCount: null,\n\n  /**\n   * 是否使用 vao\n   * @type {Boolean}\n   * @default false\n   */\n  useVao: false,\n\n  /**\n   * 是否使用 instanced\n   * @type {Boolean}\n   * @default false\n   */\n  useInstanced: false,\n\n  /**\n   * 绘图方式\n   * @type {GLenum}\n   * @default gl.TRIANGLES\n   */\n  mode: VertexArrayObject_TRIANGLES,\n\n  /**\n   * 是否脏\n   * @type {Boolean}\n   * @default true\n   */\n  isDirty: true,\n\n  /**\n   * @constructs\n   * @param  {WebGLRenderingContext} gl\n   * @param  {String} id  缓存id\n   * @param  {Object} params\n   */\n  constructor: function constructor(gl, id, params) {\n    this.gl = gl;\n    this.id = id;\n    this.vaoExtension = renderer_extensions.vao;\n    this.instancedExtension = renderer_extensions.instanced;\n    Object.assign(this, params);\n\n    if (!this.vaoExtension) {\n      this.useVao = false;\n    }\n\n    if (!this.instancedExtension) {\n      this.useInstanced = false;\n    }\n\n    if (this.useVao) {\n      this.vao = this.vaoExtension.createVertexArrayOES();\n    }\n\n    this.attributes = [];\n    this.activeStates = [];\n    this.indexBuffer = null;\n  },\n\n  /**\n   * bind\n   */\n  bind: function bind() {\n    if (currentVao !== this) {\n      if (this.useVao) {\n        this.vaoExtension.bindVertexArrayOES(this.vao);\n      } else {\n        this.bindSystemVao();\n      }\n\n      currentVao = this;\n    }\n  },\n\n  /**\n   * @private\n   */\n  bindSystemVao: function bindSystemVao() {\n    var gl = this.gl;\n\n    if (currentVao && currentVao.useVao) {\n      currentVao.unbind();\n    }\n\n    var activeStates = this.activeStates;\n    var lastBuffer;\n    this.attributes.forEach(function (attributeObject) {\n      var buffer = attributeObject.buffer,\n          attribute = attributeObject.attribute,\n          geometryData = attributeObject.geometryData;\n\n      if (lastBuffer !== buffer) {\n        lastBuffer = buffer;\n        buffer.bind();\n      }\n\n      attribute.enable();\n      attribute.pointer(geometryData);\n\n      if (attributeObject.useInstanced) {\n        attribute.divisor(1);\n      } else {\n        attribute.divisor(0);\n      }\n    });\n    globalStates.forEach(function (globalAttributeObject, i) {\n      var activeAttributeObject = activeStates[i];\n\n      if (globalAttributeObject && !activeAttributeObject) {\n        globalAttributeObject.attribute.divisor(0);\n        gl.disableVertexAttribArray(i);\n      }\n    });\n\n    if (this.indexBuffer) {\n      this.indexBuffer.bind();\n    }\n\n    globalStates = activeStates;\n  },\n\n  /**\n   * unbind\n   */\n  unbind: function unbind() {\n    if (this.useVao) {\n      this.vaoExtension.bindVertexArrayOES(null);\n    }\n\n    currentVao = null;\n  },\n\n  /**\n   * draw\n   */\n  draw: function draw() {\n    this.bind();\n    var gl = this.gl,\n        mode = this.mode;\n\n    if (this.indexBuffer) {\n      gl.drawElements(mode, this.vertexCount, this.indexType, 0);\n    } else {\n      gl.drawArrays(mode, 0, this.getVertexCount());\n    }\n  },\n\n  /**\n   * 获取顶点数量\n   * @return {Number} 顶点数量\n   */\n  getVertexCount: function getVertexCount() {\n    if (this.vertexCount === null) {\n      var attributeObj = this.attributes[0];\n\n      if (attributeObj) {\n        this.vertexCount = attributeObj.geometryData.count;\n      } else {\n        this.vertexCount = 0;\n      }\n    }\n\n    return this.vertexCount;\n  },\n\n  /**\n   * drawInstance\n   * @param  {Number} [primcount=1]\n   */\n  drawInstance: function drawInstance() {\n    var primcount = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 1;\n    this.bind();\n    var gl = this.gl,\n        mode = this.mode;\n\n    if (this.useInstanced) {\n      if (this.indexBuffer) {\n        this.instancedExtension.drawElementsInstancedANGLE(mode, this.vertexCount, gl.UNSIGNED_SHORT, 0, primcount);\n      } else {\n        this.instancedExtension.drawArraysInstancedANGLE(mode, 0, this.getVertexCount(), primcount);\n      }\n    }\n  },\n\n  /**\n   * addIndexBuffer\n   * @param {GeometryData} data\n   * @param {GLenum} usage gl.STATIC_DRAW|gl.DYNAMIC_DRAW\n   * @return {Buffer} Buffer\n   */\n  addIndexBuffer: function addIndexBuffer(geometryData, usage) {\n    this.bind();\n    var gl = this.gl;\n    var buffer = this.indexBuffer;\n    this.indexType = geometryData.type;\n\n    if (!buffer) {\n      buffer = renderer_Buffer.createIndexBuffer(gl, geometryData, usage);\n      buffer.bind();\n      this.indexBuffer = buffer;\n      this.vertexCount = geometryData.length;\n    } else if (geometryData.isDirty) {\n      buffer.uploadGeometryData(geometryData);\n      this.vertexCount = geometryData.length;\n    }\n\n    return buffer;\n  },\n\n  /**\n   * addAttribute\n   * @param {GeometryData} geometryData\n   * @param {Object} attribute\n   * @param {GLenum} usage gl.STATIC_DRAW|gl.DYNAMIC_DRAW\n   * @param {Function} onInit\n   * @return {AttributeObject} attributeObject\n   */\n  addAttribute: function addAttribute(geometryData, attribute, usage, onInit) {\n    this.bind();\n    var gl = this.gl;\n    var name = attribute.name;\n    var attributeObject = this[name];\n\n    if (!attributeObject) {\n      var buffer = renderer_Buffer.createVertexBuffer(gl, geometryData, usage);\n      buffer.bind();\n      attribute.enable();\n      attribute.pointer(geometryData);\n      attributeObject = {\n        attribute: attribute,\n        buffer: buffer,\n        geometryData: geometryData\n      };\n      this.attributes.push(attributeObject);\n      this[name] = attributeObject;\n      attribute.addTo(this.activeStates, attributeObject);\n\n      if (onInit) {\n        onInit(attributeObject);\n      }\n    }\n\n    if (geometryData.isDirty) {\n      var _buffer = attributeObject.buffer;\n\n      _buffer.bind();\n\n      attribute.enable();\n      attribute.pointer(geometryData);\n\n      _buffer.uploadGeometryData(geometryData);\n    }\n\n    return attributeObject;\n  },\n\n  /**\n   * addInstancedAttribute\n   * @param {Object} attribute\n   * @param {Array} meshes\n   * @param {function} getData\n   * @return {AttributeObject} attributeObject\n   */\n  addInstancedAttribute: function addInstancedAttribute(attribute, meshes, getData) {\n    this.bind();\n    var gl = this.gl;\n    var name = attribute.name,\n        glTypeInfo = attribute.glTypeInfo;\n    var instancedData = utils_bufferUtil.getTypedArray(Float32Array, meshes.length * glTypeInfo.size);\n    meshes.forEach(function (mesh, index) {\n      var attributeData = getData(mesh);\n\n      if (attributeData !== undefined) {\n        utils_bufferUtil.fillArrayData(instancedData, getData(mesh), index * glTypeInfo.size);\n      } else {\n        utils_log.warn('no attributeData:' + name + '-' + mesh.name);\n      }\n    });\n    var attributeObject = this[name];\n    var geometryData;\n\n    if (attributeObject) {\n      geometryData = attributeObject.geometryData;\n      geometryData.data = instancedData;\n    } else {\n      geometryData = new geometry_GeometryData(instancedData, 1);\n    }\n\n    return this.addAttribute(geometryData, attribute, gl.DYNAMIC_DRAW, function (attributeObject) {\n      attribute.divisor(1);\n      attributeObject.useInstanced = true;\n    });\n  },\n\n  /**\n   * 获取资源\n   * @param {Object[]} [resources=[]]\n   * @return {Object[]}\n   */\n  getResources: function getResources() {\n    var resources = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n\n    if (this.attributes) {\n      this.attributes.forEach(function (attributeObject) {\n        resources.push(attributeObject.buffer);\n      });\n    }\n\n    if (this.indexBuffer) {\n      resources.push(this.indexBuffer);\n    }\n\n    return resources;\n  },\n\n  /**\n   * 没有被引用时销毁资源\n   * @param  {WebGLRenderer} renderer\n   * @return {VertexArrayObject} this\n   */\n  destroyIfNoRef: function destroyIfNoRef(renderer) {\n    var resourceManager = renderer.resourceManager;\n    resourceManager.destroyIfNoRef(this);\n    return this;\n  },\n\n  /**\n   * 销毁资源\n   * @return {VertexArrayObject} this\n   */\n  destroy: function destroy() {\n    var _this = this;\n\n    if (this._isDestroyed) {\n      return this;\n    }\n\n    this.instancedExtension = null;\n\n    if (this.useVao) {\n      this.vaoExtension.deleteVertexArrayOES(this.vao);\n      this.vao = null;\n      this.vaoExtension = null;\n    }\n\n    this.gl = null;\n    this.indexBuffer = null;\n    this.attributes.forEach(function (attributeObject) {\n      var attribute = attributeObject.attribute || {};\n      _this[attribute.name] = null;\n    });\n    this.attributes = null;\n    this.activeStates = null;\n    VertexArrayObject_cache.removeObject(this);\n    this._isDestroyed = true;\n    return this;\n  }\n});\n/* harmony default export */ var renderer_VertexArrayObject = (VertexArrayObject);\n/**\n * 顶点对象\n * @typedef {object} AttributeObject\n * @property {Object} attribute\n * @property {WebGLBuffer} buffer\n * @property {GeometryData} geometryData\n * @property {Boolean} useInstanced\n */\n// CONCATENATED MODULE: ./src/texture/Texture.js\n\n\n\n\n\n\n\nvar TEXTURE_2D = src_constants.TEXTURE_2D,\n    RGBA = src_constants.RGBA,\n    Texture_LINEAR = src_constants.LINEAR,\n    NEAREST = src_constants.NEAREST,\n    REPEAT = src_constants.REPEAT,\n    CLAMP_TO_EDGE = src_constants.CLAMP_TO_EDGE,\n    Texture_UNSIGNED_BYTE = src_constants.UNSIGNED_BYTE;\nvar Texture_cache = new utils_Cache();\n/**\n * 纹理\n * @class\n * @example\n * var loader = new Hilo3d.BasicLoader();\n * loader.load({\n *     src: '//img.alicdn.com/tfs/TB1aNxtQpXXXXX1XVXXXXXXXXXX-1024-1024.jpg',\n *     crossOrigin: true\n * }).then(img => {\n *     return new Hilo3d.Texture({\n *         image: img\n *     });\n * });\n */\n\nvar Texture = core_Class.create(\n/** @lends Texture.prototype */\n{\n  Statics: {\n    /**\n     * 缓存\n     * @memberOf Texture\n     * @readOnly\n     * @type {Object}\n     */\n    cache: {\n      get: function get() {\n        return Texture_cache;\n      }\n    },\n\n    /**\n     * 重置\n     * @memberOf Texture\n     * @param  {WebGLRenderingContext} gl\n     */\n    reset: function reset(gl) {\n      Texture_cache.each(function (glTexture, id) {\n        gl.deleteTexture(glTexture);\n        Texture_cache.remove(id);\n      });\n    }\n  },\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isTexture: true,\n\n  /**\n   * @default Texture\n   * @type {string}\n   */\n  className: 'Texture',\n\n  /**\n   * 图片资源是否可以释放，可以的话，上传到GPU后将释放图片引用\n   * @type {boolean}\n   * @default false\n   */\n  isImageCanRelease: false,\n  _isImageReleased: false,\n  _image: null,\n\n  /**\n   * 图片对象\n   * @type {HTMLImageElement}\n   * @default null\n   */\n  image: {\n    get: function get() {\n      if (this._isImageReleased) {\n        utils_log.errorOnce(\"Read Texture.image(\".concat(this.id, \")\"), 'Read Texture.image after image released!');\n      }\n\n      return this._image;\n    },\n    set: function set(_img) {\n      this._image = _img;\n      this._isImageReleased = false;\n    }\n  },\n  _releaseImage: function _releaseImage() {\n    this._canvasImage = null;\n    this._canvasCtx = null;\n    this._originImage = null;\n    this._image = null;\n    this.mipmaps = null;\n    this._isImageReleased = true;\n  },\n\n  /**\n   * mipmaps\n   * @type {HTMLImageElement[]|TypedArray[]}\n   * @default null\n   */\n  mipmaps: null,\n\n  /**\n   * Texture Target\n   * @default gl.TEXTURE_2D\n   * @type {GLenum}\n   */\n  target: TEXTURE_2D,\n\n  /**\n   * Texture Internal Format\n   * @default gl.RGBA\n   * @type {GLenum}\n   */\n  internalFormat: RGBA,\n\n  /**\n   * 图片 Format\n   * @default gl.RGBA\n   * @type {GLenum}\n   */\n  format: RGBA,\n\n  /**\n   * 类型\n   * @default gl.UNSIGNED_BYTE\n   * @type {GLenum}\n   */\n  type: Texture_UNSIGNED_BYTE,\n\n  /**\n   * @default 0\n   * @type {number}\n   */\n  width: 0,\n\n  /**\n   * @default 0\n   * @type {number}\n   */\n  height: 0,\n\n  /**\n   * @default 0\n   * @readOnly\n   * @type {Number}\n   */\n  border: 0,\n\n  /**\n   * magFilter\n   * @default gl.LINEAR\n   * @type {GLenum}\n   */\n  magFilter: Texture_LINEAR,\n\n  /**\n   * minFilter\n   * @default gl.LINEAR\n   * @type {GLenum}\n   */\n  minFilter: Texture_LINEAR,\n\n  /**\n   * wrapS\n   * @default gl.REPEAT\n   * @type {GLenum}\n   */\n  wrapS: REPEAT,\n\n  /**\n   * wrapT\n   * @default gl.REPEAT\n   * @type {GLenum}\n   */\n  wrapT: REPEAT,\n\n  /**\n   * @type {string}\n   */\n  name: '',\n\n  /**\n   * @default false\n   * @type {boolean}\n   */\n  premultiplyAlpha: false,\n\n  /**\n   * 是否翻转Texture的Y轴\n   * @default false\n   * @type {boolean}\n   */\n  flipY: false,\n\n  /**\n   * 是否压缩\n   * @default false\n   * @type {Boolean}\n   */\n  compressed: false,\n\n  /**\n   * 是否需要更新Texture\n   * @default true\n   * @type {boolean}\n   */\n  needUpdate: true,\n\n  /**\n   * 是否需要销毁之前的Texture，Texture参数变更之后需要销毁\n   * @default false\n   * @type {boolean}\n   */\n  needDestroy: false,\n\n  /**\n   * 是否每次都更新Texture\n   * @default false\n   * @type {boolean}\n   */\n  autoUpdate: false,\n\n  /**\n   * uv\n   * @default 0\n   * @type {Number}\n   */\n  uv: 0,\n\n  /**\n   * anisotropic\n   * @default 1\n   * @type {Number}\n   */\n  anisotropic: 1,\n\n  /**\n   * 获取原始图像宽度。\n   * @default 0\n   * @type {Number}\n   */\n  origWidth: {\n    get: function get() {\n      if (this._originImage) {\n        return this._originImage.width || this.width;\n      }\n\n      if (this.image) {\n        return this.image.width || this.width;\n      }\n\n      return this.width;\n    }\n  },\n\n  /**\n   * 获取原始图像高度。\n   * @default 0\n   * @type {Number}\n   */\n  origHeight: {\n    get: function get() {\n      if (this.originImage) {\n        return this._originImage.height || this.height;\n      }\n\n      if (this.image) {\n        return this.image.height || this.height;\n      }\n\n      return this.height;\n    }\n  },\n\n  /**\n   * 是否使用 mipmap\n   * @readOnly\n   * @type {Boolean}\n   */\n  useMipmap: {\n    get: function get() {\n      return this.minFilter !== Texture_LINEAR && this.minFilter !== NEAREST;\n    },\n    set: function set() {\n      utils_log.warn('texture.useMipmap is readOnly!');\n    }\n  },\n\n  /**\n   * 是否使用 repeat\n   * @readOnly\n   * @type {Boolean}\n   */\n  useRepeat: {\n    get: function get() {\n      return this.wrapS !== CLAMP_TO_EDGE || this.wrapT !== CLAMP_TO_EDGE;\n    },\n    set: function set() {\n      utils_log.warn('texture.useRepeat is readOnly!');\n    }\n  },\n\n  /**\n   * mipmapCount\n   * @readOnly\n   * @type {Number}\n   */\n  mipmapCount: {\n    get: function get() {\n      return Math.floor(Math.log2(Math.max(this.width, this.height)) + 1);\n    },\n    set: function set() {\n      utils_log.warn('texture.mipmapCount is readOnly!');\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    this.id = math_math.generateUUID(this.className);\n    Object.assign(this, params);\n  },\n\n  /**\n   * 是否是 2 的 n 次方\n   * @param  {HTMLImageElement}  img\n   * @return {Boolean}\n   */\n  isImgPowerOfTwo: function isImgPowerOfTwo(img) {\n    return math_math.isPowerOfTwo(img.width) && math_math.isPowerOfTwo(img.height);\n  },\n\n  /**\n   * 获取支持的尺寸\n   * @param  {HTMLImageElement} img\n   * @param  {Boolean} [needPowerOfTwo=false]\n   * @return {Object} { width, height }\n   */\n  getSupportSize: function getSupportSize(img) {\n    var needPowerOfTwo = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n    var width = img.width;\n    var height = img.height;\n\n    if (needPowerOfTwo && !this.isImgPowerOfTwo(img)) {\n      width = math_math.nextPowerOfTwo(width);\n      height = math_math.nextPowerOfTwo(height);\n    }\n\n    var maxTextureSize = renderer_capabilities.MAX_TEXTURE_SIZE;\n\n    if (maxTextureSize) {\n      if (width > maxTextureSize) {\n        width = maxTextureSize;\n      }\n\n      if (height > maxTextureSize) {\n        height = maxTextureSize;\n      }\n    }\n\n    return {\n      width: width,\n      height: height\n    };\n  },\n\n  /**\n   * 更新图片大小成为 2 的 n 次方\n   * @param  {HTMLImageElement} img\n   * @return {HTMLCanvasElement|HTMLImageElement}\n   */\n  resizeImgToPowerOfTwo: function resizeImgToPowerOfTwo(img) {\n    var sizeResult = this.getSupportSize(img, true);\n    return this.resizeImg(img, sizeResult.width, sizeResult.height);\n  },\n\n  /**\n   * 更新图片大小\n   * @param  {HTMLImageElement} img\n   * @param {Number} width\n   * @param {Number} height\n   * @return {HTMLCanvasElement|HTMLImageElement}\n   */\n  resizeImg: function resizeImg(img, width, height) {\n    if (img.width === width && img.height === height) {\n      return img;\n    }\n\n    var canvas = this._canvasImage;\n\n    if (!canvas) {\n      canvas = document.createElement('canvas');\n      canvas.width = width;\n      canvas.height = height;\n      this._canvasImage = canvas;\n      this._canvasCtx = canvas.getContext('2d');\n    } else {\n      canvas.width = width;\n      canvas.height = height;\n      this._canvasCtx = canvas.getContext('2d');\n    }\n\n    this._canvasCtx.drawImage(img, 0, 0, img.width, img.height, 0, 0, width, height);\n\n    utils_log.warnOnce(\"Texture.resizeImg(\".concat(this.id, \")\"), \"image size(\".concat(img.width, \"x\").concat(img.height, \") is not support. Resized to \").concat(canvas.width, \"x\").concat(canvas.height), img.src);\n    this._originImage = img;\n    return canvas;\n  },\n\n  /**\n   * GL上传贴图\n   * @private\n   * @param  {WebGLState} state\n   * @param  {GLenum} target\n   * @param  {HTMLImageElement|TypedArray} image\n   * @param  {HTMLImageElement} [level=0]\n   * @param  {Number} [width=this.width]\n   * @param  {Number} [height=this.height]\n   * @return {Texture}  this\n   */\n  _glUploadTexture: function _glUploadTexture(state, target, image) {\n    var level = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 0;\n    var width = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : this.width;\n    var height = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : this.height;\n    var gl = state.gl;\n\n    if (this.compressed) {\n      gl.compressedTexImage2D(target, level, this.internalFormat, width, height, this.border, image);\n    } else if (image && image.width !== undefined) {\n      gl.texImage2D(target, level, this.internalFormat, this.format, this.type, image);\n    } else {\n      gl.texImage2D(target, level, this.internalFormat, width, height, this.border, this.format, this.type, image);\n    }\n\n    return this;\n  },\n\n  /**\n   * 上传贴图，子类可重写\n   * @private\n   * @param  {WebGLState} state\n   * @return {Texture} this\n   */\n  _uploadTexture: function _uploadTexture(state) {\n    var _this = this;\n\n    if (this.useMipmap && this.mipmaps) {\n      this.mipmaps.forEach(function (mipmap, index) {\n        _this._glUploadTexture(state, _this.target, mipmap.data, index, mipmap.width, mipmap.height);\n      });\n    } else {\n      this._glUploadTexture(state, this.target, this.image, 0);\n    }\n\n    return this;\n  },\n\n  /**\n   * 更新 Texture\n   * @param  {WebGLState} state\n   * @param  {WebGLTexture} glTexture\n   * @return {Texture} this\n   */\n  updateTexture: function updateTexture(state, glTexture) {\n    var gl = state.gl;\n\n    if (this.needUpdate || this.autoUpdate) {\n      if (this._originImage && this.image === this._canvasImage) {\n        this.image = this._originImage;\n      }\n\n      var useMipmap = this.useMipmap;\n      var useRepeat = this.useRepeat;\n\n      if (this.image && !this.image.length) {\n        var needPowerOfTwo = useRepeat || useMipmap;\n        var sizeResult = this.getSupportSize(this.image, needPowerOfTwo);\n        this.image = this.resizeImg(this.image, sizeResult.width, sizeResult.height);\n        this.width = this.image.width;\n        this.height = this.image.height;\n      }\n\n      state.activeTexture(gl.TEXTURE0 + renderer_capabilities.MAX_TEXTURE_INDEX);\n      state.bindTexture(this.target, glTexture);\n      state.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.premultiplyAlpha);\n      state.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, !!this.flipY);\n      var textureFilterAnisotropic = renderer_extensions.textureFilterAnisotropic;\n\n      if (textureFilterAnisotropic && this.anisotropic > 1) {\n        gl.texParameterf(this.target, textureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT, Math.min(this.anisotropic, renderer_capabilities.MAX_TEXTURE_MAX_ANISOTROPY));\n      }\n\n      this._uploadTexture(state);\n\n      if (useMipmap) {\n        if (!this.compressed) {\n          gl.generateMipmap(this.target);\n        } else if (!this.mipmaps) {\n          utils_log.warn(\"Compressed texture has no mipmips, changed the minFilter from \".concat(this.minFilter, \" to Linear!\"), this);\n          this.minFilter = Texture_LINEAR;\n        }\n      }\n\n      gl.texParameterf(this.target, gl.TEXTURE_MAG_FILTER, this.magFilter);\n      gl.texParameterf(this.target, gl.TEXTURE_MIN_FILTER, this.minFilter);\n      gl.texParameterf(this.target, gl.TEXTURE_WRAP_S, this.wrapS);\n      gl.texParameterf(this.target, gl.TEXTURE_WRAP_T, this.wrapT);\n      this.needUpdate = false;\n    }\n\n    if (this._needUpdateSubTexture) {\n      this._uploadSubTextures(state, glTexture);\n\n      this._needUpdateSubTexture = false;\n    }\n\n    return this;\n  },\n\n  /**\n   * 跟新所有的局部贴图\n   * @private\n   * @param  {WebGLState} state\n   * @param  {WebGLTexture} glTexture\n   */\n  _uploadSubTextures: function _uploadSubTextures(state, glTexture) {\n    var _this2 = this;\n\n    if (this._subTextureList && this._subTextureList.length > 0) {\n      var gl = state.gl;\n      state.activeTexture(gl.TEXTURE0 + renderer_capabilities.MAX_TEXTURE_INDEX);\n      state.bindTexture(this.target, glTexture);\n      state.pixelStorei(gl.UNPACK_PREMULTIPLY_ALPHA_WEBGL, this.premultiplyAlpha);\n      state.pixelStorei(gl.UNPACK_FLIP_Y_WEBGL, !!this.flipY);\n\n      this._subTextureList.forEach(function (subInfo) {\n        var xOffset = subInfo[0];\n        var yOffset = subInfo[1];\n        var image = subInfo[2];\n        gl.texSubImage2D(_this2.target, 0, xOffset, yOffset, _this2.format, _this2.type, image);\n      });\n\n      this._subTextureList.length = 0;\n    }\n  },\n  _needUpdateSubTexture: false,\n  _subTextureList: null,\n\n  /**\n   * 跟新局部贴图\n   * @param  {Number} xOffset\n   * @param  {Number} yOffset\n   * @param  {HTMLImageElement|HTMLCanvasElement|ImageData} image\n   */\n  updateSubTexture: function updateSubTexture(xOffset, yOffset, image) {\n    if (!this._subTextureList) {\n      this._subTextureList = [];\n    }\n\n    this._subTextureList.push([xOffset, yOffset, image]);\n\n    this._needUpdateSubTexture = true;\n  },\n\n  /**\n   * 获取 GLTexture\n   * @param  {WebGLState} state\n   * @return {WebGLTexture}\n   */\n  getGLTexture: function getGLTexture(state) {\n    this.state = state;\n    var gl = this.gl = state.gl;\n    var id = this.id;\n\n    if (this.needDestroy) {\n      this.destroy();\n      this.needDestroy = false;\n    }\n\n    var glTexture = Texture_cache.get(id);\n\n    if (glTexture) {\n      this.updateTexture(state, glTexture);\n    } else {\n      glTexture = gl.createTexture();\n      Texture_cache.add(id, glTexture);\n      this.needUpdate = true;\n      this.updateTexture(state, glTexture);\n    }\n\n    if (this.isImageCanRelease) {\n      this._releaseImage();\n    }\n\n    return glTexture;\n  },\n\n  /**\n   * 设置 GLTexture\n   * @param {WebGLTexture}  texture\n   * @param {Boolean} [needDestroy=false] 是否销毁之前的 GLTexture\n   * @return {Texture} this\n   */\n  setGLTexture: function setGLTexture(texture) {\n    var needDestroy = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (needDestroy) {\n      this.destroy();\n    }\n\n    Texture_cache.add(this.id, texture);\n    return this;\n  },\n\n  /**\n   * 销毁当前Texture\n   * @return {Texture} this\n   */\n  destroy: function destroy() {\n    var id = this.id;\n    var glTexture = Texture_cache.get(id);\n\n    if (glTexture && this.gl) {\n      this.gl.deleteTexture(glTexture);\n      Texture_cache.remove(id);\n    }\n\n    return this;\n  },\n\n  /**\n   * clone\n   * @return {Texture}\n   */\n  clone: function clone() {\n    var option = Object.assign({}, this);\n    delete option.id;\n    var texture = new this.constructor(option);\n    return texture;\n  }\n});\n/* harmony default export */ var texture_Texture = (Texture);\n// CONCATENATED MODULE: ./src/renderer/Framebuffer.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar Framebuffer_TEXTURE_2D = src_constants.TEXTURE_2D,\n    Framebuffer_RGBA = src_constants.RGBA,\n    Framebuffer_UNSIGNED_BYTE = src_constants.UNSIGNED_BYTE,\n    COLOR_ATTACHMENT0 = src_constants.COLOR_ATTACHMENT0,\n    DEPTH_STENCIL = src_constants.DEPTH_STENCIL,\n    DEPTH_TEST = src_constants.DEPTH_TEST,\n    CULL_FACE = src_constants.CULL_FACE,\n    TRIANGLE_STRIP = src_constants.TRIANGLE_STRIP,\n    Framebuffer_NEAREST = src_constants.NEAREST,\n    Framebuffer_CLAMP_TO_EDGE = src_constants.CLAMP_TO_EDGE;\nvar Framebuffer_cache = new utils_Cache();\n/**\n * 帧缓冲\n * @class\n */\n\nvar Framebuffer = core_Class.create(\n/** @lends Framebuffer.prototype */\n{\n  Statics: {\n    /**\n     * 缓存\n     * @readOnly\n     * @memberOf Framebuffer\n     * @type {Cache}\n     */\n    cache: {\n      get: function get() {\n        return Framebuffer_cache;\n      }\n    },\n\n    /**\n     * 重置所有framebuffer\n     * @memberOf Framebuffer\n     * @param  {WebGLRenderingContext} gl\n     */\n    reset: function reset(gl) {\n      // eslint-disable-line no-unused-vars\n      Framebuffer_cache.each(function (framebuffer) {\n        framebuffer.reset();\n      });\n    },\n\n    /**\n     * 销毁所有 Framebuffer\n     * @memberOf Framebuffer\n     * @param  {WebGLRenderingContext} gl\n     */\n    destroy: function destroy(gl) {\n      // eslint-disable-line no-unused-vars\n      Framebuffer_cache.each(function (framebuffer) {\n        framebuffer.destroy();\n      });\n    }\n  },\n\n  /**\n   * @default Framebuffer\n   * @type {String}\n   */\n  className: 'Framebuffer',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isFramebuffer: true,\n\n  /**\n   * bufferInternalFormat\n   * @type {GLenum}\n   * @default gl.DEPTH_STENCIL\n   */\n  bufferInternalFormat: DEPTH_STENCIL,\n\n  /**\n   * texture target\n   * @type {GLenum}\n   * @default gl.TEXTURE_2D\n   */\n  target: Framebuffer_TEXTURE_2D,\n\n  /**\n   * texture format\n   * @type {GLenum}\n   * @default gl.RGBA\n   */\n  format: Framebuffer_RGBA,\n\n  /**\n   * texture internalFormat\n   * @type {GLenum}\n   * @default gl.RGBA\n   */\n  internalFormat: Framebuffer_RGBA,\n\n  /**\n   * texture type\n   * @type {GLenum}\n   * @default gl.UNSIGNED_BYTE\n   */\n  type: Framebuffer_UNSIGNED_BYTE,\n\n  /**\n   * texture minFilter\n   * @type {GLenum}\n   * @default gl.NEAREST\n   */\n  minFilter: Framebuffer_NEAREST,\n\n  /**\n   * texture magFilter\n   * @type {GLenum}\n   * @default gl.NEAREST\n   */\n  magFilter: Framebuffer_NEAREST,\n\n  /**\n   * texture data\n   * @type {TypedArray}\n   * @default null\n   */\n  data: null,\n\n  /**\n   * attachment\n   * @type {GLenum}\n   * @default gl.COLOR_ATTACHMENT0\n   */\n  attachment: COLOR_ATTACHMENT0,\n\n  /**\n   * 是否需要renderbuffer\n   * @type {Boolean}\n   * @default true\n   */\n  needRenderbuffer: true,\n\n  /**\n   * 是否使用VAO\n   * @type {Boolean}\n   * @default true\n   */\n  useVao: true,\n\n  /**\n   * renderer\n   * @type {WebGLRenderer}\n   * @default null\n   */\n  renderer: null,\n\n  /**\n   * texture\n   * @type {Texture}\n   */\n  texture: null,\n\n  /**\n   * renderbuffer\n   * @type {WebGLRenderbuffer}\n   */\n  renderbuffer: null,\n\n  /**\n   * framebuffer\n   * @type {WebGLFramebuffer}\n   */\n  framebuffer: null,\n  _isInit: false,\n\n  /**\n   * @constructs\n   * @param {WebGLRenderer}  renderer\n   * @param  {Object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(renderer, params) {\n    this.id = math_math.generateUUID(this.className);\n    this.renderer = renderer;\n    Object.assign(this, params);\n\n    if (!this.width) {\n      this.width = renderer.width;\n    }\n\n    if (!this.height) {\n      this.height = renderer.height;\n    }\n\n    Framebuffer_cache.add(this.id, this);\n  },\n\n  /**\n   * init\n   * @private\n   */\n  init: function init() {\n    if (!this._isInit && this.renderer.isInit) {\n      this._isInit = true;\n      var renderer = this.renderer;\n      this.gl = renderer.gl;\n      this.state = renderer.state;\n      this.reset();\n    }\n  },\n\n  /**\n   * reset\n   * @private\n   */\n  reset: function reset() {\n    this.destroyResource();\n    var gl = this.gl;\n    /**\n     * framebuffer\n     * @type {WebGLFramebuffer}\n     */\n\n    this.framebuffer = gl.createFramebuffer();\n    this.bind();\n\n    if (this.needRenderbuffer) {\n      this.renderbuffer = this.createRenderbuffer();\n    }\n\n    this.texture = this.createTexture();\n\n    if (!this.isComplete()) {\n      utils_log.warn('Framebuffer is not complete => ' + gl.checkFramebufferStatus(gl.FRAMEBUFFER));\n    }\n\n    this.unbind();\n  },\n\n  /**\n   * framebuffer 是否完成\n   * @return {Boolean}\n   */\n  isComplete: function isComplete() {\n    var gl = this.gl;\n\n    if (gl && gl.checkFramebufferStatus(gl.FRAMEBUFFER) === gl.FRAMEBUFFER_COMPLETE) {\n      return true;\n    }\n\n    return false;\n  },\n\n  /**\n   * 绑定\n   */\n  bind: function bind() {\n    this.init();\n\n    if (this._isInit) {\n      this.state.bindFramebuffer(this.gl.FRAMEBUFFER, this.framebuffer);\n    }\n  },\n\n  /**\n   * 解绑\n   */\n  unbind: function unbind() {\n    this.init();\n\n    if (this._isInit) {\n      var state = this.state;\n      state.bindFramebuffer(this.gl.FRAMEBUFFER, state.preFramebuffer);\n    }\n  },\n  clear: function clear() {\n    var clearColor = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : new math_Color(0, 0, 0, 0);\n\n    if (this._isInit) {\n      var gl = this.gl;\n      gl.clearColor(clearColor.r, clearColor.g, clearColor.b, clearColor.a);\n      gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    }\n  },\n\n  /**\n   * 渲染当前纹理\n   * @param  {Number} [x=0]\n   * @param  {Number} [y=0]\n   * @param  {Number} [width=1]\n   * @param  {Number} [height=1]\n   * @param  {Color} clearColor\n   */\n  render: function render() {\n    var x = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : 0;\n    var y = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 0;\n    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    var clearColor = arguments.length > 4 ? arguments[4] : undefined;\n\n    if (this._isInit) {\n      var gl = this.gl,\n          state = this.state;\n      state.disable(DEPTH_TEST);\n      state.disable(CULL_FACE);\n\n      if (clearColor) {\n        this.clear(clearColor);\n      }\n\n      var shader = shader_Shader.getCustomShader(screen_default.a, shader_screen_default.a, '', 'FramebufferTextureShader');\n      var program = renderer_Program.getProgram(shader, state);\n      program.useProgram();\n      var vaoId = \"\".concat(x, \"_\").concat(y, \"_\").concat(width, \"_\").concat(height, \"_\").concat(program.id);\n      var vao = renderer_VertexArrayObject.getVao(gl, vaoId, {\n        useVao: this.useVao,\n        useInstanced: false,\n        mode: TRIANGLE_STRIP\n      });\n\n      if (vao.isDirty) {\n        vao.isDirty = false;\n        x = x * 2 - 1;\n        y = 1 - y * 2;\n        width *= 2;\n        height *= 2;\n        var vertices = [x, y, x + width, y, x, y - height, x + width, y - height];\n        vao.addAttribute(new geometry_GeometryData(new Float32Array(vertices), 2), program.attributes.a_position);\n        vao.addAttribute(new geometry_GeometryData(new Float32Array([0, 1, 1, 1, 0, 0, 1, 0]), 2), program.attributes.a_texcoord0);\n      }\n\n      state.activeTexture(gl.TEXTURE0);\n      state.bindTexture(gl.TEXTURE_2D, this.texture.getGLTexture(state));\n      vao.draw();\n    }\n  },\n\n  /**\n   * 生成 Renderbuffer\n   * @private\n   * @return {WebGLRenderbuffer}\n   */\n  createRenderbuffer: function createRenderbuffer() {\n    var gl = this.gl,\n        width = this.width,\n        height = this.height;\n    var renderbuffer = gl.createRenderbuffer();\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_STENCIL, width, height);\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_STENCIL_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\n    return renderbuffer;\n  },\n\n  /**\n   * 生成纹理\n   * @private\n   * @return {Texture}\n   */\n  createTexture: function createTexture() {\n    var state = this.state;\n    var gl = state.gl;\n    var texture = new texture_Texture({\n      minFilter: this.minFilter,\n      magFilter: this.magFilter,\n      internalFormat: this.internalFormat,\n      format: this.format,\n      type: this.type,\n      width: this.width,\n      height: this.height,\n      image: this.data,\n      wrapS: Framebuffer_CLAMP_TO_EDGE,\n      wrapT: Framebuffer_CLAMP_TO_EDGE\n    });\n    var glTexture = texture.getGLTexture(state);\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, this.attachment, this.target, glTexture, 0);\n    return texture;\n  },\n\n  /**\n   * resize\n   * @param  {Number} width\n   * @param  {Number} height\n   * @param  {Boolean} [force=true]\n   */\n  resize: function resize(width, height, force) {\n    if (force || this.width !== width || this.height !== height) {\n      this.width = width;\n      this.height = height;\n\n      if (this._isInit) {\n        this.reset();\n      }\n    }\n  },\n\n  /**\n   * 读取区域像素\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} [width=1]\n   * @param  {Number} [height=1]\n   * @return {TypedArray}\n   */\n  readPixels: function readPixels(x, y) {\n    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    var TypedArray = getTypedArrayClass(this.type);\n    var pixels = new TypedArray(width * height * 4);\n\n    if (this._isInit) {\n      var gl = this.gl; // convert to webgl coordinate system\n\n      y = this.height - y - height;\n      this.bind();\n      gl.readPixels(x, y, width, height, this.format, this.type, pixels);\n      this.unbind();\n    }\n\n    return pixels;\n  },\n  destroy: function destroy() {\n    this.destroyResource();\n    this.gl = null;\n    Framebuffer_cache.removeObject(this);\n  },\n\n  /**\n   * 销毁资源\n   */\n  destroyResource: function destroyResource() {\n    var gl = this.gl;\n\n    if (gl) {\n      if (this.framebuffer) {\n        gl.deleteFramebuffer(this.framebuffer);\n        this.framebuffer = null;\n      }\n\n      if (this.renderbuffer) {\n        gl.deleteRenderbuffer(this.renderbuffer);\n        this.renderbuffer = null;\n      }\n\n      if (this.texture) {\n        this.texture.destroy();\n        this.texture = null;\n      }\n    }\n  }\n});\n/* harmony default export */ var renderer_Framebuffer = (Framebuffer);\n// CONCATENATED MODULE: ./src/texture/CubeTexture.js\n\n\n\n\nvar TEXTURE_CUBE_MAP = src_constants.TEXTURE_CUBE_MAP,\n    RGB = src_constants.RGB,\n    CubeTexture_LINEAR = src_constants.LINEAR,\n    CubeTexture_CLAMP_TO_EDGE = src_constants.CLAMP_TO_EDGE,\n    TEXTURE_CUBE_MAP_POSITIVE_X = src_constants.TEXTURE_CUBE_MAP_POSITIVE_X;\n/**\n * 立方体纹理\n * @class\n * @extends Texture\n * @example\n * var loadQueue = new Hilo3d.LoadQueue([{\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB15OJpQFXXXXXgXVXXXXXXXXXX-512-512.png'\n * }, {\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB1gwNqQFXXXXcIXFXXXXXXXXXX-512-512.png'\n * }, {\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB1pyNcQFXXXXb7XVXXXXXXXXXX-512-512.png'\n * }, {\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB1FilNQFXXXXcKXXXXXXXXXXXX-512-512.png'\n * }, {\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB1gIpqQFXXXXcZXFXXXXXXXXXX-512-512.png'\n * }, {\n *     crossOrigin: 'anonymous',\n *     src: '//gw.alicdn.com/tfs/TB1RFXLQFXXXXXEXpXXXXXXXXXX-512-512.png'\n * }]).on('complete', function () {\n *     var result = loadQueue.getAllContent();\n *     var skyboxMap = new Hilo3d.CubeTexture({\n *         image: result\n *     });\n *     var skybox = new Hilo3d.Mesh({\n *         geometry: new Hilo3d.BoxGeometry(),\n *         material: new Hilo3d.BasicMaterial({\n *             lightType: 'NONE',\n *             diffuse: skyboxMap\n *         })\n *     });\n *     stage.addChild(skybox);\n * });\n */\n\nvar CubeTexture = core_Class.create(\n/** @lends CubeTexture.prototype */\n{\n  Extends: texture_Texture,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isCubeTexture: true,\n\n  /**\n   * @default CubeTexture\n   * @type {string}\n   */\n  className: 'CubeTexture',\n\n  /**\n   * @default TEXTURE_CUBE_MAP\n   * @type {number}\n   */\n  target: TEXTURE_CUBE_MAP,\n\n  /**\n   * @default RGB\n   * @type {number}\n   */\n  internalFormat: RGB,\n\n  /**\n   * @default RGB\n   * @type {number}\n   */\n  format: RGB,\n\n  /**\n   * @default LINEAR\n   * @type {number}\n   */\n  magFilter: CubeTexture_LINEAR,\n\n  /**\n   * @default LINEAR\n   * @type {number}\n   */\n  minFilter: CubeTexture_LINEAR,\n\n  /**\n   * @default CLAMP_TO_EDGE\n   * @type {number}\n   */\n  wrapS: CubeTexture_CLAMP_TO_EDGE,\n\n  /**\n   * @default CLAMP_TO_EDGE\n   * @type {number}\n   */\n  wrapT: CubeTexture_CLAMP_TO_EDGE,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {HTMLImageElement[]} [params.image] 图片列表，共6张\n   */\n  constructor: function constructor(params) {\n    CubeTexture.superclass.constructor.call(this, params);\n    this.image = this.image || [];\n  },\n  _uploadTexture: function _uploadTexture(state) {\n    var _this = this;\n\n    var images = this.image;\n\n    if (!Array.isArray(images) || images.length !== 6) {\n      utils_log.error('CubeTexture image must be an Array of length 6', images);\n      return;\n    }\n\n    if (images[0] && images[0].width) {\n      this.width = images[0].width;\n      this.height = images[0].height;\n    }\n\n    images.forEach(function (img, i) {\n      _this._glUploadTexture(state, TEXTURE_CUBE_MAP_POSITIVE_X + i, img, 0);\n    });\n  },\n\n  /**\n   * 右侧的图片\n   * @type {HTMLImageElement}\n   */\n  right: {\n    get: function get() {\n      return this.image[0];\n    },\n    set: function set(img) {\n      this.image[0] = img;\n    }\n  },\n\n  /**\n   * 左侧的图片\n   * @type {HTMLImageElement}\n   */\n  left: {\n    get: function get() {\n      return this.image[1];\n    },\n    set: function set(img) {\n      this.image[1] = img;\n    }\n  },\n\n  /**\n   * 顶部的图片\n   * @type {HTMLImageElement}\n   */\n  top: {\n    get: function get() {\n      return this.image[2];\n    },\n    set: function set(img) {\n      this.image[2] = img;\n    }\n  },\n\n  /**\n   * 底部的图片\n   * @type {HTMLImageElement}\n   */\n  bottom: {\n    get: function get() {\n      return this.image[3];\n    },\n    set: function set(img) {\n      this.image[3] = img;\n    }\n  },\n\n  /**\n   * 朝前的图片\n   * @type {HTMLImageElement}\n   */\n  front: {\n    get: function get() {\n      return this.image[4];\n    },\n    set: function set(img) {\n      this.image[4] = img;\n    }\n  },\n\n  /**\n   * 朝后的图片\n   * @type {HTMLImageElement}\n   */\n  back: {\n    get: function get() {\n      return this.image[5];\n    },\n    set: function set(img) {\n      this.image[5] = img;\n    }\n  }\n});\n/* harmony default export */ var texture_CubeTexture = (CubeTexture);\n// CONCATENATED MODULE: ./src/texture/DataTexture.js\n\n\n\n\n\nvar DataTexture_TEXTURE_2D = src_constants.TEXTURE_2D,\n    DataTexture_RGBA = src_constants.RGBA,\n    DataTexture_NEAREST = src_constants.NEAREST,\n    DataTexture_CLAMP_TO_EDGE = src_constants.CLAMP_TO_EDGE,\n    DataTexture_FLOAT = src_constants.FLOAT;\n/**\n * 数据纹理\n * @class\n * @extends Texture\n */\n\nvar DataTexture = core_Class.create(\n/** @lends DataTexture.prototype */\n{\n  Extends: texture_Texture,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isDataTexture: true,\n\n  /**\n   * @default DataTexture\n   * @type {string}\n   */\n  className: 'DataTexture',\n\n  /**\n   * @default TEXTURE_2D\n   * @type {number}\n   */\n  target: DataTexture_TEXTURE_2D,\n\n  /**\n   * @default RGBA\n   * @type {number}\n   */\n  internalFormat: DataTexture_RGBA,\n\n  /**\n   * @default RGBA\n   * @type {number}\n   */\n  format: DataTexture_RGBA,\n\n  /**\n   * @default FLOAT\n   * @type {number}\n   */\n  type: DataTexture_FLOAT,\n\n  /**\n   * @default NEAREST\n   * @type {number}\n   */\n  magFilter: DataTexture_NEAREST,\n\n  /**\n   * @default NEAREST\n   * @type {number}\n   */\n  minFilter: DataTexture_NEAREST,\n\n  /**\n   * @default CLAMP_TO_EDGE\n   * @type {number}\n   */\n  wrapS: DataTexture_CLAMP_TO_EDGE,\n\n  /**\n   * @default CLAMP_TO_EDGE\n   * @type {number}\n   */\n  wrapT: DataTexture_CLAMP_TO_EDGE,\n  dataLength: 0,\n  resetSize: function resetSize(dataLen) {\n    if (dataLen === this.dataLength) {\n      return;\n    }\n\n    this.dataLength = dataLen;\n    var pixelCount = math_math.nextPowerOfTwo(dataLen / 4);\n    var n = Math.max(Math.log2(pixelCount), 4);\n    var w = Math.floor(n / 2);\n    var h = n - w;\n    this.width = Math.pow(2, w);\n    this.height = Math.pow(2, h);\n    this.DataClass = getTypedArrayClass(this.type);\n  },\n\n  /**\n   * 数据，改变数据的时候会自动更新Texture\n   * @type {Float32Array}\n   */\n  data: {\n    get: function get() {\n      return this.image;\n    },\n    set: function set(_data) {\n      if (this.image !== _data) {\n        this.resetSize(_data.length);\n        var len = this.width * this.height * 4;\n\n        if (len === _data.length && _data instanceof this.DataClass) {\n          this.image = _data;\n        } else {\n          if (!this.image || this.image.length !== len) {\n            this.image = new this.DataClass(len);\n          }\n\n          this.image.set(_data, 0);\n        }\n\n        this.needUpdate = true;\n      }\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {Array|Float32Array} [params.data] 数据\n   */\n  constructor: function constructor(params) {\n    DataTexture.superclass.constructor.call(this, params);\n  }\n});\n/* harmony default export */ var texture_DataTexture = (DataTexture);\n// CONCATENATED MODULE: ./src/material/semantic.js\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n/* eslint no-unused-vars: \"off\" */\n\n\n\n\n\n\nvar semantic_tempVector3 = new math_Vector3();\nvar semantic_tempMatrix3 = new math_Matrix3();\nvar semantic_tempMatrix4 = new math_Matrix4();\nvar tempFloat32Array4 = new Float32Array([0.5, 0.5, 0.5, 1]);\nvar tempFloat32Array2 = new Float32Array([0, 0]);\nvar blankInfo = {\n  get: function get() {\n    return undefined;\n  }\n};\nvar semantic_camera;\nvar semantic_gl;\nvar semantic_lightManager;\nvar semantic_state;\nvar semantic_fog;\nvar semantic_renderer;\n/**\n * 语义\n * @namespace semantic\n * @type {Object}\n */\n\nvar semantic = {\n  /**\n   * @type {WebGLState}\n   */\n  state: null,\n\n  /**\n   * @type {Camera}\n   */\n  camera: null,\n\n  /**\n   * @type {LightManager}\n   */\n  lightManager: null,\n\n  /**\n   * @type {Fog}\n   */\n  fog: null,\n\n  /**\n   * @type {WebGLRenderingContext}\n   */\n  gl: null,\n\n  /**\n   * WebGLRenderer\n   * @type {WebGLRenderer}\n   */\n  renderer: null,\n  blankInfo: blankInfo,\n\n  /**\n   * 初始化\n   * @param  {WebGLState} _state\n   * @param  {Camera} _camera\n   * @param  {LightManager} _lightManager\n   * @param  {Fog} _fog\n   */\n  init: function init(_renderer, _state, _camera, _lightManager, _fog) {\n    semantic_renderer = this._renderer = _renderer;\n    semantic_state = this.state = _state;\n    semantic_camera = this.camera = _camera;\n    semantic_lightManager = this.lightManager = _lightManager;\n    semantic_fog = this.fog = _fog;\n    semantic_gl = this.gl = semantic_state.gl;\n  },\n\n  /**\n   * 设置相机\n   * @param {Camera} _camera\n   */\n  setCamera: function setCamera(_camera) {\n    semantic_camera = this.camera = _camera;\n  },\n  handlerColorOrTexture: function handlerColorOrTexture(value, textureIndex) {\n    if (value && value.isTexture) {\n      return this.handlerTexture(value, textureIndex);\n    }\n\n    if (value && value.isColor) {\n      value.toArray(tempFloat32Array4);\n    } else {\n      tempFloat32Array4[0] = tempFloat32Array4[1] = tempFloat32Array4[2] = 0.5;\n    }\n\n    return tempFloat32Array4;\n  },\n  handlerTexture: function handlerTexture(value, textureIndex) {\n    if (value && value.isTexture) {\n      return this.handlerGLTexture(value.target, value.getGLTexture(semantic_state), textureIndex);\n    }\n\n    return undefined;\n  },\n  handlerGLTexture: function handlerGLTexture(target, texture, textureIndex) {\n    if (texture) {\n      semantic_state.activeTexture(semantic_gl.TEXTURE0 + textureIndex);\n      semantic_state.bindTexture(target, texture);\n      return textureIndex;\n    }\n\n    return undefined;\n  },\n  handlerUV: function handlerUV(texture) {\n    if (texture && texture.isTexture) {\n      return texture.uv || 0;\n    }\n\n    return 0;\n  },\n  // attributes\n\n  /**\n   * @type {semanticObject}\n   */\n  POSITION: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.vertices;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  NORMAL: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.normals;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  TANGENT: {\n    get: function get(mesh, material, programInfo) {\n      var normalMap = material.normalMap;\n\n      if (normalMap && normalMap.isTexture) {\n        if (Number(normalMap.uv) === 1) {\n          return mesh.geometry.tangents1;\n        }\n\n        return mesh.geometry.tangents;\n      }\n\n      return undefined;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  TEXCOORD_0: {\n    get: function get(mesh, material, programInfo) {\n      if (!mesh.geometry.uvs) {\n        return undefined;\n      }\n\n      return mesh.geometry.uvs;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  TEXCOORD_1: {\n    get: function get(mesh, material, programInfo) {\n      if (!mesh.geometry.uvs1) {\n        return undefined;\n      }\n\n      return mesh.geometry.uvs1;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  UVMATRIX_0: {\n    get: function get(mesh, material, programInfo) {\n      if (!material.uvMatrix) {\n        return undefined;\n      }\n\n      return material.uvMatrix.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  UVMATRIX_1: {\n    get: function get(mesh, material, programInfo) {\n      if (!material.uvMatrix1) {\n        return undefined;\n      }\n\n      return material.uvMatrix1.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  CAMERAFAR: {\n    get: function get(mesh, material, programInfo) {\n      if (semantic_camera.isPerspectiveCamera) {\n        return semantic_camera.far;\n      }\n\n      return undefined;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  CAMERANEAR: {\n    get: function get(mesh, material, programInfo) {\n      if (semantic_camera.isPerspectiveCamera) {\n        return semantic_camera.near;\n      }\n\n      return undefined;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  CAMERATYPE: {\n    get: function get(mesh, material, programInfo) {\n      if (semantic_camera.isPerspectiveCamera) {\n        return 1;\n      }\n\n      return 0;\n    }\n  },\n  CAMERAPOSITION: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.worldMatrix.getTranslation(semantic_tempVector3).elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  COLOR_0: {\n    get: function get(mesh, material, programInfo) {\n      if (!mesh.geometry.colors) {\n        return undefined;\n      }\n\n      return mesh.geometry.colors;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SKININDICES: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.skinIndices;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SKINWEIGHTS: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.skinWeights;\n    }\n  },\n  // uniforms\n\n  /**\n   * @type {semanticObject}\n   */\n  RENDERERSIZE: {\n    get: function get(mesh, material, programInfo) {\n      tempFloat32Array2[0] = semantic_renderer.width;\n      tempFloat32Array2[1] = semantic_renderer.height;\n      return tempFloat32Array2;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  LOCAL: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.matrix.elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODEL: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.worldMatrix.elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  VIEW: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.viewMatrix.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  PROJECTION: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.projectionMatrix.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  VIEWPROJECTION: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.viewProjectionMatrix.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELVIEW: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.getModelViewMatrix(mesh, semantic_tempMatrix4).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELVIEWPROJECTION: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.getModelProjectionMatrix(mesh, semantic_tempMatrix4).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELINVERSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix4.invert(mesh.worldMatrix).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  VIEWINVERSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_camera.worldMatrix.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n  */\n  VIEWINVERSEINVERSETRANSPOSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix3.normalFromMat4(semantic_camera.worldMatrix).elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  PROJECTIONINVERSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix4.invert(semantic_camera.projectionMatrix).elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELVIEWINVERSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix4.invert(semantic_camera.getModelViewMatrix(mesh, semantic_tempMatrix4)).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELVIEWPROJECTIONINVERSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix4.invert(semantic_camera.getModelProjectionMatrix(mesh, semantic_tempMatrix4)).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELINVERSETRANSPOSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix3.normalFromMat4(mesh.worldMatrix).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  MODELVIEWINVERSETRANSPOSE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_tempMatrix3.normalFromMat4(semantic_camera.getModelViewMatrix(mesh, semantic_tempMatrix4)).elements;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * 还未实现，不要使用\n   * @type {semanticObject}\n   * @default undefined\n   */\n  VIEWPORT: undefined,\n\n  /**\n   * @type {semanticObject}\n   */\n  JOINTMATRIX: {\n    get: function get(mesh, material, programInfo) {\n      if (mesh.isSkinedMesh) {\n        return mesh.getJointMat();\n      }\n\n      utils_log.warnOnce(\"semantic.JOINTMATRIX(\".concat(mesh.id, \")\"), 'Current mesh is not SkinedMesh!', mesh.id);\n      return undefined;\n    },\n    isDependMesh: true,\n    notSupportInstanced: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  JOINTMATRIXTEXTURE: {\n    get: function get(mesh, material, programInfo) {\n      if (mesh.isSkinedMesh) {\n        mesh.updateJointMatTexture();\n        return semantic.handlerTexture(mesh.jointMatTexture, programInfo.textureIndex);\n      }\n\n      utils_log.warnOnce(\"semantic.JOINTMATRIXTEXTURE(\".concat(mesh.id, \")\"), 'Current mesh is not SkinedMesh!', mesh.id);\n      return undefined;\n    },\n    isDependMesh: true,\n    notSupportInstanced: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  JOINTMATRIXTEXTURESIZE: {\n    get: function get(mesh, material, programInfo) {\n      if (mesh.isSkinedMesh) {\n        mesh.initJointMatTexture();\n        return [mesh.jointMatTexture.width, mesh.jointMatTexture.height];\n      }\n\n      utils_log.warnOnce(\"semantic.JOINTMATRIXTEXTURESIZE(\".concat(mesh.id, \")\"), 'Current mesh is not SkinedMesh!', mesh.id);\n      return undefined;\n    },\n    isDependMesh: true,\n    notSupportInstanced: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  NORMALMAPSCALE: {\n    get: function get(mesh, material, programInfo) {\n      return material.normalMapScale;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  OCCLUSIONSTRENGTH: {\n    get: function get(mesh, material, programInfo) {\n      return material.occlusionStrength;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SHININESS: {\n    get: function get(mesh, material, programInfo) {\n      return material.shininess;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPECULARENVMATRIX: {\n    get: function get(mesh, material, programInfo) {\n      if (material.specularEnvMatrix && material.specularEnvMap) {\n        return material.specularEnvMatrix.elements;\n      }\n\n      semantic_tempMatrix4.identity();\n      return semantic_tempMatrix4.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  REFLECTIVITY: {\n    get: function get(mesh, material, programInfo) {\n      return material.reflectivity;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  REFRACTRATIO: {\n    get: function get(mesh, material, programInfo) {\n      return material.refractRatio;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  REFRACTIVITY: {\n    get: function get(mesh, material, programInfo) {\n      return material.refractivity;\n    }\n  },\n  LOGDEPTH: {\n    get: function get(mesh, material, programInfo) {\n      return 2.0 / (Math.log(semantic_camera.far + 1.0) / Math.LN2);\n    }\n  },\n  // light\n\n  /**\n   * @type {semanticObject}\n   */\n  AMBIENTLIGHTSCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.ambientInfo;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.directionalInfo.colors;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSINFO: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.directionalInfo.infos;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSSHADOWMAP: {\n    get: function get(mesh, material, programInfo) {\n      var result = semantic_lightManager.directionalInfo.shadowMap.map(function (texture, i) {\n        return semantic.handlerTexture(texture, programInfo.textureIndex + i);\n      });\n      return result;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSSHADOWMAPSIZE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.directionalInfo.shadowMapSize;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSSHADOWBIAS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.directionalInfo.shadowBias;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIRECTIONALLIGHTSPACEMATRIX: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.directionalInfo.lightSpaceMatrix;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSPOS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.poses;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.colors;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSINFO: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.infos;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSRANGE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.ranges;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSSHADOWMAP: {\n    get: function get(mesh, material, programInfo) {\n      var result = semantic_lightManager.pointInfo.shadowMap.map(function (texture, i) {\n        return semantic.handlerTexture(texture, programInfo.textureIndex + i);\n      });\n      return result;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSSHADOWBIAS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.shadowBias;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTSPACEMATRIX: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.lightSpaceMatrix;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  POINTLIGHTCAMERA: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.pointInfo.cameras;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSPOS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.poses;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSDIR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.dirs;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.colors;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSCUTOFFS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.cutoffs;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSINFO: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.infos;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSRANGE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.ranges;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSSHADOWMAP: {\n    get: function get(mesh, material, programInfo) {\n      var result = semantic_lightManager.spotInfo.shadowMap.map(function (texture, i) {\n        return semantic.handlerTexture(texture, programInfo.textureIndex + i);\n      });\n      return result;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSSHADOWMAPSIZE: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.shadowMapSize;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSSHADOWBIAS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.shadowBias;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPOTLIGHTSPACEMATRIX: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.spotInfo.lightSpaceMatrix;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.areaInfo.colors;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSPOS: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.areaInfo.poses;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSWIDTH: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.areaInfo.width;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSHEIGHT: {\n    get: function get(mesh, material, programInfo) {\n      return semantic_lightManager.areaInfo.height;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSLTCTEXTURE1: {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(semantic_lightManager.areaInfo.ltcTexture1, programInfo.textureIndex);\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  AREALIGHTSLTCTEXTURE2: {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(semantic_lightManager.areaInfo.ltcTexture2, programInfo.textureIndex);\n    }\n  },\n  // fog\n\n  /**\n   * @type {semanticObject}\n   */\n  FOGCOLOR: {\n    get: function get(mesh, material, programInfo) {\n      if (semantic_fog) {\n        return semantic_fog.color.elements;\n      }\n\n      return undefined;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  FOGINFO: {\n    get: function get(mesh, material, programInfo) {\n      if (semantic_fog) {\n        return semantic_fog.getInfo();\n      }\n\n      return undefined;\n    }\n  },\n  // unQuantize\n\n  /**\n   * @type {semanticObject}\n   */\n  POSITIONDECODEMAT: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.positionDecodeMat;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  NORMALDECODEMAT: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.normalDecodeMat;\n    },\n    isDependMesh: true\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  UVDECODEMAT: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.uvDecodeMat;\n    },\n    isDependMesh: true\n  },\n  UV1DECODEMAT: {\n    get: function get(mesh, material, programInfo) {\n      return mesh.geometry.uv1DecodeMat;\n    },\n    isDependMesh: true\n  },\n  // pbr\n\n  /**\n   * @type {semanticObject}\n   */\n  BASECOLOR: {\n    get: function get(mesh, material, programInfo) {\n      return material.baseColor.elements;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  METALLIC: {\n    get: function get(mesh, material, programInfo) {\n      return material.metallic;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  ROUGHNESS: {\n    get: function get(mesh, material, programInfo) {\n      return material.roughness;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIFFUSEENVMAP: {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(material.diffuseEnvMap, programInfo.textureIndex);\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  DIFFUSEENVINTENSITY: {\n    get: function get(mesh, material, programInfo) {\n      return material.diffuseEnvIntensity;\n    }\n  },\n  DIFFUSEENVSPHEREHARMONICS3: {\n    get: function get(mesh, material, programInfo) {\n      var sphereHarmonics3 = material.diffuseEnvSphereHarmonics3;\n\n      if (sphereHarmonics3) {\n        return sphereHarmonics3.toArray();\n      }\n\n      return undefined;\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  BRDFLUT: {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(material.brdfLUT, programInfo.textureIndex);\n    }\n  },\n\n  /**\n   * @type {semanticObject}\n   */\n  SPECULARENVMAP: {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(material.specularEnvMap, programInfo.textureIndex);\n    }\n  },\n  SPECULARENVINTENSITY: {\n    get: function get(mesh, material, programInfo) {\n      return material.specularEnvIntensity;\n    }\n  },\n  SPECULARENVMAPMIPCOUNT: {\n    get: function get(mesh, material, programInfo) {\n      var specularEnvMap = material.specularEnvMap;\n\n      if (specularEnvMap) {\n        return specularEnvMap.mipmapCount;\n      }\n\n      return 1;\n    }\n  },\n  GLOSSINESS: {\n    get: function get(mesh, material, programInfo) {\n      return material.glossiness;\n    }\n  },\n  ALPHACUTOFF: {\n    get: function get(mesh, material, programInfo) {\n      return material.alphaCutoff;\n    }\n  },\n  EXPOSURE: {\n    get: function get(mesh, material, programInfo) {\n      return material.exposure;\n    }\n  },\n  GAMMAFACTOR: {\n    get: function get(mesh, material, programInfo) {\n      return material.gammaFactor;\n    }\n  },\n  // Morph Animation Uniforms\n  MORPHWEIGHTS: {\n    isDependMesh: true,\n    notSupportInstanced: true,\n    get: function get(mesh, material, programInfo) {\n      var geometry = mesh.geometry;\n\n      if (!geometry.isMorphGeometry || !geometry.weights) {\n        return undefined;\n      }\n\n      return geometry.weights;\n    }\n  }\n}; // Morph Animation Attributes\n\n[['POSITION', 'vertices'], ['NORMAL', 'normals'], ['TANGENT', 'tangents']].forEach(function (info) {\n  for (var i = 0; i < 8; i++) {\n    semantic['MORPH' + info[0] + i] = {\n      get: function (name, i) {\n        return function (mesh, material, programInfo) {\n          var geometry = mesh.geometry;\n\n          if (!geometry.isMorphGeometry || !geometry.targets || !geometry.targets[name]) {\n            return undefined;\n          }\n\n          var idx = geometry._originalMorphIndices ? geometry._originalMorphIndices[i] : i;\n          var data = geometry.targets[name][idx];\n          var idxCacheKey = \"_target_\".concat(name, \"_\").concat(i);\n\n          if (geometry[idxCacheKey] !== idx && data) {\n            data.isDirty = true;\n            geometry[idxCacheKey] = idx;\n          }\n\n          return data;\n        };\n      }(info[1], i)\n    };\n  }\n}); // Texture or Vector4\n\n[['DIFFUSE', 'diffuse'], ['SPECULAR', 'specular'], ['EMISSION', 'emission'], ['AMBIENT', 'ambient']].forEach(function (info) {\n  var _info = _slicedToArray(info, 2),\n      semanticName = _info[0],\n      textureName = _info[1];\n\n  semantic[semanticName] = {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerColorOrTexture(material[textureName], programInfo.textureIndex);\n    }\n  };\n  semantic[\"\".concat(semanticName, \"UV\")] = {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerUV(material[textureName]);\n    }\n  };\n}); // Texture\n\n[['NORMALMAP', 'normalMap'], ['PARALLAXMAP', 'parallaxMap'], ['BASECOLORMAP', 'baseColorMap'], ['METALLICMAP', 'metallicMap'], ['ROUGHNESSMAP', 'roughnessMap'], ['METALLICROUGHNESSMAP', 'metallicRoughnessMap'], ['OCCLUSIONMAP', 'occlusionMap'], ['SPECULARGLOSSINESSMAP', 'specularGlossinessMap'], ['LIGHTMAP', 'lightMap']].forEach(function (info) {\n  var _info2 = _slicedToArray(info, 2),\n      semanticName = _info2[0],\n      textureName = _info2[1];\n\n  semantic[semanticName] = {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerTexture(material[textureName], programInfo.textureIndex);\n    }\n  };\n  semantic[\"\".concat(semanticName, \"UV\")] = {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerUV(material[textureName]);\n    }\n  };\n}); // TRANSPARENCY\n\n[['TRANSPARENCY', 'transparency']].forEach(function (info) {\n  var _info3 = _slicedToArray(info, 2),\n      semanticName = _info3[0],\n      textureName = _info3[1];\n\n  semantic[semanticName] = {\n    get: function get(mesh, material, programInfo) {\n      var value = material[textureName];\n\n      if (value && value.isTexture) {\n        return semantic.handlerTexture(value, programInfo.textureIndex);\n      }\n\n      if (value !== undefined && value !== null) {\n        return value;\n      }\n\n      return 1;\n    }\n  };\n  semantic[\"\".concat(semanticName, \"UV\")] = {\n    get: function get(mesh, material, programInfo) {\n      return semantic.handlerUV(material[textureName]);\n    }\n  };\n});\n/**\n * semantic 对象\n * @typedef {object} semanticObject\n * @property {Boolean} isDependMesh 是否依赖 mesh\n * @property {Boolean} notSupportInstanced 是否不支持 instanced\n * @property {Function} get 获取数据方法\n */\n\n/* harmony default export */ var material_semantic = (semantic);\n// CONCATENATED MODULE: ./src/material/Material.js\n\n\n\n\n\nvar LEQUAL = src_constants.LEQUAL,\n    Material_BACK = src_constants.BACK,\n    Material_FRONT = src_constants.FRONT,\n    Material_FRONT_AND_BACK = src_constants.FRONT_AND_BACK,\n    ZERO = src_constants.ZERO,\n    FUNC_ADD = src_constants.FUNC_ADD,\n    ONE = src_constants.ONE,\n    SRC_ALPHA = src_constants.SRC_ALPHA,\n    ONE_MINUS_SRC_ALPHA = src_constants.ONE_MINUS_SRC_ALPHA;\nvar Material_blankInfo = {\n  isBlankInfo: true,\n  get: function get() {\n    return undefined;\n  }\n};\n/**\n * 材质基类，一般不直接使用\n * @class\n */\n\nvar Material = core_Class.create(\n/** @lends Material.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isMaterial: true,\n\n  /**\n   * @default Material\n   * @type {string}\n   */\n  className: 'Material',\n\n  /**\n   * name\n   * @type {string}\n   */\n  name: null,\n\n  /**\n   * shader cache id\n   * @default null\n   * @type {String}\n   */\n  shaderCacheId: null,\n\n  /**\n   * 光照类型\n   * @default NONE\n   * @type {string}\n   */\n  lightType: 'NONE',\n\n  /**\n   * 是否开启网格模式\n   * @default false\n   * @type {boolean}\n   */\n  wireframe: false,\n\n  /**\n   * 是否开启深度测试\n   * @default true\n   * @type {boolean}\n   */\n  depthTest: true,\n\n  /**\n   * SAMPLE_ALPHA_TO_COVERAGE\n   * @default false\n   * @type {Boolean}\n   */\n  sampleAlphaToCoverage: false,\n\n  /**\n   * 是否开启depthMask\n   * @default true\n   * @type {boolean}\n   */\n  depthMask: true,\n\n  /**\n   * 深度测试Range\n   * @default [0, 1]\n   * @type {Array}\n   */\n  depthRange: [0, 1],\n\n  /**\n   * 深度测试方法\n   * @default LESS\n   * @type {GLenum}\n   */\n  depthFunc: LEQUAL,\n  _cullFace: true,\n\n  /**\n   * 法线贴图\n   * @default null\n   * @type {Texture}\n   */\n  normalMap: null,\n\n  /**\n   * 视差贴图\n   * @default null\n   * @type {Texture}\n   */\n  parallaxMap: null,\n\n  /**\n   * 法线贴图scale\n   * @default 1\n   * @type {Number}\n   */\n  normalMapScale: 1,\n\n  /**\n   * 是否忽略透明度\n   * @type {Boolean}\n   * @default false\n   */\n  ignoreTranparent: false,\n\n  /**\n   * 是否开启 gamma 矫正\n   * @type {Boolean}\n   * @default false\n   */\n  gammaCorrection: false,\n\n  /**\n   * 是否使用物理灯光\n   * @type {Boolean}\n   * @default false\n   */\n  usePhysicsLight: false,\n\n  /**\n   * 是否环境贴图和环境光同时生效\n   * @type {Boolean}\n   * @default false\n   */\n  isDiffuesEnvAndAmbientLightWorkTogether: false,\n\n  /**\n   * 渲染顺序数字小的先渲染（透明物体和不透明在不同的队列）\n   * @default 0\n   * @type {Number}\n   */\n  renderOrder: 0,\n  _premultiplyAlpha: true,\n\n  /**\n   * 是否预乘 alpha\n   * @type {Boolean}\n   * @default true\n   */\n  premultiplyAlpha: {\n    get: function get() {\n      return this._premultiplyAlpha;\n    },\n    set: function set(value) {\n      this._premultiplyAlpha = value;\n\n      if (this.transparent) {\n        this.setDefaultTransparentBlend();\n      }\n    }\n  },\n\n  /**\n   * gammaOutput\n   * @type {Boolean}\n   * @deprecated\n   * @default false\n   */\n  gammaOutput: {\n    get: function get() {\n      utils_log.warnOnce('Matrial.gammaOutput', 'material.gammaOutput has deprecated. Use material.gammaCorrection instead.');\n      return this.gammaCorrection;\n    },\n    set: function set(value) {\n      utils_log.warnOnce('Matrial.gammaOutput', 'material.gammaOutput has deprecated. Use material.gammaCorrection instead.');\n      this.gammaCorrection = value;\n    }\n  },\n\n  /**\n   * gamma值\n   * @type {Number}\n   * @default 2.2\n   */\n  gammaFactor: 2.2,\n\n  /**\n   * 是否投射阴影\n   * @type {Boolean}\n   * @default true\n   */\n  castShadows: true,\n\n  /**\n   * 是否接受阴影\n   * @type {Boolean}\n   * @default true\n   */\n  receiveShadows: true,\n\n  /**\n   * uv transform eg:new Matrix3().fromRotationTranslationScale(Math.PI/2, 0, 0, 2, 2)\n   * @type {Matrix3}\n   */\n  uvMatrix: null,\n\n  /**\n   * uv1 transform eg:new Matrix3().fromRotationTranslationScale(Math.PI/2, 0, 0, 2, 2)\n   * @type {Matrix3}\n   */\n  uvMatrix1: null,\n\n  /**\n   * 是否开启 CullFace\n   * @default true\n   * @type {boolean}\n   */\n  cullFace: {\n    get: function get() {\n      return this._cullFace;\n    },\n    set: function set(value) {\n      this._cullFace = value;\n\n      if (value) {\n        this.cullFaceType = this._cullFaceType;\n      } else {\n        this._side = Material_FRONT_AND_BACK;\n      }\n    }\n  },\n  _cullFaceType: Material_BACK,\n\n  /**\n   * CullFace 类型\n   * @default BACK\n   * @type {GLenum}\n   */\n  cullFaceType: {\n    get: function get() {\n      return this._cullFaceType;\n    },\n    set: function set(value) {\n      this._cullFaceType = value;\n\n      if (this._cullFace) {\n        if (value === Material_BACK) {\n          this._side = Material_FRONT;\n        } else if (value === Material_FRONT) {\n          this._side = Material_BACK;\n        }\n      }\n    }\n  },\n  _side: Material_FRONT,\n\n  /**\n   * 显示面，可选值 FRONT, BACK, FRONT_AND_BACK\n   * @type {GLenum}\n   * @default FRONT\n   */\n  side: {\n    get: function get() {\n      return this._side;\n    },\n    set: function set(value) {\n      if (this._side !== value) {\n        this._side = value;\n\n        if (value === Material_FRONT_AND_BACK) {\n          this._cullFace = false;\n        } else {\n          this._cullFace = true;\n\n          if (value === Material_FRONT) {\n            this._cullFaceType = Material_BACK;\n          } else if (value === Material_BACK) {\n            this._cullFaceType = Material_FRONT;\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * 是否开启颜色混合\n   * @default false\n   * @type {boolean}\n   */\n  blend: false,\n\n  /**\n   * 颜色混合方式\n   * @default FUNC_ADD\n   * @type {GLenum}\n   */\n  blendEquation: FUNC_ADD,\n\n  /**\n   * 透明度混合方式\n   * @default FUNC_ADD\n   * @type {GLenum}\n   */\n  blendEquationAlpha: FUNC_ADD,\n\n  /**\n   * 颜色混合来源比例\n   * @default ONE\n   * @type {GLenum}\n   */\n  blendSrc: ONE,\n\n  /**\n   * 颜色混合目标比例\n   * @default ZERO\n   * @type {GLenum}\n   */\n  blendDst: ZERO,\n\n  /**\n   * 透明度混合来源比例\n   * @default ONE\n   * @type {GLenum}\n   */\n  blendSrcAlpha: ONE,\n\n  /**\n   * 透明度混合目标比例\n   * @default ONE\n   * @type {GLenum}\n   */\n  blendDstAlpha: ZERO,\n\n  /**\n   * 当前是否需要强制更新\n   * @default false\n   * @type {boolean}\n   */\n  isDirty: false,\n\n  /**\n   * 透明度 0~1\n   * @default 1\n   * @type {number}\n   */\n  transparency: 1,\n  _transparent: false,\n\n  /**\n   * 是否需要透明\n   * @default false\n   * @type {boolean}\n   */\n  transparent: {\n    get: function get() {\n      return this._transparent;\n    },\n    set: function set(value) {\n      if (this._transparent !== value) {\n        this._transparent = value;\n\n        if (!value) {\n          this.blend = false;\n          this.depthMask = true;\n        } else {\n          this.setDefaultTransparentBlend();\n        }\n      }\n    }\n  },\n  setDefaultTransparentBlend: function setDefaultTransparentBlend() {\n    this.blend = true;\n    this.depthMask = false;\n\n    if (this.premultiplyAlpha) {\n      this.blendSrc = ONE;\n      this.blendDst = ONE_MINUS_SRC_ALPHA;\n      this.blendSrcAlpha = ONE;\n      this.blendDstAlpha = ONE_MINUS_SRC_ALPHA;\n    } else {\n      this.blendSrc = SRC_ALPHA;\n      this.blendDst = ONE_MINUS_SRC_ALPHA;\n      this.blendSrcAlpha = SRC_ALPHA;\n      this.blendDstAlpha = ONE_MINUS_SRC_ALPHA;\n    }\n  },\n\n  /**\n   * 透明度剪裁，如果渲染的颜色透明度大于等于这个值的话渲染为完全不透明，否则渲染为完全透明\n   * @default 0\n   * @type {number}\n   */\n  alphaCutoff: 0,\n\n  /**\n   * 是否使用HDR\n   * @default false\n   * @type {Boolean}\n   */\n  useHDR: false,\n\n  /**\n   * 曝光度，仅在 useHDR 为 true 时生效\n   * @default 1\n   * @type {Number}\n   */\n  exposure: 1,\n\n  /**\n   * 是否需要加基础 uniforms\n   * @type {Boolean}\n   * @default true\n   */\n  needBasicUnifroms: true,\n\n  /**\n   * 是否需要加基础 attributes\n   * @type {Boolean}\n   * @default true\n   */\n  needBasicAttributes: true,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    /**\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * 可以通过指定，semantic来指定值的获取方式，或者自定义get方法\n     * @default {}\n     * @type {object}\n     */\n\n    this.uniforms = {};\n    /**\n     * 可以通过指定，semantic来指定值的获取方式，或者自定义get方法\n     * @default {}\n     * @type {object}\n     */\n\n    this.attributes = {};\n    Object.assign(this, params);\n\n    if (this.needBasicAttributes) {\n      this.addBasicAttributes();\n    }\n\n    if (this.needBasicUnifroms) {\n      this.addBasicUniforms();\n    }\n  },\n\n  /**\n   * 增加基础 attributes\n   */\n  addBasicAttributes: function addBasicAttributes() {\n    var attributes = this.attributes;\n\n    this._copyProps(attributes, {\n      a_position: 'POSITION',\n      a_normal: 'NORMAL',\n      a_tangent: 'TANGENT',\n      a_texcoord0: 'TEXCOORD_0',\n      a_texcoord1: 'TEXCOORD_1',\n      a_color: 'COLOR_0',\n      a_skinIndices: 'SKININDICES',\n      a_skinWeights: 'SKINWEIGHTS'\n    });\n\n    ['POSITION', 'NORMAL', 'TANGENT'].forEach(function (name) {\n      var camelName = name.slice(0, 1) + name.slice(1).toLowerCase();\n\n      for (var i = 0; i < 8; i++) {\n        var morphAttributeName = 'a_morph' + camelName + i;\n\n        if (attributes[morphAttributeName] === undefined) {\n          attributes[morphAttributeName] = 'MORPH' + name + i;\n        }\n      }\n    });\n  },\n\n  /**\n   * 增加基础 uniforms\n   */\n  addBasicUniforms: function addBasicUniforms() {\n    this._copyProps(this.uniforms, {\n      u_modelMatrix: 'MODEL',\n      u_viewMatrix: 'VIEW',\n      u_projectionMatrix: 'PROJECTION',\n      u_modelViewMatrix: 'MODELVIEW',\n      u_modelViewProjectionMatrix: 'MODELVIEWPROJECTION',\n      u_viewInverseNormalMatrix: 'VIEWINVERSEINVERSETRANSPOSE',\n      u_normalMatrix: 'MODELVIEWINVERSETRANSPOSE',\n      u_normalWorldMatrix: 'MODELINVERSETRANSPOSE',\n      u_cameraPosition: 'CAMERAPOSITION',\n      u_rendererSize: 'RENDERERSIZE',\n      u_logDepth: 'LOGDEPTH',\n      // light\n      u_ambientLightsColor: 'AMBIENTLIGHTSCOLOR',\n      u_directionalLightsColor: 'DIRECTIONALLIGHTSCOLOR',\n      u_directionalLightsInfo: 'DIRECTIONALLIGHTSINFO',\n      u_directionalLightsShadowMap: 'DIRECTIONALLIGHTSSHADOWMAP',\n      u_directionalLightsShadowMapSize: 'DIRECTIONALLIGHTSSHADOWMAPSIZE',\n      u_directionalLightsShadowBias: 'DIRECTIONALLIGHTSSHADOWBIAS',\n      u_directionalLightSpaceMatrix: 'DIRECTIONALLIGHTSPACEMATRIX',\n      u_pointLightsPos: 'POINTLIGHTSPOS',\n      u_pointLightsColor: 'POINTLIGHTSCOLOR',\n      u_pointLightsInfo: 'POINTLIGHTSINFO',\n      u_pointLightsRange: 'POINTLIGHTSRANGE',\n      u_pointLightsShadowBias: 'POINTLIGHTSSHADOWBIAS',\n      u_pointLightsShadowMap: 'POINTLIGHTSSHADOWMAP',\n      u_pointLightSpaceMatrix: 'POINTLIGHTSPACEMATRIX',\n      u_pointLightCamera: 'POINTLIGHTCAMERA',\n      u_spotLightsPos: 'SPOTLIGHTSPOS',\n      u_spotLightsDir: 'SPOTLIGHTSDIR',\n      u_spotLightsColor: 'SPOTLIGHTSCOLOR',\n      u_spotLightsCutoffs: 'SPOTLIGHTSCUTOFFS',\n      u_spotLightsInfo: 'SPOTLIGHTSINFO',\n      u_spotLightsRange: 'SPOTLIGHTSRANGE',\n      u_spotLightsShadowMap: 'SPOTLIGHTSSHADOWMAP',\n      u_spotLightsShadowMapSize: 'SPOTLIGHTSSHADOWMAPSIZE',\n      u_spotLightsShadowBias: 'SPOTLIGHTSSHADOWBIAS',\n      u_spotLightSpaceMatrix: 'SPOTLIGHTSPACEMATRIX',\n      u_areaLightsPos: 'AREALIGHTSPOS',\n      u_areaLightsColor: 'AREALIGHTSCOLOR',\n      u_areaLightsWidth: 'AREALIGHTSWIDTH',\n      u_areaLightsHeight: 'AREALIGHTSHEIGHT',\n      u_areaLightsLtcTexture1: 'AREALIGHTSLTCTEXTURE1',\n      u_areaLightsLtcTexture2: 'AREALIGHTSLTCTEXTURE2',\n      // joint\n      u_jointMat: 'JOINTMATRIX',\n      u_jointMatTexture: 'JOINTMATRIXTEXTURE',\n      u_jointMatTextureSize: 'JOINTMATRIXTEXTURESIZE',\n      // quantization\n      u_positionDecodeMat: 'POSITIONDECODEMAT',\n      u_normalDecodeMat: 'NORMALDECODEMAT',\n      u_uvDecodeMat: 'UVDECODEMAT',\n      u_uv1DecodeMat: 'UV1DECODEMAT',\n      // morph\n      u_morphWeights: 'MORPHWEIGHTS',\n      u_normalMapScale: 'NORMALMAPSCALE',\n      u_emission: 'EMISSION',\n      u_transparency: 'TRANSPARENCY',\n      // uv matrix\n      u_uvMatrix: 'UVMATRIX_0',\n      u_uvMatrix1: 'UVMATRIX_1',\n      // other info\n      u_fogColor: 'FOGCOLOR',\n      u_fogInfo: 'FOGINFO',\n      u_alphaCutoff: 'ALPHACUTOFF',\n      u_exposure: 'EXPOSURE',\n      u_gammaFactor: 'GAMMAFACTOR'\n    });\n\n    this.addTextureUniforms({\n      u_normalMap: 'NORMALMAP',\n      u_parallaxMap: 'PARALLAXMAP',\n      u_emission: 'EMISSION',\n      u_transparency: 'TRANSPARENCY'\n    });\n  },\n\n  /**\n   * 增加贴图 uniforms\n   * @param {Object} textureUniforms textureName:semanticName 键值对\n   */\n  addTextureUniforms: function addTextureUniforms(textureUniforms) {\n    var uniforms = {};\n\n    for (var uniformName in textureUniforms) {\n      var semanticName = textureUniforms[uniformName];\n      uniforms[uniformName] = semanticName;\n      uniforms[\"\".concat(uniformName, \".texture\")] = semanticName;\n      uniforms[\"\".concat(uniformName, \".uv\")] = \"\".concat(semanticName, \"UV\");\n    }\n\n    this._copyProps(this.uniforms, uniforms);\n  },\n\n  /**\n   * 获取渲染选项值\n   * @param  {Object} [option={}] 渲染选项值\n   * @return {Object} 渲染选项值\n   */\n  getRenderOption: function getRenderOption() {\n    var _this = this;\n\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    var lightType = this.lightType;\n    option[\"LIGHT_TYPE_\".concat(lightType)] = 1;\n    option.SIDE = this.side;\n\n    if (lightType !== 'NONE') {\n      option.HAS_LIGHT = 1;\n    }\n\n    if (this.premultiplyAlpha) {\n      option.PREMULTIPLY_ALPHA = 1;\n    }\n\n    var textureOption = this._textureOption.reset(option);\n\n    if (option.HAS_LIGHT) {\n      option.HAS_NORMAL = 1;\n      textureOption.add(this.normalMap, 'NORMAL_MAP', function () {\n        if (_this.normalMapScale !== 1) {\n          option.NORMAL_MAP_SCALE = 1;\n        }\n      });\n    }\n\n    textureOption.add(this.parallaxMap, 'PARALLAX_MAP');\n    textureOption.add(this.emission, 'EMISSION_MAP');\n    textureOption.add(this.transparency, 'TRANSPARENCY_MAP');\n\n    if (this.ignoreTranparent) {\n      option.IGNORE_TRANSPARENT = 1;\n    }\n\n    if (this.alphaCutoff > 0) {\n      option.ALPHA_CUTOFF = 1;\n    }\n\n    if (this.useHDR) {\n      option.USE_HDR = 1;\n    }\n\n    if (this.gammaCorrection) {\n      option.GAMMA_CORRECTION = 1;\n    }\n\n    if (this.receiveShadows) {\n      option.RECEIVE_SHADOWS = 1;\n    }\n\n    if (this.castShadows) {\n      option.CAST_SHADOWS = 1;\n    }\n\n    if (this.uvMatrix) {\n      option.UV_MATRIX = 1;\n    }\n\n    if (this.uvMatrix1) {\n      option.UV_MATRIX1 = 1;\n    }\n\n    if (this.usePhysicsLight) {\n      option.USE_PHYSICS_LIGHT = 1;\n    }\n\n    if (this.isDiffuesEnvAndAmbientLightWorkTogether) {\n      option.IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER = 1;\n    }\n\n    textureOption.update();\n    return option;\n  },\n  _textureOption: {\n    uvTypes: null,\n    option: null,\n    reset: function reset(option) {\n      this.option = option;\n      this.uvTypes = {};\n      return this;\n    },\n    add: function add(texture, optionName, callback) {\n      if (texture && texture.isTexture) {\n        var uvTypes = this.uvTypes,\n            option = this.option;\n        var uv = texture.uv || 0;\n        uvTypes[uv] = 1;\n        option[optionName] = uv;\n\n        if (texture.isCubeTexture) {\n          option[\"\".concat(optionName, \"_CUBE\")] = 1;\n        }\n\n        if (callback) {\n          callback(texture);\n        }\n      }\n\n      return this;\n    },\n    update: function update() {\n      var supportUV = [0, 1];\n      var uvTypes = this.uvTypes,\n          option = this.option;\n\n      for (var type in uvTypes) {\n        if (supportUV.indexOf(Number(type)) !== -1) {\n          option[\"HAS_TEXCOORD\".concat(type)] = 1;\n        } else {\n          utils_log.warnOnce(\"Material._textureOption.update(\".concat(type, \")\"), \"uv_\".concat(type, \" not support!\"));\n          option.HAS_TEXCOORD0 = 1;\n        }\n      }\n\n      return this;\n    }\n  },\n\n  /**\n   * 获取 instanced uniforms\n   * @private\n   * @return {Object}\n   */\n  getInstancedUniforms: function getInstancedUniforms() {\n    var instancedUniforms = this._instancedUniforms;\n\n    if (!this._instancedUniforms) {\n      var uniforms = this.uniforms;\n      instancedUniforms = this._instancedUniforms = [];\n\n      for (var name in uniforms) {\n        var info = this.getUniformInfo(name);\n\n        if (info.isDependMesh && !info.notSupportInstanced) {\n          instancedUniforms.push({\n            name: name,\n            info: info\n          });\n        }\n      }\n    }\n\n    return instancedUniforms;\n  },\n  getUniformData: function getUniformData(name, mesh, programInfo) {\n    return this.getUniformInfo(name).get(mesh, this, programInfo);\n  },\n  getAttributeData: function getAttributeData(name, mesh, programInfo) {\n    return this.getAttributeInfo(name).get(mesh, this, programInfo);\n  },\n  getUniformInfo: function getUniformInfo(name) {\n    return this.getInfo('uniforms', name);\n  },\n  getAttributeInfo: function getAttributeInfo(name) {\n    return this.getInfo('attributes', name);\n  },\n  getInfo: function getInfo(dataType, name) {\n    var dataDict = this[dataType];\n    var info = dataDict[name];\n\n    if (typeof info === 'string') {\n      info = material_semantic[info];\n    }\n\n    if (!info || !info.get) {\n      utils_log.warnOnce('material.getInfo-' + name, 'Material.getInfo: no this semantic:' + name);\n      info = Material_blankInfo;\n    }\n\n    return info;\n  },\n\n  /**\n   * clone 当前Material\n   * @return {Material} 返回clone的Material\n   */\n  clone: function clone() {\n    var newMaterial = new this.constructor();\n\n    for (var key in this) {\n      if (key !== 'id') {\n        newMaterial[key] = this[key];\n      }\n    }\n\n    return newMaterial;\n  },\n\n  /**\n   * 销毁贴图\n   * @return {Material} this\n   */\n  destroyTextures: function destroyTextures() {\n    this.getTextures().forEach(function (texture) {\n      texture.destroy();\n    });\n  },\n\n  /**\n   * 获取材质全部贴图\n   * @return {Texture[]}\n   */\n  getTextures: function getTextures() {\n    var textures = [];\n\n    for (var propName in this) {\n      var texture = this[propName];\n\n      if (texture && texture.isTexture) {\n        textures.push(texture);\n      }\n    }\n\n    return textures;\n  },\n\n  /**\n   * 复制属性，只有没属性时才会覆盖\n   * @private\n   * @param  {Object} origin\n   * @param  {Object} data\n   */\n  _copyProps: function _copyProps(origin, data) {\n    for (var key in data) {\n      if (origin[key] === undefined) {\n        origin[key] = data[key];\n      }\n    }\n  }\n});\n/* harmony default export */ var material_Material = (Material);\n// CONCATENATED MODULE: ./src/material/BasicMaterial.js\n\n\n\n/**\n * 基础材质，支持 NONE, PHONG, BLINN-PHONG, LAMBERT光照模型\n * @class\n * @extends Material\n * @example\n * const material = new Hilo3d.BasicMaterial({\n *     diffuse: new Hilo3d.Color(1, 0, 0, 1)\n * });\n */\n\nvar BasicMaterial = core_Class.create(\n/** @lends BasicMaterial.prototype */\n{\n  Extends: material_Material,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isBasicMaterial: true,\n\n  /**\n   * @default BasicMaterial\n   * @type {string}\n   */\n  className: 'BasicMaterial',\n\n  /**\n   * 光照类型，支持: NONE, PHONG, BLINN-PHONG, LAMBERT\n   * @default BLINN-PHONG\n   * @type {string}\n   */\n  lightType: 'BLINN-PHONG',\n\n  /**\n   * 漫反射贴图，或颜色\n   * @default Color(.5, .5, .5)\n   * @type {Texture|Color}\n   */\n  diffuse: null,\n\n  /**\n   * 环境光贴图，或颜色\n   * @default null\n   * @type {Texture|Color}\n   */\n  ambient: null,\n\n  /**\n   * 镜面贴图，或颜色\n   * @default Color(1, 1, 1)\n   * @type {Texture|Color}\n   */\n  specular: null,\n\n  /**\n   * 放射光贴图，或颜色\n   * @default Color(0, 0, 0)\n   * @type {Texture|Color}\n   */\n  emission: null,\n\n  /**\n   * 环境贴图\n   * @default null\n   * @type {CubeTexture|Texture}\n   */\n  specularEnvMap: null,\n\n  /**\n   * 环境贴图变化矩阵，如旋转等\n   * @default null\n   * @type {Matrix4}\n   */\n  specularEnvMatrix: null,\n\n  /**\n   * 反射率\n   * @default 0\n   * @type {number}\n   */\n  reflectivity: 0,\n\n  /**\n   * 折射比率\n   * @default 0\n   * @type {number}\n   */\n  refractRatio: 0,\n\n  /**\n   * 折射率\n   * @default 0\n   * @type {number}\n   */\n  refractivity: 0,\n\n  /**\n   * 高光发光值\n   * @default 32\n   * @type {number}\n   */\n  shininess: 32,\n  usedUniformVectors: 11,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {string} [params.lightType=BLINN-PHONG] 光照类型，支持: NONE, PHONG, BLINN-PHONG, LAMBERT\n   * @param {Texture|Color} [params.diffuse=new Color(.5, .5, .5)] 漫反射贴图，或颜色\n   * @param {Texture|Color} [params.ambient] 环境光贴图，或颜色\n   * @param {Texture|Color} [params.specular=new Color(1, 1, 1)] 镜面贴图，或颜色\n   * @param {Texture|Color} [params.emission=new Color(0, 0, 0)] 放射光贴图，或颜色\n   * @param {Texture} [params.specularEnvMap] 环境贴图\n   * @param {Matrix4} [params.specularEnvMatrix] 环境贴图变化矩阵，如旋转等\n   * @param {number} [params.reflectivity=0] 反射率\n   * @param {number} [params.refractRatio=0] 折射比率\n   * @param {number} [params.refractivity=0] 折射率\n   * @param {number} [params.shininess=32] 高光发光值\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    this.diffuse = new math_Color(.5, .5, .5);\n    this.specular = new math_Color(1, 1, 1);\n    this.emission = new math_Color(0, 0, 0);\n    BasicMaterial.superclass.constructor.call(this, params);\n    Object.assign(this.uniforms, {\n      u_diffuse: 'DIFFUSE',\n      u_specular: 'SPECULAR',\n      u_ambient: 'AMBIENT',\n      u_shininess: 'SHININESS',\n      u_reflectivity: 'REFLECTIVITY',\n      u_refractRatio: 'REFRACTRATIO',\n      u_refractivity: 'REFRACTIVITY',\n      u_specularEnvMap: 'SPECULARENVMAP',\n      u_specularEnvMatrix: 'SPECULARENVMATRIX'\n    });\n    this.addTextureUniforms({\n      u_diffuse: 'DIFFUSE',\n      u_specular: 'SPECULAR',\n      u_ambient: 'AMBIENT'\n    });\n  },\n  getRenderOption: function getRenderOption() {\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    BasicMaterial.superclass.getRenderOption.call(this, option);\n\n    var textureOption = this._textureOption.reset(option);\n\n    var lightType = this.lightType;\n\n    if (lightType === 'PHONG' || lightType === 'BLINN-PHONG') {\n      option.HAS_SPECULAR = 1;\n    }\n\n    var diffuse = this.diffuse;\n\n    if (diffuse && diffuse.isTexture) {\n      if (diffuse.isCubeTexture) {\n        option.DIFFUSE_CUBE_MAP = 1;\n      } else {\n        textureOption.add(this.diffuse, 'DIFFUSE_MAP');\n      }\n    }\n\n    if (option.HAS_LIGHT) {\n      textureOption.add(this.specular, 'SPECULAR_MAP');\n      textureOption.add(this.ambient, 'AMBIENT_MAP');\n      textureOption.add(this.specularEnvMap, 'SPECULAR_ENV_MAP');\n    }\n\n    textureOption.update();\n    return option;\n  }\n});\n/* harmony default export */ var material_BasicMaterial = (BasicMaterial);\n// CONCATENATED MODULE: ./src/material/GeometryMaterial.js\n\n\n\nvar GeometryMaterial_POSITION = src_constants.POSITION,\n    GeometryMaterial_NORMAL = src_constants.NORMAL,\n    GeometryMaterial_DEPTH = src_constants.DEPTH,\n    GeometryMaterial_DISTANCE = src_constants.DISTANCE,\n    NONE = src_constants.NONE;\n/**\n * 几何材质，支持 POSITION, NORMAL, DEPTH, DISTANCE 顶点类型\n * @class\n * @extends BasicMaterial\n * @example\n * const material = new Hilo3d.GeometryMaterial({\n *     diffuse: new Hilo3d.Color(1, 0, 0, 1)\n * });\n */\n\nvar GeometryMaterial = core_Class.create(\n/** @lends GeometryMaterial.prototype */\n{\n  Extends: material_BasicMaterial,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isGeometryMaterial: true,\n\n  /**\n   * @default GeometryMaterial\n   * @type {string}\n   */\n  className: 'GeometryMaterial',\n\n  /**\n   * 顶点类型 POSITION, NORMAL, DEPTH, DISTANCE\n   * @type {String}\n   */\n  vertexType: GeometryMaterial_POSITION,\n  lightType: NONE,\n\n  /**\n   * 是否直接存储\n   * @type {Boolean}\n   */\n  writeOriginData: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    GeometryMaterial.superclass.constructor.call(this, params);\n    Object.assign(this.uniforms, {\n      u_cameraFar: 'CAMERAFAR',\n      u_cameraNear: 'CAMERANEAR',\n      u_cameraType: 'CAMERATYPE'\n    });\n  },\n  getRenderOption: function getRenderOption() {\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    GeometryMaterial.superclass.getRenderOption.call(this, option);\n    option[\"VERTEX_TYPE_\".concat(this.vertexType)] = 1;\n\n    switch (this.vertexType) {\n      case GeometryMaterial_POSITION:\n        option.HAS_FRAG_POS = 1;\n        break;\n\n      case GeometryMaterial_NORMAL:\n        option.HAS_NORMAL = 1;\n        break;\n\n      case GeometryMaterial_DEPTH:\n        break;\n\n      case GeometryMaterial_DISTANCE:\n        option.HAS_FRAG_POS = 1;\n        break;\n    }\n\n    if (this.writeOriginData) {\n      option.WRITE_ORIGIN_DATA = 1;\n    }\n\n    return option;\n  }\n});\n/* harmony default export */ var material_GeometryMaterial = (GeometryMaterial);\n// CONCATENATED MODULE: ./src/camera/OrthographicCamera.js\n\n\n\n/**\n * 正交投影摄像机\n * @class\n * @extends Camera\n */\n\nvar OrthographicCamera = core_Class.create(\n/** @lends OrthographicCamera.prototype */\n{\n  Extends: camera_Camera,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isOrthographicCamera: true,\n\n  /**\n   * @default OrthographicCamera\n   * @type {string}\n   */\n  className: 'OrthographicCamera',\n  _left: -1,\n\n  /**\n   * @default -1\n   * @type {number}\n   */\n  left: {\n    get: function get() {\n      return this._left;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._left = value;\n    }\n  },\n  _right: 1,\n\n  /**\n   * @default 1\n   * @type {number}\n   */\n  right: {\n    get: function get() {\n      return this._right;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._right = value;\n    }\n  },\n  _bottom: -1,\n\n  /**\n   * @default -1\n   * @type {number}\n   */\n  bottom: {\n    get: function get() {\n      return this._bottom;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._bottom = value;\n    }\n  },\n  _top: 1,\n\n  /**\n   * @default 1\n   * @type {number}\n   */\n  top: {\n    get: function get() {\n      return this._top;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._top = value;\n    }\n  },\n  _near: 0.1,\n\n  /**\n   * @default 0.1\n   * @type {number}\n   */\n  near: {\n    get: function get() {\n      return this._near;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._near = value;\n    }\n  },\n  _far: 1,\n\n  /**\n   * @default 1\n   * @type {number}\n   */\n  far: {\n    get: function get() {\n      return this._far;\n    },\n    set: function set(value) {\n      this._needUpdateProjectionMatrix = true;\n      this._isGeometryDirty = true;\n      this._far = value;\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {number} [params.left=1]\n   * @param {number} [params.right=1]\n   * @param {number} [params.top=1]\n   * @param {number} [params.bottom=1]\n   * @param {number} [params.near=0.1]\n   * @param {number} [params.far=1]\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    OrthographicCamera.superclass.constructor.call(this, params);\n    this.updateProjectionMatrix();\n  },\n\n  /**\n   * 更新投影矩阵\n   */\n  updateProjectionMatrix: function updateProjectionMatrix() {\n    this.projectionMatrix.ortho(this.left, this.right, this.bottom, this.top, this.near, this.far);\n  },\n  getGeometry: function getGeometry(forceUpdate) {\n    if (forceUpdate || !this._geometry || this._isGeometryDirty) {\n      this._isGeometryDirty = false;\n      var geometry = new geometry_Geometry();\n      var p1 = [this.left, this.bottom, -this.near];\n      var p2 = [this.right, this.bottom, -this.near];\n      var p3 = [this.right, this.top, -this.near];\n      var p4 = [this.left, this.top, -this.near];\n      var p5 = [this.left, this.bottom, -this.far];\n      var p6 = [this.right, this.bottom, -this.far];\n      var p7 = [this.right, this.top, -this.far];\n      var p8 = [this.left, this.top, -this.far];\n      geometry.addRect(p5, p6, p7, p8); // front\n\n      geometry.addRect(p6, p2, p3, p7); // right\n\n      geometry.addRect(p2, p1, p4, p3); // back\n\n      geometry.addRect(p1, p5, p8, p4); // left\n\n      geometry.addRect(p8, p7, p3, p4); // top\n\n      geometry.addRect(p1, p2, p6, p5); // bottom\n\n      this._geometry = geometry;\n    }\n\n    return this._geometry;\n  }\n});\n/* harmony default export */ var camera_OrthographicCamera = (OrthographicCamera);\n// CONCATENATED MODULE: ./src/light/LightShadow.js\n\n\n\n\n\n\n\n\n\n\nvar LightShadow_DEPTH = src_constants.DEPTH,\n    LightShadow_BACK = src_constants.BACK;\nvar shadowMaterial = null;\nvar LightShadow_clearColor = new math_Color(1, 1, 1);\nvar LightShadow_tempMatrix4 = new math_Matrix4();\n\nvar isNeedRenderMesh = function isNeedRenderMesh(mesh) {\n  return mesh.material.castShadows;\n};\n/**\n * @class\n * @private\n */\n\n\nvar LightShadow = core_Class.create(\n/** @lends LightShadow.prototype */\n{\n  isLightShadow: true,\n  className: 'LightShadow',\n  light: null,\n  renderer: null,\n  framebuffer: null,\n  camera: null,\n  width: 1024,\n  height: 1024,\n  maxBias: 0.05,\n  minBias: 0.005,\n  cameraInfo: null,\n  debug: false,\n  constructor: function constructor(params) {\n    this.id = math_math.generateUUID(this.className);\n    Object.assign(this, params);\n  },\n  createFramebuffer: function createFramebuffer() {\n    if (this.framebuffer) {\n      return;\n    }\n\n    this.framebuffer = new renderer_Framebuffer(this.renderer, {\n      width: this.width,\n      height: this.height\n    });\n\n    if (this.debug) {\n      this.showShadowMap();\n    }\n  },\n  updateLightCamera: function updateLightCamera(currentCamera) {\n    if (this.light.isDirectionalLight) {\n      this.updateDirectionalLightCamera(currentCamera);\n    } else if (this.light.isSpotLight) {\n      this.updateSpotLightCamera(currentCamera);\n    }\n  },\n  updateDirectionalLightCamera: function updateDirectionalLightCamera(currentCamera) {\n    var light = this.light;\n    this.camera.lookAt(light.direction);\n\n    if (this.cameraInfo) {\n      this.updateCustumCamera(this.cameraInfo);\n    } else {\n      var geometry = currentCamera.getGeometry();\n\n      if (geometry) {\n        this.camera.updateViewMatrix();\n        LightShadow_tempMatrix4.multiply(this.camera.viewMatrix, currentCamera.worldMatrix);\n        var bounds = geometry.getBounds(LightShadow_tempMatrix4);\n        this.camera.near = -bounds.zMax;\n        this.camera.far = -bounds.zMin;\n        this.camera.left = bounds.xMin;\n        this.camera.right = bounds.xMax;\n        this.camera.bottom = bounds.yMin;\n        this.camera.top = bounds.yMax;\n      }\n    }\n\n    this.camera.updateViewMatrix();\n  },\n  updateCustumCamera: function updateCustumCamera(cameraInfo) {\n    for (var name in cameraInfo) {\n      this.camera[name] = cameraInfo[name];\n    }\n  },\n  updateSpotLightCamera: function updateSpotLightCamera(currentCamera) {\n    var light = this.light;\n    this.camera.lookAt(light.direction);\n\n    if (this.cameraInfo) {\n      this.updateCustumCamera(this.cameraInfo);\n    } else {\n      this.camera.fov = light.outerCutoff * 2;\n      this.camera.near = 0.01;\n      this.camera.far = currentCamera.far;\n      this.camera.aspect = 1;\n    }\n\n    this.camera.updateViewMatrix();\n  },\n  createCamera: function createCamera(currentCamera) {\n    if (!this.camera) {\n      if (this.light.isDirectionalLight) {\n        this.camera = new camera_OrthographicCamera();\n      } else if (this.light.isSpotLight) {\n        this.camera = new camera_PerspectiveCamera();\n      }\n\n      this.camera.addTo(this.light);\n    }\n\n    if (this._cameraMatrixVersion !== currentCamera.matrixVersion) {\n      this.updateLightCamera(currentCamera);\n      this._cameraMatrixVersion = currentCamera.matrixVersion;\n    }\n  },\n  createShadowMap: function createShadowMap(currentCamera) {\n    this.createFramebuffer();\n    this.createCamera(currentCamera);\n    var renderer = this.renderer,\n        framebuffer = this.framebuffer,\n        camera = this.camera;\n\n    if (!shadowMaterial) {\n      shadowMaterial = new material_GeometryMaterial({\n        vertexType: LightShadow_DEPTH,\n        side: LightShadow_BACK,\n        writeOriginData: true\n      });\n    }\n\n    framebuffer.bind();\n    renderer.state.viewport(0, 0, this.width, this.height);\n    renderer.clear(LightShadow_clearColor);\n    camera.updateViewProjectionMatrix();\n    material_semantic.setCamera(camera);\n    renderer.forceMaterial = shadowMaterial;\n    this.renderShadowScene(renderer);\n    delete renderer.forceMaterial;\n    framebuffer.unbind();\n    material_semantic.setCamera(currentCamera);\n    renderer.viewport();\n  },\n  renderShadowScene: function renderShadowScene(renderer) {\n    var renderList = renderer.renderList;\n    renderList.traverse(function (mesh) {\n      if (isNeedRenderMesh(mesh)) {\n        renderer.renderMesh(mesh);\n      }\n    }, function (instancedMeshes) {\n      renderer.renderInstancedMeshes(instancedMeshes.filter(function (mesh) {\n        return isNeedRenderMesh(mesh);\n      }));\n    });\n  },\n  showShadowMap: function showShadowMap() {\n    var _this = this;\n\n    this.renderer.on('afterRender', function () {\n      _this.framebuffer.render(0, 0.7, 0.3, 0.3);\n    });\n  }\n});\n/* harmony default export */ var light_LightShadow = (LightShadow);\n// CONCATENATED MODULE: ./src/light/CubeLightShadow.js\n\n\n\n\n\n\n\n\n\n\n\n\nvar CubeLightShadow_DISTANCE = src_constants.DISTANCE,\n    CubeLightShadow_BACK = src_constants.BACK,\n    CubeLightShadow_TEXTURE_CUBE_MAP = src_constants.TEXTURE_CUBE_MAP,\n    TEXTURE0 = src_constants.TEXTURE0,\n    CubeLightShadow_TEXTURE_CUBE_MAP_POSITIVE_X = src_constants.TEXTURE_CUBE_MAP_POSITIVE_X,\n    CubeLightShadow_NEAREST = src_constants.NEAREST,\n    FRAMEBUFFER = src_constants.FRAMEBUFFER,\n    FRAMEBUFFER_COMPLETE = src_constants.FRAMEBUFFER_COMPLETE;\nvar CubeLightShadow_shadowMaterial = null;\nvar CubeLightShadow_clearColor = new math_Color(0, 0, 0, 0);\nvar CubeLightShadow_tempVector3 = new math_Vector3();\nvar LookAtMap = [[1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1], [0, -1, 0, 0, -1, 0, 0, 0, 1, 0, 0, -1, 0, -1, 0, 0, -1, 0]];\n\nvar CubeLightShadow_isNeedRenderMesh = function isNeedRenderMesh(mesh, camera) {\n  if (mesh.material.castShadows) {\n    if (!mesh.frustumTest) {\n      return true;\n    }\n\n    if (camera.isMeshVisible(mesh)) {\n      return true;\n    }\n  }\n\n  return false;\n};\n/**\n * @class\n * @private\n */\n\n\nvar CubeLightShadow = core_Class.create(\n/** @lends CubeLightShadow.prototype */\n{\n  isLightShadow: true,\n  className: 'CubeLightShadow',\n  Extends: light_LightShadow,\n  light: null,\n  renderer: null,\n  framebuffer: null,\n  camera: null,\n  width: 1024,\n  height: 1024,\n  maxBias: 0.05,\n  minBias: 0.005,\n  debug: false,\n  constructor: function constructor(params) {\n    CubeLightShadow.superclass.constructor.call(this, params);\n  },\n  createFramebuffer: function createFramebuffer() {\n    if (this.framebuffer) {\n      return;\n    }\n\n    var size = 1024;\n    this.framebuffer = new renderer_Framebuffer(this.renderer, {\n      target: CubeLightShadow_TEXTURE_CUBE_MAP,\n      width: size,\n      height: size,\n      createTexture: function createTexture() {\n        var state = this.state;\n        var gl = state.gl;\n        var texture = new texture_CubeTexture({\n          image: [null, null, null, null, null, null],\n          type: this.type,\n          format: this.format,\n          internalFormat: this.internalFormat,\n          magFilter: CubeLightShadow_NEAREST,\n          minFilter: CubeLightShadow_NEAREST,\n          width: size,\n          height: size\n        });\n\n        if (gl.checkFramebufferStatus(FRAMEBUFFER) !== FRAMEBUFFER_COMPLETE) {\n          utils_log.warn('Framebuffer is not complete', gl.checkFramebufferStatus(FRAMEBUFFER));\n        }\n\n        return texture;\n      },\n      bindTexture: function bindTexture(index) {\n        index = index || 0;\n        var state = this.state;\n        var gl = state.gl;\n        var glTexture = this.texture.getGLTexture(state);\n        state.activeTexture(TEXTURE0 + renderer_capabilities.MAX_TEXTURE_INDEX);\n        state.bindTexture(this.target, glTexture);\n        gl.framebufferTexture2D(FRAMEBUFFER, this.attachment, CubeLightShadow_TEXTURE_CUBE_MAP_POSITIVE_X + index, glTexture, 0);\n      }\n    });\n  },\n  updateLightCamera: function updateLightCamera(currentCamera) {\n    this.camera.fov = 90;\n    this.camera.near = currentCamera.near;\n    this.camera.far = currentCamera.far;\n    this.camera.aspect = 1;\n    this.camera.updateViewMatrix();\n  },\n  createCamera: function createCamera(currentCamera) {\n    if (this.camera) {\n      return;\n    }\n\n    this.camera = new camera_PerspectiveCamera();\n    this.updateLightCamera(currentCamera);\n  },\n  createShadowMap: function createShadowMap(currentCamera) {\n    this.createFramebuffer();\n    this.createCamera(currentCamera);\n    var renderer = this.renderer,\n        framebuffer = this.framebuffer,\n        camera = this.camera;\n\n    if (!CubeLightShadow_shadowMaterial) {\n      CubeLightShadow_shadowMaterial = new material_GeometryMaterial({\n        vertexType: CubeLightShadow_DISTANCE,\n        side: CubeLightShadow_BACK,\n        writeOriginData: false\n      });\n    }\n\n    framebuffer.bind();\n    renderer.state.viewport(0, 0, framebuffer.width, framebuffer.height);\n    this.light.worldMatrix.getTranslation(camera.position);\n\n    for (var i = 0; i < 6; i++) {\n      framebuffer.bindTexture(i);\n      CubeLightShadow_tempVector3.fromArray(LookAtMap[0], i * 3).add(camera.position);\n      camera.up.fromArray(LookAtMap[1], i * 3);\n      camera.lookAt(CubeLightShadow_tempVector3);\n      camera.updateViewProjectionMatrix();\n      renderer.clear(CubeLightShadow_clearColor);\n      material_semantic.setCamera(camera);\n      renderer.forceMaterial = CubeLightShadow_shadowMaterial;\n      this.renderShadowScene(renderer);\n    }\n\n    camera.matrix.identity();\n    camera.updateViewProjectionMatrix();\n    delete renderer.forceMaterial;\n    framebuffer.unbind();\n    material_semantic.setCamera(currentCamera);\n    renderer.viewport();\n  },\n  renderShadowScene: function renderShadowScene(renderer) {\n    var renderList = renderer.renderList;\n    var camera = this.camera;\n    renderList.traverse(function (mesh) {\n      if (CubeLightShadow_isNeedRenderMesh(mesh, camera)) {\n        renderer.renderMesh(mesh);\n      }\n    }, function (instancedMeshes) {\n      var needRenderMeshes = instancedMeshes.filter(function (mesh) {\n        return CubeLightShadow_isNeedRenderMesh(mesh, camera);\n      });\n      renderer.renderInstancedMeshes(needRenderMeshes);\n    });\n  }\n});\n/* harmony default export */ var light_CubeLightShadow = (CubeLightShadow);\n// CONCATENATED MODULE: ./src/light/PointLight.js\n\n\n\n/**\n * 点光源\n * @class\n * @extends Light\n */\n\nvar PointLight = core_Class.create(\n/** @lends PointLight.prototype */\n{\n  Extends: light_Light,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isPointLight: true,\n\n  /**\n   * @default PointLight\n   * @type {string}\n   */\n  className: 'PointLight',\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {Color} [params.color=new Color(1, 1, 1)] 光颜色\n   * @param {number} [params.amount=1] 光强度\n   * @param {number} [params.range=0] 光照范围, 0 时代表光照范围无限大。\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    PointLight.superclass.constructor.call(this, params);\n  },\n  createShadowMap: function createShadowMap(renderer, camera) {\n    if (!this.shadow) {\n      return;\n    }\n\n    if (!this.lightShadow) {\n      this.lightShadow = new light_CubeLightShadow({\n        light: this,\n        renderer: renderer\n      });\n\n      if ('minBias' in this.shadow) {\n        this.lightShadow.minBias = this.shadow.minBias;\n      }\n\n      if ('maxBias' in this.shadow) {\n        this.lightShadow.maxBias = this.shadow.maxBias;\n      }\n    }\n\n    this.lightShadow.createShadowMap(camera);\n  }\n});\n/* harmony default export */ var light_PointLight = (PointLight);\n// CONCATENATED MODULE: ./src/light/DirectionalLight.js\n\n\n\n\n\nvar DirectionalLight_tempMatrix4 = new math_Matrix4();\nvar DirectionalLight_tempVector3 = new math_Vector3();\n/**\n * 平行光\n * @class\n * @extends Light\n */\n\nvar DirectionalLight = core_Class.create(\n/** @lends DirectionalLight.prototype */\n{\n  Extends: light_Light,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isDirectionalLight: true,\n\n  /**\n   * @default DirectionalLight\n   * @type {string}\n   */\n  className: 'DirectionalLight',\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {Color} [params.color=new Color(1, 1, 1)] 光颜色\n   * @param {number} [params.amount=1] 光强度\n   * @param {Vector3} [params.direction=new Vector3(0, 0, 1)] 光方向\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    /**\n     * 光方向\n     * @type {Vector3}\n     * @default new Vector3(0, 0, 1)\n     */\n    this.direction = new math_Vector3(0, 0, 1);\n    DirectionalLight.superclass.constructor.call(this, params);\n  },\n  createShadowMap: function createShadowMap(renderer, camera) {\n    if (!this.shadow) {\n      return;\n    }\n\n    if (!this.lightShadow) {\n      this.lightShadow = new light_LightShadow({\n        light: this,\n        renderer: renderer,\n        width: this.shadow.width || renderer.width,\n        height: this.shadow.height || renderer.height,\n        debug: this.shadow.debug,\n        cameraInfo: this.shadow.cameraInfo\n      });\n\n      if ('minBias' in this.shadow) {\n        this.lightShadow.minBias = this.shadow.minBias;\n      }\n\n      if ('maxBias' in this.shadow) {\n        this.lightShadow.maxBias = this.shadow.maxBias;\n      }\n    }\n\n    this.lightShadow.createShadowMap(camera);\n  },\n  getWorldDirection: function getWorldDirection() {\n    DirectionalLight_tempVector3.copy(this.direction).transformDirection(this.worldMatrix).normalize();\n    return DirectionalLight_tempVector3;\n  },\n  getViewDirection: function getViewDirection(camera) {\n    var modelViewMatrix = camera.getModelViewMatrix(this, DirectionalLight_tempMatrix4);\n    DirectionalLight_tempVector3.copy(this.direction).transformDirection(modelViewMatrix).normalize();\n    return DirectionalLight_tempVector3;\n  }\n});\n/* harmony default export */ var light_DirectionalLight = (DirectionalLight);\n// CONCATENATED MODULE: ./src/light/SpotLight.js\n\n\n\n\n\n\nvar SpotLight_tempMatrix4 = new math_Matrix4();\nvar SpotLight_tempVector3 = new math_Vector3();\n/**\n * 聚光灯\n * @class\n * @extends Light\n */\n\nvar SpotLight = core_Class.create(\n/** @lends SpotLight.prototype */\n{\n  Extends: light_Light,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isSpotLight: true,\n\n  /**\n   * @default SpotLight\n   * @type {string}\n   */\n  className: 'SpotLight',\n  _cutoffCos: 0.9763,\n  _cutoff: 12.5,\n\n  /**\n   * 切光角(角度)，落在这个角度之内的光亮度为1\n   * @default 12.5\n   * @type {number}\n   */\n  cutoff: {\n    get: function get() {\n      return this._cutoff;\n    },\n    set: function set(value) {\n      this._cutoff = value;\n      this._cutoffCos = Math.cos(math_math.degToRad(value));\n    }\n  },\n  _outerCutoffCos: 0.9537,\n  _outerCutoff: 17.5,\n\n  /**\n   * 外切光角(角度)，在切光角合外切光角之间的光亮度渐变到0\n   * @default 17.5\n   * @type {number}\n   */\n  outerCutoff: {\n    get: function get() {\n      return this._outerCutoff;\n    },\n    set: function set(value) {\n      this._outerCutoff = value;\n      this._outerCutoffCos = Math.cos(math_math.degToRad(value));\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {Color} [params.color=new Color(1, 1, 1)] 光颜色\n   * @param {number} [params.amount=1] 光强度\n   * @param {number} [params.range=0] 光照范围, 0 时代表光照范围无限大。\n   * @param {Vector3} [params.direction=new Vector3(0, 0, 1)] 光方向\n   * @param {number} [params.cutoff=12.5] 切光角(角度)，落在这个角度之内的光亮度为1\n   * @param {number} [params.outerCutoff=17.5] 外切光角(角度)，在切光角合外切光角之间的光亮度渐变到0\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    /**\n     * 光方向\n     * @type {Vector3}\n     * @default new Vector3(0, 0, 1)\n     */\n    this.direction = new math_Vector3(0, 0, 1);\n    SpotLight.superclass.constructor.call(this, params);\n  },\n  createShadowMap: function createShadowMap(renderer, camera) {\n    if (!this.shadow) {\n      return;\n    }\n\n    if (!this.lightShadow) {\n      this.lightShadow = new light_LightShadow({\n        light: this,\n        renderer: renderer,\n        width: this.shadow.width || renderer.width,\n        height: this.shadow.height || renderer.height,\n        debug: this.shadow.debug,\n        cameraInfo: this.shadow.cameraInfo\n      });\n\n      if ('minBias' in this.shadow) {\n        this.lightShadow.minBias = this.shadow.minBias;\n      }\n\n      if ('maxBias' in this.shadow) {\n        this.lightShadow.maxBias = this.shadow.maxBias;\n      }\n    }\n\n    this.lightShadow.createShadowMap(camera);\n  },\n  getWorldDirection: function getWorldDirection() {\n    SpotLight_tempVector3.copy(this.direction).transformDirection(this.worldMatrix).normalize();\n    return SpotLight_tempVector3;\n  },\n  getViewDirection: function getViewDirection(camera) {\n    var modelViewMatrix = camera.getModelViewMatrix(this, SpotLight_tempMatrix4);\n    SpotLight_tempVector3.copy(this.direction).transformDirection(modelViewMatrix).normalize();\n    return SpotLight_tempVector3;\n  }\n});\n/* harmony default export */ var light_SpotLight = (SpotLight);\n// CONCATENATED MODULE: ./src/material/ShaderMaterial.js\n\n\n/**\n * Shader材质\n * @class\n * @extends Material\n * @example\n * const material = new Hilo3d.ShaderMaterial({\n *     attributes:{\n *         a_pos: 'POSITION'\n *     },\n *     uniforms:{\n *         u_mat:'MODELVIEWPROJECTION',\n *         u_color_b:{\n *             get:function(mesh, material, programInfo){\n *                 return Math.random();\n *             }\n *         }\n *     },\n *     vs:`\n *         precision HILO_MAX_VERTEX_PRECISION float;\n *         attribute vec3 a_pos;\n *         uniform mat4 u_mat;\n *\n *         void main(void) {\n *             gl_Position = u_mat * vec4(a_pos, 1.0);\n *         }\n *     `,\n *     fs:`\n *         precision HILO_MAX_FRAGMENT_PRECISION float;\n *         uniform float u_color_b;\n *\n *         void main(void) {\n *             gl_FragColor = vec4(0.6, 0.8, u_color_b, 1);\n *         }\n *     `\n * });\n */\n\nvar ShaderMaterial = core_Class.create(\n/** @lends ShaderMaterial.prototype */\n{\n  Extends: material_Material,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isShaderMaterial: true,\n\n  /**\n   * @default ShaderMaterial\n   * @type {string}\n   */\n  className: 'ShaderMaterial',\n\n  /**\n   * vertex shader 代码\n   * @type {string}\n   */\n  vs: '',\n\n  /**\n   * fragment shader 代码\n   * @type {string}\n   */\n  fs: '',\n\n  /**\n   * 是否使用 header cache shader\n   * @default true\n   * @type {Boolean}\n   */\n  useHeaderCache: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    ShaderMaterial.superclass.constructor.call(this, params);\n  },\n  getRenderOption: function getRenderOption() {\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    ShaderMaterial.superclass.getRenderOption.call(this, option);\n\n    if (this.getCustomRenderOption) {\n      var custumOption = this.getCustomRenderOption({});\n\n      for (var name in custumOption) {\n        option[\"HILO_CUSTUM_OPTION_\".concat(name)] = custumOption[name];\n      }\n    }\n\n    return option;\n  },\n\n  /**\n   * 获取定制的渲染参数\n   * @default null\n   * @type {Function}\n   */\n  getCustomRenderOption: null\n});\n/* harmony default export */ var material_ShaderMaterial = (ShaderMaterial);\n// EXTERNAL MODULE: ./node_modules/_amc@1.0.6@amc/build/amd.js\nvar amd = __webpack_require__(\"./node_modules/_amc@1.0.6@amc/build/amd.js\");\nvar amd_default = /*#__PURE__*/__webpack_require__.n(amd);\n\n// CONCATENATED MODULE: ./src/geometry/MorphGeometry.js\n\n\n\n/**\n * Morph几何体\n * @class\n * @extends Geometry\n */\n\nvar MorphGeometry = core_Class.create(\n/** @lends MorphGeometry.prototype */\n{\n  Extends: geometry_Geometry,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isMorphGeometry: true,\n\n  /**\n   * @default MorphGeometry\n   * @type {string}\n   */\n  className: 'MorphGeometry',\n  isStatic: false,\n\n  /**\n   * morph animation weights\n   * @type {Array.<number>}\n   */\n  weights: [],\n\n  /**\n   * like:\n   * {\n   *     vertices: [[], []],\n   *     normals: [[], []],\n   *     tangents: [[], []]\n   * }\n   * @default null\n   * @type {Object}\n   */\n  targets: null,\n\n  /**\n   * @constructs\n   * @param {object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    MorphGeometry.superclass.constructor.call(this, params);\n    this.weights = this.weights || [];\n  },\n  update: function update(weights, originalWeightIndices) {\n    this.weights = weights;\n    this._originalMorphIndices = originalWeightIndices;\n  },\n  clone: function clone() {\n    return geometry_Geometry.prototype.clone.call(this, {\n      targets: this.targets,\n      weights: this.weights\n    });\n  },\n  getRenderOption: function getRenderOption() {\n    var _this = this;\n\n    var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    MorphGeometry.superclass.getRenderOption.call(this, opt);\n\n    if (this.targets) {\n      if (!this._maxMorphTargetCount) {\n        this._maxMorphTargetCount = Math.floor(8 / Object.keys(this.targets).length);\n      }\n\n      util_each(this.targets, function (list, name) {\n        opt.MORPH_TARGET_COUNT = Math.min(list.length, _this._maxMorphTargetCount);\n\n        if (name === 'vertices') {\n          opt.MORPH_HAS_POSITION = 1;\n        } else if (name === 'normals') {\n          opt.MORPH_HAS_NORMAL = 1;\n        } else if (name === 'tangents') {\n          opt.MORPH_HAS_TANGENT = 1;\n        }\n      });\n    }\n\n    return opt;\n  }\n});\n/* harmony default export */ var geometry_MorphGeometry = (MorphGeometry);\n// CONCATENATED MODULE: ./src/loader/AliAMCExtension.js\n\n\n\n\nvar glTFAttrToGeometry = {\n  POSITION: {\n    name: 'vertices',\n    decodeMatName: 'positionDecodeMat'\n  },\n  TEXCOORD_0: {\n    name: 'uvs',\n    decodeMatName: 'uvDecodeMat'\n  },\n  TEXCOORD_1: {\n    name: 'uvs1',\n    decodeMatName: 'uv1DecodeMat'\n  },\n  NORMAL: {\n    name: 'normals',\n    decodeMatName: 'normalDecodeMat'\n  },\n  JOINT: {\n    name: 'skinIndices'\n  },\n  JOINTS_0: {\n    name: 'skinIndices'\n  },\n  WEIGHT: {\n    name: 'skinWeights'\n  },\n  WEIGHTS_0: {\n    name: 'skinWeights'\n  },\n  TANGENT: {\n    name: 'tangents'\n  },\n  COLOR_0: {\n    name: 'colors'\n  }\n};\nvar mockHilo3d = {\n  Geometry: geometry_Geometry,\n  GeometryData: geometry_GeometryData\n};\n\nfunction fixMorphGeometry(info, amcGeometry, destGeometry) {\n  if (!destGeometry.isMorphGeometry) {\n    var morphGeometry = new geometry_MorphGeometry();\n\n    for (var name in destGeometry) {\n      if (Object.prototype.hasOwnProperty.call(destGeometry, name) && name !== 'id') {\n        morphGeometry[name] = destGeometry[name];\n      }\n    }\n\n    morphGeometry.targets = {};\n    destGeometry = morphGeometry;\n  }\n\n  var targets = destGeometry.targets;\n\n  for (var i = 0; i < info.targets.length; i++) {\n    var target = info.targets[i];\n\n    for (var _name in target) {\n      if (_name in glTFAttrToGeometry) {\n        var amcAttrIndex = target[_name];\n        var hilo3dName = glTFAttrToGeometry[_name].name;\n\n        if (!targets[hilo3dName]) {\n          targets[hilo3dName] = [];\n        }\n\n        var attr = amcGeometry.attrs[amcAttrIndex];\n        targets[hilo3dName].push(new geometry_GeometryData(attr.data, attr.itemCount));\n      }\n    }\n  }\n\n  if (info.weights) {\n    destGeometry.weights = info.weights;\n  } else {\n    destGeometry.weights = new Float32Array(info.targets.length);\n  }\n\n  return destGeometry;\n}\n\nvar AliAMCExtension = {\n  _decodeTotalTime: 0,\n  wasmURL: '',\n  workerURL: '',\n  useWASM: true,\n  useWebWorker: true,\n  useAuto: true,\n  init: function init() {\n    if (AliAMCExtension.useAuto) {\n      return amd_default.a.initWASM(AliAMCExtension.wasmURL, AliAMCExtension.memPages);\n    }\n\n    if (AliAMCExtension.useWebWorker) {\n      return amd_default.a.initWorker(AliAMCExtension.workerURL);\n    }\n\n    if (AliAMCExtension.useWASM) {\n      return amd_default.a.initWASM(AliAMCExtension.wasmURL, AliAMCExtension.memPages);\n    }\n\n    return Promise.resolve();\n  },\n  parse: function parse(info, parser, result, options) {\n    var st = Date.now();\n    var bufferView = parser.bufferViews[info.bufferView];\n    var wasmURL = AliAMCExtension.wasmURL,\n        workerURL = AliAMCExtension.workerURL,\n        useAuto = AliAMCExtension.useAuto,\n        useWASM = AliAMCExtension.useWASM,\n        useWebWorker = AliAMCExtension.useWebWorker;\n    var amcGeometry;\n    var data = new Uint8Array(bufferView.buffer, bufferView.byteOffset, bufferView.byteLength);\n\n    function done(amcGeometry) {\n      AliAMCExtension._decodeTotalTime += Date.now() - st;\n      var destGeometry = amcGeometry.toHilo3dGeometry(mockHilo3d, options.primitive._geometry);\n\n      if (info.targets) {\n        destGeometry = fixMorphGeometry(info, amcGeometry, destGeometry);\n      }\n\n      return destGeometry;\n    }\n\n    if (useAuto) {\n      return amd_default.a.decompress(data, wasmURL, workerURL).then(done);\n    }\n\n    if (useWebWorker) {\n      return amd_default.a.decompressWithWorker(data, useWASM, wasmURL, workerURL).then(done);\n    }\n\n    if (useWASM) {\n      amcGeometry = amd_default.a.decompressWithWASM(data, wasmURL);\n    } else {\n      amcGeometry = amd_default.a.decompressWithJS(data);\n    }\n\n    return done(amcGeometry);\n  },\n  freeMemory: function freeMemory() {\n    amd_default.a.destory();\n  }\n};\n/* harmony default export */ var loader_AliAMCExtension = (AliAMCExtension);\n// CONCATENATED MODULE: ./src/loader/GLTFExtensions.js\n/* eslint camelcase: \"off\" */\n\n\n\n\n\n\n\n\n\n\nvar SAMPLER_2D = src_constants.SAMPLER_2D;\n\n/**\n * GLTFExtension Handler 接口\n * @interface IGLTFExtensionHandler\n */\n\n/**\n * 解析元素扩展\n * @function\n * @name IGLTFExtensionHandler#[parse]\n * @param {Object} [extensionData] 扩展数据\n * @param {GLTFParser} [parser] parser\n * @param {Object} [element] parse的元素，e.g. material, mesh, geometry\n * @param {Object} [options]\n * @return {Object} [result] 一般需要返回原始元素或者替换的新的元素\n */\n\n/**\n * 解析全局扩展，在资源加载后执行\n * @function\n * @name IGLTFExtensionHandler#[parseOnLoad]\n * @param {Object} [extensionData] 扩展数据\n * @param {GLTFParser} [parser] parser\n * @param {Object} [element] parse的元素，这里为 null\n * @param {Object} [options]\n */\n\n/**\n * 解析全局扩展，在所有元素解析结束后执行\n * @function\n * @name IGLTFExtensionHandler#[parseOnEnd]\n * @param {Object} [extensionData] 扩展数据\n * @param {GLTFParser} [parser] parser\n * @param {GLTFModel} [element] parse的元素，这里为加载后的model，{node, scene, meshes, json, cameras, lights, textures, materials}\n * @param {Object} [options]\n */\n\n/**\n * 初始化全局扩展，在加载前执行，可进行添加需要加载的资源\n * @function\n * @name IGLTFExtensionHandler#[init]\n * @param {GLTFLoader} [gltfLoader]\n * @param {GLTFParser} [parser]\n */\n\n/**\n * 获取扩展用到的贴图信息, parser.isLoadAllTextures 为 false 时生效\n * @function\n * @name IGLTFExtensionHandler#[getUsedTextureNameMap]\n * @param {Object} [extensionData] 扩展数据\n * @param {Object} [map] used texture map\n * @example\n * getUsedTextureNameMap(extension, map) {\n *     if (extension.diffuseTexture) {\n *         map[extension.diffuseTexture.index] = true;\n *     }\n * }\n */\n\nvar WEB3D_quantized_attributes = {\n  unQuantizeData: function unQuantizeData(data, decodeMat) {\n    if (!decodeMat) {\n      return data;\n    }\n\n    var matSize = Math.sqrt(decodeMat.length);\n    var itemLen = matSize - 1;\n    var result = new Float32Array(data.length);\n    var tempArr = [];\n    data.traverse(function (d, i) {\n      if (d.toArray) {\n        d.toArray(tempArr);\n      } else {\n        tempArr[0] = d;\n      }\n\n      var idx = i * itemLen;\n\n      for (var j = 0; j < matSize; j++) {\n        result[idx + j] = 0;\n\n        for (var k = 0; k < matSize; k++) {\n          var v = k === itemLen ? 1 : tempArr[k];\n          result[idx + j] += decodeMat[k * matSize + j] * v;\n        }\n      }\n    });\n    data.data = result;\n    data.stride = 0;\n    data.offset = 0;\n    return data;\n  },\n  parse: function parse(quantizeInfo, parser, result, options) {\n    var decodeMat = quantizeInfo.decodeMatrix;\n\n    if (options.isDecode) {\n      result = WEB3D_quantized_attributes.unQuantizeData(result, decodeMat);\n    } else {\n      result.decodeMat = decodeMat;\n    }\n\n    return result;\n  }\n};\nvar HILO_animation_clips = {\n  parseOnEnd: function parseOnEnd(animClips, parser, model) {\n    if (!model.anim || parser.isMultiAnim) {\n      return model;\n    }\n\n    for (var name in animClips) {\n      var clip = animClips[name];\n      model.anim.addClip(name, clip[0], clip[1]);\n    }\n\n    return model;\n  }\n};\nvar ALI_animation_clips = HILO_animation_clips;\nvar ALI_bounding_box = {\n  parse: function parse(bounds, parser, model) {\n    bounds.center = bounds.max.map(function (a, i) {\n      return (a + bounds.min[i]) / 2;\n    });\n    bounds.width = bounds.max[0] - bounds.min[0];\n    bounds.height = bounds.max[1] - bounds.min[1];\n    bounds.depth = bounds.max[2] - bounds.min[2];\n    bounds.size = Math.sqrt(Math.pow(bounds.width, 2) + Math.pow(bounds.height, 2) + Math.pow(bounds.depth, 2));\n    model.bounds = bounds;\n    return model;\n  }\n};\nvar KHR_materials_pbrSpecularGlossiness = {\n  getUsedTextureNameMap: function getUsedTextureNameMap(extension, map) {\n    if (extension.diffuseTexture) {\n      map[extension.diffuseTexture.index] = true;\n    }\n\n    if (extension.specularGlossinessTexture) {\n      map[extension.specularGlossinessTexture.index] = true;\n    }\n  },\n  parse: function parse(info, parser, material) {\n    if (info.diffuseFactor) {\n      material.baseColor.fromArray(info.diffuseFactor);\n    }\n\n    if (info.diffuseTexture) {\n      material.baseColorMap = parser.getTexture(info.diffuseTexture);\n    }\n\n    if (info.specularFactor) {\n      material.specular.fromArray(info.specularFactor);\n      material.specular.a = 1;\n    }\n\n    if ('glossinessFactor' in info) {\n      material.glossiness = info.glossinessFactor;\n    }\n\n    if (info.specularGlossinessTexture) {\n      material.specularGlossinessMap = parser.getTexture(info.specularGlossinessTexture);\n    }\n\n    material.isSpecularGlossiness = true;\n    return material;\n  }\n};\nvar KHR_lights_punctual = {\n  parse: function parse(info, parser, node) {\n    if (!parser.isUseExtension(parser.json, 'KHR_lights_punctual') || !parser.json.extensions.KHR_lights_punctual.lights) {\n      return node;\n    }\n\n    var lightInfo = parser.json.extensions.KHR_lights_punctual.lights[info.light];\n\n    if (!lightInfo) {\n      return node;\n    }\n\n    var light;\n    var color = new math_Color(1, 1, 1, 1);\n\n    if (lightInfo.color) {\n      color.r = lightInfo.color[0];\n      color.g = lightInfo.color[1];\n      color.b = lightInfo.color[2];\n    }\n\n    var amount = lightInfo.intensity !== undefined ? lightInfo.intensity : 1;\n    var name = lightInfo.name || ''; // spot light\n\n    var spotInfo = lightInfo.spot || {};\n    var cutoff = spotInfo.innerConeAngle !== undefined ? math_math.radToDeg(spotInfo.innerConeAngle) : 0;\n    var outerCutoff = spotInfo.outerConeAngle !== undefined ? math_math.radToDeg(spotInfo.outerConeAngle) : 45;\n    var range = lightInfo.range || 0;\n\n    switch (lightInfo.type) {\n      case 'directional':\n        light = new light_DirectionalLight({\n          color: color,\n          amount: amount,\n          name: name,\n          range: range\n        });\n        light.direction.set(0, 0, -1);\n        break;\n\n      case 'point':\n        light = new light_PointLight({\n          color: color,\n          amount: amount,\n          name: name,\n          range: range\n        });\n        break;\n\n      case 'spot':\n        light = new light_SpotLight({\n          color: color,\n          amount: amount,\n          name: name,\n          range: range,\n          cutoff: cutoff,\n          outerCutoff: outerCutoff\n        });\n        light.direction.set(0, 0, -1);\n        break;\n\n      default:\n        return node;\n    }\n\n    if (light) {\n      node.addChild(light);\n      parser.lights.push(light);\n    }\n\n    return node;\n  }\n};\nvar GLTFExtensions_KHR_techniques_webgl = {\n  init: function init(loader, parser) {\n    var actions = [];\n    var extensions = parser.json.extensions || {};\n    var KHR_techniques_webgl = extensions.KHR_techniques_webgl || {};\n    var programs = KHR_techniques_webgl.programs || [];\n    var shaders = KHR_techniques_webgl.shaders || [];\n    var techniques = KHR_techniques_webgl.techniques || [];\n    parser.shaders = {};\n    shaders.forEach(function (shader, index) {\n      var uri = getRelativePath(parser.src, shader.uri);\n\n      if (parser.preHandlerShaderURI) {\n        uri = parser.preHandlerShaderURI(uri, index, shader);\n      }\n\n      actions.push(loader.loadRes(uri).then(function (shaderText) {\n        parser.shaders[index] = shaderText;\n      }));\n    });\n    parser.programs = {};\n    programs.forEach(function (program, index) {\n      parser.programs[index] = Object.assign({}, program);\n    });\n    parser.techniques = {};\n    techniques.forEach(function (technique, index) {\n      var newTechnique = parser.techniques[index] = Object.assign({}, technique);\n      var textureInfos = newTechnique.textureInfos = {};\n      var uniforms = technique.uniforms || {};\n\n      for (var name in uniforms) {\n        var uniform = uniforms[name];\n\n        if (uniform.type === SAMPLER_2D) {\n          textureInfos[name] = uniform.value || {};\n        }\n      }\n    });\n    return Promise.all(actions);\n  },\n  getUsedTextureNameMap: function getUsedTextureNameMap(extension, map, parser) {\n    var techniques = parser.techniques;\n    var technique = techniques[extension.technique];\n    var values = extension.values || {};\n\n    if (technique) {\n      var textureInfos = technique.textureInfos;\n\n      for (var name in textureInfos) {\n        var imageIndex = void 0;\n\n        if (values[name] && values[name].index !== undefined) {\n          imageIndex = values[name].index;\n        } else if (textureInfos[name].index !== undefined) {\n          imageIndex = textureInfos[name].index;\n        }\n\n        if (imageIndex !== undefined) {\n          map[textureInfos[name].index] = true;\n        }\n      }\n    }\n  },\n  parse: function parse(info, parser, material) {\n    var textures = parser.textures || [];\n    var techniqueInfo = parser.techniques[info.technique];\n\n    if (!techniqueInfo) {\n      return material;\n    }\n\n    var programInfo = parser.programs[techniqueInfo.program];\n\n    if (!programInfo) {\n      return material;\n    }\n\n    var fragmentText = parser.shaders[programInfo.fragmentShader];\n    var vertexText = parser.shaders[programInfo.vertexShader];\n    var uniformsInfo = techniqueInfo.uniforms || {};\n    var attributesInfo = techniqueInfo.attributes || {};\n    var valuesInfo = info.values || {};\n    var attributes = {};\n    var uniforms = {};\n\n    var _loop = function _loop(uniformName) {\n      var uniformDef = uniformsInfo[uniformName] || {};\n      var uniformValue = valuesInfo[uniformName];\n\n      if (uniformValue === undefined) {\n        uniformValue = uniformDef.value;\n      }\n\n      var uniformObject = void 0;\n\n      if (uniformValue !== undefined) {\n        if (uniformDef.type === SAMPLER_2D) {\n          var textureIndex = uniformValue.index || 0;\n          uniformObject = {\n            get: function get(mesh, material, programInfo) {\n              return material_semantic.handlerTexture(textures[textureIndex], programInfo.textureIndex);\n            }\n          };\n        } else {\n          uniformObject = {\n            get: function get() {\n              return uniformValue;\n            }\n          };\n        }\n      } else if (uniformDef.semantic && material_semantic[uniformDef.semantic]) {\n        var semanticFunc = material_semantic[uniformDef.semantic];\n        var nodeIndex = uniformDef.node;\n        var node;\n\n        if (nodeIndex !== undefined) {\n          uniformObject = {\n            get: function get(mesh, material, programInfo) {\n              if (node === undefined) {\n                node = parser.node.getChildByFn(function (node) {\n                  return node.animationId === nodeIndex;\n                }) || mesh;\n              }\n\n              return semanticFunc.get(node, material, programInfo);\n            }\n          };\n        } else {\n          uniformObject = uniformDef.semantic;\n        }\n      } else {\n        utils_log.warn(\"KHR_techniques_webgl: no \".concat(uniformName, \" value found!\"));\n        uniformObject = material_semantic.blankInfo;\n      }\n\n      uniforms[uniformName] = uniformObject;\n    };\n\n    for (var uniformName in uniformsInfo) {\n      _loop(uniformName);\n    }\n\n    for (var attributeName in attributesInfo) {\n      var attributeValue = attributesInfo[attributeName] || {};\n\n      if (attributeValue.semantic) {\n        attributes[attributeName] = attributeValue.semantic;\n      }\n    }\n\n    var shaderMaterial = new material_ShaderMaterial({\n      needBasicUnifroms: false,\n      needBasicAttributes: false,\n      vs: vertexText,\n      fs: fragmentText,\n      attributes: attributes,\n      uniforms: uniforms\n    });\n    return shaderMaterial;\n  }\n};\n// CONCATENATED MODULE: ./src/core/Fog.js\n\n\n\nvar tempFloat32Array = new Float32Array(2);\n/**\n * 雾\n * @class\n */\n\nvar Fog = core_Class.create(\n/** @lends Fog.prototype */\n{\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isFog: true,\n\n  /**\n   * @default Fog\n   * @type {String}\n   */\n  className: 'Fog',\n\n  /**\n   * 雾模式, 可选 LINEAR, EXP, EXP2\n   * @type {String}\n   * @default LINEAR\n   */\n  mode: 'LINEAR',\n\n  /**\n   * 雾影响起始值, 只在 mode 为 LINEAR 时生效\n   * @type {Number}\n   * @default 5\n   */\n  start: 5,\n\n  /**\n   * 雾影响终点值, 只在 mode 为 LINEAR 时生效\n   * @type {Number}\n   * @default 10\n   */\n  end: 10,\n\n  /**\n   * 雾密度, 只在 mode 为 EXP, EXP2 时生效\n   * @type {Number}\n   * @default 0.1\n   */\n  density: 0.1,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    /**\n     * id\n     * @default math.generateUUID('Fog')\n     * @type {String}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * 雾颜色\n     * @type {Color}\n     * @default  new Color(1, 1, 1, 1)\n     */\n\n    this.color = new math_Color(1, 1, 1, 1);\n    Object.assign(this, params);\n  },\n\n  /**\n   * 获取雾信息\n   * @return {Array} res\n   */\n  getInfo: function getInfo() {\n    if (this.mode === 'LINEAR') {\n      tempFloat32Array[0] = this.start;\n      tempFloat32Array[1] = this.end;\n      return tempFloat32Array;\n    }\n\n    return this.density;\n  },\n  getRenderOption: function getRenderOption() {\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    option[\"FOG_\".concat(this.mode)] = 1;\n    return option;\n  }\n});\n/* harmony default export */ var core_Fog = (Fog);\n// EXTERNAL MODULE: ./node_modules/_ray-3d@1.1.1@ray-3d/index.js\nvar _ray_3d_1_1_1_ray_3d = __webpack_require__(\"./node_modules/_ray-3d@1.1.1@ray-3d/index.js\");\nvar _ray_3d_1_1_1_ray_3d_default = /*#__PURE__*/__webpack_require__.n(_ray_3d_1_1_1_ray_3d);\n\n// CONCATENATED MODULE: ./src/math/Ray.js\n\n\n\n/**\n * 射线\n * @class\n * @example\n * var ray = new Hilo3d.Ray();\n * ray.fromCamera(camera, 10, 10, stage.width, stage.height);\n */\n\nvar Ray = core_Class.create(\n/** @lends Ray.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default Ray\n   */\n  className: 'Ray',\n\n  /**\n   * 是否是射线\n   * @type {Boolean}\n   * @default true\n   */\n  isRay: true,\n\n  /**\n   * 原点\n   * @type {Vector3}\n   */\n  origin: {\n    get: function get() {\n      return this._origin;\n    },\n    set: function set(value) {\n      this._origin = value;\n      this._ray.origin = value.elements;\n    }\n  },\n\n  /**\n   * 方向\n   * @type {Vector3}\n   */\n  direction: {\n    get: function get() {\n      return this._direction;\n    },\n    set: function set(value) {\n      this._direction = value;\n      this._ray.direction = value.elements;\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {Object} [params]\n   * @param {Vector3} [params.origin=new Vector3(0, 0, 0)] 原点\n   * @param {Vector3} [params.direction=new Vector3(0, 0, -1)] 方向\n   */\n  constructor: function constructor() {\n    var params = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this._ray = new _ray_3d_1_1_1_ray_3d_default.a();\n    this.origin = params.origin || new math_Vector3(0, 0, 0);\n    this.direction = params.direction || new math_Vector3(0, 0, -1);\n  },\n\n  /**\n   * set\n   * @param {Vector3} origin\n   * @param {Vector3} direction\n   * @return {Ray} this\n   */\n  set: function set(origin, direction) {\n    this.origin = origin;\n    this.direction = direction;\n    return this;\n  },\n\n  /**\n   * copy\n   * @param  {Vector3} other\n   * @return {Ray}\n   */\n  copy: function copy(other) {\n    this.origin.copy(other.origin);\n    this.direction.copy(other.direction);\n  },\n\n  /**\n   * clone\n   * @return {Ray}\n   */\n  clone: function clone() {\n    return new this.constructor({\n      origin: this.origin.clone(),\n      direction: this.direction.clone()\n    });\n  },\n\n  /**\n   * 从摄像机设置\n   * @param  {Camera} camera\n   * @param  {Number} x 屏幕x\n   * @param  {Number} y 屏幕y\n   * @param  {Number} width   屏幕宽\n   * @param  {Number} height  屏幕高\n   */\n  fromCamera: function fromCamera(camera, x, y, width, height) {\n    if (camera.isPerspectiveCamera) {\n      camera.worldMatrix.getTranslation(this.origin);\n      this.direction.set(x, y, 0);\n      this.direction.copy(camera.unprojectVector(this.direction, width, height));\n      this.direction.sub(this.origin).normalize();\n    } else if (camera.isOrthographicCamera) {\n      this.origin.set(x, y, (camera.near + camera.far) / (camera.near - camera.far));\n      this.origin.copy(camera.unprojectVector(this.origin, width, height));\n      this.direction.set(0, 0, -1).transformDirection(camera.worldMatrix).normalize();\n    }\n  },\n\n  /**\n   * Transforms the ray with a mat4\n   * @param  {Matrix4} mat4\n   */\n  transformMat4: function transformMat4(mat4) {\n    this.origin.transformMat4(mat4);\n    this.direction.transformDirection(mat4).normalize();\n  },\n\n  /**\n   * 排序碰撞点\n   * @param  {Vector3[]|raycastInfo[]} points\n   * @param  {String} [pointName='']\n   */\n  sortPoints: function sortPoints(points, pointName) {\n    var _this = this;\n\n    if (pointName) {\n      points.sort(function (a, b) {\n        return _this.squaredDistance(a[pointName]) - _this.squaredDistance(b[pointName]);\n      });\n    } else {\n      points.sort(function (a, b) {\n        return _this.squaredDistance(a) - _this.squaredDistance(b);\n      });\n    }\n  },\n\n  /**\n   * squaredDistance\n   * @param  {Vector3} point\n   * @return {Number}\n   */\n  squaredDistance: function squaredDistance(point) {\n    return this.origin.squaredDistance(point);\n  },\n\n  /**\n   * distance\n   * @param  {Vector3} point\n   * @return {Number}\n   */\n  distance: function distance(point) {\n    return this.origin.distance(point);\n  },\n\n  /**\n   * intersectsSphere\n   * @param  {Number[]} center [x, y, z]\n   * @param  {Number} radius\n   * @return {Vector3}  碰撞点，如果没有碰撞返回 null\n   */\n  intersectsSphere: function intersectsSphere(center, radius) {\n    var res = this._ray.intersectsSphere(center, radius);\n\n    return this._getRes(res);\n  },\n\n  /**\n   * intersectsPlane\n   * @param  {Number[]} normal [x, y, z]\n   * @param  {Number} distance\n   * @return {Vector3}  碰撞点，如果没有碰撞返回 null\n   */\n  intersectsPlane: function intersectsPlane(normal, distance) {\n    var res = this._ray.intersectsPlane(normal, distance);\n\n    return this._getRes(res);\n  },\n\n  /**\n   * intersectsTriangle\n   * @param  {Array} triangle [[a.x, a.y, a.z], [b.x, b.y, b.z],[c.x, c.y, c.z]]\n   * @return {Vector3}  碰撞点，如果没有碰撞返回 null\n   */\n  intersectsTriangle: function intersectsTriangle(triangle) {\n    var res = this._ray.intersectsTriangle(triangle);\n\n    return this._getRes(res);\n  },\n\n  /**\n   * intersectsBox\n   * @param  {Array} aabb [[min.x, min.y, min.z], [max.x, max.y, max.z]]\n   * @return {Vector3}  碰撞点，如果没有碰撞返回 null\n   */\n  intersectsBox: function intersectsBox(aabb) {\n    var res = this._ray.intersectsBox(aabb);\n\n    return this._getRes(res);\n  },\n\n  /**\n   * intersectsTriangleCell\n   * @param  {Array} cell\n   * @param  {Array} positions\n   * @return {Vector3}  碰撞点，如果没有碰撞返回 null\n   */\n  intersectsTriangleCell: function intersectsTriangleCell(cell, positions) {\n    var res = this._ray.intersectsTriangleCell(cell, positions);\n\n    return this._getRes(res);\n  },\n\n  /**\n   * _getRes\n   * @private\n   */\n  _getRes: function _getRes(res) {\n    if (res) {\n      return new math_Vector3(res[0], res[1], res[2]);\n    }\n\n    return null;\n  }\n});\n/* harmony default export */ var math_Ray = (Ray);\n// CONCATENATED MODULE: ./src/core/Mesh.js\n\n\n\n\nvar tempRay = new math_Ray();\nvar Mesh_tempMatrix4 = new math_Matrix4();\n/**\n * Mesh\n * @class\n * @extends Node\n * @example\n * const mesh = new Hilo3d.Mesh({\n *     geometry: new Hilo3d.BoxGeometry(),\n *     material: new Hilo3d.BasicMaterial({\n *         diffuse: new Hilo3d.Color(0.8, 0, 0)\n *     }),\n *     x:100,\n *     rotationX:30\n * });\n * stage.addChild(mesh);\n */\n\nvar Mesh = core_Class.create(\n/** @lends Mesh.prototype */\n{\n  Extends: core_Node,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isMesh: true,\n\n  /**\n   * @default Mesh\n   * @type {string}\n   */\n  className: 'Mesh',\n\n  /**\n   * @type {Geometry}\n   */\n  geometry: null,\n\n  /**\n   * @type {Material}\n   */\n  material: null,\n\n  /**\n   * 是否使用 Instanced\n   * @default false\n   * @type {boolean}\n   */\n  useInstanced: false,\n\n  /**\n   * 是否开启视锥体裁剪\n   * @default true\n   * @type {Boolean}\n   */\n  frustumTest: true,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {Geometry} [params.geometry] 几何体\n   * @param {Material} [params.material] 材质\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    Mesh.superclass.constructor.call(this, params);\n  },\n\n  /**\n   * clone 当前mesh\n   * @param {boolean} isChild 是否子元素\n   * @return {Mesh} 返回clone的实例\n   */\n  clone: function clone(isChild) {\n    var node = core_Node.prototype.clone.call(this, isChild);\n    Object.assign(node, {\n      geometry: this.geometry,\n      material: this.material\n    });\n    return node;\n  },\n\n  /**\n   * raycast\n   * @param  {Ray} ray\n   * @param {Boolean} [sort=true] 是否按距离排序\n   * @return {Vector3[]|null}\n   */\n  raycast: function raycast(ray) {\n    var sort = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n\n    if (!this.visible) {\n      return null;\n    }\n\n    var geometry = this.geometry;\n    var material = this.material;\n    var worldMatrix = this.worldMatrix;\n\n    if (geometry && material) {\n      Mesh_tempMatrix4.invert(worldMatrix);\n      tempRay.copy(ray);\n      tempRay.transformMat4(Mesh_tempMatrix4);\n      var res = geometry.raycast(tempRay, material.side, sort);\n\n      if (res) {\n        res.forEach(function (point) {\n          point.transformMat4(worldMatrix);\n        });\n        return res;\n      }\n    }\n\n    return null;\n  },\n  getRenderOption: function getRenderOption() {\n    var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    this.geometry.getRenderOption(opt);\n    return opt;\n  },\n\n  /**\n   * 是否被销毁\n   * @readOnly\n   * @type {Boolean}\n   */\n  isDestroyed: {\n    get: function get() {\n      return this._isDestroyed;\n    }\n  },\n\n  /**\n   * 销毁 Mesh 资源\n   * @param {WebGLRenderer} renderer\n   * @param {Boolean} [destroyTextures=false] 是否销毁材质的贴图，默认不销毁\n   * @return {Mesh} this\n   */\n  destroy: function destroy(renderer) {\n    var needDestroyTextures = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : false;\n\n    if (this._isDestroyed) {\n      return this;\n    }\n\n    this.removeFromParent();\n    var resourceManager = renderer.resourceManager;\n    resourceManager.destroyMesh(this);\n\n    if (this.material && needDestroyTextures) {\n      this.material.destroyTextures();\n    }\n\n    this.off();\n    this.geometry = null;\n    this.material = null;\n    this._isDestroyed = true;\n    return this;\n  }\n});\n/* harmony default export */ var core_Mesh = (Mesh);\n// CONCATENATED MODULE: ./src/core/SkinedMesh.js\n\n\n\n\n\n\n\nvar tempMatrix1 = new math_Matrix4();\nvar tempMatrix2 = new math_Matrix4();\n/**\n * 蒙皮Mesh\n * @class\n * @extends Mesh\n */\n\nvar SkinedMesh = core_Class.create(\n/** @lends SkinedMesh.prototype */\n{\n  Extends: core_Mesh,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isSkinedMesh: true,\n\n  /**\n   * @default SkinedMesh\n   * @type {string}\n   */\n  className: 'SkinedMesh',\n\n  /**\n   * 是否支持 Instanced\n   * @default false\n   * @type {boolean}\n   */\n  useInstanced: false,\n\n  /**\n   * 骨骼矩阵DataTexture\n   * @default null\n   * @type {DataTexture}\n   */\n  jointMatTexture: null,\n\n  /**\n   * 是否开启视锥体裁剪\n   * @default false\n   * @type {Boolean}\n   */\n  frustumTest: false,\n\n  /**\n   * 骨架\n   * @default null\n   * @type {Skeleton}\n   */\n  skeleton: null,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    SkinedMesh.superclass.constructor.call(this, params);\n  },\n\n  /**\n   * 获取每个骨骼对应的矩阵数组\n   * @return {Float32Array} 返回矩阵数组\n   */\n  getJointMat: function getJointMat() {\n    var _this = this;\n\n    if (!this.skeleton || this.skeleton.jointCount <= 0) {\n      return undefined;\n    }\n\n    var jointNodeList = this.skeleton.jointNodeList;\n    var inverseBindMatrices = this.skeleton.inverseBindMatrices;\n    var jointMatLength = this.skeleton.jointCount * 16;\n\n    if (!this.jointMat || this.jointMat.length !== jointMatLength) {\n      this.jointMat = new Float32Array(jointMatLength);\n    }\n\n    if (!this.clonedFrom) {\n      tempMatrix2.invert(this.worldMatrix);\n    } else {\n      tempMatrix2.invert(this.clonedFrom.worldMatrix);\n    }\n\n    jointNodeList.forEach(function (node, i) {\n      tempMatrix1.copy(tempMatrix2);\n      tempMatrix1.multiply(node.worldMatrix);\n      tempMatrix1.multiply(inverseBindMatrices[i]);\n      tempMatrix1.toArray(_this.jointMat, i * 16);\n    });\n    return this.jointMat;\n  },\n\n  /**\n   * 用新骨骼的 node name 重设 jointNames\n   * @param  {Skeleton} skeleton 新骨架\n   */\n  resetJointNamesByNodeName: function resetJointNamesByNodeName(skeleton) {\n    this.skeleton.resetJointNamesByNodeName(skeleton);\n  },\n\n  /**\n   * 用新骨骼重置skinIndices\n   * @param  {Skeleton} skeleton\n   */\n  resetSkinIndices: function resetSkinIndices(skeleton) {\n    var currentSkeleton = this.skeleton;\n\n    if (currentSkeleton) {\n      var geometry = this.geometry;\n      var skinIndices = geometry.skinIndices;\n\n      if (skinIndices) {\n        this.material.isDirty = true;\n        geometry.isDirty = true;\n        skinIndices.isDirty = true;\n        var tempIndices = new math_Vector4();\n        skinIndices.traverse(function (attribute, index, offset) {\n          attribute.elements.forEach(function (value, elementIndex) {\n            var jointName = currentSkeleton.jointNames[value];\n            var jointIndex = skeleton.jointNames.indexOf(jointName);\n\n            if (jointIndex >= 0) {\n              tempIndices.elements[elementIndex] = jointIndex;\n            } else {\n              utils_log.warnOnce('SkinedMesh.resetSkinIndices', 'SkinedMesh.resetSkinIndices: no jointName found!', jointName);\n            }\n          });\n          skinIndices.setByOffset(offset, tempIndices);\n        });\n      }\n    }\n  },\n\n  /**\n   * 根据当前骨骼数来生成骨骼矩阵的 jointMatTexture\n   * @return {DataTexture}\n   */\n  initJointMatTexture: function initJointMatTexture() {\n    if (!this.jointMatTexture) {\n      var jointMat = this.getJointMat();\n      this.jointMatTexture = new texture_DataTexture({\n        data: jointMat\n      });\n    }\n\n    return this.jointMatTexture;\n  },\n\n  /**\n   * 将 getJointMat 获取的骨骼矩阵数组更新到 jointMatTexture 中\n   */\n  updateJointMatTexture: function updateJointMatTexture() {\n    if (!this.jointMatTexture) {\n      this.initJointMatTexture();\n    } else {\n      var jointMat = this.getJointMat();\n      this.jointMatTexture.data.set(jointMat, 0);\n      this.jointMatTexture.needUpdate = true;\n    }\n  },\n  clone: function clone(isChild) {\n    var mesh = core_Mesh.prototype.clone.call(this, isChild);\n    Object.assign(mesh, {\n      useInstanced: this.useInstanced,\n      skeleton: this.skeleton.clone()\n    });\n    mesh.clonedFrom = this;\n    return mesh;\n  },\n  getRenderOption: function getRenderOption() {\n    var opt = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    SkinedMesh.superclass.getRenderOption.call(this, opt);\n    var jointCount = this.skeleton.jointCount;\n\n    if (jointCount) {\n      opt.JOINT_COUNT = jointCount;\n\n      if (renderer_capabilities.VERTEX_TEXTURE_FLOAT) {\n        var maxJointCount = (renderer_capabilities.MAX_VERTEX_UNIFORM_VECTORS - 22) / 4;\n\n        if (jointCount > maxJointCount) {\n          opt.JOINT_MAT_MAP = 1;\n        }\n      }\n    }\n\n    return opt;\n  }\n});\n/* harmony default export */ var core_SkinedMesh = (SkinedMesh);\n// CONCATENATED MODULE: ./src/core/Skeleton.js\n\n\n/**\n * 骨架\n * @class\n */\n\nvar Skeleton = core_Class.create(\n/** @lends Skeleton.prototype */\n{\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isSkeleton: true,\n\n  /**\n   * @default Skeleton\n   * @type {String}\n   */\n  className: 'Skeleton',\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    /**\n     * id\n     * @default math.generateUUID('Skeleton')\n     * @type {String}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * @default []\n     * @type {Node[]}\n     */\n\n    this.jointNodeList = [];\n    /**\n     * @default []\n     * @type {String[]}\n     */\n\n    this.jointNames = [];\n    /**\n     * @default []\n     * @type {Matrix4[]}\n     */\n\n    this.inverseBindMatrices = [];\n    Object.assign(this, params);\n  },\n\n  /**\n   * 关节数量\n   * @readOnly\n   * @type {Number}\n   */\n  jointCount: {\n    get: function get() {\n      return this.jointNodeList.length;\n    }\n  },\n\n  /**\n   * @private\n   * @type {Node}\n   */\n  _rootNode: null,\n\n  /**\n   * 设置根节点\n   * @type {Node}\n   */\n  rootNode: {\n    get: function get() {\n      return this._rootNode;\n    },\n    set: function set(rootNode) {\n      this._rootNode = rootNode;\n\n      if (rootNode) {\n        this._initJointNodeList();\n      }\n    }\n  },\n\n  /**\n   * @private\n   */\n  _initJointNodeList: function _initJointNodeList() {\n    var map = {};\n    this.rootNode.traverse(function (node) {\n      map[node.jointName] = node;\n    });\n    this.jointNodeList = this.jointNames.map(function (name) {\n      return map[name];\n    });\n  },\n\n  /**\n   * 用新骨骼的 node name 重设 jointNames\n   * @param  {Skeleton} skeleton 新骨架\n   */\n  resetJointNamesByNodeName: function resetJointNamesByNodeName(skeleton) {\n    var jointNames = this.jointNames;\n    this.jointNodeList.forEach(function (jointNode, index) {\n      var mainJointNode = skeleton.rootNode.getChildByName(jointNode.name);\n\n      if (mainJointNode) {\n        jointNames[index] = mainJointNode.jointName;\n      }\n    });\n  },\n\n  /**\n   * clone\n   * @param {Node} [rootNode]\n   * @return {Skeleton}\n   */\n  clone: function clone(rootNode) {\n    var skeleton = new Skeleton();\n    skeleton.copy(this, rootNode);\n    return skeleton;\n  },\n\n  /**\n   * copy\n   * @param  {Skeleton} skeleton\n   * @param {Node} [rootNode]\n   * @return {Skeleton} this\n   */\n  copy: function copy(skeleton, rootNode) {\n    this.inverseBindMatrices = skeleton.inverseBindMatrices;\n    this.jointNames = skeleton.jointNames.slice();\n\n    if (rootNode === undefined) {\n      rootNode = skeleton.rootNode;\n    }\n\n    this.rootNode = rootNode;\n    return this;\n  }\n});\n/* harmony default export */ var core_Skeleton = (Skeleton);\n// CONCATENATED MODULE: ./src/core/version.js\n/* global HILO3D_VERSION */\n/* harmony default export */ var core_version = (\"1.15.8\");\n// CONCATENATED MODULE: ./src/renderer/RenderInfo.js\n\n/**\n * 渲染信息\n * @class\n */\n\nvar RenderInfo = core_Class.create(\n/** @lends RenderInfo.prototype */\n{\n  /**\n   * @default RenderInfo\n   * @type {String}\n   */\n  className: 'RenderInfo',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isRenderInfo: true,\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    this.reset();\n  },\n\n  /**\n   * 增加面数\n   * @param {Number} num\n   */\n  addFaceCount: function addFaceCount(num) {\n    this._currentFaceCount += num;\n  },\n\n  /**\n   * 增加绘图数\n   * @param {Number} num\n   */\n  addDrawCount: function addDrawCount(num) {\n    this._currentDrawCount += num;\n  },\n\n  /**\n   * 重置信息\n   */\n  reset: function reset() {\n    /**\n     * 面数\n     * @type {Number}\n     * @readOnly\n     */\n    this.faceCount = Math.floor(this._currentFaceCount);\n    /**\n     * 绘图数\n     * @type {Number}\n     * @readOnly\n     */\n\n    this.drawCount = Math.floor(this._currentDrawCount);\n    /**\n     * 当前面数\n     * @type {Number}\n     * @private\n     */\n\n    this._currentFaceCount = 0;\n    /**\n     * 当前绘图数\n     * @private\n     * @type {Number}\n     */\n\n    this._currentDrawCount = 0;\n  }\n});\n/* harmony default export */ var renderer_RenderInfo = (RenderInfo);\n// CONCATENATED MODULE: ./src/renderer/RenderList.js\n\n\n\nvar RenderList_tempVector3 = new math_Vector3();\n\nvar opaqueSort = function opaqueSort(meshA, meshB) {\n  // sort by material renderOrder\n  var renderOrderA = meshA.material.renderOrder;\n  var renderOrderB = meshB.material.renderOrder;\n\n  if (renderOrderA !== renderOrderB) {\n    return renderOrderA - renderOrderB;\n  } // sort by shader id\n\n\n  var shaderNumIdA = meshA.material._shaderNumId || 0;\n  var shaderNumIdB = meshB.material._shaderNumId || 0;\n\n  if (shaderNumIdA !== shaderNumIdB) {\n    return shaderNumIdA - shaderNumIdB;\n  } // sort by render z\n\n\n  return meshA._sortRenderZ - meshB._sortRenderZ;\n};\n\nvar transparentSort = function transparentSort(meshA, meshB) {\n  // sort by material renderOrder\n  var renderOrderA = meshA.material.renderOrder;\n  var renderOrderB = meshB.material.renderOrder;\n\n  if (renderOrderA !== renderOrderB) {\n    return renderOrderA - renderOrderB;\n  } // sort by inverse render z\n\n\n  return meshB._sortRenderZ - meshA._sortRenderZ;\n};\n/**\n * 渲染列表\n * @class\n */\n\n\nvar RenderList = core_Class.create(\n/** @lends RenderList.prototype */\n{\n  /**\n   * @default RenderList\n   * @type {String}\n   */\n  className: 'RenderList',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isRenderList: true,\n\n  /**\n   * 使用 instanced\n   * @type {Boolean}\n   * @default false\n   */\n  useInstanced: false,\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    /**\n     * 不透明物体列表\n     * @type {Array}\n     */\n    this.opaqueList = [];\n    /**\n     * 透明物体列表\n     * @type {Array}\n     */\n\n    this.transparentList = [];\n    /**\n     * instanced物体字典\n     * @type {Object}\n     */\n\n    this.instancedDict = {};\n  },\n\n  /**\n   * 重置列表\n   */\n  reset: function reset() {\n    this.opaqueList.length = 0;\n    this.transparentList.length = 0;\n    this.instancedDict = {};\n  },\n\n  /**\n   * 遍历列表执行回调\n   * @param  {RenderListTraverseCallback} callback callback(mesh)\n   * @param  {RenderListInstancedTraverseCallback} [instancedCallback=null] instancedCallback(instancedMeshes)\n   */\n  traverse: function traverse(callback, instancedCallback) {\n    this.opaqueList.forEach(function (mesh) {\n      callback(mesh);\n    });\n    var instancedDict = this.instancedDict;\n\n    for (var instancedId in instancedDict) {\n      var instancedList = instancedDict[instancedId];\n\n      if (instancedList.length > 2 && instancedCallback) {\n        instancedCallback(instancedList);\n      } else {\n        instancedList.forEach(function (mesh) {\n          callback(mesh);\n        });\n      }\n    }\n\n    this.transparentList.forEach(function (mesh) {\n      callback(mesh);\n    });\n  },\n  sort: function sort() {\n    this.transparentList.sort(transparentSort);\n    this.opaqueList.sort(opaqueSort);\n  },\n\n  /**\n   * 增加 mesh\n   * @param {Mesh} mesh\n   * @param {Camera} camera\n   */\n  addMesh: function addMesh(mesh, camera) {\n    var material = mesh.material;\n    var geometry = mesh.geometry;\n\n    if (material && geometry) {\n      if (mesh.frustumTest && !camera.isMeshVisible(mesh)) {\n        return;\n      }\n\n      if (this.useInstanced && mesh.useInstanced) {\n        var instancedDict = this.instancedDict;\n        var instancedId = material.id + '_' + geometry.id;\n        var instancedList = instancedDict[instancedId];\n\n        if (!instancedDict[instancedId]) {\n          instancedList = instancedDict[instancedId] = [];\n        }\n\n        instancedList.push(mesh);\n      } else {\n        mesh.worldMatrix.getTranslation(RenderList_tempVector3);\n        RenderList_tempVector3.transformMat4(camera.viewProjectionMatrix);\n        mesh._sortRenderZ = RenderList_tempVector3.z;\n\n        if (material.transparent) {\n          this.transparentList.push(mesh);\n        } else {\n          this.opaqueList.push(mesh);\n        }\n      }\n    } else {\n      utils_log.warnOnce(\"RenderList.addMesh(\".concat(mesh.id, \")\"), 'Mesh must have material and geometry', mesh);\n    }\n  }\n});\n/* harmony default export */ var renderer_RenderList = (RenderList);\n/**\n * @callback RenderListTraverseCallback\n * @param {Mesh} mesh\n */\n\n/**\n * @callback RenderListInstancedTraverseCallback\n * @param {Mesh[]} meshes\n */\n// CONCATENATED MODULE: ./src/renderer/WebGLState.js\n\n/**\n * WebGL 状态管理，减少 api 调用\n * @class\n */\n\nvar WebGLState = core_Class.create(\n/** @lends WebGLState.prototype */\n{\n  /**\n   * @default WebGLState\n   * @type {String}\n   */\n  className: 'WebGLState',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isWebGLState: true,\n\n  /**\n   * 系统framebuffer\n   * @default true\n   * @type {null}\n   */\n  systemFramebuffer: null,\n\n  /**\n   * @constructs\n   * @param  {WebGLRenderingContext} gl\n   */\n  constructor: function constructor(gl) {\n    /**\n     * gl\n     * @type {WebGLRenderingContext}\n     */\n    this.gl = gl;\n    this.reset();\n  },\n\n  /**\n   * 重置状态\n   */\n  reset: function reset() {\n    this._dict = {};\n    this.activeTextureIndex = null;\n    this.textureUnitDict = {};\n    this.currentFramebuffer = null;\n    this.preFramebuffer = null;\n    this._pixelStorei = {};\n  },\n\n  /**\n   * enable\n   * @param  {GLenum} capability\n   */\n  enable: function enable(capability) {\n    var value = this._dict[capability];\n\n    if (value !== true) {\n      this._dict[capability] = true;\n      this.gl.enable(capability);\n    }\n  },\n\n  /**\n   * disable\n   * @param  {GLenum} capability\n   */\n  disable: function disable(capability) {\n    var value = this._dict[capability];\n\n    if (value !== false) {\n      this._dict[capability] = false;\n      this.gl.disable(capability);\n    }\n  },\n\n  /**\n   * bindFramebuffer\n   * @param  {GLenum} target\n   * @param  {WebGLFramebuffer} framebuffer\n   */\n  bindFramebuffer: function bindFramebuffer(target, framebuffer) {\n    if (this.currentFramebuffer !== framebuffer) {\n      this.preFramebuffer = this.currentFramebuffer;\n      this.currentFramebuffer = framebuffer;\n      this.gl.bindFramebuffer(target, framebuffer);\n    }\n  },\n\n  /**\n   * 绑定系统framebuffer\n   */\n  bindSystemFramebuffer: function bindSystemFramebuffer() {\n    this.bindFramebuffer(this.gl.FRAMEBUFFER, this.systemFramebuffer);\n  },\n\n  /**\n   * useProgram\n   * @param  { WebGLProgram} program\n   */\n  useProgram: function useProgram(program) {\n    this.set1('useProgram', program);\n  },\n\n  /**\n   * depthFunc\n   * @param  {GLenum } func\n   */\n  depthFunc: function depthFunc(func) {\n    this.set1('depthFunc', func);\n  },\n\n  /**\n   * depthMask\n   * @param  {GLenum } flag\n   */\n  depthMask: function depthMask(flag) {\n    this.set1('depthMask', flag);\n  },\n\n  /**\n   * clear\n   * @param  {Number} mask\n   */\n  clear: function clear(mask) {\n    this.gl.clear(mask);\n  },\n\n  /**\n   * depthRange\n   * @param  {Number} zNear\n   * @param  {Number} zFar\n   */\n  depthRange: function depthRange(zNear, zFar) {\n    this.set2('depthRange', zNear, zFar);\n  },\n\n  /**\n   * stencilFunc\n   * @param  {GLenum} func\n   * @param  {Number} ref\n   * @param  {Number} mask\n   */\n  stencilFunc: function stencilFunc(func, ref, mask) {\n    this.set3('stencilFunc', func, ref, mask);\n  },\n\n  /**\n   * stencilMask\n   * @param  {Number} mask\n   */\n  stencilMask: function stencilMask(mask) {\n    this.set1('stencilMask', mask);\n  },\n\n  /**\n   * stencilOp\n   * @param  {GLenum} fail\n   * @param  {GLenum} zfail\n   * @param  {GLenum} zpass\n   */\n  stencilOp: function stencilOp(fail, zfail, zpass) {\n    this.set3('stencilOp', fail, zfail, zpass);\n  },\n\n  /**\n   * colorMask\n   * @param  {Boolean} red\n   * @param  {Boolean} green\n   * @param  {Boolean} blue\n   * @param  {Boolean} alpha\n   */\n  colorMask: function colorMask(red, green, blue, alpha) {\n    this.set4('colorMask', red, green, blue, alpha);\n  },\n\n  /**\n   * cullFace\n   * @param  {GLenum} mode\n   */\n  cullFace: function cullFace(mode) {\n    this.set1('cullFace', mode);\n  },\n\n  /**\n   * frontFace\n   * @param  {GLenum} mode\n   */\n  frontFace: function frontFace(mode) {\n    this.set1('frontFace', mode);\n  },\n\n  /**\n   * blendFuncSeparate\n   * @param  {GLenum} srcRGB\n   * @param  {GLenum} dstRGB\n   * @param  {GLenum} srcAlpha\n   * @param  {GLenum} dstAlpha\n   */\n  blendFuncSeparate: function blendFuncSeparate(srcRGB, dstRGB, srcAlpha, dstAlpha) {\n    this.set4('blendFuncSeparate', srcRGB, dstRGB, srcAlpha, dstAlpha);\n  },\n\n  /**\n   * blendEquationSeparate\n   * @param  {GLenum} modeRGB\n   * @param  {GLenum} modeAlpha\n   */\n  blendEquationSeparate: function blendEquationSeparate(modeRGB, modeAlpha) {\n    this.set2('blendEquationSeparate', modeRGB, modeAlpha);\n  },\n\n  /**\n   * pixelStorei\n   * @param  {GLenum} pname\n   * @param  {GLenum} param\n   */\n  pixelStorei: function pixelStorei(pname, param) {\n    var currentParam = this._pixelStorei[pname];\n\n    if (currentParam !== param) {\n      this._pixelStorei[pname] = param;\n      this.gl.pixelStorei(pname, param);\n    }\n  },\n\n  /**\n   * viewport\n   * @param  {Number} x\n   * @param  {Number} y\n   * @param  {Number} width\n   * @param  {Number} height\n   */\n  viewport: function viewport(x, y, width, height) {\n    this.set4('viewport', x, y, width, height);\n  },\n\n  /**\n   * activeTexture\n   * @param  {GLenum} texture\n   */\n  activeTexture: function activeTexture(texture) {\n    if (this.activeTextureIndex !== texture) {\n      this.activeTextureIndex = texture;\n      this.gl.activeTexture(texture);\n    }\n  },\n\n  /**\n   * bindTexture\n   * @param  {GLenum} target\n   * @param  {WebGLTexture } texture\n   */\n  bindTexture: function bindTexture(target, texture) {\n    var textureUnit = this.getActiveTextureUnit();\n\n    if (textureUnit[target] !== texture) {\n      textureUnit[target] = texture;\n      this.gl.bindTexture(target, texture);\n    }\n  },\n\n  /**\n   * 获取当前激活的纹理对象\n   * @return {GLenum}\n   */\n  getActiveTextureUnit: function getActiveTextureUnit() {\n    var textureUnit = this.textureUnitDict[this.activeTextureIndex];\n\n    if (!textureUnit) {\n      textureUnit = this.textureUnitDict[this.activeTextureIndex] = {};\n    }\n\n    return textureUnit;\n  },\n\n  /**\n   * 调 gl 1参数方法\n   * @private\n   * @param  {String} name  方法名\n   * @param  {Number|Object} param 方法参数\n   */\n  set1: function set1(name, param) {\n    var value = this._dict[name];\n\n    if (value !== param) {\n      this._dict[name] = param;\n      this.gl[name](param);\n    }\n  },\n\n  /**\n   * 调 gl 2参数方法\n   * @private\n   * @param  {String} name  方法名\n   * @param  {Number|Object} param0 方法参数\n   * @param  {Number|Object} param1 方法参数\n   */\n  set2: function set2(name, param0, param1) {\n    var value = this._dict[name];\n\n    if (!value) {\n      value = this._dict[name] = [];\n    }\n\n    if (value[0] !== param0 || value[1] !== param1) {\n      value[0] = param0;\n      value[1] = param1;\n      this.gl[name](param0, param1);\n    }\n  },\n\n  /**\n   * 调 gl 3参数方法\n   * @private\n   * @param  {String} name  方法名\n   * @param  {Number|Object} param0 方法参数\n   * @param  {Number|Object} param1 方法参数\n   * @param  {Number|Object} param2 方法参数\n   */\n  set3: function set3(name, param0, param1, param2) {\n    var value = this._dict[name];\n\n    if (!value) {\n      value = this._dict[name] = [];\n    }\n\n    if (value[0] !== param0 || value[1] !== param1 || value[2] !== param2) {\n      value[0] = param0;\n      value[1] = param1;\n      value[2] = param2;\n      this.gl[name](param0, param1, param2);\n    }\n  },\n\n  /**\n   * 调 gl 4参数方法\n   * @private\n   * @param  {String} name  方法名\n   * @param  {Number|Object} param0 方法参数\n   * @param  {Number|Object} param1 方法参数\n   * @param  {Number|Object} param2 方法参数\n   * @param  {Number|Object} param3 方法参数\n   */\n  set4: function set4(name, param0, param1, param2, param3) {\n    var value = this._dict[name];\n\n    if (!value) {\n      value = this._dict[name] = [];\n    }\n\n    if (value[0] !== param0 || value[1] !== param1 || value[2] !== param2 || value[3] !== param3) {\n      value[0] = param0;\n      value[1] = param1;\n      value[2] = param2;\n      value[3] = param3;\n      this.gl[name](param0, param1, param2, param3);\n    }\n  },\n  get: function get(name) {\n    return this._dict[name];\n  }\n});\n/* harmony default export */ var renderer_WebGLState = (WebGLState);\n// CONCATENATED MODULE: ./src/renderer/WebGLResourceManager.js\n\n\n/**\n * WebGLResourceManager 资源管理器\n * @mixes EventMixin\n * @fires destroyResource 销毁资源\n * @class\n */\n\nvar WebGLResourceManager = core_Class.create(\n/** @lends WebGLResourceManager.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * 类名\n   * @type {String}\n   * @default WebGLResourceManager\n   */\n  className: 'WebGLResourceManager',\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  isWebGLResourceManager: true,\n\n  /**\n   * 是否有需要销毁的资源\n   * @type {Boolean}\n   * @default false\n   */\n  hasNeedDestroyResource: false,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    this._needDestroyResources = [];\n    Object.assign(this, params);\n  },\n  destroyMesh: function destroyMesh(mesh) {\n    var _this = this;\n\n    var resources = this.getMeshResources(mesh);\n    resources.forEach(function (resource) {\n      _this.destroyIfNoRef(resource);\n    });\n    mesh._vao = mesh._program = mesh._shader = null;\n  },\n  getMeshResources: function getMeshResources(mesh) {\n    var resources = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n\n    if (mesh._shader) {\n      resources.push(mesh._shader);\n    }\n\n    if (mesh._vao) {\n      resources.push(mesh._vao);\n\n      mesh._vao.getResources(resources);\n    }\n\n    if (mesh._program) {\n      resources.push(mesh._program);\n    }\n\n    return resources;\n  },\n\n  /**\n   * 没有引用时销毁资源\n   * @param  {Object} res\n   * @return {WebGLResourceManager} this\n   */\n  destroyIfNoRef: function destroyIfNoRef(res) {\n    var _needDestroyResources = this._needDestroyResources;\n\n    if (res && _needDestroyResources.indexOf(res) < 0) {\n      _needDestroyResources.push(res);\n    }\n\n    return this;\n  },\n\n  /**\n   * 获取 rootNode 用到的资源\n   * @param  {Node} [rootNode] 根节点，不传返回空数组\n   * @return {Object[]}\n   */\n  getUsedResources: function getUsedResources(rootNode) {\n    var _this2 = this;\n\n    var resources = [];\n\n    if (rootNode) {\n      rootNode.traverse(function (node) {\n        if (node.isMesh && !node.isDestroyed) {\n          _this2.getMeshResources(node, resources);\n        }\n      });\n    }\n\n    return resources;\n  },\n\n  /**\n   * 销毁没被 rootNode 使用的资源，通常传 stage。\n   * @param {Node} [rootNode] 根节点，不传代表所有资源都没被使用过。\n   * @return {WebGLResourceManager} this\n   */\n  destroyUnsuedResource: function destroyUnsuedResource(rootNode) {\n    var _this3 = this;\n\n    var needDestroyResources = this._needDestroyResources;\n\n    if (needDestroyResources.length === 0) {\n      return this;\n    }\n\n    var usedResources = this.getUsedResources(rootNode);\n    needDestroyResources.forEach(function (resource) {\n      if (usedResources.indexOf(resource) < 0) {\n        if (resource && resource.destroy && !resource.alwaysUse) {\n          _this3.fire('destroyResource', resource.id);\n\n          resource.destroy();\n        }\n      }\n    });\n    this.reset();\n    return this;\n  },\n\n  /**\n   * 重置\n   * @return {WebGLResourceManager} this\n   */\n  reset: function reset() {\n    this._needDestroyResources.length = 0;\n    return this;\n  }\n});\n/* harmony default export */ var renderer_WebGLResourceManager = (WebGLResourceManager);\n// CONCATENATED MODULE: ./src/light/LightManager.js\n\n\n\n\n\nvar LightManager_tempMatrix4 = new math_Matrix4();\nvar LightManager_tempVector3 = new math_Vector3();\nvar LightManager_tempFloat32Array = new Float32Array([0, 0, 0]);\n/**\n * 光管理类\n * @class\n */\n\nvar LightManager = core_Class.create(\n/** @lends LightManager.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isLightManager: true,\n\n  /**\n   * @default DirectionalLight\n   * @type {string}\n   */\n  className: 'LightManager',\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    this.ambientLights = [];\n    this.directionalLights = [];\n    this.pointLights = [];\n    this.spotLights = [];\n    this.areaLights = [];\n    this.lightInfo = {\n      AMBIENT_LIGHTS: 0,\n      POINT_LIGHTS: 0,\n      DIRECTIONAL_LIGHTS: 0,\n      SPOT_LIGHTS: 0,\n      AREA_LIGHTS: 0,\n      uid: 0\n    };\n    Object.assign(this, params);\n  },\n  getRenderOption: function getRenderOption() {\n    var _this = this;\n\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    util_each(this.lightInfo, function (count, name) {\n      if (name === 'uid' || !count) {\n        return;\n      }\n\n      option[name] = count;\n\n      var shadowMapCount = _this.getShadowMapCount(name);\n\n      if (shadowMapCount) {\n        option[name + '_SMC'] = shadowMapCount;\n      }\n    });\n    return option;\n  },\n\n  /**\n   * 增加光\n   * @param {Light} light 光源\n   * @return {LightManager} this\n   */\n  addLight: function addLight(light) {\n    var lights = null;\n\n    if (!light.enabled) {\n      return this;\n    }\n\n    if (light.isAmbientLight) {\n      lights = this.ambientLights;\n    } else if (light.isDirectionalLight) {\n      lights = this.directionalLights;\n    } else if (light.isPointLight) {\n      lights = this.pointLights;\n    } else if (light.isSpotLight) {\n      lights = this.spotLights;\n    } else if (light.isAreaLight) {\n      lights = this.areaLights;\n    } else {\n      utils_log.warnOnce(\"LightManager.addLight(\".concat(light.id, \")\"), 'Not support this light:', light);\n    }\n\n    if (lights) {\n      if (light.shadow) {\n        lights.unshift(light);\n      } else {\n        lights.push(light);\n      }\n    }\n\n    return this;\n  },\n\n  /**\n   * 获取方向光信息\n   * @param  {Camera} camera 摄像机\n   * @return {Object}\n   */\n  getDirectionalInfo: function getDirectionalInfo(camera) {\n    var colors = [];\n    var infos = [];\n    var shadowMap = [];\n    var shadowMapSize = [];\n    var lightSpaceMatrix = [];\n    var shadowBias = [];\n    this.directionalLights.forEach(function (light, index) {\n      var offset = index * 3;\n      light.getRealColor().toRGBArray(colors, offset);\n      light.getViewDirection(camera).toArray(infos, offset);\n\n      if (light.shadow && light.lightShadow) {\n        shadowMap.push(light.lightShadow.framebuffer.texture);\n        shadowMapSize.push(light.lightShadow.width);\n        shadowMapSize.push(light.lightShadow.height);\n        shadowBias.push(light.lightShadow.minBias, light.lightShadow.maxBias);\n        LightManager_tempMatrix4.copy(camera.worldMatrix);\n        LightManager_tempMatrix4.premultiply(light.lightShadow.camera.viewProjectionMatrix);\n        LightManager_tempMatrix4.toArray(lightSpaceMatrix, index * 16);\n      }\n    });\n    var result = {\n      colors: new Float32Array(colors),\n      infos: new Float32Array(infos)\n    };\n\n    if (shadowMap.length) {\n      result.shadowMap = shadowMap;\n      result.shadowMapSize = new Float32Array(shadowMapSize);\n      result.shadowBias = new Float32Array(shadowBias);\n      result.lightSpaceMatrix = new Float32Array(lightSpaceMatrix);\n    }\n\n    return result;\n  },\n\n  /**\n   * 获取聚光灯信息\n   * @param {Camera} camera 摄像机\n   * @return {Object}\n   */\n  getSpotInfo: function getSpotInfo(camera) {\n    var colors = [];\n    var infos = [];\n    var poses = [];\n    var dirs = [];\n    var cutoffs = [];\n    var shadowMap = [];\n    var shadowMapSize = [];\n    var lightSpaceMatrix = [];\n    var shadowBias = [];\n    var ranges = [];\n    this.spotLights.forEach(function (light, index) {\n      var offset = index * 3;\n      light.getRealColor().toRGBArray(colors, offset);\n      light.toInfoArray(infos, offset);\n      light.getViewDirection(camera).toArray(dirs, offset);\n      ranges.push(light.range);\n      cutoffs.push(light._cutoffCos, light._outerCutoffCos);\n      camera.getModelViewMatrix(light, LightManager_tempMatrix4);\n      LightManager_tempMatrix4.getTranslation(LightManager_tempVector3);\n      LightManager_tempVector3.toArray(poses, offset);\n\n      if (light.shadow && light.lightShadow) {\n        shadowMap.push(light.lightShadow.framebuffer.texture);\n        shadowMapSize.push(light.lightShadow.width);\n        shadowMapSize.push(light.lightShadow.height);\n        shadowBias.push(light.lightShadow.minBias, light.lightShadow.maxBias);\n        LightManager_tempMatrix4.multiply(light.lightShadow.camera.viewProjectionMatrix, camera.worldMatrix);\n        LightManager_tempMatrix4.toArray(lightSpaceMatrix, index * 16);\n      }\n    });\n    var result = {\n      colors: new Float32Array(colors),\n      infos: new Float32Array(infos),\n      poses: new Float32Array(poses),\n      dirs: new Float32Array(dirs),\n      cutoffs: new Float32Array(cutoffs),\n      ranges: new Float32Array(ranges)\n    };\n\n    if (shadowMap.length) {\n      result.shadowMap = shadowMap;\n      result.shadowMapSize = new Float32Array(shadowMapSize);\n      result.shadowBias = new Float32Array(shadowBias);\n      result.lightSpaceMatrix = new Float32Array(lightSpaceMatrix);\n    }\n\n    return result;\n  },\n\n  /**\n   * 获取点光源信息\n   * @param  {Camera} camera 摄像机\n   * @return {Object}\n   */\n  getPointInfo: function getPointInfo(camera) {\n    var colors = [];\n    var infos = [];\n    var poses = [];\n    var shadowMap = [];\n    var lightSpaceMatrix = [];\n    var shadowBias = [];\n    var cameras = [];\n    var ranges = [];\n    this.pointLights.forEach(function (light, index) {\n      var offset = index * 3;\n      light.getRealColor().toRGBArray(colors, offset);\n      light.toInfoArray(infos, offset);\n      ranges.push(light.range);\n      camera.getModelViewMatrix(light, LightManager_tempMatrix4);\n      LightManager_tempMatrix4.getTranslation(LightManager_tempVector3);\n      LightManager_tempVector3.toArray(poses, offset);\n\n      if (light.shadow && light.lightShadow) {\n        shadowMap.push(light.lightShadow.framebuffer.texture);\n        shadowBias.push(light.lightShadow.minBias, light.lightShadow.maxBias);\n        camera.worldMatrix.toArray(lightSpaceMatrix, index * 16);\n        cameras[index * 2] = light.lightShadow.camera.near;\n        cameras[index * 2 + 1] = light.lightShadow.camera.far;\n      }\n    });\n    var result = {\n      colors: new Float32Array(colors),\n      infos: new Float32Array(infos),\n      poses: new Float32Array(poses),\n      ranges: new Float32Array(ranges)\n    };\n\n    if (shadowMap.length) {\n      result.shadowMap = shadowMap;\n      result.shadowBias = new Float32Array(shadowBias);\n      result.lightSpaceMatrix = new Float32Array(lightSpaceMatrix);\n      result.cameras = new Float32Array(cameras);\n    }\n\n    return result;\n  },\n\n  /**\n   * 获取面光源信息\n   * @param  {Camera} camera 摄像机\n   * @return {Object}\n   */\n  getAreaInfo: function getAreaInfo(camera) {\n    var colors = [];\n    var poses = [];\n    var width = [];\n    var height = [];\n    var ltcTexture1;\n    var ltcTexture2;\n    this.areaLights.forEach(function (light, index) {\n      var offset = index * 3;\n      light.getRealColor().toRGBArray(colors, offset);\n      camera.getModelViewMatrix(light, LightManager_tempMatrix4);\n      LightManager_tempMatrix4.getTranslation(LightManager_tempVector3);\n      LightManager_tempVector3.toArray(poses, offset);\n      var quat = LightManager_tempMatrix4.getRotation();\n      LightManager_tempMatrix4.fromQuat(quat);\n      LightManager_tempVector3.set(light.width * 0.5, 0, 0);\n      LightManager_tempVector3.transformMat4(LightManager_tempMatrix4);\n      LightManager_tempVector3.toArray(width, offset);\n      LightManager_tempVector3.set(0.0, light.height * 0.5, 0.0);\n      LightManager_tempVector3.transformMat4(LightManager_tempMatrix4);\n      LightManager_tempVector3.toArray(height, offset);\n      ltcTexture1 = light.ltcTexture1;\n      ltcTexture2 = light.ltcTexture2;\n    });\n    var result = {\n      colors: new Float32Array(colors),\n      poses: new Float32Array(poses),\n      width: new Float32Array(width),\n      height: new Float32Array(height),\n      ltcTexture1: ltcTexture1,\n      ltcTexture2: ltcTexture2\n    };\n    return result;\n  },\n\n  /**\n   * 获取环境光信息\n   * @return {Object}\n   */\n  getAmbientInfo: function getAmbientInfo() {\n    LightManager_tempFloat32Array[0] = LightManager_tempFloat32Array[1] = LightManager_tempFloat32Array[2] = 0;\n    this.ambientLights.forEach(function (light) {\n      var realColor = light.getRealColor();\n      LightManager_tempFloat32Array[0] += realColor.r;\n      LightManager_tempFloat32Array[1] += realColor.g;\n      LightManager_tempFloat32Array[2] += realColor.b;\n    });\n    LightManager_tempFloat32Array[0] = Math.min(1, LightManager_tempFloat32Array[0]);\n    LightManager_tempFloat32Array[1] = Math.min(1, LightManager_tempFloat32Array[1]);\n    LightManager_tempFloat32Array[2] = Math.min(1, LightManager_tempFloat32Array[2]);\n    return LightManager_tempFloat32Array;\n  },\n\n  /**\n   * 更新所有光源信息\n   * @param  {Camera} camera 摄像机\n   */\n  updateInfo: function updateInfo(camera) {\n    var lightInfo = this.lightInfo,\n        ambientLights = this.ambientLights,\n        directionalLights = this.directionalLights,\n        pointLights = this.pointLights,\n        spotLights = this.spotLights,\n        areaLights = this.areaLights;\n    lightInfo.AMBIENT_LIGHTS = ambientLights.length;\n    lightInfo.POINT_LIGHTS = pointLights.length;\n    lightInfo.DIRECTIONAL_LIGHTS = directionalLights.length;\n    lightInfo.SPOT_LIGHTS = spotLights.length;\n    lightInfo.AREA_LIGHTS = areaLights.length;\n\n    var shadowFilter = function shadowFilter(light) {\n      return !!light.shadow;\n    };\n\n    lightInfo.SHADOW_POINT_LIGHTS = pointLights.filter(shadowFilter).length;\n    lightInfo.SHADOW_SPOT_LIGHTS = spotLights.filter(shadowFilter).length;\n    lightInfo.SHADOW_DIRECTIONAL_LIGHTS = directionalLights.filter(shadowFilter).length;\n    lightInfo.uid = [lightInfo.AMBIENT_LIGHTS, lightInfo.POINT_LIGHTS, lightInfo.SHADOW_POINT_LIGHTS, lightInfo.DIRECTIONAL_LIGHTS, lightInfo.SHADOW_DIRECTIONAL_LIGHTS, lightInfo.SPOT_LIGHTS, lightInfo.SHADOW_SPOT_LIGHTS, lightInfo.AREA_LIGHTS].join('_');\n    this.directionalInfo = this.getDirectionalInfo(camera);\n    this.pointInfo = this.getPointInfo(camera);\n    this.spotInfo = this.getSpotInfo(camera);\n    this.areaInfo = this.getAreaInfo(camera);\n    this.ambientInfo = this.getAmbientInfo();\n  },\n\n  /**\n   * 获取光源信息\n   * @return {Object}\n   */\n  getInfo: function getInfo() {\n    return this.lightInfo;\n  },\n\n  /**\n   * 重置所有光源\n   */\n  reset: function reset() {\n    this.ambientLights.length = 0;\n    this.directionalLights.length = 0;\n    this.pointLights.length = 0;\n    this.spotLights.length = 0;\n    this.areaLights.length = 0;\n  },\n  getShadowMapCount: function getShadowMapCount(type) {\n    var lights = [];\n\n    if (type === 'POINT_LIGHTS') {\n      lights = this.pointLights;\n    } else if (type === 'DIRECTIONAL_LIGHTS') {\n      lights = this.directionalLights;\n    } else if (type === 'SPOT_LIGHTS') {\n      lights = this.spotLights;\n    } else if (type === 'AREA_LIGHTS') {\n      lights = this.spotLights;\n    }\n\n    var count = 0;\n    lights.forEach(function (light) {\n      count += light.shadow ? 1 : 0;\n    });\n    return count;\n  },\n  createShadowMap: function createShadowMap(renderer, camera) {\n    this.directionalLights.forEach(function (light) {\n      light.createShadowMap(renderer, camera);\n    });\n    this.spotLights.forEach(function (light) {\n      light.createShadowMap(renderer, camera);\n    });\n    this.pointLights.forEach(function (light) {\n      light.createShadowMap(renderer, camera);\n    });\n    this.areaLights.forEach(function (light) {\n      light.createShadowMap(renderer, camera);\n    });\n  }\n});\n/* harmony default export */ var light_LightManager = (LightManager);\n// CONCATENATED MODULE: ./src/renderer/WebGLRenderer.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar WebGLRenderer_DEPTH_TEST = src_constants.DEPTH_TEST,\n    SAMPLE_ALPHA_TO_COVERAGE = src_constants.SAMPLE_ALPHA_TO_COVERAGE,\n    WebGLRenderer_CULL_FACE = src_constants.CULL_FACE,\n    WebGLRenderer_FRONT_AND_BACK = src_constants.FRONT_AND_BACK,\n    BLEND = src_constants.BLEND,\n    WebGLRenderer_LINES = src_constants.LINES,\n    WebGLRenderer_STATIC_DRAW = src_constants.STATIC_DRAW,\n    DYNAMIC_DRAW = src_constants.DYNAMIC_DRAW;\n/**\n * WebGL渲染器\n * @class\n * @fires init 初始化事件\n * @fires beforeRender 渲染前事件\n * @fires beforeRenderScene 渲染场景前事件\n * @fires afterRender 渲染后事件\n * @fires initFailed 初始化失败事件\n * @fires webglContextLost webglContextLost 事件\n * @fires webglContextRestored webglContextRestored 事件\n * @mixes EventMixin\n */\n\nvar WebGLRenderer = core_Class.create(\n/** @lends WebGLRenderer.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * @default WebGLRenderer\n   * @type {String}\n   */\n  className: 'WebGLRenderer',\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isWebGLRenderer: true,\n\n  /**\n   * gl\n   * @default null\n   * @type {WebGLRenderingContext}\n   */\n  gl: null,\n\n  /**\n   * 宽\n   * @type {Number}\n   * @default 0\n   */\n  width: 0,\n\n  /**\n   * 高\n   * @type {Number}\n   * @default 0\n   */\n  height: 0,\n\n  /**\n   * 像素密度\n   * @type {Number}\n   * @default 1\n   */\n  pixelRatio: 1,\n\n  /**\n   * dom元素\n   * @type {HTMLCanvasElement}\n   * @default null\n   */\n  domElement: null,\n\n  /**\n   * 是否使用instanced\n   * @type {Boolean}\n   * @default false\n   */\n  useInstanced: false,\n\n  /**\n   * 是否使用VAO\n   * @type {Boolean}\n   * @default true\n   */\n  useVao: true,\n\n  /**\n   * 是否开启透明背景\n   * @type {Boolean}\n   * @default false\n   */\n  alpha: false,\n\n  /**\n   * @type {Boolean}\n   * @default true\n   */\n  depth: true,\n\n  /**\n   * @type {Boolean}\n   * @default false\n   */\n  stencil: false,\n\n  /**\n   * 是否开启抗锯齿\n   * @type {Boolean}\n   * @default true\n   */\n  antialias: true,\n\n  /**\n   * Boolean that indicates that the page compositor will assume the drawing buffer contains colors with pre-multiplied alpha.\n   * @type {Boolean}\n   * @default true\n   */\n  premultipliedAlpha: true,\n\n  /**\n   * If the value is true the buffers will not be cleared and will preserve their values until cleared or overwritten by the author.\n   * @type {Boolean}\n   * @default false\n   */\n  preserveDrawingBuffer: false,\n\n  /**\n   * Boolean that indicates if a context will be created if the system performance is low.\n   * @type {Boolean}\n   * @default false\n   */\n  failIfMajorPerformanceCaveat: false,\n\n  /**\n   * 游戏模式, UC浏览器专用\n   * @default false\n   * @type {Boolean}\n   */\n  gameMode: false,\n\n  /**\n   * 是否使用framebuffer\n   * @type {Boolean}\n   * @default false\n   */\n  useFramebuffer: false,\n\n  /**\n   * framebuffer配置\n   * @type {Object}\n   * @default {}\n   */\n  framebufferOption: {},\n\n  /**\n   * 是否使用对数深度\n   * @type {Boolean}\n   * @default false\n   */\n  useLogDepth: false,\n\n  /**\n   * 顶点着色器精度, 可以是以下值：highp, mediump, lowp\n   * @type {String}\n   * @default highp\n   */\n  vertexPrecision: 'highp',\n\n  /**\n   * 片段着色器精度, 可以是以下值：highp, mediump, lowp\n   * @type {String}\n   * @default mediump\n   */\n  fragmentPrecision: 'highp',\n\n  /**\n   * 雾\n   * @type {Fog}\n   * @default null\n   */\n  fog: null,\n\n  /**\n   * 偏移值\n   * @type {Number}\n   * @default 0\n   */\n  offsetX: 0,\n\n  /**\n   * 偏移值\n   * @type {Number}\n   * @default 0\n   */\n  offsetY: 0,\n\n  /**\n   * 是否初始化失败\n   * @default false\n   * @type {Boolean}\n   */\n  isInitFailed: false,\n\n  /**\n   * 是否初始化\n   * @type {Boolean}\n   * @default false\n   * @private\n   */\n  _isInit: false,\n\n  /**\n   * 是否lost context\n   * @type {Boolean}\n   * @default false\n   * @private\n   */\n  _isContextLost: false,\n\n  /**\n   * @constructs\n   * @param  {Object} [params] 初始化参数，所有params都会复制到实例上\n   */\n  constructor: function constructor(params) {\n    /**\n     * 背景色\n     * @type {Color}\n     * @default new Color(1, 1, 1, 1)\n     */\n    this.clearColor = new math_Color(1, 1, 1);\n    Object.assign(this, params);\n    /**\n     * 渲染信息\n     * @type {RenderInfo}\n     * @default new RenderInfo\n     */\n\n    this.renderInfo = new renderer_RenderInfo();\n    /**\n     * 渲染列表\n     * @type {RenderList}\n     * @default new RenderList\n     */\n\n    this.renderList = new renderer_RenderList();\n    /**\n     * 灯光管理器\n     * @type {LightManager}\n     * @default new LightManager\n     */\n\n    this.lightManager = new light_LightManager();\n    /**\n     * 资源管理器\n     * @type {WebGLResourceManager}\n     * @default new WebGLResourceManager\n     */\n\n    this.resourceManager = new renderer_WebGLResourceManager();\n  },\n\n  /**\n   * 改变大小\n   * @param  {Number} width  宽\n   * @param  {Number} height  高\n   * @param  {Boolean} [force=false] 是否强制刷新\n   */\n  resize: function resize(width, height, force) {\n    if (force || this.width !== width || this.height !== height) {\n      var canvas = this.domElement;\n      this.width = width;\n      this.height = height;\n      canvas.width = width;\n      canvas.height = height;\n\n      if (this.framebuffer) {\n        this.framebuffer.resize(this.width, this.height, force);\n      }\n\n      this.viewport();\n    }\n  },\n\n  /**\n   * 设置viewport偏移值\n   * @param {Number} x x\n   * @param {Number} y y\n   */\n  setOffset: function setOffset(x, y) {\n    if (this.offsetX !== x || this.offsetY !== y) {\n      this.offsetX = x;\n      this.offsetY = y;\n      this.viewport();\n    }\n  },\n\n  /**\n   * 设置viewport\n   * @param  {Number} [x=this.offsetX]  x\n   * @param  {Number} [y=this.offsetY] y\n   * @param  {Number} [width=this.gl.drawingBufferWidth]  width\n   * @param  {Number} [height=this.gl.drawingBufferHeight]  height\n   */\n  viewport: function viewport(x, y, width, height) {\n    var state = this.state,\n        gl = this.gl;\n\n    if (state) {\n      if (x === undefined) {\n        x = this.offsetX;\n      } else {\n        this.offsetX = x;\n      }\n\n      if (y === undefined) {\n        y = this.offsetY;\n      } else {\n        this.offsetY = y;\n      }\n\n      if (width === undefined) {\n        width = gl.drawingBufferWidth;\n      }\n\n      if (height === undefined) {\n        height = gl.drawingBufferHeight;\n      }\n\n      state.viewport(x, y, width, height);\n    }\n  },\n\n  /**\n   * 是否初始化\n   * @type {Boolean}\n   * @default false\n   * @readOnly\n   */\n  isInit: {\n    get: function get() {\n      return this._isInit && !this.isInitFailed;\n    }\n  },\n\n  /**\n   * 初始化回调\n   * @return {WebGLRenderer} this\n   */\n  onInit: function onInit(callback) {\n    var _this = this;\n\n    if (this._isInit) {\n      callback(this);\n    } else {\n      this.on('init', function () {\n        callback(_this);\n      }, true);\n    }\n  },\n\n  /**\n   * 初始化 context\n   */\n  initContext: function initContext() {\n    if (!this._isInit) {\n      this._isInit = true;\n\n      try {\n        this._initContext();\n\n        this.fire('init');\n      } catch (e) {\n        this.isInitFailed = true;\n        this.fire('initFailed', e);\n      }\n    }\n  },\n  _initContext: function _initContext() {\n    var _this2 = this;\n\n    var contextAttributes = {\n      alpha: this.alpha,\n      depth: this.depth,\n      stencil: this.stencil,\n      antialias: this.antialias,\n      premultipliedAlpha: this.premultipliedAlpha,\n      failIfMajorPerformanceCaveat: this.failIfMajorPerformanceCaveat\n    }; // fix ios bug...\n\n    if (this.preserveDrawingBuffer === true) {\n      contextAttributes.preserveDrawingBuffer = true;\n    }\n\n    if (this.gameMode === true) {\n      contextAttributes.gameMode = true;\n    }\n\n    var gl = this.gl = this.domElement.getContext('webgl', contextAttributes);\n    gl.viewport(0, 0, this.width, this.height);\n    renderer_glType.init(gl);\n    renderer_extensions.init(gl);\n    renderer_capabilities.init(gl);\n    shader_Shader.init(this);\n    /**\n     * state，初始化后生成。\n     * @type {WebGLState}\n     * @default null\n     */\n\n    this.state = new renderer_WebGLState(gl);\n\n    if (!renderer_extensions.instanced) {\n      this.useInstanced = false;\n    }\n\n    if (!renderer_extensions.vao) {\n      this.useVao = false;\n    }\n\n    if (this.useFramebuffer) {\n      /**\n       * framebuffer，只在 useFramebuffer 为 true 时初始化后生成\n       * @type {Framebuffer}\n       * @default null\n       */\n      this.framebuffer = new renderer_Framebuffer(this, Object.assign({\n        useVao: this.useVao,\n        width: this.width,\n        height: this.height\n      }, this.framebufferOption));\n    }\n\n    this.domElement.addEventListener('webglcontextlost', function (e) {\n      _this2._onContextLost(e);\n    }, false);\n    this.domElement.addEventListener('webglcontextrestored', function (e) {\n      _this2._onContextRestore(e);\n    }, false);\n  },\n  _onContextLost: function _onContextLost(e) {\n    this.fire('webglContextLost');\n    var gl = this.gl;\n    this._isContextLost = true;\n    e.preventDefault();\n    renderer_Program.reset(gl);\n    shader_Shader.reset(gl);\n    texture_Texture.reset(gl);\n    renderer_Buffer.reset(gl);\n    renderer_VertexArrayObject.reset(gl);\n    this.state.reset(gl);\n    this._lastMaterial = null;\n    this._lastProgram = null;\n  },\n  _onContextRestore: function _onContextRestore(e) {\n    // eslint-disable-line no-unused-vars\n    this.fire('webglContextRestored');\n    var gl = this.gl;\n    this._isContextLost = false;\n    renderer_extensions.reset(gl);\n    renderer_Framebuffer.reset(gl);\n  },\n\n  /**\n   * 设置深度检测\n   * @param  {Material} material\n   */\n  setupDepthTest: function setupDepthTest(material) {\n    var state = this.state;\n\n    if (material.depthTest) {\n      state.enable(WebGLRenderer_DEPTH_TEST);\n      state.depthFunc(material.depthFunc);\n      state.depthMask(material.depthMask);\n      state.depthRange(material.depthRange[0], material.depthRange[1]);\n    } else {\n      state.disable(WebGLRenderer_DEPTH_TEST);\n    }\n  },\n\n  /**\n   * 设置alphaToCoverage\n   * @param  {Material} material\n   */\n  setupSampleAlphaToCoverage: function setupSampleAlphaToCoverage(material) {\n    var state = this.state;\n\n    if (material.sampleAlphaToCoverage) {\n      state.enable(SAMPLE_ALPHA_TO_COVERAGE);\n    } else {\n      state.disable(SAMPLE_ALPHA_TO_COVERAGE);\n    }\n  },\n\n  /**\n   * 设置背面剔除\n   * @param  {Material} material\n   */\n  setupCullFace: function setupCullFace(material) {\n    var state = this.state;\n\n    if (material.cullFace && material.cullFaceType !== WebGLRenderer_FRONT_AND_BACK) {\n      state.enable(WebGLRenderer_CULL_FACE);\n      state.cullFace(material.cullFaceType);\n    } else {\n      state.disable(WebGLRenderer_CULL_FACE);\n    }\n  },\n\n  /**\n   * 设置混合\n   * @param  {Material} material\n   */\n  setupBlend: function setupBlend(material) {\n    var state = this.state;\n\n    if (material.blend) {\n      state.enable(BLEND);\n      state.blendFuncSeparate(material.blendSrc, material.blendDst, material.blendSrcAlpha, material.blendDstAlpha);\n      state.blendEquationSeparate(material.blendEquation, material.blendEquationAlpha);\n    } else {\n      state.disable(BLEND);\n    }\n  },\n\n  /**\n   * 设置通用的 uniform\n   * @param  {Program} program\n   * @param  {Mesh} mesh\n   * @param  {Boolean} [force=false] 是否强制更新\n   */\n  setupUniforms: function setupUniforms(program, mesh, useInstanced, force) {\n    var material = this.forceMaterial || mesh.material;\n\n    for (var name in program.uniforms) {\n      var uniformInfo = material.getUniformInfo(name);\n      var programUniformInfo = program.uniforms[name];\n\n      if (!uniformInfo.isBlankInfo) {\n        if (force || uniformInfo.isDependMesh && !useInstanced) {\n          var uniformData = uniformInfo.get(mesh, material, programUniformInfo);\n\n          if (uniformData !== undefined && uniformData !== null) {\n            program[name] = uniformData;\n          }\n        }\n      }\n    }\n  },\n\n  /**\n   * 设置vao\n   * @param  {VertexArrayObject} vao\n   * @param  {Program} program\n   * @param  {Mesh} mesh\n   */\n  setupVao: function setupVao(vao, program, mesh) {\n    var geometry = mesh.geometry;\n    var isStatic = geometry.isStatic;\n\n    if (vao.isDirty || !isStatic || geometry.isDirty) {\n      vao.isDirty = false;\n      var material = this.forceMaterial || mesh.material;\n      var materialAttributes = material.attributes;\n      var usage = isStatic ? WebGLRenderer_STATIC_DRAW : DYNAMIC_DRAW;\n\n      for (var name in materialAttributes) {\n        var programAttribute = program.attributes[name];\n\n        if (programAttribute) {\n          var data = material.getAttributeData(name, mesh, programAttribute);\n\n          if (data !== undefined && data !== null) {\n            vao.addAttribute(data, programAttribute, usage);\n          }\n        }\n      }\n\n      if (geometry.indices) {\n        vao.addIndexBuffer(geometry.indices, usage);\n      }\n\n      geometry.isDirty = false;\n    }\n\n    if (geometry.vertexCount) {\n      vao.vertexCount = geometry.vertexCount;\n    }\n  },\n\n  /**\n   * 设置材质\n   * @param  {Program} program\n   * @param  {Mesh} mesh\n   */\n  setupMaterial: function setupMaterial(program, mesh, useInstanced) {\n    var needForceUpdateUniforms = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : false;\n    var material = this.forceMaterial || mesh.material;\n\n    if (material.isDirty || this._lastMaterial !== material) {\n      this.setupDepthTest(material);\n      this.setupSampleAlphaToCoverage(material);\n      this.setupCullFace(material);\n      this.setupBlend(material);\n      needForceUpdateUniforms = true;\n    }\n\n    this.setupUniforms(program, mesh, useInstanced, needForceUpdateUniforms);\n    material.isDirty = false;\n    this._lastMaterial = material;\n  },\n\n  /**\n   * 设置mesh\n   * @param  {Mesh} mesh\n   * @param  {Boolean} useInstanced\n   * @return {Object} res\n   * @return {VertexArrayObject} res.vao\n   * @return {Program} res.program\n   * @return {Geometry} res.geometry\n   */\n  setupMesh: function setupMesh(mesh, useInstanced) {\n    var gl = this.gl;\n    var state = this.state;\n    var lightManager = this.lightManager;\n    var geometry = mesh.geometry;\n    var material = this.forceMaterial || mesh.material;\n    var shader = shader_Shader.getShader(mesh, material, useInstanced, lightManager, this.fog, this.useLogDepth);\n    var program = renderer_Program.getProgram(shader, state);\n    program.useProgram();\n    this.setupMaterial(program, mesh, useInstanced, this._lastProgram !== program);\n    this._lastProgram = program;\n\n    if (mesh.material.wireframe && geometry.mode !== WebGLRenderer_LINES) {\n      geometry.convertToLinesMode();\n    }\n\n    var vaoId = geometry.id + program.id;\n    var vao = renderer_VertexArrayObject.getVao(gl, vaoId, {\n      useInstanced: useInstanced,\n      useVao: this.useVao,\n      mode: geometry.mode\n    });\n    this.setupVao(vao, program, mesh);\n    mesh._vao = vao;\n    mesh._shader = shader;\n    mesh._program = program;\n    return {\n      vao: vao,\n      program: program,\n      geometry: geometry\n    };\n  },\n\n  /**\n   * 增加渲染信息\n   * @param {Number} faceCount 面数量\n   * @param {Number} drawCount 绘图数量\n   */\n  addRenderInfo: function addRenderInfo(faceCount, drawCount) {\n    var renderInfo = this.renderInfo;\n    renderInfo.addFaceCount(faceCount);\n    renderInfo.addDrawCount(drawCount);\n  },\n\n  /**\n   * 渲染\n   * @param  {Stage} stage\n   * @param  {Camera} camera\n   * @param  {Boolean} [fireEvent=false] 是否发送事件\n   */\n  render: function render(stage, camera) {\n    var fireEvent = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    this.initContext();\n\n    if (this.isInitFailed || this._isContextLost) {\n      return;\n    }\n\n    var renderList = this.renderList,\n        renderInfo = this.renderInfo,\n        lightManager = this.lightManager,\n        resourceManager = this.resourceManager,\n        state = this.state;\n    this.fog = stage.fog;\n    lightManager.reset();\n    renderInfo.reset();\n    renderList.reset();\n    material_semantic.init(this, state, camera, lightManager, this.fog);\n    stage.updateMatrixWorld();\n    camera.updateViewProjectionMatrix();\n    stage.traverse(function (node) {\n      if (!node.visible) {\n        return core_Node.TRAVERSE_STOP_CHILDREN;\n      }\n\n      if (node.isMesh) {\n        renderList.addMesh(node, camera);\n      } else if (node.isLight) {\n        lightManager.addLight(node);\n      }\n\n      return core_Node.TRAVERSE_STOP_NONE;\n    });\n    renderList.sort();\n    lightManager.createShadowMap(this, camera);\n    lightManager.updateInfo(camera);\n\n    if (fireEvent) {\n      this.fire('beforeRender');\n    }\n\n    if (this.useFramebuffer) {\n      this.framebuffer.bind();\n    }\n\n    this.clear();\n\n    if (fireEvent) {\n      this.fire('beforeRenderScene');\n    }\n\n    this.renderScene();\n\n    if (this.useFramebuffer) {\n      this.renderToScreen(this.framebuffer);\n    }\n\n    if (fireEvent) {\n      this.fire('afterRender');\n    }\n\n    resourceManager.destroyUnsuedResource(stage);\n  },\n\n  /**\n   * 渲染场景\n   */\n  renderScene: function renderScene() {\n    var _this3 = this;\n\n    var renderList = this.renderList;\n    renderList.traverse(function (mesh) {\n      _this3.renderMesh(mesh);\n    }, function (instancedMeshes) {\n      _this3.renderInstancedMeshes(instancedMeshes);\n    });\n\n    this._gameModeSumbit();\n  },\n  _gameModeSumbit: function _gameModeSumbit() {\n    var gl = this.gl;\n\n    if (this.gameMode && gl && gl.submit) {\n      gl.submit();\n    }\n  },\n\n  /**\n   * 清除背景\n   * @param  {Color} [clearColor=this.clearColor]\n   */\n  clear: function clear(clearColor) {\n    var gl = this.gl,\n        state = this.state;\n    clearColor = clearColor || this.clearColor;\n    state.depthMask(true);\n    this._lastMaterial = null;\n    this._lastProgram = null;\n    gl.clearColor(clearColor.r, clearColor.g, clearColor.b, clearColor.a);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n  },\n\n  /**\n   * 清除深度\n   */\n  clearDepth: function clearDepth() {\n    var gl = this.gl,\n        state = this.state;\n    state.depthMask(true);\n    gl.clear(gl.DEPTH_BUFFER_BIT);\n  },\n\n  /**\n   * 将framebuffer渲染到屏幕\n   * @param  {Framebuffer} framebuffer\n   */\n  renderToScreen: function renderToScreen(framebuffer) {\n    this.state.bindSystemFramebuffer();\n    framebuffer.render(0, 0, 1, 1, this.clearColor);\n  },\n\n  /**\n   * 渲染一个mesh\n   * @param  {Mesh} mesh\n   */\n  renderMesh: function renderMesh(mesh) {\n    var vao = this.setupMesh(mesh, false).vao;\n    vao.draw();\n    this.addRenderInfo(vao.vertexCount / 3, 1);\n  },\n\n  /**\n   * 渲染一组 instanced mesh\n   * @param  {Mesh[]} meshes\n   */\n  renderInstancedMeshes: function renderInstancedMeshes(meshes) {\n    var mesh = meshes[0];\n\n    if (!mesh) {\n      return;\n    }\n\n    var material = this.forceMaterial || mesh.material;\n\n    var _this$setupMesh = this.setupMesh(mesh, true),\n        vao = _this$setupMesh.vao,\n        program = _this$setupMesh.program;\n\n    var instancedUniforms = material.getInstancedUniforms();\n    instancedUniforms.forEach(function (uniformObj) {\n      var name = uniformObj.name;\n      var info = uniformObj.info;\n      var attribute = program.attributes[name];\n\n      if (attribute) {\n        vao.addInstancedAttribute(attribute, meshes, function (mesh) {\n          return info.get(mesh);\n        });\n      }\n    });\n    vao.drawInstance(meshes.length);\n    this.addRenderInfo(vao.vertexCount / 3 * meshes.length, 1);\n  },\n\n  /**\n   * 渲染一组普通mesh\n   * @param  {Mesh[]} meshes\n   */\n  renderMultipleMeshes: function renderMultipleMeshes(meshes) {\n    var _this4 = this;\n\n    meshes.forEach(function (mesh) {\n      _this4.renderMesh(mesh);\n    });\n  },\n\n  /**\n   * 销毁 WebGL 资源\n   */\n  releaseGLResource: function releaseGLResource() {\n    var gl = this.gl;\n\n    if (gl) {\n      renderer_Program.reset(gl);\n      shader_Shader.reset(gl);\n      renderer_Buffer.reset(gl);\n      renderer_VertexArrayObject.reset(gl);\n      this.state.reset(gl);\n      texture_Texture.reset(gl);\n      renderer_Framebuffer.destroy(gl);\n    }\n  }\n});\n/* harmony default export */ var renderer_WebGLRenderer = (WebGLRenderer);\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/util/browser.js\nvar browser = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/util/browser.js\");\nvar browser_default = /*#__PURE__*/__webpack_require__.n(browser);\n\n// CONCATENATED MODULE: ./src/utils/browser.js\n/**\n * 浏览器特性集合\n * @namespace\n * @see  {@link http://hiloteam.github.io/Hilo/docs/api-zh/symbols/browser.html}\n */\n\n/* harmony default export */ var utils_browser = (browser_default.a);\n// CONCATENATED MODULE: ./src/core/Stage.js\n\n\n\n\n\n\n\n\n\n/**\n * 舞台类\n * @class\n * @extends Node\n * @example\n * const stage = new Hilo3d.Stage({\n *     container:document.body,\n *     width:innerWidth,\n *     height:innerHeight\n * });\n */\n\nvar Stage = core_Class.create(\n/** @lends Stage.prototype */\n{\n  Extends: core_Node,\n  isStage: true,\n  className: 'Stage',\n\n  /**\n   * 渲染器\n   * @type {WebGLRenderer}\n   */\n  renderer: null,\n\n  /**\n   * 摄像机\n   * @type {Camera}\n   */\n  camera: null,\n\n  /**\n   * 像素密度\n   * @type {Number}\n   * @default 根据设备自动判断\n   */\n  pixelRatio: null,\n\n  /**\n   * 偏移值\n   * @type {Number}\n   * @default 0\n   */\n  offsetX: 0,\n\n  /**\n   * 偏移值\n   * @type {Number}\n   * @default 0\n   */\n  offsetY: 0,\n\n  /**\n   * canvas\n   * @type {HTMLCanvasElement}\n   * @default null\n   */\n  canvas: null,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性，所有属性会透传给 Renderer。\n   * @param {HTMLElement} [params.container] stage的容器, 如果有，会把canvas加进container里。\n   * @param {HTMLCanvasElement} [params.canvas] stage的canvas，不传会自动创建。\n   * @param {Camera} [params.camera] stage的摄像机。\n   * @param {number} [params.width=innerWidth] stage的宽，默认网页宽度\n   * @param {number} [params.height=innerHeight] stage的高，默认网页高度\n   * @param {number} [params.pixelRatio=根据设备自动判断] 像素密度。\n   * @param {Color} [params.clearColor=new Color(1, 1, 1, 1)] 背景色。\n   * @param {boolean} [params.useFramebuffer=false] 是否使用Framebuffer，有后处理需求时需要。\n   * @param {Object} [params.framebufferOption={}] framebufferOption Framebuffer的配置，useFramebuffer为true时生效。\n   * @param {boolean} [params.useLogDepth=false] 是否使用对数深度，处理深度冲突。\n   * @param {boolean} [params.alpha=false] 是否背景透明。\n   * @param {boolean} [params.depth=true] 是否需要深度缓冲区。\n   * @param {boolean} [params.stencil=false] 是否需要模版缓冲区。\n   * @param {boolean} [params.antialias=true] 是否抗锯齿。\n   * @param {boolean} [params.premultipliedAlpha=true] 是否需要 premultipliedAlpha。\n   * @param {boolean} [params.preserveDrawingBuffer=false] 是否需要 preserveDrawingBuffer。\n   * @param {boolean} [params.failIfMajorPerformanceCaveat=false] 是否需要 failIfMajorPerformanceCaveat。\n   * @param {boolean} [params.gameMode=false] 是否开启游戏模式，UC 浏览器专用\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    if (!params.width) {\n      params.width = window.innerWidth;\n    }\n\n    if (!params.height) {\n      params.height = window.innerHeight;\n    }\n\n    if (!params.pixelRatio) {\n      var pixelRatio = window.devicePixelRatio || 1;\n      pixelRatio = Math.min(pixelRatio, 1024 / Math.max(params.width, params.height), 2);\n      pixelRatio = Math.max(pixelRatio, 1);\n      params.pixelRatio = pixelRatio;\n    }\n\n    Stage.superclass.constructor.call(this, params);\n    this.initRenderer(params);\n    utils_log.log(\"Hilo3d version: \".concat(core_version));\n  },\n\n  /**\n   * 初始化渲染器\n   * @private\n   * @param  {Object} params\n   */\n  initRenderer: function initRenderer(params) {\n    var canvas = this.canvas = this.createCanvas(params);\n    this.renderer = new renderer_WebGLRenderer(Object.assign(params, {\n      domElement: canvas\n    }));\n    this.resize(this.width, this.height, this.pixelRatio, true);\n  },\n\n  /**\n   * 生成canvas\n   * @private\n   * @param  {Object} params\n   * @return {HTMLCanvasElement}\n   */\n  createCanvas: function createCanvas(params) {\n    var canvas;\n\n    if (params.canvas) {\n      canvas = params.canvas;\n    } else {\n      canvas = document.createElement('canvas');\n    }\n\n    if (params.container) {\n      params.container.appendChild(canvas);\n    }\n\n    return canvas;\n  },\n\n  /**\n   * 缩放舞台\n   * @param  {Number} width 舞台宽\n   * @param  {Number} height 舞台高\n   * @param  {Number} [pixelRatio=this.pixelRatio] 像素密度\n   * @param  {Boolean} [force=false] 是否强制刷新\n   * @return {Stage} 舞台本身。链式调用支持。\n   */\n  resize: function resize(width, height, pixelRatio, force) {\n    if (pixelRatio === undefined) {\n      pixelRatio = this.pixelRatio;\n    }\n\n    if (force || this.width !== width || this.height !== height || this.pixelRatio !== pixelRatio) {\n      this.width = width;\n      this.height = height;\n      this.pixelRatio = pixelRatio;\n      this.rendererWidth = width * pixelRatio;\n      this.rendererHeight = height * pixelRatio;\n      var canvas = this.canvas;\n      var renderer = this.renderer;\n      renderer.resize(this.rendererWidth, this.rendererHeight, force);\n      canvas.style.width = this.width + 'px';\n      canvas.style.height = this.height + 'px';\n      this.updateDomViewport();\n    }\n\n    return this;\n  },\n\n  /**\n   * 设置舞台偏移值\n   * @param {Number} x x\n   * @param {Number} y y\n   * @return {Stage} 舞台本身。链式调用支持。\n   */\n  setOffset: function setOffset(x, y) {\n    if (this.offsetX !== x || this.offsetY !== y) {\n      this.offsetX = x;\n      this.offsetY = y;\n      var pixelRatio = this.pixelRatio;\n      this.renderer.setOffset(x * pixelRatio, y * pixelRatio);\n    }\n\n    return this;\n  },\n\n  /**\n   * 改viewport\n   * @param  {Number} x      x\n   * @param  {Number} y      y\n   * @param  {Number} width  width\n   * @param  {Number} height height\n   * @return {Stage} 舞台本身。链式调用支持。\n   */\n  viewport: function viewport(x, y, width, height) {\n    this.resize(width, height, this.pixelRatio, true);\n    this.setOffset(x, y);\n    return this;\n  },\n\n  /**\n   * 渲染一帧\n   * @param  {Number} dt 间隔时间\n   * @return {Stage} 舞台本身。链式调用支持。\n   */\n  tick: function tick(dt) {\n    this.traverseUpdate(dt);\n\n    if (this.camera) {\n      this.renderer.render(this, this.camera, true);\n    }\n\n    return this;\n  },\n\n  /**\n   * 开启/关闭舞台的DOM事件响应。要让舞台上的可视对象响应用户交互，必须先使用此方法开启舞台的相应事件的响应。\n   * @param {String|Array} type 要开启/关闭的事件名称或数组。\n   * @param {Boolean} enabled 指定开启还是关闭。如果不传此参数，则默认为开启。\n   * @return {Stage} 舞台本身。链式调用支持。\n   */\n  enableDOMEvent: function enableDOMEvent(types) {\n    var _this = this;\n\n    var enabled = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n    var canvas = this.canvas;\n\n    var handler = this._domListener || (this._domListener = function (e) {\n      _this._onDOMEvent(e);\n    });\n\n    types = typeof types === 'string' ? [types] : types;\n    types.forEach(function (type) {\n      if (enabled) {\n        canvas.addEventListener(type, handler, false);\n      } else {\n        canvas.removeEventListener(type, handler);\n      }\n    });\n    return this;\n  },\n\n  /**\n   * DOM事件处理函数。此方法会把事件调度到事件的坐标点所对应的可视对象。\n   * @private\n   */\n  _onDOMEvent: function _onDOMEvent(event) {\n    var canvas = this.canvas;\n    var target = this._eventTarget;\n    var type = event.type;\n    var isTouch = type.indexOf('touch') === 0; // calculate stageX/stageY\n\n    var posObj = event;\n\n    if (isTouch) {\n      var touches = event.touches;\n      var changedTouches = event.changedTouches;\n\n      if (touches && touches.length) {\n        posObj = touches[0];\n      } else if (changedTouches && changedTouches.length) {\n        posObj = changedTouches[0];\n      }\n    }\n\n    var domViewport = this.domViewport || this.updateDomViewport();\n    var x = (posObj.pageX || posObj.clientX) - domViewport.left;\n    var y = (posObj.pageY || posObj.clientY) - domViewport.top;\n    event.stageX = x;\n    event.stageY = y; // 鼠标事件需要阻止冒泡方法 Prevent bubbling on mouse events.\n\n    event.stopPropagation = function () {\n      this._stopPropagationed = true;\n    };\n\n    var meshResult = this.getMeshResultAtPoint(x, y, true);\n    var obj = meshResult.mesh;\n    event.hitPoint = meshResult.point; // fire mouseout/touchout event for last event target\n\n    var leave = type === 'mouseout'; // 当obj和target不同 且obj不是target的子元素时才触发out事件 fire out event when obj and target isn't the same as well as obj is not a child element to target.\n\n    if (target && (target !== obj && (!target.contains || !target.contains(obj)) || leave)) {\n      var out = false;\n\n      if (type === 'touchmove') {\n        out = 'touchout';\n      } else if (type === 'mousemove' || leave || !obj) {\n        out = 'mouseout';\n      }\n\n      if (out) {\n        var outEvent = Object.assign({}, event);\n        outEvent.type = out;\n        outEvent.eventTarget = target;\n\n        target._fireMouseEvent(outEvent);\n      }\n\n      event.lastEventTarget = target;\n      this._eventTarget = null;\n    } // fire event for current view\n\n\n    if (obj && obj.pointerEnabled && type !== 'mouseout') {\n      event.eventTarget = this._eventTarget = obj;\n\n      obj._fireMouseEvent(event);\n    } // set cursor for current view\n\n\n    if (!isTouch) {\n      var cursor = obj && obj.pointerEnabled && obj.useHandCursor ? 'pointer' : '';\n      canvas.style.cursor = cursor;\n    } // fix android: `touchmove` fires only once\n\n\n    if (utils_browser.android && type === 'touchmove') {\n      event.preventDefault();\n    }\n  },\n\n  /**\n   * 更新 DOM viewport\n   * @return {Object} DOM viewport, {left, top, right, bottom}\n   */\n  updateDomViewport: function updateDomViewport() {\n    var canvas = this.canvas;\n    var domViewport = null;\n\n    if (canvas.parentNode) {\n      domViewport = this.domViewport = getElementRect(canvas);\n    }\n\n    return domViewport;\n  },\n\n  /**\n   * 获取指定点的 mesh\n   * @param  {Number}  x\n   * @param  {Number}  y\n   * @param  {Boolean} [eventMode=false]\n   * @return {Mesh|null}\n   */\n  getMeshResultAtPoint: function getMeshResultAtPoint(x, y) {\n    var eventMode = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : false;\n    var camera = this.camera;\n    var ray = this._ray;\n\n    if (!ray) {\n      ray = this._ray = new math_Ray();\n    }\n\n    ray.fromCamera(camera, x, y, this.width, this.height);\n    var hitResult = this.raycast(ray, true, eventMode);\n\n    if (hitResult) {\n      return hitResult[0];\n    }\n\n    if (!this._stageResultAtPoint) {\n      this._stageResultAtPoint = {\n        mesh: this,\n        point: new math_Vector3()\n      };\n    }\n\n    var point = this._stageResultAtPoint.point;\n    point.copy(camera.unprojectVector(point.set(x, y, 0), this.width, this.height));\n    return this._stageResultAtPoint;\n  },\n\n  /**\n   * 释放 WebGL 资源\n   * @return {Stage} this\n   */\n  releaseGLResource: function releaseGLResource() {\n    this.renderer.releaseGLResource();\n    return this;\n  },\n\n  /**\n   * 销毁\n   * @override\n   * @return {Stage} this\n   */\n  destroy: function destroy() {\n    Stage.superclass.destroy.call(this, this.renderer);\n    this.releaseGLResource();\n    this.traverse(function (child) {\n      child.off();\n      child.parent = null;\n    });\n    this.children.length = 0;\n    this.renderer.off();\n    return this;\n  }\n});\n/* harmony default export */ var core_Stage = (Stage);\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/tween/Tween.js\nvar Tween = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/tween/Tween.js\");\nvar Tween_default = /*#__PURE__*/__webpack_require__.n(Tween);\n\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/tween/Ease.js\nvar Ease = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/tween/Ease.js\");\nvar Ease_default = /*#__PURE__*/__webpack_require__.n(Ease);\n\n// CONCATENATED MODULE: ./src/core/Tween.js\n/**\n * Tween类提供缓动功能。\n * @class  Tween\n * @param {Object} target 缓动对象。\n * @param {Object} fromProps 对象缓动的起始属性集合。\n * @param {Object} toProps 对象缓动的目标属性集合。\n * @param {TweenParams} params 缓动参数。可包含Tween类所有可写属性。\n * @property {Object} target 缓动目标。只读属性。\n * @property {Number} duration 缓动总时长。单位毫秒。\n * @property {Number} delay 缓动延迟时间。单位毫秒。\n * @property {Boolean} paused 缓动是否暂停。默认为false。\n * @property {Boolean} loop 缓动是否循环。默认为false。\n * @property {Boolean} reverse 缓动是否反转播放。默认为false。\n * @property {Number} repeat 缓动重复的次数。默认为0。\n * @property {Number} repeatDelay 缓动重复的延迟时长。单位为毫秒。\n * @property {Function} ease 缓动变化函数。默认为null。\n * @property {Number} time 缓动已进行的时长。单位毫秒。只读属性。\n * @property {Function} onStart 缓动开始回调函数。它接受1个参数：tween。默认值为null。\n * @property {Function} onUpdate 缓动更新回调函数。它接受2个参数：ratio和tween。默认值为null。\n * @property {Function} onComplete 缓动结束回调函数。它接受1个参数：tween。默认值为null。\n * @see {@link https://hiloteam.github.io/Hilo/docs/api-zh/symbols/Tween.html}\n * @example\n * Hilo.Tween.to(node, {\n *     x:100,\n *     y:20\n * }, {\n *     duration:1000,\n *     delay:500,\n *     ease:Hilo3d.Tween.Ease.Quad.EaseIn,\n *     onComplete:function(){\n *         console.log('complete');\n *     }\n * });\n */\n\n\n/**\n * Ease类包含为Tween类提供各种缓动功能的函数。\n * @memberOf Tween\n * @property {TweenEaseObject} Back\n * @property {TweenEaseObject} Bounce\n * @property {TweenEaseObject} Circ\n * @property {TweenEaseObject} Cubic\n * @property {TweenEaseObject} Elastic\n * @property {TweenEaseObject} Expo\n * @property {TweenEaseObject} Linear\n * @property {TweenEaseObject} Quad\n * @property {TweenEaseObject} Quart\n * @property {TweenEaseObject} Quint\n * @property {TweenEaseObject} Sine\n * @see  {@link https://hiloteam.github.io/Hilo/docs/api-zh/symbols/Ease.html}\n */\n\nTween_default.a.Ease = Ease_default.a;\n/* harmony default export */ var core_Tween = (Tween_default.a);\n/**\n * 长方体几何体\n * @class\n * @extends Geometry\n */\n\nvar BoxGeometry = core_Class.create(\n/** @lends BoxGeometry.prototype */\n{\n  Extends: geometry_Geometry,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isBoxGeometry: true,\n\n  /**\n   * @default BoxGeometry\n   * @type {string}\n   */\n  className: 'BoxGeometry',\n\n  /**\n   * box的宽度\n   * @default 1\n   * @type {number}\n   */\n  width: 1,\n\n  /**\n   * box的高度\n   * @default 1\n   * @type {number}\n   */\n  height: 1,\n\n  /**\n   * box的深度\n   * @default 1\n   * @type {number}\n   */\n  depth: 1,\n\n  /**\n   * 水平分割面的数量\n   * @default 1\n   * @type {number}\n   */\n  widthSegments: 1,\n\n  /**\n   * 垂直分割面的数量\n   * @default 1\n   * @type {number}\n   */\n  heightSegments: 1,\n\n  /**\n   * 深度分割面的数量\n   * @default 1\n   * @type {number}\n   */\n  depthSegments: 1,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {number} [params.width=1] box的宽度\n   * @param {number} [params.height=1] box的高度\n   * @param {number} [params.depth=1] box的深度\n   * @param {number} [params.widthSegments=1] 水平分割面的数量\n   * @param {number} [params.heightSegments=1] 垂直分割面的数量\n   * @param {number} [params.depthSegments=1] 深度分割面的数量\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    BoxGeometry.superclass.constructor.call(this, params);\n\n    if (this.isSegments()) {\n      this.buildWithSegments();\n    } else {\n      this.build();\n    }\n  },\n  buildWithSegments: function buildWithSegments() {\n    var width = this.width,\n        height = this.height,\n        depth = this.depth,\n        widthSegments = this.widthSegments,\n        heightSegments = this.heightSegments,\n        depthSegments = this.depthSegments;\n    var xVertexCount = (heightSegments + 1) * (depthSegments + 1);\n    var yVertexCount = (widthSegments + 1) * (depthSegments + 1);\n    var zVertexCount = (widthSegments + 1) * (heightSegments + 1);\n    var xIndexCount = heightSegments * depthSegments * 6;\n    var yIndexCount = widthSegments * depthSegments * 6;\n    var zIndexCount = widthSegments * heightSegments * 6;\n    var verticesCount = (xVertexCount + yVertexCount + zVertexCount) * 2;\n    var vertices = new Float32Array(verticesCount * 3);\n    var normals = new Float32Array(verticesCount * 3);\n    var uvs = new Float32Array(verticesCount * 2);\n    var indices = new Uint16Array((xIndexCount + yIndexCount + zIndexCount) * 2);\n    this.vertices = new geometry_GeometryData(vertices, 3);\n    this.normals = new geometry_GeometryData(normals, 3);\n    this.uvs = new geometry_GeometryData(uvs, 2);\n    this.indices = new geometry_GeometryData(indices, 1);\n    var idxInfo = [0, 0]; // x right\n\n    this.buildPlane(idxInfo, 2, 1, 0, -1, 1, depth, height, width / 2, depthSegments, heightSegments); // -x left\n\n    this.buildPlane(idxInfo, 2, 1, 0, 1, 1, depth, height, -width / 2, depthSegments, heightSegments); // y top\n\n    this.buildPlane(idxInfo, 0, 2, 1, 1, -1, width, depth, height / 2, widthSegments, depthSegments); // -y bottom\n\n    this.buildPlane(idxInfo, 0, 2, 1, 1, 1, width, depth, -height / 2, widthSegments, depthSegments); // z front\n\n    this.buildPlane(idxInfo, 0, 1, 2, 1, 1, width, height, depth / 2, widthSegments, heightSegments); // -z back\n\n    this.buildPlane(idxInfo, 0, 1, 2, -1, 1, width, height, -depth / 2, widthSegments, heightSegments);\n  },\n  buildPlane: function buildPlane(idxInfo, u, v, w, uDir, vDir, uLength, vLength, wValue, uSegments, vSegments) {\n    var uDiff = uLength / uSegments;\n    var vDiff = vLength / vSegments;\n    var uHalf = uLength / 2;\n    var vHalf = vLength / 2;\n    var idx = idxInfo[0];\n    var currentIndicesIdx = idxInfo[1];\n    var vertices = this.vertices.data;\n    var normals = this.normals.data;\n    var uvs = this.uvs.data;\n    var indices = this.indices.data;\n\n    for (var vi = 0; vi <= vSegments; vi++) {\n      var vValue = (vi * vDiff - vHalf) * vDir;\n\n      for (var ui = 0; ui <= uSegments; ui++) {\n        vertices[idx * 3 + u] = (ui * uDiff - uHalf) * uDir;\n        vertices[idx * 3 + v] = vValue;\n        vertices[idx * 3 + w] = wValue;\n        normals[idx * 3 + u] = 0;\n        normals[idx * 3 + v] = 0;\n        normals[idx * 3 + w] = wValue < 0 ? -1 : 1;\n        uvs[idx * 2] = ui / uSegments;\n        uvs[idx * 2 + 1] = 1 - vi / vSegments;\n\n        if (ui < uSegments && vi < vSegments) {\n          var lb = idxInfo[0] + (vi + 1) * (uSegments + 1) + ui;\n          indices[currentIndicesIdx++] = lb;\n          indices[currentIndicesIdx++] = idx;\n          indices[currentIndicesIdx++] = lb + 1;\n          indices[currentIndicesIdx++] = lb + 1;\n          indices[currentIndicesIdx++] = idx;\n          indices[currentIndicesIdx++] = idx + 1;\n        }\n\n        idx++;\n      }\n    }\n\n    idxInfo[0] = idx;\n    idxInfo[1] = currentIndicesIdx;\n  },\n  build: function build() {\n    var vertices = new Float32Array(72);\n    var indices = new Uint16Array(36);\n    this.vertices = new geometry_GeometryData(vertices, 3);\n    this.indices = new geometry_GeometryData(indices, 1);\n    var halfWidth = this.width / 2;\n    var halfHeight = this.height / 2;\n    var halfDepth = this.depth / 2;\n    var p1 = [-halfWidth, -halfHeight, -halfDepth];\n    var p2 = [halfWidth, -halfHeight, -halfDepth];\n    var p3 = [halfWidth, halfHeight, -halfDepth];\n    var p4 = [-halfWidth, halfHeight, -halfDepth];\n    var p5 = [-halfWidth, -halfHeight, halfDepth];\n    var p6 = [halfWidth, -halfHeight, halfDepth];\n    var p7 = [halfWidth, halfHeight, halfDepth];\n    var p8 = [-halfWidth, halfHeight, halfDepth];\n    this.addRect(p6, p2, p3, p7); // right\n\n    this.addRect(p1, p5, p8, p4); // left\n\n    this.addRect(p8, p7, p3, p4); // top\n\n    this.addRect(p1, p2, p6, p5); // bottom\n\n    this.addRect(p5, p6, p7, p8); // front\n\n    this.addRect(p2, p1, p4, p3); // back\n  },\n  isSegments: function isSegments() {\n    return this.widthSegments > 1 || this.heightSegments > 1 || this.depthSegments > 1;\n  },\n\n  /**\n   * 设置朝前面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setFrontUV: function setFrontUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setFrontUV!');\n      return;\n    }\n\n    this.setVertexUV(32, uv);\n  },\n\n  /**\n   * 设置右侧面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setRightUV: function setRightUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setRightUV!');\n      return;\n    }\n\n    this.setVertexUV(0, uv);\n  },\n\n  /**\n   * 设置朝后面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setBackUV: function setBackUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setBackUV!');\n      return;\n    }\n\n    this.setVertexUV(40, uv);\n  },\n\n  /**\n   * 设置左侧面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setLeftUV: function setLeftUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setLeftUV!');\n      return;\n    }\n\n    this.setVertexUV(8, uv);\n  },\n\n  /**\n   * 设置顶部面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setTopUV: function setTopUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setTopUV!');\n      return;\n    }\n\n    this.setVertexUV(16, uv);\n  },\n\n  /**\n   * 设置底部面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][]} uv uv数据，如 [[0, 1], [1, 1], [1, 0], [0, 0]]\n   */\n  setBottomUV: function setBottomUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setBottomUV!');\n      return;\n    }\n\n    this.setVertexUV(24, uv);\n  },\n\n  /**\n   * 设置所有面的uv，不支持设置带有 widthSegments heightSegments depthSegments 的实例\n   * @param {number[][][]} uv uv数据，如\n   * [<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]],<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]],<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]],<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]],<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]],<br>\n   *     [[0, 1], [1, 1], [1, 0], [0, 0]]<br>\n   * ]\n   */\n  setAllRectUV: function setAllRectUV(uv) {\n    if (this.isSegments()) {\n      utils_log.warn('segmented BoxGeometry dont support setAllRectUV!');\n      return null;\n    }\n\n    for (var i = 0; i < 6; i++) {\n      this.setVertexUV(i * 8, uv);\n    }\n\n    return this;\n  },\n  _raycast: function _raycast(ray, side) {\n    // TODO:optimize\n    return BoxGeometry.superclass._raycast.call(this, ray, side);\n  }\n});\n/* harmony default export */ var geometry_BoxGeometry = (BoxGeometry);\n// CONCATENATED MODULE: ./src/geometry/PlaneGeometry.js\n\n\n\n\nvar PlaneGeometry_FRONT = src_constants.FRONT,\n    PlaneGeometry_BACK = src_constants.BACK;\nvar normalData = [0, 0, 1];\n/**\n * 平面几何体\n * @class\n * @extends Geometry\n */\n\nvar PlaneGeometry = core_Class.create(\n/** @lends PlaneGeometry.prototype */\n{\n  Extends: geometry_Geometry,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isPlaneGeometry: true,\n\n  /**\n   * @default PlaneGeometry\n   * @type {string}\n   */\n  className: 'PlaneGeometry',\n\n  /**\n   * 宽度\n   * @default 1\n   * @type {number}\n   */\n  width: 1,\n\n  /**\n   * 高度\n   * @default 1\n   * @type {number}\n   */\n  height: 1,\n\n  /**\n   * 水平分割面的数量\n   * @default 1\n   * @type {number}\n   */\n  widthSegments: 1,\n\n  /**\n   * 垂直分割面的数量\n   * @default 1\n   * @type {number}\n   */\n  heightSegments: 1,\n\n  /**\n   * @constructs\n   * @param {object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {number} [params.width=1] 宽度\n   * @param {number} [params.height=1] 高度\n   * @param {number} [params.widthSegments=1] 水平分割面的数量\n   * @param {number} [params.heightSegments=1] 垂直分割面的数量\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    PlaneGeometry.superclass.constructor.call(this, params);\n    this.build();\n  },\n  build: function build() {\n    var widthSegments = this.widthSegments,\n        heightSegments = this.heightSegments;\n    var count = (widthSegments + 1) * (heightSegments + 1);\n    var diffW = this.width / widthSegments;\n    var diffH = this.height / heightSegments;\n    var vertices = new Float32Array(count * 3);\n    var normals = new Float32Array(count * 3);\n    var uvs = new Float32Array(count * 2);\n    var indices = new Uint16Array(widthSegments * heightSegments * 6);\n    var indicesIdx = 0;\n\n    for (var h = 0; h <= heightSegments; h++) {\n      for (var w = 0; w <= widthSegments; w++) {\n        var idx = h * (widthSegments + 1) + w;\n        vertices[idx * 3] = w * diffW - this.width / 2;\n        vertices[idx * 3 + 1] = this.height / 2 - h * diffH;\n        normals[idx * 3] = 0;\n        normals[idx * 3 + 1] = 0;\n        normals[idx * 3 + 2] = 1;\n        uvs[idx * 2] = w / widthSegments;\n        uvs[idx * 2 + 1] = 1 - h / heightSegments;\n\n        if (h < heightSegments && w < widthSegments) {\n          var lb = (h + 1) * (widthSegments + 1) + w;\n          indices[indicesIdx++] = idx;\n          indices[indicesIdx++] = lb;\n          indices[indicesIdx++] = lb + 1;\n          indices[indicesIdx++] = idx;\n          indices[indicesIdx++] = lb + 1;\n          indices[indicesIdx++] = idx + 1;\n        }\n      }\n    }\n\n    this.vertices = new geometry_GeometryData(vertices, 3);\n    this.indices = new geometry_GeometryData(indices, 1);\n    this.normals = new geometry_GeometryData(normals, 3);\n    this.uvs = new geometry_GeometryData(uvs, 2);\n  },\n  _raycast: function _raycast(ray, side) {\n    var originZ = ray.origin.z;\n    var directionZ = ray.direction.z;\n\n    if (side === PlaneGeometry_FRONT && (directionZ > 0 || originZ < 0)) {\n      return null;\n    }\n\n    if (side === PlaneGeometry_BACK && (directionZ < 0 || originZ > 0)) {\n      return null;\n    }\n\n    var point = ray.intersectsPlane(normalData, 0);\n\n    if (point) {\n      var x = point.x;\n      var y = point.y;\n      var halfWidth = this.width * .5;\n      var halfHeight = this.height * .5;\n\n      if (x >= -halfWidth && x <= halfWidth && y >= -halfHeight && y <= halfHeight) {\n        return [point];\n      }\n    }\n\n    return null;\n  }\n});\n/* harmony default export */ var geometry_PlaneGeometry = (PlaneGeometry);\n\n/**\n * 球形几何体\n * @class\n * @extends Geometry\n */\n\nvar SphereGeometry = core_Class.create(\n/** @lends SphereGeometry.prototype */\n{\n  Extends: geometry_Geometry,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isSphereGeometry: true,\n\n  /**\n   * @default SphereGeometry\n   * @type {string}\n   */\n  className: 'SphereGeometry',\n\n  /**\n   * 半径\n   * @default 1\n   * @type {number}\n   */\n  radius: 1,\n\n  /**\n   * 垂直分割面的数量\n   * @default 16\n   * @type {number}\n   */\n  heightSegments: 16,\n\n  /**\n   * 水平分割面的数量\n   * @default 32\n   * @type {number}\n   */\n  widthSegments: 32,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {number} [params.radius=1] 半径\n   * @param {number} [params.heightSegments=16] 垂直分割面的数量\n   * @param {number} [params.widthSegments=32] 水平分割面的数量\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    SphereGeometry.superclass.constructor.call(this, params);\n    this.build();\n  },\n  build: function build() {\n    var radius = this.radius;\n    var heightSegments = this.heightSegments;\n    var widthSegments = this.widthSegments;\n    var count = (widthSegments + 1) * (heightSegments + 1);\n    var gridCount = widthSegments * heightSegments;\n    var vertices = new Float32Array(count * 3);\n    var tangents = new Float32Array(count * 4);\n    var uvs = new Float32Array(count * 2);\n    var indices = new Uint16Array(gridCount * 6);\n    var indexId = 0;\n    var vertexId = 0;\n    var tangentId = 0;\n    var uvId = 0;\n    var pointId = 0;\n    var ANGLE_360 = Math.PI * 2;\n    var ANGLE_180 = Math.PI;\n\n    for (var h = 0; h <= heightSegments; h++) {\n      var v = h / heightSegments;\n      var pitchAngle = ANGLE_180 * v;\n      var y = Math.cos(pitchAngle) * radius;\n      var yawRadius = Math.sin(pitchAngle) * radius;\n\n      for (var w = 0; w <= widthSegments; w++) {\n        var u = w / widthSegments;\n        var yawAngle = ANGLE_360 * u;\n        var yawCos = Math.cos(yawAngle);\n        var yawSin = Math.sin(yawAngle);\n        var x = yawCos * yawRadius;\n        var z = yawSin * yawRadius;\n        var tangentX = yawSin;\n        var tangentY = 0;\n        var tangentZ = -yawCos;\n        tangents[tangentId++] = tangentX;\n        tangents[tangentId++] = tangentY;\n        tangents[tangentId++] = tangentZ;\n        tangents[tangentId++] = 1;\n        vertices[vertexId++] = x;\n        vertices[vertexId++] = y;\n        vertices[vertexId++] = z;\n        uvs[uvId++] = u;\n        uvs[uvId++] = v;\n\n        if (h > 0 && w > 0) {\n          var a = pointId;\n          var b = a - 1;\n          var c = b - widthSegments - 1;\n          var d = a - widthSegments - 1;\n          indices[indexId++] = c;\n          indices[indexId++] = d;\n          indices[indexId++] = a;\n          indices[indexId++] = c;\n          indices[indexId++] = a;\n          indices[indexId++] = b;\n        }\n\n        pointId++;\n      }\n    }\n\n    this.vertices = new geometry_GeometryData(vertices, 3);\n    this.indices = new geometry_GeometryData(indices, 1);\n    this.uvs = new geometry_GeometryData(uvs, 2);\n    this.tangents = new geometry_GeometryData(tangents, 4);\n    this.normals = new geometry_GeometryData(new Float32Array(vertices), 3);\n  },\n  _raycast: function _raycast(ray, side) {\n    // TODO:optimize\n    return SphereGeometry.superclass._raycast.call(this, ray, side);\n  }\n});\n/* harmony default export */ var geometry_SphereGeometry = (SphereGeometry);\n// CONCATENATED MODULE: ./src/renderer/logGLResource.js\n\n\n\n\n\n\nvar resourceList = [shader_Shader, renderer_Program, renderer_Buffer, renderer_VertexArrayObject, texture_Texture];\n\nvar logGLResource_logGLResource = function logGLResource() {\n  var msg = '';\n  resourceList.forEach(function (ResourceClass) {\n    msg += \"\".concat(ResourceClass.prototype.className, \":\").concat(Object.keys(ResourceClass.cache._cache).length, \" \");\n  });\n  utils_log.log(msg);\n};\n\n/* harmony default export */ var renderer_logGLResource = (logGLResource_logGLResource);\n// CONCATENATED MODULE: ./src/loader/LoadCache.js\n\n\n/**\n * 加载缓存类\n * @class\n * @mixes EventMixin\n * @fires update 更新事件\n * @ignore\n */\n\nvar LoadCache = core_Class.create(\n/** @lends LoadCache.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {Boolean}\n   */\n  isLoadCache: true,\n\n  /**\n   * @default LoadCache\n   * @type {String}\n   */\n  className: 'LoadCache',\n  Statics: {\n    PENDING: 1,\n    LOADED: 2,\n    FAILED: 3\n  },\n  enabled: true,\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    this._files = {};\n  },\n  update: function update(key, state, data) {\n    if (!this.enabled) {\n      return;\n    }\n\n    var file = {\n      key: key,\n      state: state,\n      data: data\n    };\n    this._files[key] = file;\n    this.fire('update', file);\n    this.fire(\"update:\".concat(file.key), file);\n  },\n  get: function get(key) {\n    if (!this.enabled) {\n      return null;\n    }\n\n    return this._files[key];\n  },\n  remove: function remove(key) {\n    delete this._files[key];\n  },\n  clear: function clear() {\n    this._files = {};\n  },\n  wait: function wait(file) {\n    var _this = this;\n\n    if (!file) {\n      return Promise.reject();\n    }\n\n    if (file.state === LoadCache.LOADED) {\n      return Promise.resolve(file.data);\n    }\n\n    if (file.state === LoadCache.FAILED) {\n      return Promise.reject();\n    }\n\n    return new Promise(function (resolve, reject) {\n      _this.on(\"update:\".concat(file.key), function (evt) {\n        var file = evt.detail;\n\n        if (file.state === LoadCache.LOADED) {\n          resolve(file.data);\n        } else if (file.state === LoadCache.FAILED) {\n          reject(file.data);\n        }\n      }, true);\n    });\n  }\n});\n/* harmony default export */ var loader_LoadCache = (LoadCache);\n// CONCATENATED MODULE: ./src/loader/BasicLoader.js\n\n\n\n\n\nvar BasicLoader_cache = new loader_LoadCache();\n/**\n * 基础的资源加载类\n * @class\n * @fires beforeload loaded failed\n * @mixes EventMixin\n * @borrows EventMixin#on as #on\n * @borrows EventMixin#off as #off\n * @borrows EventMixin#fire as #fire\n * @fires beforeload 加载前事件\n * @fires loaded 加载事件\n * @fires failed 失败事件\n * @fires progress 进度事件\n * @example\n * var loader = new Hilo3d.BasicLoader();\n * loader.load({\n *     src: '//img.alicdn.com/tfs/TB1aNxtQpXXXXX1XVXXXXXXXXXX-1024-1024.jpg',\n *     crossOrigin: true\n * }).then(img => {\n *     return new Hilo3d.Texture({\n *         image: img\n *     });\n * }, err => {\n *     return new Hilo3d.Color(1, 0, 0);\n * }).then(diffuse => {\n *     return new Hilo3d.BasicMaterial({\n *         diffuse: diffuse\n *     });\n * });\n */\n\nvar BasicLoader = core_Class.create(\n/** @lends BasicLoader.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isBasicLoader: true,\n\n  /**\n   * @default BasicLoader\n   * @type {string}\n   */\n  className: 'BasicLoader',\n  Statics: {\n    _cache: BasicLoader_cache,\n    enalbeCache: function enalbeCache() {\n      BasicLoader_cache.enabled = true;\n    },\n    disableCache: function disableCache() {\n      BasicLoader_cache.enabled = false;\n    },\n    deleteCache: function deleteCache(key) {\n      BasicLoader_cache.remove(key);\n    },\n    clearCache: function clearCache() {\n      BasicLoader_cache.clear();\n    },\n    cache: {\n      get: function get() {\n        return BasicLoader_cache;\n      },\n      set: function set() {\n        utils_log.warn('BasicLoader.cache is readonly!');\n      }\n    }\n  },\n\n  /**\n   * 加载资源，这里会自动调用 loadImg 或者 loadRes\n   * @param {object} data 参数\n   * @param {string} data.src 资源地址\n   * @param {string} [data.type] 资源类型(img, json, buffer)，不提供将根据 data.src 来判断类型\n   * @return {Promise.<any, Error>} 返回加载完的资源对象\n   */\n  load: function load(data) {\n    var src = data.src;\n    var type = data.type;\n\n    if (!type) {\n      var ext = getExtension(src);\n\n      if (/^(?:png|jpe?g|gif|webp|bmp)$/i.test(ext)) {\n        type = 'img';\n      }\n\n      if (!type) {\n        type = data.defaultType;\n      }\n    }\n\n    if (type === 'img') {\n      return this.loadImg(src, data.crossOrigin);\n    }\n\n    return this.loadRes(src, type);\n  },\n\n  /**\n   * 判断链接是否跨域，无法处理二级域名，及修改 document.domain 的情况\n   * @param {string} url 需要判断的链接\n   * @return {boolean} 是否跨域\n   */\n  isCrossOrigin: function isCrossOrigin(url) {\n    var loc = window.location;\n    var a = document.createElement('a');\n    a.href = url;\n    return a.hostname !== loc.hostname || a.port !== loc.port || a.protocol !== loc.protocol;\n  },\n  isBase64: function isBase64(url) {\n    return /^data:(.+?);base64,/.test(url);\n  },\n  Uint8ArrayFrom: function Uint8ArrayFrom(source, mapFn) {\n    if (Uint8Array.from) {\n      return Uint8Array.from(source, mapFn);\n    }\n\n    var len = source.length;\n    var result = new Uint8Array(len);\n\n    for (var i = 0; i < len; i++) {\n      result[i] = mapFn(source[i]);\n    }\n\n    return result;\n  },\n\n  /**\n   * 加载图片\n   * @param {string} url 图片地址\n   * @param {boolean} [crossOrigin=false] 是否跨域\n   * @return {Promise.<HTMLImageElement, Error>} 返回加载完的图片\n   */\n  loadImg: function loadImg(url, crossOrigin) {\n    var _this = this;\n\n    var file = BasicLoader_cache.get(url);\n\n    if (file) {\n      return BasicLoader_cache.wait(file);\n    }\n\n    return new Promise(function (resolve, reject) {\n      var img = new Image();\n      BasicLoader_cache.update(url, loader_LoadCache.PENDING);\n\n      img.onload = function () {\n        img.onerror = null;\n        img.onabort = null;\n        img.onload = null;\n        BasicLoader_cache.update(url, loader_LoadCache.LOADED, img);\n        resolve(img);\n      };\n\n      img.onerror = function () {\n        img.onerror = null;\n        img.onabort = null;\n        img.onload = null;\n        var err = new Error(\"Image load failed for \".concat(url.slice(0, 100)));\n        BasicLoader_cache.update(url, loader_LoadCache.FAILED, err);\n        reject(err);\n      };\n\n      img.onabort = img.onerror;\n\n      if (crossOrigin || _this.isCrossOrigin(url)) {\n        if (!_this.isBase64(url)) {\n          img.crossOrigin = 'anonymous';\n        }\n      }\n\n      img.src = url;\n    });\n  },\n\n  /**\n   * 使用XHR加载其他资源\n   * @param {string} url 资源地址\n   * @param {string} [type=text] 资源类型(json, buffer, text)\n   * @return {Promise.<Object, Error>} 返回加载完的内容对象(Object, ArrayBuffer, String)\n   */\n  loadRes: function loadRes(url, type) {\n    var _this2 = this;\n\n    if (this.isBase64(url)) {\n      var mime = RegExp.$1;\n      var base64Str = url.slice(13 + mime.length);\n      var result = atob(base64Str);\n\n      if (type === 'json') {\n        result = JSON.parse(result);\n      } else if (type === 'buffer') {\n        result = this.Uint8ArrayFrom(result, function (c) {\n          return c.charCodeAt(0);\n        }).buffer;\n      }\n\n      return Promise.resolve(result);\n    }\n\n    var file = BasicLoader_cache.get(url);\n\n    if (file) {\n      return BasicLoader_cache.wait(file);\n    }\n\n    BasicLoader_cache.update(url, loader_LoadCache.PENDING);\n    this.fire('beforeload');\n    return this.request({\n      url: url,\n      type: type\n    }).then(function (data) {\n      _this2.fire('loaded');\n\n      BasicLoader_cache.update(url, loader_LoadCache.LOADED, data);\n      return data;\n    }, function (err) {\n      _this2.fire('failed', err);\n\n      BasicLoader_cache.update(url, loader_LoadCache.FAILED);\n      throw new Error(\"Resource load failed for \".concat(url, \", \").concat(err));\n    });\n  },\n\n  /**\n   * XHR资源请求\n   * @param {object} opt 请求参数\n   * @param {string} opt.url 资源地址\n   * @param {string} [opt.type=text] 资源类型(json, buffer, text)\n   * @param {string} [opt.method=GET] 请求类型(GET, POST ..)\n   * @param {object} [opt.headers] 请求头参数\n   * @param {string} [opt.body] POST请求发送的数据\n   * @return {Promise.<Object, Error>} 返回加载完的内容对象(Object, ArrayBuffer, String)\n   */\n  request: function request(opt) {\n    var _this3 = this;\n\n    return new Promise(function (resolve, reject) {\n      var xhr = new XMLHttpRequest();\n\n      xhr.onload = function () {\n        if (xhr.status < 200 || xhr.status >= 300) {\n          reject(new TypeError(\"Network request failed for \".concat(xhr.status)));\n          return;\n        }\n\n        var result = 'response' in xhr ? xhr.response : xhr.responseText;\n\n        if (opt.type === 'json') {\n          try {\n            result = JSON.parse(result);\n          } catch (err) {\n            reject(new TypeError('JSON.parse error' + err));\n            return;\n          }\n        }\n\n        resolve(result);\n      };\n\n      xhr.onprogress = function (evt) {\n        _this3.fire('progress', {\n          url: opt.url,\n          loaded: evt.loaded,\n          total: evt.total\n        });\n      };\n\n      xhr.onerror = function () {\n        reject(new TypeError('Network request failed'));\n      };\n\n      xhr.ontimeout = function () {\n        reject(new TypeError('Network request timed out'));\n      };\n\n      xhr.open(opt.method || 'GET', opt.url, true);\n\n      if (opt.credentials === 'include') {\n        xhr.withCredentials = true;\n      }\n\n      if (opt.type === 'buffer') {\n        xhr.responseType = 'arraybuffer';\n      }\n\n      util_each(opt.headers, function (value, name) {\n        xhr.setRequestHeader(name, value);\n      });\n      xhr.send(opt.body || null);\n    });\n  }\n});\n/* harmony default export */ var loader_BasicLoader = (BasicLoader);\n// CONCATENATED MODULE: ./src/loader/Loader.js\n\n\n\n/**\n * @class\n */\n\nvar Loader = core_Class.create(\n/** @lends Loader.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isLoader: true,\n\n  /**\n   * @default Loader\n   * @type {string}\n   */\n  className: 'Loader',\n  maxConnections: 2,\n  Statics: {\n    _loaderClassMap: {},\n    _loaders: {},\n\n    /**\n     * 给Loader类添加扩展Loader\n     * @memberOf Loader\n     * @static\n     * @param {string} ext 资源扩展，如gltf, png 等\n     * @param {BasicLoader} LoaderClass 用于加载的类，需要继承BasicLoader\n     */\n    addLoader: function addLoader(ext, LoaderClass) {\n      Loader._loaderClassMap[ext] = LoaderClass;\n    },\n    getLoader: function getLoader(ext) {\n      if (!Loader._loaders[ext]) {\n        var LoaderClass = Loader._loaderClassMap[ext] ? Loader._loaderClassMap[ext] : loader_BasicLoader;\n        Loader._loaders[ext] = new LoaderClass();\n      }\n\n      return Loader._loaders[ext];\n    }\n  },\n\n  /**\n   * load\n   * @param  {Object|Array} data\n   * @return {Promise<any>}\n   */\n  load: function load(data) {\n    var _this = this;\n\n    if (data instanceof Array) {\n      return Promise.all(data.map(function (d) {\n        return _this.load(d);\n      }));\n    }\n\n    var type = data.type || getExtension(data.src);\n    var loader = Loader.getLoader(type);\n    return loader.load(data);\n  }\n});\n/* harmony default export */ var loader_Loader = (Loader);\n// CONCATENATED MODULE: ./src/loader/CubeTextureLoader.js\n\n\n\n\n\n/**\n * CubeTexture加载类\n * @class\n * @extends {BasicLoader}\n * @example\n * var loader = new Hilo3d.CubeTextureLoader();\n * loader.load({\n *     crossOrigin: true,\n *     images: [\n *         '//gw.alicdn.com/tfs/TB1Ss.ORpXXXXcNXVXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1YhUDRpXXXXcyaXXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1Y1MORpXXXXcpXVXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1ZgAqRpXXXXa0aFXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1IVZNRpXXXXaNXFXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1M3gyRpXXXXb9apXXXXXXXXXX-2048-2048.jpg_960x960.jpg'\n *     ]\n * }).then(function (skybox) {\n *     var material = new Hilo3d.BasicMaterial({\n *         diffuse: skybox\n *     });\n *     ...\n * });\n */\n\nvar CubeTextureLoader = core_Class.create(\n/** @lends CubeTextureLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isCubeTextureLoader: true,\n\n  /**\n   * @default CubeTextureLoader\n   * @type {string}\n   */\n  className: 'CubeTextureLoader',\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    CubeTextureLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * 加载CubeTexture\n   * @param {object} params 加载参数\n   * @param {boolean} params.crossOrigin 是否跨域，不传将自动判断\n   * @param {Array.<string>} params.images 纹理图片地址数组，顺序为 right, left, top, bottom, front, back\n   * @param {string} params.right 右面的图片地址\n   * @param {string} params.left 左面的图片地址\n   * @param {string} params.top 上面的图片地址\n   * @param {string} params.bottom 下面的图片地址\n   * @param {string} params.front 前面的图片地址\n   * @param {string} params.back 背面的图片地址\n   * @async\n   * @return {Promise<CubeTexture, Error>} 返回加载完的CubeTexture对象\n   */\n  load: function load(params) {\n    var _this = this;\n\n    var images;\n\n    if (params.images && Array.isArray(params.images)) {\n      images = params.images;\n    } else {\n      images = [params.right, params.left, params.top, params.bottom, params.front, params.back];\n    }\n\n    return Promise.all(images.map(function (img) {\n      return _this.loadImg(img, params.crossOrigin);\n    })).then(function (images) {\n      var args = Object.assign({}, params);\n      delete args.images;\n      delete args.type;\n      delete args.right;\n      delete args.left;\n      delete args.top;\n      delete args.bottom;\n      delete args.front;\n      delete args.back;\n      args.image = images;\n      return new texture_CubeTexture(args);\n    })[\"catch\"](function (err) {\n      utils_log.error('load CubeTexture failed', err.message, err.stack);\n      throw err;\n    });\n  }\n});\nloader_Loader.addLoader('CubeTexture', CubeTextureLoader);\n/* harmony default export */ var loader_CubeTextureLoader = (CubeTextureLoader);\n// CONCATENATED MODULE: ./src/material/PBRMaterial.js\n\n\n\n\n/**\n * PBR材质\n * @class\n * @extends Material\n * @example\n * const material = new Hilo3d.PBRMaterial();\n */\n\nvar PBRMaterial = core_Class.create(\n/** @lends PBRMaterial.prototype */\n{\n  Extends: material_Material,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isPBRMaterial: true,\n\n  /**\n   * @default PBRMaterial\n   * @type {string}\n   */\n  className: 'PBRMaterial',\n\n  /**\n   * 光照类型，只能为 PBR 或 NONE\n   * @default PBR\n   * @readOnly\n   * @type {string}\n   */\n  lightType: 'PBR',\n\n  /**\n   * gammaCorrection\n   * @type {Boolean}\n   * @default true\n   */\n  gammaCorrection: true,\n\n  /**\n   * 是否使用物理灯光\n   * @type {Boolean}\n   * @default true\n   */\n  usePhysicsLight: true,\n\n  /**\n   * 基础颜色\n   * @default null\n   * @type {Color}\n   */\n  baseColor: null,\n\n  /**\n   * 基础颜色贴图(sRGB空间)\n   * @default null\n   * @type {Texture}\n   */\n  baseColorMap: null,\n\n  /**\n   * 金属度\n   * @default 1\n   * @type {Number}\n   */\n  metallic: 1,\n\n  /**\n   * 金属度贴图\n   * @default null\n   * @type {Texture}\n   */\n  metallicMap: null,\n\n  /**\n   * 粗糙度\n   * @default 1\n   * @type {Number}\n   */\n  roughness: 1,\n\n  /**\n   * 粗糙度贴图\n   * @default null\n   * @type {Texture}\n   */\n  roughnessMap: null,\n\n  /**\n   * 金属度及粗糙度贴图，金属度为B通道，粗糙度为G通道，可以指定R通道作为环境光遮蔽\n   * @default null\n   * @type {Texture}\n   */\n  metallicRoughnessMap: null,\n\n  /**\n   * 环境光遮蔽贴图\n   * @default null\n   * @type {Texture}\n   */\n  occlusionMap: null,\n\n  /**\n   * 环境光遮蔽强度\n   * @default 1\n   * @type {Number}\n   */\n  occlusionStrength: 1,\n\n  /**\n   * 环境光遮蔽贴图(occlusionMap)包含在 metallicRoughnessMap 的R通道中\n   * @default false\n   * @type {boolean}\n   */\n  isOcclusionInMetallicRoughnessMap: false,\n\n  /**\n   * 漫反射辐照(Diffuse IBL)贴图\n   * @default null\n   * @type {CubeTexture|Texture}\n   */\n  diffuseEnvMap: null,\n\n  /**\n   * 漫反射 SphericalHarmonics3\n   * @type {SphericalHarmonics3}\n   */\n  diffuseEnvSphereHarmonics3: null,\n\n  /**\n   * 漫反射环境强度\n   * @default 1\n   * @type {Number}\n   */\n  diffuseEnvIntensity: 1,\n\n  /**\n   * BRDF贴图，跟环境反射贴图一起使用 [示例]{@link https://gw.alicdn.com/tfs/TB1EvwBRFXXXXbNXpXXXXXXXXXX-256-256.png}\n   * @default null\n   * @type {Texture}\n   */\n  brdfLUT: null,\n\n  /**\n   * 环境反射(Specular IBL)贴图强度\n   * @default 1\n   * @type {Number}\n   */\n  specularEnvIntensity: 1,\n\n  /**\n   * 环境反射(Specular IBL)贴图\n   * @default null\n   * @type {CubeTexture|Texture}\n   */\n  specularEnvMap: null,\n\n  /**\n   * 环境反射是否包含 mipmaps\n   * @default false\n   * @type {boolean}\n   */\n  isSpecularEnvMapIncludeMipmaps: false,\n\n  /**\n   * 放射光贴图(sRGB 空间)，或颜色\n   * @default null\n   * @type {Texture|Color}\n   */\n  emission: null,\n\n  /**\n   * 是否基于反射光泽度的 PBR，具体见 [KHR_materials_pbrSpecularGlossiness]{@link https://github.com/KhronosGroup/glTF/tree/master/extensions/Khronos/KHR_materials_pbrSpecularGlossiness}\n   * @default false\n   * @type {boolean}\n   */\n  isSpecularGlossiness: false,\n\n  /**\n   * 镜面反射率，针对 isSpecularGlossiness 渲染\n   * @default Color(1, 1, 1)\n   * @type {Color}\n   */\n  specular: null,\n\n  /**\n   * 光泽度，针对 isSpecularGlossiness 渲染，默认PBR无效\n   * @default 1\n   * @type {number}\n   */\n  glossiness: 1,\n\n  /**\n   * 镜面反射即光泽度贴图，RGB 通道为镜面反射率，A 通道为光泽度\n   * @default null\n   * @type {Texture}\n   */\n  specularGlossinessMap: null,\n  usedUniformVectors: 11,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {string} [params.lightType=PBR] 光照类型，只能为 PBR 或 NONE\n   * @param {Color} [params.baseColor=new Color(1, 1, 1)] 基础颜色\n   * @param {Texture} [params.baseColorMap] 基础颜色贴图(sRGB空间)\n   * @param {number} [params.metallic=1] 金属度\n   * @param {Texture} [params.metallicMap] 金属度贴图\n   * @param {number} [params.roughness=1] 粗糙度\n   * @param {Texture} [params.roughnessMap] 粗糙度贴图\n   * @param {Texture} [params.occlusionMap] 环境光遮蔽贴图\n   * @param {number} [params.occlusionStrength=1] 环境光遮蔽强度\n   * @param {Texture|Color} [params.emission] 放射光贴图(sRGB 空间)，或颜色\n   * @param {Texture} [params.diffuseEnvMap] 漫反射辐照(Diffuse IBL)贴图\n   * @param {SphericalHarmonics3} [params.diffuseEnvSphereHarmonics3] 漫反射 SphericalHarmonics3\n   * @param {number} [params.diffuseEnvIntensity=1] 漫反射强度\n   * @param {Texture} [params.specularEnvMap] 环境反射(Specular IBL)贴图\n   * @param {Texture} [params.brdfLUT] BRDF贴图，跟环境反射贴图一起使用\n   * @param {number} [params.specularEnvIntensity=1] 环境反射(Specular IBL)贴图强度\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    this.baseColor = new math_Color(1, 1, 1);\n    this.specular = new math_Color(1, 1, 1);\n    PBRMaterial.superclass.constructor.call(this, params);\n    Object.assign(this.uniforms, {\n      u_baseColor: 'BASECOLOR',\n      u_metallic: 'METALLIC',\n      u_roughness: 'ROUGHNESS',\n      u_specular: 'SPECULAR',\n      u_glossiness: 'GLOSSINESS',\n      u_brdfLUT: 'BRDFLUT',\n      u_diffuseEnvMap: 'DIFFUSEENVMAP',\n      u_diffuseEnvIntensity: 'DIFFUSEENVINTENSITY',\n      u_occlusionStrength: 'OCCLUSIONSTRENGTH',\n      u_specularEnvMap: 'SPECULARENVMAP',\n      u_specularEnvIntensity: 'SPECULARENVINTENSITY',\n      u_specularEnvMapMipCount: 'SPECULARENVMAPMIPCOUNT',\n      u_diffuseEnvSphereHarmonics3: 'DIFFUSEENVSPHEREHARMONICS3'\n    });\n    this.addTextureUniforms({\n      u_baseColorMap: 'BASECOLORMAP',\n      u_metallicMap: 'METALLICMAP',\n      u_roughnessMap: 'ROUGHNESSMAP',\n      u_metallicRoughnessMap: 'METALLICROUGHNESSMAP',\n      u_occlusionMap: 'OCCLUSIONMAP',\n      u_specularGlossinessMap: 'SPECULARGLOSSINESSMAP',\n      u_lightMap: 'LIGHTMAP'\n    });\n  },\n  getRenderOption: function getRenderOption() {\n    var option = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n    PBRMaterial.superclass.getRenderOption.call(this, option);\n\n    var textureOption = this._textureOption.reset(option);\n\n    textureOption.add(this.baseColorMap, 'BASE_COLOR_MAP');\n    textureOption.add(this.metallicMap, 'METALLIC_MAP');\n    textureOption.add(this.roughnessMap, 'ROUGHNESS_MAP');\n    textureOption.add(this.metallicRoughnessMap, 'METALLIC_ROUGHNESS_MAP');\n    textureOption.add(this.diffuseEnvMap, 'DIFFUSE_ENV_MAP');\n    textureOption.add(this.occlusionMap, 'OCCLUSION_MAP');\n    textureOption.add(this.lightMap, 'LIGHT_MAP');\n\n    if (this.brdfLUT) {\n      textureOption.add(this.specularEnvMap, 'SPECULAR_ENV_MAP');\n\n      if (renderer_capabilities.SHADER_TEXTURE_LOD && this.specularEnvMap) {\n        option.USE_SHADER_TEXTURE_LOD = 1;\n      }\n    }\n\n    if (this.isSpecularGlossiness) {\n      option.PBR_SPECULAR_GLOSSINESS = 1;\n      textureOption.add(this.specularGlossinessMap, 'SPECULAR_GLOSSINESS_MAP');\n    }\n\n    if (this.isOcclusionInMetallicRoughnessMap) {\n      option.IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP = 1;\n    }\n\n    if (this.occlusionStrength !== 1) {\n      option.OCCLUSION_STRENGTH = 1;\n    }\n\n    if (this.diffuseEnvSphereHarmonics3) {\n      option.HAS_NORMAL = 1;\n      option.DIFFUSE_ENV_SPHERE_HARMONICS3 = 1;\n    }\n\n    if (this.specularEnvMap || this.diffuseEnvSphereHarmonics3 || this.specularEnvMap) {\n      option.NEED_WORLD_NORMAL = 1;\n    }\n\n    if (this.specularEnvMap && this.isSpecularEnvMapIncludeMipmaps) {\n      option.IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS = 1;\n    }\n\n    textureOption.update();\n    return option;\n  }\n});\n/* harmony default export */ var material_PBRMaterial = (PBRMaterial);\n// CONCATENATED MODULE: ./src/texture/LazyTexture.js\n\n\n\n\n\nvar placeHolder = new Image();\nplaceHolder.src = 'data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7';\n/**\n * 懒加载纹理\n * @class\n * @extends Texture\n * @fires load 加载成功事件\n * @fires error 加载失败事件\n * @example\n * var material = new Hilo3d.BasicMaterial({\n *     diffuse: new Hilo3d.LazyTexture({\n *         crossOrigin: true,\n *         src: '//img.alicdn.com/tfs/TB1aNxtQpXXXXX1XVXXXXXXXXXX-1024-1024.jpg'\n *     });\n * });\n */\n\nvar LazyTexture = core_Class.create(\n/** @lends LazyTexture.prototype */\n{\n  Extends: texture_Texture,\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isLazyTexture: true,\n\n  /**\n   * @default LazyTexture\n   * @type {string}\n   */\n  className: 'LazyTexture',\n  _src: '',\n\n  /**\n   * 图片是否跨域\n   * @default false\n   * @type {boolean}\n   */\n  crossOrigin: false,\n\n  /**\n   * 是否在设置src后立即加载图片\n   * @default true\n   * @type {boolean}\n   */\n  autoLoad: true,\n\n  /**\n   * 资源类型，用于加载时判断\n   * @type {string}\n   */\n  resType: '',\n\n  /**\n   * 图片地址\n   * @type {string}\n   */\n  src: {\n    get: function get() {\n      return this._src;\n    },\n    set: function set(src) {\n      if (this._src !== src) {\n        this._src = src;\n\n        if (this.autoLoad) {\n          this.load();\n        }\n      }\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数，所有params都会复制到实例上\n   * @param {boolean} [params.crossOrigin=false] 是否跨域\n   * @param {HTMLImageElement} [params.placeHolder] 占位图片，默认为1像素的透明图片\n   * @param {boolean} [params.autoLoad=true] 是否自动加载\n   * @param {string} [params.src] 图片地址\n   */\n  constructor: function constructor(params) {\n    if (params) {\n      // 必须在src设置前赋值\n      if ('crossOrigin' in params) {\n        this.crossOrigin = params.crossOrigin;\n      }\n\n      if ('autoLoad' in params) {\n        this.autoLoad = params.autoLoad;\n      }\n    }\n\n    LazyTexture.superclass.constructor.call(this, params);\n    this.image = this.placeHolder || placeHolder;\n  },\n\n  /**\n   * 加载图片\n   * @param {boolean} [throwError=false] 是否 throw error\n   * @return {Promise<void>} 返回加载的Promise\n   */\n  load: function load(throwError) {\n    var _this = this;\n\n    LazyTexture.loader = LazyTexture.loader || new loader_Loader();\n    return LazyTexture.loader.load({\n      src: this.src,\n      crossOrigin: this.crossOrigin,\n      type: this.resType,\n      defaultType: 'img'\n    }).then(function (img) {\n      if (img.isTexture) {\n        Object.assign(_this, img);\n        _this.needUpdate = true;\n        _this.needDestroy = true;\n\n        _this.fire('load');\n      } else {\n        _this.image = img;\n        _this.needUpdate = true;\n\n        _this.fire('load');\n      }\n    }, function (err) {\n      _this.fire('error');\n\n      if (throwError) {\n        throw new Error(\"LazyTexture Failed \".concat(err));\n      } else {\n        utils_log.warn(\"LazyTexture Failed \".concat(err));\n      }\n    });\n  },\n  _releaseImage: function _releaseImage() {\n    if (this._src && typeof this._src !== 'string') {\n      this._src = '';\n    }\n\n    LazyTexture.superclass._releaseImage.call(this);\n  }\n});\n/* harmony default export */ var texture_LazyTexture = (LazyTexture);\n// CONCATENATED MODULE: ./src/animation/AnimationStates.js\nfunction AnimationStates_slicedToArray(arr, i) { return AnimationStates_arrayWithHoles(arr) || AnimationStates_iterableToArrayLimit(arr, i) || AnimationStates_unsupportedIterableToArray(arr, i) || AnimationStates_nonIterableRest(); }\n\nfunction AnimationStates_nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction AnimationStates_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return AnimationStates_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return AnimationStates_arrayLikeToArray(o, minLen); }\n\nfunction AnimationStates_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction AnimationStates_iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction AnimationStates_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\n\n\nvar tempQuat1 = new math_Quaternion();\nvar tempQuat2 = new math_Quaternion();\nvar tempQuat3 = new math_Quaternion();\nvar tempQuat4 = new math_Quaternion();\nvar tempQuat5 = new math_Quaternion();\nvar tempQuat6 = new math_Quaternion();\nvar tempEuler = new math_Euler();\nvar tempArr = [];\n\nfunction ascCompare(a, b) {\n  return a - b;\n}\n/**\n * 元素动画状态序列处理\n * @class\n */\n\n\nvar AnimationStates = core_Class.create(\n/** @lends AnimationStates.prototype */\n{\n  Statics: {\n    interpolation: {\n      LINEAR: function LINEAR(a, b, t) {\n        if (b === undefined) {\n          return a;\n        }\n\n        if (a.slerp) {\n          return a.slerp(b, t);\n        }\n\n        if (a.lerp) {\n          return a.lerp(b, t);\n        }\n\n        if (isArrayLike(a)) {\n          tempArr.length = 0;\n\n          for (var i = a.length - 1; i >= 0; i--) {\n            tempArr[i] = a[i] + t * (b[i] - a[i]);\n          }\n\n          return tempArr;\n        }\n\n        return a + t * (b - a);\n      },\n      STEP: function STEP(a, b, t) {\n        // eslint-disable-line no-unused-vars\n        return a;\n      },\n      CUBICSPLINE: function CUBICSPLINE(a, b, t, tr) {\n        // eslint-disable-line no-unused-vars\n        var itemLen = a.length / 3;\n\n        if (b === undefined) {\n          if (itemLen === 1) {\n            return a[1];\n          }\n\n          return a.slice(itemLen, -itemLen);\n        }\n\n        var p0 = a[1];\n        var m0 = a[2];\n        var p1 = b[1];\n        var m1 = b[0];\n\n        if (itemLen > 1) {\n          p0 = a.slice(itemLen, -itemLen);\n          m0 = a.slice(-itemLen);\n          p1 = b.slice(itemLen, -itemLen);\n          m1 = b.slice(0, itemLen);\n        }\n\n        if (p0.hermite) {\n          p0.hermite(p0, m0.scale(tr), p1, m1.scale(tr), t);\n        } else if (p0.isQuaternion) {\n          p0.fromArray(this._cubicSpline(p0.elements, m0.elements, p1.elements, m1.elements, tr, t), 0, true);\n          p0.normalize(true);\n        } else {\n          if (!isArrayLike(p0)) {\n            p0 = [p0];\n            m0 = [m0];\n            p1 = [p1];\n            m1 = [m1];\n          }\n\n          p0 = this._cubicSpline(p0, m0, p1, m1, tr, t);\n        }\n\n        return p0;\n      },\n      _cubicSpline: function _cubicSpline(p0, m0, p1, m1, tr, t) {\n        var t2 = t * t;\n        var t3 = t2 * t;\n        var x1 = 2 * t3 - 3 * t2 + 1;\n        var x2 = t3 - 2 * t2 + t;\n        var x3 = -2 * t3 + 3 * t2;\n        var x4 = t3 - t2;\n        tempArr.length = 0;\n\n        for (var i = p0.length - 1; i >= 0; i--) {\n          tempArr[i] = p0[i] * x1 + x2 * m0[i] * tr + p1[i] * x3 + x4 * m1[i] * tr;\n        }\n\n        return tempArr;\n      }\n    },\n\n    /**\n     * 状态类型\n     * @memberOf AnimationStates\n     * @static\n     * @enum {string}\n     */\n    StateType: {\n      TRANSLATE: 'Translation',\n      POSITION: 'Translation',\n      TRANSLATION: 'Translation',\n      SCALE: 'Scale',\n      ROTATE: 'Rotation',\n      ROTATION: 'Rotation',\n      QUATERNION: 'Quaternion',\n      WEIGHTS: 'Weights'\n    },\n\n    /**\n     * 根据名字获取状态类型\n     * @memberOf AnimationStates\n     * @static\n     * @param {string} name 名字，忽略大小写，如 translate => StateType.TRANSLATE\n     * @return {AnimationStates.StateType} 返回获取的状态名\n     */\n    getType: function getType(name) {\n      name = String(name).toUpperCase();\n      return AnimationStates.StateType[name] || AnimationStates._extraStateHandlers.type[name];\n    },\n    _extraStateHandlers: {\n      type: {},\n      handler: {}\n    },\n\n    /**\n     * 注册属性处理器\n     * @memberOf AnimationStates\n     * @param {string} name 属性名\n     * @param {Function} handler 属性处理方法\n     */\n    registerStateHandler: function registerStateHandler(name, handler) {\n      AnimationStates._extraStateHandlers.type[String(name).toUpperCase()] = name;\n      AnimationStates._extraStateHandlers.handler[name] = handler;\n    }\n  },\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isAnimationStates: true,\n\n  /**\n   * @default AnimationStates\n   * @type {string}\n   */\n  className: 'AnimationStates',\n\n  /**\n   * 对应的node名字(动画是根据名字关联的)\n   * @type {string}\n   */\n  nodeName: '',\n\n  /**\n   * 状态类型\n   * @type {AnimationStates.StateType}\n   */\n  type: '',\n\n  /**\n   * 插值算法\n   * @default LINEAR\n   * @type {string}\n   */\n  interpolationType: 'LINEAR',\n\n  /**\n   * @constructs\n   * @param {Object} parmas 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(parmas) {\n    /**\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * 时间序列\n     * @default []\n     * @type {number[]}\n     */\n\n    this.keyTime = [];\n    /**\n     * 对应时间上的状态，数组长度应该跟keyTime一致，即每一帧上的状态信息\n     * @default []\n     * @type {Array.<Array>}\n     */\n\n    this.states = [];\n    Object.assign(this, parmas);\n  },\n\n  /**\n   * 查找指定时间在 keyTime 数组中的位置\n   * @param {number} time 指定的时间\n   * @return {number[]} 返回找到的位置，如: [low, high]\n   */\n  findIndexByTime: function findIndexByTime(time) {\n    var indexArr = getIndexFromSortedArray(this.keyTime, time, ascCompare); // if (indexArr[0] < 0) {\n    //     indexArr[0] = 0;\n    // }\n    // if (indexArr[1] >= this.keyTime.length) {\n    //     indexArr[1] = this.keyTime.length - 1;\n    // }\n\n    return indexArr;\n  },\n  getStateByIndex: function getStateByIndex(index) {\n    var len = this.states.length / this.keyTime.length;\n\n    if (len === 1) {\n      return this.states[index];\n    }\n\n    return this.states.slice(index * len, index * len + len);\n  },\n\n  /**\n   * 获取指定时间上对应的状态，这里会进行插值计算\n   * @param {number} time 指定的时间\n   * @return {number[]} 返回插值后的状态数据\n   */\n  getState: function getState(time) {\n    var _this$findIndexByTime = this.findIndexByTime(time),\n        _this$findIndexByTime2 = AnimationStates_slicedToArray(_this$findIndexByTime, 2),\n        index1 = _this$findIndexByTime2[0],\n        index2 = _this$findIndexByTime2[1];\n\n    if (index1 < 0 || index2 >= this.keyTime.length) {\n      // do nothing if time is out of range\n      return null;\n    }\n\n    var time1 = this.keyTime[index1];\n    var time2 = this.keyTime[index2];\n    var state1 = this.getStateByIndex(index1);\n\n    if (this.interpolationType === 'STEP') {\n      return state1;\n    }\n\n    if (index1 === index2) {\n      var _result = this.interpolation(state1);\n\n      if (this.type === AnimationStates.StateType.ROTATION) {\n        _result = tempQuat1.fromEuler(tempEuler.fromArray(_result));\n      }\n\n      return _result.elements || _result;\n    }\n\n    var state2 = this.getStateByIndex(index2);\n    var timeRange = time2 - time1;\n    var ratio = (time - time1) / timeRange;\n\n    if (this.type === AnimationStates.StateType.ROTATION) {\n      if (isArrayLike(state1[0])) {\n        state1[0] = tempQuat1.fromEuler(tempEuler.fromArray(state1[0]));\n        state1[1] = tempQuat2.fromEuler(tempEuler.fromArray(state1[1]));\n        state1[2] = tempQuat3.fromEuler(tempEuler.fromArray(state1[2]));\n        state2[0] = tempQuat4.fromEuler(tempEuler.fromArray(state2[0]));\n        state2[1] = tempQuat5.fromEuler(tempEuler.fromArray(state2[1]));\n        state2[2] = tempQuat6.fromEuler(tempEuler.fromArray(state2[2]));\n      } else {\n        state1 = tempQuat1.fromEuler(tempEuler.fromArray(state1));\n        state2 = tempQuat2.fromEuler(tempEuler.fromArray(state2));\n      }\n    } else if (this.type === AnimationStates.StateType.QUATERNION) {\n      if (isArrayLike(state1[0])) {\n        state1[0] = tempQuat1.fromArray(state1[0]);\n        state1[1] = tempQuat2.fromArray(state1[1]);\n        state1[2] = tempQuat3.fromArray(state1[2]);\n        state2[0] = tempQuat4.fromArray(state2[0]);\n        state2[1] = tempQuat5.fromArray(state2[1]);\n        state2[2] = tempQuat6.fromArray(state2[2]);\n      } else {\n        state1 = tempQuat1.fromArray(state1);\n        state2 = tempQuat2.fromArray(state2);\n      }\n    }\n\n    var result = this.interpolation(state1, state2, ratio, timeRange);\n    return result.elements || result;\n  },\n  interpolation: function interpolation(a, b, t, tr) {\n    return AnimationStates.interpolation[this.interpolationType](a, b, t, tr);\n  },\n\n  /**\n   * 更新指定元素的位置\n   * @param {Node} node 需要更新的元素\n   * @param {number[]} value 位置信息，[x, y, z]\n   */\n  updateNodeTranslation: function updateNodeTranslation(node, value) {\n    node.x = value[0];\n    node.y = value[1];\n    node.z = value[2];\n  },\n\n  /**\n   * 更新指定元素的缩放\n   * @param {Node} node 需要更新的元素\n   * @param {number[]} value 缩放信息，[scaleX, scaleY, scaleZ]\n   */\n  updateNodeScale: function updateNodeScale(node, value) {\n    node.scaleX = value[0];\n    node.scaleY = value[1];\n    node.scaleZ = value[2];\n  },\n\n  /**\n   * 更新指定元素的旋转(四元数)\n   * @param {Node} node 需要更新的元素\n   * @param {number[]} value 四元数的旋转信息，[x, y, z, w]\n   */\n  updateNodeQuaternion: function updateNodeQuaternion(node, value) {\n    node.quaternion.fromArray(value);\n  },\n  updateNodeWeights: function updateNodeWeights(node, weights) {\n    var originalWeightIndices = this._originalWeightIndices = this._originalWeightIndices || [];\n    var len = weights.length;\n    weights = weights.slice();\n\n    for (var i = 0; i < len; i++) {\n      originalWeightIndices[i] = i;\n    }\n\n    for (var _i2 = 0; _i2 < len; _i2++) {\n      for (var j = _i2 + 1; j < len; j++) {\n        if (weights[j] > weights[_i2]) {\n          var t = weights[_i2];\n          weights[_i2] = weights[j];\n          weights[j] = t;\n          t = originalWeightIndices[_i2];\n          originalWeightIndices[_i2] = originalWeightIndices[j];\n          originalWeightIndices[j] = t;\n        }\n      }\n    }\n\n    node.traverse(function (mesh) {\n      if (mesh.isMesh && mesh.geometry && mesh.geometry.isMorphGeometry) {\n        mesh.geometry.update(weights, originalWeightIndices);\n      }\n    });\n  },\n\n  /**\n   * 更新指定元素的状态\n   * @param {number} time 时间，从keyTime中查找到状态然后更新\n   * @param {Node} node 需要更新的元素\n   */\n  updateNodeState: function updateNodeState(time, node) {\n    if (!node) {\n      return;\n    }\n\n    var type = this.type;\n\n    if (type === AnimationStates.StateType.ROTATION) {\n      type = AnimationStates.StateType.QUATERNION;\n    }\n\n    var state = this.getState(time);\n\n    if (!state) {\n      return;\n    }\n\n    var fnName = 'updateNode' + type;\n\n    if (this[fnName]) {\n      this[fnName](node, state);\n    } else if (AnimationStates._extraStateHandlers.handler[type]) {\n      AnimationStates._extraStateHandlers.handler[type].call(this, node, state);\n    } else {\n      utils_log.warnOnce(fnName, 'updateNodeState failed unknow type(%s)', type);\n    }\n  },\n\n  /**\n   * clone\n   * @return {AnimationStates} 返回clone的实例\n   */\n  clone: function clone() {\n    return new this.constructor({\n      keyTime: this.keyTime,\n      states: this.states,\n      type: this.type,\n      nodeName: this.nodeName\n    });\n  }\n});\n/* harmony default export */ var animation_AnimationStates = (AnimationStates);\n// CONCATENATED MODULE: ./src/animation/Animation.js\n\n\n\n\n/**\n * 动画类\n * @class\n * @mixes EventMixin\n * @fires end 动画完全结束事件\n * @fires loopEnd 动画每次循环结束事件\n */\n\nvar Animation = core_Class.create(\n/** @lends Animation.prototype */\n{\n  Statics: {\n    _anims: [],\n\n    /**\n     * tick\n     * @memberOf Animation\n     * @method tick\n     * @param {Number} dt 一帧时间\n     */\n    tick: function tick(dt) {\n      this._anims.forEach(function (anim) {\n        return anim.tick(dt);\n      });\n    }\n  },\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isAnimation: true,\n\n  /**\n   * @default Animation\n   * @type {string}\n   */\n  className: 'Animation',\n\n  /**\n   * 动画是否暂停\n   * @default false\n   * @type {boolean}\n   */\n  paused: false,\n\n  /**\n   * 动画当前播放次数\n   * @default 0\n   * @type {number}\n   */\n  currentLoopCount: 0,\n\n  /**\n   * 动画需要播放的次数，默认值为 Infinity 表示永远循环\n   * @default Infinity\n   * @type {number}\n   */\n  loop: Infinity,\n\n  /**\n   * 动画当前时间\n   * @default 0\n   * @type {number}\n   */\n  currentTime: 0,\n\n  /**\n   * 动画播放速度\n   * @default 1\n   * @type {number}\n   */\n  timeScale: 1,\n\n  /**\n   * 动画开始时间\n   * @default 0\n   * @type {number}\n   */\n  startTime: 0,\n\n  /**\n   * 动画结束时间，初始化后会根据 AnimationStates 来自动获取，也可以通过 play 来改变\n   * @default 0\n   * @type {number}\n   */\n  endTime: 0,\n\n  /**\n   * 动画整体的最小时间，初始化后会根据 AnimationStates 来自动获取\n   * @default 0\n   * @type {number}\n   */\n  clipStartTime: 0,\n\n  /**\n   * 动画整体的最大时间，初始化后会根据 AnimationStates 来自动获取\n   * @default 0\n   * @type {number}\n   */\n  clipEndTime: 0,\n  nodeNameMap: null,\n  _rootNode: null,\n\n  /**\n   * 动画根节点，不指定根节点将无法正常播放动画\n   * @default null\n   * @type {Node}\n   */\n  rootNode: {\n    get: function get() {\n      return this._rootNode;\n    },\n    set: function set(value) {\n      this._rootNode = value;\n      this.initNodeNameMap();\n    }\n  },\n\n  /**\n   * AnimationId集合\n   * @type {Object}\n   */\n  validAnimationIds: null,\n\n  /**\n   * @constructs\n   * @param {Object} [parmas] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(parmas) {\n    /**\n     * @type {string}\n     */\n    this.id = math_math.generateUUID(this.className);\n    /**\n     * 动画状态列表\n     * @default []\n     * @type {AnimationStates[]}\n     */\n\n    this.animStatesList = [];\n    /**\n     * 动画剪辑列表，{ name: { start: 0, end: 1} }，play的时候可以通过name来播放某段剪辑\n     * @default {}\n     * @type {Object}\n     */\n\n    this.clips = {};\n    Object.assign(this, parmas);\n    this.initClipTime();\n  },\n\n  /**\n   * 添加动画剪辑\n   * @param {string} name 剪辑名字\n   * @param {number} start 动画开始时间\n   * @param {number} end 动画结束时间\n   * @param {AnimationStates[]} animStatesList 动画帧列表\n   */\n  addClip: function addClip(name, start, end, animStatesList) {\n    this.clips[name] = {\n      start: start,\n      end: end,\n      animStatesList: animStatesList\n    };\n  },\n\n  /**\n   * 移除动画剪辑\n   * @param {string} name 需要移除的剪辑名字\n   */\n  removeClip: function removeClip(name) {\n    this.clips[name] = null;\n  },\n\n  /**\n   * 获取动画列表的时间信息\n   * @param  {AnimationStates[]} animStatesList 动画列表\n   * @return {Object} result {startTime, endTime} 时间信息\n   */\n  getAnimStatesListTimeInfo: function getAnimStatesListTimeInfo(animStatesList) {\n    var endTime = 0;\n    var startTime = Infinity;\n    animStatesList.forEach(function (animStates) {\n      endTime = Math.max(animStates.keyTime[animStates.keyTime.length - 1], endTime);\n      startTime = Math.min(animStates.keyTime[0], startTime);\n    });\n    return {\n      startTime: startTime,\n      endTime: endTime\n    };\n  },\n  initClipTime: function initClipTime() {\n    var timeInfo = this.getAnimStatesListTimeInfo(this.animStatesList);\n    this.clipStartTime = timeInfo.startTime;\n    this.clipEndTime = timeInfo.endTime;\n  },\n  initNodeNameMap: function initNodeNameMap() {\n    if (this._rootNode) {\n      var map = this.nodeNameMap = {};\n\n      this._rootNode.traverse(function (child) {\n        map[child.animationId] = child; // fix smd animation bug\n\n        var originName = child.name;\n\n        if (originName !== undefined && !map[originName]) {\n          map[originName] = child;\n        }\n      }, false);\n    }\n  },\n\n  /**\n   * tick\n   * @param  {Number} dt\n   */\n  tick: function tick(dt) {\n    if (this.paused) {\n      return;\n    }\n\n    this.currentTime += dt / 1000 * this.timeScale; // 当前动画结束\n\n    if (this.currentTime >= this.endTime) {\n      this.currentLoopCount++; // 渲染最后一帧\n\n      this.currentTime = this.endTime;\n      this.updateAnimStates();\n      this.fire('loopEnd'); // 动画完全结束\n\n      if (!this.loop || this.currentLoopCount >= this.loop) {\n        this.stop();\n        this.fire('end');\n      } else {\n        this.currentTime = this.startTime;\n      }\n    } else {\n      this.updateAnimStates();\n    }\n  },\n\n  /**\n   * 更新动画状态\n   * @return {Animation} this\n   */\n  updateAnimStates: function updateAnimStates() {\n    var _this = this;\n\n    this.animStatesList.forEach(function (animStates) {\n      animStates.updateNodeState(_this.currentTime, _this.nodeNameMap[animStates.nodeName]);\n    });\n    return this;\n  },\n\n  /**\n   * 播放动画(剪辑)\n   * @param {number|string} [startOrClipName=0] 动画开始时间，或者动画剪辑名字\n   * @param {number} [end=this.clipEndTime] 动画结束时间，如果是剪辑的话不需要传\n   */\n  play: function play(startOrClipName, end) {\n    var start;\n\n    if (typeof startOrClipName === 'string') {\n      var clip = this.clips[startOrClipName];\n\n      if (clip) {\n        start = clip.start;\n        end = clip.end;\n\n        if (clip.animStatesList) {\n          this.animStatesList = clip.animStatesList;\n          this.initClipTime();\n        }\n      } else {\n        utils_log.warn('no this animation clip name:' + startOrClipName);\n      }\n    } else {\n      start = startOrClipName;\n    }\n\n    if (start === undefined) {\n      start = this.clipStartTime;\n    }\n\n    if (end === undefined) {\n      end = this.clipEndTime;\n    }\n\n    this.endTime = Math.min(end, this.clipEndTime);\n    this.startTime = Math.min(start, this.endTime);\n    this.currentTime = this.startTime;\n    this.currentLoopCount = 0; // 先移除，然后再插入\n\n    this.stop();\n    this.paused = false;\n\n    Animation._anims.push(this);\n  },\n\n  /**\n   * 停止动画，这个会将动画从Ticker中移除，需要重新调用play才能再次播放\n   */\n  stop: function stop() {\n    this.paused = true;\n    var anims = Animation._anims;\n    var index = anims.indexOf(this);\n\n    if (index !== -1) {\n      anims.splice(index, 1);\n    }\n  },\n\n  /**\n   * 暂停动画，这个不会将动画从Ticker中移除\n   */\n  pause: function pause() {\n    this.paused = true;\n  },\n\n  /**\n   * 恢复动画播放，只能针对 pause 暂停后恢复\n   */\n  resume: function resume() {\n    this.paused = false;\n  },\n\n  /**\n   * clone动画\n   * @param {Node} rootNode 目标动画根节点\n   * @return {Animation} clone的动画对象\n   */\n  clone: function clone(rootNode) {\n    var anim = new this.constructor({\n      rootNode: rootNode,\n      animStatesList: this.animStatesList,\n      timeScale: this.timeScale,\n      loop: this.loop,\n      paused: this.paused,\n      currentTime: this.currentTime,\n      startTime: this.startTime,\n      endTime: this.endTime,\n      clips: this.clips\n    });\n\n    if (!this.paused) {\n      anim.play();\n    }\n\n    return anim;\n  }\n});\n/* harmony default export */ var animation_Animation = (Animation);\n// CONCATENATED MODULE: ./src/loader/GLTFParser.js\nfunction GLTFParser_slicedToArray(arr, i) { return GLTFParser_arrayWithHoles(arr) || GLTFParser_iterableToArrayLimit(arr, i) || GLTFParser_unsupportedIterableToArray(arr, i) || GLTFParser_nonIterableRest(); }\n\nfunction GLTFParser_nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction GLTFParser_unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return GLTFParser_arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return GLTFParser_arrayLikeToArray(o, minLen); }\n\nfunction GLTFParser_arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction GLTFParser_iterableToArrayLimit(arr, i) { if (typeof Symbol === \"undefined\" || !(Symbol.iterator in Object(arr))) return; var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction GLTFParser_arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nvar GLTFParser_BLEND = src_constants.BLEND,\n    GLTFParser_DEPTH_TEST = src_constants.DEPTH_TEST,\n    GLTFParser_CULL_FACE = src_constants.CULL_FACE,\n    GLTFParser_FRONT = src_constants.FRONT,\n    GLTFParser_BACK = src_constants.BACK,\n    GLTFParser_FRONT_AND_BACK = src_constants.FRONT_AND_BACK;\nvar ComponentTypeMap = {\n  5120: [1, Int8Array],\n  5121: [1, Uint8Array],\n  5122: [2, Int16Array],\n  5123: [2, Uint16Array],\n  5125: [4, Uint32Array],\n  5126: [4, Float32Array]\n};\nvar ComponentNumberMap = {\n  SCALAR: 1,\n  VEC2: 2,\n  VEC3: 3,\n  VEC4: 4,\n  MAT2: 4,\n  MAT3: 9,\n  MAT4: 16\n};\nvar GLTFParser_glTFAttrToGeometry = {\n  POSITION: {\n    name: 'vertices',\n    decodeMatName: 'positionDecodeMat'\n  },\n  TEXCOORD_0: {\n    name: 'uvs',\n    decodeMatName: 'uvDecodeMat'\n  },\n  TEXCOORD_1: {\n    name: 'uvs1',\n    decodeMatName: 'uv1DecodeMat'\n  },\n  NORMAL: {\n    name: 'normals',\n    decodeMatName: 'normalDecodeMat'\n  },\n  JOINT: {\n    name: 'skinIndices'\n  },\n  JOINTS_0: {\n    name: 'skinIndices'\n  },\n  WEIGHT: {\n    name: 'skinWeights'\n  },\n  WEIGHTS_0: {\n    name: 'skinWeights'\n  },\n  TANGENT: {\n    name: 'tangents'\n  },\n  COLOR_0: {\n    name: 'colors'\n  }\n};\n/**\n * @class\n */\n\nvar GLTFParser = core_Class.create(\n/** @lends GLTFParser.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isGLTFParser: true,\n\n  /**\n   * @default GLTFParser\n   * @type {string}\n   */\n  className: 'GLTFParser',\n  Statics:\n  /** @lends GLTFParser */\n  {\n    MAGIC: 'glTF',\n\n    /**\n     * 扩展接口\n     * @type {Object}\n     */\n    extensionHandlers: GLTFExtensions_namespaceObject,\n\n    /**\n     * 注册扩展接口\n     * @param  {String} extensionName 接口名称\n     * @param  {IGLTFExtensionHandler} handler 接口\n     */\n    registerExtensionHandler: function registerExtensionHandler(extensionName, handler) {\n      this.extensionHandlers[extensionName] = handler;\n    },\n\n    /**\n     * 取消注册扩展接口\n     * @param  {String} extensionName 接口名称\n     */\n    unregisterExtensionHandler: function unregisterExtensionHandler(extensionName) {\n      if (this.extensionHandlers[extensionName]) {\n        delete this.extensionHandlers[extensionName];\n      }\n    }\n  },\n  isMultiAnim: true,\n  isProgressive: false,\n  isUnQuantizeInShader: true,\n  isLoadAllTextures: false,\n  preHandlerImageURI: null,\n  preHandlerBufferURI: null,\n  customMaterialCreator: null,\n  ignoreTextureError: false,\n  forceCreateNewBuffer: false,\n  src: '',\n\n  /**\n   * @constructs\n   * @param  {ArrayBuffer|String} content\n   * @param  {Object} params\n   */\n  constructor: function constructor(content, params) {\n    Object.assign(this, params);\n    this.content = content;\n  },\n  parse: function parse(loader) {\n    var _this = this;\n\n    if (this.content instanceof ArrayBuffer) {\n      var buffer = this.content;\n      var magic = convertUint8ArrayToString(new Uint8Array(buffer, 0, 4));\n\n      if (magic === GLTFParser.MAGIC) {\n        this.parseBinary(buffer);\n      } else {\n        var content = convertUint8ArrayToString(new Uint8Array(buffer), true);\n        this.json = JSON.parse(content);\n      }\n    } else {\n      this.json = JSON.parse(this.content);\n    }\n\n    this.glTFVersion = parseFloat(this.json.asset.version);\n\n    if (this.glTFVersion >= 2) {\n      this.isGLTF2 = true;\n    }\n\n    this.parseExtensionUsed();\n    return this.loadResources(loader).then(function () {\n      _this.parseExtensions(_this.json.extensions, null, {\n        isGlobal: true,\n        methodName: 'parseOnLoad'\n      });\n\n      return Promise.resolve();\n    }).then(function () {\n      return _this.parseGeometries();\n    }).then(function () {\n      return _this.parseScene();\n    });\n  },\n  parseExtensionUsed: function parseExtensionUsed() {\n    var _this2 = this;\n\n    this.extensionsUsed = {};\n    util_each(this.json.extensionsUsed, function (name) {\n      _this2.extensionsUsed[name] = true;\n    });\n\n    if (!this.extensionsUsed.WEB3D_quantized_attributes) {\n      // this glTF model havn't use quantize!\n      this.isUnQuantizeInShader = false;\n    }\n  },\n  getExtensionHandler: function getExtensionHandler(name) {\n    return this.extensionHandlers && this.extensionHandlers[name] || GLTFParser.extensionHandlers[name];\n  },\n  parseExtension: function parseExtension(extensions, name, result) {\n    var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n    var info = extensions[name];\n    var extension = this.getExtensionHandler(name);\n\n    if (extension && extension.parse) {\n      return extension.parse(info, this, result, options);\n    }\n\n    return result;\n  },\n  parseExtensions: function parseExtensions(extensions, result) {\n    var _this3 = this;\n\n    var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n    util_each(extensions, function (info, name) {\n      if (options.ignoreExtensions && options.ignoreExtensions[name]) {\n        return;\n      }\n\n      var extension = _this3.getExtensionHandler(name);\n\n      var methodName = options.methodName || 'parse';\n\n      if (extension && extension[methodName]) {\n        result = extension[methodName](info, _this3, result, options);\n      }\n    });\n    return result;\n  },\n  isUseExtension: function isUseExtension(data, extensionName) {\n    return !!(data && data.extensions && data.extensions[extensionName]);\n  },\n  parseBinary: function parseBinary(buffer) {\n    this.isBinary = true;\n    var infoDataView = new DataView(buffer);\n    var version = infoDataView.getUint32(4, true);\n    var totalLength = infoDataView.getUint32(8, true);\n    var content;\n    var start = 12;\n\n    if (version < 2) {\n      var contentLength = infoDataView.getUint32(start, true);\n      content = new Uint8Array(buffer, 20, contentLength);\n      content = convertUint8ArrayToString(content, true);\n      this.json = JSON.parse(content);\n      this.binaryBody = buffer.slice(20 + contentLength);\n    } else if (version === 2) {\n      while (start < totalLength) {\n        var chunkLength = infoDataView.getUint32(start, true);\n        var chunkType = infoDataView.getUint32(start + 4, true);\n\n        if (chunkType === 0x4E4F534A) {\n          // JSON...\n          content = new Uint8Array(buffer, start + 8, chunkLength);\n          content = convertUint8ArrayToString(content, true);\n          this.json = JSON.parse(content);\n        } else if (chunkType === 0x004E4942) {\n          // binary\n          this.binaryBody = buffer.slice(start + 8, start + 8 + chunkLength);\n        }\n\n        start += 8 + chunkLength;\n      }\n    } else {\n      throw new Error(\"Dont support glTF version \".concat(version));\n    }\n  },\n  loadResources: function loadResources(loader) {\n    var _this4 = this;\n\n    var actions = [];\n\n    for (var extensionName in this.extensionsUsed) {\n      var extension = this.getExtensionHandler(extensionName);\n\n      if (extension && extension.init) {\n        actions.push(extension.init(loader, this));\n      }\n    }\n\n    if (this.isBinary) {\n      actions.push(this.loadBuffers(loader).then(function () {\n        return _this4.loadTextures(loader);\n      }));\n    } else {\n      actions.push(this.loadBuffers(loader));\n      actions.push(this.loadTextures(loader));\n    }\n\n    return Promise.all(actions);\n  },\n  getBufferUri: function getBufferUri(bufferName) {\n    var uri = getRelativePath(this.src, this.json.buffers[bufferName].uri);\n\n    if (this.preHandlerBufferURI) {\n      uri = this.preHandlerBufferURI(uri, this.json.buffers[bufferName]);\n    }\n\n    return uri;\n  },\n  loadBuffers: function loadBuffers(loader) {\n    var _this5 = this;\n\n    this.buffers = {};\n\n    if (this.isBinary) {\n      if (this.isGLTF2) {\n        this.buffers[0] = this.binaryBody;\n      } else {\n        this.buffers.binary_glTF = this.binaryBody;\n      }\n\n      this.parseBufferViews();\n      return Promise.resolve();\n    }\n\n    return Promise.all(Object.keys(this.json.buffers || []).map(function (bufferName) {\n      var uri = _this5.getBufferUri(bufferName);\n\n      return loader.loadRes(uri, 'buffer').then(function (buffer) {\n        _this5.buffers[bufferName] = buffer;\n      });\n    })).then(function () {\n      _this5.parseBufferViews();\n    });\n  },\n  getImageUri: function getImageUri(imageName) {\n    var imgData = this.json.images[imageName];\n    var uri = imgData.uri;\n\n    if (this.isUseExtension(imgData, 'KHR_binary_glTF')) {\n      var binaryInfo = imgData.extensions.KHR_binary_glTF;\n      var bufferView = this.bufferViews[binaryInfo.bufferView];\n      var data = new Uint8Array(bufferView.buffer, bufferView.byteOffset, bufferView.byteLength);\n      uri = getBlobUrl(binaryInfo.mimeType, data);\n    } else if (uri) {\n      uri = getRelativePath(this.src, uri);\n    } else if ('bufferView' in imgData) {\n      var _bufferView = this.bufferViews[imgData.bufferView];\n\n      var _data = new Uint8Array(_bufferView.buffer, _bufferView.byteOffset, _bufferView.byteLength);\n\n      if (imgData.mimeType === 'image/ktx') {\n        uri = _data;\n      } else {\n        uri = getBlobUrl(imgData.mimeType, _data);\n      }\n    }\n\n    if (this.preHandlerImageURI) {\n      uri = this.preHandlerImageURI(uri, imgData);\n    }\n\n    return uri;\n  },\n  getImageType: function getImageType(imageName) {\n    var imgData = this.json.images[imageName];\n    var type = '';\n\n    if (imgData && /^image\\/(.*)$/.test(imgData.mimeType)) {\n      type = RegExp.$1;\n    }\n\n    if (['ktx'].indexOf(type) < 0) {\n      // clear type if type is not valid\n      type = '';\n    }\n\n    return type;\n  },\n  getUsedTextureNameMap: function getUsedTextureNameMap() {\n    var _this6 = this;\n\n    var map = {};\n    util_each(this.json.materials, function (material) {\n      var values = material;\n      var isKMC = false;\n\n      if (_this6.isUseExtension(material, 'KHR_materials_common')) {\n        isKMC = true;\n        values = material.extensions.KHR_materials_common.values;\n      }\n\n      if (_this6.isGLTF2 && !isKMC) {\n        // glTF 2.0\n        if (values.normalTexture) {\n          map[values.normalTexture.index] = true;\n        }\n\n        if (values.occlusionTexture) {\n          map[values.occlusionTexture.index] = true;\n        }\n\n        if (values.emissiveTexture) {\n          map[values.emissiveTexture.index] = true;\n        }\n\n        if (values.transparencyTexture) {\n          map[values.transparencyTexture.index] = true;\n        }\n\n        if (_this6.isUseExtension(values, 'KHR_materials_pbrSpecularGlossiness')) {\n          var subValues = values.extensions.KHR_materials_pbrSpecularGlossiness;\n\n          var extensionHandler = _this6.getExtensionHandler('KHR_materials_pbrSpecularGlossiness');\n\n          extensionHandler.getUsedTextureNameMap(subValues, map, _this6);\n        } else if (_this6.isUseExtension(values, 'KHR_techniques_webgl')) {\n          var _subValues = values.extensions.KHR_techniques_webgl;\n\n          var _extensionHandler = _this6.getExtensionHandler('KHR_techniques_webgl');\n\n          _extensionHandler.getUsedTextureNameMap(_subValues, map, _this6);\n        } else if (values.pbrMetallicRoughness) {\n          var _subValues2 = values.pbrMetallicRoughness;\n\n          if (_subValues2.baseColorTexture) {\n            map[_subValues2.baseColorTexture.index] = true;\n          }\n\n          if (_subValues2.metallicRoughnessTexture) {\n            map[_subValues2.metallicRoughnessTexture.index] = true;\n          }\n        }\n      } else {\n        // glTF 1.0\n        if (!isKMC) {\n          values = material.values;\n        }\n\n        ['diffuse', 'specular', 'emission', 'ambient', 'transparency', 'normalMap'].forEach(function (name) {\n          var value = values[name];\n\n          if (value instanceof Object && 'index' in value) {\n            value = value.index;\n          }\n\n          if (isStrOrNumber(value) && _this6.json.textures[value]) {\n            map[value] = true;\n          }\n        });\n      }\n    });\n    return map;\n  },\n  loadTextures: function loadTextures() {\n    var _this7 = this;\n\n    this.textures = {};\n\n    if (!this.json.textures) {\n      return Promise.resolve();\n    }\n\n    var needLoadTextures = Object.keys(this.json.textures);\n\n    if (!this.isLoadAllTextures) {\n      var usedTextures = this.getUsedTextureNameMap();\n      needLoadTextures = needLoadTextures.filter(function (textureName) {\n        return usedTextures[textureName];\n      });\n    }\n\n    return Promise.all(needLoadTextures.map(function (textureName) {\n      var textureData = _this7.json.textures[textureName];\n\n      var uri = _this7.getImageUri(textureData.source);\n\n      var texture = new texture_LazyTexture(textureData);\n      texture.uv = undefined;\n      texture.autoLoad = _this7.isProgressive;\n      texture.crossOrigin = true;\n      texture.resType = _this7.getImageType(textureData.source);\n      texture.src = uri;\n      texture.name = textureData.name || textureName;\n\n      if (isBlobUrl(uri)) {\n        var onTextureLoad = function onTextureLoad() {\n          revokeBlobUrl(uri);\n          texture.off('load', onTextureLoad);\n          texture.off('error', onTextureLoad);\n        };\n\n        texture.on('load', onTextureLoad, true);\n        texture.on('error', onTextureLoad, true);\n      }\n\n      if (_this7.json.samplers) {\n        Object.assign(texture, _this7.json.samplers[textureData.sampler]);\n      }\n\n      if (textureData.extensions) {\n        texture = _this7.parseExtensions(textureData.extensions, texture);\n      }\n\n      _this7.textures[textureName] = texture;\n\n      if (!_this7.isProgressive) {\n        return texture.load(!_this7.ignoreTextureError);\n      }\n\n      return Promise.resolve();\n    }));\n  },\n  parseBufferViews: function parseBufferViews() {\n    var _this8 = this;\n\n    this.bufferViews = {};\n    util_each(this.json.bufferViews, function (data, name) {\n      var buffer = _this8.buffers[data.buffer];\n      var byteOffset = data.byteOffset || 0;\n      var byteLength = data.byteLength;\n      _this8.bufferViews[name] = {\n        id: math_math.generateUUID('bufferView'),\n        byteOffset: byteOffset,\n        byteLength: byteLength,\n        buffer: buffer,\n        byteStride: data.byteStride\n      };\n    });\n\n    if (!this.isBinary) {\n      delete this.buffers;\n    }\n  },\n  // get Texture for glTF 2.0\n  getTexture: function getTexture(textureInfo) {\n    var texture = this.textures[textureInfo.index];\n\n    if (!texture) {\n      return null;\n    }\n\n    var texCoord = textureInfo.texCoord || 0;\n    var key = textureInfo.index + '_' + texCoord;\n\n    if (this.textures[key]) {\n      texture = this.textures[key];\n    } else if (typeof texture.uv === 'number' && texture.uv !== texCoord) {\n      texture = texture.clone();\n      this.textures[key] = texture;\n    }\n\n    texture.uv = texCoord;\n    texture.__gltfTextureInfo = textureInfo;\n    return texture;\n  },\n  getColorOrTexture: function getColorOrTexture(value) {\n    if (Array.isArray(value)) {\n      return new math_Color(value[0], value[1], value[2]);\n    }\n\n    if (value instanceof Object && 'index' in value) {\n      value = value.index;\n    }\n\n    return this.textures[value];\n  },\n  parseMaterialCommonProps: function parseMaterialCommonProps(material, materialData) {\n    switch (materialData.alphaMode) {\n      case 'BLEND':\n        material.transparent = true;\n        break;\n\n      case 'MASK':\n        if ('alphaCutoff' in materialData) {\n          material.alphaCutoff = materialData.alphaCutoff;\n        } else {\n          material.alphaCutoff = 0.5;\n        }\n\n        break;\n\n      case 'OPAQUE':\n      default:\n        material.ignoreTranparent = true;\n        break;\n    }\n\n    if (!materialData.doubleSided) {\n      material.side = GLTFParser_FRONT;\n    } else {\n      material.side = GLTFParser_FRONT_AND_BACK;\n    }\n\n    if (materialData.transparencyTexture) {\n      material.transparency = this.getTexture(materialData.transparencyTexture);\n    }\n  },\n  createPBRMaterial: function createPBRMaterial(materialData) {\n    var material = new material_PBRMaterial();\n    var values = materialData;\n    var needLight = !this.isUseExtension(values, 'KHR_materials_unlit');\n\n    if (needLight) {\n      var normalTexture = values.normalTexture;\n\n      if (normalTexture) {\n        material.normalMap = this.getTexture(normalTexture);\n\n        if (normalTexture.scale !== undefined) {\n          material.normalMapScale = normalTexture.scale;\n        } else {\n          material.normalMapScale = 1;\n        }\n      }\n\n      var occlusionTexture = values.occlusionTexture;\n\n      if (occlusionTexture) {\n        material.occlusionMap = this.getTexture(occlusionTexture);\n\n        if (occlusionTexture.strength !== undefined) {\n          material.occlusionStrength = occlusionTexture.strength;\n        } else {\n          material.occlusionStrength = 1;\n        }\n      }\n\n      var emissiveTexture = values.emissiveTexture;\n\n      if (emissiveTexture) {\n        material.emission = this.getTexture(emissiveTexture);\n      }\n    } else {\n      material.lightType = 'NONE';\n    }\n\n    if (this.isUseExtension(values, 'KHR_materials_pbrSpecularGlossiness')) {\n      this.parseExtension(values.extensions, 'KHR_materials_pbrSpecularGlossiness', material);\n    } else if (values.pbrMetallicRoughness) {\n      var subValues = values.pbrMetallicRoughness;\n\n      if (subValues.baseColorFactor) {\n        material.baseColor.fromArray(subValues.baseColorFactor);\n      }\n\n      if (subValues.baseColorTexture) {\n        material.baseColorMap = this.getTexture(subValues.baseColorTexture);\n      }\n\n      if (needLight) {\n        if (subValues.metallicRoughnessTexture) {\n          material.metallicRoughnessMap = this.getTexture(subValues.metallicRoughnessTexture);\n\n          if (material.occlusionMap === material.metallicRoughnessMap) {\n            material.occlusionMap = null;\n            material.isOcclusionInMetallicRoughnessMap = true;\n          }\n        }\n\n        if ('roughnessFactor' in subValues) {\n          material.roughness = subValues.roughnessFactor;\n        }\n\n        if ('metallicFactor' in subValues) {\n          material.metallic = subValues.metallicFactor;\n        }\n      }\n    }\n\n    if (material.baseColorMap) {\n      this._parseTextureTransform(material, material.baseColorMap);\n    }\n\n    return material;\n  },\n  _parseTextureTransform: function _parseTextureTransform(material, texture) {\n    var textureInfo = texture.__gltfTextureInfo;\n\n    if (this.isUseExtension(textureInfo, 'KHR_texture_transform')) {\n      var transformInfo = textureInfo.extensions.KHR_texture_transform;\n\n      if (transformInfo.texCoord !== undefined) {\n        texture.uv = transformInfo.texCoord;\n      }\n\n      if (transformInfo.offset || transformInfo.rotation || transformInfo.scale) {\n        var offset = transformInfo.offset || [0, 0];\n        var rotation = transformInfo.rotation || 0;\n        var scale = transformInfo.scale || [1, 1];\n        var uvMatrix = new math_Matrix3().fromRotationTranslationScale(rotation, offset[0], offset[1], scale[0], scale[1]);\n\n        if (texture.uv === 0) {\n          material.uvMatrix = uvMatrix;\n        } else if (texture.uv === 1) {\n          material.uvMatrix1 = uvMatrix;\n        }\n      }\n    }\n  },\n  createKMCMaterial: function createKMCMaterial(materialData, kmc) {\n    var material = new material_BasicMaterial();\n    var values;\n\n    if (kmc) {\n      values = kmc.values;\n      material.lightType = kmc.technique;\n    } else {\n      values = materialData.values;\n    } // glTF 1.0 or KMC\n\n\n    material.diffuse = this.getColorOrTexture(values.diffuse) || material.diffuse;\n    material.specular = this.getColorOrTexture(values.specular) || material.specular;\n    material.emission = this.getColorOrTexture(values.emission) || material.emission;\n    material.ambient = this.getColorOrTexture(values.ambient) || material.ambient;\n\n    if (values.normalMap) {\n      material.normalMap = this.getColorOrTexture(values.normalMap);\n    }\n\n    if (typeof values.transparency === 'number') {\n      material.transparency = values.transparency;\n\n      if (material.transparency < 1) {\n        material.transparent = true;\n      }\n    } else if (typeof values.transparency === 'string') {\n      material.transparency = this.getColorOrTexture(values.transparency);\n      material.transparent = true;\n    }\n\n    if (values.transparent === true) {\n      material.transparent = true;\n    }\n\n    if ('shininess' in values) {\n      material.shininess = values.shininess;\n    }\n\n    this._parseTextureTransform(material, material.diffuse);\n\n    return material;\n  },\n  parseMaterials: function parseMaterials() {\n    var _this9 = this;\n\n    this.materials = {};\n    util_each(this.json.materials, function (materialData, name) {\n      if (_this9.customMaterialCreator) {\n        var _material = _this9.customMaterialCreator(name, materialData, _this9.json, _this9);\n\n        if (_material) {\n          _this9.materials[name] = _material;\n          return;\n        }\n      }\n\n      var kmc = null;\n\n      if (_this9.isUseExtension(materialData, 'KHR_materials_common')) {\n        kmc = materialData.extensions.KHR_materials_common;\n      }\n\n      var material;\n\n      if (_this9.isGLTF2 && !kmc) {\n        if (_this9.isUseExtension(materialData, 'KHR_techniques_webgl')) {\n          material = _this9.parseExtension(materialData.extensions, 'KHR_techniques_webgl');\n        } else {\n          material = _this9.createPBRMaterial(materialData);\n        }\n\n        _this9.parseMaterialCommonProps(material, materialData);\n      } else {\n        material = _this9.createKMCMaterial(materialData, kmc);\n      }\n\n      material = _this9.parseExtensions(materialData.extensions, material, {\n        ignoreExtensions: {\n          KHR_techniques_webgl: 1,\n          KHR_materials_common: 1,\n          KHR_materials_pbrSpecularGlossiness: 1\n        },\n        isMaterial: true\n      });\n      material.name = materialData.name || name;\n      _this9.materials[name] = material;\n\n      _this9.parseTechnique(materialData, material);\n    });\n  },\n  sparseAccessorHandler: function sparseAccessorHandler(data, sparse) {\n    if (!sparse) {\n      return data;\n    }\n\n    var count = sparse.count; // if dont create a new TpyedArray here, it will change the origin data in buffer\n\n    var TypedArray = data.data.constructor;\n    var newArray = new TypedArray(data.realLength);\n    newArray.set(data.data);\n    data.data = newArray; // values\n\n    var buffer = this.bufferViews[sparse.values.bufferView];\n    var values = new TypedArray(buffer.buffer, buffer.byteOffset + (sparse.values.byteOffset || 0), count * data.size); // indices\n\n    TypedArray = ComponentTypeMap[sparse.indices.componentType][1];\n    buffer = this.bufferViews[sparse.indices.bufferView];\n    var indices = new TypedArray(buffer.buffer, buffer.byteOffset + (sparse.indices.byteOffset || 0), count); // change it\n\n    for (var i = 0; i < count; i++) {\n      copyArrayData(newArray, values, indices[i] * data.size, i * data.size, data.size);\n    }\n\n    return data;\n  },\n  getAccessorData: function getAccessorData(name, isDecode) {\n    var accessor = this.json.accessors[name];\n\n    if (accessor.data) {\n      return accessor.data;\n    }\n\n    var _ComponentTypeMap$acc = GLTFParser_slicedToArray(ComponentTypeMap[accessor.componentType], 2),\n        TypedArray = _ComponentTypeMap$acc[1];\n\n    var number = ComponentNumberMap[accessor.type];\n    var bufferView = this.bufferViews[accessor.bufferView];\n    var count = accessor.count * number;\n    var result;\n\n    if (bufferView) {\n      if (bufferView.byteStride && bufferView.byteStride > number * TypedArray.BYTES_PER_ELEMENT) {\n        bufferView.array = new TypedArray(bufferView.buffer, bufferView.byteOffset, bufferView.byteLength / TypedArray.BYTES_PER_ELEMENT);\n        result = new geometry_GeometryData(bufferView.array, number, {\n          offset: accessor.byteOffset || 0,\n          stride: bufferView.byteStride,\n          bufferViewId: bufferView.id\n        });\n      } else {\n        var offset = (accessor.byteOffset || 0) + bufferView.byteOffset;\n        var array;\n\n        if (offset % TypedArray.BYTES_PER_ELEMENT || this.forceCreateNewBuffer) {\n          var buffer = bufferView.buffer.slice(offset, offset + count * TypedArray.BYTES_PER_ELEMENT);\n          array = new TypedArray(buffer);\n        } else {\n          array = new TypedArray(bufferView.buffer, offset, count);\n        }\n\n        result = new geometry_GeometryData(array, number);\n      }\n    }\n\n    if (accessor.sparse) {\n      if (!result) {\n        result = new geometry_GeometryData(new TypedArray(count), number);\n      }\n\n      result = this.sparseAccessorHandler(result, accessor.sparse);\n    }\n\n    result = this.parseExtensions(accessor.extensions, result, {\n      isDecode: isDecode,\n      isAccessor: true\n    });\n    accessor.data = result;\n\n    if (accessor.normalized) {\n      result.normalized = true;\n    }\n\n    return result;\n  },\n  getArrayByAccessor: function getArrayByAccessor(name, isDecode) {\n    var accessor = this.json.accessors[name];\n\n    if (accessor.array) {\n      return accessor.array;\n    }\n\n    var data = this.getAccessorData(name, isDecode);\n\n    if (!data.stride && !data.offset && data.size === 1) {\n      return data.data;\n    }\n\n    var result = [];\n    data.traverse(function (d) {\n      result.push(d.toArray ? d.toArray() : d);\n    });\n    accessor.array = result;\n    return result;\n  },\n  parseTechnique: function parseTechnique(materialData, material) {\n    var technique = null;\n\n    if (this.json.techniques) {\n      technique = this.json.techniques[materialData.technique];\n    }\n\n    if (!technique) {\n      return;\n    }\n\n    if (!technique.states) {\n      return;\n    }\n\n    technique.states.enable.forEach(function (flag) {\n      switch (flag) {\n        case GLTFParser_BLEND:\n          material.blend = true;\n          break;\n\n        case GLTFParser_DEPTH_TEST:\n          material.depthTest = true;\n          break;\n\n        case GLTFParser_CULL_FACE:\n          material.cullFace = true;\n          break;\n      }\n    });\n    util_each(technique.states.functions, function (value, fnName) {\n      switch (fnName) {\n        case 'blendEquationSeparate':\n          material.blendEquation = value[0];\n          material.blendEquationAlpha = value[1];\n          break;\n\n        case 'blendFuncSeparate':\n          material.blendSrc = value[0];\n          material.blendDst = value[1];\n          material.blendSrcAlpha = value[2];\n          material.blendDstAlpha = value[3];\n          break;\n\n        case 'depthMask':\n          material.depthMask = value[0];\n          break;\n\n        case 'cullFace':\n          material.cullFaceType = value[0];\n          break;\n\n        default:\n          material[fnName] = value;\n          break;\n      }\n    });\n\n    if (material.cullFace) {\n      material.side = material.cullFaceType === GLTFParser_FRONT ? GLTFParser_BACK : GLTFParser_FRONT;\n    } else {\n      material.side = GLTFParser_FRONT_AND_BACK;\n    }\n  },\n  createMorphGeometry: function createMorphGeometry(primitive, weights) {\n    var _this10 = this;\n\n    // MorphGeometry\n    var geometry = new geometry_MorphGeometry();\n    var targets = geometry.targets = {};\n    util_each(primitive.targets, function (target) {\n      util_each(target, function (accessorName, name) {\n        var geometryName = GLTFParser_glTFAttrToGeometry[name].name;\n\n        if (!targets[geometryName]) {\n          targets[geometryName] = [];\n        }\n\n        var data = _this10.getAccessorData(accessorName, true);\n\n        targets[geometryName].push(data);\n      });\n    });\n\n    if (weights) {\n      geometry.weights = weights;\n    } else {\n      geometry.weights = new Float32Array(primitive.targets.length);\n    }\n\n    return geometry;\n  },\n  handlerGeometry: function handlerGeometry(geometry, primitive) {\n    var mode = primitive.mode === undefined ? 4 : primitive.mode;\n\n    if (primitive.extensions) {\n      var extensionGeometry = this.parseExtensions(primitive.extensions, null, {\n        primitive: primitive,\n        isPrimitive: true\n      });\n\n      if (extensionGeometry) {\n        extensionGeometry.mode = mode;\n        return extensionGeometry;\n      }\n    }\n\n    if (!geometry) {\n      geometry = new geometry_Geometry({\n        mode: mode\n      });\n    }\n\n    if ('indices' in primitive) {\n      geometry.indices = this.getAccessorData(primitive.indices);\n    }\n\n    var attr = primitive.attributes;\n\n    for (var name in attr) {\n      var info = GLTFParser_glTFAttrToGeometry[name];\n\n      if (!info) {\n        utils_log.warn(\"Unknow attribute named \".concat(name, \"!\"));\n        continue;\n      }\n\n      var isDecode = !(this.isUnQuantizeInShader && info.decodeMatName);\n      geometry[info.name] = this.getAccessorData(attr[name], isDecode);\n\n      if (!isDecode) {\n        geometry[info.decodeMatName] = geometry[info.name].decodeMat;\n        delete geometry[info.name].decodeMat;\n      }\n    }\n\n    return geometry;\n  },\n  handlerSkinedMesh: function handlerSkinedMesh(mesh, skeleton) {\n    if (!skeleton) {\n      return;\n    }\n\n    mesh.skeleton = skeleton;\n\n    if (this.useInstanced) {\n      mesh.useInstanced = true;\n    }\n  },\n  fixProgressiveGeometry: function fixProgressiveGeometry(primitive, geometry) {\n    primitive._geometry = geometry;\n\n    if (this.isProgressive && primitive._meshes) {\n      primitive._meshes.forEach(function (mesh) {\n        mesh.visible = true;\n        mesh.geometry = geometry;\n      });\n    }\n  },\n  parseGeometries: function parseGeometries() {\n    var _this11 = this;\n\n    var promise = serialRun(this.json.meshes, function (meshData) {\n      return serialRun(meshData.primitives, function (primitive) {\n        var geometry;\n\n        if (primitive.targets && primitive.targets.length) {\n          geometry = _this11.createMorphGeometry(primitive, meshData.weights);\n        }\n\n        primitive._geometry = geometry;\n\n        var result = _this11.handlerGeometry(geometry, primitive);\n\n        if (result && result.then) {\n          return result.then(function (geometry) {\n            _this11.fixProgressiveGeometry(primitive, geometry);\n          }, function (err) {\n            utils_log.error('geometry parse error', err);\n          });\n        }\n\n        _this11.fixProgressiveGeometry(primitive, result);\n\n        return result;\n      });\n    });\n    return this.isProgressive ? null : promise;\n  },\n  parseMesh: function parseMesh(meshName, node, nodeData) {\n    var _this12 = this;\n\n    var meshData = this.json.meshes[meshName];\n    meshData.primitives.forEach(function (primitive) {\n      var mesh;\n      var skin = _this12.skins && _this12.skins[nodeData.skin];\n\n      if (primitive.meshNode) {\n        mesh = primitive.meshNode.clone();\n      } else {\n        var material = _this12.materials[primitive.material] || new material_BasicMaterial();\n        var MeshClass = skin ? core_SkinedMesh : core_Mesh;\n        mesh = new MeshClass({\n          geometry: primitive._geometry,\n          material: material,\n          name: 'mesh-' + (meshData.name || meshName)\n        });\n        primitive.meshNode = mesh;\n      }\n\n      _this12.handlerSkinedMesh(mesh, skin);\n\n      if (_this12.isProgressive && !mesh.geometry) {\n        mesh.visible = false;\n        primitive._meshes = primitive._meshes || [];\n\n        primitive._meshes.push(mesh);\n      }\n\n      node.addChild(mesh);\n\n      _this12.meshes.push(mesh);\n    });\n  },\n  parseCameras: function parseCameras() {\n    var _this13 = this;\n\n    this.cameras = {};\n    var defaultAspect = window.innerWidth / window.innerHeight;\n    util_each(this.json.cameras, function (cameraData, name) {\n      var camera;\n\n      if (cameraData.type === 'perspective' && cameraData.perspective) {\n        camera = new camera_PerspectiveCamera();\n        camera.fov = math_math.radToDeg(cameraData.perspective.yfov);\n        camera.near = cameraData.perspective.znear;\n        camera.far = cameraData.perspective.zfar;\n\n        if (cameraData.aspectRatio) {\n          camera.aspect = cameraData.aspectRatio;\n        } else {\n          camera.aspect = defaultAspect;\n        }\n      } else if (cameraData.type === 'orthographic' && cameraData.orthographic) {\n        camera = new camera_OrthographicCamera();\n        camera.near = cameraData.orthographic.znear;\n        camera.far = cameraData.orthographic.zfar;\n        camera.right = cameraData.orthographic.xmag;\n        camera.left = camera.right * -1;\n        camera.top = cameraData.orthographic.ymag;\n        camera.bottom = camera.top * -1;\n      }\n\n      camera = _this13.parseExtensions(cameraData.extensions, camera, {\n        isCamera: true\n      });\n\n      if (camera) {\n        camera.name = cameraData.name || name;\n        _this13.cameras[name] = camera;\n      }\n    });\n  },\n  handlerNodeTransform: function handlerNodeTransform(node, data) {\n    if (data.matrix) {\n      node.matrix.fromArray(data.matrix);\n    } else {\n      if (data.rotation) {\n        node.quaternion.fromArray(data.rotation);\n      }\n\n      if (data.scale) {\n        node.setScale(data.scale[0], data.scale[1], data.scale[2]);\n      }\n\n      if (data.translation) {\n        node.x = data.translation[0];\n        node.y = data.translation[1];\n        node.z = data.translation[2];\n      }\n    }\n  },\n  parseNode: function parseNode(nodeName, parentNode) {\n    var _this14 = this;\n\n    var node;\n    var data = this.json.nodes[nodeName];\n\n    if (!data) {\n      utils_log.warn(\"GLTFParser.parseNode: nodes[\".concat(nodeName, \"] has nothing.\"));\n    }\n\n    node = new core_Node({\n      name: data.name,\n      animationId: nodeName\n    });\n    node = this.parseExtensions(data.extensions, node, {\n      isNode: true\n    });\n\n    if ('camera' in data && this.cameras[data.camera]) {\n      node.addChild(this.cameras[data.camera]);\n    }\n\n    this.handlerNodeTransform(node, data);\n\n    if (data.jointName) {\n      node.jointName = data.jointName;\n      this.jointMap[node.jointName] = node;\n    } else if (this.isGLTF2) {\n      node.jointName = nodeName;\n      this.jointMap[nodeName] = node;\n    }\n\n    if (data.meshes) {\n      data.meshes.forEach(function (meshName) {\n        return _this14.parseMesh(meshName, node, data);\n      });\n    } else if ('mesh' in data) {\n      this.parseMesh(data.mesh, node, data);\n    }\n\n    if (data.children) {\n      data.children.forEach(function (name) {\n        return _this14.parseNode(name, node);\n      });\n    }\n\n    parentNode.addChild(node);\n  },\n  parseAnimations: function parseAnimations() {\n    var _this15 = this;\n\n    if (!this.json.animations) {\n      return null;\n    }\n\n    var isMultiAnim = this.isMultiAnim;\n    var clips = {};\n    var animStatesList = [];\n    var validAnimationIds = {};\n    util_each(this.json.animations, function (info) {\n      info.channels.forEach(function (channel) {\n        var path = channel.target.path;\n        var nodeId = channel.target.id;\n\n        if (_this15.isGLTF2) {\n          nodeId = channel.target.node;\n        }\n\n        var sampler = info.samplers[channel.sampler];\n        var inputAccessName = _this15.isGLTF2 ? sampler.input : info.parameters[sampler.input];\n        var outputAccessName = _this15.isGLTF2 ? sampler.output : info.parameters[path];\n\n        var keyTime = _this15.getArrayByAccessor(inputAccessName, true);\n\n        var states = _this15.getArrayByAccessor(outputAccessName, true);\n\n        if (path === 'rotation') {\n          path = 'quaternion';\n        }\n\n        var animStates = new animation_AnimationStates({\n          interpolationType: sampler.interpolation || 'LINEAR',\n          nodeName: nodeId,\n          keyTime: keyTime,\n          states: states,\n          type: animation_AnimationStates.getType(path)\n        });\n        animStatesList.push(animStates);\n        validAnimationIds[nodeId] = true;\n      });\n\n      if (isMultiAnim && animStatesList.length) {\n        clips[info.name] = {\n          animStatesList: animStatesList\n        };\n        animStatesList = [];\n      }\n    });\n\n    if (isMultiAnim && Object.keys(clips).length > 0) {\n      animStatesList = Object.values(clips)[0].animStatesList;\n    }\n\n    if (animStatesList.length) {\n      return new animation_Animation({\n        rootNode: this.node,\n        animStatesList: animStatesList,\n        validAnimationIds: validAnimationIds,\n        clips: clips\n      });\n    }\n\n    return null;\n  },\n  parseScene: function parseScene() {\n    var _this16 = this;\n\n    this.parseMaterials();\n    this.jointMap = {};\n    this.meshes = [];\n    this.lights = [];\n    this.node = new core_Node({\n      needCallChildUpdate: false\n    });\n    this.parseCameras();\n    var scene = this.json.scenes[this.getDefaultSceneName()];\n\n    if (!scene) {\n      utils_log.warn('GLTFParser:no scene!');\n      return {\n        node: this.node,\n        meshes: [],\n        cameras: [],\n        lights: [],\n        textures: [],\n        materials: []\n      };\n    }\n\n    var nodes = scene.nodes;\n    this.parseSkins();\n    nodes.forEach(function (node) {\n      return _this16.parseNode(node, _this16.node);\n    });\n    this.resetSkinInfo(this.node);\n    var model = {\n      node: this.node,\n      scene: this.node,\n      meshes: this.meshes,\n      json: this.json,\n      cameras: Object.values(this.cameras),\n      lights: this.lights,\n      textures: Object.values(this.textures),\n      materials: Object.values(this.materials)\n    };\n    var anim = this.parseAnimations();\n\n    if (anim) {\n      this.node.setAnim(anim);\n      anim.play();\n      model.anim = anim;\n    }\n\n    this.parseExtensions(scene.extensions, null, {\n      isScene: true\n    });\n    this.parseExtensions(this.json.extensions, model, {\n      isGlobal: true,\n      methodName: 'parseOnEnd'\n    });\n    return model;\n  },\n  getDefaultSceneName: function getDefaultSceneName() {\n    if (this.defaultScene !== undefined) {\n      return this.defaultScene;\n    }\n\n    if (this.json.scenes) {\n      return Object.keys(this.json.scenes)[0];\n    }\n\n    return null;\n  },\n  parseSkins: function parseSkins() {\n    var _this17 = this;\n\n    this.skins = [];\n    var skins = this.json.skins;\n\n    if (skins && skins.length) {\n      this.skins = skins.map(function (skin) {\n        var skeleton = new core_Skeleton();\n        var jointCount = skin.joints.length;\n\n        var inverseBindMatrices = _this17.getArrayByAccessor(skin.inverseBindMatrices, true);\n\n        for (var i = 0; i < jointCount; i++) {\n          var inverseBindMatrice = new math_Matrix4().fromArray(inverseBindMatrices[i]);\n          skeleton.inverseBindMatrices.push(inverseBindMatrice);\n        }\n\n        skeleton.jointNames = skin.joints;\n        return skeleton;\n      });\n    }\n  },\n\n  /**\n   * 重设 jointName，使其保持唯一性。\n   * @private\n   * @param  {Node} rootNode\n   */\n  resetSkinInfo: function resetSkinInfo(rootNode) {\n    var jointNameMap = {};\n    rootNode.traverse(function (node) {\n      var newJointName = \"\".concat(node.id, \"_\").concat(node.name);\n      jointNameMap[node.jointName] = newJointName;\n      node.jointName = newJointName;\n    });\n    this.skins.forEach(function (skin) {\n      skin.jointNames = skin.jointNames.map(function (jointName) {\n        return jointNameMap[jointName];\n      });\n    });\n    rootNode.resetSkinedMeshRootNode();\n  }\n});\n/* harmony default export */ var loader_GLTFParser = (GLTFParser);\n// CONCATENATED MODULE: ./src/loader/GLTFLoader.js\n\n\n\n\n\n/**\n * glTF模型加载类\n * @class\n * @extends {BasicLoader}\n * @example\n * var loader = new Hilo3d.GLTFLoader();\n * loader.load({\n *     src: '//ossgw.alicdn.com/tmall-c3/tmx/a9bedc04da498b95c57057d6a5d29fe7.gltf'\n * }).then(function (model) {\n *     stage.addChild(model.node);\n * });\n */\n\nvar GLTFLoader = core_Class.create(\n/** @lends GLTFLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isGLTFLoader: true,\n\n  /**\n   * @default GLTFLoader\n   * @type {string}\n   */\n  className: 'GLTFLoader',\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    GLTFLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * 加载glTF模型\n   * @param {object} params 加载参数\n   * @param {string} params.src glTF模型地址\n   * @param {number|string} [params.defaultScene] 加载后要展示的场景，默认读模型里的\n   * @param {boolean} [params.isMultiAnim=false] 模型是否多动画，如果是的话会返回 anims 对象保存多个动画对象\n   * @param {boolean} [params.isProgressive=false] 是否渐进式加载，图片加载完前使用占位图片\n   * @param {boolean} [params.isUnQuantizeInShader=true] 是否在shader中进行量化解压数据\n   * @param {boolean} [params.ignoreTextureError=false] 是否忽略图片加载错误\n   * @param {boolean} [params.forceCreateNewBuffer=false] 解析模型数据的时候是否强制创建新buffer，以防内存被引用导致无法释放\n   * @param {function} [params.preHandlerImageURI=null] 图片URL预处理函数\n   * @param {function} [params.preHandlerBufferURI=null] Buffer URL预处理函数\n   * @param {function} [params.customMaterialCreator=null] 是否使用自定义的Material创建器\n   * @param {function} [params.isLoadAllTextures=false] 是否加载所有的贴图，默认只加载用到的贴图\n   * @async\n   * @return {Promise<GLTFModel, Error>} 返回加载完的模型对象\n   */\n  load: function load(params) {\n    var _this = this;\n\n    return this.loadRes(params.src, 'buffer').then(function (buffer) {\n      var parser = new loader_GLTFParser(buffer, params);\n      return parser.parse(_this);\n    })[\"catch\"](function (err) {\n      utils_log.error('load gltf failed', err.message, err.stack);\n      throw err;\n    });\n  }\n});\nloader_Loader.addLoader('gltf', GLTFLoader);\nloader_Loader.addLoader('glb', GLTFLoader);\n/* harmony default export */ var loader_GLTFLoader = (GLTFLoader);\n/**\n * GLTFLoader 模型加载完返回的对象格式\n * @typedef {object} GLTFModel\n * @property {Object} json 原始数据\n * @property {Node} [node] 模型的根节点\n * @property {Mesh[]} [meshes] 模型的所有Mesh对象数组\n * @property {Animation} [anim] 模型的动画对象数组，没有动画的话为null\n * @property {Camera[]} [cameras] 模型中的所有Camera对象数组\n * @property {Light[]} [lights] 模型中的所有Light对象数组\n * @property {Texture[]} [textures] 模型中的所有Texture对象数组\n * @property {BasicMaterial[]} [materials] 模型中的所有Material对象数组\n * @property {Skeleton[]} [skins] 模型中的所有Skeleton对象数组\n */\n// EXTERNAL MODULE: ./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js\nvar _parse_hdr_1_0_0_parse_hdr = __webpack_require__(\"./node_modules/_parse-hdr@1.0.0@parse-hdr/index.js\");\nvar _parse_hdr_1_0_0_parse_hdr_default = /*#__PURE__*/__webpack_require__.n(_parse_hdr_1_0_0_parse_hdr);\n\n// CONCATENATED MODULE: ./src/loader/HDRLoader.js\n\n\n\n\n\n\n\nvar HDRLoader_RGBA = src_constants.RGBA,\n    HDRLoader_NEAREST = src_constants.NEAREST,\n    HDRLoader_CLAMP_TO_EDGE = src_constants.CLAMP_TO_EDGE,\n    HDRLoader_FLOAT = src_constants.FLOAT;\n/**\n * @class\n */\n\nvar HDRLoader = core_Class.create(\n/** @lends HDRLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isHDRLoader: true,\n\n  /**\n   * @default HDRLoader\n   * @type {string}\n   */\n  className: 'HDRLoader',\n  constructor: function constructor() {\n    HDRLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * load\n   * @param  {Object} params\n   * @return {Promise<Texture>}\n   */\n  load: function load(params) {\n    return this.loadRes(params.src, 'buffer').then(function (buffer) {\n      try {\n        var img = _parse_hdr_1_0_0_parse_hdr_default()(buffer);\n        var shape = img.shape;\n        var pixels = img.data;\n        var texture = new texture_Texture({\n          width: shape[0],\n          height: shape[1],\n          flipY: params.flipY || false,\n          image: pixels,\n          type: HDRLoader_FLOAT,\n          magFilter: HDRLoader_NEAREST,\n          minFilter: HDRLoader_NEAREST,\n          wrapS: HDRLoader_CLAMP_TO_EDGE,\n          wrapT: HDRLoader_CLAMP_TO_EDGE,\n          internalFormat: HDRLoader_RGBA,\n          format: HDRLoader_RGBA\n        });\n        Object.assign(texture, params);\n        return texture;\n      } catch (e) {\n        utils_log.error('HDRLoader:parse error => ', e);\n      }\n\n      return null;\n    });\n  }\n});\nloader_Loader.addLoader('hdr', HDRLoader);\n/* harmony default export */ var loader_HDRLoader = (HDRLoader);\n// CONCATENATED MODULE: ./src/loader/KTXLoader.js\n/**\n * for description see https://www.khronos.org/opengles/sdk/tools/KTX/\n * for file layout see https://www.khronos.org/opengles/sdk/tools/KTX/file_format_spec/\n * ported from https://raw.githubusercontent.com/mrdoob/three.js/dev/examples/js/loaders/KTXLoader.js\n */\n\n\n\n\n\n\n/**\n * @class\n * @private\n */\n\nvar KhronosTextureContainer = core_Class.create(\n/** @lends KhronosTextureContainer.prototype */\n{\n  Statics: {\n    HEADER_LEN: 12 + 13 * 4,\n    // identifier + header elements (not including key value meta-data pairs)\n    COMPRESSED_2D: 0,\n    // uses a gl.compressedTexImage2D()\n    COMPRESSED_3D: 1,\n    // uses a gl.compressedTexImage3D()\n    TEX_2D: 2,\n    // uses a gl.texImage2D()\n    TEX_3D: 3 // uses a gl.texImage3D()\n\n  },\n  isKhronosTextureContainer: true,\n  className: 'KhronosTextureContainer',\n\n  /**\n   * @constructs\n   * @param {ArrayBuffer} arrayBuffer contents of the KTX container file\n   * @param {number} facesExpected should be either 1 or 6, based whether a cube texture or or\n   */\n  constructor: function constructor(arrayBuffer, facesExpected) {\n    var baseOffset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    this.arrayBuffer = arrayBuffer;\n    this.baseOffset = baseOffset; // Test that it is a ktx formatted file, based on the first 12 bytes, character representation is:\n    // '´', 'K', 'T', 'X', ' ', '1', '1', 'ª', '\\r', '\\n', '\\x1A', '\\n'\n    // 0xAB, 0x4B, 0x54, 0x58, 0x20, 0x31, 0x31, 0xBB, 0x0D, 0x0A, 0x1A, 0x0A\n\n    var identifier = new Uint8Array(this.arrayBuffer, this.baseOffset, 12);\n\n    if (identifier[0] !== 0xAB || identifier[1] !== 0x4B || identifier[2] !== 0x54 || identifier[3] !== 0x58 || identifier[4] !== 0x20 || identifier[5] !== 0x31 || identifier[6] !== 0x31 || identifier[7] !== 0xBB || identifier[8] !== 0x0D || identifier[9] !== 0x0A || identifier[10] !== 0x1A || identifier[11] !== 0x0A) {\n      utils_log.error('texture missing KTX identifier');\n      return;\n    } // load the reset of the header in native 32 bit uint\n\n\n    var dataSize = Uint32Array.BYTES_PER_ELEMENT;\n    var headerDataView = new DataView(this.arrayBuffer, this.baseOffset + 12, 13 * dataSize);\n    var endianness = headerDataView.getUint32(0, true);\n    var littleEndian = endianness === 0x04030201;\n    this.glType = headerDataView.getUint32(1 * dataSize, littleEndian); // must be 0 for compressed textures\n\n    this.glTypeSize = headerDataView.getUint32(2 * dataSize, littleEndian); // must be 1 for compressed textures\n\n    this.glFormat = headerDataView.getUint32(3 * dataSize, littleEndian); // must be 0 for compressed textures\n\n    this.glInternalFormat = headerDataView.getUint32(4 * dataSize, littleEndian); // the value of arg passed to gl.compressedTexImage2D(,,x,,,,)\n\n    this.glBaseInternalFormat = headerDataView.getUint32(5 * dataSize, littleEndian); // specify GL_RGB, GL_RGBA, GL_ALPHA, etc (un-compressed only)\n\n    this.pixelWidth = headerDataView.getUint32(6 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage2D(,,,x,,,)\n\n    this.pixelHeight = headerDataView.getUint32(7 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage2D(,,,,x,,)\n\n    this.pixelDepth = headerDataView.getUint32(8 * dataSize, littleEndian); // level 0 value of arg passed to gl.compressedTexImage3D(,,,,,x,,)\n\n    this.numberOfArrayElements = headerDataView.getUint32(9 * dataSize, littleEndian); // used for texture arrays\n\n    this.numberOfFaces = headerDataView.getUint32(10 * dataSize, littleEndian); // used for cubemap textures, should either be 1 or 6\n\n    this.numberOfMipmapLevels = headerDataView.getUint32(11 * dataSize, littleEndian); // number of levels; disregard possibility of 0 for compressed textures\n\n    this.bytesOfKeyValueData = headerDataView.getUint32(12 * dataSize, littleEndian); // the amount of space after the header for meta-data\n    // value of zero is an indication to generate mipmaps @ runtime.  Not usually allowed for compressed, so disregard.\n\n    this.numberOfMipmapLevels = Math.max(1, this.numberOfMipmapLevels);\n\n    if (this.pixelHeight === 0 || this.pixelDepth !== 0) {\n      utils_log.warn('only 2D textures currently supported');\n      return;\n    }\n\n    if (this.numberOfArrayElements !== 0) {\n      utils_log.warn('texture arrays not currently supported');\n      return;\n    }\n\n    if (this.numberOfFaces !== facesExpected) {\n      utils_log.warn('number of faces expected' + facesExpected + ', but found ' + this.numberOfFaces);\n      return;\n    } // we now have a completely validated file, so could use existence of loadType as success\n    // would need to make this more elaborate & adjust checks above to support more than one load type\n\n\n    if (this.glType === 0) {\n      this.loadType = KhronosTextureContainer.COMPRESSED_2D;\n    } else {\n      this.loadType = KhronosTextureContainer.TEX_2D;\n    }\n  },\n  // return mipmaps\n  mipmaps: function mipmaps(loadMipmaps) {\n    var mipmaps = []; // initialize width & height for level 1\n\n    var dataOffset = KhronosTextureContainer.HEADER_LEN + this.bytesOfKeyValueData;\n    var width = this.pixelWidth;\n    var height = this.pixelHeight;\n    var mipmapCount = loadMipmaps ? this.numberOfMipmapLevels : 1;\n\n    for (var level = 0; level < mipmapCount; level++) {\n      var imageSize = new Int32Array(this.arrayBuffer, this.baseOffset + dataOffset, 1)[0]; // size per face, since not supporting array cubemaps\n\n      for (var face = 0; face < this.numberOfFaces; face++) {\n        var byteArray = new Uint8Array(this.arrayBuffer, this.baseOffset + dataOffset + 4, imageSize);\n        mipmaps.push({\n          data: byteArray,\n          width: width,\n          height: height\n        });\n        dataOffset += imageSize + 4; // size of the image + 4 for the imageSize field\n\n        dataOffset += 3 - (imageSize + 3) % 4; // add padding for odd sized image\n      }\n\n      width = Math.max(1.0, width * 0.5);\n      height = Math.max(1.0, height * 0.5);\n    }\n\n    return mipmaps;\n  }\n});\n/**\n * KTX 加载器\n * @class\n */\n\nvar KTXLoader = core_Class.create(\n/** @lends KTXLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n  Statics: {\n    /**\n     * astc\n     * @memberOf KTXLoader\n     * @type {String}\n     * @readOnly\n     * @default WEBGL_compressed_texture_astc\n     */\n    astc: 'WEBGL_compressed_texture_astc',\n\n    /**\n     * etc\n     * @memberOf KTXLoader\n     * @type {String}\n     * @readOnly\n     * @default WEBGL_compressed_texture_etc\n     */\n    etc: 'WEBGL_compressed_texture_etc',\n\n    /**\n     * etc1\n     * @memberOf KTXLoader\n     * @type {String}\n     * @readOnly\n     * @default WEBGL_compressed_texture_etc1\n     */\n    etc1: 'WEBGL_compressed_texture_etc1',\n\n    /**\n     * pvrtc\n     * @memberOf KTXLoader\n     * @type {String}\n     * @readOnly\n     * @default WEBGL_compressed_texture_pvrtc\n     */\n    pvrtc: 'WEBGL_compressed_texture_pvrtc',\n\n    /**\n     * s3tc\n     * @memberOf KTXLoader\n     * @type {String}\n     * @readOnly\n     * @default WEBGL_compressed_texture_s3tc\n     */\n    s3tc: 'WEBGL_compressed_texture_s3tc'\n  },\n\n  /**\n   * @type {boolean}\n   * @default true\n   */\n  isKTXLoader: true,\n\n  /**\n   * 类名\n   * @type {string}\n   * @default KTXLoader\n   */\n  className: 'KTXLoader',\n  constructor: function constructor() {\n    renderer_extensions.use(KTXLoader.astc);\n    renderer_extensions.use(KTXLoader.atc);\n    renderer_extensions.use(KTXLoader.etc);\n    renderer_extensions.use(KTXLoader.etc1);\n    renderer_extensions.use(KTXLoader.pvrtc);\n    renderer_extensions.use(KTXLoader.s3tc);\n    renderer_extensions.use(KTXLoader.s3tc_srgb);\n    KTXLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * load\n   * @param  {Object} params\n   */\n  load: function load(params) {\n    var _this = this;\n\n    if (params.src instanceof ArrayBuffer) {\n      return Promise.resolve(this.createTexture(params, params.src));\n    }\n\n    if (ArrayBuffer.isView(params.src)) {\n      return Promise.resolve(this.createTexture(params, params.src.buffer, params.src.byteOffset));\n    }\n\n    return this.loadRes(params.src, 'buffer').then(function (buffer) {\n      return _this.createTexture(params, buffer);\n    });\n  },\n  createTexture: function createTexture(params, buffer) {\n    var baseOffset = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 0;\n    var ktx = new KhronosTextureContainer(buffer, 1, baseOffset);\n    var data = {\n      compressed: ktx.glType === 0,\n      type: ktx.glType,\n      width: ktx.pixelWidth,\n      height: ktx.pixelHeight,\n      internalFormat: ktx.glInternalFormat,\n      format: ktx.glFormat,\n      isCubemap: ktx.numberOfFaces === 6\n    };\n\n    if (ktx.numberOfMipmapLevels >= Math.floor(Math.log2(Math.max(data.width, data.height)) + 1)) {\n      data.mipmaps = ktx.mipmaps(true);\n      data.image = data.mipmaps[0].data;\n    } else {\n      data.mipmaps = null;\n      data.image = ktx.mipmaps(false)[0].data;\n    }\n\n    return new texture_Texture(data);\n  }\n});\nloader_Loader.addLoader('ktx', KTXLoader);\n/* harmony default export */ var loader_KTXLoader = (KTXLoader);\n// CONCATENATED MODULE: ./src/loader/LoadQueue.js\n\n\n\n\n/**\n * 队列加载器，用于批量加载\n * @class\n * @mixes EventMixin\n * @fires complete 完成事件\n * @fires load 加载事件\n * @fires error 错误事件\n * @example\n * var loadQueue = new Hilo3d.LoadQueue([{\n *     type: 'CubeTexture',\n *     images: [\n *         '//gw.alicdn.com/tfs/TB1Ss.ORpXXXXcNXVXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1YhUDRpXXXXcyaXXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1Y1MORpXXXXcpXVXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1ZgAqRpXXXXa0aFXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1IVZNRpXXXXaNXFXXXXXXXXXX-2048-2048.jpg_960x960.jpg',\n *         '//gw.alicdn.com/tfs/TB1M3gyRpXXXXb9apXXXXXXXXXX-2048-2048.jpg_960x960.jpg'\n *     ]\n * }, {\n *     src: '//ossgw.alicdn.com/tmall-c3/tmx/0356679fd543809bba95dfaea32e1d45.gltf'\n * }]).on('complete', function () {\n *     var result = loadQueue.getAllContent();\n *     var box = new Hilo3d.Mesh({\n *         geometry: geometry,\n *         material: new Hilo3d.BasicMaterial({\n *             lightType: 'NONE',\n *             cullFaceType: Hilo3d.constants.FRONT,\n *             diffuse: result[0]\n *         })\n *     }).addTo(stage);\n *     box.setScale(20);\n *     var material = new Hilo3d.BasicMaterial({\n *         diffuse: new Hilo3d.Color(0, 0, 0),\n *         skyboxMap: result[0],\n *         refractRatio: 1/1.5,\n *         refractivity: 0.8,\n *         reflectivity: 0.2\n *     });\n *     var model = result[1];\n *     model.node.setScale(0.001);\n *     model.meshes.forEach(function (m) {\n *         m.material = material;\n *     });\n *     stage.addChild(model.node);\n * }).start();\n */\n\nvar LoadQueue = core_Class.create(\n/** @lends LoadQueue.prototype */\n{\n  Mixes: core_EventMixin,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isLoadQueue: true,\n\n  /**\n   * @default LoadQueue\n   * @type {string}\n   */\n  className: 'LoadQueue',\n  Statics: {\n    /**\n     * 给LoadQueue类添加扩展Loader\n     * @memberOf LoadQueue\n     * @static\n     * @param {string} ext 资源扩展，如gltf, png 等\n     * @param {BasicLoader} LoaderClass 用于加载的类，需要继承BasicLoader\n     */\n    addLoader: function addLoader(ext, LoaderClass) {\n      utils_log.warn('LoadQueue.addLoader is duplicated, please use Loader.addLoader');\n      loader_Loader.addLoader(ext, LoaderClass);\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {Array} [source] 需要加载的资源列表\n   */\n  constructor: function constructor(source) {\n    this._source = [];\n    this.add(source);\n  },\n\n  /**\n   * 最大并发连接数\n   * @default 2\n   * @type {number}\n   */\n  maxConnections: 2,\n  _source: null,\n  _loaded: 0,\n  _connections: 0,\n  _currentIndex: -1,\n\n  /**\n   * 添加需要加载的资源\n   *\n   * @param {object} source 资源信息\n   * @param {string} source.src 资源地址\n   * @param {string} [source.id] 资源id\n   * @param {string} [source.type] 资源类型，对应ext，不传的话自动根据src来获取\n   * @param {number} [source.size] 资源大小，用于精确计算当前加载进度\n   */\n  add: function add(source) {\n    if (source) {\n      source = Array.isArray(source) ? source : [source];\n      this._source = this._source.concat(source);\n    }\n\n    return this;\n  },\n\n  /**\n   * 获取指定id的资源\n   *\n   * @param {string} id id\n   * @return {object} 返回对应的资源信息\n   */\n  get: function get(id) {\n    if (!id) {\n      return null;\n    }\n\n    var source = this._source;\n\n    for (var i = 0; i < source.length; i++) {\n      var item = source[i];\n\n      if (item.id === id || item.src === id) {\n        return item;\n      }\n    }\n\n    return null;\n  },\n\n  /**\n   * 获取指定id加载完后的数据\n   *\n   * @param {string} id id\n   * @return {object} 加载完的结果\n   */\n  getContent: function getContent(id) {\n    var item = this.get(id);\n    return item && item.content;\n  },\n\n  /**\n   * 开始加载资源\n   * @return {LoadQueue} 返回this\n   */\n  start: function start() {\n    if (!this._loader) {\n      this._loader = new loader_Loader();\n    }\n\n    this._loadNext();\n\n    return this;\n  },\n  _loadNext: function _loadNext() {\n    var _this = this;\n\n    var source = this._source;\n    var len = source.length; // all items loaded\n\n    if (this._loaded >= len) {\n      this.fire('complete');\n      return;\n    }\n\n    if (this._currentIndex < len - 1 && this._connections < this.maxConnections) {\n      var index = ++this._currentIndex;\n      var item = source[index];\n      this._connections++;\n\n      this._loader.load(item).then(function (data) {\n        _this._onItemLoad(index, data);\n      }, function (err) {\n        _this._onItemError(index, err);\n      });\n    }\n  },\n  _onItemLoad: function _onItemLoad(index, content) {\n    var item = this._source[index];\n    item.loaded = true;\n    item.content = content;\n    this._connections--;\n    this._loaded++;\n    this.fire('load', item);\n\n    this._loadNext();\n  },\n  _onItemError: function _onItemError(index, e) {\n    var item = this._source[index];\n    item.error = e;\n    this._connections--;\n    this._loaded++;\n    this.fire('error', item);\n\n    this._loadNext();\n  },\n  getSize: function getSize(loaded) {\n    var size = 0;\n    var source = this._source;\n\n    for (var i = 0; i < source.length; i++) {\n      var item = source[i];\n      size += (loaded ? item.loaded && item.size : item.size) || 0;\n    }\n\n    return size;\n  },\n\n  /**\n   * 获取当前已经加载完的资源数量\n   * @return {number}\n   */\n  getLoaded: function getLoaded() {\n    return this._loaded;\n  },\n\n  /**\n   * 获取需要加载的资源总数\n   * @return {number}\n   */\n  getTotal: function getTotal() {\n    return this._source.length;\n  },\n\n  /**\n   * 获取加载的所有资源结果\n   *\n   * @return {Array} 加载的所有资源结果\n   */\n  getAllContent: function getAllContent() {\n    return this._source.map(function (r) {\n      return r.content;\n    });\n  }\n});\n/* harmony default export */ var loader_LoadQueue = (LoadQueue);\n// CONCATENATED MODULE: ./src/loader/ShaderMaterialLoader.js\n\n\n\n\n/**\n * ShaderMaterial加载类\n * @class\n * @extends {BasicLoader}\n * @example\n * var loader = new Hilo3d.ShaderMaterialLoader();\n * loader.load({\n *     fs: './test.frag',\n *     vs: './test.vert',\n *     attributes: {\n *         a_pos: {\n *             semantic: 'POSITION'\n *         },\n *         a_uv: {\n *             semantic: 'TEXCOORD_0'\n *         }\n *     },\n *     uniforms: {\n *         u_mat: {\n *             semantic:'MODELVIEWPROJECTION'\n *         },\n *         u_diffuse: {\n *             semantic: 'DIFFUSE'\n *         }\n *     },\n *     diffuse: new Hilo3d.LazyTexture({\n *         crossOrigin: true,\n *         src: '//img.alicdn.com/tfs/TB1va2xQVXXXXaFapXXXXXXXXXX-1024-710.jpg'\n *     })\n * }).then(material => {\n *     var geometry = new Hilo3d.PlaneGeometry();\n *     var plane = new Hilo3d.Mesh({\n *         material: material,\n *         geometry: geometry\n *     });\n *     stage.addChild(plane);\n * });\n */\n\nvar ShaderMaterialLoader = core_Class.create(\n/** @lends  ShaderMaterialLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isShaderMaterialLoader: true,\n\n  /**\n   * @default ShaderMaterialLoader\n   * @type {string}\n   */\n  className: 'ShaderMaterialLoader',\n  constructor: function constructor() {\n    ShaderMaterialLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * 加载ShaderMaterial\n   *\n   * @memberOf ShaderMaterialLoader\n   * @instance\n   *\n   * @param {object} params 加载参数，所有参数均会传递给 ShaderMaterial 的构造器\n   * @param {string} params.fs fragment shader 文件的地址\n   * @param {string} params.vs vertex shader 文件的地址\n   * @return {Promise.<ShaderMaterial, Error>} 返回加载完的ShaderMaterial实例\n   */\n  load: function load(params) {\n    var list = [this.loadRes(params.fs), this.loadRes(params.vs)];\n    var args = Object.assign({}, params);\n    return Promise.all(list).then(function (result) {\n      args.fs = result[0];\n      args.vs = result[1];\n      return new material_ShaderMaterial(args);\n    }, function (err) {\n      utils_log.warn(\"ShaderMaterial Loader Failed for \".concat(err));\n    });\n  }\n});\n/* harmony default export */ var loader_ShaderMaterialLoader = (ShaderMaterialLoader);\n// CONCATENATED MODULE: ./src/loader/TextureLoader.js\n\n\n\n\n\n/**\n * Texture加载类\n * @class\n * @extends {BasicLoader}\n * @example\n * var loader = new Hilo3d.TextureLoader();\n * loader.load({\n *     crossOrigin: true,\n *     src: '//gw.alicdn.com/tfs/TB1iNtERXXXXXcBaXXXXXXXXXXX-600-600.png'\n * }).then(function (diffuse) {\n *     var material = new Hilo3d.BasicMaterial({\n *         diffuse: diffuse\n *     });\n *     ...\n * });\n */\n\nvar TextureLoader = core_Class.create(\n/** @lends TextureLoader.prototype */\n{\n  Extends: loader_BasicLoader,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isTextureLoader: true,\n\n  /**\n   * @default TextureLoader\n   * @type {string}\n   */\n  className: 'TextureLoader',\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    TextureLoader.superclass.constructor.call(this);\n  },\n\n  /**\n   * 加载Texture\n   * @param {object} params 加载参数\n   * @param {string} params.src 纹理图片地址\n   * @param {boolean} params.crossOrigin 是否跨域，不传将自动判断\n   * @async\n   * @return {Promise<Texture, Error>} 返回加载完的Texture对象\n   */\n  load: function load(params) {\n    return this.loadImg(params.src, params.crossOrigin).then(function (img) {\n      var args = Object.assign({}, params);\n      args.image = img;\n      delete args.type;\n      return new texture_Texture(args);\n    })[\"catch\"](function (err) {\n      utils_log.error('load Texture failed', err.message, err.stack);\n      throw err;\n    });\n  }\n});\nloader_Loader.addLoader('Texture', TextureLoader);\n/* harmony default export */ var loader_TextureLoader = (TextureLoader);\n// CONCATENATED MODULE: ./src/helper/AxisHelper.js\n\n\n\n\n\n\n\n\nvar AxisHelper_LINES = src_constants.LINES;\nvar axisMap = {\n  x: [0, 0, 0, 1, 0, 0],\n  y: [0, 0, 0, 0, 1, 0],\n  z: [0, 0, 0, 0, 0, 1]\n};\n/**\n * 坐标轴帮助类\n * @class\n * @extends Node\n * @example\n * stage.addChild(new Hilo3d.AxisHelper());\n */\n\nvar AxisHelper = core_Class.create(\n/** @lends AxisHelper.prototype */\n{\n  Extends: core_Node,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isAxisHelper: true,\n\n  /**\n   * @default AxisHelper\n   * @type {string}\n   */\n  className: 'AxisHelper',\n\n  /**\n   * 坐标轴的长度，不可变更，需要变可以通过设置 scale\n   * @default 1\n   * @type {number}\n   */\n  size: 1,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数\n   */\n  constructor: function constructor(params) {\n    AxisHelper.superclass.constructor.call(this, params);\n    this.init();\n  },\n  addAxis: function addAxis(direction) {\n    var mesh = new core_Mesh({\n      name: 'AxisHelper_' + direction,\n      geometry: new geometry_Geometry({\n        mode: AxisHelper_LINES,\n        vertices: new geometry_GeometryData(new Float32Array(axisMap[direction]), 3),\n        indices: new geometry_GeometryData(new Uint16Array([0, 1]), 1)\n      }),\n      material: new material_BasicMaterial({\n        diffuse: new math_Color(axisMap[direction][3], axisMap[direction][4], axisMap[direction][5]),\n        lightType: 'NONE'\n      })\n    });\n    this.addChild(mesh);\n  },\n  init: function init() {\n    this.setScale(this.size);\n    this.addAxis('x');\n    this.addAxis('y');\n    this.addAxis('z');\n  }\n});\n/* harmony default export */ var helper_AxisHelper = (AxisHelper);\n// CONCATENATED MODULE: ./src/helper/AxisNetHelper.js\n\n\n\n\n\n\nvar AxisNetHelper_LINES = src_constants.LINES;\n/**\n * 网格帮助类\n * @class\n * @extends Mesh\n * @example\n * stage.addChild(new Hilo3d.AxisNetHelper({ size: 5 }));\n */\n\nvar AxisNetHelper = core_Class.create(\n/** @lends AxisNetHelper.prototype */\n{\n  Extends: core_Mesh,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isAxisNetHelper: true,\n\n  /**\n   * @default AxisNetHelper\n   * @type {string}\n   */\n  className: 'AxisNetHelper',\n\n  /**\n   * 网格线数量的一半(类似圆的半径)\n   * @default 5\n   * @type {number}\n   */\n  size: 5,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数\n   */\n  constructor: function constructor(params) {\n    AxisNetHelper.superclass.constructor.call(this, params);\n    /**\n     * 颜色\n     * @default new Color(.5, .5, .5)\n     * @type {Color}\n     */\n\n    this.color = this.color || new math_Color(.5, .5, .5);\n    var geometry = new geometry_Geometry({\n      mode: AxisNetHelper_LINES\n    });\n    var size = this.size;\n    var max = size * 2 + 1;\n\n    for (var i = 0; i < max; i++) {\n      var x = i / size - 1;\n      geometry.addLine([x, 0, -1], [x, 0, 1]);\n      geometry.addLine([-1, 0, x], [1, 0, x]);\n    }\n\n    this.geometry = geometry;\n    this.material = new material_BasicMaterial({\n      diffuse: this.color,\n      lightType: 'NONE'\n    });\n  }\n});\n/* harmony default export */ var helper_AxisNetHelper = (AxisNetHelper);\n// CONCATENATED MODULE: ./src/helper/CameraHelper.js\n\n\n\n\n\n\n\n\nvar CameraHelper_LINES = src_constants.LINES;\nvar CameraHelper_tempVector3 = new math_Vector3();\n/**\n * 摄像机帮助类\n * @class\n * @extends Mesh\n * @example\n * stage.addChild(new Hilo3d.CameraHelper());\n */\n\nvar CameraHelper = core_Class.create(\n/** @lends CameraHelper.prototype */\n{\n  Extends: core_Mesh,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isCameraHelper: true,\n\n  /**\n   * @default CameraHelper\n   * @type {string}\n   */\n  className: 'CameraHelper',\n  camera: null,\n\n  /**\n   * 颜色\n   * @default new Color(0.3, 0.9, 0.6)\n   * @type {Color}\n   */\n  color: null,\n\n  /**\n   * @constructs\n   * @param {object} [params] 初始化参数\n   */\n  constructor: function constructor(params) {\n    CameraHelper.superclass.constructor.call(this, params);\n\n    if (!this.color) {\n      this.color = new math_Color(0.3, 0.9, 0.6);\n    }\n\n    this.material = new material_BasicMaterial({\n      lightType: 'NONE',\n      diffuse: this.color || new math_Color(0.5, 0.5, 0.5, 1)\n    });\n    this.geometry = new geometry_Geometry({\n      mode: CameraHelper_LINES,\n      isStatic: false,\n      vertices: new geometry_GeometryData(new Float32Array(9 * 3), 3),\n      indices: new geometry_GeometryData(new Uint16Array([0, 1, 1, 2, 2, 3, 3, 0, 4, 5, 5, 6, 6, 7, 7, 4, 0, 4, 1, 5, 2, 6, 3, 7, 8, 4, 8, 5, 8, 6, 8, 7]), 1)\n    });\n  },\n  onUpdate: function onUpdate() {\n    if (this.camera) {\n      this.camera.updateViewProjectionMatrix();\n\n      this._buildGeometry();\n    }\n  },\n  _buildGeometry: function _buildGeometry() {\n    var camera = this.camera;\n    var geometry = this.geometry;\n    var width = 1;\n    var height = 1;\n    var depth = 1;\n    geometry.vertices.set(0, camera.unprojectVector(CameraHelper_tempVector3.set(-width, -height, depth)));\n    geometry.vertices.set(1, camera.unprojectVector(CameraHelper_tempVector3.set(-width, height, depth)));\n    geometry.vertices.set(2, camera.unprojectVector(CameraHelper_tempVector3.set(width, height, depth)));\n    geometry.vertices.set(3, camera.unprojectVector(CameraHelper_tempVector3.set(width, -height, depth)));\n    geometry.vertices.set(4, camera.unprojectVector(CameraHelper_tempVector3.set(-width, -height, -depth)));\n    geometry.vertices.set(5, camera.unprojectVector(CameraHelper_tempVector3.set(-width, height, -depth)));\n    geometry.vertices.set(6, camera.unprojectVector(CameraHelper_tempVector3.set(width, height, -depth)));\n    geometry.vertices.set(7, camera.unprojectVector(CameraHelper_tempVector3.set(width, -height, -depth)));\n    geometry.vertices.set(8, camera.worldMatrix.getTranslation(CameraHelper_tempVector3));\n  }\n});\n/* harmony default export */ var helper_CameraHelper = (CameraHelper);\n// CONCATENATED MODULE: ./src/light/AmbientLight.js\n\n\n/**\n * 环境光\n * @class\n * @extends Light\n */\n\nvar AmbientLight = core_Class.create(\n/** @lends AmbientLight.prototype */\n{\n  Extends: light_Light,\n\n  /**\n   * @type {Boolean}\n   * @readOnly\n   * @default true\n   */\n  isAmbientLight: true,\n\n  /**\n   * @type {String}\n   * @readOnly\n   * @default AmbientLight\n   */\n  className: 'AmbientLight',\n  autoUpdateWorldMatrix: false,\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   * @param {Color} [params.color=new Color(1, 1, 1)] 光颜色\n   * @param {number} [params.amount=1] 光强度\n   * @param {any} [params.[value:string]] 其它属性\n   */\n  constructor: function constructor(params) {\n    AmbientLight.superclass.constructor.call(this, params);\n  }\n});\n/* harmony default export */ var light_AmbientLight = (AmbientLight);\n// CONCATENATED MODULE: ./src/light/AreaLight.js\n\n\n\n\n/**\n * 面光源\n * @class\n * @extends Light\n */\n\nvar AreaLight = core_Class.create(\n/** @lends AreaLight.prototype */\n{\n  Statics: {\n    /**\n     * ltcTexture1\n     * @memberOf AreaLight\n     * @type {DataTexture}\n     * @default null\n     */\n    ltcTexture1: null,\n\n    /**\n     * ltcTexture2\n     * @memberOf AreaLight\n     * @type {DataTexture}\n     * @default null\n     */\n    ltcTexture2: null,\n\n    /**\n     * ltcTexture 是否加载完成\n     * @memberOf AreaLight\n     * @type {Boolean}\n     * @default false\n     */\n    ltcTextureReady: false,\n\n    /**\n     * ltcTexture 地址\n     * @memberOf AreaLight\n     * @type {String}\n     */\n    ltcTextureUrl: '//g.alicdn.com/tmapp/static/4.0.63/ltcTexture.js',\n\n    /**\n     * 初始化 ltcTexture\n     * @memberOf AreaLight\n     */\n    loadLtcTexture: function loadLtcTexture() {\n      var _this = this;\n\n      if (this.ltcTextureReady) {\n        return;\n      }\n\n      if (this._loader !== undefined) {\n        return;\n      }\n\n      this._loader = new loader_Loader();\n\n      this._loader.load({\n        type: 'json',\n        src: this.ltcTextureUrl\n      }).then(function (data) {\n        _this._loader = null;\n        _this.ltcTexture1 = new texture_DataTexture({\n          data: data.ltcTexture1\n        });\n        _this.ltcTexture2 = new texture_DataTexture({\n          data: data.ltcTexture2\n        });\n        _this.ltcTextureReady = true;\n      });\n    }\n  },\n  Extends: light_Light,\n\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isAreaLight: true,\n\n  /**\n   * @default AreaLight\n   * @type {string}\n   */\n  className: 'AreaLight',\n\n  /**\n   * width\n   * @default 10\n   * @type {Number}\n   */\n  width: 10,\n\n  /**\n   * height\n   * @default 10\n   * @type {Number}\n   */\n  height: 10,\n  _enabled: true,\n  enabled: {\n    get: function get() {\n      return this._enabled && AreaLight.ltcTextureReady;\n    },\n    set: function set(value) {\n      this._enabled = value;\n    }\n  },\n\n  /**\n   * @constructs\n   * @param {Object} [params] 创建对象的属性参数。可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    AreaLight.superclass.constructor.call(this, params);\n    AreaLight.loadLtcTexture();\n  },\n\n  /**\n   * ltcTexture1\n   * @type {DataTexture}\n   */\n  ltcTexture1: {\n    get: function get() {\n      return AreaLight.ltcTexture1;\n    },\n    set: function set(texture) {\n      AreaLight.ltcTexture1 = texture;\n    }\n  },\n\n  /**\n   * ltcTexture1\n   * @type {DataTexture}\n   */\n  ltcTexture2: {\n    get: function get() {\n      return AreaLight.ltcTexture2;\n    },\n    set: function set(texture) {\n      AreaLight.ltcTexture2 = texture;\n    }\n  }\n});\n/* harmony default export */ var light_AreaLight = (AreaLight);\n// CONCATENATED MODULE: ./src/utils/MeshPicker.js\n\n\n\n\n\nvar meshPickerMaterial = new material_BasicMaterial({\n  lightType: 'NONE'\n});\nvar MeshPicker_clearColor = new math_Color(1, 1, 1);\nvar MeshPicker_tempColor = new math_Color();\n/**\n * Mesh 选择工具，可以获取画布中某个区域内的Mesh\n * @class\n * @example\n * const picker = new Hilo3d.MeshPicker({\n *     renderer: stage.renderer\n * });\n * picker.getSelection(20, 20, 1, 1);\n */\n\nvar MeshPicker = core_Class.create(\n/** @lends MeshPicker.prototype */\n{\n  /**\n   * @default true\n   * @type {boolean}\n   */\n  isMeshPicker: true,\n\n  /**\n   * @default MeshPicker\n   * @type {string}\n   */\n  className: 'MeshPicker',\n\n  /**\n   * 是否开启debug，开启后会将mesh以不同的颜色绘制在左下角\n   * @default false\n   * @type {boolean}\n   */\n  debug: false,\n\n  /**\n   * WebGLRenderer 的实例\n   * @default null\n   * @type {WebGLRenderer}\n   */\n  renderer: null,\n  colorMeshMap: null,\n\n  /**\n   * @constructs\n   * @param {object} [params] 创建对象的属性参数，可包含此类的所有属性。\n   */\n  constructor: function constructor(params) {\n    Object.assign(this, params);\n    this.colorMeshMap = {};\n    this.init();\n  },\n  createFramebuffer: function createFramebuffer() {\n    if (this.framebuffer) {\n      return;\n    }\n\n    var renderer = this.renderer;\n    this.framebuffer = new renderer_Framebuffer(renderer, {\n      useVao: renderer.useVao,\n      width: renderer.width,\n      height: renderer.height\n    });\n  },\n  renderDebug: function renderDebug() {\n    this.framebuffer.render(0, 0.7, 0.3, 0.3);\n  },\n  createMeshNumberId: function createMeshNumberId(mesh) {\n    if (!('numberId' in mesh)) {\n      mesh.numberId = Number(mesh.id.replace(/^.*_(\\d+)$/, '$1')) * 10;\n      mesh.color = padLeft(mesh.numberId.toString(16), 6);\n      this.colorMeshMap[mesh.color] = mesh;\n    }\n  },\n  renderColoredMeshes: function renderColoredMeshes() {\n    var _this = this;\n\n    var renderer = this.renderer,\n        framebuffer = this.framebuffer;\n    framebuffer.bind();\n    renderer.clear(MeshPicker_clearColor);\n    var currentForceMaterial = renderer.forceMaterial;\n    renderer.forceMaterial = meshPickerMaterial;\n    renderer.renderList.traverse(function (mesh) {\n      _this.createMeshNumberId(mesh);\n\n      meshPickerMaterial.diffuse.fromHEX(mesh.color);\n      meshPickerMaterial.isDirty = true;\n      renderer.renderMesh(mesh);\n    });\n    renderer.forceMaterial = currentForceMaterial;\n    framebuffer.unbind();\n  },\n\n  /**\n   * 获取指定区域内的Mesh，注意无法获取被遮挡的Mesh\n   * @param {number} x 左上角的x坐标\n   * @param {number} y 左上角的y坐标\n   * @param {number} [width=1] 区域的宽\n   * @param {number} [height=1] 区域的高\n   * @return {Mesh[]} 返回获取的Mesh数组\n   */\n  getSelection: function getSelection(x, y) {\n    var width = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : 1;\n    var height = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : 1;\n    var pixelRatio = this.renderer.pixelRatio;\n    var meshes = [];\n    var pixels = this.framebuffer.readPixels(x * pixelRatio, y * pixelRatio, width * pixelRatio, height * pixelRatio);\n\n    for (var i = 0; i < pixels.length; i += 4) {\n      var color = MeshPicker_tempColor.fromUintArray(pixels, i).toHEX();\n\n      if (this.colorMeshMap[color]) {\n        meshes.push(this.colorMeshMap[color]);\n      }\n    }\n\n    return meshes;\n  },\n  init: function init() {\n    var _this2 = this;\n\n    this.createFramebuffer();\n    this.renderer.on('afterRender', function () {\n      _this2.renderColoredMeshes();\n\n      if (_this2.debug) {\n        _this2.renderDebug();\n      }\n    });\n  }\n});\n/* harmony default export */ var utils_MeshPicker = (MeshPicker);\n// EXTERNAL MODULE: ./node_modules/_hilojs@2.0.2@hilojs/util/Ticker.js\nvar Ticker = __webpack_require__(\"./node_modules/_hilojs@2.0.2@hilojs/util/Ticker.js\");\nvar Ticker_default = /*#__PURE__*/__webpack_require__.n(Ticker);\n\n// CONCATENATED MODULE: ./src/utils/Ticker.js\n/**\n * Ticker是一个定时器类。它可以按指定帧率重复运行，从而按计划执行代码。\n * @class  Ticker\n * @see  {@link http://hiloteam.github.io/Hilo/docs/api-zh/symbols/Ticker.html}\n */\n\n/**\n * 添加定时器对象。定时器对象必须实现 tick 方法。\n * @memberOf Ticker.prototype\n * @method addTick\n * @param {Object} tickObject\n */\n\n/**\n * 删除定时器对象。\n * @memberOf Ticker.prototype\n * @method removeTick\n * @param {Object} tickObject\n */\n\n/**\n * 开始计时器\n * @memberOf Ticker.prototype\n * @method start\n */\n\n/**\n * 停止计时器\n * @memberOf Ticker.prototype\n * @method stop\n */\n\n/**\n * 暂停计时器\n * @memberOf Ticker.prototype\n * @method pause\n */\n\n/**\n * 恢复计时器\n * @memberOf Ticker.prototype\n * @method resume\n */\n\n/**\n * 延迟指定的时间后调用回调, 类似setTimeout\n * @memberOf Ticker.prototype\n * @method timeout\n * @param {Function} callback\n * @param {number} duration 时间周期，单位毫秒\n * @returns {Object} tickObject 定时器对象\n */\n\n/**\n * 指定的时间周期来调用函数, 类似setInterval\n * @memberOf Ticker.prototype\n * @method interval\n * @param {Function} callback\n * @param {number} duration 时间周期，单位毫秒\n * @returns {Object} tickObject 定时器对象\n */\n\n/**\n * 下次tick时回调\n * @memberOf Ticker.prototype\n * @method nextTick\n * @param {Function} callback\n * @returns {Object} tickObject 定时器对象\n */\n\n/**\n * 获得测定的运行时帧率。\n * @memberOf Ticker.prototype\n * @method getMeasuredFPS\n * @returns {number}\n */\n\n/* harmony default export */ var utils_Ticker = (Ticker_default.a);\n// CONCATENATED MODULE: ./src/utils/WebGLSupport.js\n/**\n * WebGL支持检测\n * @namespace WebGLSupport\n * @type {Object}\n */\nvar WebGLSupport = {\n  /**\n   * 是否支持 WebGL\n   * @return {Boolean}\n   */\n  get: function get() {\n    if (this._isWebGLSupport === undefined) {\n      try {\n        var canvas = document.createElement('canvas');\n        var gl = canvas.getContext('webgl');\n        gl.clearColor(0, 1, 0, 1);\n        gl.clear(gl.COLOR_BUFFER_BIT);\n        var pixels = new Uint8Array(4);\n        gl.readPixels(0, 0, 1, 1, gl.RGBA, gl.UNSIGNED_BYTE, pixels);\n\n        if (pixels[0] === 0 && pixels[1] === 255 && pixels[2] === 0 && pixels[3] === 255) {\n          this._isWebGLSupport = true;\n        } else {\n          this._isWebGLSupport = false;\n        }\n\n        canvas = null;\n        gl = null;\n        pixels = null;\n      } catch (e) {\n        this._isWebGLSupport = false;\n      }\n    }\n\n    return this._isWebGLSupport;\n  }\n};\n/* harmony default export */ var utils_WebGLSupport = (WebGLSupport);\n// CONCATENATED MODULE: ./src/math/SphericalHarmonics3.js\n\n\nvar tempArray = new Float32Array(27);\n/**\n * SphericalHarmonics3\n * @class\n */\n\nvar SphericalHarmonics3 = core_Class.create(\n/** @lends SphericalHarmonics3.prototype */\n{\n  /**\n   * 类名\n   * @type {String}\n   * @default SphericalHarmonics3\n   */\n  className: 'SphericalHarmonics3',\n\n  /**\n   * @type {boolean}\n   * @default true\n   */\n  isSphericalHarmonics3: true,\n  Statics: {\n    SH3_SCALE: [Math.sqrt(1 / (4 * Math.PI)), -Math.sqrt(3 / (4 * Math.PI)), Math.sqrt(3 / (4 * Math.PI)), -Math.sqrt(3 / (4 * Math.PI)), Math.sqrt(15 / (4 * Math.PI)), -Math.sqrt(15 / (4 * Math.PI)), Math.sqrt(5 / (16 * Math.PI)), -Math.sqrt(15 / (4 * Math.PI)), Math.sqrt(15 / (16 * Math.PI))]\n  },\n\n  /**\n   * @constructs\n   */\n  constructor: function constructor() {\n    this.coefficients = [];\n\n    for (var i = 0; i < 9; i++) {\n      this.coefficients.push(new math_Vector3());\n    }\n  },\n\n  /**\n   * scale\n   * @param  {Number} scale\n   * @return {SphericalHarmonics3} this\n   */\n  scale: function scale(_scale) {\n    this.coefficients.forEach(function (coefficient) {\n      coefficient.scale(_scale);\n    });\n    return this;\n  },\n\n  /**\n   * fromArray\n   * @param {Number[][]|Number[]} coefficients\n   * @return {SphericalHarmonics3} this\n   */\n  fromArray: function fromArray(data) {\n    if (data.length === 9) {\n      this.coefficients.forEach(function (coefficient, index) {\n        coefficient.fromArray(data[index]);\n      });\n    } else if (data.length === 27) {\n      this.coefficients.forEach(function (coefficient, index) {\n        coefficient.fromArray(data, index * 3);\n      });\n    }\n\n    return this;\n  },\n\n  /**\n   * scaleForRender\n   * @return {SphericalHarmonics3} this\n   */\n  scaleForRender: function scaleForRender() {\n    var SH3_SCALE = SphericalHarmonics3.SH3_SCALE;\n    this.coefficients.forEach(function (coefficient, index) {\n      coefficient.scale(SH3_SCALE[index]);\n    });\n    this.scale(1 / Math.PI);\n    return this;\n  },\n\n  /**\n   * toArray\n   * @returns {Float32Array}\n   */\n  toArray: function toArray() {\n    this.coefficients.forEach(function (coefficient, index) {\n      coefficient.toArray(tempArray, index * 3);\n    });\n    return tempArray;\n  },\n\n  /**\n   * 克隆\n   * @return {SphericalHarmonics3}\n   */\n  clone: function clone() {\n    var sphericalHarmonics3 = new this.constructor();\n    sphericalHarmonics3.copy(this);\n    return sphericalHarmonics3;\n  },\n\n  /**\n   * 复制\n   * @param  {SphericalHarmonics3} other\n   * @return {SphericalHarmonics3} this\n   */\n  copy: function copy(other) {\n    var otherCoefficients = other.coefficients;\n    this.coefficients.forEach(function (coefficient, index) {\n      coefficient.copy(otherCoefficients[index]);\n    });\n    return this;\n  }\n});\n/* harmony default export */ var math_SphericalHarmonics3 = (SphericalHarmonics3);\n// CONCATENATED MODULE: ./src/math/index.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n// CONCATENATED MODULE: ./src/Hilo3d.js\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n/***/ }),\n\n/***/ \"./src/polyfill.js\":\n/*!*************************!*\\\n  !*** ./src/polyfill.js ***!\n  \\*************************/\n/*! no exports provided */\n/*! ModuleConcatenation bailout: Module is referenced from these modules with unsupported syntax: multi ./src/polyfill.js ./src/Hilo3d.js (referenced with single entry) */\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var object_assign__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! object-assign */ \"./node_modules/_object-assign@4.1.1@object-assign/index.js\");\n/* harmony import */ var object_assign__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(object_assign__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var object_keys__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! object.keys */ \"./node_modules/_object.keys@0.1.0@object.keys/index.js\");\n/* harmony import */ var object_keys__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(object_keys__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var object_values__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! object-values */ \"./node_modules/_object-values@2.0.0@object-values/index.js\");\n/* harmony import */ var object_values__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(object_values__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var pinkie_promise__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! pinkie-promise */ \"./node_modules/_pinkie-promise@2.0.1@pinkie-promise/index.js\");\n/* harmony import */ var pinkie_promise__WEBPACK_IMPORTED_MODULE_3___default = /*#__PURE__*/__webpack_require__.n(pinkie_promise__WEBPACK_IMPORTED_MODULE_3__);\n\n\n\n\n\nif (!Object.assign) {\n  Object.assign = object_assign__WEBPACK_IMPORTED_MODULE_0___default.a;\n}\n\nif (!Object.keys) {\n  Object.keys = object_keys__WEBPACK_IMPORTED_MODULE_1___default.a;\n}\n\nif (!Object.values) {\n  Object.values = object_values__WEBPACK_IMPORTED_MODULE_2___default.a;\n}\n\nif (typeof Promise === 'undefined') {\n  window.Promise = pinkie_promise__WEBPACK_IMPORTED_MODULE_3___default.a;\n} // iOS 9 doesn't support TypedArray slice\n\n\n[Int8Array, Uint8Array, Int16Array, Uint16Array, Uint32Array, Float32Array].forEach(function (TypedArray) {\n  if (!TypedArray.prototype.slice) {\n    Object.defineProperty(TypedArray.prototype, 'slice', {\n      value: function value(begin, end) {\n        return new TypedArray(Array.prototype.slice.call(this, begin, end));\n      }\n    });\n  }\n});\n\n/***/ }),\n\n/***/ \"./src/shader/basic.frag\":\n/*!*******************************!*\\\n  !*** ./src/shader/basic.frag ***!\n  \\*******************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.frag */ \"./src/shader/chunk/extensions.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.frag */ \"./src/shader/chunk/precision.frag\") + \"\\n\\n\" + __webpack_require__(/*! ./chunk/color.frag */ \"./src/shader/chunk/color.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/uv.frag */ \"./src/shader/chunk/uv.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/normal.frag */ \"./src/shader/chunk/normal.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog.frag */ \"./src/shader/chunk/lightFog.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/diffuse.frag */ \"./src/shader/chunk/diffuse.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/light.frag */ \"./src/shader/chunk/light.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/phong.frag */ \"./src/shader/chunk/phong.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/transparency.frag */ \"./src/shader/chunk/transparency.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/fog.frag */ \"./src/shader/chunk/fog.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/logDepth.frag */ \"./src/shader/chunk/logDepth.frag\") + \"\\n\\nvoid main(void) {\\nvec4 diffuse = vec4(0., 0., 0., 1.);\\nvec4 color = vec4(0., 0., 0., 1.);\\n\\n\" + __webpack_require__(/*! ./chunk/normal_main.frag */ \"./src/shader/chunk/normal_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog_main.frag */ \"./src/shader/chunk/lightFog_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/diffuse_main.frag */ \"./src/shader/chunk/diffuse_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/phong_main.frag */ \"./src/shader/chunk/phong_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/transparency_main.frag */ \"./src/shader/chunk/transparency_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/frag_color.frag */ \"./src/shader/chunk/frag_color.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/logDepth_main.frag */ \"./src/shader/chunk/logDepth_main.frag\") + \"\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/basic.vert\":\n/*!*******************************!*\\\n  !*** ./src/shader/basic.vert ***!\n  \\*******************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.vert */ \"./src/shader/chunk/extensions.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.vert */ \"./src/shader/chunk/precision.vert\") + \"\\n\\nattribute vec3 a_position;\\nuniform mat4 u_modelViewProjectionMatrix;\\n\\n\" + __webpack_require__(/*! ./chunk/unQuantize.vert */ \"./src/shader/chunk/unQuantize.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/joint.vert */ \"./src/shader/chunk/joint.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/uv.vert */ \"./src/shader/chunk/uv.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/normal.vert */ \"./src/shader/chunk/normal.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog.vert */ \"./src/shader/chunk/lightFog.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/morph.vert */ \"./src/shader/chunk/morph.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/color.vert */ \"./src/shader/chunk/color.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/logDepth.vert */ \"./src/shader/chunk/logDepth.vert\") + \"\\nvoid main(void) {\\nvec4 pos = vec4(a_position, 1.0);\\n#ifdef HILO_HAS_TEXCOORD0\\nvec2 uv = a_texcoord0;\\n#endif\\n#ifdef HILO_HAS_TEXCOORD1\\nvec2 uv1 = a_texcoord1;\\n#endif\\n#ifdef HILO_HAS_NORMAL\\nvec3 normal = a_normal;\\n#endif\\n\\n#ifdef HILO_NORMAL_MAP\\nvec4 tangent = a_tangent;\\n#endif\\n\\n\" + __webpack_require__(/*! ./chunk/color_main.vert */ \"./src/shader/chunk/color_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/unQuantize_main.vert */ \"./src/shader/chunk/unQuantize_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/morph_main.vert */ \"./src/shader/chunk/morph_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/joint_main.vert */ \"./src/shader/chunk/joint_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/uv_main.vert */ \"./src/shader/chunk/uv_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/normal_main.vert */ \"./src/shader/chunk/normal_main.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog_main.vert */ \"./src/shader/chunk/lightFog_main.vert\") + \"\\n\\ngl_Position = u_modelViewProjectionMatrix * pos;\\n\\n\" + __webpack_require__(/*! ./chunk/logDepth_main.vert */ \"./src/shader/chunk/logDepth_main.vert\") + \"\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/baseDefine.glsl\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/baseDefine.glsl ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#define HILO_FRONT_SIDE 1028\\n#define HILO_BACK_SIDE 1029\\n#define HILO_FRONT_AND_BACK_SIDE 1032\\n#define HILO_PI 3.141592653589793\\n#define HILO_INVERSE_PI 0.3183098861837907\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/color.frag\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/color.frag ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\nvarying vec4 v_color;\\n#endif\\n\\n#ifdef HILO_USE_HDR\\nuniform float u_exposure;\\n#endif\\n\\n#ifdef HILO_GAMMA_CORRECTION\\nuniform float u_gammaFactor;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/color.vert\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/color.vert ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\n#if HILO_COLOR_SIZE == 3\\nattribute vec3 a_color;\\n#elif HILO_COLOR_SIZE == 4\\nattribute vec4 a_color;\\n#endif\\nvarying vec4 v_color;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/color_main.vert\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/color_main.vert ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_COLOR\\n#if HILO_COLOR_SIZE == 3\\nv_color = vec4(a_color, 1.0);\\n#elif HILO_COLOR_SIZE == 4\\nv_color = a_color;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/diffuse.frag\":\n/*!***************************************!*\\\n  !*** ./src/shader/chunk/diffuse.frag ***!\n  \\***************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_DIFFUSE_MAP)\\nuniform HILO_SAMPLER_2D u_diffuse;\\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\\nuniform samplerCube u_diffuse;\\n#else\\nuniform vec4 u_diffuse;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/diffuse_main.frag\":\n/*!********************************************!*\\\n  !*** ./src/shader/chunk/diffuse_main.frag ***!\n  \\********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_DIFFUSE_MAP)\\ndiffuse = HILO_TEXTURE_2D(u_diffuse);\\n#elif defined(HILO_DIFFUSE_CUBE_MAP)\\ndiffuse = textureCube(u_diffuse, v_position);\\n#elif defined(HILO_HAS_COLOR)\\ndiffuse = v_color;\\n#else\\ndiffuse = u_diffuse;\\n#endif\\ncolor.a = diffuse.a;\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/extensions.frag\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/extensions.frag ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#ifdef HILO_USE_SHADER_TEXTURE_LOD\\n#extension GL_EXT_shader_texture_lod: enable\\n#endif\\n\\n#ifdef HILO_USE_EXT_FRAG_DEPTH\\n#extension GL_EXT_frag_depth: enable\\n#define GLSLIFY 1\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/extensions.vert\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/extensions.vert ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/fixMathCrash.glsl\":\n/*!********************************************!*\\\n  !*** ./src/shader/chunk/fixMathCrash.glsl ***!\n  \\********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_FIX_MAX_BUG\\nfloat hilo_max(float a, float b){\\nif (a > b) {\\nreturn a;\\n}\\nreturn b;\\n}\\n#define HILO_MAX(a, b) hilo_max(a, b);\\n#else\\n#define HILO_MAX(a, b) max(a, b);\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/fog.frag\":\n/*!***********************************!*\\\n  !*** ./src/shader/chunk/fog.frag ***!\n  \\***********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_FOG\\nvarying float v_dist;\\nuniform vec4 u_fogColor;\\n\\n#ifdef HILO_FOG_LINEAR\\nuniform vec2 u_fogInfo;\\n#else\\nuniform float u_fogInfo;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/fog_main.frag\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/fog_main.frag ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_FOG\\nfloat fogFactor = 1.0;\\n\\n#ifdef HILO_FOG_LINEAR\\nfogFactor = (u_fogInfo.y - v_dist)/(u_fogInfo.y - u_fogInfo.x);\\n#elif defined(HILO_FOG_EXP)\\nfogFactor = exp(-abs(u_fogInfo * v_dist));\\n#elif defined(HILO_FOG_EXP2)\\nfogFactor = exp(-(u_fogInfo * v_dist) * (u_fogInfo * v_dist)); \\n#endif\\n\\nfogFactor = clamp(fogFactor, 0.0, 1.0);\\ncolor = mix(u_fogColor, color, fogFactor);\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/frag_color.frag\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/frag_color.frag ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_IGNORE_TRANSPARENT\\ncolor.a = 1.0;\\n#endif\\n\\n#ifdef HILO_USE_HDR\\ncolor.rgb = vec3(1.0) - exp(-color.rgb * u_exposure);\\n#endif\\n\\n#ifdef HILO_GAMMA_CORRECTION\\ncolor.rgb = pow(color.rgb, vec3(1.0 / u_gammaFactor));\\n#endif\\n\\n\" + __webpack_require__(/*! ./fog_main.frag */ \"./src/shader/chunk/fog_main.frag\") + \"\\n\\n#ifdef HILO_PREMULTIPLY_ALPHA\\ncolor.rgb *= color.a;\\n#endif\\n\\ngl_FragColor = color;\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/joint.vert\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/joint.vert ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_JOINT_COUNT\\nattribute vec4 a_skinIndices;\\nattribute vec4 a_skinWeights;\\n#ifdef HILO_JOINT_MAT_MAP\\nuniform sampler2D u_jointMatTexture;\\nuniform vec2 u_jointMatTextureSize;\\nmat4 getJointMat(float index) {\\nindex *= 4.0;\\nfloat x = float(mod(index, u_jointMatTextureSize.x));\\nfloat y = float(floor(index / u_jointMatTextureSize.x));\\nfloat dx = 1.0 / float(u_jointMatTextureSize.x);\\nfloat dy = 1.0 / float(u_jointMatTextureSize.y);\\ny = dy * (y + 0.5);\\nvec4 v1 = texture2D(u_jointMatTexture, vec2(dx * (x + 0.5), y));\\nvec4 v2 = texture2D(u_jointMatTexture, vec2(dx * (x + 1.5), y));\\nvec4 v3 = texture2D(u_jointMatTexture, vec2(dx * (x + 2.5), y));\\nvec4 v4 = texture2D(u_jointMatTexture, vec2(dx * (x + 3.5), y));\\nmat4 mat = mat4(v1, v2, v3, v4);\\nreturn mat;\\n}\\n\\nmat4 getJointMat(vec4 weights, vec4 indices) {\\nmat4 mat = weights.x * getJointMat(indices.x);\\nmat += weights.y * getJointMat(indices.y);\\nmat += weights.z * getJointMat(indices.z);\\nmat += weights.w * getJointMat(indices.w);\\nreturn mat;\\n}\\n#else\\nuniform mat4 u_jointMat[HILO_JOINT_COUNT];\\n\\nmat4 getJointMat(vec4 weights, vec4 indices) {\\nmat4 mat = weights.x * u_jointMat[int(indices.x)];\\nmat += weights.y * u_jointMat[int(indices.y)];\\nmat += weights.z * u_jointMat[int(indices.z)];\\nmat += weights.w * u_jointMat[int(indices.w)];\\nreturn mat;\\n}\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/joint_main.vert\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/joint_main.vert ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_JOINT_COUNT\\nmat4 skinMat = getJointMat(a_skinWeights, a_skinIndices);\\npos = skinMat * pos;\\n\\n#ifdef HILO_HAS_NORMAL\\nnormal = mat3(skinMat) * normal;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/light.frag\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/light.frag ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_DIRECTIONAL_LIGHTS\\nuniform vec3 u_directionalLightsColor[HILO_DIRECTIONAL_LIGHTS];\\nuniform vec3 u_directionalLightsInfo[HILO_DIRECTIONAL_LIGHTS];\\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\nuniform sampler2D u_directionalLightsShadowMap[HILO_DIRECTIONAL_LIGHTS_SMC];\\nuniform vec2 u_directionalLightsShadowMapSize[HILO_DIRECTIONAL_LIGHTS_SMC];\\nuniform mat4 u_directionalLightSpaceMatrix[HILO_DIRECTIONAL_LIGHTS_SMC];\\nuniform vec2 u_directionalLightsShadowBias[HILO_DIRECTIONAL_LIGHTS_SMC];\\n#endif\\n#endif\\n\\n#ifdef HILO_SPOT_LIGHTS\\nuniform vec3 u_spotLightsPos[HILO_SPOT_LIGHTS];\\nuniform vec3 u_spotLightsDir[HILO_SPOT_LIGHTS];\\nuniform vec3 u_spotLightsColor[HILO_SPOT_LIGHTS];\\nuniform vec2 u_spotLightsCutoffs[HILO_SPOT_LIGHTS];\\nuniform vec3 u_spotLightsInfo[HILO_SPOT_LIGHTS];\\nuniform float u_spotLightsRange[HILO_SPOT_LIGHTS];\\n#ifdef HILO_SPOT_LIGHTS_SMC\\nuniform sampler2D u_spotLightsShadowMap[HILO_SPOT_LIGHTS_SMC];\\nuniform vec2 u_spotLightsShadowMapSize[HILO_SPOT_LIGHTS_SMC];\\nuniform mat4 u_spotLightSpaceMatrix[HILO_SPOT_LIGHTS_SMC];\\nuniform vec2 u_spotLightsShadowBias[HILO_SPOT_LIGHTS_SMC];\\n#endif\\n#endif\\n\\n#ifdef HILO_POINT_LIGHTS\\nuniform vec3 u_pointLightsPos[HILO_POINT_LIGHTS];\\nuniform vec3 u_pointLightsColor[HILO_POINT_LIGHTS];\\nuniform vec3 u_pointLightsInfo[HILO_POINT_LIGHTS];\\nuniform float u_pointLightsRange[HILO_POINT_LIGHTS];\\n#ifdef HILO_POINT_LIGHTS_SMC\\nuniform samplerCube u_pointLightsShadowMap[HILO_POINT_LIGHTS_SMC];\\nuniform mat4 u_pointLightSpaceMatrix[HILO_POINT_LIGHTS_SMC];\\nuniform vec2 u_pointLightsShadowBias[HILO_POINT_LIGHTS_SMC];\\nuniform vec2 u_pointLightCamera[HILO_POINT_LIGHTS_SMC];\\n#endif\\n#endif\\n\\n#ifdef HILO_AREA_LIGHTS\\nuniform vec3 u_areaLightsPos[HILO_AREA_LIGHTS];\\nuniform vec3 u_areaLightsColor[HILO_AREA_LIGHTS];\\nuniform vec3 u_areaLightsWidth[HILO_AREA_LIGHTS];\\nuniform vec3 u_areaLightsHeight[HILO_AREA_LIGHTS];\\nuniform sampler2D u_areaLightsLtcTexture1;\\nuniform sampler2D u_areaLightsLtcTexture2;\\n\\n\" + __webpack_require__(/*! ../method/getAreaLight.glsl */ \"./src/shader/method/getAreaLight.glsl\") + \"\\n#endif\\n\\n#ifdef HILO_AMBIENT_LIGHTS\\nuniform vec3 u_ambientLightsColor;\\n#endif\\n\\n\" + __webpack_require__(/*! ../method/getDiffuse.glsl */ \"./src/shader/method/getDiffuse.glsl\") + \"\\n\" + __webpack_require__(/*! ../method/getSpecular.glsl */ \"./src/shader/method/getSpecular.glsl\") + \"\\n\" + __webpack_require__(/*! ../method/getLightAttenuation.glsl */ \"./src/shader/method/getLightAttenuation.glsl\") + \"\\n\" + __webpack_require__(/*! ../method/unpackFloat.glsl */ \"./src/shader/method/unpackFloat.glsl\") + \"\\n\" + __webpack_require__(/*! ../method/getShadow.glsl */ \"./src/shader/method/getShadow.glsl\") + \"\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/lightFog.frag\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/lightFog.frag ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\\nvarying vec3 v_fragPos;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/lightFog.vert\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/lightFog.vert ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\\nuniform mat4 u_modelViewMatrix;\\n#ifdef HILO_HAS_FOG\\nvarying float v_dist;\\n#endif\\n\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS) \\nvarying vec3 v_fragPos;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/lightFog_main.frag\":\n/*!*********************************************!*\\\n  !*** ./src/shader/chunk/lightFog_main.frag ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_LIGHT\\n#if HILO_SIDE == HILO_FRONT_AND_BACK_SIDE\\nnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/lightFog_main.vert\":\n/*!*********************************************!*\\\n  !*** ./src/shader/chunk/lightFog_main.vert ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FOG) || defined(HILO_HAS_FRAG_POS)\\nvec3 fragPos = (u_modelViewMatrix * pos).xyz;\\n\\n#if defined(HILO_HAS_LIGHT) || defined(HILO_HAS_FRAG_POS)\\nv_fragPos = fragPos;\\n#endif\\n\\n#ifdef HILO_HAS_FOG\\nv_dist = length(fragPos);\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/logDepth.frag\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/logDepth.frag ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\\nuniform float u_logDepth;\\nvarying float v_fragDepth;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/logDepth.vert\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/logDepth.vert ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_USE_LOG_DEPTH\\n#ifdef HILO_USE_EXT_FRAG_DEPTH\\nvarying float v_fragDepth;\\n#else\\nuniform float u_logDepth;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/logDepth_main.frag\":\n/*!*********************************************!*\\\n  !*** ./src/shader/chunk/logDepth_main.frag ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#if defined(HILO_USE_LOG_DEPTH) && defined(HILO_USE_EXT_FRAG_DEPTH)\\ngl_FragDepthEXT = log2( v_fragDepth ) * u_logDepth * 0.5;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/logDepth_main.vert\":\n/*!*********************************************!*\\\n  !*** ./src/shader/chunk/logDepth_main.vert ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_USE_LOG_DEPTH\\n#ifdef HILO_USE_EXT_FRAG_DEPTH\\nv_fragDepth = 1.0 + gl_Position.w;\\n#else\\ngl_Position.z = log2( max( 1e-6, gl_Position.w + 1.0 ) ) * u_logDepth - 1.0;\\ngl_Position.z *= gl_Position.w;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/morph.vert\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/morph.vert ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_MORPH_TARGET_COUNT\\nuniform float u_morphWeights[HILO_MORPH_TARGET_COUNT];\\n\\n#if HILO_MORPH_TARGET_COUNT > 0\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition0;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal0;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent0;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 1\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition1;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal1;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent1;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 2\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition2;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal2;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent2;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 3\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition3;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal3;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent3;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 4\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition4;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal4;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent4;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 5\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition5;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal5;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent5;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 6\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition6;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal6;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent6;\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 7\\n#ifdef HILO_MORPH_HAS_POSITION\\nattribute vec3 a_morphPosition7;\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nattribute vec3 a_morphNormal7;\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\nattribute vec3 a_morphTangent7;\\n#endif\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/morph_main.vert\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/morph_main.vert ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_MORPH_TARGET_COUNT\\n#if HILO_MORPH_TARGET_COUNT > 0\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition0 * u_morphWeights[0];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal0 * u_morphWeights[0];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent0 * u_morphWeights[0];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 1\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition1 * u_morphWeights[1];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal1 * u_morphWeights[1];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent1 * u_morphWeights[1];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 2\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition2 * u_morphWeights[2];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal2 * u_morphWeights[2];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent2 * u_morphWeights[2];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 3\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition3 * u_morphWeights[3];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal3 * u_morphWeights[3];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent3 * u_morphWeights[3];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 4\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition4 * u_morphWeights[4];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal4 * u_morphWeights[4];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent4 * u_morphWeights[4];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 5\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition5 * u_morphWeights[5];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal5 * u_morphWeights[5];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent5 * u_morphWeights[5];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 6\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition6 * u_morphWeights[6];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal6 * u_morphWeights[6];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent6 * u_morphWeights[6];\\n#endif\\n#endif\\n\\n#if HILO_MORPH_TARGET_COUNT > 7\\n#ifdef HILO_MORPH_HAS_POSITION\\npos.xyz += a_morphPosition7 * u_morphWeights[7];\\n#endif\\n#if defined(HILO_MORPH_HAS_NORMAL) && defined(HILO_HAS_NORMAL)\\nnormal += a_morphNormal7 * u_morphWeights[7];\\n#endif\\n#if defined(HILO_MORPH_HAS_TANGENT) && defined(HILO_HAS_TANGENT)\\ntangent.xyz += a_morphTangent7 * u_morphWeights[7];\\n#endif\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/normal.frag\":\n/*!**************************************!*\\\n  !*** ./src/shader/chunk/normal.frag ***!\n  \\**************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\nvarying vec3 v_normal;\\n#ifdef HILO_NORMAL_MAP\\nuniform HILO_SAMPLER_2D u_normalMap;\\nvarying mat3 v_TBN;\\n\\n#ifdef HILO_NORMAL_MAP_SCALE\\nuniform float u_normalMapScale;\\n#endif\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/normal.vert\":\n/*!**************************************!*\\\n  !*** ./src/shader/chunk/normal.vert ***!\n  \\**************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\nattribute vec3 a_normal;\\nuniform mat3 u_normalMatrix;\\nvarying vec3 v_normal;\\n\\n#ifdef HILO_NORMAL_MAP\\nattribute vec4 a_tangent;\\nvarying mat3 v_TBN;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/normal_main.frag\":\n/*!*******************************************!*\\\n  !*** ./src/shader/chunk/normal_main.frag ***!\n  \\*******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_NORMAL_MAP\\nvec3 normal = HILO_TEXTURE_2D(u_normalMap).rgb * 2.0 - 1.0;\\n#ifdef HILO_NORMAL_MAP_SCALE\\nnormal.xy *= u_normalMapScale;\\n#endif\\nnormal = normalize(v_TBN * normal);\\n#elif defined(HILO_HAS_NORMAL)\\nvec3 normal = normalize(v_normal);\\n#else\\nvec3 normal = vec3(0, 0, 1);\\n#endif\\n\\n#if HILO_SIDE == HILO_BACK_SIDE\\nnormal = -normal;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/normal_main.vert\":\n/*!*******************************************!*\\\n  !*** ./src/shader/chunk/normal_main.vert ***!\n  \\*******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_NORMAL\\n#ifdef HILO_NORMAL_MAP\\nvec3 T = normalize(u_normalMatrix * tangent.xyz);\\nvec3 N = normalize(u_normalMatrix * normal);\\nT = normalize(T - dot(T, N) * N);\\nvec3 B = cross(N, T) * tangent.w;\\nv_TBN = mat3(T, B, N);\\n#endif\\nv_normal = normalize(u_normalMatrix * normal);\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/pbr.frag\":\n/*!***********************************!*\\\n  !*** ./src/shader/chunk/pbr.frag ***!\n  \\***********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ../method/textureEnvMap.glsl */ \"./src/shader/method/textureEnvMap.glsl\") + \"\\n\" + __webpack_require__(/*! ../method/encoding.glsl */ \"./src/shader/method/encoding.glsl\") + \"\\n\" + __webpack_require__(/*! ./fixMathCrash.glsl */ \"./src/shader/chunk/fixMathCrash.glsl\") + \"\\n\\nuniform vec4 u_baseColor;\\n#ifdef HILO_BASE_COLOR_MAP\\nuniform HILO_SAMPLER_2D u_baseColorMap;\\n#endif\\n\\n#ifdef HILO_NEED_WORLD_NORMAL\\nuniform mat3 u_viewInverseNormalMatrix;\\n#endif\\n\\n#ifdef HILO_HAS_LIGHT\\nuniform float u_metallic;\\n#ifdef HILO_METALLIC_MAP\\nuniform HILO_SAMPLER_2D u_metallicMap;\\n#endif\\nuniform float u_roughness;\\n#ifdef HILO_ROUGHNESS_MAP\\nuniform HILO_SAMPLER_2D u_roughnessMap;\\n#endif\\n#ifdef HILO_METALLIC_ROUGHNESS_MAP\\nuniform HILO_SAMPLER_2D u_metallicRoughnessMap;\\n#endif\\n#ifdef HILO_OCCLUSION_MAP\\nuniform HILO_SAMPLER_2D u_occlusionMap;\\n#endif\\n\\n#ifdef HILO_OCCLUSION_STRENGTH\\nuniform float u_occlusionStrength;\\n#endif\\n\\n#ifdef HILO_DIFFUSE_ENV_MAP\\n#ifdef HILO_DIFFUSE_ENV_MAP_CUBE\\nuniform samplerCube u_diffuseEnvMap;\\n#else\\nuniform sampler2D u_diffuseEnvMap;\\n#endif\\nuniform float u_diffuseEnvIntensity;\\n#elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\nuniform vec3 u_diffuseEnvSphereHarmonics3[9];\\nuniform float u_diffuseEnvIntensity;\\n#endif\\n#ifdef HILO_SPECULAR_ENV_MAP\\nuniform sampler2D u_brdfLUT;\\n#ifdef HILO_SPECULAR_ENV_MAP_CUBE\\nuniform samplerCube u_specularEnvMap;\\n#else\\nuniform sampler2D u_specularEnvMap;\\n#endif\\nuniform float u_specularEnvIntensity;\\n\\nuniform float u_specularEnvMapMipCount;\\n#endif\\n\\n#ifdef HILO_EMISSION_MAP\\nuniform HILO_SAMPLER_2D u_emission;\\n#endif\\n\\n#ifdef HILO_PBR_SPECULAR_GLOSSINESS\\nuniform vec4 u_specular;\\nuniform float u_glossiness;\\n#ifdef HILO_SPECULAR_GLOSSINESS_MAP\\nuniform HILO_SAMPLER_2D u_specularGlossinessMap;\\n#endif\\n#endif\\n\\n#ifdef HILO_LIGHT_MAP\\nuniform HILO_SAMPLER_2D u_lightMap;\\n#endif\\n\\n\\n// PBR Based on https://github.com/KhronosGroup/glTF-WebGL-PBR\\n\\n// Basic Lambertian diffuse\\n// Implementation from Lambert's Photometria https://archive.org/details/lambertsphotome00lambgoog\\n// See also [1], Equation 1\\nvec3 diffuse(vec3 diffuseColor) {\\nreturn diffuseColor * HILO_INVERSE_PI;\\n}\\n\\n// The following equation models the Fresnel reflectance term of the spec equation (aka F())\\n// Implementation of fresnel from [4], Equation 15\\nvec3 specularReflection(vec3 reflectance0, vec3 reflectance90, float VdotH) {\\nreturn reflectance0 + (reflectance90 - reflectance0) * pow(clamp(1.0 - VdotH, 0.0, 1.0), 5.0);\\n}\\n\\n// This calculates the specular geometric attenuation (aka G()),\\n// where rougher material will reflect less light back to the viewer.\\n// This implementation is based on [1] Equation 4, and we adopt their modifications to\\n// alphaRoughness as input as originally proposed in [2].\\nfloat geometricOcclusion(float NdotL, float NdotV, float alphaRoughness) {\\nfloat r = alphaRoughness * alphaRoughness;\\n\\nfloat attenuationL = 2.0 * NdotL / (NdotL + sqrt(r + (1.0 - r) * (NdotL * NdotL)));\\nfloat attenuationV = 2.0 * NdotV / (NdotV + sqrt(r + (1.0 - r) * (NdotV * NdotV)));\\nreturn attenuationL * attenuationV;\\n}\\n\\n// The following equation(s) model the distribution of microfacet normals across the area being drawn (aka D())\\n// Implementation from \\\"Average Irregularity Representation of a Roughened Surface for Ray Reflection\\\" by T. S. Trowbridge, and K. P. Reitz\\n// Follows the distribution function recommended in the SIGGRAPH 2013 course notes from EPIC Games [1], Equation 3.\\nfloat microfacetDistribution(float alphaRoughness, float NdotH) {\\nfloat roughnessSq = alphaRoughness * alphaRoughness;\\nfloat f = (NdotH * roughnessSq - NdotH) * NdotH + 1.0;\\nreturn roughnessSq * HILO_INVERSE_PI / (f * f);\\n}\\n\\nvec3 computeDiffuseSHLight(vec3 normal, in vec3 sh[9]) {\\nreturn sh[0] +\\nsh[1] * (normal.y) +\\nsh[2] * (normal.z) +\\nsh[3] * (normal.x) +\\nsh[4] * (normal.y * normal.x) +\\nsh[5] * (normal.y * normal.z) +\\nsh[6] * ((3.0 * normal.z * normal.z) - 1.0) +\\nsh[7] * (normal.z * normal.x) +\\nsh[8] * (normal.x * normal.x - (normal.y * normal.y));\\n}\\n\\n// https://github.com/KhronosGroup/glTF/blob/master/extensions/2.0/Vendor/EXT_lights_image_based/README.md#rgbd\\nvec3 decodeRGBD(in vec4 color){\\nreturn color.rgb / color.a;\\n}\\n\\nvec3 getIBLContribution(in vec3 N, in vec3 V, vec3 diffuseColor, vec3 specularColor, float ao, float NdotV, float perceptualRoughness) {\\nvec3 color = vec3(.0, .0, .0);\\n#ifdef HILO_NEED_WORLD_NORMAL\\nN = u_viewInverseNormalMatrix * N;\\nV = u_viewInverseNormalMatrix * V;\\n#endif\\n#if defined(HILO_DIFFUSE_ENV_MAP) || defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\n#ifdef HILO_DIFFUSE_ENV_MAP\\n#ifdef HILO_GAMMA_CORRECTION\\nvec3 diffuseLight = sRGBToLinear(textureEnvMap(u_diffuseEnvMap, N)).rgb;\\n#else\\nvec3 diffuseLight = textureEnvMap(u_diffuseEnvMap, N).rgb;\\n#endif\\n#elif defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)\\nvec3 diffuseLight = computeDiffuseSHLight(N, u_diffuseEnvSphereHarmonics3);\\n#endif\\ncolor.rgb += diffuseLight * diffuseColor * ao * u_diffuseEnvIntensity;\\n#endif\\n\\n#ifdef HILO_SPECULAR_ENV_MAP\\nvec3 R = -normalize(reflect(V, N));\\nvec3 brdf = texture2D(u_brdfLUT, vec2(NdotV, 1.0 - perceptualRoughness)).rgb;\\n#ifdef HILO_IS_SPECULAR_ENV_MAP_INCLUDE_MIPMAPS\\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\nvec4 specularEnvMap = textureEnvMapIncludeMipmapsLod(u_specularEnvMap, R, lod);\\n#elif HILO_USE_SHADER_TEXTURE_LOD\\nfloat lod = clamp(perceptualRoughness * u_specularEnvMapMipCount, 0.0, u_specularEnvMapMipCount);\\nvec4 specularEnvMap = textureEnvMapLod(u_specularEnvMap, R, lod);\\n#else\\nvec4 specularEnvMap = textureEnvMap(u_specularEnvMap, R);\\n#endif\\n\\nvec3 specularLight = decodeRGBD(specularEnvMap);\\n\\n#ifdef HILO_GAMMA_CORRECTION\\nspecularLight = sRGBToLinear(specularLight);\\n#endif\\ncolor.rgb += specularLight * (specularColor * brdf.x + brdf.y) * u_specularEnvIntensity;\\n#endif\\nreturn color;\\n}\\n\\nvec3 calculateLo(vec3 N, vec3 V, vec3 L, vec3 reflectance0, vec3 reflectance90, float alphaRoughness, vec3 diffuseColor, float NdotV) {\\nvec3 H = normalize(L + V);\\nfloat NdotL = clamp(dot(N, L), 0.001, 1.0);\\nfloat NdotH = clamp(dot(N, H), 0.0, 1.0);\\nfloat LdotH = clamp(dot(L, H), 0.0, 1.0);\\nfloat VdotH = clamp(dot(V, H), 0.0, 1.0);\\n// Calculate the shading terms for the microfacet specular shading model\\nvec3 F = specularReflection(reflectance0, reflectance90, VdotH);\\nfloat G = geometricOcclusion(NdotL, NdotV, alphaRoughness);\\nfloat D = microfacetDistribution(alphaRoughness, NdotH);\\n\\nvec3 diffuseContrib;\\n\\n#ifdef HILO_LIGHT_MAP\\ndiffuseContrib = vec3(0.0);\\n#else\\ndiffuseContrib = (1.0 - F) * diffuse(diffuseColor);\\n#endif\\nvec3 specContrib = F * G * D / (4.0 * NdotL * NdotV);\\n// Obtain final intensity as reflectance (BRDF) scaled by the energy of the light (cosine law)\\nreturn NdotL * (diffuseContrib + specContrib);\\n}\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/pbr_main.frag\":\n/*!****************************************!*\\\n  !*** ./src/shader/chunk/pbr_main.frag ***!\n  \\****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\nvec4 baseColor = u_baseColor;\\n\\n#ifdef HILO_BASE_COLOR_MAP\\n#ifdef HILO_GAMMA_CORRECTION\\nbaseColor *= sRGBToLinear(HILO_TEXTURE_2D(u_baseColorMap));\\n#else\\nbaseColor *= HILO_TEXTURE_2D(u_baseColorMap);\\n#endif\\n#endif\\n\\n#if defined(HILO_HAS_COLOR)\\nbaseColor *= v_color;\\n#endif\\n\\ncolor.a = baseColor.a;\\n\\n\" + __webpack_require__(/*! ./transparency_main.frag */ \"./src/shader/chunk/transparency_main.frag\") + \"\\n\\n#ifdef HILO_HAS_LIGHT\\nvec3 viewPos = vec3(0, 0, 0);\\nvec3 N = normal;\\nvec3 V = normalize(viewPos - v_fragPos);\\n\\n#ifdef HILO_OCCLUSION_MAP\\nfloat ao  = HILO_TEXTURE_2D(u_occlusionMap).r;\\n#else\\nfloat ao = 1.0;\\n#endif\\n\\n#ifdef HILO_PBR_SPECULAR_GLOSSINESS\\nvec3 specular = u_specular.rgb;\\nfloat glossiness = u_glossiness;\\n#ifdef HILO_SPECULAR_GLOSSINESS_MAP\\nvec4 specularGlossiness = sRGBToLinear(HILO_TEXTURE_2D(u_specularGlossinessMap));\\nspecular = specularGlossiness.rgb * specular;\\nglossiness = specularGlossiness.a * glossiness;\\n#endif\\nfloat roughness = 1.0 - glossiness;\\nfloat metallic = 0.0;\\nvec3 diffuseColor = baseColor.rgb * (1.0 - max(max(specular.r, specular.g), specular.b));\\nvec3 specularColor = specular;\\n#else\\nfloat metallic = u_metallic;\\nfloat roughness = u_roughness;\\n#ifdef HILO_METALLIC_MAP\\nmetallic = HILO_TEXTURE_2D(u_metallicMap).r * u_metallic;\\n#endif\\n#ifdef HILO_ROUGHNESS_MAP\\nroughness  = HILO_TEXTURE_2D(u_roughnessMap).r * u_roughness;\\n#endif\\n#ifdef HILO_METALLIC_ROUGHNESS_MAP\\nvec4 metallicRoughnessMap = HILO_TEXTURE_2D(u_metallicRoughnessMap);\\n#ifdef HILO_IS_OCCLUSION_MAP_IN_METALLIC_ROUGHNESS_MAP\\nao = metallicRoughnessMap.r;\\n#endif\\nroughness = metallicRoughnessMap.g * u_roughness;\\nmetallic = metallicRoughnessMap.b * u_metallic;\\n#endif\\nroughness = clamp(roughness, 0.04, 1.0);\\nmetallic = clamp(metallic, 0.0, 1.0);\\nvec3 f0 = vec3(0.04);\\nvec3 diffuseColor = baseColor.rgb * (vec3(1.0) - f0);\\ndiffuseColor *= 1.0 - metallic;\\nvec3 specularColor = mix(f0, baseColor.rgb, metallic);\\n#endif\\n\\n#ifdef HILO_OCCLUSION_STRENGTH\\nao = mix(1.0, ao, u_occlusionStrength);\\n#endif\\n\\nfloat reflectance = max(max(specularColor.r, specularColor.g), specularColor.b);\\n// For typical incident reflectance range (between 4% to 100%) set the grazing reflectance to 100% for typical fresnel effect.\\n// For very low reflectance range on highly diffuse objects (below 4%), incrementally reduce grazing reflecance to 0%.\\nfloat reflectance90 = clamp(reflectance * 25.0, 0.0, 1.0);\\nvec3 specularEnvironmentR0 = specularColor.rgb;\\nvec3 specularEnvironmentR90 = vec3(1.0, 1.0, 1.0) * reflectance90;\\n\\nfloat NdotV = clamp(abs(dot(N, V)), 0.001, 1.0);\\nfloat alphaRoughness = roughness * roughness;\\n\\n#ifdef HILO_DIRECTIONAL_LIGHTS\\nfor(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\\nvec3 lightDir = normalize(-u_directionalLightsInfo[i]);\\nvec3 radiance = u_directionalLightsColor[i];\\nfloat shadow = 1.0;\\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\nif (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_directionalLightsShadowBias[i][0]);\\nshadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\\n}\\n#endif\\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n}\\n#endif\\n\\n#ifdef HILO_SPOT_LIGHTS\\nfor(int i = 0; i < HILO_SPOT_LIGHTS; i++){\\nvec3 lightDir = normalize(-u_spotLightsDir[i]);\\nvec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\\n\\nfloat theta = dot(normalize(distanceVec), lightDir);\\nfloat epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\\nfloat intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\\nfloat attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\\nvec3 radiance = intensity * attenuation * u_spotLightsColor[i];\\n\\nfloat shadow = 1.0;\\n#ifdef HILO_SPOT_LIGHTS_SMC\\nif (i < HILO_SPOT_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(N, lightDir)), u_spotLightsShadowBias[i][0]);\\nshadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\\n}\\n#endif\\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n}\\n#endif\\n\\n#ifdef HILO_POINT_LIGHTS\\nfor(int i = 0; i < HILO_POINT_LIGHTS; i++){\\nvec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\\nvec3 lightDir = normalize(distanceVec);\\n\\nfloat shadow = 1.0;\\n#ifdef HILO_POINT_LIGHTS_SMC\\nif (i < HILO_POINT_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\\nshadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\\n}\\n#endif\\n\\nfloat attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\\nvec3 radiance = attenuation * u_pointLightsColor[i];\\n\\ncolor.rgb += shadow * radiance * calculateLo(N, V, lightDir, specularEnvironmentR0, specularEnvironmentR90, alphaRoughness, diffuseColor, NdotV);\\n}\\n#endif\\n\\n#ifdef HILO_AREA_LIGHTS\\nfor(int i = 0; i < HILO_AREA_LIGHTS; i++){\\ncolor.rgb += getAreaLight(diffuseColor, specularColor, roughness, N, V, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\\n}\\n#endif\\n\\n#ifdef HILO_LIGHT_MAP\\nvec4 lightMapColor = HILO_TEXTURE_2D(u_lightMap);\\n// https://github.com/KhronosGroup/glTF/tree/master/extensions/2.0/Vendor/EXT_lights_image_based#rgbd\\ncolor.rgb += baseColor.rgb * decodeRGBD(lightMapColor);\\n#endif\\n\\n// IBL\\ncolor.rgb += getIBLContribution(N, V, diffuseColor, specularColor, ao, NdotV, roughness);\\n\\n#if defined(HILO_AMBIENT_LIGHTS) && (defined(HILO_IS_DIFFUESENV_AND_AMBIENTLIGHT_WORK_TOGETHER) || (!defined(HILO_DIFFUSE_ENV_MAP) && !defined(HILO_DIFFUSE_ENV_SPHERE_HARMONICS3)))\\ncolor.rgb += u_ambientLightsColor * baseColor.rgb * ao;\\n#endif\\n\\n#ifdef HILO_EMISSION_MAP\\n#ifdef HILO_GAMMA_CORRECTION\\ncolor.rgb += sRGBToLinear(HILO_TEXTURE_2D(u_emission)).rgb;\\n#else\\ncolor.rgb += HILO_TEXTURE_2D(u_emission).rgb;\\n#endif\\n#endif\\n#else\\ncolor = baseColor;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/phong.frag\":\n/*!*************************************!*\\\n  !*** ./src/shader/chunk/phong.frag ***!\n  \\*************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ../method/textureEnvMap.glsl */ \"./src/shader/method/textureEnvMap.glsl\") + \"\\n\" + __webpack_require__(/*! ./fixMathCrash.glsl */ \"./src/shader/chunk/fixMathCrash.glsl\") + \"\\n\\n#ifdef HILO_HAS_LIGHT\\n#ifdef HILO_HAS_SPECULAR\\nuniform float u_shininess;\\n#ifdef HILO_SPECULAR_MAP\\nuniform HILO_SAMPLER_2D u_specular;\\n#else\\nuniform vec4 u_specular;\\n#endif\\n#endif\\n#ifdef HILO_EMISSION_MAP\\nuniform HILO_SAMPLER_2D u_emission;\\n#else\\nuniform vec4 u_emission;\\n#endif\\n#ifdef HILO_AMBIENT_MAP\\nuniform HILO_SAMPLER_2D u_ambient;\\n#endif\\n#ifdef HILO_SPECULAR_ENV_MAP\\n#ifdef HILO_SPECULAR_ENV_MAP_CUBE\\nuniform samplerCube u_specularEnvMap;\\n#else\\nuniform sampler2D u_specularEnvMap;\\n#endif\\nuniform mat4 u_specularEnvMatrix;\\nuniform float u_reflectivity;\\nuniform float u_refractRatio;\\nuniform float u_refractivity;\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/phong_main.frag\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/phong_main.frag ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_LIGHT\\nvec3 lightDiffuse = vec3(0, 0, 0);\\nvec3 lightAmbient = vec3(0, 0, 0);\\nvec3 viewPos = vec3(0, 0, 0);\\n\\n#ifdef HILO_AMBIENT_MAP\\nlightAmbient = HILO_TEXTURE_2D(u_ambient).rgb;\\n#else\\nlightAmbient = diffuse.rgb;\\n#endif\\n\\n#ifdef HILO_HAS_SPECULAR\\nvec3 lightSpecular = vec3(0, 0, 0);\\n#ifdef HILO_SPECULAR_MAP\\nvec4 specular = HILO_TEXTURE_2D(u_specular);\\n#else\\nvec4 specular = u_specular;\\n#endif\\n#endif\\n\\n#ifdef HILO_EMISSION_MAP\\nvec4 emission = HILO_TEXTURE_2D(u_emission);\\n#else\\nvec4 emission = u_emission;\\n#endif\\n\\n#ifdef HILO_DIRECTIONAL_LIGHTS\\nfor(int i = 0;i < HILO_DIRECTIONAL_LIGHTS;i++){\\nvec3 lightDir = -u_directionalLightsInfo[i];\\n\\nfloat shadow = 1.0;\\n#ifdef HILO_DIRECTIONAL_LIGHTS_SMC\\nif (i < HILO_DIRECTIONAL_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_directionalLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_directionalLightsShadowBias[i][0]);\\nshadow = getShadow(u_directionalLightsShadowMap[i], u_directionalLightsShadowMapSize[i], bias, v_fragPos, u_directionalLightSpaceMatrix[i]);\\n}\\n#endif\\n\\nfloat diff = getDiffuse(normal, lightDir);\\nlightDiffuse += diff * u_directionalLightsColor[i] * shadow;\\n\\n#ifdef HILO_HAS_SPECULAR\\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\nlightSpecular += spec * u_directionalLightsColor[i] * shadow;\\n#endif\\n}\\n#endif\\n\\n#ifdef HILO_SPOT_LIGHTS\\nfor(int i = 0; i < HILO_SPOT_LIGHTS; i++){\\nvec3 lightDir = -u_spotLightsDir[i];\\nvec3 distanceVec = u_spotLightsPos[i] - v_fragPos;\\n\\nfloat shadow = 1.0;\\n#ifdef HILO_SPOT_LIGHTS_SMC\\nif (i < HILO_SPOT_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_spotLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_spotLightsShadowBias[i][0]);\\nshadow = getShadow(u_spotLightsShadowMap[i], u_spotLightsShadowMapSize[i], bias, v_fragPos, u_spotLightSpaceMatrix[i]);\\n}\\n#endif\\n\\nfloat diff = getDiffuse(normal, normalize(distanceVec));\\nfloat theta = dot(normalize(distanceVec), lightDir);\\nfloat epsilon = u_spotLightsCutoffs[i][0] - u_spotLightsCutoffs[i][1];\\nfloat intensity = clamp((theta - u_spotLightsCutoffs[i][1]) / epsilon, 0.0, 1.0);\\nfloat attenuation = getLightAttenuation(distanceVec, u_spotLightsInfo[i], u_spotLightsRange[i]);\\n\\nlightDiffuse += intensity * attenuation * shadow * diff * u_spotLightsColor[i];\\n\\n#ifdef HILO_HAS_SPECULAR\\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\nlightSpecular += intensity * attenuation * shadow * spec * u_spotLightsColor[i];\\n#endif\\n}\\n#endif\\n\\n#ifdef HILO_POINT_LIGHTS\\nfor(int i = 0;i < HILO_POINT_LIGHTS;i++){\\nvec3 distanceVec = u_pointLightsPos[i] - v_fragPos;\\nvec3 lightDir = normalize(distanceVec);\\n\\nfloat shadow = 1.0;\\n#ifdef HILO_POINT_LIGHTS_SMC\\nif (i < HILO_POINT_LIGHTS_SMC) {\\nfloat bias = HILO_MAX(u_pointLightsShadowBias[i][1] * (1.0 - dot(normal, lightDir)), u_pointLightsShadowBias[i][0]);\\nshadow = getShadow(u_pointLightsShadowMap[i], bias, u_pointLightsPos[i], v_fragPos, u_pointLightCamera[i], u_pointLightSpaceMatrix[i]);\\n}\\n#endif\\n\\nfloat diff = getDiffuse(normal, lightDir);\\nfloat attenuation = getLightAttenuation(distanceVec, u_pointLightsInfo[i], u_pointLightsRange[i]);\\nlightDiffuse += diff * attenuation * u_pointLightsColor[i] * shadow;\\n\\n#ifdef HILO_HAS_SPECULAR\\nfloat spec = getSpecular(viewPos, v_fragPos, lightDir, normal, u_shininess);\\nlightSpecular += spec * attenuation * u_pointLightsColor[i] * shadow;\\n#endif\\n}\\n#endif\\n\\n#ifdef HILO_AREA_LIGHTS\\n#ifndef HILO_HAS_SPECULAR\\nvec4 specular = vec4(0.0, 0.0, 0.0, 0.0);\\n#endif\\nvec3 viewDir = normalize(vec3(0, 0, 0) - v_fragPos);\\nfor(int i = 0; i < HILO_AREA_LIGHTS; i++){\\ncolor.rgb += getAreaLight(diffuse.rgb, specular.rgb, sqrt(2.0/(u_shininess+2.0)), normal, viewDir, v_fragPos, u_areaLightsPos[i], u_areaLightsColor[i], u_areaLightsWidth[i], u_areaLightsHeight[i], u_areaLightsLtcTexture1, u_areaLightsLtcTexture2);\\n}\\n#endif\\n\\n#ifdef HILO_AMBIENT_LIGHTS\\ncolor.rgb += u_ambientLightsColor * lightAmbient;\\n#endif\\n\\n#if defined(HILO_SPECULAR_ENV_MAP) && defined(HILO_HAS_SPECULAR)\\nvec3 I = normalize(v_fragPos - viewPos);\\nif (u_reflectivity > 0.0) {\\nvec3 R = reflect(I, normal);\\nR = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\\nlightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_reflectivity;\\n}\\nif (u_refractivity > 0.0) {\\nvec3 R = refract(I, normal, u_refractRatio);\\nR = normalize(vec3(u_specularEnvMatrix * vec4(R, 1.0)));\\nlightSpecular += textureEnvMap(u_specularEnvMap, R).rgb * u_refractivity;\\n}\\n#endif\\n\\ncolor.rgb += lightDiffuse * diffuse.rgb;\\n#ifdef HILO_HAS_SPECULAR\\ncolor.rgb += lightSpecular * specular.rgb;\\n#endif\\n\\ncolor.rgb += emission.rgb;\\n#else\\ncolor = diffuse;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/precision.frag\":\n/*!*****************************************!*\\\n  !*** ./src/shader/chunk/precision.frag ***!\n  \\*****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#ifdef GL_ES\\nprecision HILO_MAX_FRAGMENT_PRECISION float;\\n#define GLSLIFY 1\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/precision.vert\":\n/*!*****************************************!*\\\n  !*** ./src/shader/chunk/precision.vert ***!\n  \\*****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#ifdef GL_ES\\nprecision HILO_MAX_VERTEX_PRECISION float;\\n#define GLSLIFY 1\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/transparency.frag\":\n/*!********************************************!*\\\n  !*** ./src/shader/chunk/transparency.frag ***!\n  \\********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_TRANSPARENCY_MAP\\nuniform HILO_SAMPLER_2D u_transparency;\\n#else\\nuniform float u_transparency;\\n#endif\\n\\n#ifdef HILO_ALPHA_CUTOFF\\nuniform float u_alphaCutoff;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/transparency_main.frag\":\n/*!*************************************************!*\\\n  !*** ./src/shader/chunk/transparency_main.frag ***!\n  \\*************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat transparency = 1.0;\\n#ifdef HILO_TRANSPARENCY_MAP\\ntransparency = HILO_TEXTURE_2D(u_transparency).r;\\n#else\\ntransparency = u_transparency;\\n#endif\\ncolor.a *= transparency;\\n#ifdef HILO_ALPHA_CUTOFF\\nif (color.a < u_alphaCutoff) {\\ndiscard;\\n} else {\\ncolor.a = 1.0;\\n}\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/unQuantize.vert\":\n/*!******************************************!*\\\n  !*** ./src/shader/chunk/unQuantize.vert ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_QUANTIZED\\n#ifdef HILO_POSITION_QUANTIZED\\nuniform mat4 u_positionDecodeMat;\\n#endif\\n#ifdef HILO_NORMAL_QUANTIZED\\nuniform mat4 u_normalDecodeMat;\\n#endif\\n#ifdef HILO_UV_QUANTIZED\\nuniform mat3 u_uvDecodeMat;\\n#endif\\n#ifdef HILO_UV1_QUANTIZED\\nuniform mat3 u_uv1DecodeMat;\\n#endif\\n\\nvec2 unQuantize(vec2 data, mat3 decodeMat) {\\nvec3 result = vec3(data, 1.0);\\nresult = decodeMat * result;\\nreturn result.xy;\\n}\\n\\nvec3 unQuantize(vec3 data, mat4 decodeMat) {\\nvec4 result = vec4(data, 1.0);\\nresult = decodeMat * result;\\nreturn result.xyz;\\n}\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/unQuantize_main.vert\":\n/*!***********************************************!*\\\n  !*** ./src/shader/chunk/unQuantize_main.vert ***!\n  \\***********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_QUANTIZED\\n#ifdef HILO_POSITION_QUANTIZED\\npos.xyz = unQuantize(pos.xyz, u_positionDecodeMat);\\n#endif\\n#if defined(HILO_HAS_TEXCOORD0) && defined(HILO_UV_QUANTIZED)\\nuv = unQuantize(uv, u_uvDecodeMat);\\n#endif\\n#if defined(HILO_HAS_TEXCOORD1) && defined(HILO_UV1_QUANTIZED)\\nuv1 = unQuantize(uv1, u_uv1DecodeMat);\\n#endif\\n#if defined(HILO_HAS_NORMAL) && defined(HILO_NORMAL_QUANTIZED)\\nnormal = unQuantize(normal, u_normalDecodeMat);\\n#endif\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/uv.frag\":\n/*!**********************************!*\\\n  !*** ./src/shader/chunk/uv.frag ***!\n  \\**********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\nvarying vec2 v_texcoord0;\\n#endif\\n\\n#ifdef HILO_HAS_TEXCOORD1\\nvarying vec2 v_texcoord1;\\n#endif\\n\\n#if defined(HILO_HAS_TEXCOORD0) || defined(HILO_HAS_TEXCOORD1)\\n#if defined(HILO_HAS_TEXCOORD0) && defined(HILO_HAS_TEXCOORD1)\\n#define HILO_SAMPLER_2D hiloSampler2D\\n// https://www.khronos.org/opengl/wiki/Data_Type_(GLSL)#Opaque_types\\n#define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  hiloTexture2D(HILO_SAMPLER_2D.texture, HILO_SAMPLER_2D.uv)\\nstruct hiloSampler2D{\\nsampler2D texture;\\nint uv; \\n};\\n\\nvec4 hiloTexture2D(sampler2D texture, int uv){\\nif(uv == 0){\\nreturn texture2D(texture, v_texcoord0);\\n}\\nelse{\\nreturn texture2D(texture, v_texcoord1);\\n}\\n}\\n#else\\n#ifdef HILO_HAS_TEXCOORD1\\n#define HILO_V_TEXCOORD v_texcoord1\\n#else\\n#define HILO_V_TEXCOORD v_texcoord0\\n#endif\\n#define HILO_SAMPLER_2D sampler2D\\n#define HILO_TEXTURE_2D(HILO_SAMPLER_2D)  texture2D(HILO_SAMPLER_2D, HILO_V_TEXCOORD)\\n#endif\\n#endif\\n\\n\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\nvarying vec3 v_position;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/uv.vert\":\n/*!**********************************!*\\\n  !*** ./src/shader/chunk/uv.vert ***!\n  \\**********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\nattribute vec2 a_texcoord0;\\nvarying vec2 v_texcoord0;\\n#ifdef HILO_UV_MATRIX\\nuniform mat3 u_uvMatrix;\\n#endif\\n#endif\\n\\n#ifdef HILO_HAS_TEXCOORD1\\nattribute vec2 a_texcoord1;\\nvarying vec2 v_texcoord1;\\n#ifdef HILO_UV_MATRIX1\\nuniform mat3 u_uvMatrix1;\\n#endif\\n#endif\\n\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\nvarying vec3 v_position;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/chunk/uv_main.vert\":\n/*!***************************************!*\\\n  !*** ./src/shader/chunk/uv_main.vert ***!\n  \\***************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n#ifdef HILO_HAS_TEXCOORD0\\n#ifdef HILO_UV_MATRIX\\nv_texcoord0 = (u_uvMatrix * vec3(uv, 1.0)).xy;\\n#else\\nv_texcoord0 = uv;\\n#endif\\n#endif\\n#ifdef HILO_HAS_TEXCOORD1\\n#ifdef HILO_UV_MATRIX1\\nv_texcoord1 = (u_uvMatrix1 * vec3(uv1, 1.0)).xy;\\n#else\\nv_texcoord1 = uv1;\\n#endif\\n#endif\\n#ifdef HILO_DIFFUSE_CUBE_MAP\\nv_position = pos.xyz;\\n#endif\";\n\n/***/ }),\n\n/***/ \"./src/shader/geometry.frag\":\n/*!**********************************!*\\\n  !*** ./src/shader/geometry.frag ***!\n  \\**********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.frag */ \"./src/shader/chunk/extensions.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.frag */ \"./src/shader/chunk/precision.frag\") + \"\\n\\n#if defined(HILO_VERTEX_TYPE_POSITION)\\nvarying vec3 v_fragPos;\\n#elif defined(HILO_VERTEX_TYPE_NORMAL)\\nvarying vec3 v_normal;\\n#elif defined(HILO_VERTEX_TYPE_DEPTH)\\nuniform float u_cameraFar;\\nuniform float u_cameraNear;\\nuniform float u_cameraType;\\n#elif defined(HILO_VERTEX_TYPE_DISTANCE)\\n\" + __webpack_require__(/*! ./method/packFloat.glsl */ \"./src/shader/method/packFloat.glsl\") + \"\\n\\nuniform float u_cameraFar;\\nuniform float u_cameraNear;\\nvarying vec3 v_fragPos;\\n#endif\\n\\nvec4 transformDataToColor(vec3 data){\\n#ifdef HILO_WRITE_ORIGIN_DATA\\nreturn vec4(data, 1.0);\\n#else\\nreturn vec4(data * 0.5 + 0.5, 1.0);\\n#endif\\n}\\n\\n\" + __webpack_require__(/*! ./chunk/logDepth.frag */ \"./src/shader/chunk/logDepth.frag\") + \"\\n\\nvoid main(void) {\\n#if defined(HILO_VERTEX_TYPE_POSITION)\\ngl_FragColor = transformDataToColor(v_fragPos);\\n#elif defined(HILO_VERTEX_TYPE_NORMAL)\\ngl_FragColor = transformDataToColor(v_normal);\\n#elif defined(HILO_VERTEX_TYPE_DEPTH)\\nfloat z;\\n#ifdef HILO_WRITE_ORIGIN_DATA\\nz = gl_FragCoord.z;\\n#else\\n// OrthographicCamera\\nif(u_cameraType < 1.0){\\nz = gl_FragCoord.z;\\n}\\n// PerspectiveCamera\\nelse{\\nz = gl_FragCoord.z * 2.0 - 1.0;\\nz = (2.0 * u_cameraNear * u_cameraFar) / (u_cameraFar + u_cameraNear - z * (u_cameraFar - u_cameraNear));\\n}\\n#endif\\ngl_FragColor = vec4(z, z, z, 1.0);\\n#elif defined(HILO_VERTEX_TYPE_DISTANCE)\\nfloat distance = length(v_fragPos);\\n#ifdef HILO_WRITE_ORIGIN_DATA\\ngl_FragColor = vec4(distance, distance, distance, 1.0);\\n#else\\ngl_FragColor = packFloat((distance - u_cameraNear)/(u_cameraFar - u_cameraNear));\\n#endif\\n#endif\\n\" + __webpack_require__(/*! ./chunk/logDepth_main.frag */ \"./src/shader/chunk/logDepth_main.frag\") + \"\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/encoding.glsl\":\n/*!*****************************************!*\\\n  !*** ./src/shader/method/encoding.glsl ***!\n  \\*****************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nvec4 sRGBToLinear( in vec4 value ) {\\nreturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\\n}\\n\\nvec3 sRGBToLinear( in vec3 value ) {\\nreturn vec3( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ));\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/getAreaLight.glsl\":\n/*!*********************************************!*\\\n  !*** ./src/shader/method/getAreaLight.glsl ***!\n  \\*********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n// modified from https://github.com/mrdoob/three.js/blob/dev/src/renderers/shaders/ShaderChunk/lights_physical_pars_fragment.glsl#L26\\n\\n\" + __webpack_require__(/*! ../method/transpose.glsl */ \"./src/shader/method/transpose.glsl\") + \"\\n\\nvec2 LTC_Uv(const in vec3 N, const in vec3 V, const in float roughness) {\\nconst float LUT_SIZE = 64.0;\\nconst float LUT_SCALE = (LUT_SIZE - 1.0) / LUT_SIZE;\\nconst float LUT_BIAS = 0.5 / LUT_SIZE;\\nfloat dotNV = clamp(dot(N, V), 0.0, 1.0);\\nvec2 uv = vec2(roughness, sqrt(1.0 - dotNV));\\nuv = (uv * LUT_SCALE) + LUT_BIAS;\\nreturn uv;\\n}\\n\\nfloat LTC_ClippedSphereFormFactor(const in vec3 f) {\\nfloat l = length(f);\\nreturn max(((l * l) + f.z) / (l + 1.0), 0.0);\\n}\\n\\nvec3 LTC_EdgeVectorFormFactor(const in vec3 v1, const in vec3 v2) {\\nfloat x = dot(v1, v2);\\nfloat y = abs(x);\\nfloat a = 0.8543985 + ((0.4965155 + (0.0145206 * y)) * y);\\nfloat b = 3.4175940 + ((4.1616724 + y) * y);\\nfloat v = a / b;\\nfloat theta_sintheta = x > 0.0 ? v : (0.5 * inversesqrt(max(1.0 - (x * x), 1e-7))) - v;\\nreturn cross(v1, v2) * theta_sintheta;\\n}\\n\\nvec3 LTC_Evaluate(const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[4]) {\\nvec3 v1 = rectCoords[1] - rectCoords[0];\\nvec3 v2 = rectCoords[3] - rectCoords[0];\\nvec3 lightNormal = cross(v1, v2);\\nif (dot(lightNormal, P - rectCoords[0]) < 0.0)\\nreturn vec3(0.0);\\nvec3 T1, T2;\\nT1 = normalize(V - (N * dot(V, N)));\\nT2 = -cross(N, T1);\\nmat3 mat = mInv * transpose(mat3(T1, T2, N));\\nvec3 coords[4];\\ncoords[0] = mat * (rectCoords[0] - P);\\ncoords[1] = mat * (rectCoords[1] - P);\\ncoords[2] = mat * (rectCoords[2] - P);\\ncoords[3] = mat * (rectCoords[3] - P);\\ncoords[0] = normalize(coords[0]);\\ncoords[1] = normalize(coords[1]);\\ncoords[2] = normalize(coords[2]);\\ncoords[3] = normalize(coords[3]);\\nvec3 vectorFormFactor = vec3(0.0);\\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[0], coords[1]);\\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[1], coords[2]);\\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[2], coords[3]);\\nvectorFormFactor += LTC_EdgeVectorFormFactor(coords[3], coords[0]);\\nfloat result = LTC_ClippedSphereFormFactor(vectorFormFactor);\\nreturn vec3(result);\\n}\\n\\nvec3 getAreaLight(const in vec3 diffuseColor, const in vec3 specularColor, const in float roughness, const in vec3 normal, const in vec3 viewDir, const in vec3 position, const in vec3 lightPos, const in vec3 lightColor, const in vec3 halfWidth, const in vec3 halfHeight, const in sampler2D areaLightsLtcTexture1, const in sampler2D areaLightsLtcTexture2){\\nvec3 rectCoords[4];\\nrectCoords[0] = (lightPos - halfWidth) - halfHeight;\\nrectCoords[1] = (lightPos + halfWidth) - halfHeight;\\nrectCoords[2] = (lightPos + halfWidth) + halfHeight;\\nrectCoords[3] = (lightPos - halfWidth) + halfHeight;\\n\\nvec2 uv = LTC_Uv(normal, viewDir, roughness);\\nvec4 t1 = texture2D(areaLightsLtcTexture1, uv);\\nvec4 t2 = texture2D(areaLightsLtcTexture2, uv);\\n\\nmat3 mInv = mat3(vec3(t1.x, 0, t1.y), vec3(0, 1, 0), vec3(t1.z, 0, t1.w));\\nvec3 fresnel = (specularColor * t2.x) + ((vec3(1.0) - specularColor) * t2.y);\\n\\nvec3 color = vec3(0.0, 0.0, 0.0);\\ncolor += ((lightColor * fresnel) * LTC_Evaluate(normal, viewDir, position, mInv, rectCoords));\\ncolor += ((lightColor * diffuseColor) * LTC_Evaluate(normal, viewDir, position, mat3(1.0), rectCoords));\\nreturn color;\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/getDiffuse.glsl\":\n/*!*******************************************!*\\\n  !*** ./src/shader/method/getDiffuse.glsl ***!\n  \\*******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat getDiffuse(vec3 normal, vec3 lightDir){\\nreturn max(dot(normal, lightDir), 0.0);\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/getLightAttenuation.glsl\":\n/*!****************************************************!*\\\n  !*** ./src/shader/method/getLightAttenuation.glsl ***!\n  \\****************************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat getLightAttenuation(vec3 distanceVec, vec3 info, float range){\\nfloat distance = length(distanceVec);\\nfloat attenuation = 1.0;\\n#ifdef HILO_USE_PHYSICS_LIGHT\\nattenuation = max(1.0 / (distance * distance), 0.001);\\nif (range > 0.0) {\\nattenuation *= max(min(1.0 - pow( distance / range, 4.0 ), 1.0), 0.0);\\n}\\n#else\\nattenuation = 1.0/(info.x + info.y * distance + info.z * distance * distance);\\n#endif\\n\\nreturn attenuation;\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/getShadow.glsl\":\n/*!******************************************!*\\\n  !*** ./src/shader/method/getShadow.glsl ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nbool isOutOfRange(vec2 pos) {\\nif (pos.x < 0.0 || pos.x > 1.0 || pos.y < 0.0 || pos.y > 1.0) {\\nreturn true;\\n}\\nreturn false;\\n}\\n\\nfloat getShadow(sampler2D shadowMap, vec2 shadowMapSize, float bias, vec3 fragPos, mat4 lightSpaceMatrix) {\\nvec4 fragPosLightSpace = lightSpaceMatrix * vec4(fragPos, 1.0);\\nvec3 projCoords = fragPosLightSpace.xyz / fragPosLightSpace.w;\\nprojCoords = projCoords * 0.5 + 0.5;\\nif (isOutOfRange(projCoords.xy)) {\\nreturn 1.0;\\n}\\nfloat currentDepth = projCoords.z;\\nfloat shadow = 0.0;\\nvec2 texelSize = 1.0 / shadowMapSize;\\nfor (int x = -1; x <= 1; ++x) {\\nfor (int y = -1; y <= 1; ++y) {\\nvec2 pos = projCoords.xy + vec2(x, y) * texelSize;\\nif (isOutOfRange(pos)) {\\nshadow += 1.0;\\n} else {\\nfloat pcfDepth = texture2D(shadowMap, pos).r;\\nshadow += currentDepth - bias > pcfDepth ? 1.0 : 0.0;\\n}\\n}\\n}\\nreturn 1.0 - shadow / 9.0;\\n}\\n\\nfloat getShadow(samplerCube shadowMap, float bias, vec3 lightPos, vec3 position, vec2 camera, mat4 lightSpaceMatrix) {\\nvec4 distanceVec = lightSpaceMatrix * vec4(position, 1.0) - lightSpaceMatrix * vec4(lightPos, 1.0);\\nfloat currentDistance = length(distanceVec);\\nvec3 direction = normalize(distanceVec).xyz;\\n\\nfloat shadow = 0.0;\\nconst float samples = 2.0;\\nconst float offset = 0.01;\\nconst float step = offset / (samples * 0.5);\\nfor(float x = -offset; x < offset; x +=step)\\n{\\nfor(float y = -offset; y < offset; y +=step)\\n{\\nfor(float z = -offset; z < offset; z +=step)\\n{\\nfloat closestDistance = camera[0] + (camera[1] - camera[0]) * unpackFloat(textureCube(shadowMap, direction + vec3(x, y, z)));\\nif (closestDistance == camera[0]) {\\ncontinue;\\n}\\nelse if(currentDistance - bias > closestDistance)\\nshadow += 1.0;\\n}\\n}\\n}\\nshadow /= (samples * samples * samples);\\n\\nreturn 1.0 - shadow;\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/getSpecular.glsl\":\n/*!********************************************!*\\\n  !*** ./src/shader/method/getSpecular.glsl ***!\n  \\********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat getSpecular(vec3 cameraPos, vec3 fragPos, vec3 lightDir, vec3 normal, float shininess){\\nvec3 viewDir = normalize(cameraPos - fragPos);\\n#ifdef LIGHT_TYPE_PHONG\\nreturn pow(max(dot(viewDir, reflect(-lightDir, normal), 0.0), shininess);\\n#else\\nreturn pow(max(dot(normal, normalize(lightDir + viewDir)), 0.0), shininess);\\n#endif\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/packFloat.glsl\":\n/*!******************************************!*\\\n  !*** ./src/shader/method/packFloat.glsl ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\n// https://github.com/playcanvas/engine/blob/master/src/graphics/program-lib/chunks/packDepth.frag\\n// Packing a float in GLSL with multiplication and mod\\n// http://blog.gradientstudios.com/2012/08/23/shadow-map-improvement\\nvec4 packFloat(float depth) {\\nconst vec4 bit_shift = vec4(256.0 * 256.0 * 256.0, 256.0 * 256.0, 256.0, 1.0);\\nconst vec4 bit_mask  = vec4(0.0, 1.0 / 256.0, 1.0 / 256.0, 1.0 / 256.0);\\n\\n// combination of mod and multiplication and division works better\\nvec4 res = mod(depth * bit_shift * vec4(255), vec4(256) ) / vec4(255);\\nres -= res.xxyz * bit_mask;\\nreturn res;\\n}\\n\\n\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/textureEnvMap.glsl\":\n/*!**********************************************!*\\\n  !*** ./src/shader/method/textureEnvMap.glsl ***!\n  \\**********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nvec4 textureEnvMap(sampler2D texture, vec3 position){\\nreturn texture2D(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI));\\n}\\n\\nvec4 textureEnvMap(samplerCube texture, vec3 position){\\nreturn textureCube(texture, position);\\n}\\n\\nvec4 textureEnvMapIncludeMipmapsLod(sampler2D texture, vec3 position, float lod){\\nlod = floor(lod);\\nvec2 uv = vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI);\\n\\nfloat scale = pow(2.0, lod);\\n\\nreturn texture2D(texture, vec2(uv.x / scale, (uv.y / scale / 2.0) + 1.0 - 1.0/pow(2.0, lod)));\\n}\\n\\n#ifdef HILO_USE_SHADER_TEXTURE_LOD\\nvec4 textureEnvMapLod(sampler2D texture, vec3 position, float lod){\\nreturn texture2DLodEXT(texture, vec2(atan(position.x, position.z) * HILO_INVERSE_PI * 0.5+0.5,  acos(position.y) * HILO_INVERSE_PI), lod);\\n}\\n\\nvec4 textureEnvMapLod(samplerCube texture, vec3 position, float lod){\\nreturn textureCubeLodEXT(texture, position, lod);\\n}\\n#endif\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/transpose.glsl\":\n/*!******************************************!*\\\n  !*** ./src/shader/method/transpose.glsl ***!\n  \\******************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat transpose(float m) {\\nreturn m;\\n}\\n\\nmat2 transpose(mat2 m) {\\nreturn mat2(m[0][0], m[1][0],\\nm[0][1], m[1][1]);\\n}\\n\\nmat3 transpose(mat3 m) {\\nreturn mat3(m[0][0], m[1][0], m[2][0],\\nm[0][1], m[1][1], m[2][1],\\nm[0][2], m[1][2], m[2][2]);\\n}\\n\\nmat4 transpose(mat4 m) {\\nreturn mat4(m[0][0], m[1][0], m[2][0], m[3][0],\\nm[0][1], m[1][1], m[2][1], m[3][1],\\nm[0][2], m[1][2], m[2][2], m[3][2],\\nm[0][3], m[1][3], m[2][3], m[3][3]);\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/method/unpackFloat.glsl\":\n/*!********************************************!*\\\n  !*** ./src/shader/method/unpackFloat.glsl ***!\n  \\********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports) {\n\nmodule.exports = \"#define GLSLIFY 1\\nfloat unpackFloat(vec4 rgbaDepth) {\\nconst vec4 bitShift = vec4(1.0 / (256.0 * 256.0 * 256.0), 1.0 / (256.0 * 256.0), 1.0 / 256.0, 1.0);\\nfloat depth = dot(rgbaDepth, bitShift);\\nreturn depth;\\n}\\n\\n\";\n\n/***/ }),\n\n/***/ \"./src/shader/pbr.frag\":\n/*!*****************************!*\\\n  !*** ./src/shader/pbr.frag ***!\n  \\*****************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.frag */ \"./src/shader/chunk/extensions.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.frag */ \"./src/shader/chunk/precision.frag\") + \"\\n\\n\" + __webpack_require__(/*! ./chunk/color.frag */ \"./src/shader/chunk/color.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/uv.frag */ \"./src/shader/chunk/uv.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/normal.frag */ \"./src/shader/chunk/normal.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog.frag */ \"./src/shader/chunk/lightFog.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/pbr.frag */ \"./src/shader/chunk/pbr.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/light.frag */ \"./src/shader/chunk/light.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/transparency.frag */ \"./src/shader/chunk/transparency.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/fog.frag */ \"./src/shader/chunk/fog.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/logDepth.frag */ \"./src/shader/chunk/logDepth.frag\") + \"\\n\\nvoid main(void) {\\nvec4 color = vec4(0., 0., 0., 1.);\\n\\n\" + __webpack_require__(/*! ./chunk/normal_main.frag */ \"./src/shader/chunk/normal_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/lightFog_main.frag */ \"./src/shader/chunk/lightFog_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/pbr_main.frag */ \"./src/shader/chunk/pbr_main.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/frag_color.frag */ \"./src/shader/chunk/frag_color.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/logDepth_main.frag */ \"./src/shader/chunk/logDepth_main.frag\") + \"\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/screen.frag\":\n/*!********************************!*\\\n  !*** ./src/shader/screen.frag ***!\n  \\********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.frag */ \"./src/shader/chunk/extensions.frag\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.frag */ \"./src/shader/chunk/precision.frag\") + \"\\n\\nvarying vec2 v_texcoord0;\\nuniform sampler2D u_diffuse;\\n\\nvoid main(void) {  \\ngl_FragColor = texture2D(u_diffuse, v_texcoord0);\\n}\";\n\n/***/ }),\n\n/***/ \"./src/shader/screen.vert\":\n/*!********************************!*\\\n  !*** ./src/shader/screen.vert ***!\n  \\********************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = \"#define GLSLIFY 1\\n\" + __webpack_require__(/*! ./chunk/extensions.vert */ \"./src/shader/chunk/extensions.vert\") + \"\\n\" + __webpack_require__(/*! ./chunk/baseDefine.glsl */ \"./src/shader/chunk/baseDefine.glsl\") + \"\\n\" + __webpack_require__(/*! ./chunk/precision.vert */ \"./src/shader/chunk/precision.vert\") + \"\\n\\nattribute vec2 a_position;\\nattribute vec2 a_texcoord0;\\nvarying vec2 v_texcoord0;\\n\\n\\nvoid main(void) {\\nvec4 pos = vec4(a_position, 0.0, 1.0);\\ngl_Position = pos;\\nv_texcoord0 = a_texcoord0;\\n}\";\n\n/***/ }),\n\n/***/ 0:\n/*!***********************************************!*\\\n  !*** multi ./src/polyfill.js ./src/Hilo3d.js ***!\n  \\***********************************************/\n/*! no static exports found */\n/*! ModuleConcatenation bailout: Module is not an ECMAScript module */\n/***/ (function(module, exports, __webpack_require__) {\n\n__webpack_require__(/*! ./src/polyfill.js */\"./src/polyfill.js\");\nmodule.exports = __webpack_require__(/*! ./src/Hilo3d.js */\"./src/Hilo3d.js\");\n\n\n/***/ })\n\n/******/ });\nif(typeof window !== 'undefined' && window.Hilo3d){\n    {\n        module.exports = window.Hilo3d;\n    }\n}\n});\n\nvar Hilo3d$1 = unwrapExports(Hilo3d);\nvar Hilo3d_1 = Hilo3d.util;\nvar Hilo3d_2 = Hilo3d.GLTFExtensions;\nvar Hilo3d_3 = Hilo3d.Class;\nvar Hilo3d_4 = Hilo3d.EventMixin;\nvar Hilo3d_5 = Hilo3d.Fog;\nvar Hilo3d_6 = Hilo3d.Mesh;\nvar Hilo3d_7 = Hilo3d.Node;\nvar Hilo3d_8 = Hilo3d.SkinedMesh;\nvar Hilo3d_9 = Hilo3d.Stage;\nvar Hilo3d_10 = Hilo3d.Tween;\nvar Hilo3d_11 = Hilo3d.version;\nvar Hilo3d_12 = Hilo3d.BoxGeometry;\nvar Hilo3d_13 = Hilo3d.Geometry;\nvar Hilo3d_14 = Hilo3d.GeometryData;\nvar Hilo3d_15 = Hilo3d.MorphGeometry;\nvar Hilo3d_16 = Hilo3d.PlaneGeometry;\nvar Hilo3d_17 = Hilo3d.SphereGeometry;\nvar Hilo3d_18 = Hilo3d.Camera;\nvar Hilo3d_19 = Hilo3d.PerspectiveCamera;\nvar Hilo3d_20 = Hilo3d.OrthographicCamera;\nvar Hilo3d_21 = Hilo3d.Buffer;\nvar Hilo3d_22 = Hilo3d.capabilities;\nvar Hilo3d_23 = Hilo3d.extensions;\nvar Hilo3d_24 = Hilo3d.Framebuffer;\nvar Hilo3d_25 = Hilo3d.glType;\nvar Hilo3d_26 = Hilo3d.Program;\nvar Hilo3d_27 = Hilo3d.RenderInfo;\nvar Hilo3d_28 = Hilo3d.RenderList;\nvar Hilo3d_29 = Hilo3d.VertexArrayObject;\nvar Hilo3d_30 = Hilo3d.WebGLRenderer;\nvar Hilo3d_31 = Hilo3d.WebGLResourceManager;\nvar Hilo3d_32 = Hilo3d.WebGLState;\nvar Hilo3d_33 = Hilo3d.BasicLoader;\nvar Hilo3d_34 = Hilo3d.CubeTextureLoader;\nvar Hilo3d_35 = Hilo3d.GLTFLoader;\nvar Hilo3d_36 = Hilo3d.GLTFParser;\nvar Hilo3d_37 = Hilo3d.AliAMCExtension;\nvar Hilo3d_38 = Hilo3d.HDRLoader;\nvar Hilo3d_39 = Hilo3d.KTXLoader;\nvar Hilo3d_40 = Hilo3d.LoadCache;\nvar Hilo3d_41 = Hilo3d.LoadQueue;\nvar Hilo3d_42 = Hilo3d.ShaderMaterialLoader;\nvar Hilo3d_43 = Hilo3d.TextureLoader;\nvar Hilo3d_44 = Hilo3d.Loader;\nvar Hilo3d_45 = Hilo3d.Texture;\nvar Hilo3d_46 = Hilo3d.LazyTexture;\nvar Hilo3d_47 = Hilo3d.CubeTexture;\nvar Hilo3d_48 = Hilo3d.DataTexture;\nvar Hilo3d_49 = Hilo3d.Shader;\nvar Hilo3d_50 = Hilo3d.BasicMaterial;\nvar Hilo3d_51 = Hilo3d.GeometryMaterial;\nvar Hilo3d_52 = Hilo3d.Material;\nvar Hilo3d_53 = Hilo3d.PBRMaterial;\nvar Hilo3d_54 = Hilo3d.semantic;\nvar Hilo3d_55 = Hilo3d.ShaderMaterial;\nvar Hilo3d_56 = Hilo3d.AxisHelper;\nvar Hilo3d_57 = Hilo3d.AxisNetHelper;\nvar Hilo3d_58 = Hilo3d.CameraHelper;\nvar Hilo3d_59 = Hilo3d.AmbientLight;\nvar Hilo3d_60 = Hilo3d.AreaLight;\nvar Hilo3d_61 = Hilo3d.DirectionalLight;\nvar Hilo3d_62 = Hilo3d.CubeLightShadow;\nvar Hilo3d_63 = Hilo3d.Light;\nvar Hilo3d_64 = Hilo3d.LightManager;\nvar Hilo3d_65 = Hilo3d.LightShadow;\nvar Hilo3d_66 = Hilo3d.PointLight;\nvar Hilo3d_67 = Hilo3d.SpotLight;\nvar Hilo3d_68 = Hilo3d.Animation;\nvar Hilo3d_69 = Hilo3d.AnimationStates;\nvar Hilo3d_70 = Hilo3d.MeshPicker;\nvar Hilo3d_71 = Hilo3d.Ticker;\nvar Hilo3d_72 = Hilo3d.log;\nvar Hilo3d_73 = Hilo3d.Cache;\nvar Hilo3d_74 = Hilo3d.browser;\nvar Hilo3d_75 = Hilo3d.WebGLSupport;\nvar Hilo3d_76 = Hilo3d.constants;\nvar Hilo3d_77 = Hilo3d.Color;\nvar Hilo3d_78 = Hilo3d.Euler;\nvar Hilo3d_79 = Hilo3d.EulerNotifier;\nvar Hilo3d_80 = Hilo3d.Frustum;\nvar Hilo3d_81 = Hilo3d.math;\nvar Hilo3d_82 = Hilo3d.Matrix3;\nvar Hilo3d_83 = Hilo3d.Matrix4;\nvar Hilo3d_84 = Hilo3d.Matrix4Notifier;\nvar Hilo3d_85 = Hilo3d.Plane;\nvar Hilo3d_86 = Hilo3d.Quaternion;\nvar Hilo3d_87 = Hilo3d.Ray;\nvar Hilo3d_88 = Hilo3d.Sphere;\nvar Hilo3d_89 = Hilo3d.Vector2;\nvar Hilo3d_90 = Hilo3d.Vector3;\nvar Hilo3d_91 = Hilo3d.Vector3Notifier;\nvar Hilo3d_92 = Hilo3d.Vector4;\nvar Hilo3d_93 = Hilo3d.SphericalHarmonics3;\nvar Hilo3d_94 = Hilo3d.Skeleton;\n\nvar Hilo3d$2 = /*#__PURE__*/Object.freeze({\n  __proto__: null,\n  'default': Hilo3d$1,\n  __moduleExports: Hilo3d,\n  util: Hilo3d_1,\n  GLTFExtensions: Hilo3d_2,\n  Class: Hilo3d_3,\n  EventMixin: Hilo3d_4,\n  Fog: Hilo3d_5,\n  Mesh: Hilo3d_6,\n  Node: Hilo3d_7,\n  SkinedMesh: Hilo3d_8,\n  Stage: Hilo3d_9,\n  Tween: Hilo3d_10,\n  version: Hilo3d_11,\n  BoxGeometry: Hilo3d_12,\n  Geometry: Hilo3d_13,\n  GeometryData: Hilo3d_14,\n  MorphGeometry: Hilo3d_15,\n  PlaneGeometry: Hilo3d_16,\n  SphereGeometry: Hilo3d_17,\n  Camera: Hilo3d_18,\n  PerspectiveCamera: Hilo3d_19,\n  OrthographicCamera: Hilo3d_20,\n  Buffer: Hilo3d_21,\n  capabilities: Hilo3d_22,\n  extensions: Hilo3d_23,\n  Framebuffer: Hilo3d_24,\n  glType: Hilo3d_25,\n  Program: Hilo3d_26,\n  RenderInfo: Hilo3d_27,\n  RenderList: Hilo3d_28,\n  VertexArrayObject: Hilo3d_29,\n  WebGLRenderer: Hilo3d_30,\n  WebGLResourceManager: Hilo3d_31,\n  WebGLState: Hilo3d_32,\n  BasicLoader: Hilo3d_33,\n  CubeTextureLoader: Hilo3d_34,\n  GLTFLoader: Hilo3d_35,\n  GLTFParser: Hilo3d_36,\n  AliAMCExtension: Hilo3d_37,\n  HDRLoader: Hilo3d_38,\n  KTXLoader: Hilo3d_39,\n  LoadCache: Hilo3d_40,\n  LoadQueue: Hilo3d_41,\n  ShaderMaterialLoader: Hilo3d_42,\n  TextureLoader: Hilo3d_43,\n  Loader: Hilo3d_44,\n  Texture: Hilo3d_45,\n  LazyTexture: Hilo3d_46,\n  CubeTexture: Hilo3d_47,\n  DataTexture: Hilo3d_48,\n  Shader: Hilo3d_49,\n  BasicMaterial: Hilo3d_50,\n  GeometryMaterial: Hilo3d_51,\n  Material: Hilo3d_52,\n  PBRMaterial: Hilo3d_53,\n  semantic: Hilo3d_54,\n  ShaderMaterial: Hilo3d_55,\n  AxisHelper: Hilo3d_56,\n  AxisNetHelper: Hilo3d_57,\n  CameraHelper: Hilo3d_58,\n  AmbientLight: Hilo3d_59,\n  AreaLight: Hilo3d_60,\n  DirectionalLight: Hilo3d_61,\n  CubeLightShadow: Hilo3d_62,\n  Light: Hilo3d_63,\n  LightManager: Hilo3d_64,\n  LightShadow: Hilo3d_65,\n  PointLight: Hilo3d_66,\n  SpotLight: Hilo3d_67,\n  Animation: Hilo3d_68,\n  AnimationStates: Hilo3d_69,\n  MeshPicker: Hilo3d_70,\n  Ticker: Hilo3d_71,\n  log: Hilo3d_72,\n  Cache: Hilo3d_73,\n  browser: Hilo3d_74,\n  WebGLSupport: Hilo3d_75,\n  constants: Hilo3d_76,\n  Color: Hilo3d_77,\n  Euler: Hilo3d_78,\n  EulerNotifier: Hilo3d_79,\n  Frustum: Hilo3d_80,\n  math: Hilo3d_81,\n  Matrix3: Hilo3d_82,\n  Matrix4: Hilo3d_83,\n  Matrix4Notifier: Hilo3d_84,\n  Plane: Hilo3d_85,\n  Quaternion: Hilo3d_86,\n  Ray: Hilo3d_87,\n  Sphere: Hilo3d_88,\n  Vector2: Hilo3d_89,\n  Vector3: Hilo3d_90,\n  Vector3Notifier: Hilo3d_91,\n  Vector4: Hilo3d_92,\n  SphericalHarmonics3: Hilo3d_93,\n  Skeleton: Hilo3d_94\n});\n\n/**\r\n * @File   : Hilo3d.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 2018/9/29 下午1:26:08\r\n * @Description:\r\n */\n\n/**\r\n * @hidden\r\n */\r\nvar math = Hilo3d$2.math;\r\nvar clamp = math.clamp;\r\nvar DEG2RAD = math.DEG2RAD;\r\nvar degToRad = math.degToRad;\r\nvar isPowerOfTwo = math.isPowerOfTwo;\r\nvar nearestPowerOfTwo = math.nearestPowerOfTwo;\r\nvar nextPowerOfTwo = math.nextPowerOfTwo;\r\nvar RAD2DEG = math.RAD2DEG;\r\nvar radToDeg = math.radToDeg;\r\n/**\r\n * 判断一个实例是否为`Vector2`。\r\n */\r\nfunction isVector2(value) {\r\n    return value.isVector2;\r\n}\r\n/**\r\n * 判断一个实例是否为`Vector3`。\r\n */\r\nfunction isVector3(value) {\r\n    return value.isVector3;\r\n}\r\n/**\r\n * 判断一个实例是否为`Vector4`。\r\n */\r\nfunction isVector4(value) {\r\n    return value.isVector4;\r\n}\r\n/**\r\n * 判断一个实例是否为`Matrix3`。\r\n */\r\nfunction isMatrix3(value) {\r\n    return value.isMatrix3;\r\n}\r\n/**\r\n * 判断一个实例是否为`Matrix4`。\r\n */\r\nfunction isMatrix4(value) {\r\n    return value.isMatrix4;\r\n}\r\n/**\r\n * 判断一个实例是否为`Quaternion`。\r\n */\r\nfunction isQuaternion(value) {\r\n    return value.isQuaternion;\r\n}\r\n/**\r\n * 判断一个实例是否为`Color`。\r\n */\r\nfunction isColor(value) {\r\n    return value.isColor;\r\n}\r\n/**\r\n * 判断一个实例是否为`Euler`。\r\n */\r\nfunction isEuler(value) {\r\n    return value.isEuler;\r\n}\r\n/**\r\n * 判断一个实例是否为`SphericalHarmonics3`。\r\n */\r\nfunction isSphericalHarmonics3(value) {\r\n    return value.isSphericalHarmonics3;\r\n}\r\nvar Vector2 = /** @class */ (function (_super) {\r\n    __extends(Vector2, _super);\r\n    function Vector2() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Vector2;\r\n}(Hilo3d$2.Vector2));\r\nvar Vector3 = /** @class */ (function (_super) {\r\n    __extends(Vector3, _super);\r\n    function Vector3() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Vector3;\r\n}(Hilo3d$2.Vector3));\r\nvar Vector4 = /** @class */ (function (_super) {\r\n    __extends(Vector4, _super);\r\n    function Vector4() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Vector4;\r\n}(Hilo3d$2.Vector4));\r\nvar Matrix3 = /** @class */ (function (_super) {\r\n    __extends(Matrix3, _super);\r\n    function Matrix3() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Matrix3;\r\n}(Hilo3d$2.Matrix3));\r\nvar Matrix4 = /** @class */ (function (_super) {\r\n    __extends(Matrix4, _super);\r\n    function Matrix4() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Matrix4;\r\n}(Hilo3d$2.Matrix4));\r\nvar Quaternion = /** @class */ (function (_super) {\r\n    __extends(Quaternion, _super);\r\n    function Quaternion() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Quaternion;\r\n}(Hilo3d$2.Quaternion));\r\nvar Color = /** @class */ (function (_super) {\r\n    __extends(Color, _super);\r\n    function Color() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Color;\r\n}(Hilo3d$2.Color));\r\nvar Euler = /** @class */ (function (_super) {\r\n    __extends(Euler, _super);\r\n    function Euler() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Euler;\r\n}(Hilo3d$2.Euler));\r\nvar SphericalHarmonics3 = /** @class */ (function (_super) {\r\n    __extends(SphericalHarmonics3, _super);\r\n    function SphericalHarmonics3() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return SphericalHarmonics3;\r\n}(Hilo3d$2.SphericalHarmonics3));\r\n/**\r\n * 判断一个实例是否为`Spherical`。\r\n */\r\nfunction isSpherical(value) {\r\n    return value.isSpherical;\r\n}\r\n/**\r\n * 球面坐标系。\r\n */\r\nvar Spherical = /** @class */ (function () {\r\n    function Spherical(radius, phi, theta) {\r\n        this.isSpherical = true;\r\n        /**\r\n         * 球面球心。\r\n         */\r\n        this.center = new Vector3();\r\n        this.radius = radius || 0;\r\n        this.phi = phi || 0;\r\n        this.theta = theta || 0;\r\n    }\r\n    Spherical.prototype.set = function (radius, phi, theta) {\r\n        this.radius = radius;\r\n        this.phi = phi;\r\n        this.theta = theta;\r\n        return this;\r\n    };\r\n    Spherical.prototype.clone = function () {\r\n        return new Spherical().copy(this);\r\n    };\r\n    Spherical.prototype.copy = function (other) {\r\n        this.radius = other.radius;\r\n        this.phi = other.phi;\r\n        this.theta = other.theta;\r\n        return this;\r\n    };\r\n    /**\r\n     * restrict phi to be between EPS and PI-EPS。\r\n     */\r\n    Spherical.prototype.makeSafe = function () {\r\n        var EPS = Spherical.EPS;\r\n        this.phi = Math.max(EPS, Math.min(Math.PI - EPS, this.phi));\r\n        return this;\r\n    };\r\n    /**\r\n     * 从笛卡尔坐标系的Vector3转换。\r\n     */\r\n    Spherical.prototype.setFromVector3 = function (vector) {\r\n        return this.setFromCartesianCoords(vector.x, vector.y, vector.z);\r\n    };\r\n    /**\r\n     * 从笛卡尔坐标系的x、y、z转换。\r\n     */\r\n    Spherical.prototype.setFromCartesianCoords = function (x, y, z) {\r\n        this.radius = Math.sqrt(x * x + y * y + z * z);\r\n        if (this.radius === 0) {\r\n            this.theta = 0;\r\n            this.phi = 0;\r\n        }\r\n        else {\r\n            this.theta = Math.atan2(x, z);\r\n            this.phi = Math.acos(clamp(y / this.radius, -1, 1));\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 转换到笛卡尔坐标系的Vector3。\r\n     */\r\n    Spherical.prototype.toVector3 = function (vector) {\r\n        vector = vector || new Vector3();\r\n        var _a = this, radius = _a.radius, phi = _a.phi, theta = _a.theta, center = _a.center;\r\n        vector.x = radius * Math.sin(phi) * Math.sin(theta) + center.x;\r\n        vector.y = radius * Math.cos(phi) + center.y;\r\n        vector.z = radius * Math.sin(phi) * Math.cos(theta) + center.z;\r\n        return vector;\r\n    };\r\n    Spherical.EPS = 0.000001;\r\n    return Spherical;\r\n}());\n\nvar Tween = /** @class */ (function (_super) {\r\n    __extends(Tween, _super);\r\n    function Tween() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Tween;\r\n}(Hilo3d$2.Tween));\n\n/**\r\n * 判断一个实例是否为`Level`。\r\n */\r\nfunction isLevel(value) {\r\n    return value.isLevel;\r\n}\r\n/**\r\n * 关卡类，单个关卡的逻辑容器，挂载在`World`下，也是存储`SceneActor`的实际容器，通常使用`getLevel`获取。\r\n * 一般来讲，我们不建议直接使用`Level`中的一些方法，而是使用`World`进行代理，更符合直觉。\r\n * 它的实际游戏逻辑由[LevelScriptActor](../levelscriptactor)描述。\r\n *\r\n * @template IState Level的状态Actor类型，用于存储当前关卡的状态数据。\r\n * @noInheritDoc\r\n */\r\nvar Level = /** @class */ (function (_super) {\r\n    __extends(Level, _super);\r\n    /**\r\n     * 创建Level，不要自己创建！\r\n     *\r\n     * @hidden\r\n     */\r\n    function Level(name, LevelScript, world) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isLevel = true;\r\n        /**\r\n         * 开放世界游戏，end用于无缝自动切换关卡，先占位，待完成\r\n         */\r\n        _this.bound = {\r\n            start: new Vector3(0, 0, 0),\r\n            end: null\r\n        };\r\n        _this._world = null;\r\n        _this._actors = new SArray();\r\n        _this._actorsForUpdate = new SArray();\r\n        _this._actorsNeedUpdate = false;\r\n        _this._script = null;\r\n        _this._updatable = false;\r\n        _this.handleLoading = function (params) {\r\n            try {\r\n                _this._script.onLoading(params);\r\n            }\r\n            catch (error) {\r\n                throwException(error, _this._script);\r\n            }\r\n            _this.game.event.trigger('LevelIsPreloading', { level: _this, state: params });\r\n        };\r\n        _this.handleLoadError = function (_a) {\r\n            var error = _a.error, state = _a.state;\r\n            throwException(error, _this._script, state);\r\n        };\r\n        _this.handleLoadDone = function () {\r\n            _this.game.resource.onLoading.remove(_this.handleLoading);\r\n            _this.game.resource.onError.remove(_this.handleLoadError);\r\n            _this.game.event.trigger('LevelDidPreload', { level: _this });\r\n            try {\r\n                _this._script.onCreate();\r\n            }\r\n            catch (error) {\r\n                throwException(error, _this._script);\r\n            }\r\n            _this._state.updateOnEverTick = true;\r\n            _this._script.updateOnEverTick = true;\r\n            _this.game.event.trigger('LevelDidCreateActors', { level: _this });\r\n        };\r\n        _this._world = world;\r\n        _this._ScriptClass = LevelScript;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Level.prototype, \"state\", {\r\n        /**\r\n         * Level状态Actor实例引用。\r\n         */\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Level.prototype, \"game\", {\r\n        /**\r\n         * 当前`Game`实例引用。一般不直接使用，而是用`actor.getGame()`或`component.getGame`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._world.game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Level.prototype, \"world\", {\r\n        /**\r\n         * 当前`World`实例引用。一般不直接使用，而是用`actor.getWorld()`或`component.getWorld`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._world;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Level.prototype, \"parent\", {\r\n        /**\r\n         * Level的父级World实例引用。\r\n         */\r\n        get: function () {\r\n            return this._world;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Level.prototype, \"actors\", {\r\n        /**\r\n         * 当前所有的actors，建议使用`world.actors`获取。\r\n         */\r\n        get: function () {\r\n            return this._actors;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在Game中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Level.prototype.onError = function (error, details) {\r\n        return this._script.onError(error, details);\r\n    };\r\n    /**\r\n     * 用于继承上个挂卡的actors，**不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Level.prototype.inherit = function (inheritActors) {\r\n        var _this = this;\r\n        this._actors.merge(inheritActors);\r\n        inheritActors.forEach(function (actor) {\r\n            if (isLevel(actor.parent)) {\r\n                actor._parent = _this;\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Level.prototype.init = function (initState) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this._script = this.game.addActor(this.name + \"-level-script\", this._ScriptClass);\r\n                        this._script.updateOnEverTick = false;\r\n                        this._state = this.game.addActor('level-state', this._ScriptClass.LevelStateClass);\r\n                        this._state.copy(initState);\r\n                        this._state.updateOnEverTick = false;\r\n                        this._script._parent = this;\r\n                        this._state.copy(initState);\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this._script.onLogin()];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        error_1 = _a.sent();\r\n                        throwException(error_1, this._script);\r\n                        return [3 /*break*/, 4];\r\n                    case 4:\r\n                        this._updatable = true;\r\n                        this.game.event.trigger('LevelDidInit', { level: this });\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Level.prototype.startLoading = function () {\r\n        this.game.event.trigger('LevelWillPreload', { level: this });\r\n        try {\r\n            this._script.onPreload();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this._script);\r\n        }\r\n        if (this.game.resource.loadDone) {\r\n            this.handleLoadDone();\r\n            return;\r\n        }\r\n        this.game.resource.onLoading.add(this.handleLoading);\r\n        this.game.resource.onError.add(this.handleLoadError);\r\n        this.game.resource.onLoaded.addOnce(this.handleLoadDone);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Level.prototype.update = function (delta) {\r\n        if (!this._updatable) {\r\n            return;\r\n        }\r\n        if (this._actorsNeedUpdate) {\r\n            this._actorsForUpdate.copy(this._actors);\r\n            this._actorsNeedUpdate = false;\r\n        }\r\n        this._actorsForUpdate.forEach(function (actor) { return actor.update(delta); });\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Level.prototype.destroy = function (forceClear) {\r\n        if (forceClear === void 0) { forceClear = false; }\r\n        _super.prototype.destroy.call(this);\r\n        this.game.event.trigger('LevelWillDestroy', { level: this });\r\n        /**\r\n         * 销毁时同时取消所有资源加载逻辑。\r\n         */\r\n        this.game.resource.onLoading.remove(this.handleLoading);\r\n        this.game.resource.onError.remove(this.handleLoadError);\r\n        this.game.resource.onLoaded.remove(this.handleLoadDone);\r\n        /**\r\n         * 取消所有Tween动画。\r\n         */\r\n        Tween.removeAll();\r\n        var inheritActors = new SArray();\r\n        if (!forceClear) {\r\n            this._actorsForUpdate.forEach(function (actor) {\r\n                if (actor.persistent) {\r\n                    inheritActors.add(actor);\r\n                }\r\n                else {\r\n                    actor.destroy();\r\n                }\r\n            });\r\n        }\r\n        else {\r\n            this._actorsForUpdate.forEach(function (actor) {\r\n                actor.destroy();\r\n            });\r\n        }\r\n        // parent is not right, do not use removeFromParent\r\n        this.game.removeActor(this._script);\r\n        this.game.removeActor(this._state);\r\n        return inheritActors;\r\n    };\r\n    /**\r\n     * 通过指定的Actor类`ActorClass`和初始化参数`initOptions`，向Level中添加一个`SceneActor`。\r\n     * 一般使用`world.addActor`进行代理。\r\n     */\r\n    Level.prototype.addActor = function (name, ActorClass, initOptions, parent, parentComponent) {\r\n        var actor = new ActorClass(name, this.game, initOptions);\r\n        if (this.game.devMode) {\r\n            try {\r\n                actor.verifyAdding(initOptions);\r\n            }\r\n            catch (error) {\r\n                throwException(error, actor);\r\n                return;\r\n            }\r\n        }\r\n        actor.initialized();\r\n        this._actors.add(actor);\r\n        if (!parent) {\r\n            actor._parent = this;\r\n        }\r\n        else {\r\n            parent.addChild(actor, parentComponent);\r\n        }\r\n        actor.added();\r\n        this._actorsNeedUpdate = true;\r\n        return actor;\r\n    };\r\n    /**\r\n     * 从Level中移除一个SceneActor。\r\n     * 一般使用`world.removeActor`进行代理。\r\n     */\r\n    Level.prototype.removeActor = function (actor) {\r\n        // debugger;\r\n        actor.destroy();\r\n        actor._parent = null;\r\n        this._actors.remove(actor);\r\n        this._actorsNeedUpdate = true;\r\n        return this;\r\n    };\r\n    Level = __decorate([\r\n        SClass({ className: 'Level', classType: 'Level' })\r\n    ], Level);\r\n    return Level;\r\n}(SObject));\n\nfunction isSceneActor(value) {\r\n    return value.isSceneActor;\r\n}\n\n/**\r\n * @File   : Layers.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 1/28/2019, 7:58:47 PM\r\n * @Description:\r\n */\r\n/**\r\n * 判断一个实例是否为`Layers`。\r\n */\r\nfunction isLayers(value) {\r\n    return value.isLayers;\r\n}\r\n/**\r\n * 图层类。用于在开启`World`的图层功能时，快速切换可视对象。\r\n * 图层是根据一个32通道的mask设定的，你可以通过这个类的一些方法开启或关闭某个或某些通道。\r\n * 图层可以给每个`Actor`设定，其中包含当前主相机的`Actor`负责测试所有实例是否可见。\r\n *\r\n * 实例请见[Layers](../../example/render/layers)。\r\n */\r\nvar Layers = /** @class */ (function () {\r\n    function Layers() {\r\n        this.isLayers = true;\r\n        this._mask = 0xffffffff;\r\n    }\r\n    /**\r\n     * 强制设置为某些通道。\r\n     */\r\n    Layers.prototype.set = function (channel) {\r\n        this._mask = 1 << channel | 0;\r\n    };\r\n    /**\r\n     * 切换某些通道。\r\n     */\r\n    Layers.prototype.toggle = function (channel) {\r\n        this._mask ^= (1 << channel | 0);\r\n    };\r\n    /**\r\n     * 开启某些通道。\r\n     */\r\n    Layers.prototype.enable = function (channel) {\r\n        this._mask |= (1 << channel | 0);\r\n    };\r\n    /**\r\n     * 关闭某些通道。\r\n     */\r\n    Layers.prototype.disable = function (channel) {\r\n        this._mask &= ~(1 << channel | 0);\r\n    };\r\n    /**\r\n     * 通道复位。\r\n     */\r\n    Layers.prototype.reset = function () {\r\n        this._mask = 0xffffffff;\r\n    };\r\n    /**\r\n     * 和另一个图层进行测试。\r\n     */\r\n    Layers.prototype.test = function (layers) {\r\n        return (this._mask & layers._mask) !== 0;\r\n    };\r\n    return Layers;\r\n}());\n\n/**\r\n * @hidden\r\n */\r\nvar tmpVec3 = new Vector3();\r\n/**\r\n * 判断一个实例是否为`SceneComponent`。\r\n */\r\nfunction isSceneComponent(value) {\r\n    return value.isSceneComponent;\r\n}\r\n/**\r\n * 场景Component类，作为`SceneActor`的根组件，即为实际拥有3D变换功能的一类特殊Component。\r\n * 你可以直接使用它，也可以使用继承自它的那些类（比如`PrimitiveComponent`，图元组件，用于承载模型数据）。\r\n * SceneComponent实例可以以树状结构嵌套，但处于性能考虑，原则上一旦生成就不建议再去动态插拔子级实例。\r\n *\r\n * @template IStateTypes 初始化参数类型，必须继承自[ISceneComponentState](../interfaces/iscenecomponentstate)。\r\n * @noInheritDoc\r\n */\r\nvar SceneComponent = /** @class */ (function (_super) {\r\n    __extends(SceneComponent, _super);\r\n    function SceneComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSceneComponent = true;\r\n        /**\r\n         * 是否需要在销毁时释放Gl资源，如果确定以后还会使用相同的材质、几何体等，可以设为`false`，性能优化。\r\n         * 对于GlTF模型实例化的资源默认会设为`false`，而在资源释放时统一释放Gl资源。\r\n         *\r\n         * @default true\r\n         */\r\n        _this.needReleaseGlRes = true;\r\n        /**\r\n         * 图层属性，详见[Layers](../layers)。\r\n         */\r\n        _this.layers = new Layers();\r\n        _this._children = new SArray();\r\n        _this._tmpQuat = new Quaternion();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SceneComponent.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例，根据情况不同可能有不同的类型，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._parent || this._owner;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"children\", {\r\n        /**\r\n         * 获取自身的所有子级SceneComponent，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._children;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"hiloNode\", {\r\n        /**\r\n         * 底层hilo3d的节点，内部随时可能变更实现，**不要自己使用**。\r\n         *\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._node;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"visible\", {\r\n        /**\r\n         * 获取该组件在世界中是否可见。\r\n         */\r\n        get: function () {\r\n            return this._node.visible;\r\n        },\r\n        /**\r\n         * 设置该组件在世界中是否可见。\r\n         */\r\n        set: function (value) {\r\n            this._node.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"isStatic\", {\r\n        /**\r\n         * 获取是否为静态对象，若是，则从此层开始的所有子级实例都不会在每一帧更新`WorldMatrix`。\r\n         * 用于性能优化。\r\n         */\r\n        get: function () {\r\n            return !this._node.autoUpdateWorldMatrix;\r\n        },\r\n        /**\r\n         * 设置是否为静态对象，若是，则从此层开始的所有子级实例都不会在每一帧更新`WorldMatrix`。\r\n         * 用于性能优化。\r\n         */\r\n        set: function (value) {\r\n            this._node.autoUpdateWorldMatrix = !value;\r\n            this._node.autoUpdateChildWorldMatrix = !value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"position\", {\r\n        /**\r\n         * 获取本地空间位置数据。\r\n         */\r\n        get: function () {\r\n            return this._node.position;\r\n        },\r\n        /**\r\n         * 设置本地空间位置数据。\r\n         */\r\n        set: function (position) {\r\n            this._node.position.copy(position);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"rotation\", {\r\n        /**\r\n         * 获取本地空间旋转数据。\r\n         */\r\n        get: function () {\r\n            return this._node.rotation;\r\n        },\r\n        /**\r\n         * 设置本地空间旋转数据。\r\n         */\r\n        set: function (rotation) {\r\n            this._node.rotation.copy(rotation);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"scale\", {\r\n        /**\r\n         * 获取本地空间缩放数据。\r\n         */\r\n        get: function () {\r\n            return this._node.scale;\r\n        },\r\n        /**\r\n         * 设置本地空间缩放数据。\r\n         */\r\n        set: function (scale) {\r\n            this._node.scale.copy(scale);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"pivot\", {\r\n        /**\r\n         * 获取本地空间锚点数据。\r\n         */\r\n        get: function () {\r\n            return this._node.pivot;\r\n        },\r\n        /**\r\n         * 设置本地空间锚点数据。\r\n         */\r\n        set: function (pivot) {\r\n            this._node.pivot.copy(pivot);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"quaternion\", {\r\n        /**\r\n         * 获取本地空间四元数数据。\r\n         */\r\n        get: function () {\r\n            return this._node.quaternion;\r\n        },\r\n        /**\r\n         * 设置本地空间四元数数据。\r\n         */\r\n        set: function (quaternion) {\r\n            this._node.quaternion.copy(quaternion);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"matrix\", {\r\n        /**\r\n         * 获取本地矩阵数据。\r\n         */\r\n        get: function () {\r\n            return this._node.matrix;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"x\", {\r\n        get: function () {\r\n            return this.position.x;\r\n        },\r\n        set: function (value) {\r\n            this.position.x = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"y\", {\r\n        get: function () {\r\n            return this.position.y;\r\n        },\r\n        set: function (value) {\r\n            this.position.y = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"z\", {\r\n        get: function () {\r\n            return this.position.z;\r\n        },\r\n        set: function (value) {\r\n            this.position.z = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"rotationX\", {\r\n        get: function () {\r\n            return this.rotation.x;\r\n        },\r\n        set: function (value) {\r\n            this.rotation.x = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"rotationY\", {\r\n        get: function () {\r\n            return this.rotation.y;\r\n        },\r\n        set: function (value) {\r\n            this.rotation.y = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"rotationZ\", {\r\n        get: function () {\r\n            return this.rotation.z;\r\n        },\r\n        set: function (value) {\r\n            this.rotation.z = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"scaleX\", {\r\n        get: function () {\r\n            return this.scale.x;\r\n        },\r\n        set: function (value) {\r\n            this.scale.x = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"scaleY\", {\r\n        get: function () {\r\n            return this.scale.y;\r\n        },\r\n        set: function (value) {\r\n            this.scale.y = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"scaleZ\", {\r\n        get: function () {\r\n            return this.scale.z;\r\n        },\r\n        set: function (value) {\r\n            this.scale.z = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"pivotX\", {\r\n        get: function () {\r\n            return this.pivot.x;\r\n        },\r\n        set: function (value) {\r\n            this.pivot.x = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"pivotY\", {\r\n        get: function () {\r\n            return this.pivot.y;\r\n        },\r\n        set: function (value) {\r\n            this.pivot.y = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"pivotZ\", {\r\n        get: function () {\r\n            return this.pivot.z;\r\n        },\r\n        set: function (value) {\r\n            this.pivot.z = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"worldMatrix\", {\r\n        /**\r\n         * 直接获取世界矩阵的数据。\r\n         */\r\n        get: function () {\r\n            return this._node.worldMatrix;\r\n        },\r\n        /**\r\n         * 直接设置世界矩阵的数据。\r\n         */\r\n        set: function (matrix) {\r\n            this._node.worldMatrix.copy(matrix);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"absolutePosition\", {\r\n        /**\r\n         * 直接获取组件在世界空间的位置数据。\r\n         */\r\n        get: function () {\r\n            return this._node.worldMatrix.getTranslation();\r\n        },\r\n        /**\r\n         * 直接设置组件在世界空间的位置数据。\r\n         *\r\n         * **注意此设置会涉及矩阵的clone和乘法，有一些性能开销，**\r\n         */\r\n        set: function (value) {\r\n            var parent = this._node.parent;\r\n            if (parent) {\r\n                var invertParentWorldMatrix = parent.worldMatrix.clone();\r\n                invertParentWorldMatrix.invert();\r\n                this.position = value.transformMat4(invertParentWorldMatrix);\r\n            }\r\n            else {\r\n                this.position = value;\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"absoluteRotation\", {\r\n        /**\r\n         * 直接获取组件在世界空间的旋转数据。\r\n         *\r\n         * **注意此值从世界矩阵实时计算而来，有一些性能消耗。**\r\n         */\r\n        get: function () {\r\n            var quat = new Quaternion();\r\n            return this._node.worldMatrix.getRotation(quat);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"absoluteScale\", {\r\n        /**\r\n         * 直接获取组件在世界空间的缩放数据。\r\n         *\r\n         * **注意此值从世界矩阵实时计算而来，有一些性能消耗。**\r\n         */\r\n        get: function () {\r\n            return this._node.worldMatrix.getScaling();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"ndcPosition\", {\r\n        /**\r\n         * 直接获取组件在**当前摄像机**下标准设备空间的位置数据。\r\n         *\r\n         * **注意此值从世界矩阵和视图矩阵实时计算而来，有一些性能消耗。**\r\n         */\r\n        get: function () {\r\n            var mainCamera = this.getWorld().mainCamera;\r\n            if (!mainCamera) {\r\n                return null;\r\n            }\r\n            return this.absolutePosition.transformMat4(mainCamera.viewProjectionMatrix);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"forwardVector\", {\r\n        /**\r\n         * 直接获取组件在本地空间的forward向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, 1).transformQuat(this.quaternion);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"upVector\", {\r\n        /**\r\n         * 直接获取组件在本地空间的up向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 1, 0).transformQuat(this.quaternion);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"rightVector\", {\r\n        /**\r\n         * 直接获取组件在本地空间的right向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(1, 0, 0).transformQuat(this.quaternion);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"worldForwardVector\", {\r\n        /**\r\n         * 直接获取组件在世界空间的forward向量。\r\n         *\r\n         * **注意会先获取`absoluteRotation`，有一定开销！**\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, 1).transformQuat(this.absoluteRotation);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"worldUpVector\", {\r\n        /**\r\n         * 直接获取组件在世界空间的up向量。\r\n         *\r\n         * **注意会先获取`absoluteRotation`，有一定开销！**\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 1, 0).transformQuat(this.absoluteRotation);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"worldRightVector\", {\r\n        /**\r\n         * 直接获取组件在世界空间的right向量。\r\n         *\r\n         * **注意会先获取`absoluteRotation`，有一定开销！**\r\n         */\r\n        get: function () {\r\n            return new Vector3(1, 0, 0).transformQuat(this.absoluteRotation);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneComponent.prototype, \"up\", {\r\n        /**\r\n         * 直接获取组件的UP向量。\r\n         *\r\n         * **注意这是一个可修改的值，如果没有特殊需求以防万一请用`upVector`！**\r\n         */\r\n        get: function () {\r\n            return this._node.up;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 直接获取组件在**指定摄像机**下标准设备空间的位置数据。\r\n     *\r\n     * **注意此值从世界矩阵和视图矩阵实时计算而来，有一些性能消耗。**\r\n     */\r\n    SceneComponent.prototype.getNdcPosition = function (camera) {\r\n        return this.absolutePosition.transformMat4(camera.viewProjectionMatrix);\r\n    };\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    SceneComponent.prototype.onInit = function (initState) {\r\n        this._node = new Hilo3d$2.Node();\r\n        if (!initState) {\r\n            return;\r\n        }\r\n        var initTransform = initState;\r\n        if (initTransform.position) {\r\n            this._node.position.copy(initTransform.position);\r\n            delete initTransform['position'];\r\n        }\r\n        if (initTransform.rotation) {\r\n            this._node.rotation.copy(initTransform.rotation);\r\n            delete initTransform['rotation'];\r\n        }\r\n        if (initTransform.pivot) {\r\n            this._node.pivot.copy(initTransform.pivot);\r\n            delete initTransform['pivot'];\r\n        }\r\n        if (initTransform.quaternion) {\r\n            this._node.quaternion.copy(initTransform.quaternion);\r\n            delete initTransform['quaternion'];\r\n        }\r\n        if (initTransform.matrix) {\r\n            this._node.matrix.copy(initTransform.matrix);\r\n            delete initTransform['matrix'];\r\n        }\r\n        if (initTransform.visible !== undefined) {\r\n            this._node.visible = initTransform.visible;\r\n        }\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    SceneComponent.prototype.onDestroy = function () {\r\n        if (this.needReleaseGlRes) {\r\n            this._node.destroy(this.getGame().renderer, true);\r\n        }\r\n        else {\r\n            this._node.removeFromParent();\r\n        }\r\n    };\r\n    /**\r\n     * 获取组件的的包围盒(AABB)信息。\r\n     * @param bounds 当前计算的包围盒信息，可用于节省开销\r\n     * @param currentMatrix 当前计算的矩阵，可用于节省开销\r\n     */\r\n    SceneComponent.prototype.getBounds = function (bounds, currentMatrix) {\r\n        return this._node.getBounds(null, currentMatrix, bounds);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneComponent.prototype.addChild = function (component) {\r\n        this._children.add(component);\r\n        component._parent = this;\r\n        component._node.addTo(this._node);\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneComponent.prototype.removeChild = function (component) {\r\n        var index = this._children.indexOf(component);\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        component._parent = null;\r\n        this._children.remove(index);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置本地空间位置数据。\r\n     */\r\n    SceneComponent.prototype.setPosition = function (x, y, z) {\r\n        this._node.setPosition(x, y, z);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置本地空间旋转数据。\r\n     */\r\n    SceneComponent.prototype.setRotation = function (x, y, z) {\r\n        this._node.setRotation(x, y, z);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置本地空间位移数据。\r\n     */\r\n    SceneComponent.prototype.setScale = function (x, y, z) {\r\n        this._node.setScale(x, y, z);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置本地空间锚点数据。\r\n     */\r\n    SceneComponent.prototype.setPivot = function (x, y, z) {\r\n        this._node.setPivot(x, y, z);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置本地空间四元数数据。\r\n     */\r\n    SceneComponent.prototype.setQuaternion = function (x, y, z, w) {\r\n        this._node.quaternion.x = x;\r\n        this._node.quaternion.y = y;\r\n        this._node.quaternion.z = z;\r\n        this._node.quaternion.w = w;\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置世界空间位置数据。\r\n     */\r\n    SceneComponent.prototype.setAbsolutePosition = function (x, y, z) {\r\n        this.absolutePosition = new Vector3(x, y, z);\r\n        return this;\r\n    };\r\n    /**\r\n     * 沿着某个轴`axis`平移`distance`距离。\r\n     */\r\n    SceneComponent.prototype.translate = function (axis, distance) {\r\n        tmpVec3.copy(axis).scale(distance);\r\n        this.position.add(tmpVec3);\r\n        // this.absolutePosition = this.absolutePosition.add(tmpVec3);\r\n        return this;\r\n    };\r\n    /**\r\n     * 绕着某个轴`axis`旋转`rad`弧度。\r\n     */\r\n    SceneComponent.prototype.rotate = function (axis, rad) {\r\n        this._tmpQuat.setAxisAngle(axis, rad);\r\n        this.quaternion.multiply(this._tmpQuat);\r\n        return this;\r\n    };\r\n    /**\r\n     * 更新当前实例以及子级组件的世界矩阵。\r\n     */\r\n    SceneComponent.prototype.updateMatrixWorld = function (force) {\r\n        var node = this._node;\r\n        while (node) {\r\n            if (node.parent && node.parent.isStage) {\r\n                node.updateMatrixWorld(force);\r\n                break;\r\n            }\r\n            node = node.parent;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 将自己从父级移除，基本等同于`destroy`方法，从Owner中销毁自身，同时递归移除所有子级组件。\r\n     * 若父级也为`SceneComponent`，则会将自身从父级`children`中移除。\r\n     */\r\n    SceneComponent.prototype.removeFromParent = function () {\r\n        if (!isSceneActor(this._parent)) {\r\n            this._parent.removeChild(this);\r\n        }\r\n        this._owner.removeComponent(this);\r\n        return this;\r\n    };\r\n    /**\r\n     * 修改自身的朝向。\r\n     */\r\n    SceneComponent.prototype.lookAt = function (target) {\r\n        if (isVector3(target)) {\r\n            this._node.lookAt(target);\r\n            return this;\r\n        }\r\n        if (isSceneActor(target)) {\r\n            this._node.lookAt(target.transform.absolutePosition);\r\n            return this;\r\n        }\r\n        this._node.lookAt(target.absolutePosition);\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneComponent.prototype.cloneFromHiloNode = function (node) {\r\n        this._node.gltfExtensions = node.gltfExtensions;\r\n        this._node.jointName = node.jointName;\r\n        this._node.animationId = node.animationId;\r\n        this._node.name = node.name;\r\n    };\r\n    /**\r\n     * 可以自行重写用于添加预渲染策略！\r\n     * 进行一次预渲染，期间会处理材质预编译、资源预提交等。\r\n     */\r\n    SceneComponent.prototype.preRender = function () {\r\n    };\r\n    SceneComponent = __decorate([\r\n        SClass({ className: 'SceneComponent' })\r\n    ], SceneComponent);\r\n    return SceneComponent;\r\n}(Component));\n\n/**\r\n * @File   : Constants.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 10/9/2018, 11:43:07 PM\r\n * @Description:\r\n */\r\n/**\r\n * WebGL相关的静态约束。\r\n */\r\nvar Constants = Hilo3d$2.constants;\n\n/**\r\n * 判断一个实例是否为`Texture`。\r\n */\r\nfunction isTexture(value) {\r\n    return value.isTexture;\r\n}\r\nvar Texture = /** @class */ (function (_super) {\r\n    __extends(Texture, _super);\r\n    function Texture() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Texture;\r\n}(Hilo3d$2.Texture));\n\n/**\r\n * @hidden\r\n */\r\nfunction isIMaterialUniform(value) {\r\n    return value && !value.substr && 'value' in value;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isIMaterialAttribute(value) {\r\n    return value.name !== undefined;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isNumber(value) {\r\n    return !!value.toPrecision;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isNumberArray(value) {\r\n    return !!value.push;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isString(value) {\r\n    return !!value.toLowerCase;\r\n}\r\n/**\r\n * 判断一个实例是否为`RawShaderMaterial`。\r\n */\r\nfunction isRawShaderMaterial(value) {\r\n    return value.isRawShaderMaterial;\r\n}\r\n/**\r\n * 纯净的自定义材质类，允许你创建属于自己的Shader材质。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar RawShaderMaterial = /** @class */ (function (_super) {\r\n    __extends(RawShaderMaterial, _super);\r\n    function RawShaderMaterial(options) {\r\n        var _this = _super.call(this, { useHeaderCache: true }) || this;\r\n        _this.isRawShaderMaterial = true;\r\n        /**\r\n         * 类名。\r\n         */\r\n        _this.className = 'RawShaderMaterial';\r\n        /**\r\n         * 当材质作为模型中的自定义材质时，每次创建一个新模型实例时是否要对材质进行`clone`。\r\n         * 这通常用于可能有多个实例的、具有材质动画的模型。\r\n         */\r\n        _this.cloneForInst = false;\r\n        _this._chuckDefines = [];\r\n        _this._chuckVs = [];\r\n        _this._chuckFs = [];\r\n        _this._uniforms = {};\r\n        /**\r\n         * 获取定制的渲染参数，一般用于宏开关。\r\n         */\r\n        _this.getCustomRenderOption = function (options) {\r\n        };\r\n        _this._initOptions = options;\r\n        if (!options) {\r\n            return _this;\r\n        }\r\n        _this.className = _this.constructor.CLASS_NAME.value;\r\n        options.shaderCacheId = options.id;\r\n        if (!options.id && _this.className !== 'RawShaderMaterial' && _this.className !== 'ShaderMaterial') {\r\n            options.shaderCacheId = _this.className;\r\n        }\r\n        delete options.id;\r\n        _this.init(options);\r\n        return _this;\r\n    }\r\n    RawShaderMaterial_1 = RawShaderMaterial;\r\n    /**\r\n     * 获取特定的Uniform实例引用，可以获取后直接用`value`来设置它。\r\n     */\r\n    RawShaderMaterial.prototype.getUniform = function (key) {\r\n        return this._uniforms[key];\r\n    };\r\n    /**\r\n     * 直接设置某个特定uniform的`value`。\r\n     */\r\n    RawShaderMaterial.prototype.setUniform = function (key, value) {\r\n        var uniform = this._uniforms[key];\r\n        if (!uniform || uniform.value === null || uniform.value === undefined) {\r\n            this.initUniform(key, { value: value });\r\n            return this;\r\n        }\r\n        uniform.value = value;\r\n        return this;\r\n    };\r\n    /**\r\n     * 通过一个回调函数以及其传入的uniform当前值，设置某个特定uniform的`value`。\r\n     */\r\n    RawShaderMaterial.prototype.changeUniform = function (key, handler) {\r\n        var value = handler(this._uniforms[key].value);\r\n        return this.setUniform(key, value);\r\n    };\r\n    RawShaderMaterial.prototype.init = function (options) {\r\n        if (!options.id) {\r\n            delete options.id;\r\n        }\r\n        // default blend mode\r\n        this.blendSrc = Constants.SRC_ALPHA;\r\n        this.blendDst = Constants.ONE_MINUS_SRC_ALPHA;\r\n        this.blendEquationAlpha = Constants.FUNC_ADD;\r\n        Object.assign(this, options);\r\n        this.uniforms = {};\r\n        this.attributes = {};\r\n        this.vs = '';\r\n        this.fs = '';\r\n        this.initChunks(options);\r\n        this.initAttributes(options);\r\n        this.initUniforms(options);\r\n        this.initShaders(options);\r\n    };\r\n    RawShaderMaterial.prototype.initChunks = function (options) {\r\n        options.attributes = options.attributes || {};\r\n        options.uniforms = options.uniforms || {};\r\n        if (options.chunks) {\r\n            var length_1 = options.chunks.length;\r\n            for (var index = 0; index < length_1; index += 1) {\r\n                var chuck = options.chunks[index];\r\n                if (Debug.devMode) {\r\n                    this.checkChuck(chuck, options);\r\n                }\r\n                Object.assign(options.attributes, chuck.attributes);\r\n                Object.assign(options.uniforms, chuck.uniforms);\r\n                if (chuck.vs) {\r\n                    this._chuckVs.push(chuck.vs);\r\n                    if (chuck.isMain && chuck.hasVsOut) {\r\n                        this._mainVsChunkName = chuck.vsEntryName;\r\n                    }\r\n                }\r\n                if (chuck.fs) {\r\n                    this._chuckFs.push(chuck.fs);\r\n                    if (chuck.isMain && chuck.hasFsOut) {\r\n                        this._mainFsChunkName = chuck.fsEntryName;\r\n                    }\r\n                }\r\n                if (chuck.defines) {\r\n                    this._chuckDefines.push(chuck.defines);\r\n                }\r\n            }\r\n        }\r\n        if (options.vs) {\r\n            if (isString(options.vs)) {\r\n                this._chuckVs.push({ main: options.vs, header: '' });\r\n            }\r\n            else {\r\n                this._chuckVs.push(options.vs);\r\n            }\r\n            this._mainVsChunkName = '';\r\n        }\r\n        if (options.fs) {\r\n            if (isString(options.fs)) {\r\n                this._chuckFs.push({ main: options.fs, header: '' });\r\n            }\r\n            else if (options.fs) {\r\n                this._chuckFs.push(options.fs);\r\n            }\r\n            this._mainFsChunkName = '';\r\n        }\r\n        if (options.defines) {\r\n            this._chuckDefines.push(options.defines);\r\n        }\r\n    };\r\n    RawShaderMaterial.prototype.checkChuck = function (chuck, options) {\r\n        var requiredUniforms = chuck.requiredUniforms, requiredAttributes = chuck.requiredAttributes, uniforms = chuck.uniforms, attributes = chuck.attributes;\r\n        // check requiredAttributes\r\n        for (var _i = 0, requiredAttributes_1 = requiredAttributes; _i < requiredAttributes_1.length; _i++) {\r\n            var key = requiredAttributes_1[_i];\r\n            if (!options.attributes[key]) {\r\n                throw new Error(\"Shader chuck \\\"\" + chuck.name + \"\\\" requires attribute \\\"\" + key + \"\\\" !\");\r\n            }\r\n        }\r\n        // check requiredUniforms\r\n        for (var _a = 0, requiredUniforms_1 = requiredUniforms; _a < requiredUniforms_1.length; _a++) {\r\n            var key = requiredUniforms_1[_a];\r\n            if (!options.uniforms[key]) {\r\n                throw new Error(\"Shader chuck \\\"\" + chuck.name + \"\\\" requires uniform \\\"\" + key + \"\\\" !\");\r\n            }\r\n        }\r\n        // check conflict\r\n        for (var key in attributes) {\r\n            if (options.attributes[key]) {\r\n                throw new Error(\"Attribute \\\"\" + key + \"\\\" is already existed, re-defined in shader chuck \\\"\" + chuck.name + \"\\\" !\");\r\n            }\r\n        }\r\n        for (var key in uniforms) {\r\n            if (options.uniforms[key]) {\r\n                throw new Error(\"Uniform \\\"\" + key + \"\\\" is already existed, re-defined in shader chuck \\\"\" + chuck.name + \"\\\" !\");\r\n            }\r\n        }\r\n    };\r\n    RawShaderMaterial.prototype.initAttributes = function (options) {\r\n        var attributes = options.attributes;\r\n        this.attributes = {};\r\n        var _loop_1 = function (key) {\r\n            var attribute = attributes[key];\r\n            if (!isIMaterialAttribute(attribute)) {\r\n                this_1.attributes[key] = attribute;\r\n            }\r\n            else {\r\n                this_1.attributes[key] = {\r\n                    get: function (mesh) { return mesh.geometry[attribute.name]; }\r\n                };\r\n            }\r\n        };\r\n        var this_1 = this;\r\n        for (var key in attributes) {\r\n            _loop_1(key);\r\n        }\r\n    };\r\n    RawShaderMaterial.prototype.initUniforms = function (options) {\r\n        var uniforms = options.uniforms;\r\n        if (!uniforms['u_gammaFactor']) {\r\n            uniforms['u_gammaFactor'] = 'GAMMAFACTOR';\r\n        }\r\n        if (!uniforms['u_exposure']) {\r\n            uniforms['u_exposure'] = 'EXPOSURE';\r\n        }\r\n        for (var key in uniforms) {\r\n            var uniform = uniforms[key];\r\n            if (!isIMaterialUniform(uniform)) {\r\n                this.uniforms[key] = uniform;\r\n                continue;\r\n            }\r\n            this.initUniform(key, uniform);\r\n        }\r\n    };\r\n    RawShaderMaterial.prototype.initUniform = function (key, uniform) {\r\n        var _uniforms = this._uniforms;\r\n        if (uniform.isGlobal) {\r\n            _uniforms[key] = uniform;\r\n        }\r\n        else {\r\n            _uniforms[key] = { value: uniform.value };\r\n        }\r\n        var value = _uniforms[key].value;\r\n        this.isDirty = true;\r\n        if (value === null || value === undefined) {\r\n            this.uniforms[key] = {\r\n                get: function () {\r\n                    return null;\r\n                }\r\n            };\r\n            return;\r\n        }\r\n        if (isTexture(value)) {\r\n            this.uniforms[key] = {\r\n                get: function (_, __, programInfo) {\r\n                    return Hilo3d$2.semantic.handlerTexture(_uniforms[key].value, programInfo.textureIndex);\r\n                }\r\n            };\r\n            return;\r\n        }\r\n        if (isNumber(value) || isNumberArray(value)) {\r\n            this.uniforms[key] = {\r\n                get: function () {\r\n                    return _uniforms[key].value;\r\n                }\r\n            };\r\n            return;\r\n        }\r\n        this.uniforms[key] = {\r\n            get: function () {\r\n                return _uniforms[key].value.elements;\r\n            }\r\n        };\r\n    };\r\n    RawShaderMaterial.prototype.initShaders = function (options) {\r\n        var definesChuck = this._chuckDefines.join('\\n') + '\\n';\r\n        this.vs += definesChuck;\r\n        this.fs += definesChuck;\r\n        this.vs += this.generateShader(this._chuckVs);\r\n        this.fs += this.generateShader(this._chuckFs);\r\n        if (this._mainVsChunkName) {\r\n            this.vs += \"\\nvoid main() {\\ngl_Position = \" + this._mainVsChunkName + \"();\\n}\\n\";\r\n        }\r\n        if (this._mainFsChunkName) {\r\n            this.fs += \"\\nvoid main() {\\ngl_FragColor = \" + this._mainFsChunkName + \"();\\n}\\n\";\r\n        }\r\n        this.initCommonOptions(options);\r\n    };\r\n    /**\r\n     * 不需要自己使用！\r\n     *\r\n     * @hidden\r\n     */\r\n    RawShaderMaterial.prototype.initCommonOptions = function (options, fromLoader) {\r\n        if (fromLoader === void 0) { fromLoader = false; }\r\n        if (options.alphaMode && (!fromLoader || !this._initOptions.alphaMode)) {\r\n            switch (options.alphaMode) {\r\n                case 'BLEND':\r\n                    this.transparent = true;\r\n                    this.blend = true;\r\n                    if (!fromLoader) {\r\n                        this.blendSrc = options.blendSrc || Constants.SRC_ALPHA;\r\n                        this.blendDst = options.blendDst || Constants.ONE_MINUS_SRC_ALPHA;\r\n                        this.blendEquationAlpha = options.blendEquationAlpha || Constants.FUNC_ADD;\r\n                    }\r\n                    break;\r\n                case 'MASK':\r\n                    if ('alphaCutoff' in options) {\r\n                        this.alphaCutoff = options.alphaCutoff;\r\n                    }\r\n                    else {\r\n                        this.alphaCutoff = 0.5;\r\n                    }\r\n                    break;\r\n                case 'OPAQUE':\r\n                default:\r\n                    this.ignoreTranparent = true;\r\n                    break;\r\n            }\r\n            this._initOptions.alphaMode = options.alphaMode;\r\n        }\r\n        if ((options.doubleSided && !fromLoader) || (options.doubleSided && !this._initOptions.doubleSided)) {\r\n            this.side = Constants.FRONT_AND_BACK;\r\n            this._initOptions.doubleSided = true;\r\n        }\r\n        this.lightType = options.unlit ? 'NONE' : 'ENABLE';\r\n    };\r\n    RawShaderMaterial.prototype.generateShader = function (chucks) {\r\n        var headerCode = '';\r\n        var mainCode = '';\r\n        var length = chucks.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            var _a = chucks[index], header = _a.header, main = _a.main;\r\n            headerCode += header + '\\n';\r\n            mainCode += main + '\\n';\r\n        }\r\n        return headerCode + '\\n' + mainCode + '\\n';\r\n    };\r\n    /**\r\n     * clone一个材质，一般不会重新编译program，但会生成一份新的`uniforms`。\r\n     */\r\n    RawShaderMaterial.prototype.clone = function () {\r\n        var material = new this.constructor(this._initOptions);\r\n        material.initCommonOptions(this._initOptions);\r\n        return material;\r\n    };\r\n    RawShaderMaterial.prototype.destroyTextures = function () {\r\n        _super.prototype.destroyTextures.call(this);\r\n        for (var propName in this._uniforms) {\r\n            var texture = this._uniforms[propName].value;\r\n            if (texture && isTexture(texture)) {\r\n                texture.destroy();\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    var RawShaderMaterial_1;\r\n    /**\r\n     * 类名。\r\n     */\r\n    RawShaderMaterial.CLASS_NAME = new SName('RawShaderMaterial');\r\n    RawShaderMaterial = RawShaderMaterial_1 = __decorate([\r\n        SMaterial({ className: 'RawShaderMaterial' })\r\n    ], RawShaderMaterial);\r\n    return RawShaderMaterial;\r\n}(Hilo3d$2.ShaderMaterial));\n\nvar Shader = /** @class */ (function (_super) {\r\n    __extends(Shader, _super);\r\n    function Shader() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Shader;\r\n}(Hilo3d$2.Shader));\n\n/**\r\n * 判断一个对象是否为`SkyboxMaterial`。\r\n */\r\nfunction isSkyboxMaterial(value) {\r\n    return value.isSkyboxMaterial;\r\n}\r\n/**\r\n * 默认的天空盒纹理，支持纯色、立方体纹理、全景纹理模式。\r\n */\r\nvar SkyboxMaterial = /** @class */ (function (_super) {\r\n    __extends(SkyboxMaterial, _super);\r\n    function SkyboxMaterial(options) {\r\n        var _this = _super.call(this, {\r\n            depthMask: true,\r\n            // 渲染非透明物体的队列中，最后渲染天空盒来保证良好的性能\r\n            renderOrder: 9999,\r\n            side: Constants.BACK,\r\n            attributes: {\r\n                a_position: 'POSITION',\r\n                a_uv: 'TEXCOORD_0'\r\n            },\r\n            uniforms: {\r\n                u_viewProjectionMatrix: { value: new Matrix4() },\r\n                u_texture: options.uniforms.u_texture,\r\n                u_color: options.uniforms.u_color,\r\n                u_rotation: options.uniforms.u_rotation,\r\n                u_factor: options.uniforms.u_factor || { value: 1 },\r\n                u_exposure: options.uniforms.u_exposure,\r\n                u_degrees: options.uniforms.u_degrees\r\n            },\r\n            vs: \"\\nprecision highp float;\\n\\nattribute vec3 a_position;\\nattribute vec2 a_uv;\\n\\nuniform mat4 u_viewProjectionMatrix;\\n\\nvarying vec2 v_uv;\\n\\n#ifdef SKYBOX_CUBE\\nvarying vec3 v_position;\\n#endif\\n\\nvoid main()\\n{\\n#ifdef SKYBOX_CUBE\\nv_position = a_position.xyz;\\n#endif\\nvec4 pos = u_viewProjectionMatrix * vec4(a_position, 1.0);\\ngl_Position = pos.xyww;\\nv_uv = a_uv;\\n}\\n\",\r\n            fs: \"\\nprecision mediump float;\\n\\nuniform float u_factor;\\nuniform vec4 u_color;\\n\\n\" + Shader.shaders['chunk/color.frag'] + \"\\n\" + Shader.shaders['method/encoding.glsl'] + \"\\n\\n#ifdef SKYBOX_CUBE\\nuniform samplerCube u_texture;\\nuniform float u_exposure;\\nvarying vec3 v_position;\\n#endif\\n\\n#ifdef SKYBOX_PANORAMIC\\nuniform sampler2D u_texture;\\nuniform float u_exposure;\\n#endif\\n\\nvarying vec2 v_uv;\\n\\nvec3 decodeRGBD(vec4 color) {\\nreturn color.rgb / color.a;\\n}\\n\\nvoid main()\\n{\\nvec4 color = vec4(1., 1., 1., 1.);\\n\\n#ifdef SKYBOX_CUBE\\nvec3 tex = decodeRGBD(textureCube(u_texture, v_position));\\n#endif\\n\\n#ifdef SKYBOX_PANORAMIC\\nvec3 tex = decodeRGBD(texture2D(u_texture, v_uv));\\n#endif\\n\\n#ifdef HILO_GAMMA_CORRECTION\\ntex = sRGBToLinear(tex);\\n#endif\\ncolor.rgb = tex * u_color.rgb * u_exposure * u_factor;\\n\\n\" + Shader.shaders['chunk/frag_color.frag'] + \"\\n}     \\n\"\r\n        }) || this;\r\n        _this.isSkyboxMaterial = true;\r\n        _this.type = 'Color';\r\n        _this.getCustomRenderOption = function (options) {\r\n            if (_this.type === 'Cube') {\r\n                options.SKYBOX_CUBE = 1;\r\n            }\r\n            else if (_this.type === 'Panoramic') {\r\n                options.SKYBOX_PANORAMIC = 1;\r\n            }\r\n            else {\r\n                options.SKYBOX_COLOR = 1;\r\n            }\r\n            return options;\r\n        };\r\n        _this.type = options.type;\r\n        return _this;\r\n    }\r\n    SkyboxMaterial = __decorate([\r\n        SMaterial({ className: 'SkyboxMaterial' })\r\n    ], SkyboxMaterial);\r\n    return SkyboxMaterial;\r\n}(RawShaderMaterial));\n\n/**\r\n * 判断一个实例是否为`Mesh`。\r\n */\r\nfunction isMesh(value) {\r\n    return value.isMesh;\r\n}\r\n/**\r\n * 曲面类。封装几何体`Geometry`和材质`Material`。\r\n */\r\nvar Mesh = /** @class */ (function (_super) {\r\n    __extends(Mesh, _super);\r\n    function Mesh() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    /**\r\n     * 获取指定类型的材质。\r\n     */\r\n    Mesh.prototype.getMaterial = function () {\r\n        return this.material;\r\n    };\r\n    /**\r\n     * 克隆。\r\n     */\r\n    Mesh.prototype.clone = function (isChild) {\r\n        return _super.prototype.clone.call(this, isChild);\r\n    };\r\n    return Mesh;\r\n}(Hilo3d$2.Mesh));\n\n/**\r\n * 判断一个实例是否为`BoxGeometry`。\r\n */\r\nfunction isBoxGeometry(value) {\r\n    return value.isBoxGeometry;\r\n}\r\nvar BoxGeometry = /** @class */ (function (_super) {\r\n    __extends(BoxGeometry, _super);\r\n    function BoxGeometry() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return BoxGeometry;\r\n}(Hilo3d$2.BoxGeometry));\n\n/**\r\n * 判断一个实例是否为`SphereGeometry`。\r\n */\r\nfunction isSphereGeometry(value) {\r\n    return value.isSphereGeometry;\r\n}\r\nvar SphereGeometry = /** @class */ (function (_super) {\r\n    __extends(SphereGeometry, _super);\r\n    function SphereGeometry() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return SphereGeometry;\r\n}(Hilo3d$2.SphereGeometry));\n\n/**\r\n * 判断一个实例是否为`BreakGuardException`。\r\n */\r\nfunction isBreakGuardException(value) {\r\n    return value.isBreakGuardException;\r\n}\r\n/**\r\n * 破坏守护机制的异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BreakGuardException = /** @class */ (function (_super) {\r\n    __extends(BreakGuardException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function BreakGuardException(object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'BreakGuard', object, message) || this;\r\n        _this.isBreakGuardException = true;\r\n        return _this;\r\n    }\r\n    return BreakGuardException;\r\n}(BaseException));\n\n/**\r\n * 判断一个实例是否为`CameraComponent`。\r\n */\r\nfunction isCameraComponent(value) {\r\n    return value.isCameraComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`CameraActor`。\r\n */\r\nfunction isCameraActor(value) {\r\n    return isSceneActor(value) && isCameraComponent(value.root);\r\n}\r\n/**\r\n * 摄像机Component基类，承担着场景摄像机的实际功能。\r\n * 一般不直接使用，而是使用各个派生类。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CameraComponent = /** @class */ (function (_super) {\r\n    __extends(CameraComponent, _super);\r\n    function CameraComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isCameraComponent = true;\r\n        _this._isMainCamera = false;\r\n        _this._rendererAlive = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(CameraComponent.prototype, \"isMainCamera\", {\r\n        /**\r\n         * 是否为当前World的主摄像机。\r\n         */\r\n        get: function () {\r\n            return this._isMainCamera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CameraComponent.prototype, \"viewMatrix\", {\r\n        /**\r\n         * 视图矩阵。\r\n         */\r\n        get: function () {\r\n            return this._camera.viewMatrix;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CameraComponent.prototype, \"projectionMatrix\", {\r\n        /**\r\n         * 投影矩阵。\r\n         */\r\n        get: function () {\r\n            return this._camera.projectionMatrix;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CameraComponent.prototype, \"viewProjectionMatrix\", {\r\n        /**\r\n         * 视图投影矩阵。\r\n         */\r\n        get: function () {\r\n            return this._camera.viewProjectionMatrix;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CameraComponent.prototype, \"rendererAlive\", {\r\n        /**\r\n         * 渲染器是否在正常活动。\r\n         */\r\n        get: function () {\r\n            return this._rendererAlive;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 修改天空盒材质。\r\n     */\r\n    CameraComponent.prototype.changeBackgroundMat = function (action) {\r\n        var preType = this._backgroundMat.type;\r\n        action(this._backgroundMat);\r\n        if (preType !== this._backgroundMat.type) {\r\n            this.generateSkybox(this._backgroundMat);\r\n            if (this._isMainCamera) {\r\n                this.disableSkybox();\r\n                this.enableSkybox();\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    CameraComponent.prototype.onInit = function (initState) {\r\n        _super.prototype.onInit.call(this, initState);\r\n        this._camera = this.onCreateCamera(initState);\r\n        this._camera.__forceUseParentWorldMatrix = true;\r\n        this._node.addChild(this._camera);\r\n        this._node._rotation.order = 'XYZ';\r\n        this._node.isCamera = true;\r\n        this.generateSkybox(initState.backgroundMat);\r\n    };\r\n    CameraComponent.prototype.generateSkybox = function (mat) {\r\n        if (!mat) {\r\n            mat = new SkyboxMaterial({ type: 'Color', uniforms: {\r\n                    u_color: { value: this.getGame().renderer.clearColor }\r\n                } });\r\n        }\r\n        if (mat.type === 'Color') {\r\n            this.getGame().renderer.clearColor.copy(mat.getUniform('u_color').value);\r\n            return;\r\n        }\r\n        this._backgroundMat = mat;\r\n        if (mat.type === 'Panoramic') {\r\n            this._background = new Mesh({\r\n                geometry: new SphereGeometry({ radius: 1 }),\r\n                material: this._backgroundMat\r\n            });\r\n        }\r\n        else {\r\n            this._background = new Mesh({\r\n                geometry: new BoxGeometry({ width: 2, height: 2, depth: 2 }),\r\n                material: this._backgroundMat\r\n            });\r\n        }\r\n    };\r\n    CameraComponent.prototype.onCreateCamera = function (initState) {\r\n        return null;\r\n    };\r\n    /**\r\n     * 特殊生命周期，当摄像机被作为World的主摄像机时被触发。\r\n     */\r\n    CameraComponent.prototype.onAsMainCamera = function (isMain) {\r\n        var game = this.getGame();\r\n        if (isMain) {\r\n            this.enableSkybox();\r\n            game.hiloStage.camera = this._camera;\r\n            this._isMainCamera = true;\r\n        }\r\n        else if (this._isMainCamera) {\r\n            this.disableSkybox();\r\n            game.hiloStage.camera = null;\r\n            this._isMainCamera = false;\r\n        }\r\n    };\r\n    CameraComponent.prototype.enableSkybox = function () {\r\n        if (this._background) {\r\n            this.getGame().hiloStage.addChild(this._background);\r\n        }\r\n    };\r\n    CameraComponent.prototype.disableSkybox = function () {\r\n        if (this._background) {\r\n            this.getGame().hiloStage.removeChild(this._background);\r\n        }\r\n    };\r\n    /**\r\n     * 加入World，继承请先`super.onAdd()`。\r\n     */\r\n    CameraComponent.prototype.onAdd = function () {\r\n        if (!this.getWorld().mainCamera) {\r\n            this.getWorld().setMainCamera(this);\r\n        }\r\n    };\r\n    /**\r\n     * 每一帧更新，继承请先`super.onUpdate()`。\r\n     */\r\n    CameraComponent.prototype.onUpdate = function () {\r\n        var _this = this;\r\n        this._rendererAlive = false;\r\n        if (this._isMainCamera && this._background) {\r\n            this._backgroundMat.changeUniform('u_viewProjectionMatrix', function (mat) {\r\n                mat.copy(_this.viewMatrix);\r\n                var rotation = _this._backgroundMat.getUniform('u_rotation');\r\n                if (rotation && rotation.value !== 0) {\r\n                    mat.rotateY(-rotation.value);\r\n                }\r\n                mat.elements[12] = 0;\r\n                mat.elements[13] = 0;\r\n                mat.elements[14] = 0;\r\n                mat.premultiply(_this.projectionMatrix);\r\n                return mat;\r\n            });\r\n        }\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    CameraComponent.prototype.onDestroy = function () {\r\n        this.onAsMainCamera(false);\r\n        if (this.getWorld().mainCamera === this) {\r\n            this.getWorld().removeMainCamera();\r\n        }\r\n        _super.prototype.onDestroy.call(this);\r\n    };\r\n    /**\r\n     * 计算向量`vector`从世界空间被该相机投影到二维画布上的位置。\r\n     * 若不传容器的`width`和`height`，则返回`0 ~ 1`的值。\r\n     */\r\n    CameraComponent.prototype.projectVector = function (vector, width, height) {\r\n        return this._camera.projectVector(vector, width, height);\r\n    };\r\n    /**\r\n     * 计算向量`vector`从屏幕空间反变换到世界空间后的位置。\r\n     * 若不传容器的`width`和`height`，则认为`vector`是NDC的坐标。\r\n     */\r\n    CameraComponent.prototype.unprojectVector = function (vector, width, height) {\r\n        return this._camera.unprojectVector(vector, width, height);\r\n    };\r\n    /**\r\n     * 更新视图投影矩阵\r\n     */\r\n    CameraComponent.prototype.updateViewProjectionMatrix = function () {\r\n        this._camera.updateProjectionMatrix();\r\n    };\r\n    /**\r\n     * 根据容器上的一个点`(x, y)`以及容器的宽度`width`和高度`height`，还有射线长度`rayLength`生成世界空间的一条射线。\r\n     * 射线起点和终点将会被存储到传入的`outFrom`和`outTo`中。\r\n     */\r\n    CameraComponent.prototype.generateRay = function (x, y, width, height, outFrom, outTo, rayLength) {\r\n        throw new Error('Not implements');\r\n    };\r\n    /**\r\n     * 截取当前画布并返回Blob或Base64。\r\n     * 但注意其开销！其会**立即再渲染一遍当前场景**！\r\n     *\r\n     * @param mimetype 编码类型，例如image/jpeg\r\n     * @param encoderOptions 编码参数，0 ~ 1。\r\n     */\r\n    CameraComponent.prototype.captureScreen = function (mode, mimetype, encoderOptions) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var canvas;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (!this._isMainCamera) {\r\n                    throw new BreakGuardException(this, '`captureScreen` can not be called by `mainCamera` now !');\r\n                }\r\n                canvas = this.getGame().canvas;\r\n                return [2 /*return*/, new Promise(function (resolve, reject) {\r\n                        _this.render();\r\n                        try {\r\n                            if (mode === 'blob') {\r\n                                canvas.toBlob(function (blob) { return resolve(blob); }, mimetype, encoderOptions);\r\n                            }\r\n                            else {\r\n                                resolve(canvas.toDataURL(mimetype, encoderOptions));\r\n                            }\r\n                        }\r\n                        catch (error) {\r\n                            reject(error);\r\n                        }\r\n                    })];\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 渲染当前摄像机对应的画面。如果没有特殊需求（比如后处理、镜面等）不需要自己调用。\r\n     *\r\n     * @param frameBuffer 如果指定，则将会渲染到这个FrameBuffer，不会输出到屏幕上。\r\n     * @param fireEvent 开发者无需关心，**不要自己使用！**。\r\n     */\r\n    CameraComponent.prototype.render = function (frameBuffer, fireEvent) {\r\n        var _this = this;\r\n        if (fireEvent === void 0) { fireEvent = false; }\r\n        var game = this.getGame();\r\n        var world = this.getWorld();\r\n        var renderer = game.renderer;\r\n        if (this._isMainCamera && fireEvent) {\r\n            game.event.trigger('MainRendererWillStart');\r\n        }\r\n        if (!this._isMainCamera) {\r\n            game.hiloStage.camera = this._camera;\r\n        }\r\n        if (world.enableLayers) {\r\n            world.actors.forEach(function (actor) {\r\n                actor.visible = _this.layers.test(actor.layers);\r\n            });\r\n        }\r\n        try {\r\n            if (frameBuffer) {\r\n                frameBuffer.bind();\r\n                renderer.render(game.hiloStage, this._camera, false);\r\n                frameBuffer.unbind();\r\n            }\r\n            else {\r\n                renderer.render(game.hiloStage, this._camera, fireEvent);\r\n            }\r\n            this._rendererAlive = true;\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n            this._rendererAlive = false;\r\n        }\r\n        if (!this._isMainCamera) {\r\n            game.hiloStage.camera = world.mainCamera._camera;\r\n        }\r\n        if (this._isMainCamera && fireEvent) {\r\n            game.event.trigger('MainRendererIsFinished');\r\n        }\r\n    };\r\n    CameraComponent = __decorate([\r\n        SClass({ className: 'CameraComponent' })\r\n    ], CameraComponent);\r\n    return CameraComponent;\r\n}(SceneComponent));\n\n/**\r\n * 判断一个实例是否为`UnmetRequireException`。\r\n */\r\nfunction isUnmetRequireException(value) {\r\n    return value.isUnmetRequireException;\r\n}\r\n/**\r\n * 前置功能缺失异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar UnmetRequireException = /** @class */ (function (_super) {\r\n    __extends(UnmetRequireException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function UnmetRequireException(object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'UnmetRequire', object, message) || this;\r\n        _this.isUnmetRequireException = true;\r\n        return _this;\r\n    }\r\n    return UnmetRequireException;\r\n}(BaseException));\n\n/**\r\n * 判断一个实例是否为`PerspectiveCameraComponent`。\r\n */\r\nfunction isPerspectiveCameraComponent(value) {\r\n    return value.isPerspectiveCameraComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`PerspectiveCameraActor`。\r\n */\r\nfunction isPerspectiveCameraActor(value) {\r\n    return isSceneActor(value) && isPerspectiveCameraComponent(value.root);\r\n}\r\n/**\r\n * 透视摄像机组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PerspectiveCameraComponent = /** @class */ (function (_super) {\r\n    __extends(PerspectiveCameraComponent, _super);\r\n    function PerspectiveCameraComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPerspectiveCameraComponent = true;\r\n        return _this;\r\n    }\r\n    PerspectiveCameraComponent.prototype.onCreateCamera = function (initState) {\r\n        return new Hilo3d$2.PerspectiveCamera(initState);\r\n    };\r\n    Object.defineProperty(PerspectiveCameraComponent.prototype, \"near\", {\r\n        /**\r\n         * 摄像机近裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.near;\r\n        },\r\n        /**\r\n         * 摄像机近裁剪面。\r\n         */\r\n        set: function (near) {\r\n            this._camera.near = near;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PerspectiveCameraComponent.prototype, \"far\", {\r\n        /**\r\n         * 摄像机远裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.far;\r\n        },\r\n        /**\r\n         * 摄像机远裁剪面。\r\n         */\r\n        set: function (far) {\r\n            this._camera.far = far;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PerspectiveCameraComponent.prototype, \"fov\", {\r\n        /**\r\n         * 摄像机俯仰角。\r\n         */\r\n        get: function () {\r\n            return this._camera.fov;\r\n        },\r\n        /**\r\n         * 摄像机俯仰角。\r\n         */\r\n        set: function (fov) {\r\n            this._camera.fov = fov;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PerspectiveCameraComponent.prototype, \"aspect\", {\r\n        /**\r\n         * 摄像机视场纵横比。\r\n         */\r\n        get: function () {\r\n            return this._camera.aspect;\r\n        },\r\n        /**\r\n         * 摄像机视场纵横比。\r\n         */\r\n        set: function (aspect) {\r\n            this._camera.aspect = aspect;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 根据容器上的一个点`(x, y)`以及容器的宽度`width`和高度`height`，还有射线长度`rayLength`生成世界空间的一条射线。\r\n     * 射线起点和终点将会被存储到传入的`outFrom`和`outTo`中。\r\n     */\r\n    PerspectiveCameraComponent.prototype.generateRay = function (x, y, width, height, outFrom, outTo, rayLength) {\r\n        if (rayLength === void 0) { rayLength = 100; }\r\n        this._node.worldMatrix.getTranslation(outFrom);\r\n        outTo.set(x, y, 1);\r\n        outTo.copy(this._camera.unprojectVector(outTo, width, height).subtract(outFrom)).normalize().scale(rayLength).add(outFrom);\r\n        return this;\r\n    };\r\n    PerspectiveCameraComponent = __decorate([\r\n        SClass({ className: 'PerspectiveCameraComponent' })\r\n    ], PerspectiveCameraComponent);\r\n    return PerspectiveCameraComponent;\r\n}(CameraComponent));\n\n/**\r\n * 判断一个实例是否为`OrthographicCameraComponent`。\r\n */\r\nfunction isOrthographicCameraComponent(value) {\r\n    return value.isOrthographicCameraComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`OrthographicCameraActor`。\r\n */\r\nfunction isOrthographicCameraActor(value) {\r\n    return isSceneActor(value) && isOrthographicCameraComponent(value.root);\r\n}\r\n/**\r\n * 正交摄像机组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar OrthographicCameraComponent = /** @class */ (function (_super) {\r\n    __extends(OrthographicCameraComponent, _super);\r\n    function OrthographicCameraComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isOrthographicCameraComponent = true;\r\n        return _this;\r\n    }\r\n    OrthographicCameraComponent.prototype.onCreateCamera = function (initState) {\r\n        return new Hilo3d$2.OrthographicCamera(initState);\r\n    };\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"near\", {\r\n        /**\r\n         * 摄像机近裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.near;\r\n        },\r\n        /**\r\n         * 摄像机近裁剪面。\r\n         */\r\n        set: function (near) {\r\n            this._camera.near = near;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"far\", {\r\n        /**\r\n         * 摄像机远裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.far;\r\n        },\r\n        /**\r\n         * 摄像机远裁剪面。\r\n         */\r\n        set: function (far) {\r\n            this._camera.far = far;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"left\", {\r\n        /**\r\n         * 摄像机左裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.left;\r\n        },\r\n        /**\r\n         * 摄像机左裁剪面。\r\n         */\r\n        set: function (left) {\r\n            this._camera.left = left;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"right\", {\r\n        /**\r\n         * 摄像机右裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.right;\r\n        },\r\n        /**\r\n         * 摄像机右裁剪面。\r\n         */\r\n        set: function (right) {\r\n            this._camera.right = right;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"top\", {\r\n        /**\r\n         * 摄像机上裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.top;\r\n        },\r\n        /**\r\n         * 摄像机上裁剪面。\r\n         */\r\n        set: function (top) {\r\n            this._camera.top = top;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(OrthographicCameraComponent.prototype, \"bottom\", {\r\n        /**\r\n         * 摄像机下裁剪面。\r\n         */\r\n        get: function () {\r\n            return this._camera.bottom;\r\n        },\r\n        /**\r\n         * 摄像机下裁剪面。\r\n         */\r\n        set: function (bottom) {\r\n            this._camera.bottom = bottom;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 根据容器上的一个点`(x, y)`以及容器的宽度`width`和高度`height`，还有射线长度`rayLength`生成世界空间的一条射线。\r\n     * 射线起点和终点将会被存储到传入的`outFrom`和`outTo`中。\r\n     */\r\n    OrthographicCameraComponent.prototype.generateRay = function (x, y, width, height, outFrom, outTo, rayLength) {\r\n        if (rayLength === void 0) { rayLength = 100; }\r\n        var camera = this._camera;\r\n        outFrom.set(x, y, (camera.near + camera.far) / (camera.near - camera.far));\r\n        outFrom.copy(this._camera.unprojectVector(outFrom, width, height));\r\n        var forwardVector = this.forwardVector;\r\n        outTo.copy(outFrom).add(forwardVector.scale(-rayLength));\r\n        return this;\r\n    };\r\n    OrthographicCameraComponent = __decorate([\r\n        SClass({ className: 'OrthographicCameraComponent' })\r\n    ], OrthographicCameraComponent);\r\n    return OrthographicCameraComponent;\r\n}(CameraComponent));\n\n/**\r\n * 判断一个实例是否为`World`。\r\n */\r\nfunction isWorld(value) {\r\n    return value.isWorld;\r\n}\r\n/**\r\n * 世界类，单个世界的逻辑容器，挂载在`Game`下，通常使用`getWorld`获取。\r\n * 一般来讲，我们不建议直接使用`Level`中的一些方法，而是使用`World`进行代理，更符合直觉。\r\n * 它的实际游戏逻辑由[GameModeActor](../gamemodeactor)描述。\r\n *\r\n * @template IState World的状态Actor类型，用于存储当前世界的状态数据。\r\n * @noInheritDoc\r\n */\r\nvar World = /** @class */ (function (_super) {\r\n    __extends(World, _super);\r\n    /**\r\n     * 创建World，不要自己创建！\r\n     *\r\n     * @hidden\r\n     */\r\n    function World(name, GameMode, levels, game) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isWorld = true;\r\n        /**\r\n         * 开启图层功能，若开启，可以通过给每个`Actor`指定`layers`，之后通过摄像机的`layers`来控制显示内容。\r\n         * 详见示例**[Layers](../../example/renderer/layers)**。\r\n         */\r\n        _this.enableLayers = false;\r\n        _this._game = null;\r\n        _this._script = null;\r\n        _this._level = null;\r\n        _this._levels = {};\r\n        _this._mainCamera = null;\r\n        // use for splitting screen mode, waiting.....\r\n        _this._mainCameras = [];\r\n        _this._physicWorld = null;\r\n        _this._updatable = false;\r\n        _this._game = game;\r\n        _this._levels = levels;\r\n        _this._GameModeClass = GameMode;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(World, \"UP\", {\r\n        /**\r\n         * 世界的up单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 1, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World, \"DOWN\", {\r\n        /**\r\n         * 世界的down单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, -1, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World, \"RIGHT\", {\r\n        /**\r\n         * 世界的right单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(1, 0, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World, \"LEFT\", {\r\n        /**\r\n         * 世界的left单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(-1, 0, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World, \"FORWARD\", {\r\n        /**\r\n         * 世界的forward单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, -1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World, \"BACK\", {\r\n        /**\r\n         * 世界的back单位向量。\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, 1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"state\", {\r\n        /**\r\n         * World状态Actor实例引用。\r\n         */\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"game\", {\r\n        /**\r\n         * 当前`Game`实例引用。一般不直接使用，而是用`actor.getGame()`或`component.getGame`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"level\", {\r\n        /**\r\n         * 当前`Level`实例引用。一般不直接使用，而是用`actor.getLevel()`或`component.getLevel`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._level;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"parent\", {\r\n        /**\r\n         * Wolrd的父级Game实例引用。\r\n         */\r\n        get: function () {\r\n            return this._game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"actors\", {\r\n        /**\r\n         * 当前Level所有的actors，建议从这里获取。\r\n         */\r\n        get: function () {\r\n            return this._level.actors;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"mainCamera\", {\r\n        /**\r\n         * 当前的摄像机组件实例引用。\r\n         */\r\n        get: function () {\r\n            return this._mainCamera;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"physicWorld\", {\r\n        /**\r\n         * 当前的物理世界实例引用，需要使用[enablePhysic](#enablephysic)开启后获取。\r\n         */\r\n        get: function () {\r\n            return this._physicWorld;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"upVector\", {\r\n        /**\r\n         * 当前世界的up单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 1, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"downVector\", {\r\n        /**\r\n         * 当前世界的down单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, -1, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"rightVector\", {\r\n        /**\r\n         * 当前世界的right单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(1, 0, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"leftVector\", {\r\n        /**\r\n         * 当前世界的left单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(-1, 0, 0);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"forwardVector\", {\r\n        /**\r\n         * 当前世界的forward单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, -1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(World.prototype, \"backVector\", {\r\n        /**\r\n         * 当前世界的back单位向量。\r\n         *\r\n         * @deprecated\r\n         */\r\n        get: function () {\r\n            return new Vector3(0, 0, 1);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在Game中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    World.prototype.onError = function (error, details) {\r\n        return this._script.onError(error, details);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    World.prototype.init = function (initState) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        this._script = this._game.addActor(this.name + \"-game-mode\", this._GameModeClass);\r\n                        this._script.updateOnEverTick = false;\r\n                        this._state = this._game.addActor('world-state', this._GameModeClass.WorldStateClass);\r\n                        this._state.copy(initState);\r\n                        this._state.updateOnEverTick = false;\r\n                        this._script._parent = this;\r\n                        this._state.copy(initState);\r\n                        this._game.event.trigger('WorldDidInit', { world: this });\r\n                        _a.label = 1;\r\n                    case 1:\r\n                        _a.trys.push([1, 3, , 4]);\r\n                        return [4 /*yield*/, this._script.onLogin()];\r\n                    case 2:\r\n                        _a.sent();\r\n                        return [3 /*break*/, 4];\r\n                    case 3:\r\n                        error_1 = _a.sent();\r\n                        throwException(error_1, this._script);\r\n                        return [3 /*break*/, 4];\r\n                    case 4:\r\n                        try {\r\n                            this._script.onCreatePlayers();\r\n                        }\r\n                        catch (error) {\r\n                            throwException(error, this._script);\r\n                        }\r\n                        this._game.event.trigger('WorldDidCreatePlayers', { world: this });\r\n                        if (this._game.players.length < 1) {\r\n                            throw new UnmetRequireException(this, 'You must give at least one player !');\r\n                        }\r\n                        this._script.updateOnEverTick = true;\r\n                        this._state.updateOnEverTick = true;\r\n                        this._updatable = true;\r\n                        return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    World.prototype.update = function (delta) {\r\n        if (!this._updatable) {\r\n            return;\r\n        }\r\n        if (this._level) {\r\n            this._level.update(delta);\r\n        }\r\n        if (!this.mainCamera) {\r\n            return;\r\n        }\r\n        this.mainCamera.render(null, true);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    World.prototype.destroy = function (forceClear) {\r\n        if (forceClear === void 0) { forceClear = true; }\r\n        _super.prototype.destroy.call(this);\r\n        this._game.event.trigger('WorldWillDestroy', { world: this });\r\n        try {\r\n            this._script.onDestroyPlayers();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this._script);\r\n        }\r\n        var inheritActors = this._level.destroy(forceClear);\r\n        // parent is not right, do not use removeFromParent\r\n        this.game.removeActor(this._script);\r\n        this.game.removeActor(this._state);\r\n        if (this._physicWorld) {\r\n            this._physicWorld.destroy();\r\n        }\r\n        this._game.players.forEach(function (player) {\r\n            player.releaseController();\r\n        });\r\n        return inheritActors;\r\n    };\r\n    /**\r\n     * 实际上的关卡切换逻辑，一般使用`game.switchLevel`进行代理。\r\n     */\r\n    World.prototype.switchLevel = function (name, initState, \r\n    // from world, for persistent level\r\n    initActors) {\r\n        if (initState === void 0) { initState = null; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var inheritActors, level, Script;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._levels[name]) {\r\n                            throwException(new MissingMemberException(this, 'Level', name, this), this);\r\n                        }\r\n                        level = this._level;\r\n                        Script = this._levels[name].Script;\r\n                        this._level = new Level(name, Script, this);\r\n                        this.addActor = this._level.addActor.bind(this._level);\r\n                        this.removeActor = this._level.removeActor.bind(this._level);\r\n                        // 先销毁当前关卡\r\n                        if (level) {\r\n                            inheritActors = level.destroy();\r\n                        }\r\n                        // 再继承Actor\r\n                        this._level.inherit(inheritActors || initActors || new SArray());\r\n                        // 然后当前关卡的onInit/onAdd/onLogin\r\n                        return [4 /*yield*/, this._level.init(initState)];\r\n                    case 1:\r\n                        // 然后当前关卡的onInit/onAdd/onLogin\r\n                        _a.sent();\r\n                        // 最后加载资源\r\n                        this._level.startLoading();\r\n                        return [2 /*return*/, this];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 开启物理世界，具体使用见示例[Physic](../../example/physic/base)。\r\n     *\r\n     * @enableContactEvents 是否要启用高级碰撞事件，这可以让你拥有对碰撞更细致的控制，但会有一些性能损耗，默认不开启。\r\n     */\r\n    World.prototype.enablePhysic = function (physicWorld, enableContactEvents) {\r\n        if (enableContactEvents === void 0) { enableContactEvents = false; }\r\n        this._physicWorld = physicWorld;\r\n        if (enableContactEvents) {\r\n            this._physicWorld.initContactEvents();\r\n        }\r\n        return this;\r\n    };\r\n    World.prototype.setMainCamera = function (obj) {\r\n        if (this._mainCamera) {\r\n            this._mainCamera.onAsMainCamera(false);\r\n        }\r\n        if (isSObject(obj) && isCameraComponent(obj)) {\r\n            this._mainCamera = obj;\r\n        }\r\n        else {\r\n            this._mainCamera = obj.camera;\r\n        }\r\n        this._mainCamera.onAsMainCamera(true);\r\n        return this.resizeMainCamera();\r\n    };\r\n    /**\r\n     * 重置当前摄像机相关的尺寸参数，一般不需要自己调用。\r\n     */\r\n    World.prototype.resizeMainCamera = function () {\r\n        if (!this._mainCamera) {\r\n            return this;\r\n        }\r\n        var _a = this._game.bound, width = _a.width, height = _a.height;\r\n        var aspect = width / height;\r\n        if (isPerspectiveCameraComponent(this._mainCamera)) {\r\n            this._mainCamera.aspect = aspect;\r\n            return this;\r\n        }\r\n        if (isOrthographicCameraComponent(this._mainCamera)) {\r\n            this._mainCamera.top = this._mainCamera.right / aspect;\r\n            this._mainCamera.bottom = -this._mainCamera.top;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 移除当前世界的主摄像机引用，一般在主摄像机销毁时调用，比如关卡切换时。\r\n     */\r\n    World.prototype.removeMainCamera = function () {\r\n        this._mainCamera = null;\r\n        this._mainCameras = [];\r\n    };\r\n    World = __decorate([\r\n        SClass({ className: 'World', classType: 'World' })\r\n    ], World);\r\n    return World;\r\n}(SObject));\n\nfunction isSceneComponent$1(value) {\r\n    return value.isSceneComponent;\r\n}\n\n/**\r\n * 判断一个实例是否为`ChildActorComponent`。\r\n */\r\nfunction isChildActorComponent(value) {\r\n    return value.isChildActorComponent;\r\n}\r\n/**\r\n * 用于给一个Actor挂载一个子级Actor的组件。\r\n * 注意此组件仅仅是建立了渲染层以及逻辑上的父子关系，但子级Actor仍然存在于`Game`或者`World`中，并不按照bfs顺序更新。\r\n *\r\n * @template TActor 要挂载的子级Actor的类型。\r\n * @noInheritDoc\r\n */\r\nvar ChildActorComponent = /** @class */ (function (_super) {\r\n    __extends(ChildActorComponent, _super);\r\n    function ChildActorComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isChildActorComponent = true;\r\n        /**\r\n         * 声明通过该Component挂载的Actor是否随着父级的销毁而自动销毁。\r\n         * 没有十足把握请不要修改！\r\n         * 若想变更Actor的父级，请使用`SceneActor`下的`changeParent`方法。\r\n         */\r\n        _this.autoDestroyActor = true;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ChildActorComponent.prototype, \"actor\", {\r\n        /**\r\n         * 挂载的Actor的引用。\r\n         */\r\n        get: function () {\r\n            return this._actor;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    ChildActorComponent.prototype.onInit = function (initState) {\r\n        this._actor = initState.actor;\r\n        this._parent = initState.parent || this.getRoot();\r\n        if (!isSceneActor(this._actor) || !isSceneComponent$1(this._parent)) {\r\n            return;\r\n        }\r\n        this._actor.root.hiloNode.removeFromParent();\r\n        this._actor._parent = this;\r\n        this._parent.hiloNode.addChild(this._actor.root.hiloNode);\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ChildActorComponent.prototype.onDestroy = function () {\r\n        if (!this._actor) {\r\n            return;\r\n        }\r\n        this._actor._parent = null;\r\n        if (isSceneActor(this._actor)) {\r\n            this._actor.root.hiloNode.removeFromParent();\r\n            if (this.autoDestroyActor) {\r\n                this.getWorld().removeActor(this._actor);\r\n            }\r\n        }\r\n        else {\r\n            if (this.autoDestroyActor) {\r\n                this.getGame().removeActor(this._actor);\r\n            }\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ChildActorComponent.prototype.removeActor = function (actor) {\r\n        this.removeFromParent();\r\n    };\r\n    ChildActorComponent = __decorate([\r\n        SClass({ className: 'ChildActorComponent' })\r\n    ], ChildActorComponent);\r\n    return ChildActorComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`MemberConflictException`。\r\n */\r\nfunction isMemberConflictException(value) {\r\n    return value.isMemberConflictException;\r\n}\r\n/**\r\n * 成员冲突异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar MemberConflictException = /** @class */ (function (_super) {\r\n    __extends(MemberConflictException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param parent 成员父级实例。\r\n     * @param memberType 成员类型。\r\n     * @param memberName 成员名称。\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function MemberConflictException(parent, memberType, memberName, object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'MemberConflict', object, memberType + \" \\\"\" + memberName + \"\\\" is already in \" + parent.className + \" \\\"\" + parent.name + \"\\\". \" + message) || this;\r\n        _this.isMemberConflictException = true;\r\n        return _this;\r\n    }\r\n    return MemberConflictException;\r\n}(BaseException));\n\n/**\r\n * Sein.js封装的用于存储`SObject`实例的特殊Map容器。\r\n *\r\n * @template T 存储的实例的类型。\r\n */\r\nvar SMap = /** @class */ (function (_super) {\r\n    __extends(SMap, _super);\r\n    function SMap() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._table = {};\r\n        _this._tableReflect = {};\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SMap.prototype, \"array\", {\r\n        /**\r\n         * 原始基础数组。\r\n         */\r\n        get: function () {\r\n            return this._array;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 设置对应键的实例引用。\r\n     */\r\n    SMap.prototype.set = function (key, item) {\r\n        var oldItem = this._table[key];\r\n        if (oldItem) {\r\n            this.removeItem(oldItem);\r\n            delete this._tableReflect[oldItem.uuid];\r\n        }\r\n        this.addItem(item);\r\n        this._table[key] = item;\r\n        this._tableReflect[item.uuid] = key;\r\n        return this;\r\n    };\r\n    /**\r\n     * 判断键是否在容器内。\r\n     */\r\n    SMap.prototype.has = function (key) {\r\n        return !!this._table[key];\r\n    };\r\n    /**\r\n     * 通过键从容器中移除一个实例。\r\n     */\r\n    SMap.prototype.remove = function (key) {\r\n        var oldItem = this._table[key];\r\n        if (!oldItem) {\r\n            return;\r\n        }\r\n        this.removeItem(oldItem);\r\n        delete this._table[key];\r\n        delete this._tableReflect[oldItem.uuid];\r\n        return oldItem;\r\n    };\r\n    /**\r\n     * 通过键获取一个实例。\r\n     */\r\n    SMap.prototype.get = function (key) {\r\n        return this.findByName(key);\r\n    };\r\n    /**\r\n     * 通过索引从容器中获取一个实例。\r\n     */\r\n    SMap.prototype.getAtIndex = function (index) {\r\n        return this._array[index];\r\n    };\r\n    /**\r\n     * 清空所有存储的实例。\r\n     */\r\n    SMap.prototype.clear = function () {\r\n        _super.prototype.clear.call(this);\r\n        this._table = {};\r\n        this._tableReflect = {};\r\n        return this;\r\n    };\r\n    /**\r\n     * 遍历所有键值对。\r\n     * 通过回调的返回值设`true`，你可以终止迭代，这用于性能优化。\r\n     */\r\n    SMap.prototype.forEachEntities = function (func) {\r\n        var length = this.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            var item = this._array[index];\r\n            if (func(this._tableReflect[item.uuid], item)) {\r\n                return this;\r\n            }\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 从一个基本的数组实例初始化SIterable。\r\n     */\r\n    SMap.prototype.fromArray = function (array) {\r\n        this.clear();\r\n        var length = array.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            this.set(array[index].name.value, array[index]);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 通过名字查找第一个实例。\r\n     */\r\n    SMap.prototype.findByName = function (name) {\r\n        return this._table[name];\r\n    };\r\n    /**\r\n     * 通过名字查找所有实例。\r\n     */\r\n    SMap.prototype.findAllByName = function (name) {\r\n        return [this._table[name]];\r\n    };\r\n    return SMap;\r\n}(SIterable));\n\n/**\r\n * 判断一个实例是否为`Actor`。\r\n */\r\nfunction isActor(value) {\r\n    return value.isActor;\r\n}\r\n/**\r\n * 游戏世界的基石，作为Components的封装容器。\r\n * 自身可以包含一定程度的业务逻辑，但不推荐，推荐在专用Actor中编写业务逻辑，比如`GameModeActor`和`LevelScriptActor`。\r\n *\r\n * @template IOptionTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n * @template TRootComponent 根级组件类型，一般交由由继承的类定义实现多态。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar Actor = /** @class */ (function (_super) {\r\n    __extends(Actor, _super);\r\n    /**\r\n     * 构造Actor，**不可自行构造！！！**请参见`game.addActor`或`world.addActor`方法。\r\n     */\r\n    function Actor(name, game, initOptions) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isActor = true;\r\n        /**\r\n         * Actor是否需要在每一帧进行进行`update`调用，如果为`false`，则将不会触发`onUpdate`生命周期（包括挂载在其下的所有Component）。\r\n         * 用于性能优化。\r\n         */\r\n        _this.updateOnEverTick = true;\r\n        /**\r\n         * 在Actor自身销毁时，是否同时需要触发其下挂载的所有Component的销毁，也就是`onDestroy`生命周期的调用。\r\n         * 用于性能优化。\r\n         */\r\n        _this.emitComponentsDestroy = true;\r\n        /**\r\n         * 用于给Actor归类的标签，可以用于后续的快速索引。\r\n         */\r\n        _this.tag = new SName('UnTagged');\r\n        _this._game = null;\r\n        _this._root = null;\r\n        _this._components = new SMap();\r\n        _this._componentsForUpdate = new SArray();\r\n        _this._componentsNeedUpdate = false;\r\n        _this._parent = null;\r\n        _this._inWorld = false;\r\n        _this._linked = false;\r\n        _this._game = game;\r\n        _this._initOptions = initOptions;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Actor.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例，根据情况不同可能有不同的类型，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._parent;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, \"linked\", {\r\n        /**\r\n         * Actor是否被连接到了舞台上。\r\n         */\r\n        get: function () {\r\n            return this._linked;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, \"event\", {\r\n        /**\r\n         * Actor自身范围内的事件系统管理器，将会直接代理到其的根组件`root`。\r\n         */\r\n        get: function () {\r\n            return this._root.event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Actor.prototype, \"root\", {\r\n        /**\r\n         * Actor自身的根组件。一般来讲创建后就不会变更。\r\n         */\r\n        get: function () {\r\n            return this._root;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 用于验证改Actor在当前状态是否可被添加，一般用于防止重复添加不可重复的系统Actor等。\r\n     * 你可以重写此方法来达成验证，如果验证不通过请抛出异常。\r\n     * 注意，此验证仅会在`development`环境下被执行！\r\n     */\r\n    Actor.prototype.verifyAdding = function (initOptions) { };\r\n    /**\r\n     * 用于验证该Actor在当前状态是否可被移除。\r\n     * 你可以重写此方法来达成验证，如果验证不通过请抛出异常。\r\n     * 注意，此验证仅会在`development`环境下被执行！\r\n     */\r\n    Actor.prototype.verifyRemoving = function () { };\r\n    /**\r\n     * 生命周期，将在Actor被创建时最先调用，用于创建从属于该Actor的根组件。\r\n     * 在原生Actor中均有默认值，你可以用此周期来定义你自己的Actor。\r\n     */\r\n    Actor.prototype.onCreateRoot = function (initOptions) {\r\n        return this.addComponent('root', Component);\r\n    };\r\n    /**\r\n     * 生命周期，将在Actor创建了根组件后、在正式被添加到游戏中之前被调用。\r\n     */\r\n    Actor.prototype.onInit = function (initOptions) {\r\n    };\r\n    /**\r\n     * 生命周期，将在Actor被正式加入到游戏中之后被调用。\r\n     */\r\n    Actor.prototype.onAdd = function (initOptions) {\r\n    };\r\n    /**\r\n     * 生命周期，将在Actor被正式加入到游戏中之后，并且`updateOnEverTick`为`true`时在每一帧被调用。\r\n     */\r\n    Actor.prototype.onUpdate = function (delta) {\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在游戏中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Actor.prototype.onError = function (error, details) {\r\n    };\r\n    /**\r\n     * 生命周期，将在调用`actor.unLink`方法后触发。\r\n     */\r\n    Actor.prototype.onUnLink = function () {\r\n    };\r\n    /**\r\n     * 生命周期，将在调用`actor.reLink`方法后触发。\r\n     *\r\n     * @param parent 要恢复连接到的父级。\r\n     */\r\n    Actor.prototype.onReLink = function (parent) {\r\n    };\r\n    /**\r\n     * 生命周期，将在Actor被销毁时触发。\r\n     */\r\n    Actor.prototype.onDestroy = function () {\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Actor.prototype.initialized = function () {\r\n        try {\r\n            this._root = this.onCreateRoot(this._initOptions);\r\n            this._componentsForUpdate.add(this._root);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        this._root.isRoot = true;\r\n        try {\r\n            this.onInit(this._initOptions);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Actor.prototype.added = function () {\r\n        if (this._inWorld) {\r\n            return;\r\n        }\r\n        this._inWorld = true;\r\n        this._linked = true;\r\n        this._components.forEach(function (component) {\r\n            component.added();\r\n        });\r\n        try {\r\n            this.onAdd(this._initOptions);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Actor.prototype.update = function (delta) {\r\n        this.syncComponentsNeedUpdate();\r\n        if (!this.updateOnEverTick || !this._inWorld || !this._parent) {\r\n            return;\r\n        }\r\n        try {\r\n            this.onUpdate(delta);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        this._componentsForUpdate.forEach(function (component) {\r\n            component.update(delta);\r\n        });\r\n    };\r\n    /**\r\n     * 将一个已经创建的`actor`从游戏世界中移除，但仍然保留其状态。之后可以用`reLink`方法让其重新和游戏世界建立连接。\r\n     * 注意如果有子级`actor`，并不会自动`unLink`！\r\n     * 这一般用于性能优化，比如对象池的创建。\r\n     */\r\n    Actor.prototype.unLink = function () {\r\n        if (!this._linked) {\r\n            return this;\r\n        }\r\n        try {\r\n            this.onUnLink();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        this.syncComponentsNeedUpdate();\r\n        this._componentsForUpdate.forEach(function (component) { return component.unLink(); });\r\n        var parent = this._parent;\r\n        var realParent;\r\n        if (isChildActorComponent(parent)) {\r\n            parent.autoDestroyActor = false;\r\n            parent.removeFromParent();\r\n            this._parent = parent.getOwner();\r\n            realParent = !isSceneActor(parent.getOwner()) ? parent.getGame() : parent.getWorld();\r\n        }\r\n        else {\r\n            realParent = parent;\r\n        }\r\n        /**\r\n         * @todo: fix types\r\n         */\r\n        realParent.actors.remove(this);\r\n        realParent._actorsNeedUpdate = true;\r\n        this._linked = false;\r\n        return this;\r\n    };\r\n    /**\r\n     * 将一个已经使用`unLink`方法和游戏世界断开连接的`actor`恢复连接，将其重新加入世界中。\r\n     * 这一般用于性能优化，比如对象池的创建。\r\n     *\r\n     * @param parent 指定要恢复连接到的父级，不指定则使用上一次的父级。\r\n     */\r\n    Actor.prototype.reLink = function (parent) {\r\n        if (this._linked) {\r\n            return this;\r\n        }\r\n        parent = parent || this._parent;\r\n        var realParent;\r\n        if (isActor(parent)) {\r\n            realParent = !isSceneActor(parent) ? parent.getGame() : parent.getWorld();\r\n        }\r\n        else {\r\n            realParent = parent;\r\n        }\r\n        if (isWorld(realParent) && this.getGame().world !== realParent) {\r\n            throw new Error(\"ReLink error! Current world is different from pre world !\");\r\n        }\r\n        /**\r\n         * @todo: fix types\r\n         */\r\n        realParent.actors.add(this);\r\n        realParent._actorsNeedUpdate = true;\r\n        if (isActor(parent)) {\r\n            parent.addChild(this);\r\n        }\r\n        try {\r\n            this.onReLink(parent);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        this.syncComponentsNeedUpdate();\r\n        this._componentsForUpdate.forEach(function (component) { return component.reLink(); });\r\n        this._linked = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Actor.prototype.destroy = function () {\r\n        if (this.emitComponentsDestroy) {\r\n            this.syncComponentsNeedUpdate();\r\n            this._componentsForUpdate.forEach(function (component) { return component.destroy(); });\r\n        }\r\n        else {\r\n            this._root.destroy();\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n        this._parent = null;\r\n    };\r\n    Actor.prototype.syncComponentsNeedUpdate = function () {\r\n        var _this = this;\r\n        if (this._componentsNeedUpdate) {\r\n            this._componentsForUpdate.clear();\r\n            this._components.forEach(function (item) {\r\n                if (item.isRoot || item.needUpdateAndDestroy) {\r\n                    _this._componentsForUpdate.add(item);\r\n                }\r\n            });\r\n            this._componentsNeedUpdate = false;\r\n        }\r\n    };\r\n    /**\r\n     * 获取当前`Game`实例。\r\n     *\r\n     * @template IGameState 当前游戏状态管理器的类型。\r\n     */\r\n    Actor.prototype.getGame = function () {\r\n        return this._game;\r\n    };\r\n    /**\r\n     * 获取当前`World`实例。\r\n     *\r\n     * @template IWorldState 当前世界状态管理器的类型。\r\n     */\r\n    Actor.prototype.getWorld = function () {\r\n        return this._game.world;\r\n    };\r\n    /**\r\n     * 获取当前`Level`实例。\r\n     *\r\n     * @template ILevelState 当前关卡状态管理器的类型。\r\n     */\r\n    Actor.prototype.getLevel = function () {\r\n        return this._game.level;\r\n    };\r\n    /**\r\n     * 仅在初始化了物理引擎之后，用于获取当前物理世界`PhysicWorld`实例。\r\n     * 如何使用物理引擎请见**Guide**和**Demo**。\r\n     */\r\n    Actor.prototype.getPhysicWorld = function () {\r\n        return this._game.world.physicWorld;\r\n    };\r\n    /**\r\n     * 将自己从父级移除，基本等同于`destroy`方法，从游戏中销毁自身。\r\n     */\r\n    Actor.prototype.removeFromParent = function () {\r\n        if (!this._parent) {\r\n            throwException(new Error(\"Actor \" + this.name + \" has no parent, is it an invalid reference to an actor is already removed from world ?\"), this);\r\n        }\r\n        this._parent.removeActor(this);\r\n    };\r\n    /**\r\n     * 根据指定的`ComponentClass`和其初始化参数`initState`来添加一个Component。**注意这里要求每个Component的名字`name`是唯一的**。\r\n     * 如果是在`world`中添加一个`SceneComponent`，你可以指定一个`parent`作为要添加的Component的父级，让它们在渲染层连接起来。\r\n     */\r\n    Actor.prototype.addComponent = function (name, ComponentClass, initState, parent) {\r\n        if (this._components.has(name)) {\r\n            throw new MemberConflictException(this, 'Component', name, this);\r\n        }\r\n        if (parent && parent.getOwner() !== this) {\r\n            throw new BreakGuardException(this, \"Owner of parent component \" + parent.name + \" must be same to owner of child \" + this.name);\r\n        }\r\n        var component = new ComponentClass(name, this, initState);\r\n        if (parent && (!isSceneComponent$1(parent) || !isSceneComponent$1(component))) {\r\n            throw new BreakGuardException(this, \"Only SceneComponent could have child SceneComponent ! \\nCurrent parent: \" + parent.name + \"(\" + parent.className + \"), child: \" + component.name + \"(\" + component.className + \")\");\r\n        }\r\n        if (Debug.devMode) {\r\n            try {\r\n                component.verifyAdding(initState);\r\n            }\r\n            catch (error) {\r\n                throwException(error, component);\r\n                return;\r\n            }\r\n        }\r\n        this._components.set(name, component);\r\n        component.initialized();\r\n        if (isSceneComponent$1(component)) {\r\n            if (parent) {\r\n                parent.addChild(component);\r\n            }\r\n            else if (this._root && isSceneComponent$1(this._root)) {\r\n                this._root.addChild(component);\r\n            }\r\n            else {\r\n                component._parent = this;\r\n            }\r\n        }\r\n        else {\r\n            component._parent = this;\r\n        }\r\n        if (this._inWorld) {\r\n            component.added();\r\n        }\r\n        if (component.needUpdateAndDestroy) {\r\n            this._componentsNeedUpdate = true;\r\n        }\r\n        return component;\r\n    };\r\n    Actor.prototype.removeComponent = function (value) {\r\n        var component;\r\n        if (isSObject(value) && isComponent(value)) {\r\n            component = value;\r\n        }\r\n        else {\r\n            component = this._components.get(value);\r\n        }\r\n        if (!component) {\r\n            return this;\r\n        }\r\n        if (!component.canBeRemoved || component.isRoot) {\r\n            throw new BreakGuardException(this, \"In actor \" + this.name + \", component \" + component.name + \" can not be removed.\\nIt's one of '!canBeRemoved', 'root'\");\r\n        }\r\n        if (Debug.devMode) {\r\n            try {\r\n                component.verifyRemoving();\r\n            }\r\n            catch (error) {\r\n                throwException(error, component);\r\n                return;\r\n            }\r\n        }\r\n        if (component.parent && isSceneComponent$1(component.parent)) {\r\n            component.parent.removeChild(component);\r\n            this.clearSceneComponent(component);\r\n        }\r\n        component.destroy();\r\n        this._components.remove(component.name.value);\r\n        if (component.needUpdateAndDestroy) {\r\n            this._componentsNeedUpdate = true;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 将一个Actor作为自身的子级，注意子级Actor将仍然存在于`game`或者`world`中，并拥有自身独立的生命周期，这里只是建立了一个连接关系。\r\n     * 如果父子为`SceneActor`，那么这层链接关系还会反映到渲染层，同时可以指定一个`SceneComponent`作为其父级节点。\r\n     */\r\n    Actor.prototype.addChild = function (actor, parentComponent) {\r\n        if (actor.parent && isChildActorComponent(actor.parent)) {\r\n            actor.parent.getOwner().removeComponent(actor.parent);\r\n        }\r\n        this.addComponent(actor.name.value, ChildActorComponent, { actor: actor, parent: parentComponent });\r\n    };\r\n    /**\r\n     * 解除自身和一个子级Actor的链接。注意此方法也会直接将子级Actor从游戏中销毁！\r\n     * 如果只是想要改变一个SceneActor的归属，请使用`SceneActor`下的`changeParent`方法。\r\n     */\r\n    Actor.prototype.removeChild = function (actor) {\r\n        if (!actor.parent || !isChildActorComponent(actor.parent)) {\r\n            return;\r\n        }\r\n        this.removeComponent(actor.parent);\r\n    };\r\n    // todo: 级联将导致所有子组件递归销毁\r\n    // 性能会不会有问题？\r\n    // 这个情况还要考虑更完美的处理方式？\r\n    Actor.prototype.clearSceneComponent = function (component) {\r\n        var _this = this;\r\n        component.children.forEach(function (child) {\r\n            component.destroy();\r\n            _this._components.remove(child.name.value);\r\n            _this.clearSceneComponent(child);\r\n        });\r\n    };\r\n    /**\r\n     * 根据名字查找一个Component。\r\n     */\r\n    Actor.prototype.findComponentByName = function (name) {\r\n        return this._components.get(name);\r\n    };\r\n    /**\r\n     * 根据某个类查找一个Component。\r\n     */\r\n    Actor.prototype.findComponentByClass = function (ComponentClass) {\r\n        return this._components.findByClass(ComponentClass);\r\n    };\r\n    /**\r\n     * 查找某个类的所有实例Component。\r\n     */\r\n    Actor.prototype.findComponentsByClass = function (ComponentClass) {\r\n        return this._components.findAllByClass(ComponentClass);\r\n    };\r\n    /**\r\n     * 通过一个Filter来查找组件。\r\n     */\r\n    Actor.prototype.findComponentByFilter = function (filter) {\r\n        return this._components.findByFilter(filter);\r\n    };\r\n    /**\r\n     * 通过一个Filter来查找所有。\r\n     */\r\n    Actor.prototype.findComponentsByFilter = function (filter) {\r\n        return this._components.findAllByFilter(filter);\r\n    };\r\n    Actor = __decorate([\r\n        SClass({ className: 'Actor', classType: 'Actor' })\r\n    ], Actor);\r\n    return Actor;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`Ticker`。\r\n */\r\nfunction isTicker(value) {\r\n    return value.isTicker;\r\n}\r\n/**\r\n * 维护一个监听器队列，在每一帧调用队列里的回调。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar Ticker = /** @class */ (function (_super) {\r\n    __extends(Ticker, _super);\r\n    /**\r\n     * 指定锁定帧率，创建一个Ticker。\r\n     * 若不指定则不锁帧。\r\n     */\r\n    function Ticker(fps) {\r\n        var _this = _super.call(this, 'SeinTimer') || this;\r\n        _this.isTicker = true;\r\n        _this._rafId = 0;\r\n        _this._lockFrame = false;\r\n        _this._fps = 0;\r\n        _this._spf = 0;\r\n        _this._pre = 0;\r\n        _this._delta = 0;\r\n        _this._actualPre = 0;\r\n        _this._tickers = [];\r\n        _this._tickersQueue = [];\r\n        _this._needUpdate = false;\r\n        _this._paused = true;\r\n        _this.update = function (ts, rafId) {\r\n            if (_this._paused || _this._rafId !== rafId) {\r\n                return;\r\n            }\r\n            _this.raf(_this.update);\r\n            if (_this._pre === 0) {\r\n                _this._pre = ts;\r\n                _this._actualPre = Date.now();\r\n                return;\r\n            }\r\n            if (_this._needUpdate) {\r\n                _this._tickersQueue = _this._tickers.slice();\r\n                _this._needUpdate = false;\r\n            }\r\n            var delta = ts - _this._pre;\r\n            _this._pre = ts;\r\n            if (!_this._lockFrame) {\r\n                var length_1 = _this._tickersQueue.length;\r\n                for (var i = 0; i < length_1; i += 1) {\r\n                    _this._tickersQueue[i](delta);\r\n                }\r\n                return;\r\n            }\r\n            if (_this._delta >= _this._spf) {\r\n                var now = Date.now();\r\n                var actualDelta = now - _this._actualPre;\r\n                _this._actualPre = now;\r\n                _this._delta -= _this._spf * ~~(_this._delta / _this._spf);\r\n                var length_2 = _this._tickersQueue.length;\r\n                for (var i = 0; i < length_2; i += 1) {\r\n                    _this._tickersQueue[i](actualDelta);\r\n                }\r\n            }\r\n            _this._delta += delta;\r\n        };\r\n        if (fps !== undefined && fps !== null) {\r\n            _this.fps = fps;\r\n        }\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Ticker.prototype, \"fps\", {\r\n        /**\r\n         * 获取锁定帧率。\r\n         */\r\n        get: function () {\r\n            return this._fps;\r\n        },\r\n        /**\r\n         * 修改锁定帧率。\r\n         */\r\n        set: function (fps) {\r\n            if (60 % fps !== 0) {\r\n                Debug.warn(fps + \"fps is not safe, you can only choice 60, 30, 20(not in low-power mode in safari), 15, 10 or 5 !\");\r\n            }\r\n            this._fps = fps;\r\n            this._spf = 1000 / fps;\r\n            this._lockFrame = true;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Ticker.prototype, \"paused\", {\r\n        /**\r\n         * Ticker是否暂停。\r\n         */\r\n        get: function () {\r\n            return this._paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Ticker.prototype, \"lockFrame\", {\r\n        /**\r\n         * 获取是否开启锁帧。\r\n         */\r\n        get: function () {\r\n            return this._lockFrame;\r\n        },\r\n        /**\r\n         * 设置是否开启锁帧。\r\n         */\r\n        set: function (value) {\r\n            this._lockFrame = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 添加一个ticker监听器到队列中。\r\n     */\r\n    Ticker.prototype.add = function (listener) {\r\n        this._tickers.push(listener);\r\n        this._needUpdate = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 从队列中移除一个监听器。\r\n     */\r\n    Ticker.prototype.remove = function (listener) {\r\n        this._tickers.splice(this._tickers.indexOf(listener), 1);\r\n        this._needUpdate = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 启动Ticker。\r\n     */\r\n    Ticker.prototype.start = function () {\r\n        this._paused = false;\r\n        this._pre = 0;\r\n        this._delta = 0;\r\n        this._actualPre = 0;\r\n        this.raf(this.update);\r\n        return this;\r\n    };\r\n    /**\r\n     * 暂停Ticker。\r\n     */\r\n    Ticker.prototype.pause = function () {\r\n        this._paused = true;\r\n        this._rafId += 1;\r\n        return this;\r\n    };\r\n    Ticker.prototype.raf = function (callback) {\r\n        if (this._rafId >= 65535) {\r\n            this._rafId = 0;\r\n        }\r\n        else {\r\n            this._rafId += 1;\r\n        }\r\n        var rafId = this._rafId;\r\n        requestAnimationFrame(function (ts) { return callback(ts, rafId); });\r\n    };\r\n    Ticker = __decorate([\r\n        SClass({ className: 'Ticker', classType: 'Ticker' })\r\n    ], Ticker);\r\n    return Ticker;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`Engine`。\r\n */\r\nfunction isEngine(value) {\r\n    return value.isEngine;\r\n}\r\n/**\r\n * 顶层引擎类，一般除了初始化游戏不需要直接控制。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar Engine = /** @class */ (function (_super) {\r\n    __extends(Engine, _super);\r\n    function Engine(options) {\r\n        var _this = _super.call(this, 'SeinEngine') || this;\r\n        _this.isEngine = true;\r\n        _this._options = null;\r\n        _this._ticker = null;\r\n        _this._games = [];\r\n        _this._runningGames = [];\r\n        _this.update = function (delta) {\r\n            var length = _this._runningGames.length;\r\n            Tween.tick();\r\n            for (var i = 0; i < length; i += 1) {\r\n                _this._runningGames[i].update(delta);\r\n            }\r\n        };\r\n        Engine_1.RUNNING_ENGINES.push(_this);\r\n        _this._options = options || {};\r\n        _this._ticker = new Ticker(_this._options.fps);\r\n        _this._ticker.add(_this.update);\r\n        return _this;\r\n    }\r\n    Engine_1 = Engine;\r\n    /**\r\n     * 获取当前运行的Engine实例。\r\n     *\r\n     * @param index 索引，不传则取回第一个，一般也就是唯一的一个。\r\n     */\r\n    Engine.GET_RUNNING_ENGINE = function (index) {\r\n        if (index === void 0) { index = 0; }\r\n        return Engine_1.RUNNING_ENGINES[index];\r\n    };\r\n    Object.defineProperty(Engine.prototype, \"options\", {\r\n        /**\r\n         * 当前参数。\r\n         */\r\n        get: function () {\r\n            return this._options;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Engine.prototype, \"ticker\", {\r\n        /**\r\n         * 全局\bTicker。\r\n         */\r\n        get: function () {\r\n            return this._ticker;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Engine.prototype, \"env\", {\r\n        /**\r\n         * 当前运行环境，一般为`development`或`production`。\r\n         */\r\n        get: function () {\r\n            return Debug.env;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Engine.prototype, \"devMode\", {\r\n        /**\r\n         * `env`不为`production`时，判定为开发环境。\r\n         */\r\n        get: function () {\r\n            return Debug.devMode;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在游戏中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Engine.prototype.onError = function (error, details) {\r\n        Debug.warn(\"Error '\" + error.message + \"' reaches engine, try to catch it in exception chain !\");\r\n    };\r\n    /**\r\n     * 添加一个游戏实例到引擎中。\r\n     */\r\n    Engine.prototype.addGame = function (game) {\r\n        game._engine = this;\r\n        this._games.push(game);\r\n        try {\r\n            game.onAdd();\r\n        }\r\n        catch (error) {\r\n            throwException(error, game);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 将一个游戏实例从引擎中移除。\r\n     */\r\n    Engine.prototype.removeGame = function (game) {\r\n        var index = this._runningGames.indexOf(game);\r\n        if (index >= 0) {\r\n            this.destroyGame(game);\r\n        }\r\n        index = this._games.indexOf(game);\r\n        if (index >= 0) {\r\n            this._games.splice(index, 1);\r\n        }\r\n        game._engine = null;\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取当前运行的某个Game实例。\r\n     *\r\n     * @param index 索引，不传则取回第一个，一般也就是唯一的一个。\r\n     */\r\n    Engine.prototype.getRunningGame = function (index) {\r\n        if (index === void 0) { index = 0; }\r\n        return this._runningGames[index];\r\n    };\r\n    /**\r\n     * 不要自己调用！\r\n     *\r\n     * @hidden\r\n     */\r\n    Engine.prototype.startGame = function (game) {\r\n        if (this._runningGames.indexOf(game) < 0) {\r\n            this._runningGames.push(game);\r\n            try {\r\n                game.onStart();\r\n            }\r\n            catch (error) {\r\n                throwException(error, game);\r\n            }\r\n        }\r\n        if (this._ticker.paused) {\r\n            this._ticker.start();\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 不要自己调用！\r\n     *\r\n     * @hidden\r\n     */\r\n    Engine.prototype.pauseGame = function (game) {\r\n        try {\r\n            game.onPause();\r\n        }\r\n        catch (error) {\r\n            throwException(error, game);\r\n        }\r\n        this._runningGames.splice(this._runningGames.indexOf(game), 1);\r\n        if (this._runningGames.length === 0) {\r\n            this._ticker.pause();\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 不要自己调用！\r\n     *\r\n     * @hidden\r\n     */\r\n    Engine.prototype.resumeGame = function (game) {\r\n        this._runningGames.push(game);\r\n        try {\r\n            game.onResume();\r\n        }\r\n        catch (error) {\r\n            throwException(error, game);\r\n        }\r\n        if (this._ticker.paused) {\r\n            this._ticker.start();\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 不要自己调用！\r\n     *\r\n     * @hidden\r\n     */\r\n    Engine.prototype.restartGame = function (game) {\r\n        this.destroyGame(game);\r\n        this.startGame(game);\r\n        return this;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    Engine.prototype.destroyGame = function (game) {\r\n        var index = this._runningGames.indexOf(game);\r\n        if (index >= 0) {\r\n            this._runningGames.splice(index, 1);\r\n            try {\r\n                game.onDestroy();\r\n            }\r\n            catch (error) {\r\n                throwException(error, game);\r\n            }\r\n        }\r\n        if (this._runningGames.length === 0) {\r\n            this._ticker.pause();\r\n        }\r\n        this.removeGame(game);\r\n        return this;\r\n    };\r\n    /**\r\n     * 启动所有游戏，一般使用`game.start()`作为替代，启动特定游戏。\r\n     */\r\n    Engine.prototype.start = function () {\r\n        this._games.forEach(function (game) { return game.start(); });\r\n        return this;\r\n    };\r\n    /**\r\n     * 暂停所有游戏，一般使用`game.pause()`作为替代，暂停特定游戏。\r\n     */\r\n    Engine.prototype.pause = function () {\r\n        this._runningGames.forEach(function (game) { return game.pause(); });\r\n        return this;\r\n    };\r\n    /**\r\n     * 唤醒所有游戏，一般使用`game.resume()`作为替代，唤醒特定游戏。\r\n     */\r\n    Engine.prototype.resume = function () {\r\n        this._games.forEach(function (game) { return game.resume(); });\r\n        return this;\r\n    };\r\n    /**\r\n     * 销毁所有游戏，一般使用`game.destroy()`作为替代，销毁特定游戏。\r\n     */\r\n    Engine.prototype.destroy = function () {\r\n        this._runningGames.forEach(function (game) { return game.destroy(); });\r\n        this._games = [];\r\n        Engine_1.RUNNING_ENGINES.splice(Engine_1.RUNNING_ENGINES.indexOf(this), 1);\r\n    };\r\n    var Engine_1;\r\n    /**\r\n     * 当前所有正在运行的Engine，一般情况下只有一个。\r\n     */\r\n    Engine.RUNNING_ENGINES = [];\r\n    Engine = Engine_1 = __decorate([\r\n        SClass({ className: 'Engine', classType: 'Engine' })\r\n    ], Engine);\r\n    return Engine;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`ResourceLoadException`。\r\n */\r\nfunction isResourceLoadException(value) {\r\n    return value.isResourceLoadException;\r\n}\r\n/**\r\n * 资源加载异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar ResourceLoadException = /** @class */ (function (_super) {\r\n    __extends(ResourceLoadException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param parent 成员父级实例。\r\n     * @param memberType 成员类型。\r\n     * @param memberName 成员名称。\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function ResourceLoadException(resourceName, resourceManager, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'ResourceLoad', resourceManager, \"Error occured when load resource \\\"\" + resourceName + \"\\\". \" + message) || this;\r\n        _this.isResourceLoadException = true;\r\n        _this.resourceName = resourceName;\r\n        return _this;\r\n    }\r\n    return ResourceLoadException;\r\n}(BaseException));\n\n/**\r\n * 判断一个实例是否为`ResourceLoader`。\r\n */\r\nfunction isResourceLoader(value) {\r\n    return value.isResourceLoader;\r\n}\r\n/**\r\n * 资源加载器。加载器用于在资源管理器[ResourceManager](../eesourcemanager)注册加载器时。\r\n * 你可以继承此基类来派生自己的加载器。\r\n *\r\n * @template IResource 此加载器对应的实体参数类型。\r\n * @noInheritDoc\r\n */\r\nvar ResourceLoader = /** @class */ (function (_super) {\r\n    __extends(ResourceLoader, _super);\r\n    function ResourceLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isResourceLoader = true;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 加载一个资源，并根据情况执行`callbacks`中的回调。\r\n     */\r\n    ResourceLoader.prototype.load = function (entity, callbacks) {\r\n        setTimeout(function () { return callbacks.onLoaded(entity); }, 0);\r\n    };\r\n    /**\r\n     * 取消加载特定实体。一般不需要自己编写逻辑，而是使用`entity.canceled`在加载终点丢弃。\r\n     * 注意`entity.canceled`是在这里赋值的，所以一般继承请务必先执行`super.cancel()`！\r\n     */\r\n    ResourceLoader.prototype.cancel = function (entity) {\r\n        entity.canceled = true;\r\n    };\r\n    /**\r\n     * 通过指定资源实体实例化出一个具体的对象。\r\n     */\r\n    ResourceLoader.prototype.instantiate = function (entity, options) {\r\n        throw new Error('Not implemented !');\r\n    };\r\n    /**\r\n     * 释放资源时将会调用，用于自定义释放逻辑。\r\n     */\r\n    ResourceLoader.prototype.release = function (entity) {\r\n    };\r\n    /**\r\n     * 此加载器所关联的后缀，例如`.png`。\r\n     *\r\n     * 注意后面的会覆盖前面的！\r\n     */\r\n    ResourceLoader.EXTENSIONS = [];\r\n    ResourceLoader = __decorate([\r\n        SClass({ className: 'ResourceLoader' })\r\n    ], ResourceLoader);\r\n    return ResourceLoader;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`RigidBodyComponent`。\r\n */\r\nfunction isRigidBodyComponent(value) {\r\n    return value.isRigidBodyComponent;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nvar vec3Unit = new Vector3(1, 1, 1);\r\n/**\r\n * @hidden\r\n */\r\nvar vec3Zero = new Vector3(0, 0, 0);\r\n/**\r\n * 刚体组件类，为Actor添加物理引擎和碰撞检测、拾取的基本功能。\r\n * **当挂载到Actor后，你可以直接通过`actor.rigidBody`来访问它。**\r\n *\r\n * @noInheritDoc\r\n */\r\nvar RigidBodyComponent = /** @class */ (function (_super) {\r\n    __extends(RigidBodyComponent, _super);\r\n    function RigidBodyComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isRigidBodyComponent = true;\r\n        /**\r\n         * 不要自己使用。\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.needUpdateCollider = false;\r\n        _this._disabled = false;\r\n        _this._sleeping = false;\r\n        _this._valid = false;\r\n        _this._tmpQuat = new Quaternion();\r\n        _this._tmpQuat2 = new Quaternion();\r\n        _this._tmpScale = new Vector3(1, 1, 1);\r\n        _this._tmpScale2 = new Vector3(1, 1, 1);\r\n        _this._tmpScale3 = new Vector3(1, 1, 1);\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleCollision = function (_a) {\r\n            var body = _a.body, contact = _a.contact;\r\n            var other;\r\n            var self;\r\n            if (body.id === contact.bi.id) {\r\n                self = contact.bj;\r\n                other = contact.bi;\r\n            }\r\n            else {\r\n                self = contact.bi;\r\n                other = contact.bj;\r\n            }\r\n            if (!_this._valid || !other.component.valid) {\r\n                return;\r\n            }\r\n            _this.event.trigger('Collision', {\r\n                selfBody: self.component,\r\n                otherBody: other.component,\r\n                selfActor: self.component.getOwner(),\r\n                otherActor: other.component.getOwner()\r\n            });\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleBodyEnter = function (selfBody, otherBody) {\r\n            if (!_this._valid || !otherBody.valid) {\r\n                return;\r\n            }\r\n            _this.event.trigger('BodyEnter', { selfBody: selfBody, otherBody: otherBody, selfActor: selfBody.getOwner(), otherActor: otherBody.getOwner() });\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleBodyLeave = function (selfBody, otherBody) {\r\n            if (!_this._valid || !otherBody.valid) {\r\n                return;\r\n            }\r\n            _this.event.trigger('BodyLeave', { selfBody: selfBody, otherBody: otherBody, selfActor: selfBody.getOwner(), otherActor: otherBody.getOwner() });\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleColliderEnter = function (selfBody, otherBody, selfCollider, otherCollider) {\r\n            if (!_this._valid || !otherBody.valid) {\r\n                return;\r\n            }\r\n            _this.event.trigger('ColliderEnter', {\r\n                selfBody: selfBody, otherBody: otherBody, selfCollider: selfCollider, otherCollider: otherCollider,\r\n                selfActor: selfBody.getOwner(), otherActor: otherBody.getOwner()\r\n            });\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleColliderLeave = function (selfBody, otherBody, selfCollider, otherCollider) {\r\n            if (!_this._valid || !otherBody.valid) {\r\n                return;\r\n            }\r\n            _this.event.trigger('ColliderLeave', {\r\n                selfBody: selfBody, otherBody: otherBody, selfCollider: selfCollider, otherCollider: otherCollider,\r\n                selfActor: selfBody.getOwner(), otherActor: otherBody.getOwner()\r\n            });\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleBeforeStep = function (_, forceSync) {\r\n            if (forceSync === void 0) { forceSync = false; }\r\n            if (!_this._valid) {\r\n                return;\r\n            }\r\n            if (_this._physicStatic && !_this._sleeping && _this.mass !== 0) {\r\n                _this.setAngularVelocity(vec3Zero);\r\n                _this.setLinearVelocity(vec3Zero);\r\n            }\r\n            _this.syncTransformToRigidBody(forceSync);\r\n            _this.event.trigger('BeforeStep', _this);\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handleAfterStep = function () {\r\n            if (!_this.valid) {\r\n                return;\r\n            }\r\n            if (_this._physicStatic || _this._sleeping) {\r\n                return;\r\n            }\r\n            var transform = _this._owner.transform;\r\n            _this.event.trigger('AfterStep', _this);\r\n            _this.getPhysicWorld().setRootTransform(_this);\r\n            // object has now its world rotation. needs to be converted to local.\r\n            if (_this._owner.parent) {\r\n                _this.getParentsRotationAndScale();\r\n                _this._tmpQuat.conjugate();\r\n                transform.quaternion = _this._tmpQuat.multiply(transform.quaternion);\r\n            }\r\n            // take the position set and make it the absolute position of this object.\r\n            transform.absolutePosition = transform.position;\r\n        };\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.handlePick = function (result) {\r\n            _this.event.trigger('Pick', result);\r\n        };\r\n        return _this;\r\n    }\r\n    RigidBodyComponent_1 = RigidBodyComponent;\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"rigidBody\", {\r\n        /**\r\n         * 获取物理世界的刚体，不需要自己使用。\r\n         *\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._rigidBody;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"valid\", {\r\n        /**\r\n         * 刚体当前是否有效，不需要自己使用。\r\n         *\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._valid;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"event\", {\r\n        /**\r\n         * RigidBodyComponent的事件管理器。\r\n         */\r\n        get: function () {\r\n            return this._event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"mass\", {\r\n        /**\r\n         * 获取重力。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getBodyMass(this);\r\n        },\r\n        /**\r\n         * 设置重力。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setBodyMass(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"filterGroup\", {\r\n        /**\r\n         * 获取filterGroup。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getFilterGroup(this);\r\n        },\r\n        /**\r\n         * 设置filterGroup，一个32bits的整数，用于给刚体分组。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setFilterGroup(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"filterMask\", {\r\n        /**\r\n         * 获取filterMask。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getFilterMask(this);\r\n        },\r\n        /**\r\n         * 设置filterMask，一个32bits的整数，用于给分组后的刚体设置碰撞对象范围。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setFilterMask(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"friction\", {\r\n        /**\r\n         * 获取刚体摩擦力。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getBodyFriction(this);\r\n        },\r\n        /**\r\n         * 设置刚体摩擦力。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setBodyFriction(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"restitution\", {\r\n        /**\r\n         * 获取刚体弹性系数。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getBodyRestitution(this);\r\n        },\r\n        /**\r\n         * 设置刚体弹性系数。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setBodyRestitution(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"unControl\", {\r\n        /**\r\n         * 获取刚体是否处于不可控状态，详见[IRigidBodyComponentState](../interfaces/irigidbodycomponentstate)。\r\n         */\r\n        get: function () {\r\n            return this._unControl;\r\n        },\r\n        /**\r\n         * 设置刚体是否处于不可控状态，详见[IRigidBodyComponentState](../interfaces/irigidbodycomponentstate)。\r\n         */\r\n        set: function (value) {\r\n            this._unControl = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"physicStatic\", {\r\n        /**\r\n         * 获取刚体是否处于物理静止状态，详见[IRigidBodyComponentState](../interfaces/irigidbodycomponentstate)。\r\n         */\r\n        get: function () {\r\n            return this._physicStatic;\r\n        },\r\n        /**\r\n         * 设置刚体是否处于物理静止状态，详见[IRigidBodyComponentState](../interfaces/irigidbodycomponentstate)。\r\n         */\r\n        set: function (value) {\r\n            this._physicStatic = value;\r\n            this.getPhysicWorld().setBodyType(this, value ? ERigidBodyType.Static : ERigidBodyType.Dynamic);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(RigidBodyComponent.prototype, \"disabled\", {\r\n        /**\r\n         * 刚体组件目前是否停止运作。\r\n         */\r\n        get: function () {\r\n            return this._disabled;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    RigidBodyComponent.prototype.verifyAdding = function () {\r\n        if (!this.getPhysicWorld()) {\r\n            throw new UnmetRequireException(this, 'Physic world is required for adding RigidBodyComponent !');\r\n        }\r\n        if (this._owner.findComponentByClass(RigidBodyComponent_1)) {\r\n            throw new MemberConflictException(this._owner, 'RigidBodyComponent', this.name, this);\r\n        }\r\n    };\r\n    RigidBodyComponent.prototype.onInit = function (initState) {\r\n        this._unControl = initState.unControl || false;\r\n        this._physicStatic = initState.physicStatic || false;\r\n        if (typeof initState.filterMask !== 'undefined') {\r\n            this.filterMask = initState.filterMask;\r\n        }\r\n        if (typeof initState.filterGroup !== 'undefined') {\r\n            this.filterGroup = initState.filterGroup;\r\n        }\r\n        this._event.register('Pick');\r\n        this._event.register('Collision');\r\n        this._event.register('BodyEnter');\r\n        this._event.register('BodyLeave');\r\n        this._event.register('ColliderEnter');\r\n        this._event.register('ColliderLeave');\r\n        this._event.register('BeforeStep');\r\n        this._event.register('AfterStep');\r\n        // fixme: hack for performance\r\n        this._owner._rigidBody = this;\r\n    };\r\n    /**\r\n     * 添加到世界，继承请先`super.onAdd()`。\r\n     */\r\n    RigidBodyComponent.prototype.onAdd = function (initState) {\r\n        this._rigidBody = this.getPhysicWorld().createRigidBody(this, initState);\r\n        this.getPhysicWorld().initEvents(this);\r\n        this._valid = true;\r\n        if (initState.sleeping === true) {\r\n            this.sleep();\r\n        }\r\n    };\r\n    /**\r\n     * 从世界中暂时移除，继承请先`super.onUnLink()`。\r\n     */\r\n    RigidBodyComponent.prototype.onUnLink = function () {\r\n        this.disable();\r\n    };\r\n    /**\r\n     * 重连世界，继承请先`super.onReLink()`。\r\n     */\r\n    RigidBodyComponent.prototype.onReLink = function () {\r\n        this.enable();\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    RigidBodyComponent.prototype.onDestroy = function () {\r\n        var _this = this;\r\n        this._valid = false;\r\n        var physicWorld = this.getPhysicWorld();\r\n        setTimeout(function () { return physicWorld.removeRigidBody(_this); }, 0);\r\n        if (this._owner.rigidBody === this) {\r\n            this._owner._rigidBody = null;\r\n        }\r\n    };\r\n    /**\r\n     * 暂时使得刚体失去效应，可以用`enable`恢复。\r\n     */\r\n    RigidBodyComponent.prototype.disable = function () {\r\n        this.getPhysicWorld().disableRigidBody(this);\r\n        this._disabled = true;\r\n    };\r\n    /**\r\n     * 使得一个暂时失去效应的刚体恢复。\r\n     */\r\n    RigidBodyComponent.prototype.enable = function () {\r\n        this.getPhysicWorld().enableRigidBody(this);\r\n        this._disabled = false;\r\n    };\r\n    /**\r\n     * 获取质心。\r\n     */\r\n    RigidBodyComponent.prototype.getMassCenter = function () {\r\n        return this._owner.transform.position;\r\n    };\r\n    /**\r\n     * 设置刚体的父级Actor的`transform`。\r\n     */\r\n    RigidBodyComponent.prototype.setRootTransform = function () {\r\n        this.getPhysicWorld().setRootTransform(this);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置刚体的`transform`。\r\n     */\r\n    RigidBodyComponent.prototype.setRigidBodyTransform = function (newPosition, newRotation) {\r\n        this.getPhysicWorld().setRigidBodyTransform(this, newPosition, newRotation);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置线速度。\r\n     */\r\n    RigidBodyComponent.prototype.setLinearVelocity = function (velocity) {\r\n        this.getPhysicWorld().setLinearVelocity(this, velocity);\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置角速度。\r\n     */\r\n    RigidBodyComponent.prototype.setAngularVelocity = function (velocity) {\r\n        this.getPhysicWorld().setAngularVelocity(this, velocity);\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取线速度。\r\n     */\r\n    RigidBodyComponent.prototype.getLinearVelocity = function () {\r\n        return this.getPhysicWorld().getLinearVelocity(this);\r\n    };\r\n    /**\r\n     * 获取角速度。\r\n     */\r\n    RigidBodyComponent.prototype.getAngularVelocity = function () {\r\n        return this.getPhysicWorld().getAngularVelocity(this);\r\n    };\r\n    /**\r\n     * 使刚体进入睡眠状态，不会触发任何碰撞事件，但可以正确响应拾取操作。\r\n     */\r\n    RigidBodyComponent.prototype.sleep = function () {\r\n        this.getPhysicWorld().sleepBody(this);\r\n        this._sleeping = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 唤醒刚体。\r\n     */\r\n    RigidBodyComponent.prototype.wakeUp = function () {\r\n        this.getPhysicWorld().wakeUpBody(this);\r\n        this._sleeping = false;\r\n        return this;\r\n    };\r\n    /**\r\n     * 强制同步物理刚体的transform到组件父级Actor。\r\n     */\r\n    RigidBodyComponent.prototype.forceSync = function () {\r\n        this.handleBeforeStep(null, true);\r\n        return this;\r\n    };\r\n    RigidBodyComponent.prototype.getParentsRotationAndScale = function () {\r\n        var parent = this._owner.parent;\r\n        this._tmpQuat.set(0, 0, 0, 1);\r\n        this._tmpScale.set(1, 1, 1);\r\n        while (parent && !isLevel(parent)) {\r\n            var actor = parent.getOwner();\r\n            this._tmpQuat2.copy(actor.transform.quaternion);\r\n            this._tmpQuat.multiply(this._tmpQuat2);\r\n            this._tmpScale2.copy(actor.transform.scale);\r\n            this._tmpScale.multiply(this._tmpScale2);\r\n            parent = actor.parent;\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    RigidBodyComponent.prototype.getCurrentTransform = function () {\r\n        var transform = this._owner.transform;\r\n        transform.updateMatrixWorld(true);\r\n        if (this._owner.parent && !isLevel(this._owner.parent)) {\r\n            this.getParentsRotationAndScale();\r\n            this._tmpQuat.multiply(transform.quaternion);\r\n            this._tmpScale.multiply(transform.scale);\r\n        }\r\n        else {\r\n            this._tmpQuat.copy(transform.quaternion);\r\n            this._tmpScale.copy(transform.scale);\r\n        }\r\n        return [transform.absolutePosition, this._tmpQuat, this._tmpScale];\r\n    };\r\n    RigidBodyComponent.prototype.syncTransformToRigidBody = function (forceSync) {\r\n        // todo: bug: change this.box.transform.position & change this.box.transform.scale.x = .3;\r\n        var transform = this._owner.transform;\r\n        if (this.needUpdateCollider) {\r\n            this.getPhysicWorld().updateBounding(this);\r\n            this.needUpdateCollider = false;\r\n        }\r\n        if (!forceSync && this._unControl) {\r\n            return;\r\n        }\r\n        if (forceSync) {\r\n            transform.updateMatrixWorld(true);\r\n        }\r\n        this._tmpScale3.copy(this._tmpScale);\r\n        if (this._owner.parent && !isLevel(this._owner.parent)) {\r\n            this.getParentsRotationAndScale();\r\n            this._tmpQuat.multiply(transform.quaternion);\r\n            this._tmpScale.multiply(transform.scale);\r\n        }\r\n        else {\r\n            this._tmpQuat.copy(transform.quaternion);\r\n            this._tmpScale.copy(transform.scale);\r\n        }\r\n        var updateScale = (forceSync && !this._tmpScale.equals(vec3Unit)) || !this._tmpScale.equals(this._tmpScale3);\r\n        this.getPhysicWorld().setRigidBodyTransform(this, transform.absolutePosition, this._tmpQuat, updateScale ? this._tmpScale : null);\r\n        if (forceSync) {\r\n            this.getPhysicWorld().updateBounding(this);\r\n        }\r\n    };\r\n    var RigidBodyComponent_1;\r\n    RigidBodyComponent = RigidBodyComponent_1 = __decorate([\r\n        SClass({ className: 'RigidBodyComponent', classType: 'RigidBody' })\r\n    ], RigidBodyComponent);\r\n    return RigidBodyComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`ColliderComponent`。\r\n */\r\nfunction isColliderComponent(value) {\r\n    return value.isColliderComponent;\r\n}\r\n/**\r\n * 碰撞体组件基类。一般不自己使用，而是交由继承的类实现多态。\r\n *\r\n * @template IStateTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n * @noInheritDoc\r\n */\r\nvar ColliderComponent = /** @class */ (function (_super) {\r\n    __extends(ColliderComponent, _super);\r\n    function ColliderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isColliderComponent = true;\r\n        _this._type = EColliderType.Null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ColliderComponent.prototype, \"collider\", {\r\n        /**\r\n         * 获取物理世界的碰撞体，不要自己操作。\r\n         *\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._collider;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColliderComponent.prototype, \"type\", {\r\n        /**\r\n         * 获取碰撞体类型。\r\n         */\r\n        get: function () {\r\n            return this._type;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColliderComponent.prototype, \"initState\", {\r\n        /**\r\n         * 获取初始化参数实例引用。\r\n         */\r\n        get: function () {\r\n            return this._initState;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ColliderComponent.prototype, \"isTrigger\", {\r\n        /**\r\n         * 获取是否是触发器。\r\n         */\r\n        get: function () {\r\n            return this.getPhysicWorld().getColliderIsTrigger(this);\r\n        },\r\n        // set friction(value: number) {\r\n        //   this.getPhysicWorld().setColliderFriction(this, value);\r\n        // }\r\n        // get friction() {\r\n        //   return this.getPhysicWorld().getColliderFriction(this);\r\n        // }\r\n        // set restitution(value: number) {\r\n        //   this.getPhysicWorld().setColliderRestitution(this, value);\r\n        // }\r\n        // get restitution() {\r\n        //   return this.getPhysicWorld().getColliderRestitution(this);\r\n        // }\r\n        /**\r\n         * 设置是否是触发器。\r\n         */\r\n        set: function (value) {\r\n            this.getPhysicWorld().setColliderIsTrigger(this, value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 开发环境下，验证可添加性。\r\n     */\r\n    ColliderComponent.prototype.verifyAdding = function () {\r\n        var rigidBody = this._owner.rigidBody;\r\n        if (!rigidBody) {\r\n            throw new BreakGuardException(this, 'RigidBodyComponent must be added before adding ColliderComponent !');\r\n        }\r\n    };\r\n    /**\r\n     * 添加到世界，继承请先`super.onAdd()`。\r\n     */\r\n    ColliderComponent.prototype.onAdd = function (initState) {\r\n        var rigidBody = this._owner.rigidBody;\r\n        var options = this._initState = initState || this.getDefaultOptions();\r\n        options.offset = options.offset || [0, 0, 0];\r\n        options.quaternion = options.quaternion || [0, 0, 0, 1];\r\n        this._collider = this.getPhysicWorld().createCollider(rigidBody, this, { type: this._type, options: options });\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    ColliderComponent.prototype.onDestroy = function () {\r\n        var _this = this;\r\n        var physicWorld = this.getPhysicWorld();\r\n        setTimeout(function () {\r\n            if (_this._owner && _this._owner.rigidBody) {\r\n                physicWorld.removeCollider(_this._owner.rigidBody, _this);\r\n            }\r\n        }, 0);\r\n    };\r\n    ColliderComponent.prototype.getDefaultOptions = function () {\r\n        return null;\r\n    };\r\n    ColliderComponent = __decorate([\r\n        SClass({ className: 'ColliderComponent' })\r\n    ], ColliderComponent);\r\n    return ColliderComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`BoxColliderComponent`。\r\n */\r\nfunction isBoxColliderComponent(value) {\r\n    return value.isBoxColliderComponent;\r\n}\r\n/**\r\n * 盒碰撞体，最常见的碰撞体之一。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BoxColliderComponent = /** @class */ (function (_super) {\r\n    __extends(BoxColliderComponent, _super);\r\n    function BoxColliderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBoxColliderComponent = true;\r\n        _this._type = EColliderType.Box;\r\n        return _this;\r\n    }\r\n    BoxColliderComponent.prototype.getDefaultOptions = function () {\r\n        return null;\r\n    };\r\n    BoxColliderComponent = __decorate([\r\n        SClass({ className: 'BoxColliderComponent', classType: 'Collider' })\r\n    ], BoxColliderComponent);\r\n    return BoxColliderComponent;\r\n}(ColliderComponent));\n\n/**\r\n * 判断一个实例是否为`SphereColliderComponent`。\r\n */\r\nfunction isSphereColliderComponent(value) {\r\n    return value.isSphereColliderComponent;\r\n}\r\n/**\r\n * 球碰撞体，最常见的碰撞体之一。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SphereColliderComponent = /** @class */ (function (_super) {\r\n    __extends(SphereColliderComponent, _super);\r\n    function SphereColliderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSphereColliderComponent = true;\r\n        _this._type = EColliderType.Sphere;\r\n        return _this;\r\n    }\r\n    SphereColliderComponent.prototype.getDefaultOptions = function () {\r\n        return null;\r\n    };\r\n    SphereColliderComponent = __decorate([\r\n        SClass({ className: 'SphereColliderComponent', classType: 'Collider' })\r\n    ], SphereColliderComponent);\r\n    return SphereColliderComponent;\r\n}(ColliderComponent));\n\n/**\r\n * 判断一个实例是否为`SceneActor`。\r\n */\r\nfunction isSceneActor$1(value) {\r\n    return value.isSceneActor;\r\n}\r\n/**\r\n * 场景Actor类，如果你想将一个`Actor`放入World(Level)，那么它必须为`SceneActor`。\r\n * 简而言之，这就是一个可以被赋予`transform`的Actor，它的根组件也必须为`SceneComponent`。\r\n *\r\n * @template IOptionTypes 初始化参数类型，必须继承自[ISceneComponentState](../interfaces/iscenecomponentstate)。\r\n * @template TRootComponent 根级组件类型，必须继承自[ISceneComponent](../interfaces/iscenecomponent)。\r\n * @noInheritDoc\r\n */\r\nvar SceneActor = /** @class */ (function (_super) {\r\n    __extends(SceneActor, _super);\r\n    function SceneActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSceneActor = true;\r\n        /**\r\n         * 指定此实例是否为**持久的**，如果是，则此实例可以在关卡切换时被继承，或者在特殊状况时再世界切换时被继承。\r\n         */\r\n        _this.persistent = false;\r\n        _this._rigidBody = null;\r\n        _this._animator = null;\r\n        _this._controller = null;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SceneActor.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例，根据情况不同可能有不同的类型，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._parent;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"transform\", {\r\n        /**\r\n         * 获取自身的`transform`实例引用，本质上是根组件的一个代理。\r\n         */\r\n        get: function () {\r\n            return this._root;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"rigidBody\", {\r\n        /**\r\n         * 获取自身的刚体组件实例引用，需要开启物理引擎并初始化刚体，详见[RigidBodyComponent](../rigidbodycomponent)。\r\n         */\r\n        get: function () {\r\n            return this._rigidBody;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"animator\", {\r\n        /**\r\n         * 获取自身的动画组件实例引用，需要有模型动画或自己创建，详见[AnimatorComponent](../animatorcomponent)。\r\n         */\r\n        get: function () {\r\n            return this._animator;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"layers\", {\r\n        /**\r\n         * 图层属性，详见[Layers](../layers)。\r\n         */\r\n        get: function () {\r\n            return this._root.layers;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"visible\", {\r\n        /**\r\n         * 获取是否可见，代理到根组件的同属性。详见`SceneComponent`的同属性。\r\n         */\r\n        get: function () {\r\n            return this.root.visible;\r\n        },\r\n        /**\r\n         * 设置是否可见，代理到根组件的同属性。详见`SceneComponent`的同属性。\r\n         */\r\n        set: function (value) {\r\n            this.root.visible = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"isStatic\", {\r\n        /**\r\n         * 获取是否为静态对象，代理到根组件的同属性。详见`SceneComponent`的同属性。\r\n         */\r\n        get: function () {\r\n            return this._root.isStatic;\r\n        },\r\n        /**\r\n         * 设置是否为静态对象，代理到根组件的同属性。详见`SceneComponent`的同属性。\r\n         */\r\n        set: function (value) {\r\n            this._root.isStatic = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SceneActor.prototype, \"needReleaseGlRes\", {\r\n        /**\r\n         * 代理到根节点的同名属性，决定其下所有SceneComponent销毁时是否要同时释放Gl资源。\r\n         */\r\n        get: function () {\r\n            return this._root.needReleaseGlRes;\r\n        },\r\n        /**\r\n         * 代理到根节点的同名属性，决定其下所有SceneComponent销毁时是否要同时释放Gl资源。\r\n         */\r\n        set: function (value) {\r\n            this._root.needReleaseGlRes = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，创建默认的`SceneComponent`根组件，可以覆盖。\r\n     */\r\n    SceneActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', SceneComponent, options);\r\n    };\r\n    /**\r\n     * 专属于`SceneActor`的生命周期，一般用于从GlTF模型中实例化对象(使用`resource.instantiate`方法)的情景。\r\n     * 如果不是从资源中实例化的，将按顺序正常触发。\r\n     * 此回调将在真正完成实例化后被触发，时机在`onAdd`之后，确保实例已经完全就绪（包括世界矩阵的首次运算）。\r\n     */\r\n    SceneActor.prototype.onInstantiate = function (options) {\r\n    };\r\n    /**\r\n     * 取消链接，继承请先`super.onUnLink()`。\r\n     */\r\n    SceneActor.prototype.onUnLink = function () {\r\n        this._root.hiloNode.removeFromParent();\r\n    };\r\n    /**\r\n     * 重新链接，继承请先`super.onReLink()`。\r\n     */\r\n    SceneActor.prototype.onReLink = function (parent) {\r\n        if (!isSceneActor$1(parent)) {\r\n            this._root.hiloNode.addTo(parent.game.hiloStage);\r\n        }\r\n    };\r\n    /**\r\n     * 获取自身的`Controller`实例，涉及到玩家系统，详见[Player](./player)。\r\n     */\r\n    SceneActor.prototype.getController = function () {\r\n        return this._controller;\r\n    };\r\n    /**\r\n     * 获取根组件的的包围盒(AABB)信息。\r\n     * @param bounds 当前计算的包围盒信息，可用于节省开销\r\n     * @param currentMatrix 当前计算的矩阵，可用于节省开销\r\n     */\r\n    SceneActor.prototype.getBounds = function (bounds, currentMatrix) {\r\n        return this._root.getBounds(bounds, currentMatrix);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneActor.prototype.added = function () {\r\n        if (this._inWorld) {\r\n            return;\r\n        }\r\n        this._inWorld = true;\r\n        this._linked = true;\r\n        if (isLevel(this._parent)) {\r\n            this._game.hiloStage.addChild(this._root.hiloNode);\r\n        }\r\n        this._components.forEach(function (component) {\r\n            component.added();\r\n        });\r\n        try {\r\n            this.onAdd(this._initOptions);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        if (!(this._initOptions && this._initOptions.__fromGlTF)) {\r\n            this.instantiated();\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneActor.prototype.instantiated = function () {\r\n        this._root.updateMatrixWorld(true);\r\n        try {\r\n            this.onInstantiate(this._initOptions);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SceneActor.prototype.destroy = function () {\r\n        if (this._controller) {\r\n            this._controller.dispossessActor();\r\n        }\r\n        if (this._parent && !isLevel(this._parent)) {\r\n            this._parent.removeActor(this);\r\n        }\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    /**\r\n     * 修改自身的父级实例，通常用于Actor的复用。\r\n     * **注意修改了之后自身的渲染节点也会重新挂载！**\r\n     */\r\n    SceneActor.prototype.changeParent = function (parent) {\r\n        var game = this._game;\r\n        if (isLevel(parent) || isWorld(parent)) {\r\n            if (isLevel(this._parent)) {\r\n                return this;\r\n            }\r\n            this._parent.autoDestroyActor = false;\r\n            this._parent.removeFromParent();\r\n            game.hiloStage.addChild(this._root.hiloNode);\r\n            this._parent = game.level;\r\n            return this;\r\n        }\r\n        if (isLevel(this._parent)) {\r\n            parent.addChild(this);\r\n            return this;\r\n        }\r\n        this._parent.autoDestroyActor = false;\r\n        this._parent.removeFromParent();\r\n        parent.addChild(this);\r\n        return this;\r\n    };\r\n    /**\r\n     * 修改自身的朝向，直接代理到根组件的同名方法。\r\n     */\r\n    SceneActor.prototype.lookAt = function (target) {\r\n        this._root.lookAt(target);\r\n        return this;\r\n    };\r\n    /**\r\n     * 进行一次预渲染，期间会处理Actor下所有Component的材质预编译、资源预提交等。\r\n     */\r\n    SceneActor.prototype.preRender = function () {\r\n        this._components.forEach(function (c) {\r\n            if (isSceneComponent(c)) {\r\n                c.preRender();\r\n            }\r\n        });\r\n    };\r\n    SceneActor = __decorate([\r\n        SClass({ className: 'SceneActor' })\r\n    ], SceneActor);\r\n    return SceneActor;\r\n}(Actor));\n\n/**\r\n * 判断一个实例是否为`PrimitiveComponent`。\r\n */\r\nfunction isPrimitiveComponent(value) {\r\n    return value.isPrimitiveComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`PrimitiveActor`。\r\n */\r\nfunction isPrimitiveActor(value) {\r\n    return isSceneActor$1(value) && isPrimitiveComponent(value.root);\r\n}\r\n/**\r\n * 图元Component类，是拥有图元的组件的基类。\r\n * 这个Component拥有将Mesh添加到World中的能力，基本等同于模型，但一般不直接使用，而是使用其派生的类。\r\n *\r\n * @template IStateTypes 初始化参数类型，必须继承自[IPrimitiveComponentState](../interfaces/iprimitivecomponentstate)。\r\n * @noInheritDoc\r\n */\r\nvar PrimitiveComponent = /** @class */ (function (_super) {\r\n    __extends(PrimitiveComponent, _super);\r\n    function PrimitiveComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPrimitiveComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        _this.__multiPrimitive = false;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    PrimitiveComponent.prototype.onInit = function (state) {\r\n        _super.prototype.onInit.call(this, state);\r\n        this.__multiPrimitive = state.__doNotUseMultiPrimitiveYourself && state.__doNotUseMultiPrimitiveYourself.length > 1;\r\n        if (state.material && state.material.cloneForInst) {\r\n            state.material = state.material.clone();\r\n        }\r\n        var defaultMesh = this._mesh = this.onCreateMesh(state);\r\n        this._mesh.__forceUseParentWorldMatrix = true;\r\n        if (this.__multiPrimitive) {\r\n            this._list = [];\r\n            this._table = {};\r\n            var length_1 = state.__doNotUseMultiPrimitiveYourself.length;\r\n            for (var index = 0; index < length_1; index += 1) {\r\n                var _a = state.__doNotUseMultiPrimitiveYourself[index], geometry = _a.geometry, material = _a.material;\r\n                var mesh = index === 0 ? defaultMesh : this.onCreateMesh({\r\n                    geometry: geometry,\r\n                    material: material.cloneForInst ? material.clone() : material\r\n                });\r\n                mesh.__forceUseParentWorldMatrix = false;\r\n                this._list.push(mesh);\r\n                this._table[material.name] = mesh;\r\n                if (state.frustumTest !== undefined) {\r\n                    mesh.frustumTest = state.frustumTest;\r\n                }\r\n                this._node.addChild(mesh);\r\n            }\r\n        }\r\n        else {\r\n            if (state.frustumTest !== undefined) {\r\n                this._mesh.frustumTest = state.frustumTest;\r\n            }\r\n            this._node.addChild(this._mesh);\r\n        }\r\n        var root = this.getRoot();\r\n        if (root) {\r\n            root.hiloNode.addChild(this._node);\r\n        }\r\n    };\r\n    Object.defineProperty(PrimitiveComponent.prototype, \"material\", {\r\n        /**\r\n         * 获取材质实例引用。\r\n         */\r\n        get: function () {\r\n            return this._mesh.material;\r\n        },\r\n        /**\r\n         * 设置材质。\r\n         */\r\n        set: function (material) {\r\n            this._mesh.material = material;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 当GlTF模型数据中一个Mesh拥有多个Primitive时（对应Unity中一个GameObject拥有多个材质测场景），为了进行对应，一个PrimitiveComponent可能拥有多个Mesh。\r\n     * 这种状况时，你可以通过`materialName`来修改一个具体的材质。**但不提供自行创建这种特殊组件的方式，谨慎使用！务必清楚多材质Mesh等价于多个Mesh！**\r\n     */\r\n    PrimitiveComponent.prototype.setMaterial = function (value, materialName) {\r\n        if (!this.__multiPrimitive) {\r\n            this._mesh.material = value;\r\n            return this;\r\n        }\r\n        if (materialName && this._table[materialName]) {\r\n            this._table[materialName].material = value;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 当GlTF模型数据中一个Mesh拥有多个Primitive时（对应Unity中一个GameObject拥有多个材质测场景），为了进行对应，一个PrimitiveComponent可能拥有多个Mesh。\r\n     * 这种状况时，你可以通过`materialName`来获取一个具体的材质。**但不提供自行创建这种特殊组件的方式，谨慎使用！务必清楚多材质Mesh等价于多个Mesh！**\r\n     */\r\n    PrimitiveComponent.prototype.getMaterial = function (materialName) {\r\n        if (!materialName || !this.__multiPrimitive) {\r\n            return this._mesh.material;\r\n        }\r\n        if (this._table[materialName]) {\r\n            return this._table[materialName].material;\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * 当GlTF模型数据中一个Mesh拥有多个Primitive时（对应Unity中一个GameObject拥有多个材质测场景），为了进行对应，一个PrimitiveComponent可能拥有多个Mesh。\r\n     * 这种状况时，你可以通过此方法获取所有材质。**但不提供自行创建这种特殊组件的方式，谨慎使用！务必清楚多材质Mesh等价于多个Mesh！**\r\n     */\r\n    PrimitiveComponent.prototype.getMaterials = function () {\r\n        return (!this.__multiPrimitive ? [this.material] : this._list.map(function (mesh) { return mesh.material; }));\r\n    };\r\n    Object.defineProperty(PrimitiveComponent.prototype, \"geometry\", {\r\n        /**\r\n         * 设置几何体实例引用。\r\n         */\r\n        get: function () {\r\n            return this._mesh.geometry;\r\n        },\r\n        /**\r\n         * 获取几何体实例引用。\r\n         */\r\n        set: function (geometry) {\r\n            this._mesh.geometry = geometry;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 适用于多图元（材质）Mesh，详细基本等同于`setMaterial`方法。\r\n     */\r\n    PrimitiveComponent.prototype.setGeometry = function (value, materialName) {\r\n        if (!this.__multiPrimitive) {\r\n            this._mesh.geometry = value;\r\n            return this;\r\n        }\r\n        if (materialName && this._table[materialName]) {\r\n            this._table[materialName].geometry = value;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 适用于多图元（材质）Mesh，详细基本等同于`getMaterial`方法。\r\n     */\r\n    PrimitiveComponent.prototype.getGeometry = function (materialName) {\r\n        if (!materialName || !this.__multiPrimitive) {\r\n            return this._mesh.geometry;\r\n        }\r\n        if (this._table[materialName]) {\r\n            return this._table[materialName].geometry;\r\n        }\r\n        return null;\r\n    };\r\n    /**\r\n     * 适用于多图元（材质）Mesh。\r\n     */\r\n    PrimitiveComponent.prototype.getSubMesh = function (materialName) {\r\n        if (!materialName || !this.__multiPrimitive) {\r\n            return this._mesh;\r\n        }\r\n        if (this._table[materialName]) {\r\n            return this._table[materialName];\r\n        }\r\n        return null;\r\n    };\r\n    Object.defineProperty(PrimitiveComponent.prototype, \"frustumTest\", {\r\n        /**\r\n         * 是否需要视椎体裁剪。\r\n         */\r\n        get: function () {\r\n            return this._mesh.frustumTest;\r\n        },\r\n        /**\r\n         * 是否需要视椎体裁剪。\r\n         */\r\n        set: function (value) {\r\n            this.setMeshProperty('frustumTest', value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 进行一次预渲染，期间会处理材质预编译、资源预提交等。\r\n     */\r\n    PrimitiveComponent.prototype.preRender = function () {\r\n        var renderer = this.getGame().renderer;\r\n        if (this.__multiPrimitive) {\r\n            renderer.renderMesh(this._mesh);\r\n            return;\r\n        }\r\n        this._list.forEach(function (mesh) {\r\n            renderer.renderMesh(mesh);\r\n        });\r\n    };\r\n    PrimitiveComponent.prototype.setMeshProperty = function (name, value) {\r\n        if (this.__multiPrimitive) {\r\n            var length_2 = this._list.length;\r\n            for (var index = 0; index < length_2; index += 1) {\r\n                this._list[index][name] = value;\r\n            }\r\n            return;\r\n        }\r\n        this._mesh[name] = value;\r\n    };\r\n    PrimitiveComponent.prototype.onCreateMesh = function (state) {\r\n        return null;\r\n    };\r\n    PrimitiveComponent = __decorate([\r\n        SClass({ className: 'PrimitiveComponent' })\r\n    ], PrimitiveComponent);\r\n    return PrimitiveComponent;\r\n}(SceneComponent));\n\n/**\r\n * 判断一个实例是否为`StaticMeshComponent`。\r\n */\r\nfunction isStaticMeshComponent(value) {\r\n    return value.isStaticMeshComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`StaticMeshActor`。\r\n */\r\nfunction isStaticMeshActor(value) {\r\n    return isSceneActor(value) && isStaticMeshComponent(value.root);\r\n}\r\n/**\r\n * 静态Component类，承载纯粹静态的模型。\r\n *\r\n * @template IStateTypes 初始化参数类型，必须继承自[IStaticMeshComponentState](../interfaces/istaticmeshcomponentstate)。\r\n * @noInheritDoc\r\n */\r\nvar StaticMeshComponent = /** @class */ (function (_super) {\r\n    __extends(StaticMeshComponent, _super);\r\n    function StaticMeshComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isStaticMeshComponent = true;\r\n        return _this;\r\n    }\r\n    StaticMeshComponent.prototype.onCreateMesh = function (state) {\r\n        return new Mesh({\r\n            geometry: state ? state.geometry : null,\r\n            material: state ? state.material : null\r\n        });\r\n    };\r\n    StaticMeshComponent = __decorate([\r\n        SClass({ className: 'StaticMeshComponent' })\r\n    ], StaticMeshComponent);\r\n    return StaticMeshComponent;\r\n}(PrimitiveComponent));\n\n/**\r\n * 判断一个实例是否为`PBRMaterial`。\r\n */\r\nfunction isPBRMaterial(value) {\r\n    return value.isPBRMaterial;\r\n}\r\nvar PBRMaterial = /** @class */ (function (_super) {\r\n    __extends(PBRMaterial, _super);\r\n    function PBRMaterial() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return PBRMaterial;\r\n}(Hilo3d$2.PBRMaterial));\n\n/**\r\n * 判断一个实例是否为`AtlasManager`。\r\n */\r\nfunction isAtlasManager(value) {\r\n    return value.isAtlasManager;\r\n}\r\nfunction isPowerOfTwo$1(x) {\r\n    return (Math.log(x) / Math.log(2)) % 1 === 0;\r\n}\r\n/**\r\n * 图集管理器。\r\n * 一般通过`AtlasLoader`加载自动生成。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar AtlasManager = /** @class */ (function (_super) {\r\n    __extends(AtlasManager, _super);\r\n    /**\r\n     * 构建一个图集。\r\n     *\r\n     * @param options 初始化参数。\r\n     * @param updatable 是否是一个可更新的图集，若不是则不可调用`updateFrame`等方法。注意`updatable`的图集本身容器的宽高都必须为**2的幂！**比如512、1024、2048等等。\r\n     */\r\n    function AtlasManager(options, updatable) {\r\n        if (updatable === void 0) { updatable = true; }\r\n        var _this = _super.call(this) || this;\r\n        _this.isAtlasManager = true;\r\n        _this._AUTO_ID = 0;\r\n        _this._area = 0;\r\n        _this._needReBuild = false;\r\n        /**\r\n         * 纹理提交GPU后是否释放CPU内存\r\n         */\r\n        _this.isImageCanRelease = false;\r\n        _this._frames = options.frames;\r\n        _this._meta = options.meta;\r\n        _this._canvases = {};\r\n        _this._textures = {};\r\n        _this._updatable = updatable;\r\n        if (options.texture) {\r\n            _this._image = options.texture.image;\r\n            _this._texture = options.texture;\r\n        }\r\n        else if (options.image instanceof HTMLCanvasElement) {\r\n            _this._image = options.image;\r\n            _this._ctx = _this._image.getContext('2d');\r\n        }\r\n        else if (updatable) {\r\n            if (Debug.devMode && !(isPowerOfTwo$1(_this._meta.size.w) && isPowerOfTwo$1(_this._meta.size.h))) {\r\n                throw new Error(\"Atlas \" + _this.name + \" is updatable but it size is not power of two !\");\r\n            }\r\n            _this._image = document.createElement('canvas');\r\n            _this._image.width = _this._meta.size.w;\r\n            _this._image.height = _this._meta.size.h;\r\n            _this._ctx = _this._image.getContext('2d');\r\n            _this._ctx.drawImage(options.image, 0, 0);\r\n        }\r\n        else {\r\n            _this._image = options.image;\r\n        }\r\n        return _this;\r\n    }\r\n    AtlasManager_1 = AtlasManager;\r\n    /**\r\n     * 根据宽高创建一个空的图集，可自由申请或释放帧。\r\n     */\r\n    AtlasManager.CREATE_EMPTY = function (options) {\r\n        var width = options.width, height = options.height;\r\n        var canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        var context = canvas.getContext('2d');\r\n        context.fillStyle = 'rgba(255, 255, 255, 0)';\r\n        context.fillRect(0, 0, width, height);\r\n        return new AtlasManager_1({ image: canvas, frames: {}, meta: { size: { w: width, h: height } } }, true);\r\n    };\r\n    /**\r\n     * 根据宽高和行数、列数来创建一个空的图集。\r\n     * 这个图集将被行列分成若干个格子帧，开发者可以根据实际状况去使用`updateFrame`更新这些格子。\r\n     * 自动生成的帧的名字为`${row}${col}`，比如第一行第一列为`'11'`。\r\n     *\r\n     * @param onDraw 初始化时的回调，可以用于一开始绘制图像\r\n     */\r\n    AtlasManager.CREATE_FROM_GRIDS = function (options, onDraw) {\r\n        var width = options.width, height = options.height, rows = options.rows, cols = options.cols, space = options.space;\r\n        space = space || 0;\r\n        var canvas = document.createElement('canvas');\r\n        canvas.width = width;\r\n        canvas.height = height;\r\n        var context = canvas.getContext('2d');\r\n        context.fillStyle = 'rgba(255, 255, 255, 0)';\r\n        context.fillRect(0, 0, width, height);\r\n        var w = ~~(width / cols) - space;\r\n        var h = ~~(height / rows) - space;\r\n        var frames = {};\r\n        for (var row = 0; row < rows; row += 1) {\r\n            for (var col = 0; col < cols; col += 1) {\r\n                var frameName = \"\" + row + col;\r\n                var x = col * (w + space);\r\n                var y = row * (h + space);\r\n                frames[frameName] = {\r\n                    frame: { x: x, y: y, w: w, h: h },\r\n                    space: space\r\n                };\r\n            }\r\n        }\r\n        var atlas = new AtlasManager_1({ image: canvas, frames: frames, meta: { size: { w: width, h: height } } }, true);\r\n        if (onDraw) {\r\n            for (var row = 0; row < rows; row += 1) {\r\n                for (var col = 0; col < cols; col += 1) {\r\n                    var frameName = \"\" + row + col;\r\n                    var _a = atlas.getFrame(frameName), x = _a.x, y = _a.y, w_1 = _a.w, h_1 = _a.h;\r\n                    onDraw(atlas, context, { x: x, y: y, w: w_1, h: h_1, row: row, col: col }, frameName);\r\n                }\r\n            }\r\n        }\r\n        return atlas;\r\n    };\r\n    /**\r\n     * 根据纹理和配置，来通过纹理创建一个不可修改的图集。通常用于精灵动画。\r\n     * 这个图集将被行列分成若干个格子帧，每一帧的名字为`0`、`1`、`2`......\r\n     */\r\n    AtlasManager.CREATE_FROM_TEXTURE = function (texture, options) {\r\n        var w = options.cellWidth;\r\n        var h = options.cellHeight;\r\n        var width = texture.origWidth, height = texture.origHeight;\r\n        var spacing = options.spacing || 0;\r\n        var framesPerLine = options.framesPerLine;\r\n        var frameStart = options.frameStart, frameCount = options.frameCount;\r\n        if (frameStart === undefined) {\r\n            frameStart = 0;\r\n        }\r\n        if (frameCount === undefined) {\r\n            frameCount = Infinity;\r\n        }\r\n        var frames = {};\r\n        var i = frameStart;\r\n        while (true) {\r\n            var row = framesPerLine === 1 ? i : ~~(i / framesPerLine);\r\n            var col = framesPerLine === 1 ? 0 : i % framesPerLine;\r\n            var x = col * (w + spacing);\r\n            var y = row * (h + spacing);\r\n            if (i >= frameCount || (y + h + spacing >= height)) {\r\n                break;\r\n            }\r\n            frames[i] = {\r\n                frame: { x: x, y: y, w: w, h: h }\r\n            };\r\n            i += 1;\r\n        }\r\n        return new AtlasManager_1({ texture: texture, frames: frames, meta: { size: { w: width, h: height } } }, false);\r\n    };\r\n    Object.defineProperty(AtlasManager.prototype, \"image\", {\r\n        /**\r\n         * 获取整体图片数据。\r\n         */\r\n        get: function () {\r\n            return this._image;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AtlasManager.prototype, \"meta\", {\r\n        /**\r\n         * 获取元信息。\r\n         */\r\n        get: function () {\r\n            return this._meta;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AtlasManager.prototype, \"frames\", {\r\n        /**\r\n         * 获取帧集合。\r\n         */\r\n        get: function () {\r\n            return this._frames;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AtlasManager.prototype, \"texture\", {\r\n        /**\r\n         * 获取整体的纹理，也可以使用`getWholeTexture`。\r\n         */\r\n        get: function () {\r\n            return this.getWholeTexture();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AtlasManager.prototype, \"usage\", {\r\n        /**\r\n         * 获取当前图集的使用率，仅在**动态图集**的状况下有效。\r\n         */\r\n        get: function () {\r\n            var _a = this._meta.size, w = _a.w, h = _a.h;\r\n            return this._area / (w * h);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 获取某一帧的数据。\r\n     */\r\n    AtlasManager.prototype.getFrame = function (frameName) {\r\n        return this._frames[frameName].frame;\r\n    };\r\n    /**\r\n     * @deprecated\r\n     *\r\n     * 请用`getUVMatrix`\r\n     * 获取某一帧的uv。\r\n     */\r\n    AtlasManager.prototype.getUV = function (frameName) {\r\n        throw new Error('`getUV` is deprecated, please use `getUVMatrix`!');\r\n    };\r\n    /**\r\n     * 获取某一帧的uv变换矩阵。\r\n     */\r\n    AtlasManager.prototype.getUVMatrix = function (frameName) {\r\n        var f = this._frames[frameName];\r\n        if (!f) {\r\n            throw new Error(\"Frame \" + frameName + \" is not existed!\");\r\n        }\r\n        var uvMatrix = f.uvMatrix, frame = f.frame;\r\n        if (!uvMatrix) {\r\n            f.uvMatrix = this.buildUVMatrix(frame);\r\n        }\r\n        return f.uvMatrix;\r\n    };\r\n    AtlasManager.prototype.buildUVMatrix = function (frame) {\r\n        var _a = this._meta.size, w = _a.w, h = _a.h;\r\n        var matrix = new Matrix3();\r\n        // flipY\r\n        matrix.set(frame.w / w, 0, 0, 0, -frame.h / h, 0, frame.x / w, (frame.y + frame.h) / h, 1);\r\n        return matrix;\r\n    };\r\n    /**\r\n     * 获取某一帧的图片数据，**会创建独立的canvas，慎重使用！**。建议使用`getTexture`。\r\n     */\r\n    AtlasManager.prototype.getFrameImage = function (frameName) {\r\n        if (!this._canvases[frameName]) {\r\n            var canvas = document.createElement('canvas');\r\n            var context = canvas.getContext('2d');\r\n            var _a = this._frames[frameName].frame, x = _a.x, y = _a.y, w = _a.w, h = _a.h;\r\n            canvas.width = w;\r\n            canvas.height = h;\r\n            context.drawImage(this._image, x, y, w, h);\r\n            this._canvases[frameName] = canvas;\r\n        }\r\n        return this._canvases[frameName];\r\n    };\r\n    /**\r\n     * 获取某一帧的纹理数据，**会创建独立的canvas，慎重使用！**。建议使用`getWholeTexture`。\r\n     */\r\n    AtlasManager.prototype.getTexture = function (frameName, options) {\r\n        if (!options && this._textures[frameName]) {\r\n            return this._textures[frameName];\r\n        }\r\n        var frame = this.getFrame(frameName);\r\n        var x = frame.x, y = frame.y, w = frame.w, h = frame.h;\r\n        var image;\r\n        if (this._image instanceof HTMLImageElement) {\r\n            if (!this._tmpCanvas) {\r\n                this._tmpCanvas = document.createElement('canvas');\r\n                this._tmpCanvas.width = this._image.width;\r\n                this._tmpCanvas.height = this._image.height;\r\n            }\r\n            var ctx = this._tmpCanvas.getContext('2d');\r\n            ctx.drawImage(this._image, x, y, w, h, 0, 0, w, h);\r\n            image = ctx.getImageData(0, 0, w, h);\r\n        }\r\n        else if (this._image instanceof HTMLCanvasElement) {\r\n            var ctx = this._image.getContext('2d');\r\n            image = ctx.getImageData(x, y, w, h);\r\n        }\r\n        else {\r\n            Debug.warn(\"Image is 'ArrayBuffer', not support get a frame !\");\r\n        }\r\n        if (options) {\r\n            return new Texture(__assign({ image: image, isImageCanRelease: this.isImageCanRelease }, options));\r\n        }\r\n        this._textures[frameName] = new Texture({ image: image, isImageCanRelease: this.isImageCanRelease });\r\n        return this._textures[frameName];\r\n    };\r\n    /**\r\n     * 获取整体纹理数据，建议配合`getFrame`或`getUVMatrix`在shader中使用。\r\n     */\r\n    AtlasManager.prototype.getWholeTexture = function (options) {\r\n        if (options) {\r\n            if (this._texture) {\r\n                this._texture.destroy();\r\n            }\r\n            return this._texture = new Texture(__assign({ image: this._image, isImageCanRelease: this.isImageCanRelease }, options));\r\n        }\r\n        if (!this._texture) {\r\n            this._texture = new Texture({ image: this._image, isImageCanRelease: this.isImageCanRelease });\r\n        }\r\n        return this._texture;\r\n    };\r\n    /**\r\n     * 更新某一frame，通过`onDraw`方法参数中的`context`和`region`来更新`canvas`画布上此帧所占据区域内的图像，并同步到GPU。\r\n     */\r\n    AtlasManager.prototype.updateFrame = function (frameName, onDraw) {\r\n        if (!this._updatable) {\r\n            throw new Error(\"Atlas \" + this.name + \" is not updatable !\");\r\n        }\r\n        if (this._canvases[frameName]) {\r\n            delete this._canvases[frameName];\r\n        }\r\n        if (this._textures[frameName]) {\r\n            delete this._textures[frameName];\r\n        }\r\n        var _a = this.getFrame(frameName), x = _a.x, y = _a.y, w = _a.w, h = _a.h;\r\n        onDraw(this._ctx, { x: x, y: y, w: w, h: h }, frameName);\r\n        this.updateGlSubBuffer(x, y, w, h);\r\n    };\r\n    /**\r\n     * 申请分配指定的`region`大小的一帧，其中`frameName`是你想要赋予的名字，若不传会自动生成。\r\n     * 如果分配成功，则会通过`onDraw`的参数返回`context`、实际区域`region`和被分配的帧名`frameName`，你可以在这个方法中绘制。\r\n     *\r\n     * @returns [string] 若成功，将返回分配的`frame`的名字，否则返回`null`。\r\n     */\r\n    AtlasManager.prototype.allocateFrame = function (region, onDraw) {\r\n        if (!this._updatable) {\r\n            throw new Error(\"Atlas \" + this.name + \" is not updatable !\");\r\n        }\r\n        var frameName = region.frameName;\r\n        if (frameName && this._frames[frameName]) {\r\n            throw new Error(\"Frame named \" + frameName + \" is not already existed !\");\r\n        }\r\n        if (this._needReBuild) {\r\n            this.rebuildFrames();\r\n        }\r\n        frameName = this.generateFrame(this._root, region);\r\n        if (!frameName) {\r\n            return null;\r\n        }\r\n        this._area += region.w * region.h;\r\n        if (onDraw) {\r\n            var _a = this.getFrame(frameName), x = _a.x, y = _a.y, w = _a.w, h = _a.h;\r\n            onDraw(this._ctx, { x: x, y: y, w: w, h: h }, frameName);\r\n            this.updateGlSubBuffer(x, y, w, h);\r\n        }\r\n        return frameName;\r\n    };\r\n    AtlasManager.prototype.generateFrame = function (rootFrame, region, bottom) {\r\n        var w = region.w, h = region.h, _a = region.space, space = _a === void 0 ? 0 : _a, frameName = region.frameName;\r\n        var size = this._meta.size;\r\n        if (bottom === undefined) {\r\n            bottom = this._meta.size.h;\r\n        }\r\n        if (!this._root) {\r\n            return this._root = this.addFrame(0, 0, w, h, frameName);\r\n        }\r\n        var root = this._frames[rootFrame];\r\n        var right = root.right, down = root.down, frame = root.frame;\r\n        var x = frame.x + frame.w + space;\r\n        var y = frame.y + frame.h + space;\r\n        var aW = size.w - x;\r\n        var aH = bottom - y;\r\n        if (!right && !down && w <= aW && h <= frame.h) {\r\n            return root.right = this.addFrame(x, frame.y, w, h, frameName, space);\r\n        }\r\n        if (!right && w <= aW && h <= frame.h) {\r\n            return root.right = this.addFrame(x, frame.y, w, h, frameName, space);\r\n        }\r\n        if (!down && w <= (size.w - frame.x) && h <= aH) {\r\n            return root.down = this.addFrame(frame.x, y, w, h, frameName, space);\r\n        }\r\n        if (right && (frameName = this.generateFrame(right, region, y))) {\r\n            return frameName;\r\n        }\r\n        if (down && (frameName = this.generateFrame(down, region, bottom))) {\r\n            return frameName;\r\n        }\r\n        return null;\r\n    };\r\n    AtlasManager.prototype.rebuildFrames = function () {\r\n        var _this = this;\r\n        var size = this._meta.size;\r\n        if (!this._tmpCanvas) {\r\n            var tmp = this._tmpCanvas = document.createElement('canvas');\r\n            tmp.width = size.w;\r\n            tmp.height = size.h;\r\n        }\r\n        var tmpCtx = this._tmpCanvas.getContext('2d');\r\n        tmpCtx.drawImage(this._image, 0, 0);\r\n        this._ctx.clearRect(0, 0, size.w, size.h);\r\n        this._ctx.fillStyle = 'rgba(255, 255, 255, 0)';\r\n        this._ctx.fillRect(0, 0, size.w, size.h);\r\n        var frames = Object.assign({}, this._frames);\r\n        this._frames = {};\r\n        this._root = null;\r\n        var keys = Object.keys(frames).sort(function (a, b) {\r\n            return frames[b].frame.h - frames[a].frame.h;\r\n        });\r\n        keys.forEach(function (frameName) {\r\n            var frame = frames[frameName];\r\n            var _a = frame.frame, w = _a.w, h = _a.h;\r\n            _this.generateFrame(_this._root, { w: w, h: h, frameName: frameName, space: frame.space });\r\n            var _b = _this._frames[frameName].frame, x = _b.x, y = _b.y;\r\n            var orig = frames[frameName].frame;\r\n            _this._ctx.drawImage(_this._tmpCanvas, orig.x, orig.y, w, h, x, y, w, h);\r\n        });\r\n        this.updateGlSubBuffer(0, 0, size.w, size.h);\r\n        this._needReBuild = false;\r\n    };\r\n    AtlasManager.prototype.addFrame = function (x, y, w, h, frameName, space) {\r\n        frameName = frameName || \"AUTO-\" + this._AUTO_ID++;\r\n        this._frames[frameName] = { frame: { x: x, y: y, w: w, h: h }, space: space };\r\n        return frameName;\r\n    };\r\n    /**\r\n     * 释放一帧的空间，将其标记为可分配状态。\r\n     */\r\n    AtlasManager.prototype.releaseFrame = function (frameName) {\r\n        if (!this._updatable) {\r\n            throw new Error(\"Atlas \" + this.name + \" is not updatable !\");\r\n        }\r\n        var frame = this._frames[frameName];\r\n        if (frame) {\r\n            if (this._texture[frameName]) {\r\n                this._texture.destroy();\r\n            }\r\n            if (this._canvases[frameName]) {\r\n                delete this._canvases[frameName];\r\n            }\r\n            delete this._frames[frameName];\r\n            this._area -= frame.frame.h * frame.frame.w;\r\n            this._needReBuild = true;\r\n        }\r\n    };\r\n    AtlasManager.prototype.updateGlSubBuffer = function (x, y, w, h) {\r\n        if (!this._texture) {\r\n            return;\r\n        }\r\n        this._texture.updateSubTexture(x, this._texture.flipY ? this._meta.size.h - y - h : y, this._ctx.getImageData(x, y, w, h));\r\n    };\r\n    /**\r\n     * 完全销毁释放图集。\r\n     */\r\n    AtlasManager.prototype.destroy = function () {\r\n        for (var key in this._textures) {\r\n            this._textures[key].destroy();\r\n        }\r\n        if (this._texture) {\r\n            this._texture.destroy();\r\n        }\r\n    };\r\n    var AtlasManager_1;\r\n    AtlasManager = AtlasManager_1 = __decorate([\r\n        SClass({ className: 'AtlasManager' })\r\n    ], AtlasManager);\r\n    return AtlasManager;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`LazyTexture`。\r\n */\r\nfunction isLazyTexture(value) {\r\n    return value.isLazyTexture;\r\n}\r\nvar LazyTexture = /** @class */ (function (_super) {\r\n    __extends(LazyTexture, _super);\r\n    function LazyTexture() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return LazyTexture;\r\n}(Hilo3d$2.LazyTexture));\n\n/**\r\n * @hidden\r\n */\r\nvar getDefaultParse = function (name) { return function (info, parser, node) {\r\n    if (node) {\r\n        node.gltfExtensions = node.gltfExtensions || {};\r\n        node.gltfExtensions[name] = info;\r\n        return node;\r\n    }\r\n}; };\r\n/**\r\n * 模型解压缩扩展的配置实例。\r\n */\r\nvar AliAMCExtension = Hilo3d$2.AliAMCExtension;\r\n/**\r\n * @hidden\r\n */\r\nvar SeinNodeExtension = {\r\n    name: 'Sein_node',\r\n    optionParsers: {},\r\n    registerOptionParsers: function (type, parser) {\r\n        SeinNodeExtension.optionParsers[type] = parser;\r\n    },\r\n    unregisterOptionParsers: function (type) {\r\n        delete SeinNodeExtension.optionParsers[type];\r\n    },\r\n    parseOption: function (option, parser, info) {\r\n        var type = option.type, value = option.value;\r\n        if (type && SeinNodeExtension.optionParsers[type]) {\r\n            return SeinNodeExtension.optionParsers[type](value, parser, info);\r\n        }\r\n        else {\r\n            throw new Error(\"You must register parser for type '\" + type + \"' in Sein_node.initOptions !\");\r\n        }\r\n    },\r\n    parse: function (info, parser, node, options) {\r\n        node.gltfExtensions = node.gltfExtensions || {};\r\n        node.gltfExtensions[SeinNodeExtension.name] = info;\r\n        if (!info.initOptions) {\r\n            return node;\r\n        }\r\n        var initOptions = info.initOptions;\r\n        Object.keys(initOptions).forEach(function (name) {\r\n            initOptions[name] = SeinNodeExtension.parseOption(initOptions[name], parser, info);\r\n        });\r\n        return node;\r\n    },\r\n    instantiate: function (entity, info) {\r\n        if (info.updateOnEverTick !== undefined) {\r\n            entity.updateOnEverTick = info.updateOnEverTick;\r\n        }\r\n        if (info.neverTransform !== undefined) {\r\n            entity.isStatic = info.neverTransform;\r\n        }\r\n        if (isSceneActor(entity)) {\r\n            if (info.tag) {\r\n                entity.tag = new SName(info.tag);\r\n            }\r\n            if (info.layers) {\r\n                entity.layers.set(info.layers);\r\n            }\r\n            if (info.persistent !== undefined) {\r\n                entity.persistent = info.persistent;\r\n            }\r\n            if (info.emitComponentsDestroy !== undefined) {\r\n                entity.emitComponentsDestroy = info.emitComponentsDestroy;\r\n            }\r\n        }\r\n    }\r\n};\r\n['Float', 'Int', 'String', 'Bool'].forEach(function (type) {\r\n    SeinNodeExtension.registerOptionParsers(type, function (value) { return value; });\r\n});\r\nSeinNodeExtension.registerOptionParsers('Vec2', function (value) { return new Vector2().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Vec3', function (value) { return new Vector3().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Vec4', function (value) { return new Vector4().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Mat4', function (value) { return new Matrix4().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Quat', function (value) { return new Quaternion().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Color', function (value) { return new Color().fromArray(value); });\r\nSeinNodeExtension.registerOptionParsers('Tex2D', function (value, parser) { return parser.textures[value.index]; });\r\nSeinNodeExtension.registerOptionParsers('TexCube', function (value, parser) { return parser.cubeTextures[value.index]; });\r\nSeinNodeExtension.registerOptionParsers('Atlas', function (value, parser) { return parser.atlases[value.index]; });\r\nSeinNodeExtension.registerOptionParsers('Mat', function (value, parser) { return parser.materials[value.index]; });\r\nSeinNodeExtension.registerOptionParsers('Array', function (value, parser, info) {\r\n    return value.map(function (v) { return SeinNodeExtension.parseOption(v, parser, info); });\r\n});\r\nSeinNodeExtension.registerOptionParsers('Object', function (value, parser, info) {\r\n    var result = {};\r\n    Object.keys(value).forEach(function (name) {\r\n        result[name] = SeinNodeExtension.parseOption(value[name], parser, info);\r\n    });\r\n    return result;\r\n});\r\n/**\r\n * @hidden\r\n */\r\nvar SeinPhysicBodyExtension = {\r\n    name: 'Sein_physicBody',\r\n    instantiate: function (entity, info, game) {\r\n        if (!isSceneActor(entity)) {\r\n            Debug.warn(\"You could not add physicBody to a component: \" + entity.name + \", ignore...\");\r\n            return;\r\n        }\r\n        var physicBody = info;\r\n        if (!game.world.physicWorld) {\r\n            Debug.warn(\"Model \" + entity.name + \" in gltf file has physicBody, but \\\"PhysicWorld\\\" is not found in current world, ignore...\");\r\n            return;\r\n        }\r\n        var body = entity.addComponent('rigidBody', RigidBodyComponent, {\r\n            mass: physicBody.mass,\r\n            friction: physicBody.friction,\r\n            restitution: physicBody.restitution,\r\n            unControl: physicBody.unControl,\r\n            physicStatic: physicBody.physicStatic\r\n        });\r\n        if (info.sleeping) {\r\n            entity.rigidBody.sleep();\r\n        }\r\n        physicBody.colliders.forEach(function (collider, index) {\r\n            var name = \"collider-\" + (collider.name || (collider.type + index));\r\n            switch (collider.type) {\r\n                case 'BOX':\r\n                    entity.addComponent(name, BoxColliderComponent, collider);\r\n                    break;\r\n                case 'SPHERE':\r\n                    entity.addComponent(name, SphereColliderComponent, collider);\r\n                    break;\r\n            }\r\n        });\r\n        if (physicBody.colliders.length) {\r\n            body.forceSync();\r\n        }\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinAnimatorExtension = {\r\n    name: 'Sein_animator',\r\n    instantiate: function (entity) {\r\n        if (!isSceneActor(entity)) {\r\n            Debug.warn(\"You could not add animator to a component: \" + entity.name + \", ignore...\");\r\n            return;\r\n        }\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinRendererExtension = {\r\n    name: 'Sein_renderer',\r\n    parseOnLoad: function (info, parser) {\r\n        parser['renderer'] = parser.json.extensions.Sein_renderer || {};\r\n    },\r\n    parseOnEnd: function (info, parser, model) {\r\n        model['renderer'] = parser['renderer'];\r\n        return model;\r\n    },\r\n    instantiate: function (entity, info, _, __, resource) {\r\n        var root = isSceneActor(entity) ? entity.root : entity;\r\n        if (!isStaticMeshComponent(root) && !isPrimitiveComponent(root)) {\r\n            return;\r\n        }\r\n        root.getMaterials().forEach(function (material) {\r\n            if (isStaticMeshComponent(root) && info.lightMap) {\r\n                var matName = material.name;\r\n                material = material.clone();\r\n                root.setMaterial(material, matName);\r\n                var _a = info.lightMap, lightMapIndex = _a.lightMapIndex, uvChannel = _a.uvChannel, uvRotation = _a.uvRotation, uvScale = _a.uvScale, uvOffset = _a.uvOffset;\r\n                var texture = resource.textures[lightMapIndex];\r\n                texture.uv = uvChannel;\r\n                if (isPBRMaterial(material)) {\r\n                    material.lightMap = texture;\r\n                }\r\n                else if (isRawShaderMaterial(material)) {\r\n                    material.setUniform('u_lightMap', texture);\r\n                }\r\n                if (uvChannel === 0) {\r\n                    material.uvMatrix = new Matrix3().fromRotationTranslationScale(uvRotation, uvOffset[0], uvOffset[1], uvScale[0], uvScale[1]);\r\n                }\r\n                else {\r\n                    material.uvMatrix1 = new Matrix3().fromRotationTranslationScale(uvRotation, uvOffset[0], uvOffset[1], uvScale[0], uvScale[1]);\r\n                }\r\n            }\r\n            material.receiveShadows = info.castShadows || false;\r\n            material.castShadows = info.receiveShadows || false;\r\n            material.gammaCorrection = info.gammaCorrection || false;\r\n            var globalSetting = resource['renderer'];\r\n            if (globalSetting) {\r\n                material.gammaCorrection = globalSetting.gammaCorrection || false;\r\n                material.useHDR = globalSetting.useHDR || false;\r\n                material.exposure = globalSetting.exposure ? material.exposure : globalSetting.exposure;\r\n            }\r\n        });\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinAmbientLightExtension = {\r\n    name: 'Sein_ambientLight',\r\n    parseOnEnd: function (info, parser, model) {\r\n        var color = info.color, intensity = info.intensity;\r\n        var light = new Hilo3d$2.AmbientLight({\r\n            name: 'gltf-ambientLight-extension',\r\n            color: new Color(color[0], color[1], color[2]),\r\n            amount: intensity\r\n        });\r\n        model['ambientLight'] = light;\r\n        return model;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nfunction getRelativePath(basePath, path) {\r\n    if (/^(?:http|blob|data:|\\/)/.test(path)) {\r\n        return path;\r\n    }\r\n    var basePaths = basePath.replace(/\\/[^/]*?$/, '').split('/');\r\n    var paths = path.split('/');\r\n    var i = 0;\r\n    for (i = 0; i < paths.length; i += 1) {\r\n        var p = paths[i];\r\n        if (p === '..') {\r\n            basePaths.pop();\r\n        }\r\n        else if (p !== '.') {\r\n            break;\r\n        }\r\n    }\r\n    return basePaths.join('/') + '/' + paths.slice(i).join('/');\r\n}\r\n/**\r\n * @hidden\r\n */\r\nvar SeinCubeTextureExtension = {\r\n    name: 'Sein_cubeTexture',\r\n    init: function (_, parser) {\r\n        var game = parser.game;\r\n        var actions = [];\r\n        var extensions = parser.json.extensions || {};\r\n        var source = extensions.Sein_cubeTexture || {};\r\n        var textures = source.textures || [];\r\n        var cubeTextures = [];\r\n        parser.cubeTextures = cubeTextures;\r\n        textures.forEach(function (tex, index) {\r\n            var images = tex.images.map(function (imageIndex) {\r\n                var uri = parser.getImageUri(imageIndex);\r\n                uri = getRelativePath(parser.src, uri);\r\n                return uri;\r\n            });\r\n            actions.push(Promise.resolve().then(function () { return new Promise(function (resolve, reject) {\r\n                var format = /\\.png$/.test(images[0]) ? Constants.RGBA : Constants.RGB;\r\n                game.resource.getLoader('CubeTexture').load({\r\n                    type: 'CubeTexture', url: '', images: {\r\n                        right: images[0],\r\n                        left: images[1],\r\n                        top: images[2],\r\n                        bottom: images[3],\r\n                        front: images[4],\r\n                        back: images[5]\r\n                    },\r\n                    name: '',\r\n                    format: format,\r\n                    internalFormat: format,\r\n                    isImageCanRelease: tex.isImageCanRelease\r\n                }, {\r\n                    onLoading: function (_, progress) { },\r\n                    onLoaded: function (entity) {\r\n                        var cubeTex = entity.result;\r\n                        var sampler = parser.json.samplers[tex.sampler];\r\n                        cubeTextures[index] = cubeTex;\r\n                        cubeTex.minFilter = sampler.minFilter || cubeTex.minFilter;\r\n                        cubeTex.magFilter = sampler.magFilter || cubeTex.magFilter;\r\n                        cubeTex.wrapS = sampler.wrapS || cubeTex.wrapS;\r\n                        cubeTex.wrapT = sampler.wrapT || cubeTex.wrapT;\r\n                        resolve();\r\n                    },\r\n                    onError: function (_, error) { return reject(error); }\r\n                });\r\n            }); }));\r\n        });\r\n        return Promise.all(actions);\r\n    },\r\n    parseOnEnd: function (info, parser, model) {\r\n        model.cubeTextures = parser.cubeTextures;\r\n        return model;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinImageBasedLightingExtension = {\r\n    name: 'Sein_imageBasedLighting',\r\n    init: function (_, parser) {\r\n        var game = parser.game;\r\n        var extensions = parser.json.extensions || {};\r\n        var iblSources = extensions.Sein_imageBasedLighting || {};\r\n        var lights = iblSources.lights || [];\r\n        var imageBasedLights = [];\r\n        parser.imageBasedLights = imageBasedLights;\r\n        lights.forEach(function (light, index) {\r\n            imageBasedLights.push({\r\n                diffuse: {\r\n                    type: light.diffuse.type,\r\n                    intensity: light.diffuse.intensity,\r\n                    coefficients: new SphericalHarmonics3().fromArray(light.diffuse.coefficients),\r\n                },\r\n                specular: light.specular ? {\r\n                    type: light.specular.type,\r\n                    intensity: light.specular.intensity,\r\n                    brdfLUTIndex: light.specular.brdfLUT.index,\r\n                    includeMipmaps: light.specular.includeMipmaps,\r\n                    brdfLUT: null,\r\n                    cubeMap: null\r\n                } : null\r\n            });\r\n            var specular = imageBasedLights[index].specular;\r\n            if (!specular) {\r\n                return;\r\n            }\r\n            specular.mapIndex = light.specular.map.index;\r\n        });\r\n    },\r\n    parseOnLoad: function (info, parser) {\r\n        parser.imageBasedLights.forEach(function (light) {\r\n            if (!light.specular) {\r\n                return;\r\n            }\r\n            light.specular.brdfLUT = parser.textures[light.specular.brdfLUTIndex];\r\n            if (light.specular.type == '2D') {\r\n                light.specular.map = parser.textures[light.specular.mapIndex];\r\n            }\r\n            else {\r\n                light.specular.map = parser.cubeTextures[light.specular.mapIndex];\r\n            }\r\n        });\r\n    },\r\n    parseOnEnd: function (info, parser, model) {\r\n        model.imageBasedLights = parser.imageBasedLights;\r\n        return model;\r\n    },\r\n    parse: function (info, parser, entity) {\r\n        // material extension\r\n        var material = entity;\r\n        var lIndex = info.light, type = info.type;\r\n        var light = parser.imageBasedLights[lIndex];\r\n        if (isPBRMaterial(material)) {\r\n            // (material as any).isDiffuseEnvAndAmbientLightWorkTogether = true;\r\n            if (type == 'ALL') {\r\n                material.brdfLUT = light.specular.brdfLUT;\r\n                material.specularEnvIntensity = light.specular.intensity;\r\n                material.specularEnvMap = light.specular.map;\r\n                material.isSpecularEnvMapIncludeMipmaps = light.specular.includeMipmaps;\r\n            }\r\n            material.diffuseEnvIntensity = light.diffuse.intensity;\r\n            if (light.diffuse.type == 'SH') {\r\n                material.diffuseEnvSphereHarmonics3 = light.diffuse.coefficients;\r\n            }\r\n        }\r\n        else if (isRawShaderMaterial(material)) {\r\n            /**\r\n             * @todo: support SeinCustomMaterial\r\n             */\r\n            if (type == 'ALL') {\r\n                material.setUniform('u_brdfLUT', light.specular.brdfLUT);\r\n                material.setUniform('u_specularEnvIntensity', light.specular.intensity);\r\n                material.setUniform('u_specularEnvMap', light.specular.map);\r\n                material.isSpecularEnvMapIncludeMipmaps = light.specular.includeMipmaps;\r\n            }\r\n            material.setUniform('u_diffuseEnvIntensity', light.diffuse.intensity);\r\n            if (light.diffuse.type == 'SH') {\r\n                material.setUniform('u_diffuseEnvSphereHarmonics3', light.diffuse.coefficients);\r\n            }\r\n        }\r\n        return material;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinAtlasExtension = {\r\n    name: 'Sein_atlas',\r\n    init: function (_, parser) {\r\n        var game = parser.game;\r\n        var actions = [];\r\n        var extensions = parser.json.extensions || {};\r\n        var ex = extensions.Sein_atlas || {};\r\n        var atlasesSource = ex.atlases || [];\r\n        var atlases = [];\r\n        parser.atlases = atlases;\r\n        atlasesSource.forEach(function (atlas, index) {\r\n            atlases.push(null);\r\n            actions.push(Promise.resolve().then(function () { return new Promise(function (resolve, reject) {\r\n                var source = atlas.meta.image.index;\r\n                var uri = parser.getImageUri(source);\r\n                var texture = new LazyTexture();\r\n                texture.uv = undefined;\r\n                texture.crossOrigin = true;\r\n                texture.autoLoad = false;\r\n                texture.resType = parser.getImageType(source);\r\n                texture.src = uri;\r\n                texture.name = atlas.name;\r\n                texture.isImageCanRelease = atlas.isImageCanRelease;\r\n                var OnTextureLoad = function (error) {\r\n                    texture.off('load', OnTextureLoad);\r\n                    texture.off('error', OnTextureLoad);\r\n                    if (error) {\r\n                        return reject(error);\r\n                    }\r\n                    atlases[index] = new AtlasManager({ texture: texture, frames: atlas.frames, meta: atlas.meta }, false);\r\n                    atlases[index].name = new SName(atlas.name);\r\n                    atlases[index].isImageCanRelease = atlas.isImageCanRelease;\r\n                    resolve();\r\n                };\r\n                texture.on('load', function () { return OnTextureLoad(); });\r\n                texture.on('error', function (error) { return OnTextureLoad(error); });\r\n                texture.load(true);\r\n            }); }));\r\n        });\r\n        return Promise.all(actions);\r\n    },\r\n    parseOnEnd: function (info, parser, model) {\r\n        model.atlases = parser.atlases;\r\n        return model;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n *\r\n * 这里的扩展仅仅是全局用于加载材质脚本的。\r\n */\r\nvar SeinCustomMaterialExtension = {\r\n    name: 'Sein_customMaterial',\r\n    cache: {},\r\n    init: function (_, parser) {\r\n        var actions = [];\r\n        var extensions = parser.json.extensions || {};\r\n        var ex = extensions.Sein_customMaterial || {};\r\n        var scripts = ex.scripts || [];\r\n        parser.scripts = scripts;\r\n        scripts.forEach(function (script, index) {\r\n            var url = script.uri;\r\n            if (SeinCustomMaterialExtension.cache[url]) {\r\n                return;\r\n            }\r\n            SeinCustomMaterialExtension.cache[url] = true;\r\n            url = getRelativePath(parser.src, url);\r\n            actions.push(new Promise(function (resolve, reject) {\r\n                var s = document.createElement('script');\r\n                s.onload = function () { return resolve(); };\r\n                s.onerror = function (error) { return reject(error); };\r\n                s.src = url;\r\n                document.head.append(s);\r\n            }));\r\n        });\r\n        return Promise.all(actions);\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar FakeHiloSprite = /** @class */ (function (_super) {\r\n    __extends(FakeHiloSprite, _super);\r\n    function FakeHiloSprite() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.className = 'FakeHiloSprite';\r\n        _this.isFakeHiloSprite = true;\r\n        return _this;\r\n    }\r\n    return FakeHiloSprite;\r\n}(Hilo3d$2.Node));\r\n/**\r\n * @hidden\r\n */\r\nvar SeinSpriteExtension = {\r\n    name: 'Sein_sprite',\r\n    init: function (_, parser) {\r\n        var extensions = parser.json.extensions || {};\r\n        var ex = extensions.Sein_sprite || {};\r\n        parser.sprites = (ex.sprites || []).map(function (sprite) {\r\n            var res = new FakeHiloSprite();\r\n            res.sprite = sprite;\r\n            return res;\r\n        });\r\n    },\r\n    parseOnEnd: function (info, parser, model) {\r\n        model['sprites'] = parser.sprites;\r\n        parser.sprites.forEach(function (sp) {\r\n            if (sp.sprite.material) {\r\n                sp.material = parser.materials[sp.sprite.material.index];\r\n            }\r\n        });\r\n        return model;\r\n    },\r\n    parse: function (info, parser, entity) {\r\n        var node = entity;\r\n        node.addChild(parser.sprites[info.index]);\r\n        return node;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinSkyboxExtension = {\r\n    name: 'Sein_skybox',\r\n    parse: function (info, parser, entity) {\r\n        var camera = entity;\r\n        var material = new SkyboxMaterial({\r\n            type: info.type,\r\n            uniforms: {\r\n                u_color: { value: new Color().fromArray(info.color) },\r\n                u_factor: { value: info.factor },\r\n                u_texture: info.texture && { value: info.type === 'Panoramic' ? parser.textures[info.texture.index] : parser.cubeTextures[info.texture.index] },\r\n                u_rotation: info.rotation !== undefined && { value: info.rotation },\r\n                u_exposure: info.exposure !== undefined && { value: info.exposure },\r\n                u_degrees: info.degrees !== undefined && { value: info.degrees },\r\n            }\r\n        });\r\n        var globalSetting = parser.renderer;\r\n        if (globalSetting) {\r\n            material.gammaCorrection = globalSetting.gammaCorrection || false;\r\n            material.useHDR = globalSetting.useHDR || false;\r\n            material.exposure = globalSetting.exposure ? material.exposure : globalSetting.exposure;\r\n        }\r\n        camera.backgroundMat = material;\r\n        return camera;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar SeinTextureImproveExtension = {\r\n    name: 'Sein_textureImprove',\r\n    parse: function (info, parser, texture) {\r\n        texture.isImageCanRelease = info.isImageCanRelease;\r\n        texture.anisotropic = info.anisotropic || texture.anisotropic;\r\n        texture.type = info.textureType || texture.type;\r\n        return texture;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nfunction parse(info, parser, material, options) {\r\n    if (options.isGlobalExtension) {\r\n        return null;\r\n    }\r\n    var textures = parser.textures || [];\r\n    var techniqueInfo = parser.techniques[info.technique];\r\n    if (!techniqueInfo) {\r\n        return null;\r\n    }\r\n    var programInfo = parser.programs[techniqueInfo.program];\r\n    if (!programInfo) {\r\n        return null;\r\n    }\r\n    var fragmentText = parser.shaders[programInfo.fragmentShader];\r\n    var vertexText = parser.shaders[programInfo.vertexShader];\r\n    var uniformsInfo = techniqueInfo.uniforms || {};\r\n    var attributesInfo = techniqueInfo.attributes || {};\r\n    var valuesInfo = info.values || {};\r\n    var attributes = {};\r\n    var uniforms = {};\r\n    for (var uniformName in uniformsInfo) {\r\n        var uniformDef = uniformsInfo[uniformName] || {};\r\n        var uniformValue = valuesInfo[uniformName] !== undefined ? valuesInfo[uniformName] : uniformDef.value;\r\n        var uniformObject = void 0;\r\n        if (uniformValue !== undefined) {\r\n            if (uniformDef.type === Constants.SAMPLER_2D) {\r\n                var textureIndex = uniformValue.index || 0;\r\n                uniformObject = { value: textures[textureIndex] };\r\n            }\r\n            else {\r\n                uniformObject = { value: uniformValue };\r\n            }\r\n        }\r\n        else if (uniformDef.semantic && Hilo3d$2.semantic[uniformDef.semantic]) {\r\n            // const semanticFunc = Hilo3d.semantic[uniformDef.semantic];\r\n            // const nodeIndex = uniformDef.node;\r\n            // let node;\r\n            // if (nodeIndex !== undefined) {\r\n            //   uniformObject = {\r\n            //     get(mesh, material, programInfo) {\r\n            //       if (node === undefined) {\r\n            //         node = parser.node.getChildByFn((node) => {\r\n            //           return node.animationId === nodeIndex;\r\n            //         }) || mesh;\r\n            //       }\r\n            //       return semanticFunc.get(node, material, programInfo);\r\n            //     }\r\n            //   };\r\n            // } else {\r\n            //   uniformObject = uniformDef.semantic;\r\n            // }\r\n            uniformObject = uniformDef.semantic;\r\n        }\r\n        else {\r\n            uniformObject = Hilo3d$2.semantic.blankInfo;\r\n        }\r\n        uniforms[uniformName] = uniformObject;\r\n    }\r\n    for (var attributeName in attributesInfo) {\r\n        var attributeValue = attributesInfo[attributeName] || {};\r\n        if (attributeValue.semantic) {\r\n            attributes[attributeName] = attributeValue.semantic;\r\n        }\r\n    }\r\n    var shaderMaterial = new RawShaderMaterial({\r\n        vs: vertexText,\r\n        fs: fragmentText,\r\n        attributes: attributes,\r\n        uniforms: uniforms\r\n    });\r\n    return shaderMaterial;\r\n}\r\nHilo3d$2.GLTFExtensions.KHR_techniques_webgl.parse = parse;\n\n/**\r\n * 判断一个实例是否为`SkeletalMesh`。\r\n */\r\nfunction isSkeletalMesh(value) {\r\n    return value.isSkeletalMesh;\r\n}\r\n/**\r\n * 带有骨骼的曲面类。封装几何体`Geometry`和材质`Material`。\r\n */\r\nvar SkeletalMesh = /** @class */ (function (_super) {\r\n    __extends(SkeletalMesh, _super);\r\n    function SkeletalMesh() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSkeletalMesh = true;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 获取指定类型的材质。\r\n     */\r\n    SkeletalMesh.prototype.getMaterial = function () {\r\n        return this.material;\r\n    };\r\n    /**\r\n     * 克隆。\r\n     */\r\n    SkeletalMesh.prototype.clone = function (isChild) {\r\n        return _super.prototype.clone.call(this, isChild);\r\n    };\r\n    return SkeletalMesh;\r\n}(Hilo3d$2.SkinedMesh));\n\n/**\r\n * 判断一个实例是否为`SkeletalMeshComponent`。\r\n */\r\nfunction isSkeletalMeshComponent(value) {\r\n    return value.isSkeletalMeshComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`SkeletalMeshActor`。\r\n */\r\nfunction isSkeletalMeshActor(value) {\r\n    return isSceneActor(value) && isSkeletalMeshComponent(value.root);\r\n}\r\n/**\r\n * 骨架Component类，是拥有骨架的图元组件。\r\n * 此Component在图元基础之上添加了骨骼动画的能力，拥有骨骼动画的模型实例化后即为此类的实例。\r\n *\r\n * @template IStateTypes 初始化参数类型，必须继承自[ISkeletalMeshComponentState](../interfaces/iskeletalmeshcomponentstate)。\r\n * @noInheritDoc\r\n */\r\nvar SkeletalMeshComponent = /** @class */ (function (_super) {\r\n    __extends(SkeletalMeshComponent, _super);\r\n    function SkeletalMeshComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSkeletalMeshComponent = true;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SkeletalMeshComponent.prototype, \"skeleton\", {\r\n        /**\r\n         * 获取骨架。\r\n         */\r\n        get: function () {\r\n            return this._mesh.skeleton;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SkeletalMeshComponent.prototype.onCreateMesh = function (state) {\r\n        return new SkeletalMesh({\r\n            geometry: state ? state.geometry : null,\r\n            material: state ? state.material : null,\r\n            skeleton: state ? state.skeleton : null\r\n        });\r\n    };\r\n    /**\r\n     * 将一个`SkeletalMeshComponent`的骨架赋予到本组件上，通常用于换装。\r\n     */\r\n    SkeletalMeshComponent.prototype.changeSkeleton = function (component) {\r\n        if (this.__multiPrimitive) {\r\n            this._list.forEach(function (m) {\r\n                m.skeleton = component._mesh.skeleton;\r\n            });\r\n        }\r\n        else {\r\n            this._mesh.skeleton = component._mesh.skeleton;\r\n        }\r\n    };\r\n    SkeletalMeshComponent.prototype.changeSkin = function (param) {\r\n        var _this = this;\r\n        if (isMesh(param)) {\r\n            this._list = null;\r\n            this._table = null;\r\n            this.__multiPrimitive = false;\r\n            this._mesh.geometry = param.geometry;\r\n            this._mesh.material = param.material;\r\n            this._node.children = [this._mesh];\r\n            return;\r\n        }\r\n        if (param.length < 2) {\r\n            throwException(new BreakGuardException(this, \"meshes which is array must have more than two elements, if one, please use changeSkin(mesh)\"), this);\r\n            return;\r\n        }\r\n        var skeleton = this._mesh.skeleton;\r\n        this._node.children = [];\r\n        this._table = {};\r\n        this._list = param.map(function (_a) {\r\n            var geometry = _a.geometry, material = _a.material;\r\n            var mesh = new SkeletalMesh({ geometry: geometry, material: material.cloneForInst ? material.clone() : material, skeleton: skeleton });\r\n            _this._table[material.name] = mesh;\r\n            _this._node.addChild(mesh);\r\n            return mesh;\r\n        });\r\n        this._mesh = this._list[0];\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    SkeletalMeshComponent.prototype.cloneSkinningFromHilo = function (mesh, index) {\r\n        var m = this._mesh;\r\n        if (this.__multiPrimitive) {\r\n            m = this._list[index];\r\n            if (m.material) {\r\n                delete this._table[m.material.name];\r\n            }\r\n        }\r\n        m.skeleton = mesh.skeleton.clone(this.getRoot().hiloNode);\r\n    };\r\n    SkeletalMeshComponent = __decorate([\r\n        SClass({ className: 'SkeletalMeshComponent' })\r\n    ], SkeletalMeshComponent);\r\n    return SkeletalMeshComponent;\r\n}(PrimitiveComponent));\n\n/**\r\n * [SkeletalMeshComponent](../skeletalmeshcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SkeletalMeshActor = /** @class */ (function (_super) {\r\n    __extends(SkeletalMeshActor, _super);\r\n    function SkeletalMeshActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SkeletalMeshActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', SkeletalMeshComponent, options);\r\n    };\r\n    SkeletalMeshActor = __decorate([\r\n        SClass({ className: 'SkeletalMeshActor', classType: 'Primitive' })\r\n    ], SkeletalMeshActor);\r\n    return SkeletalMeshActor;\r\n}(SceneActor));\n\n/**\r\n * [StaticMeshComponent](../staticmeshcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar StaticMeshActor = /** @class */ (function (_super) {\r\n    __extends(StaticMeshActor, _super);\r\n    function StaticMeshActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    StaticMeshActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', StaticMeshComponent, options);\r\n    };\r\n    StaticMeshActor = __decorate([\r\n        SClass({ className: 'StaticMeshActor' })\r\n    ], StaticMeshActor);\r\n    return StaticMeshActor;\r\n}(SceneActor));\n\n/**\r\n * [OrthographicCameraComponent](../orthographiccameracomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar OrthographicCameraActor = /** @class */ (function (_super) {\r\n    __extends(OrthographicCameraActor, _super);\r\n    function OrthographicCameraActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(OrthographicCameraActor.prototype, \"camera\", {\r\n        get: function () {\r\n            return this._root;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    OrthographicCameraActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', OrthographicCameraComponent, options);\r\n    };\r\n    OrthographicCameraActor = __decorate([\r\n        SClass({ className: 'OrthographicCameraActor' })\r\n    ], OrthographicCameraActor);\r\n    return OrthographicCameraActor;\r\n}(SceneActor));\n\n/**\r\n * [PerspectiveCameraComponent](../perspectivecameracomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PerspectiveCameraActor = /** @class */ (function (_super) {\r\n    __extends(PerspectiveCameraActor, _super);\r\n    function PerspectiveCameraActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    Object.defineProperty(PerspectiveCameraActor.prototype, \"camera\", {\r\n        get: function () {\r\n            return this._root;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PerspectiveCameraActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', PerspectiveCameraComponent, options);\r\n    };\r\n    PerspectiveCameraActor = __decorate([\r\n        SClass({ className: 'PerspectiveCameraActor' })\r\n    ], PerspectiveCameraActor);\r\n    return PerspectiveCameraActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`LightComponent`。\r\n */\r\nfunction isLightComponent(value) {\r\n    return value.isLightComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`AmbientLightActor`。\r\n */\r\nfunction isLightActor(value) {\r\n    return isSceneActor(value) && isLightComponent(value.root);\r\n}\r\n/**\r\n * 环境光组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar LightComponent = /** @class */ (function (_super) {\r\n    __extends(LightComponent, _super);\r\n    function LightComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isLightComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    LightComponent.prototype.onCreateLight = function (options) {\r\n        throw new Error('Not Implement !');\r\n    };\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    LightComponent.prototype.onInit = function (options) {\r\n        _super.prototype.onInit.call(this, options);\r\n        this._light = this.onCreateLight(options);\r\n        this._light.__forceUseParentWorldMatrix = true;\r\n        this._node.addChild(this._light);\r\n    };\r\n    Object.defineProperty(LightComponent.prototype, \"amount\", {\r\n        /**\r\n         * 获取光照强度。\r\n         */\r\n        get: function () {\r\n            return this._light.amount;\r\n        },\r\n        /**\r\n         * 设置光照强度。\r\n         */\r\n        set: function (value) {\r\n            this._light.amount = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LightComponent.prototype, \"color\", {\r\n        /**\r\n         * 获取光照颜色。\r\n         */\r\n        get: function () {\r\n            return this._light.color;\r\n        },\r\n        /**\r\n         * 设置光照颜色。\r\n         */\r\n        set: function (value) {\r\n            this._light.color.copy(value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LightComponent.prototype, \"shadow\", {\r\n        /**\r\n         * 获取阴影参数。\r\n         */\r\n        get: function () {\r\n            return this._light.shadow;\r\n        },\r\n        /**\r\n         * 设置阴影参数。\r\n         */\r\n        set: function (value) {\r\n            this._light.shadow = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    LightComponent = __decorate([\r\n        SClass({ className: 'LightComponent' })\r\n    ], LightComponent);\r\n    return LightComponent;\r\n}(SceneComponent));\n\n/**\r\n * 判断一个实例是否为`AmbientLightComponent`。\r\n */\r\nfunction isAmbientLightComponent(value) {\r\n    return value.isAmbientLightComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`AmbientLightActor`。\r\n */\r\nfunction isAmbientLightActor(value) {\r\n    return isSceneActor(value) && isAmbientLightComponent(value.root);\r\n}\r\n/**\r\n * 环境光组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar AmbientLightComponent = /** @class */ (function (_super) {\r\n    __extends(AmbientLightComponent, _super);\r\n    function AmbientLightComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isAmbientLightComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    AmbientLightComponent.prototype.onCreateLight = function (options) {\r\n        return new Hilo3d$2.AmbientLight(options);\r\n    };\r\n    AmbientLightComponent = __decorate([\r\n        SClass({ className: 'AmbientLightComponent' })\r\n    ], AmbientLightComponent);\r\n    return AmbientLightComponent;\r\n}(LightComponent));\n\n/**\r\n * [AmbientLightComponent](../ambientlightcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar AmbientLightActor = /** @class */ (function (_super) {\r\n    __extends(AmbientLightActor, _super);\r\n    function AmbientLightActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    AmbientLightActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', AmbientLightComponent, options);\r\n    };\r\n    AmbientLightActor = __decorate([\r\n        SClass({ className: 'AmbientLightActor' })\r\n    ], AmbientLightActor);\r\n    return AmbientLightActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`DirectionalLightComponent`。\r\n */\r\nfunction isDirectionalLightComponent(value) {\r\n    return value.isDirectionalLightComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`DirectionalLightActor`。\r\n */\r\nfunction isDirectionalLightActor(value) {\r\n    return isSceneActor(value) && isDirectionalLightComponent(value.root);\r\n}\r\n/**\r\n * 平行光组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar DirectionalLightComponent = /** @class */ (function (_super) {\r\n    __extends(DirectionalLightComponent, _super);\r\n    function DirectionalLightComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isDirectionalLightComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    DirectionalLightComponent.prototype.onCreateLight = function (options) {\r\n        return new Hilo3d$2.DirectionalLight(options);\r\n    };\r\n    Object.defineProperty(DirectionalLightComponent.prototype, \"direction\", {\r\n        /**\r\n         * 获取光照方向。\r\n         */\r\n        get: function () {\r\n            return this._light.direction;\r\n        },\r\n        /**\r\n         * 设置光照方向。\r\n         */\r\n        set: function (value) {\r\n            this._light.direction.copy(value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    DirectionalLightComponent = __decorate([\r\n        SClass({ className: 'DirectionalLightComponent' })\r\n    ], DirectionalLightComponent);\r\n    return DirectionalLightComponent;\r\n}(LightComponent));\n\n/**\r\n * [DirectionalLightComponent](../directionallightcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar DirectionalLightActor = /** @class */ (function (_super) {\r\n    __extends(DirectionalLightActor, _super);\r\n    function DirectionalLightActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    DirectionalLightActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', DirectionalLightComponent, options);\r\n    };\r\n    DirectionalLightActor = __decorate([\r\n        SClass({ className: 'DirectionalLightActor' })\r\n    ], DirectionalLightActor);\r\n    return DirectionalLightActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`PointLightComponent`。\r\n */\r\nfunction isPointLightComponent(value) {\r\n    return value.isPointLightComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`PointLightActor`。\r\n */\r\nfunction isPointLightActor(value) {\r\n    return isSceneActor(value) && isPointLightComponent(value.root);\r\n}\r\nvar PointLightComponent = /** @class */ (function (_super) {\r\n    __extends(PointLightComponent, _super);\r\n    function PointLightComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPointLightComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    PointLightComponent.prototype.onCreateLight = function (options) {\r\n        return new Hilo3d$2.PointLight(options);\r\n    };\r\n    Object.defineProperty(PointLightComponent.prototype, \"range\", {\r\n        /**\r\n         * 获取光照范围。\r\n         */\r\n        get: function () {\r\n            return this._light.range;\r\n        },\r\n        /**\r\n         * 设置光照范围。\r\n         */\r\n        set: function (value) {\r\n            this._light.range = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PointLightComponent.prototype, \"constantAttenuation\", {\r\n        /**\r\n         * 获取固定衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.constantAttenuation;\r\n        },\r\n        /**\r\n         * 设置固定衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.constantAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PointLightComponent.prototype, \"linearAttenuation\", {\r\n        /**\r\n         * 获取线性衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.linearAttenuation;\r\n        },\r\n        /**\r\n         * 设置线性衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.linearAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(PointLightComponent.prototype, \"quadraticAttenuation\", {\r\n        /**\r\n         * 获取二次衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.quadraticAttenuation;\r\n        },\r\n        /**\r\n         * 设置二次衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.quadraticAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    PointLightComponent = __decorate([\r\n        SClass({ className: 'PointLightComponent' })\r\n    ], PointLightComponent);\r\n    return PointLightComponent;\r\n}(LightComponent));\n\n/**\r\n * [PointLightComponent](../pointlightcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PointLightActor = /** @class */ (function (_super) {\r\n    __extends(PointLightActor, _super);\r\n    function PointLightActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    PointLightActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', PointLightComponent, options);\r\n    };\r\n    PointLightActor = __decorate([\r\n        SClass({ className: 'PointLightActor' })\r\n    ], PointLightActor);\r\n    return PointLightActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`SpotLightComponent`。\r\n */\r\nfunction isSpotLightComponent(value) {\r\n    return value.isSpotLightComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`SpotLightActor`。\r\n */\r\nfunction isSpotLightActor(value) {\r\n    return isSceneActor(value) && isSpotLightComponent(value.root);\r\n}\r\nvar SpotLightComponent = /** @class */ (function (_super) {\r\n    __extends(SpotLightComponent, _super);\r\n    function SpotLightComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isLightComponent = true;\r\n        _this.isSpotLightComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    SpotLightComponent.prototype.onCreateLight = function (options) {\r\n        return new Hilo3d$2.SpotLight(options);\r\n    };\r\n    Object.defineProperty(SpotLightComponent.prototype, \"direction\", {\r\n        /**\r\n         * 获取光照方向。\r\n         */\r\n        get: function () {\r\n            return this._light.direction;\r\n        },\r\n        /**\r\n         * 设置光照方向。\r\n         */\r\n        set: function (value) {\r\n            this._light.direction.copy(value);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"range\", {\r\n        /**\r\n         * 获取光照范围。\r\n         */\r\n        get: function () {\r\n            return this._light.range;\r\n        },\r\n        /**\r\n         * 设置光照范围。\r\n         */\r\n        set: function (value) {\r\n            this._light.range = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"cutoff\", {\r\n        /**\r\n         * 获取内裁剪范围。\r\n         */\r\n        get: function () {\r\n            return this._light.cutoff;\r\n        },\r\n        /**\r\n         * 设置内裁剪范围。\r\n         */\r\n        set: function (value) {\r\n            this._light.cutoff = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"outerCutoff\", {\r\n        /**\r\n         * 获取外裁剪范围。\r\n         */\r\n        get: function () {\r\n            return this._light.outerCutoff;\r\n        },\r\n        /**\r\n         * 设置外裁剪范围。\r\n         */\r\n        set: function (value) {\r\n            this._light.outerCutoff = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"constantAttenuation\", {\r\n        /**\r\n         * 获取固定衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.constantAttenuation;\r\n        },\r\n        /**\r\n         * 设置固定衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.constantAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"linearAttenuation\", {\r\n        /**\r\n         * 获取线性衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.linearAttenuation;\r\n        },\r\n        /**\r\n         * 设置线性衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.linearAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpotLightComponent.prototype, \"quadraticAttenuation\", {\r\n        /**\r\n         * 获取二次衰减系数。\r\n         */\r\n        get: function () {\r\n            return this._light.quadraticAttenuation;\r\n        },\r\n        /**\r\n         * 设置二次衰减系数。\r\n         */\r\n        set: function (value) {\r\n            this._light.quadraticAttenuation = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    SpotLightComponent = __decorate([\r\n        SClass({ className: 'SpotLightComponent' })\r\n    ], SpotLightComponent);\r\n    return SpotLightComponent;\r\n}(LightComponent));\n\n/**\r\n * [SpotLightComponent](../spotlightcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpotLightActor = /** @class */ (function (_super) {\r\n    __extends(SpotLightActor, _super);\r\n    function SpotLightActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SpotLightActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', SpotLightComponent, options);\r\n    };\r\n    SpotLightActor = __decorate([\r\n        SClass({ className: 'SpotLightActor' })\r\n    ], SpotLightActor);\r\n    return SpotLightActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`Animation`。\r\n */\r\nfunction isAnimation(value) {\r\n    return value.isAnimation;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction nop() { }\r\n/**\r\n * 动画基类，作为动画组件的组成基本单元。\r\n * 一般不直接使用，而是使用各个派生类。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar Animation = /** @class */ (function (_super) {\r\n    __extends(Animation, _super);\r\n    function Animation(initState) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isAnimation = true;\r\n        _this.animator = null;\r\n        /**\r\n         * 播放速度，具体交由每个动画自行实现。\r\n         */\r\n        _this.speed = 1;\r\n        /**\r\n         * 播放开始时的回调，一般不需要自己使用。\r\n         */\r\n        _this.handleStart = nop;\r\n        /**\r\n         * 播放结束后的回调，**作为终止行为，请在动画结束时自行调用！**。\r\n         */\r\n        _this.handleEnd = nop;\r\n        /**\r\n         * 播放暂停时的回调，一般不需要自己使用。。\r\n         */\r\n        _this.handlePause = nop;\r\n        /**\r\n         * 播放唤醒时的回调，一般不需要自己使用。。\r\n         */\r\n        _this.handleResume = nop;\r\n        _this._initState = null;\r\n        _this._paused = true;\r\n        initState.speed = initState.speed || 1;\r\n        _this.speed = initState.speed;\r\n        _this._initState = initState;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Animation.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级动画组件实例引用，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this.animator;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, \"actor\", {\r\n        /**\r\n         * 获取自身的父级动画组件的Onwer实例引用。\r\n         */\r\n        get: function () {\r\n            return this.animator.getOwner();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, \"fsm\", {\r\n        /**\r\n         * 获取自身动画组件的状态机实例引用。\r\n         */\r\n        get: function () {\r\n            return this.animator.fsm;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, \"currentTime\", {\r\n        /**\r\n         * 获取当前播放时间。\r\n         */\r\n        get: function () {\r\n            throw new Error('Not implemented !');\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, \"duration\", {\r\n        /**\r\n         * 获取当前播放总时长。\r\n         */\r\n        get: function () {\r\n            throw new Error('Not implemented !');\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Animation.prototype, \"paused\", {\r\n        /**\r\n         * 获取当前是否处于暂停状态。\r\n         */\r\n        get: function () {\r\n            return this._paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 获取当前`Game`实例。\r\n     *\r\n     * @template IGameState 当前游戏状态管理器的类型。\r\n     */\r\n    Animation.prototype.getGame = function () {\r\n        return this.actor.getGame();\r\n    };\r\n    /**\r\n     * 获取当前`World`实例。\r\n     *\r\n     * @template IWorldState 当前世界状态管理器的类型。\r\n     */\r\n    Animation.prototype.getWorld = function () {\r\n        return this.actor.getWorld();\r\n    };\r\n    /**\r\n     * 获取当前`Level`实例。\r\n     *\r\n     * @template ILevelState 当前关卡状态管理器的类型。\r\n     */\r\n    Animation.prototype.getLevel = function () {\r\n        return this.actor.getLevel();\r\n    };\r\n    /**\r\n     * 生命周期，将在初始化时触发，你可以重写此方法来实现自定义动画。\r\n     */\r\n    Animation.prototype.onInit = function (initState) {\r\n    };\r\n    /**\r\n     * 生命周期，将在`play`时触发，你可以重写此方法来实现自定义动画。\r\n     *\r\n     * @param loopCount 当前循环次数\r\n     */\r\n    Animation.prototype.onPlay = function (loopCount) {\r\n    };\r\n    /**\r\n     * 生命周期，将在`pause`时触发，你可以重写此方法来实现自定义动画。\r\n     */\r\n    Animation.prototype.onPause = function () {\r\n    };\r\n    /**\r\n     * 生命周期，将在`resume`时触发，你可以重写此方法来实现自定义动画。\r\n     */\r\n    Animation.prototype.onResume = function () {\r\n    };\r\n    /**\r\n     * 生命周期，将在`stop`时触发，你可以重写此方法来实现自定义动画。\r\n     */\r\n    Animation.prototype.onStop = function () {\r\n    };\r\n    /**\r\n     * 生命周期，将在每一帧`update`时触发，你可以重写此方法来实现自定义动画。\r\n     */\r\n    Animation.prototype.onUpdate = function (delta) {\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在游戏中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Animation.prototype.onError = function (error, details) {\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.initialize = function () {\r\n        try {\r\n            this.onInit(this._initState);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.play = function (loopCount) {\r\n        this._paused = false;\r\n        try {\r\n            this.onPlay(loopCount);\r\n            this.handleStart(this, this.actor);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.pause = function () {\r\n        this._paused = true;\r\n        try {\r\n            this.onPause();\r\n            this.handlePause(this, this.actor);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.resume = function () {\r\n        this._paused = false;\r\n        try {\r\n            this.onResume();\r\n            this.handleResume(this, this.actor);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.stop = function () {\r\n        this._paused = true;\r\n        try {\r\n            this.onStop();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Animation.prototype.update = function (delta) {\r\n        try {\r\n            this.onUpdate(delta);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    Animation = __decorate([\r\n        SClass({ className: 'Animation', classType: 'Animation' })\r\n    ], Animation);\r\n    return Animation;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`ModelAnimation`。\r\n */\r\nfunction isModelAnimation(value) {\r\n    return value.isModelAnimation;\r\n}\r\n/**\r\n * 模型动画类，用于存储模型动画。\r\n * 一般在模型实例化时已经自动生成，不需要自己初始化。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar ModelAnimation = /** @class */ (function (_super) {\r\n    __extends(ModelAnimation, _super);\r\n    function ModelAnimation() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isModelAnimation = true;\r\n        _this._startTime = 0;\r\n        _this._endTime = 0;\r\n        _this._duration = 0;\r\n        _this._currentEndHandler = function () { };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ModelAnimation.prototype, \"duration\", {\r\n        /**\r\n         * 获取当前播放总时长。\r\n         */\r\n        get: function () {\r\n            return this._duration;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ModelAnimation.prototype, \"currentTime\", {\r\n        /**\r\n         * 获取当前播放时间。\r\n         */\r\n        get: function () {\r\n            return this._anim.currentTime;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ModelAnimation.prototype, \"paused\", {\r\n        /**\r\n         * 获取当前是否处于暂停状态。\r\n         */\r\n        get: function () {\r\n            return this._anim.paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onInit = function (initState) {\r\n        var component = this.actor.findComponentByName(initState.componentName)\r\n            || this.actor.root;\r\n        var animation = component.hiloNode.anim;\r\n        if (!animation) {\r\n            throw new BreakGuardException(this, \"Model of \" + component.name + \"->\" + this.actor.name + \" has no animations !\");\r\n        }\r\n        var clip = animation.clips[initState.clipName];\r\n        if (!clip) {\r\n            throw new BreakGuardException(this, \"Clip \" + this.className + \" is not existed in model of \" + component.name + \"->\" + this.actor.name + \" !\");\r\n        }\r\n        this._anim = animation;\r\n        this._clipName = initState.clipName;\r\n        this._anim.loop = 0;\r\n        var info = this._anim.getAnimStatesListTimeInfo(clip.animStatesList);\r\n        this._duration = info.endTime - info.startTime;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onPlay = function (loopCount) {\r\n        var _this = this;\r\n        // this callback may be re-registered before it was removed, so we must use lambda function to avoid it\r\n        this._currentEndHandler = function () { return _this.handleEnd(_this, _this.actor); };\r\n        this._anim.on('end', this._currentEndHandler, true);\r\n        this._anim.play(this._clipName);\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onPause = function () {\r\n        this._anim.off('end', this._currentEndHandler);\r\n        this._anim.pause();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onResume = function () {\r\n        this._anim.on('end', this._currentEndHandler, true);\r\n        this._anim.resume();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onStop = function () {\r\n        this._anim.off('end', this._currentEndHandler);\r\n        this._currentEndHandler = function () { };\r\n        this._anim.stop();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    ModelAnimation.prototype.onUpdate = function (delta) {\r\n        if (!this.paused) {\r\n            this._anim.tick(delta);\r\n        }\r\n    };\r\n    ModelAnimation = __decorate([\r\n        SClass({ className: 'ModelAnimation' })\r\n    ], ModelAnimation);\r\n    return ModelAnimation;\r\n}(Animation));\n\n/**\r\n * 判断一个实例是否为`FSMState`。\r\n */\r\nfunction isFSMState(value) {\r\n    return value.isFSMState;\r\n}\r\n/**\r\n * 状态机的状态类，用于存储状态以及行为。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar FSMState = /** @class */ (function (_super) {\r\n    __extends(FSMState, _super);\r\n    function FSMState(name, options, parent) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isFSMState = true;\r\n        _this._fsm = parent;\r\n        _this.onEnter = options.onEnter;\r\n        _this.onUpdate = options.onUpdate;\r\n        _this.onExit = options.onExit;\r\n        _this.actions = {};\r\n        _this.next = {};\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FSMState.prototype, \"fsm\", {\r\n        /**\r\n         * 获取父级状态机。\r\n         */\r\n        get: function () {\r\n            return this._fsm;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 进入此状态，将会触发对应回调。\r\n     */\r\n    FSMState.prototype.enter = function () {\r\n        if (this.onEnter) {\r\n            this.onEnter(this);\r\n        }\r\n    };\r\n    /**\r\n     * 每一帧更新，将会触发对应回调。\r\n     */\r\n    FSMState.prototype.update = function (delta) {\r\n        if (this.onUpdate) {\r\n            this.onUpdate(delta, this);\r\n        }\r\n    };\r\n    /**\r\n     * 退出此状态，将会触发对应回调。\r\n     */\r\n    FSMState.prototype.exit = function () {\r\n        if (this.onExit) {\r\n            this.onExit(this);\r\n        }\r\n    };\r\n    FSMState = __decorate([\r\n        SClass({ className: 'FSMState', classType: 'FSMState' })\r\n    ], FSMState);\r\n    return FSMState;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`FSMComponent`。\r\n */\r\nfunction isFSMComponent(value) {\r\n    return value.isFSMComponent;\r\n}\r\nfunction isArray(value) {\r\n    return !!value.push;\r\n}\r\n/**\r\n * 有限状态机组件类，一种通用的游戏逻辑编程模型。\r\n * 默认拥有`enter`和`exit`两个状态。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar FSMComponent = /** @class */ (function (_super) {\r\n    __extends(FSMComponent, _super);\r\n    /**\r\n     * @hidden\r\n     */\r\n    function FSMComponent(name) {\r\n        var _this = _super.call(this, name, null) || this;\r\n        _this.isFSMComponent = true;\r\n        /**\r\n         * 退出一个状态时的回调。\r\n         */\r\n        _this.onExit = new Observable();\r\n        _this._states = {};\r\n        _this._current = 'enter';\r\n        _this._default = null;\r\n        _this.handleExit = function () {\r\n            _this.dispatch('reset');\r\n            if (_this.onExit) {\r\n                _this.onExit.parent = _this;\r\n                _this.onExit.notify(_this);\r\n            }\r\n        };\r\n        _this.addState('enter');\r\n        _this.addState('exit', { onEnter: _this.handleExit });\r\n        _this.addTransition('reset', 'exit', 'enter');\r\n        return _this;\r\n    }\r\n    Object.defineProperty(FSMComponent.prototype, \"defaultState\", {\r\n        /**\r\n         * 获取默认状态名称。\r\n         */\r\n        get: function () {\r\n            return this._default;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FSMComponent.prototype, \"current\", {\r\n        /**\r\n         * 获取当前状态名称。\r\n         */\r\n        get: function () {\r\n            return this._current;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FSMComponent.prototype, \"currentState\", {\r\n        /**\r\n         * 获取当前状态实例引用。\r\n         */\r\n        get: function () {\r\n            return this._states[this._current];\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(FSMComponent.prototype, \"parent\", {\r\n        /**\r\n         * 获取父级实例引用。\r\n         */\r\n        get: function () {\r\n            return this._parent || this._owner;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 获取当前状态实例引用。\r\n     */\r\n    FSMComponent.prototype.getCurrentState = function () {\r\n        return this._states[this._current];\r\n    };\r\n    /**\r\n     * 通过名字获取状态实例引用。\r\n     */\r\n    FSMComponent.prototype.getState = function (name) {\r\n        return this._states[name];\r\n    };\r\n    /**\r\n     * 添加一个实例。\r\n     *\r\n     * @param isDefault 是否为默认状态\r\n     */\r\n    FSMComponent.prototype.addState = function (name, options, isDefault) {\r\n        if (options === void 0) { options = {}; }\r\n        if (isDefault === void 0) { isDefault = false; }\r\n        if (this._states[name]) {\r\n            throw new MemberConflictException(this, 'State', name, this);\r\n        }\r\n        this._states[name] = new FSMState(name, options, this);\r\n        if (isDefault) {\r\n            this.setDefault(name);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 修改默认状态。\r\n     */\r\n    FSMComponent.prototype.setDefault = function (name) {\r\n        this._default = name;\r\n        this.addTransition('enter', 'enter', name);\r\n        return this;\r\n    };\r\n    /**\r\n     * 判断是否拥有某个状态。\r\n     */\r\n    FSMComponent.prototype.has = function (name) {\r\n        return !!this._states[name];\r\n    };\r\n    /**\r\n     * 移除一个状态。\r\n     */\r\n    FSMComponent.prototype.removeState = function (name) {\r\n        var state = this._states[name];\r\n        if (!state) {\r\n            return;\r\n        }\r\n        delete this._states[name];\r\n        return this;\r\n    };\r\n    /**\r\n     * 重置状态机到`enter`状态。\r\n     */\r\n    FSMComponent.prototype.reset = function () {\r\n        this._current = 'enter';\r\n        return this;\r\n    };\r\n    /**\r\n     * 添加一个一对一或一对多的转换。\r\n     */\r\n    FSMComponent.prototype.addTransition = function (action, from, to) {\r\n        var _this = this;\r\n        var toState = this._states[to];\r\n        if (!toState) {\r\n            throwException(new MissingMemberException(this, 'State', to, this), this);\r\n        }\r\n        if (!isArray(from)) {\r\n            from = [from];\r\n        }\r\n        from.forEach(function (fromName) {\r\n            var fromState = _this._states[fromName];\r\n            if (!fromState) {\r\n                throwException(new MissingMemberException(_this, 'State', fromName, _this), _this);\r\n            }\r\n            if (fromState.next[to]) {\r\n                throwException(new MemberConflictException(_this, 'State', fromName, _this), _this);\r\n            }\r\n            fromState.next[to] = action;\r\n            fromState.actions[action] = to;\r\n        });\r\n        return this;\r\n    };\r\n    FSMComponent.prototype.removeTransition = function (from, to) {\r\n        var _this = this;\r\n        if (!isArray(from) && !isArray(to)) {\r\n            this.removeOneTransition(from, to);\r\n        }\r\n        if (isArray(from) && !isArray(to)) {\r\n            from.forEach(function (name) { return _this.removeOneTransition(name, to); });\r\n        }\r\n        if (isArray(to) && !isArray(from)) {\r\n            to.forEach(function (name) { return _this.removeOneTransition(from, name); });\r\n        }\r\n        return this;\r\n    };\r\n    FSMComponent.prototype.removeOneTransition = function (from, to) {\r\n        var fromState = this._states[from];\r\n        if (!fromState || !fromState.next[to]) {\r\n            return;\r\n        }\r\n        var action = fromState.next[to];\r\n        delete fromState.next[to];\r\n        delete fromState.actions[action];\r\n        return this;\r\n    };\r\n    /**\r\n     * 添加多对转换。\r\n     */\r\n    FSMComponent.prototype.addTransitions = function (options) {\r\n        var _this = this;\r\n        options.forEach(function (option) { return _this.addTransition(option.action, option.from, option.to); });\r\n        return this;\r\n    };\r\n    /**\r\n     * 移除多对转换。\r\n     */\r\n    FSMComponent.prototype.removeTransitions = function (options) {\r\n        var _this = this;\r\n        options.forEach(function (option) { return _this.removeTransition(option.from, option.to); });\r\n        return this;\r\n    };\r\n    /**\r\n     * 判断是否拥有某对转换。\r\n     */\r\n    FSMComponent.prototype.hasTransition = function (from, action) {\r\n        var state = this._states[from];\r\n        if (!state) {\r\n            return false;\r\n        }\r\n        return !!state.actions[action];\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    FSMComponent.prototype.enter = function () {\r\n        this.dispatch('enter');\r\n    };\r\n    /**\r\n     * 每一帧更新，继承请先`super.onUpdate()`。\r\n     */\r\n    FSMComponent.prototype.onUpdate = function (delta) {\r\n        if (!this._current) {\r\n            return;\r\n        }\r\n        var state = this._states[this._current];\r\n        if (state) {\r\n            state.update(delta);\r\n        }\r\n    };\r\n    /**\r\n     * 执行某个动作`action`，触发转换。\r\n     */\r\n    FSMComponent.prototype.dispatch = function (action) {\r\n        if (!this._current || !this._states[this._current]) {\r\n            throwException(new Error(\"State \\\"\" + this._current + \"\\\" does not in this fsm now: \\\"\" + this.name + \"\\\"!\"), this);\r\n        }\r\n        var currentState = this._states[this._current];\r\n        currentState.exit();\r\n        var nextName = currentState.actions[action];\r\n        if (!nextName || !this._states[nextName]) {\r\n            throwException(new Error(\"FromState \\\"\" + this._current + \"\\\" does not have action \\\"\" + action + \"\\\"!\"), this);\r\n        }\r\n        this._current = nextName;\r\n        this._states[nextName].enter();\r\n        return this;\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    FSMComponent.prototype.onDestroy = function () {\r\n        this.reset();\r\n    };\r\n    FSMComponent = __decorate([\r\n        SClass({ className: 'FSMComponent' })\r\n    ], FSMComponent);\r\n    return FSMComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`AnimatorComponent`。\r\n */\r\nfunction isAnimatorComponent(value) {\r\n    return value.isAnimatorComponent;\r\n}\r\n/**\r\n * 动画组件类，管理着一个Actor下的所有动画。\r\n * **当挂载到Actor后，你可以直接通过`actor.animator`来访问它。**\r\n *\r\n * @template IParameters 用于指定动画状态机参数的类型。\r\n * @noInheritDoc\r\n */\r\nvar AnimatorComponent = /** @class */ (function (_super) {\r\n    __extends(AnimatorComponent, _super);\r\n    function AnimatorComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isAnimatorComponent = true;\r\n        _this._fsm = new FSMComponent('fsm');\r\n        _this._loop = 0;\r\n        _this._animations = {};\r\n        _this._transitions = {};\r\n        _this._parameters = {};\r\n        _this.handleElementEnd = function (animation) {\r\n            var from = animation.name.value;\r\n            if (!_this._transitions[from]) {\r\n                _this._fsm.dispatch('exit');\r\n                return;\r\n            }\r\n            var _a = _this._transitions[from], conditions = _a.conditions, length = _a.length, array = _a.array;\r\n            for (var index = 0; index < length; index += 1) {\r\n                var to = array[index];\r\n                if (conditions[to](_this._parameters)) {\r\n                    _this._fsm.dispatch(to);\r\n                    return;\r\n                }\r\n            }\r\n            _this._fsm.dispatch('exit');\r\n        };\r\n        _this.handleEnd = function () {\r\n            if (!_this._loop || _this._loop <= 0) {\r\n                _this._event.trigger('End', { name: _this.current, animation: _this._currentAnimation, actor: _this._owner });\r\n                _this._currentAnimation = null;\r\n                return;\r\n            }\r\n            _this._event.trigger('Loop', { animation: _this._currentAnimation, name: _this._current, actor: _this._owner });\r\n            _this._fsm.dispatch(_this._current);\r\n            _this._loop -= 1;\r\n        };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(AnimatorComponent.prototype, \"event\", {\r\n        /**\r\n         * AnimatorComponent的事件管理器。\r\n         *\r\n         * ```ts\r\n         * EventManager<{\r\n         *  Start: IAnimatorEvent;\r\n         *  Pause: IAnimatorEvent;\r\n         *  Resume: IAnimatorEvent;\r\n         *  Loop: IAnimatorEvent;\r\n         *  End: IAnimatorEvent;\r\n         * }>\r\n         * ```\r\n         *\r\n         * [IAnimatorEvent](../interfaces/ianimatorevent)\r\n         */\r\n        get: function () {\r\n            return this._event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AnimatorComponent.prototype, \"current\", {\r\n        /**\r\n         * 获取当前播放的动画名称。\r\n         */\r\n        get: function () {\r\n            return this._current;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AnimatorComponent.prototype, \"fsm\", {\r\n        /**\r\n         * 获取状态机实例引用。\r\n         */\r\n        get: function () {\r\n            return this._fsm;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AnimatorComponent.prototype, \"parameters\", {\r\n        /**\r\n         * 获取当前的状态机控制参数引用。\r\n         */\r\n        get: function () {\r\n            return this._parameters;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(AnimatorComponent.prototype, \"animationNames\", {\r\n        get: function () {\r\n            return Object.keys(this._fsm.getState('enter').next);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    AnimatorComponent.prototype.onInit = function () {\r\n        this._event.register('Start');\r\n        this._event.register('Pause');\r\n        this._event.register('Resume');\r\n        this._event.register('Loop');\r\n        this._event.register('End');\r\n        this._fsm._parent = this;\r\n        this._fsm.onExit.add(this.handleEnd);\r\n    };\r\n    /**\r\n     * 添加到世界，继承请先`super.onAdd()`。\r\n     */\r\n    AnimatorComponent.prototype.onAdd = function (initState) {\r\n        this.initFromComponent(initState.componentName);\r\n        // fixme: hack for performance\r\n        this._owner._animator = this;\r\n    };\r\n    /**\r\n     * 修改状态参数的值。\r\n     */\r\n    AnimatorComponent.prototype.setParameter = function (key, value) {\r\n        this._parameters[key] = value;\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取状态参数的值。\r\n     */\r\n    AnimatorComponent.prototype.getParameter = function (key) {\r\n        return this._parameters[key];\r\n    };\r\n    /**\r\n     * 通过名字获取动画实例引用。\r\n     */\r\n    AnimatorComponent.prototype.getAnimation = function (name) {\r\n        if (!this._animations[name]) {\r\n            Debug.warn(\"Animation \" + name + \" is not existed in \" + (this._owner && this._owner.name));\r\n        }\r\n        return this._animations[name];\r\n    };\r\n    /**\r\n     * 通过组件名称添加其下的所有动画。\r\n     */\r\n    AnimatorComponent.prototype.initFromComponent = function (name) {\r\n        var _this = this;\r\n        if (name === void 0) { name = 'root'; }\r\n        var component = this._owner.findComponentByName(name);\r\n        if (!component.hiloNode.anim) {\r\n            return;\r\n        }\r\n        var oldPrefix = this._owner.name.value + '@';\r\n        var clips = component.hiloNode.anim.clips;\r\n        Object.keys(clips).forEach(function (clipName) {\r\n            _this.register(clipName.replace(oldPrefix, ''), new ModelAnimation({ componentName: name, clipName: clipName }));\r\n        });\r\n    };\r\n    /**\r\n     * 每一帧更新，继承请先`super.onUpdate()`。\r\n     */\r\n    AnimatorComponent.prototype.onUpdate = function (delta) {\r\n        this._fsm.update(delta);\r\n    };\r\n    AnimatorComponent.prototype.onUnLink = function () {\r\n        this.stop();\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    AnimatorComponent.prototype.onDestroy = function () {\r\n        if (this._currentAnimation && !this._currentAnimation.paused) {\r\n            this._currentAnimation.pause();\r\n        }\r\n        if (this._owner.animator === this) {\r\n            this._owner._animator = null;\r\n        }\r\n        this._fsm.reset();\r\n        this._animations = {};\r\n    };\r\n    /**\r\n     * 注册一个动画为一个名称，通过`isDefault`指定其是否为默认动画。\r\n     */\r\n    AnimatorComponent.prototype.register = function (name, animation, isDefault) {\r\n        var _this = this;\r\n        if (isDefault === void 0) { isDefault = false; }\r\n        if (isDefault || !this._default) {\r\n            this._default = name;\r\n        }\r\n        animation.name = new SName(name);\r\n        animation.animator = this;\r\n        animation.handleEnd = this.handleElementEnd;\r\n        animation.handlePause = function () { return _this._event.trigger('Pause', { animation: animation, name: _this._current, actor: _this._owner }); };\r\n        animation.handleResume = function () { return _this._event.trigger('Resume', { animation: animation, name: _this._current, actor: _this._owner }); };\r\n        this._fsm.addState(name, {\r\n            onEnter: function () {\r\n                _this._currentAnimation = animation;\r\n                animation.play(_this._loop);\r\n            },\r\n            onUpdate: function (delta) { return animation.update(delta); }\r\n        });\r\n        this.addTransition('enter', name, function () { return true; });\r\n        this._fsm.addTransition('exit', name, 'exit');\r\n        this._animations[name] = animation;\r\n        animation.initialize();\r\n        return this;\r\n    };\r\n    /**\r\n     * 取消注册一个动画。\r\n     */\r\n    AnimatorComponent.prototype.unregister = function (name) {\r\n        this._fsm.removeState(name);\r\n        this._fsm.removeTransition('enter', name);\r\n        if (this._animations[name]) {\r\n            this._animations[name].destroy();\r\n            delete this._animations[name];\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 设置默认的动画。\r\n     */\r\n    AnimatorComponent.prototype.setDefault = function (name) {\r\n        this._default = name;\r\n    };\r\n    /**\r\n     * 添加一个动画到另一个动画的链接。\r\n     *\r\n     * @param condition 通过当前状态参数决定此刻是否要执行这个转换，用于当一个动画拥有多个下一步的指向时。\r\n     */\r\n    AnimatorComponent.prototype.addTransition = function (from, to, condition) {\r\n        this._fsm.addTransition(to, from, to);\r\n        this._transitions[from] = this._transitions[from] || { conditions: {}, array: [], length: 0 };\r\n        this._transitions[from].conditions[to] = condition || (function () { return true; });\r\n        this._transitions[from].array.push(to);\r\n        this._transitions[from].length += 1;\r\n        return this;\r\n    };\r\n    /**\r\n     * 修改一个动画到下一个动画的转换判定函数。\r\n     */\r\n    AnimatorComponent.prototype.setTransitionCondition = function (from, to, condition) {\r\n        this._transitions[from].conditions[to] = condition;\r\n        return this;\r\n    };\r\n    /**\r\n     * 移除一个转换。\r\n     */\r\n    AnimatorComponent.prototype.removeTransition = function (from, to) {\r\n        this._fsm.removeTransition(from, to);\r\n        if (!this._transitions[from].conditions[to]) {\r\n            return this;\r\n        }\r\n        delete this._transitions[from].conditions[to];\r\n        var index = this._transitions[from].array.indexOf(to);\r\n        this._transitions[from].array.splice(index, 1);\r\n        this._transitions[from].length -= 1;\r\n        return this;\r\n    };\r\n    /**\r\n     * 清空所有动画。\r\n     */\r\n    AnimatorComponent.prototype.clear = function () {\r\n        this.stop();\r\n        this._fsm = new FSMComponent('fsm');\r\n        return this;\r\n    };\r\n    /**\r\n     * 判定一个动画是否已被注册。\r\n     */\r\n    AnimatorComponent.prototype.has = function (name) {\r\n        return this._fsm.hasTransition('enter', name);\r\n    };\r\n    /**\r\n     * 播放某个动画，不指定`name`将播放默认动画。`loop`用于指定循环次数。\r\n     */\r\n    AnimatorComponent.prototype.play = function (name, loop) {\r\n        if (!this._fsm.getCurrentState().name.equalsTo('enter')) {\r\n            this.stop();\r\n        }\r\n        name = name || this._default;\r\n        if (!name) {\r\n            return this;\r\n        }\r\n        this._loop = loop || 0;\r\n        this._current = name;\r\n        this._fsm.dispatch(name);\r\n        this._event.trigger('Start', { animation: this._currentAnimation, name: this._current, actor: this._owner });\r\n        return this;\r\n    };\r\n    /**\r\n     * 暂停动画播放。\r\n     */\r\n    AnimatorComponent.prototype.pause = function () {\r\n        this._currentAnimation.pause();\r\n        return this;\r\n    };\r\n    /**\r\n     * 唤醒动画播放。\r\n     */\r\n    AnimatorComponent.prototype.resume = function () {\r\n        this._currentAnimation.resume();\r\n        return this;\r\n    };\r\n    /**\r\n     * 停止动画播放。\r\n     */\r\n    AnimatorComponent.prototype.stop = function () {\r\n        if (this._currentAnimation && !this._currentAnimation.paused) {\r\n            this._currentAnimation.stop();\r\n        }\r\n        this._loop = 0;\r\n        this._fsm.reset();\r\n        this.handleEnd();\r\n        return this;\r\n    };\r\n    AnimatorComponent = __decorate([\r\n        SClass({ className: 'AnimatorComponent' })\r\n    ], AnimatorComponent);\r\n    return AnimatorComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`MorphGeometry`。\r\n */\r\nfunction isMorphGeometry(value) {\r\n    return value.isMorphGeometry;\r\n}\r\nvar MorphGeometry = /** @class */ (function (_super) {\r\n    __extends(MorphGeometry, _super);\r\n    function MorphGeometry() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return MorphGeometry;\r\n}(Hilo3d$2.MorphGeometry));\n\n/**\r\n * 判断一个实例是否为`BSPComponent`。\r\n */\r\nfunction isBSPComponent(value) {\r\n    return value.isBSPComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPActor`。\r\n */\r\nfunction isBSPActor(value) {\r\n    return isSceneActor(value) && isBSPComponent(value.root);\r\n}\r\n/**\r\n * 基础几何体基类，一般不直接使用，而是使用派生类。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPComponent = /** @class */ (function (_super) {\r\n    __extends(BSPComponent, _super);\r\n    function BSPComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPComponent = true;\r\n        _this.needUpdateAndDestroy = false;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    BSPComponent.prototype.onInit = function (initState) {\r\n        var state = this.convertState(initState);\r\n        _super.prototype.onInit.call(this, state);\r\n    };\r\n    BSPComponent.prototype.convertState = function (initState) {\r\n        return initState;\r\n    };\r\n    BSPComponent = __decorate([\r\n        SClass({ className: 'BSPComponent' })\r\n    ], BSPComponent);\r\n    return BSPComponent;\r\n}(StaticMeshComponent));\n\n/**\r\n * 判断一个实例是否为`BSPMorphComponent`。\r\n */\r\nfunction isBSPMorphComponent(value) {\r\n    return value.isBSPMorphComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPMorphActor`。\r\n */\r\nfunction isBSPMorphActor(value) {\r\n    return isSceneActor(value) && isBSPMorphComponent(value.root);\r\n}\r\n/**\r\n * 基础Morph几何体。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPMorphComponent = /** @class */ (function (_super) {\r\n    __extends(BSPMorphComponent, _super);\r\n    function BSPMorphComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPMorphComponent = true;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(BSPMorphComponent.prototype, \"geometry\", {\r\n        /**\r\n         * 获取几何体。\r\n         */\r\n        get: function () {\r\n            return this._mesh.geometry;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BSPMorphComponent.prototype, \"targets\", {\r\n        /**\r\n         * 设置targets。\r\n         */\r\n        get: function () {\r\n            return this.geometry.targets;\r\n        },\r\n        /**\r\n         * 获取targets。\r\n         */\r\n        set: function (value) {\r\n            this.geometry.targets = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(BSPMorphComponent.prototype, \"weights\", {\r\n        /**\r\n         * 获取权重。\r\n         */\r\n        get: function () {\r\n            return this.geometry.weights;\r\n        },\r\n        /**\r\n         * 设置权重。\r\n         */\r\n        set: function (value) {\r\n            this.geometry.weights = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    BSPMorphComponent.prototype.convertState = function (initState) {\r\n        var weights = initState.weights, targets = initState.targets, geometry = initState.geometry, others = __rest(initState, [\"weights\", \"targets\", \"geometry\"]);\r\n        var result = others;\r\n        var attrs = {};\r\n        Object.keys(geometry).forEach(function (key) {\r\n            if (geometry[key].isGeometryData) {\r\n                attrs[key] = geometry[key];\r\n            }\r\n        });\r\n        result.geometry = new MorphGeometry(attrs);\r\n        if (geometry.isMorphGeometry) {\r\n            result.geometry.targets = targets || geometry.targets;\r\n            result.geometry.weights = weights || geometry.weights.slice();\r\n        }\r\n        else {\r\n            result.geometry.weights = weights || [];\r\n            result.geometry.targets = targets || {};\r\n        }\r\n        return result;\r\n    };\r\n    BSPMorphComponent = __decorate([\r\n        SClass({ className: 'BSPMorphComponent' })\r\n    ], BSPMorphComponent);\r\n    return BSPMorphComponent;\r\n}(BSPComponent));\n\n/**\r\n * [BSPMorphComponent](../bspmorphcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPMorphActor = /** @class */ (function (_super) {\r\n    __extends(BSPMorphActor, _super);\r\n    function BSPMorphActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BSPMorphActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', BSPMorphComponent, options);\r\n    };\r\n    BSPMorphActor = __decorate([\r\n        SClass({ className: 'BSPMorphActor' })\r\n    ], BSPMorphActor);\r\n    return BSPMorphActor;\r\n}(SceneActor));\n\n/**\r\n * 用于2D精灵的材质。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpriteMaterial = /** @class */ (function (_super) {\r\n    __extends(SpriteMaterial, _super);\r\n    function SpriteMaterial(options) {\r\n        var _this = _super.call(this, {\r\n            side: Constants.FRONT_AND_BACK,\r\n            alphaMode: 'BLEND',\r\n            attributes: {\r\n                a_position: 'POSITION',\r\n                a_uv: 'TEXCOORD_0'\r\n            },\r\n            uniforms: __assign({ u_modelViewProjectionMatrix: 'SPRITEMODELVIEWPROJECTION', u_modelViewMatrix: 'MODELVIEW', u_fogInfo: 'FOGINFO', u_fogColor: 'FOGCOLOR' }, options.uniforms),\r\n            vs: \"\\nprecision HILO_MAX_VERTEX_PRECISION float;\\nattribute vec3 a_position;\\nattribute vec2 a_uv;\\nuniform mat4 u_modelViewProjectionMatrix;\\nuniform mat3 u_uvMatrix;\\n\" + Shader.shaders['chunk/lightFog.vert'] + \"\\nvarying vec2 v_uv;\\n\\nvoid main() {\\nvec4 pos = vec4(a_position, 1.0);\\nv_uv = (u_uvMatrix * vec3(a_uv, 1.)).xy;\\n\" + Shader.shaders['chunk/lightFog_main.vert'] + \"\\n\\ngl_Position = u_modelViewProjectionMatrix * pos;\\n}\\n\",\r\n            fs: \"\\nprecision HILO_MAX_FRAGMENT_PRECISION float;\\nuniform sampler2D u_texture;\\nuniform float u_opacity;\\n\" + Shader.shaders['chunk/fog.frag'] + \"\\nvarying vec2 v_uv;\\n\\nvoid main() {\\nvec4 color = texture2D(u_texture, v_uv);\\nfloat a = color.a;\\n\" + Shader.shaders['chunk/fog_main.frag'] + \"\\ncolor.a = a * u_opacity;\\n\\ngl_FragColor = color;\\n}\\n\"\r\n        }) || this;\r\n        _this.isSpriteMaterial = true;\r\n        return _this;\r\n    }\r\n    SpriteMaterial = __decorate([\r\n        SMaterial({ className: 'SpriteMaterial' })\r\n    ], SpriteMaterial);\r\n    return SpriteMaterial;\r\n}(RawShaderMaterial));\n\n/**\r\n * 判断一个实例是否为`SpriteComponent`。\r\n */\r\nfunction isSpriteComponent(value) {\r\n    return value.isSpriteComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`SpriteActor`。\r\n */\r\nfunction isSpriteActor(value) {\r\n    return isSceneActor(value) && isSpriteComponent(value.root);\r\n}\r\n/**\r\n * 精灵组件类，是展示2D图元的基本组件。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpriteComponent = /** @class */ (function (_super) {\r\n    __extends(SpriteComponent, _super);\r\n    function SpriteComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSpriteComponent = true;\r\n        _this._isBillboard = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SpriteComponent.prototype, \"isBillboard\", {\r\n        /**\r\n         * 是否开启`Billboard`模式，若开启，则精灵始终面向摄像机。\r\n         */\r\n        get: function () {\r\n            return this._isBillboard;\r\n        },\r\n        /**\r\n         * 是否开启`Billboard`模式，若开启，则精灵始终面向摄像机。\r\n         */\r\n        set: function (value) {\r\n            this._isBillboard = value;\r\n            this.getMaterial().isBillboard = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"currentFrame\", {\r\n        /**\r\n         * 获取当前的帧名（图集模式）。\r\n         */\r\n        get: function () {\r\n            return this._currentFrame;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    SpriteComponent.prototype.onInit = function (state) {\r\n        _super.prototype.onInit.call(this, state);\r\n        var texture;\r\n        var uvMatrix = new Matrix3();\r\n        if (state.atlas) {\r\n            texture = state.atlas.texture;\r\n            this._atlas = state.atlas;\r\n            uvMatrix.copy(this._atlas.getUVMatrix(state.frameName));\r\n        }\r\n        else {\r\n            this._texture = texture = state.texture;\r\n        }\r\n        texture.width = texture.origWidth;\r\n        texture.height = texture.origHeight;\r\n        var opacity = state.opacity === undefined ? 1 : state.opacity;\r\n        var geometry = new Hilo3d$2.PlaneGeometry({ width: state.width, height: state.height });\r\n        var material = (state.material || new SpriteMaterial({\r\n            uniforms: {\r\n                u_texture: { value: texture },\r\n                u_uvMatrix: { value: uvMatrix },\r\n                u_opacity: { value: opacity }\r\n            }\r\n        }));\r\n        if (state.material) {\r\n            material.setUniform('u_texture', texture);\r\n            material.setUniform('u_uvMatrix', uvMatrix);\r\n            material.setUniform('u_opacity', opacity);\r\n        }\r\n        if (state.materialOptions) {\r\n            Object.assign(material, state.materialOptions);\r\n        }\r\n        material.game = this.getGame();\r\n        this._mesh = new Mesh({ geometry: geometry, material: material });\r\n        this._mesh.__forceUseParentWorldMatrix = true;\r\n        if (state.frustumTest !== undefined) {\r\n            this._mesh.frustumTest = state.frustumTest;\r\n        }\r\n        this.isBillboard = state.isBillboard || false;\r\n        this._node.addChild(this._mesh);\r\n        var root = this.getRoot();\r\n        if (root) {\r\n            root.hiloNode.addChild(this._node);\r\n        }\r\n    };\r\n    Object.defineProperty(SpriteComponent.prototype, \"width\", {\r\n        /**\r\n         * 获取精灵宽度。\r\n         */\r\n        get: function () {\r\n            return this._initState.width;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"height\", {\r\n        /**\r\n         * 获取精灵高度。\r\n         */\r\n        get: function () {\r\n            return this._initState.height;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"texture\", {\r\n        /**\r\n         * 单纹理下模式下，直接获取纹理。\r\n         */\r\n        get: function () {\r\n            return this._texture;\r\n        },\r\n        /**\r\n         * 单纹理下模式下，直接设置纹理。\r\n         */\r\n        set: function (texture) {\r\n            if (this._texture !== texture) {\r\n                this._texture = texture;\r\n                this._mesh.material.setUniform('u_texture', texture);\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"atlas\", {\r\n        /**\r\n         * 获取当前图集。\r\n         */\r\n        get: function () {\r\n            return this._atlas;\r\n        },\r\n        /**\r\n         * 设置当前图集。\r\n         */\r\n        set: function (atlas) {\r\n            if (this._atlas !== atlas) {\r\n                this._atlas = atlas;\r\n                this._mesh.material.setUniform('u_texture', atlas.getWholeTexture());\r\n            }\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"frustumTest\", {\r\n        /**\r\n         * 是否需要视椎体裁剪。\r\n         */\r\n        get: function () {\r\n            return this._mesh.frustumTest;\r\n        },\r\n        /**\r\n         * 是否需要视椎体裁剪。\r\n         */\r\n        set: function (frustumTest) {\r\n            this._mesh.frustumTest = frustumTest;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteComponent.prototype, \"material\", {\r\n        /**\r\n         * 获取材质数据。\r\n         */\r\n        get: function () {\r\n            return this._mesh.material;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 获取材质数据。\r\n     */\r\n    SpriteComponent.prototype.getMaterial = function () {\r\n        return this._mesh.material;\r\n    };\r\n    /**\r\n     * 仅当图集`atlas`模式下，设置要显示哪一帧。\r\n     */\r\n    SpriteComponent.prototype.setFrame = function (name) {\r\n        this._mesh.material.setUniform('u_uvMatrix', this._atlas.getUVMatrix(name));\r\n        this._currentFrame = name;\r\n        return this;\r\n    };\r\n    /**\r\n     * 进行一次预渲染，期间会处理材质预编译、资源预提交等。\r\n     */\r\n    SpriteComponent.prototype.preRender = function () {\r\n        var renderer = this.getGame().renderer;\r\n        renderer.renderMesh(this._mesh);\r\n    };\r\n    SpriteComponent = __decorate([\r\n        SClass({ className: 'SpriteComponent' })\r\n    ], SpriteComponent);\r\n    return SpriteComponent;\r\n}(SceneComponent));\n\n/**\r\n * [SpriteComponent](../spritecomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpriteActor = /** @class */ (function (_super) {\r\n    __extends(SpriteActor, _super);\r\n    function SpriteActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    SpriteActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', SpriteComponent, options);\r\n    };\r\n    SpriteActor = __decorate([\r\n        SClass({ className: 'SpriteActor' })\r\n    ], SpriteActor);\r\n    return SpriteActor;\r\n}(SceneActor));\n\n/* tslint:disable */\r\n/**\r\n * @hidden\r\n */\r\nfunction generateActorOrComponentFromNode(node, parentActor, parent, isComponent, resource, world) {\r\n    var child = node.children[0];\r\n    var result = null;\r\n    var root = null;\r\n    var Class;\r\n    var initOptions = { __fromGlTF: true, matrix: node.matrix };\r\n    if (node.gltfExtensions.Sein_node && node.gltfExtensions.Sein_node.className) {\r\n        var className = node.gltfExtensions.Sein_node.className;\r\n        Class = MetaSClasses[className];\r\n        if (!Class) {\r\n            Debug.warn(\"No class named '\" + className + \"', no effect, you must use decorator 'SClass' to annotate your class before use it !\");\r\n        }\r\n        else {\r\n            Object.assign(initOptions, node.gltfExtensions.Sein_node.initOptions || {});\r\n        }\r\n    }\r\n    if (!child) {\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || SceneComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || SceneActor, initOptions, parentActor, parent)).root;\r\n        }\r\n    }\r\n    else if (child.isSkinedMesh) {\r\n        var length_1 = node.children.length;\r\n        var meshes = [];\r\n        for (var index = 0; index < length_1; index += 1) {\r\n            var mesh = node.children[index];\r\n            if (!mesh.isSkinedMesh) {\r\n                break;\r\n            }\r\n            meshes.push(mesh);\r\n            node.childrenOffset += 1;\r\n        }\r\n        length_1 = meshes.length;\r\n        var _a = child, geometry = _a.geometry, material = _a.material;\r\n        Object.assign(initOptions, { __doNotUseMultiPrimitiveYourself: meshes, geometry: geometry, material: material });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || SkeletalMeshComponent, initOptions, parent);\r\n            parentActor.skeletalMeshComponents.push([root, meshes]);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || SkeletalMeshActor, initOptions, parentActor, parent)).root;\r\n            root.getOwner().skeletalMeshComponents = [[root, meshes]];\r\n        }\r\n    }\r\n    else if (child.isMesh) {\r\n        var length_2 = node.children.length;\r\n        var meshes = [];\r\n        for (var index = 0; index < length_2; index += 1) {\r\n            var mesh = node.children[index];\r\n            if (!mesh.isMesh) {\r\n                break;\r\n            }\r\n            meshes.push(mesh);\r\n            node.childrenOffset += 1;\r\n        }\r\n        length_2 = meshes.length;\r\n        var _b = child, geometry = _b.geometry, material = _b.material;\r\n        Object.assign(initOptions, { __doNotUseMultiPrimitiveYourself: meshes, geometry: geometry, material: material });\r\n        if (geometry.isMorphGeometry) {\r\n            if (isComponent) {\r\n                root = result = parentActor.addComponent(node.name, Class || BSPMorphComponent, initOptions, parent);\r\n            }\r\n            else {\r\n                root = (result = world.addActor(node.name, Class || BSPMorphActor, initOptions, parentActor, parent)).root;\r\n            }\r\n        }\r\n        else {\r\n            if (isComponent) {\r\n                root = result = parentActor.addComponent(node.name, Class || StaticMeshComponent, initOptions, parent);\r\n            }\r\n            else {\r\n                root = (result = world.addActor(node.name, Class || StaticMeshActor, initOptions, parentActor, parent)).root;\r\n            }\r\n        }\r\n    }\r\n    else if (child.isFakeHiloSprite) {\r\n        var _c = child.sprite, width = _c.width, height = _c.height, isBillboard = _c.isBillboard, frustumTest = _c.frustumTest, atlas = _c.atlas;\r\n        var material = child.material;\r\n        var frameName = atlas.frameName, index = atlas.index;\r\n        var atlasManager = resource['atlases'][index];\r\n        Object.assign(initOptions, { width: width, height: height, isBillboard: isBillboard, frustumTest: frustumTest, frameName: frameName, atlas: atlasManager, material: material, materialOptions: { alphaMode: 'BLEND' } });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || SpriteComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || SpriteActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isOrthographicCamera) {\r\n        var _d = child, far = _d.far, near = _d.near, left = _d.left, right = _d.right, top_1 = _d.top, bottom = _d.bottom, backgroundMat = _d.backgroundMat;\r\n        Object.assign(initOptions, { far: far, near: near, left: left, right: right, top: top_1, bottom: bottom, backgroundMat: backgroundMat });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || OrthographicCameraComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || OrthographicCameraActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isPerspectiveCamera) {\r\n        var _e = child, far = _e.far, near = _e.near, fov = _e.fov, aspect = _e.aspect, backgroundMat = _e.backgroundMat;\r\n        Object.assign(initOptions, { far: far, near: near, fov: fov, aspect: aspect, backgroundMat: backgroundMat });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || PerspectiveCameraComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || PerspectiveCameraActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isAmbientLight) {\r\n        var _f = child, amount = _f.amount, color = _f.color, shadow = _f.shadow;\r\n        Object.assign(initOptions, { amount: amount, color: color, shadow: shadow });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || AmbientLightComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || AmbientLightActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isDirectionalLight) {\r\n        var _g = child, amount = _g.amount, color = _g.color, shadow = _g.shadow, direction = _g.direction;\r\n        Object.assign(initOptions, { amount: amount, color: color, shadow: shadow, direction: direction });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || DirectionalLightComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || DirectionalLightActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isPointLight) {\r\n        var _h = child, amount = _h.amount, color = _h.color, shadow = _h.shadow, range = _h.range, constantAttenuation = _h.constantAttenuation, linearAttenuation = _h.linearAttenuation, quadraticAttenuation = _h.quadraticAttenuation;\r\n        Object.assign(initOptions, { amount: amount, color: color, shadow: shadow, range: range, constantAttenuation: constantAttenuation, linearAttenuation: linearAttenuation, quadraticAttenuation: quadraticAttenuation });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || PointLightComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || PointLightActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else if (child.isSpotLight) {\r\n        var _j = child, amount = _j.amount, color = _j.color, shadow = _j.shadow, range = _j.range, constantAttenuation = _j.constantAttenuation, linearAttenuation = _j.linearAttenuation, quadraticAttenuation = _j.quadraticAttenuation, cutoff = _j.cutoff, outerCutoff = _j.outerCutoff, direction = _j.direction;\r\n        Object.assign(initOptions, { amount: amount, color: color, shadow: shadow, range: range, constantAttenuation: constantAttenuation, linearAttenuation: linearAttenuation, quadraticAttenuation: quadraticAttenuation, cutoff: cutoff, outerCutoff: outerCutoff, direction: direction });\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || SpotLightComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || SpotLightActor, initOptions, parentActor, parent)).root;\r\n        }\r\n        node.childrenOffset += 1;\r\n    }\r\n    else {\r\n        if (isComponent) {\r\n            root = result = parentActor.addComponent(node.name, Class || SceneComponent, initOptions, parent);\r\n        }\r\n        else {\r\n            root = (result = world.addActor(node.name, Class || SceneActor, initOptions, parentActor, parent)).root;\r\n        }\r\n    }\r\n    root.cloneFromHiloNode(node);\r\n    root.needReleaseGlRes = false;\r\n    var animationId = root.hiloNode.animationId;\r\n    if (isComponent && resource.anim && resource.anim.validAnimationIds[animationId]) {\r\n        parentActor.animNameMap[animationId] = root.hiloNode;\r\n        parentActor.animCount += 1;\r\n    }\r\n    return result;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction convert(game, parent, children, actors, resource, forceAsComponent, className) {\r\n    if (forceAsComponent === void 0) { forceAsComponent = false; }\r\n    if (className === void 0) { className = null; }\r\n    // if parent is null\r\n    var isComponent = false;\r\n    var parentNode = null;\r\n    var parentSeinNode = null;\r\n    if (parent) {\r\n        if (isSceneActor$1(parent)) {\r\n            parentNode = parent.root.hiloNode;\r\n        }\r\n        else {\r\n            parentNode = parent.hiloNode;\r\n            // parent is component, child must be component\r\n            isComponent = true;\r\n        }\r\n    }\r\n    if (parentNode && parentNode.gltfExtensions && parentNode.gltfExtensions.Sein_node) {\r\n        parentSeinNode = parentNode.gltfExtensions.Sein_node;\r\n    }\r\n    else {\r\n        parentSeinNode = {};\r\n    }\r\n    var length = children.length;\r\n    var _loop_1 = function (i) {\r\n        var child = children[i];\r\n        child.gltfExtensions = child.gltfExtensions || {};\r\n        child.childrenOffset = 0;\r\n        var childSeinNode = void 0;\r\n        var skipThisNode = false;\r\n        if (child.gltfExtensions.Sein_node) {\r\n            childSeinNode = child.gltfExtensions.Sein_node;\r\n            skipThisNode = childSeinNode.skipThisNode;\r\n        }\r\n        if (forceAsComponent || className) {\r\n            childSeinNode = childSeinNode || {\r\n                selfType: ESeinNodeType.Actor,\r\n                childrenType: ESeinNodeType.Component\r\n            };\r\n        }\r\n        if (forceAsComponent) {\r\n            childSeinNode.selfType = ESeinNodeType.Component;\r\n        }\r\n        if (className) {\r\n            childSeinNode.className = className;\r\n        }\r\n        // parent is actor, childrenType is component and selfType of child is component\r\n        if (childSeinNode && childSeinNode.selfType === ESeinNodeType.Actor) {\r\n            isComponent = false;\r\n        }\r\n        else if (!isComponent\r\n            && parentSeinNode.childrenType === ESeinNodeType.Component\r\n            && (!childSeinNode || childSeinNode.selfType !== ESeinNodeType.Actor)) {\r\n            isComponent = true;\r\n        }\r\n        else if (childSeinNode && childSeinNode.selfType === ESeinNodeType.Component) {\r\n            isComponent = true;\r\n        }\r\n        var result = parent;\r\n        if (!skipThisNode) {\r\n            result = generateActorOrComponentFromNode(child, (parent && !isSceneActor$1(parent)) ? parent.getOwner() : parent, (parent && isSceneActor$1(parent)) ? null : parent, isComponent, resource, game.world);\r\n            if (isSceneActor$1(result)) {\r\n                var actor = result;\r\n                actor.animNameMap = {};\r\n                actor.animCount = 0;\r\n                actor.skeletalMeshComponents = actor.skeletalMeshComponents || [];\r\n                var animationId = actor.root.hiloNode.animationId;\r\n                if (resource.anim && resource.anim.validAnimationIds[animationId]) {\r\n                    actor.animNameMap[animationId] = actor.root.hiloNode;\r\n                    actor.animCount += 1;\r\n                }\r\n                actors.add(actor);\r\n            }\r\n            Object.keys(child.gltfExtensions).forEach(function (name) {\r\n                // 避免循环依赖，临时解决方案\r\n                var handler = Hilo3d$2.GLTFParser.extensionHandlers[name];\r\n                if (handler && handler.instantiate) {\r\n                    handler.instantiate(result, child.gltfExtensions[name], game, child, resource);\r\n                }\r\n            });\r\n        }\r\n        var offset = child.childrenOffset || 0;\r\n        // Leaf node\r\n        if (!child.children || child.children.length === offset) {\r\n            return \"continue\";\r\n        }\r\n        // const grandson = child.children[offset];\r\n        // if (child.children.length === offset + 1 && (!grandson.children || grandson.children.length === 0)) {\r\n        //   console.log(child, child.jointName);\r\n        //   continue;\r\n        // }\r\n        convert(game, result, child.children.slice(offset), actors, resource);\r\n    };\r\n    for (var i = 0; i < length; i += 1) {\r\n        _loop_1(i);\r\n    }\r\n}\r\n/* tslint:enable */\r\n/**\r\n * @hidden\r\n */\r\nfunction addActorsFromGlTF(game, entity, options) {\r\n    var resource = entity.result;\r\n    var node = resource.node;\r\n    if (options && options.nodePath && options.nodePath.length !== 0) {\r\n        node = resource.node.getChildByNamePath(options.nodePath);\r\n        if (!node) {\r\n            throw new Error(\"Resource \\\"\" + entity.name + \"\\\" in type \\\"GlTF\\\" dose not has node \\\"\" + options.nodePath.toString() + \"\\\" !\");\r\n        }\r\n    }\r\n    var children = null;\r\n    var actors = new SArray();\r\n    if (node !== resource.node) {\r\n        children = [node];\r\n    }\r\n    else {\r\n        children = node.children.slice();\r\n        var al = resource['ambientLight'];\r\n        if (al && !game.world.__gltfAmbientLightCreated) {\r\n            var lNode = new Hilo3d$2.Node();\r\n            lNode.name = al.name;\r\n            lNode.addChild(al);\r\n            children.push(lNode);\r\n            game.world.__gltfAmbientLightCreated = true;\r\n        }\r\n    }\r\n    if (options && options.name && children.length === 1) {\r\n        var child = children[0];\r\n        child.name = options.name;\r\n    }\r\n    convert(game, options && (options.parentActor || options.parentComponent), children, actors, resource, options && options.asComponent, options && (options.className || (options.Class && options.Class.CLASS_NAME.value)));\r\n    actors.forEach(function (a) {\r\n        var _a = a, animCount = _a.animCount, animNameMap = _a.animNameMap, skeletalMeshComponents = _a.skeletalMeshComponents;\r\n        var length = skeletalMeshComponents.length;\r\n        for (var i = 0; i < length; i += 1) {\r\n            var _b = skeletalMeshComponents[i], component = _b[0], meshes = _b[1];\r\n            var len = meshes.length;\r\n            for (var index = 0; index < len; index += 1) {\r\n                component.cloneSkinningFromHilo(meshes[index], index);\r\n            }\r\n        }\r\n        delete a.animCount;\r\n        delete a.animNameMap;\r\n        delete a.skeletalMeshComponents;\r\n        if (animCount > 0) {\r\n            var hiloNode = a.root.hiloNode;\r\n            hiloNode.anim = resource.anim.clone(null);\r\n            hiloNode.anim.nodeNameMap = animNameMap;\r\n            if (hiloNode.gltfExtensions.Sein_animator) {\r\n                var _c = hiloNode.gltfExtensions.Sein_animator, modelAnimations = _c.modelAnimations, prefix = _c.prefix, prefixes = _c.prefixes;\r\n                length = modelAnimations.length;\r\n                if (length !== 0) {\r\n                    var originClips = hiloNode.anim.clips;\r\n                    var clips = hiloNode.anim.clips = {};\r\n                    for (var index = 0; index < length; index += 1) {\r\n                        var name_1 = modelAnimations[index];\r\n                        var finalPrefix = prefixes ? (prefixes[index] || prefix) : prefix;\r\n                        clips[name_1] = originClips[finalPrefix ? finalPrefix + \"@\" + name_1 : name_1];\r\n                    }\r\n                }\r\n            }\r\n            a.addComponent('animator', AnimatorComponent);\r\n            if (hiloNode.gltfExtensions.Sein_animator) {\r\n                var defaultAnimation = hiloNode.gltfExtensions.Sein_animator.defaultAnimation;\r\n                if (defaultAnimation) {\r\n                    a.animator.setDefault(defaultAnimation);\r\n                }\r\n            }\r\n        }\r\n        if (options.preRender) {\r\n            a.preRender();\r\n        }\r\n        a.instantiated();\r\n    });\r\n    return actors;\r\n}\n\n/**\r\n * @hidden\r\n */\r\nfunction materialCreator(name, metaData, json, parser) {\r\n    if (!metaData || !metaData.extensions || !metaData.extensions['Sein_customMaterial']) {\r\n        return;\r\n    }\r\n    var extensions = metaData.extensions, alphaMode = metaData.alphaMode, doubleSided = metaData.doubleSided;\r\n    var _a = extensions['Sein_customMaterial'], className = _a.className, uniforms = _a.uniforms, cloneForInst = _a.cloneForInst, renderOrder = _a.renderOrder;\r\n    var MaterialClass = MetaSMaterials[className];\r\n    if (!MaterialClass) {\r\n        if (parser.ignoreMaterialError) {\r\n            Debug.warn(\"ShaderMaterial \\\"\" + className + \"\\\" is not existed, Please ensure your material is decorated with 'Sein.SMaterial' !\");\r\n            return;\r\n        }\r\n        else {\r\n            throw new Error(\"ShaderMaterial \\\"\" + className + \"\\\" is not existed, Please ensure your material is decorated with 'Sein.SMaterial' !\");\r\n        }\r\n    }\r\n    var options = { uniforms: {}, doubleSided: doubleSided, alphaMode: alphaMode, renderOrder: renderOrder };\r\n    if (uniforms) {\r\n        for (var key in uniforms) {\r\n            var _b = uniforms[key], type = _b.type, value = _b.value;\r\n            var v = null;\r\n            switch (type) {\r\n                case Constants.SAMPLER_2D:\r\n                    v = parser.textures[value.index];\r\n                    break;\r\n                case Constants.SAMPLER_CUBE:\r\n                    v = parser.cubeTextures[value.index];\r\n                    break;\r\n                case Constants.FLOAT_VEC2:\r\n                case Constants.INT_VEC2:\r\n                    v = new Vector2();\r\n                    v.fromArray(value);\r\n                    break;\r\n                case Constants.FLOAT_VEC3:\r\n                case Constants.INT_VEC3:\r\n                    v = new Vector3();\r\n                    v.fromArray(value);\r\n                    break;\r\n                case Constants.FLOAT_VEC4:\r\n                case Constants.INT_VEC4:\r\n                    v = new Color();\r\n                    v.fromArray(value);\r\n                    break;\r\n                case Constants.FLOAT_MAT3:\r\n                    v = new Matrix3();\r\n                    v.fromArray(value);\r\n                    break;\r\n                case Constants.FLOAT_MAT4:\r\n                    v = new Matrix4();\r\n                    v.fromArray(value);\r\n                    break;\r\n                default:\r\n                    v = uniforms[key].value;\r\n                    break;\r\n            }\r\n            options.uniforms[key] = { value: v };\r\n        }\r\n    }\r\n    var material = new MaterialClass(options);\r\n    if (cloneForInst !== undefined) {\r\n        material.cloneForInst = cloneForInst;\r\n    }\r\n    material.initCommonOptions(options, true);\r\n    var Sein_customMaterial = extensions.Sein_customMaterial, others = __rest(extensions, [\"Sein_customMaterial\"]);\r\n    parser.parseExtensions(others, material, { isMaterial: true });\r\n    return material;\r\n}\r\n/**\r\n * 判断一个实例是否为`GlTFLoader`。\r\n */\r\nfunction isGlTFLoader(value) {\r\n    return value.isGlTFLoader;\r\n}\r\n/**\r\n * GlTF加载器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar GlTFLoader = /** @class */ (function (_super) {\r\n    __extends(GlTFLoader, _super);\r\n    function GlTFLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._cache = {};\r\n        _this._cacheNames = {};\r\n        _this.isGlTFLoader = true;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 注册GlTFLoader的扩展。\r\n     */\r\n    GlTFLoader.REGISTER_EXTENSION = function (hander) {\r\n        if (!hander.parse) {\r\n            hander.parse = getDefaultParse(hander.name);\r\n        }\r\n        else {\r\n            var parse_1 = hander.parse;\r\n            hander.parse = function (info, parser, entity, options) {\r\n                getDefaultParse(hander.name);\r\n                return parse_1(info, parser, entity, options);\r\n            };\r\n        }\r\n        Hilo3d$2.GLTFParser.registerExtensionHandler(hander.name, hander);\r\n    };\r\n    /**\r\n     * 取消注册GlTFLoader的扩展。\r\n     */\r\n    GlTFLoader.UNREGISTER_EXTENSION = function (hander) {\r\n        Hilo3d$2.GLTFParser.unregisterExtensionHandler(hander.name);\r\n    };\r\n    /**\r\n     * 获取GlTFLoader的扩展。\r\n     */\r\n    GlTFLoader.GET_EXTENSION_HANDLER = function (name) {\r\n        return Hilo3d$2.GLTFParser.extensionHandlers[name];\r\n    };\r\n    GlTFLoader.prototype.load = function (entity, callbacks) {\r\n        var _this = this;\r\n        if (this._cache[entity.url]) {\r\n            this._cacheNames[entity.url].push(entity.name);\r\n            entity.result = this._cache[entity.url];\r\n            callbacks.onLoaded(entity);\r\n            return;\r\n        }\r\n        var loader = new Hilo3d$2.GLTFLoader();\r\n        loader.game = this.game;\r\n        loader.on('progress', function (event) {\r\n            var _a = event.detail, loaded = _a.loaded, total = _a.total;\r\n            if (total > 0) {\r\n                callbacks.onLoading(entity, loaded / total);\r\n            }\r\n        });\r\n        loader.load({\r\n            src: entity.url,\r\n            isProgressive: entity.isProgressive || false,\r\n            customMaterialCreator: materialCreator,\r\n            isLoadAllTextures: true,\r\n            ignoreTextureError: entity.ignoreTextureError,\r\n            game: this.game,\r\n            ignoreMaterialError: entity.ignoreMaterialError || false,\r\n            forceCreateNewBuffer: entity.forceCreateNewBuffer || false\r\n        })\r\n            .then(function (result) {\r\n            entity.result = result;\r\n            _this._cacheNames[entity.url] = _this._cacheNames[entity.url] || [];\r\n            _this._cacheNames[entity.url][entity.name] = true;\r\n            _this._cache[entity.url] = entity.result;\r\n            callbacks.onLoaded(entity);\r\n        })\r\n            .catch(function (error) { return callbacks.onError(entity, error); });\r\n    };\r\n    /**\r\n     * 将GlTF资源实例化为Actor或者Component。\r\n     */\r\n    GlTFLoader.prototype.instantiate = function (entity, options) {\r\n        return addActorsFromGlTF(this.game, entity, options);\r\n    };\r\n    /**\r\n     * 释放资源时将会调用，用于自定义释放逻辑。\r\n     */\r\n    GlTFLoader.prototype.release = function (entity) {\r\n        var list = this._cacheNames[entity.url];\r\n        if (!list) {\r\n            return;\r\n        }\r\n        if (list.length > 1) {\r\n            list.splice(list.indexOf(entity.name), 1);\r\n            return;\r\n        }\r\n        delete this._cacheNames[entity.url];\r\n        delete this._cache[entity.url];\r\n        entity.result.node.destroy(this.game.renderer, true);\r\n    };\r\n    /**\r\n     * 开发者无需关心。\r\n     *\r\n     * @hidden\r\n     */\r\n    GlTFLoader.clearCache = function () {\r\n        Hilo3d$2.GLTFLoader.clearCache();\r\n    };\r\n    GlTFLoader.FORMATS = ['.gltf', '.glb'];\r\n    GlTFLoader = __decorate([\r\n        SClass({ className: 'GlTFLoader' })\r\n    ], GlTFLoader);\r\n    return GlTFLoader;\r\n}(ResourceLoader));\r\nGlTFLoader.REGISTER_EXTENSION(SeinCubeTextureExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinNodeExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinPhysicBodyExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinAnimatorExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinRendererExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinAmbientLightExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinImageBasedLightingExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinAtlasExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinSpriteExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinCustomMaterialExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinSkyboxExtension);\r\nGlTFLoader.REGISTER_EXTENSION(SeinTextureImproveExtension);\n\n/**\r\n * @hidden\r\n */\r\nfunction getExt(url) {\r\n    return '.' + url.split('.').pop();\r\n}\r\n/**\r\n * 判断一个实例是否为`ResourceManager`。\r\n */\r\nfunction isResourceManager(value) {\r\n    return value.isResourceManager;\r\n}\r\n/**\r\n * 资源管理器类。作为资源的集中管理容器，承担着引擎所有的资源加载器的注册、销毁，以及资源的添加、加载和释放。\r\n *\r\n * @template IDefaultLoaders 用于标注所有资源的名称以及对应的事件参数类型。\r\n * @noInheritDoc\r\n */\r\nvar ResourceManager = /** @class */ (function (_super) {\r\n    __extends(ResourceManager, _super);\r\n    /**\r\n     * @hidden\r\n     */\r\n    function ResourceManager(game) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isResourceManager = true;\r\n        _this._onError = new Observable(_this);\r\n        _this._onLoading = new Observable(_this);\r\n        _this._onLoaded = new Observable(_this);\r\n        _this._loaders = {};\r\n        _this._loadersFormat = {};\r\n        _this._queue = {};\r\n        _this._store = {};\r\n        _this._state = {\r\n            totalCount: 0,\r\n            loadedCount: 0,\r\n            progress: 0,\r\n            totalWeight: 0,\r\n            loadDone: true,\r\n            current: null\r\n        };\r\n        _this.handleLoadingOne = function (entity, progress) {\r\n            // resource has been canceled\r\n            if (!_this._queue[entity.name]) {\r\n                return;\r\n            }\r\n            var weight = entity.weight, preProgress = entity.preProgress;\r\n            entity.preProgress = progress;\r\n            _this._state.current = entity;\r\n            _this._state.progress += (weight * (progress - preProgress) / _this._state.totalWeight);\r\n            _this.onLoading.notify(Object.assign({}, _this._state));\r\n        };\r\n        _this.handleLoadedOne = function (entity, error) {\r\n            if (error === void 0) { error = null; }\r\n            var weight = entity.weight, preProgress = entity.preProgress;\r\n            var progress = 1;\r\n            entity.preProgress = progress;\r\n            _this._state.current = entity;\r\n            _this._state.progress += (weight * (progress - preProgress) / _this._state.totalWeight);\r\n            _this._state.loadedCount += 1;\r\n            delete _this._queue[entity.name];\r\n            if (!error) {\r\n                _this._store[entity.name] = entity;\r\n            }\r\n            else {\r\n                _this.onError.notify({ error: error, state: Object.assign({}, _this._state) });\r\n            }\r\n            _this.onLoading.notify(Object.assign(error ? { error: error } : {}, _this._state));\r\n            if (_this._state.loadedCount === _this._state.totalCount) {\r\n                _this.handleLoadDone();\r\n            }\r\n        };\r\n        _this._game = game;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ResourceManager.prototype, \"loadDone\", {\r\n        /**\r\n         * 此批资源是否加载完毕。\r\n         */\r\n        get: function () {\r\n            return this._state.loadDone;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ResourceManager.prototype, \"parent\", {\r\n        /**\r\n         * 获取父级Game实例。\r\n         */\r\n        get: function () {\r\n            return this._game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ResourceManager.prototype, \"onError\", {\r\n        /**\r\n         * 此批资源加载错误时的可观察实例。\r\n         */\r\n        get: function () {\r\n            return this._onError;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ResourceManager.prototype, \"onLoading\", {\r\n        /**\r\n         * 此批资源加载进度更新时的可观察实例。\r\n         */\r\n        get: function () {\r\n            return this._onLoading;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ResourceManager.prototype, \"onLoaded\", {\r\n        /**\r\n         * 此批资源加载完毕时的可观察实例。\r\n         */\r\n        get: function () {\r\n            return this._onLoaded;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    ResourceManager.prototype.getLoader = function (type) {\r\n        return this._loaders[type];\r\n    };\r\n    /**\r\n     * 获取一个指定格式的Loader。\r\n     *\r\n     * **指定格式需要在`ResourceLoader.EXTENSIONS`静态变量中定义！**\r\n     */\r\n    ResourceManager.prototype.getLoaderByFormat = function (format) {\r\n        return this.getLoader(this._loadersFormat[format]);\r\n    };\r\n    ResourceManager.prototype.register = function (type, LoaderClass) {\r\n        var _this = this;\r\n        if (this._loaders[type]) {\r\n            throw new MemberConflictException(this, 'Loader', type, this, 'You should unregister it at first !');\r\n        }\r\n        var loader = new LoaderClass();\r\n        loader.game = this._game;\r\n        this._loaders[type] = loader;\r\n        (LoaderClass.FORMATS || []).forEach(function (format) {\r\n            _this._loadersFormat[format] = type;\r\n        });\r\n        return this;\r\n    };\r\n    ResourceManager.prototype.unregister = function (type) {\r\n        var _this = this;\r\n        if (!this._loaders[type]) {\r\n            return;\r\n        }\r\n        (this._loaders[type].constructor || []).FORMATS.forEach(function (format) {\r\n            delete _this._loadersFormat[format];\r\n        });\r\n        delete this._loaders[type];\r\n        return this;\r\n    };\r\n    ResourceManager.prototype.add = function (type, name, resource) {\r\n        if (!this._loaders[type]) {\r\n            throw new MissingMemberException(this, 'Loader', type, this, 'Register it before adding resource !');\r\n        }\r\n        if (this._store[name]) {\r\n            return;\r\n        }\r\n        this._store[name] = { name: name, result: resource, type: type, url: '' };\r\n        return this;\r\n    };\r\n    /**\r\n     * 判断一个资源是否已经存在。\r\n     */\r\n    ResourceManager.prototype.has = function (name) {\r\n        return !!this._store[name];\r\n    };\r\n    ResourceManager.prototype.get = function (name) {\r\n        if (!this._store[name]) {\r\n            Debug.warn(\"Resource \" + name + \" is not existed !\");\r\n            return null;\r\n        }\r\n        return this._store[name].result;\r\n    };\r\n    /**\r\n     * 释放一个指定的资源。\r\n     */\r\n    ResourceManager.prototype.release = function (name) {\r\n        var entity = this._store[name];\r\n        if (!entity) {\r\n            throw new MissingMemberException(this, 'Entity', name, this);\r\n        }\r\n        this._loaders[entity.type].release(entity);\r\n        delete this._store[name];\r\n        return this;\r\n    };\r\n    /**\r\n     * 清除所有资源。\r\n     */\r\n    ResourceManager.prototype.clear = function () {\r\n        for (var name_1 in this._store) {\r\n            this.release(name_1);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 取消特定资源加载。\r\n     */\r\n    ResourceManager.prototype.cancel = function (name) {\r\n        if (!this._queue[name]) {\r\n            return;\r\n        }\r\n        var entity = this._queue[name].entity;\r\n        delete this._queue[name];\r\n        this._loaders[entity.type].cancel(entity);\r\n        this._state.loadedCount += 1;\r\n        if (this._state.loadedCount === this._state.totalCount) {\r\n            this.handleLoadDone();\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 取消当前所有资源加载。\r\n     */\r\n    ResourceManager.prototype.cancelAll = function () {\r\n        for (var key in this._queue) {\r\n            this.cancel(key);\r\n        }\r\n        return this;\r\n    };\r\n    ResourceManager.prototype.load = function (entity) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var type, loader, pending;\r\n            var _this = this;\r\n            return __generator(this, function (_a) {\r\n                if (typeof entity.url === 'function') {\r\n                    entity.url = entity.url(this._game);\r\n                }\r\n                type = entity.type || this._loadersFormat[getExt(entity.url)];\r\n                if (!this._loaders[type]) {\r\n                    throw new MissingMemberException(this, 'Loader', type, this, 'Register it before adding resource !');\r\n                }\r\n                if (this._store[entity.name]) {\r\n                    return [2 /*return*/, this._store[entity.name]];\r\n                }\r\n                if (this._queue[entity.name]) {\r\n                    return [2 /*return*/, this._queue[entity.name]];\r\n                }\r\n                loader = this._loaders[type];\r\n                entity.type = type;\r\n                entity.weight = entity.weight || 1;\r\n                entity.preProgress = 0;\r\n                entity.canceled = false;\r\n                this._state.totalCount += 1;\r\n                this._state.totalWeight += entity.weight;\r\n                this._state.loadDone = false;\r\n                pending = new Promise(function (resolve, reject) {\r\n                    loader.load(entity, {\r\n                        onLoading: _this.handleLoadingOne,\r\n                        onLoaded: function () {\r\n                            // resource has been canceled\r\n                            if (!_this._queue[entity.name]) {\r\n                                return;\r\n                            }\r\n                            _this.handleLoadedOne(entity);\r\n                            resolve(entity.result);\r\n                        },\r\n                        onError: function (_, error) {\r\n                            // resource has been canceled\r\n                            if (!_this._queue[entity.name]) {\r\n                                return;\r\n                            }\r\n                            var stack = error.stack;\r\n                            error = new ResourceLoadException(entity.name, _this, error.message);\r\n                            error.stack = stack;\r\n                            _this.handleLoadedOne(entity, error);\r\n                            reject(error);\r\n                        }\r\n                    });\r\n                });\r\n                this._queue[entity.name] = { pending: pending, entity: entity };\r\n                return [2 /*return*/, this._queue[entity.name].pending];\r\n            });\r\n        });\r\n    };\r\n    ResourceManager.prototype.instantiate = function (resourceName, options) {\r\n        var entity = this._store[resourceName];\r\n        if (!entity) {\r\n            throw new MissingMemberException(this, 'Entity', resourceName, this);\r\n        }\r\n        return this._loaders[entity.type].instantiate(entity, options || {});\r\n    };\r\n    ResourceManager.prototype.handleLoadDone = function () {\r\n        GlTFLoader.clearCache();\r\n        this._state.loadDone = true;\r\n        this._state.progress = 1;\r\n        var state = Object.assign({}, this._state);\r\n        this._state.totalCount = 0;\r\n        this._state.loadedCount = 0;\r\n        this._state.totalWeight = 0;\r\n        this._state.progress = 0;\r\n        this._state.current = null;\r\n        this.onLoaded.notify(state);\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    ResourceManager.prototype.onDestroy = function () {\r\n        if (!this._state.loadDone) {\r\n            this.cancelAll();\r\n        }\r\n        this.clear();\r\n        this._loaders = {};\r\n    };\r\n    ResourceManager = __decorate([\r\n        SClass({ className: 'ResourceManager' })\r\n    ], ResourceManager);\r\n    return ResourceManager;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`ImageLoader`。\r\n */\r\nfunction isImageLoader(value) {\r\n    return value.isImageLoader;\r\n}\r\n/**\r\n * 图片加载器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar ImageLoader = /** @class */ (function (_super) {\r\n    __extends(ImageLoader, _super);\r\n    function ImageLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isImageLoader = true;\r\n        return _this;\r\n    }\r\n    ImageLoader.prototype.load = function (entity, callbacks) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var image;\r\n            return __generator(this, function (_a) {\r\n                image = document.createElement('img');\r\n                image.onload = function () {\r\n                    image.onerror = null;\r\n                    image.onabort = null;\r\n                    image.onload = null;\r\n                    if (entity.canceled) {\r\n                        return;\r\n                    }\r\n                    entity.result = image;\r\n                    callbacks.onLoaded(entity);\r\n                };\r\n                image.onerror = function () {\r\n                    callbacks.onError(entity, new Error(\"Error when loading \" + entity.url));\r\n                };\r\n                image.crossOrigin = (entity.crossOrigin || false) ? 'Anonymous' : '';\r\n                image.src = entity.url;\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    ImageLoader = __decorate([\r\n        SClass({ className: 'ImageLoader' })\r\n    ], ImageLoader);\r\n    return ImageLoader;\r\n}(ResourceLoader));\n\n/**\r\n * 判断一个实例是否为`TextureLoader`。\r\n */\r\nfunction isTextureLoader(value) {\r\n    return value.isTextureLoader;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nvar loader = new Hilo3d$2.TextureLoader();\r\n/**\r\n * @hidden\r\n */\r\nvar hdrLoader = new Hilo3d$2.HDRLoader;\r\n/**\r\n * @hidden\r\n */\r\nvar ktxLoader = new Hilo3d$2.KTXLoader;\r\n/**\r\n * 纹理加载器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar TextureLoader = /** @class */ (function (_super) {\r\n    __extends(TextureLoader, _super);\r\n    function TextureLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isTextureLoader = true;\r\n        return _this;\r\n    }\r\n    TextureLoader.prototype.load = function (entity, callbacks) {\r\n        var realLoader = (entity.hdr || /.hdr$/.test(entity.url)) ? hdrLoader : (entity.ktx || /.ktx$/.test(entity.url)) ? ktxLoader : loader;\r\n        realLoader.load({\r\n            src: entity.url,\r\n            crossOrigin: entity.crossOrigin || false,\r\n            uv: entity.uv || 0,\r\n            flipY: entity.flipY,\r\n            isImageCanRelease: entity.isImageCanRelease\r\n        })\r\n            .then(function (result) {\r\n            entity.result = result;\r\n            callbacks.onLoaded(entity);\r\n        })\r\n            .catch(function (error) { return callbacks.onError(entity, error); });\r\n    };\r\n    /**\r\n     * 释放资源时将会调用，用于自定义释放逻辑。\r\n     */\r\n    TextureLoader.prototype.release = function (entity) {\r\n        entity.result.destroy();\r\n    };\r\n    TextureLoader.EXTENSIONS = ['.png', '.jpg', '.bmp', '.hdr', '.ktx'];\r\n    TextureLoader = __decorate([\r\n        SClass({ className: 'TextureLoader' })\r\n    ], TextureLoader);\r\n    return TextureLoader;\r\n}(ResourceLoader));\n\nvar axios = createCommonjsModule(function (module, exports) {\n/* axios v0.18.1 | (c) 2019 by Matt Zabriskie */\n(function webpackUniversalModuleDefinition(root, factory) {\n\tmodule.exports = factory();\n})(commonjsGlobal, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\tmodule.exports = __webpack_require__(1);\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\tvar bind = __webpack_require__(3);\n\tvar Axios = __webpack_require__(5);\n\tvar defaults = __webpack_require__(6);\n\t\n\t/**\n\t * Create an instance of Axios\n\t *\n\t * @param {Object} defaultConfig The default config for the instance\n\t * @return {Axios} A new instance of Axios\n\t */\n\tfunction createInstance(defaultConfig) {\n\t  var context = new Axios(defaultConfig);\n\t  var instance = bind(Axios.prototype.request, context);\n\t\n\t  // Copy axios.prototype to instance\n\t  utils.extend(instance, Axios.prototype, context);\n\t\n\t  // Copy context to instance\n\t  utils.extend(instance, context);\n\t\n\t  return instance;\n\t}\n\t\n\t// Create the default instance to be exported\n\tvar axios = createInstance(defaults);\n\t\n\t// Expose Axios class to allow class inheritance\n\taxios.Axios = Axios;\n\t\n\t// Factory for creating new instances\n\taxios.create = function create(instanceConfig) {\n\t  return createInstance(utils.merge(defaults, instanceConfig));\n\t};\n\t\n\t// Expose Cancel & CancelToken\n\taxios.Cancel = __webpack_require__(22);\n\taxios.CancelToken = __webpack_require__(23);\n\taxios.isCancel = __webpack_require__(19);\n\t\n\t// Expose all/spread\n\taxios.all = function all(promises) {\n\t  return Promise.all(promises);\n\t};\n\taxios.spread = __webpack_require__(24);\n\t\n\tmodule.exports = axios;\n\t\n\t// Allow use of default import syntax in TypeScript\n\tmodule.exports.default = axios;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar bind = __webpack_require__(3);\n\tvar isBuffer = __webpack_require__(4);\n\t\n\t/*global toString:true*/\n\t\n\t// utils is a library of generic helper functions non-specific to axios\n\t\n\tvar toString = Object.prototype.toString;\n\t\n\t/**\n\t * Determine if a value is an Array\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is an Array, otherwise false\n\t */\n\tfunction isArray(val) {\n\t  return toString.call(val) === '[object Array]';\n\t}\n\t\n\t/**\n\t * Determine if a value is an ArrayBuffer\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is an ArrayBuffer, otherwise false\n\t */\n\tfunction isArrayBuffer(val) {\n\t  return toString.call(val) === '[object ArrayBuffer]';\n\t}\n\t\n\t/**\n\t * Determine if a value is a FormData\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is an FormData, otherwise false\n\t */\n\tfunction isFormData(val) {\n\t  return (typeof FormData !== 'undefined') && (val instanceof FormData);\n\t}\n\t\n\t/**\n\t * Determine if a value is a view on an ArrayBuffer\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a view on an ArrayBuffer, otherwise false\n\t */\n\tfunction isArrayBufferView(val) {\n\t  var result;\n\t  if ((typeof ArrayBuffer !== 'undefined') && (ArrayBuffer.isView)) {\n\t    result = ArrayBuffer.isView(val);\n\t  } else {\n\t    result = (val) && (val.buffer) && (val.buffer instanceof ArrayBuffer);\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * Determine if a value is a String\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a String, otherwise false\n\t */\n\tfunction isString(val) {\n\t  return typeof val === 'string';\n\t}\n\t\n\t/**\n\t * Determine if a value is a Number\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a Number, otherwise false\n\t */\n\tfunction isNumber(val) {\n\t  return typeof val === 'number';\n\t}\n\t\n\t/**\n\t * Determine if a value is undefined\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if the value is undefined, otherwise false\n\t */\n\tfunction isUndefined(val) {\n\t  return typeof val === 'undefined';\n\t}\n\t\n\t/**\n\t * Determine if a value is an Object\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is an Object, otherwise false\n\t */\n\tfunction isObject(val) {\n\t  return val !== null && typeof val === 'object';\n\t}\n\t\n\t/**\n\t * Determine if a value is a Date\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a Date, otherwise false\n\t */\n\tfunction isDate(val) {\n\t  return toString.call(val) === '[object Date]';\n\t}\n\t\n\t/**\n\t * Determine if a value is a File\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a File, otherwise false\n\t */\n\tfunction isFile(val) {\n\t  return toString.call(val) === '[object File]';\n\t}\n\t\n\t/**\n\t * Determine if a value is a Blob\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a Blob, otherwise false\n\t */\n\tfunction isBlob(val) {\n\t  return toString.call(val) === '[object Blob]';\n\t}\n\t\n\t/**\n\t * Determine if a value is a Function\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a Function, otherwise false\n\t */\n\tfunction isFunction(val) {\n\t  return toString.call(val) === '[object Function]';\n\t}\n\t\n\t/**\n\t * Determine if a value is a Stream\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a Stream, otherwise false\n\t */\n\tfunction isStream(val) {\n\t  return isObject(val) && isFunction(val.pipe);\n\t}\n\t\n\t/**\n\t * Determine if a value is a URLSearchParams object\n\t *\n\t * @param {Object} val The value to test\n\t * @returns {boolean} True if value is a URLSearchParams object, otherwise false\n\t */\n\tfunction isURLSearchParams(val) {\n\t  return typeof URLSearchParams !== 'undefined' && val instanceof URLSearchParams;\n\t}\n\t\n\t/**\n\t * Trim excess whitespace off the beginning and end of a string\n\t *\n\t * @param {String} str The String to trim\n\t * @returns {String} The String freed of excess whitespace\n\t */\n\tfunction trim(str) {\n\t  return str.replace(/^\\s*/, '').replace(/\\s*$/, '');\n\t}\n\t\n\t/**\n\t * Determine if we're running in a standard browser environment\n\t *\n\t * This allows axios to run in a web worker, and react-native.\n\t * Both environments support XMLHttpRequest, but not fully standard globals.\n\t *\n\t * web workers:\n\t *  typeof window -> undefined\n\t *  typeof document -> undefined\n\t *\n\t * react-native:\n\t *  navigator.product -> 'ReactNative'\n\t */\n\tfunction isStandardBrowserEnv() {\n\t  if (typeof navigator !== 'undefined' && navigator.product === 'ReactNative') {\n\t    return false;\n\t  }\n\t  return (\n\t    typeof window !== 'undefined' &&\n\t    typeof document !== 'undefined'\n\t  );\n\t}\n\t\n\t/**\n\t * Iterate over an Array or an Object invoking a function for each item.\n\t *\n\t * If `obj` is an Array callback will be called passing\n\t * the value, index, and complete array for each item.\n\t *\n\t * If 'obj' is an Object callback will be called passing\n\t * the value, key, and complete object for each property.\n\t *\n\t * @param {Object|Array} obj The object to iterate\n\t * @param {Function} fn The callback to invoke for each item\n\t */\n\tfunction forEach(obj, fn) {\n\t  // Don't bother if no value provided\n\t  if (obj === null || typeof obj === 'undefined') {\n\t    return;\n\t  }\n\t\n\t  // Force an array if not already something iterable\n\t  if (typeof obj !== 'object') {\n\t    /*eslint no-param-reassign:0*/\n\t    obj = [obj];\n\t  }\n\t\n\t  if (isArray(obj)) {\n\t    // Iterate over array values\n\t    for (var i = 0, l = obj.length; i < l; i++) {\n\t      fn.call(null, obj[i], i, obj);\n\t    }\n\t  } else {\n\t    // Iterate over object keys\n\t    for (var key in obj) {\n\t      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t        fn.call(null, obj[key], key, obj);\n\t      }\n\t    }\n\t  }\n\t}\n\t\n\t/**\n\t * Accepts varargs expecting each argument to be an object, then\n\t * immutably merges the properties of each object and returns result.\n\t *\n\t * When multiple objects contain the same key the later object in\n\t * the arguments list will take precedence.\n\t *\n\t * Example:\n\t *\n\t * ```js\n\t * var result = merge({foo: 123}, {foo: 456});\n\t * console.log(result.foo); // outputs 456\n\t * ```\n\t *\n\t * @param {Object} obj1 Object to merge\n\t * @returns {Object} Result of all merge properties\n\t */\n\tfunction merge(/* obj1, obj2, obj3, ... */) {\n\t  var result = {};\n\t  function assignValue(val, key) {\n\t    if (typeof result[key] === 'object' && typeof val === 'object') {\n\t      result[key] = merge(result[key], val);\n\t    } else {\n\t      result[key] = val;\n\t    }\n\t  }\n\t\n\t  for (var i = 0, l = arguments.length; i < l; i++) {\n\t    forEach(arguments[i], assignValue);\n\t  }\n\t  return result;\n\t}\n\t\n\t/**\n\t * Extends object a by mutably adding to it the properties of object b.\n\t *\n\t * @param {Object} a The object to be extended\n\t * @param {Object} b The object to copy properties from\n\t * @param {Object} thisArg The object to bind function to\n\t * @return {Object} The resulting value of object a\n\t */\n\tfunction extend(a, b, thisArg) {\n\t  forEach(b, function assignValue(val, key) {\n\t    if (thisArg && typeof val === 'function') {\n\t      a[key] = bind(val, thisArg);\n\t    } else {\n\t      a[key] = val;\n\t    }\n\t  });\n\t  return a;\n\t}\n\t\n\tmodule.exports = {\n\t  isArray: isArray,\n\t  isArrayBuffer: isArrayBuffer,\n\t  isBuffer: isBuffer,\n\t  isFormData: isFormData,\n\t  isArrayBufferView: isArrayBufferView,\n\t  isString: isString,\n\t  isNumber: isNumber,\n\t  isObject: isObject,\n\t  isUndefined: isUndefined,\n\t  isDate: isDate,\n\t  isFile: isFile,\n\t  isBlob: isBlob,\n\t  isFunction: isFunction,\n\t  isStream: isStream,\n\t  isURLSearchParams: isURLSearchParams,\n\t  isStandardBrowserEnv: isStandardBrowserEnv,\n\t  forEach: forEach,\n\t  merge: merge,\n\t  extend: extend,\n\t  trim: trim\n\t};\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports) {\n\t\n\tmodule.exports = function bind(fn, thisArg) {\n\t  return function wrap() {\n\t    var args = new Array(arguments.length);\n\t    for (var i = 0; i < args.length; i++) {\n\t      args[i] = arguments[i];\n\t    }\n\t    return fn.apply(thisArg, args);\n\t  };\n\t};\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports) {\n\n\t/*!\n\t * Determine if an object is a Buffer\n\t *\n\t * @author   Feross Aboukhadijeh <https://feross.org>\n\t * @license  MIT\n\t */\n\t\n\tmodule.exports = function isBuffer (obj) {\n\t  return obj != null && obj.constructor != null &&\n\t    typeof obj.constructor.isBuffer === 'function' && obj.constructor.isBuffer(obj)\n\t};\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar defaults = __webpack_require__(6);\n\tvar utils = __webpack_require__(2);\n\tvar InterceptorManager = __webpack_require__(16);\n\tvar dispatchRequest = __webpack_require__(17);\n\t\n\t/**\n\t * Create a new instance of Axios\n\t *\n\t * @param {Object} instanceConfig The default config for the instance\n\t */\n\tfunction Axios(instanceConfig) {\n\t  this.defaults = instanceConfig;\n\t  this.interceptors = {\n\t    request: new InterceptorManager(),\n\t    response: new InterceptorManager()\n\t  };\n\t}\n\t\n\t/**\n\t * Dispatch a request\n\t *\n\t * @param {Object} config The config specific for this request (merged with this.defaults)\n\t */\n\tAxios.prototype.request = function request(config) {\n\t  /*eslint no-param-reassign:0*/\n\t  // Allow for axios('example/url'[, config]) a la fetch API\n\t  if (typeof config === 'string') {\n\t    config = utils.merge({\n\t      url: arguments[0]\n\t    }, arguments[1]);\n\t  }\n\t\n\t  config = utils.merge(defaults, {method: 'get'}, this.defaults, config);\n\t  config.method = config.method.toLowerCase();\n\t\n\t  // Hook up interceptors middleware\n\t  var chain = [dispatchRequest, undefined];\n\t  var promise = Promise.resolve(config);\n\t\n\t  this.interceptors.request.forEach(function unshiftRequestInterceptors(interceptor) {\n\t    chain.unshift(interceptor.fulfilled, interceptor.rejected);\n\t  });\n\t\n\t  this.interceptors.response.forEach(function pushResponseInterceptors(interceptor) {\n\t    chain.push(interceptor.fulfilled, interceptor.rejected);\n\t  });\n\t\n\t  while (chain.length) {\n\t    promise = promise.then(chain.shift(), chain.shift());\n\t  }\n\t\n\t  return promise;\n\t};\n\t\n\t// Provide aliases for supported request methods\n\tutils.forEach(['delete', 'get', 'head', 'options'], function forEachMethodNoData(method) {\n\t  /*eslint func-names:0*/\n\t  Axios.prototype[method] = function(url, config) {\n\t    return this.request(utils.merge(config || {}, {\n\t      method: method,\n\t      url: url\n\t    }));\n\t  };\n\t});\n\t\n\tutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n\t  /*eslint func-names:0*/\n\t  Axios.prototype[method] = function(url, data, config) {\n\t    return this.request(utils.merge(config || {}, {\n\t      method: method,\n\t      url: url,\n\t      data: data\n\t    }));\n\t  };\n\t});\n\t\n\tmodule.exports = Axios;\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\tvar normalizeHeaderName = __webpack_require__(7);\n\t\n\tvar DEFAULT_CONTENT_TYPE = {\n\t  'Content-Type': 'application/x-www-form-urlencoded'\n\t};\n\t\n\tfunction setContentTypeIfUnset(headers, value) {\n\t  if (!utils.isUndefined(headers) && utils.isUndefined(headers['Content-Type'])) {\n\t    headers['Content-Type'] = value;\n\t  }\n\t}\n\t\n\tfunction getDefaultAdapter() {\n\t  var adapter;\n\t  if (typeof XMLHttpRequest !== 'undefined') {\n\t    // For browsers use XHR adapter\n\t    adapter = __webpack_require__(8);\n\t  } else if (typeof process !== 'undefined') {\n\t    // For node use HTTP adapter\n\t    adapter = __webpack_require__(8);\n\t  }\n\t  return adapter;\n\t}\n\t\n\tvar defaults = {\n\t  adapter: getDefaultAdapter(),\n\t\n\t  transformRequest: [function transformRequest(data, headers) {\n\t    normalizeHeaderName(headers, 'Content-Type');\n\t    if (utils.isFormData(data) ||\n\t      utils.isArrayBuffer(data) ||\n\t      utils.isBuffer(data) ||\n\t      utils.isStream(data) ||\n\t      utils.isFile(data) ||\n\t      utils.isBlob(data)\n\t    ) {\n\t      return data;\n\t    }\n\t    if (utils.isArrayBufferView(data)) {\n\t      return data.buffer;\n\t    }\n\t    if (utils.isURLSearchParams(data)) {\n\t      setContentTypeIfUnset(headers, 'application/x-www-form-urlencoded;charset=utf-8');\n\t      return data.toString();\n\t    }\n\t    if (utils.isObject(data)) {\n\t      setContentTypeIfUnset(headers, 'application/json;charset=utf-8');\n\t      return JSON.stringify(data);\n\t    }\n\t    return data;\n\t  }],\n\t\n\t  transformResponse: [function transformResponse(data) {\n\t    /*eslint no-param-reassign:0*/\n\t    if (typeof data === 'string') {\n\t      try {\n\t        data = JSON.parse(data);\n\t      } catch (e) { /* Ignore */ }\n\t    }\n\t    return data;\n\t  }],\n\t\n\t  /**\n\t   * A timeout in milliseconds to abort a request. If set to 0 (default) a\n\t   * timeout is not created.\n\t   */\n\t  timeout: 0,\n\t\n\t  xsrfCookieName: 'XSRF-TOKEN',\n\t  xsrfHeaderName: 'X-XSRF-TOKEN',\n\t\n\t  maxContentLength: -1,\n\t\n\t  validateStatus: function validateStatus(status) {\n\t    return status >= 200 && status < 300;\n\t  }\n\t};\n\t\n\tdefaults.headers = {\n\t  common: {\n\t    'Accept': 'application/json, text/plain, */*'\n\t  }\n\t};\n\t\n\tutils.forEach(['delete', 'get', 'head'], function forEachMethodNoData(method) {\n\t  defaults.headers[method] = {};\n\t});\n\t\n\tutils.forEach(['post', 'put', 'patch'], function forEachMethodWithData(method) {\n\t  defaults.headers[method] = utils.merge(DEFAULT_CONTENT_TYPE);\n\t});\n\t\n\tmodule.exports = defaults;\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\tmodule.exports = function normalizeHeaderName(headers, normalizedName) {\n\t  utils.forEach(headers, function processHeader(value, name) {\n\t    if (name !== normalizedName && name.toUpperCase() === normalizedName.toUpperCase()) {\n\t      headers[normalizedName] = value;\n\t      delete headers[name];\n\t    }\n\t  });\n\t};\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\tvar settle = __webpack_require__(9);\n\tvar buildURL = __webpack_require__(12);\n\tvar parseHeaders = __webpack_require__(13);\n\tvar isURLSameOrigin = __webpack_require__(14);\n\tvar createError = __webpack_require__(10);\n\t\n\tmodule.exports = function xhrAdapter(config) {\n\t  return new Promise(function dispatchXhrRequest(resolve, reject) {\n\t    var requestData = config.data;\n\t    var requestHeaders = config.headers;\n\t\n\t    if (utils.isFormData(requestData)) {\n\t      delete requestHeaders['Content-Type']; // Let the browser set it\n\t    }\n\t\n\t    var request = new XMLHttpRequest();\n\t\n\t    // HTTP basic authentication\n\t    if (config.auth) {\n\t      var username = config.auth.username || '';\n\t      var password = config.auth.password || '';\n\t      requestHeaders.Authorization = 'Basic ' + btoa(username + ':' + password);\n\t    }\n\t\n\t    request.open(config.method.toUpperCase(), buildURL(config.url, config.params, config.paramsSerializer), true);\n\t\n\t    // Set the request timeout in MS\n\t    request.timeout = config.timeout;\n\t\n\t    // Listen for ready state\n\t    request.onreadystatechange = function handleLoad() {\n\t      if (!request || request.readyState !== 4) {\n\t        return;\n\t      }\n\t\n\t      // The request errored out and we didn't get a response, this will be\n\t      // handled by onerror instead\n\t      // With one exception: request that using file: protocol, most browsers\n\t      // will return status as 0 even though it's a successful request\n\t      if (request.status === 0 && !(request.responseURL && request.responseURL.indexOf('file:') === 0)) {\n\t        return;\n\t      }\n\t\n\t      // Prepare the response\n\t      var responseHeaders = 'getAllResponseHeaders' in request ? parseHeaders(request.getAllResponseHeaders()) : null;\n\t      var responseData = !config.responseType || config.responseType === 'text' ? request.responseText : request.response;\n\t      var response = {\n\t        data: responseData,\n\t        status: request.status,\n\t        statusText: request.statusText,\n\t        headers: responseHeaders,\n\t        config: config,\n\t        request: request\n\t      };\n\t\n\t      settle(resolve, reject, response);\n\t\n\t      // Clean up request\n\t      request = null;\n\t    };\n\t\n\t    // Handle low level network errors\n\t    request.onerror = function handleError() {\n\t      // Real errors are hidden from us by the browser\n\t      // onerror should only fire if it's a network error\n\t      reject(createError('Network Error', config, null, request));\n\t\n\t      // Clean up request\n\t      request = null;\n\t    };\n\t\n\t    // Handle timeout\n\t    request.ontimeout = function handleTimeout() {\n\t      reject(createError('timeout of ' + config.timeout + 'ms exceeded', config, 'ECONNABORTED',\n\t        request));\n\t\n\t      // Clean up request\n\t      request = null;\n\t    };\n\t\n\t    // Add xsrf header\n\t    // This is only done if running in a standard browser environment.\n\t    // Specifically not if we're in a web worker, or react-native.\n\t    if (utils.isStandardBrowserEnv()) {\n\t      var cookies = __webpack_require__(15);\n\t\n\t      // Add xsrf header\n\t      var xsrfValue = (config.withCredentials || isURLSameOrigin(config.url)) && config.xsrfCookieName ?\n\t          cookies.read(config.xsrfCookieName) :\n\t          undefined;\n\t\n\t      if (xsrfValue) {\n\t        requestHeaders[config.xsrfHeaderName] = xsrfValue;\n\t      }\n\t    }\n\t\n\t    // Add headers to the request\n\t    if ('setRequestHeader' in request) {\n\t      utils.forEach(requestHeaders, function setRequestHeader(val, key) {\n\t        if (typeof requestData === 'undefined' && key.toLowerCase() === 'content-type') {\n\t          // Remove Content-Type if data is undefined\n\t          delete requestHeaders[key];\n\t        } else {\n\t          // Otherwise add header to the request\n\t          request.setRequestHeader(key, val);\n\t        }\n\t      });\n\t    }\n\t\n\t    // Add withCredentials to request if needed\n\t    if (config.withCredentials) {\n\t      request.withCredentials = true;\n\t    }\n\t\n\t    // Add responseType to request if needed\n\t    if (config.responseType) {\n\t      try {\n\t        request.responseType = config.responseType;\n\t      } catch (e) {\n\t        // Expected DOMException thrown by browsers not compatible XMLHttpRequest Level 2.\n\t        // But, this can be suppressed for 'json' type as it can be parsed by default 'transformResponse' function.\n\t        if (config.responseType !== 'json') {\n\t          throw e;\n\t        }\n\t      }\n\t    }\n\t\n\t    // Handle progress if needed\n\t    if (typeof config.onDownloadProgress === 'function') {\n\t      request.addEventListener('progress', config.onDownloadProgress);\n\t    }\n\t\n\t    // Not all browsers support upload events\n\t    if (typeof config.onUploadProgress === 'function' && request.upload) {\n\t      request.upload.addEventListener('progress', config.onUploadProgress);\n\t    }\n\t\n\t    if (config.cancelToken) {\n\t      // Handle cancellation\n\t      config.cancelToken.promise.then(function onCanceled(cancel) {\n\t        if (!request) {\n\t          return;\n\t        }\n\t\n\t        request.abort();\n\t        reject(cancel);\n\t        // Clean up request\n\t        request = null;\n\t      });\n\t    }\n\t\n\t    if (requestData === undefined) {\n\t      requestData = null;\n\t    }\n\t\n\t    // Send the request\n\t    request.send(requestData);\n\t  });\n\t};\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar createError = __webpack_require__(10);\n\t\n\t/**\n\t * Resolve or reject a Promise based on response status.\n\t *\n\t * @param {Function} resolve A function that resolves the promise.\n\t * @param {Function} reject A function that rejects the promise.\n\t * @param {object} response The response.\n\t */\n\tmodule.exports = function settle(resolve, reject, response) {\n\t  var validateStatus = response.config.validateStatus;\n\t  // Note: status is not exposed by XDomainRequest\n\t  if (!response.status || !validateStatus || validateStatus(response.status)) {\n\t    resolve(response);\n\t  } else {\n\t    reject(createError(\n\t      'Request failed with status code ' + response.status,\n\t      response.config,\n\t      null,\n\t      response.request,\n\t      response\n\t    ));\n\t  }\n\t};\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar enhanceError = __webpack_require__(11);\n\t\n\t/**\n\t * Create an Error with the specified message, config, error code, request and response.\n\t *\n\t * @param {string} message The error message.\n\t * @param {Object} config The config.\n\t * @param {string} [code] The error code (for example, 'ECONNABORTED').\n\t * @param {Object} [request] The request.\n\t * @param {Object} [response] The response.\n\t * @returns {Error} The created error.\n\t */\n\tmodule.exports = function createError(message, config, code, request, response) {\n\t  var error = new Error(message);\n\t  return enhanceError(error, config, code, request, response);\n\t};\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports) {\n\t\n\t/**\n\t * Update an Error with the specified config, error code, and response.\n\t *\n\t * @param {Error} error The error to update.\n\t * @param {Object} config The config.\n\t * @param {string} [code] The error code (for example, 'ECONNABORTED').\n\t * @param {Object} [request] The request.\n\t * @param {Object} [response] The response.\n\t * @returns {Error} The error.\n\t */\n\tmodule.exports = function enhanceError(error, config, code, request, response) {\n\t  error.config = config;\n\t  if (code) {\n\t    error.code = code;\n\t  }\n\t  error.request = request;\n\t  error.response = response;\n\t  return error;\n\t};\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\tfunction encode(val) {\n\t  return encodeURIComponent(val).\n\t    replace(/%40/gi, '@').\n\t    replace(/%3A/gi, ':').\n\t    replace(/%24/g, '$').\n\t    replace(/%2C/gi, ',').\n\t    replace(/%20/g, '+').\n\t    replace(/%5B/gi, '[').\n\t    replace(/%5D/gi, ']');\n\t}\n\t\n\t/**\n\t * Build a URL by appending params to the end\n\t *\n\t * @param {string} url The base of the url (e.g., http://www.google.com)\n\t * @param {object} [params] The params to be appended\n\t * @returns {string} The formatted url\n\t */\n\tmodule.exports = function buildURL(url, params, paramsSerializer) {\n\t  /*eslint no-param-reassign:0*/\n\t  if (!params) {\n\t    return url;\n\t  }\n\t\n\t  var serializedParams;\n\t  if (paramsSerializer) {\n\t    serializedParams = paramsSerializer(params);\n\t  } else if (utils.isURLSearchParams(params)) {\n\t    serializedParams = params.toString();\n\t  } else {\n\t    var parts = [];\n\t\n\t    utils.forEach(params, function serialize(val, key) {\n\t      if (val === null || typeof val === 'undefined') {\n\t        return;\n\t      }\n\t\n\t      if (utils.isArray(val)) {\n\t        key = key + '[]';\n\t      } else {\n\t        val = [val];\n\t      }\n\t\n\t      utils.forEach(val, function parseValue(v) {\n\t        if (utils.isDate(v)) {\n\t          v = v.toISOString();\n\t        } else if (utils.isObject(v)) {\n\t          v = JSON.stringify(v);\n\t        }\n\t        parts.push(encode(key) + '=' + encode(v));\n\t      });\n\t    });\n\t\n\t    serializedParams = parts.join('&');\n\t  }\n\t\n\t  if (serializedParams) {\n\t    url += (url.indexOf('?') === -1 ? '?' : '&') + serializedParams;\n\t  }\n\t\n\t  return url;\n\t};\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\t// Headers whose duplicates are ignored by node\n\t// c.f. https://nodejs.org/api/http.html#http_message_headers\n\tvar ignoreDuplicateOf = [\n\t  'age', 'authorization', 'content-length', 'content-type', 'etag',\n\t  'expires', 'from', 'host', 'if-modified-since', 'if-unmodified-since',\n\t  'last-modified', 'location', 'max-forwards', 'proxy-authorization',\n\t  'referer', 'retry-after', 'user-agent'\n\t];\n\t\n\t/**\n\t * Parse headers into an object\n\t *\n\t * ```\n\t * Date: Wed, 27 Aug 2014 08:58:49 GMT\n\t * Content-Type: application/json\n\t * Connection: keep-alive\n\t * Transfer-Encoding: chunked\n\t * ```\n\t *\n\t * @param {String} headers Headers needing to be parsed\n\t * @returns {Object} Headers parsed into an object\n\t */\n\tmodule.exports = function parseHeaders(headers) {\n\t  var parsed = {};\n\t  var key;\n\t  var val;\n\t  var i;\n\t\n\t  if (!headers) { return parsed; }\n\t\n\t  utils.forEach(headers.split('\\n'), function parser(line) {\n\t    i = line.indexOf(':');\n\t    key = utils.trim(line.substr(0, i)).toLowerCase();\n\t    val = utils.trim(line.substr(i + 1));\n\t\n\t    if (key) {\n\t      if (parsed[key] && ignoreDuplicateOf.indexOf(key) >= 0) {\n\t        return;\n\t      }\n\t      if (key === 'set-cookie') {\n\t        parsed[key] = (parsed[key] ? parsed[key] : []).concat([val]);\n\t      } else {\n\t        parsed[key] = parsed[key] ? parsed[key] + ', ' + val : val;\n\t      }\n\t    }\n\t  });\n\t\n\t  return parsed;\n\t};\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\tmodule.exports = (\n\t  utils.isStandardBrowserEnv() ?\n\t\n\t  // Standard browser envs have full support of the APIs needed to test\n\t  // whether the request URL is of the same origin as current location.\n\t  (function standardBrowserEnv() {\n\t    var msie = /(msie|trident)/i.test(navigator.userAgent);\n\t    var urlParsingNode = document.createElement('a');\n\t    var originURL;\n\t\n\t    /**\n\t    * Parse a URL to discover it's components\n\t    *\n\t    * @param {String} url The URL to be parsed\n\t    * @returns {Object}\n\t    */\n\t    function resolveURL(url) {\n\t      var href = url;\n\t\n\t      if (msie) {\n\t        // IE needs attribute set twice to normalize properties\n\t        urlParsingNode.setAttribute('href', href);\n\t        href = urlParsingNode.href;\n\t      }\n\t\n\t      urlParsingNode.setAttribute('href', href);\n\t\n\t      // urlParsingNode provides the UrlUtils interface - http://url.spec.whatwg.org/#urlutils\n\t      return {\n\t        href: urlParsingNode.href,\n\t        protocol: urlParsingNode.protocol ? urlParsingNode.protocol.replace(/:$/, '') : '',\n\t        host: urlParsingNode.host,\n\t        search: urlParsingNode.search ? urlParsingNode.search.replace(/^\\?/, '') : '',\n\t        hash: urlParsingNode.hash ? urlParsingNode.hash.replace(/^#/, '') : '',\n\t        hostname: urlParsingNode.hostname,\n\t        port: urlParsingNode.port,\n\t        pathname: (urlParsingNode.pathname.charAt(0) === '/') ?\n\t                  urlParsingNode.pathname :\n\t                  '/' + urlParsingNode.pathname\n\t      };\n\t    }\n\t\n\t    originURL = resolveURL(window.location.href);\n\t\n\t    /**\n\t    * Determine if a URL shares the same origin as the current location\n\t    *\n\t    * @param {String} requestURL The URL to test\n\t    * @returns {boolean} True if URL shares the same origin, otherwise false\n\t    */\n\t    return function isURLSameOrigin(requestURL) {\n\t      var parsed = (utils.isString(requestURL)) ? resolveURL(requestURL) : requestURL;\n\t      return (parsed.protocol === originURL.protocol &&\n\t            parsed.host === originURL.host);\n\t    };\n\t  })() :\n\t\n\t  // Non standard browser envs (web workers, react-native) lack needed support.\n\t  (function nonStandardBrowserEnv() {\n\t    return function isURLSameOrigin() {\n\t      return true;\n\t    };\n\t  })()\n\t);\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\tmodule.exports = (\n\t  utils.isStandardBrowserEnv() ?\n\t\n\t  // Standard browser envs support document.cookie\n\t  (function standardBrowserEnv() {\n\t    return {\n\t      write: function write(name, value, expires, path, domain, secure) {\n\t        var cookie = [];\n\t        cookie.push(name + '=' + encodeURIComponent(value));\n\t\n\t        if (utils.isNumber(expires)) {\n\t          cookie.push('expires=' + new Date(expires).toGMTString());\n\t        }\n\t\n\t        if (utils.isString(path)) {\n\t          cookie.push('path=' + path);\n\t        }\n\t\n\t        if (utils.isString(domain)) {\n\t          cookie.push('domain=' + domain);\n\t        }\n\t\n\t        if (secure === true) {\n\t          cookie.push('secure');\n\t        }\n\t\n\t        document.cookie = cookie.join('; ');\n\t      },\n\t\n\t      read: function read(name) {\n\t        var match = document.cookie.match(new RegExp('(^|;\\\\s*)(' + name + ')=([^;]*)'));\n\t        return (match ? decodeURIComponent(match[3]) : null);\n\t      },\n\t\n\t      remove: function remove(name) {\n\t        this.write(name, '', Date.now() - 86400000);\n\t      }\n\t    };\n\t  })() :\n\t\n\t  // Non standard browser env (web workers, react-native) lack needed support.\n\t  (function nonStandardBrowserEnv() {\n\t    return {\n\t      write: function write() {},\n\t      read: function read() { return null; },\n\t      remove: function remove() {}\n\t    };\n\t  })()\n\t);\n\n\n/***/ }),\n/* 16 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\tfunction InterceptorManager() {\n\t  this.handlers = [];\n\t}\n\t\n\t/**\n\t * Add a new interceptor to the stack\n\t *\n\t * @param {Function} fulfilled The function to handle `then` for a `Promise`\n\t * @param {Function} rejected The function to handle `reject` for a `Promise`\n\t *\n\t * @return {Number} An ID used to remove interceptor later\n\t */\n\tInterceptorManager.prototype.use = function use(fulfilled, rejected) {\n\t  this.handlers.push({\n\t    fulfilled: fulfilled,\n\t    rejected: rejected\n\t  });\n\t  return this.handlers.length - 1;\n\t};\n\t\n\t/**\n\t * Remove an interceptor from the stack\n\t *\n\t * @param {Number} id The ID that was returned by `use`\n\t */\n\tInterceptorManager.prototype.eject = function eject(id) {\n\t  if (this.handlers[id]) {\n\t    this.handlers[id] = null;\n\t  }\n\t};\n\t\n\t/**\n\t * Iterate over all the registered interceptors\n\t *\n\t * This method is particularly useful for skipping over any\n\t * interceptors that may have become `null` calling `eject`.\n\t *\n\t * @param {Function} fn The function to call for each interceptor\n\t */\n\tInterceptorManager.prototype.forEach = function forEach(fn) {\n\t  utils.forEach(this.handlers, function forEachHandler(h) {\n\t    if (h !== null) {\n\t      fn(h);\n\t    }\n\t  });\n\t};\n\t\n\tmodule.exports = InterceptorManager;\n\n\n/***/ }),\n/* 17 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\tvar transformData = __webpack_require__(18);\n\tvar isCancel = __webpack_require__(19);\n\tvar defaults = __webpack_require__(6);\n\tvar isAbsoluteURL = __webpack_require__(20);\n\tvar combineURLs = __webpack_require__(21);\n\t\n\t/**\n\t * Throws a `Cancel` if cancellation has been requested.\n\t */\n\tfunction throwIfCancellationRequested(config) {\n\t  if (config.cancelToken) {\n\t    config.cancelToken.throwIfRequested();\n\t  }\n\t}\n\t\n\t/**\n\t * Dispatch a request to the server using the configured adapter.\n\t *\n\t * @param {object} config The config that is to be used for the request\n\t * @returns {Promise} The Promise to be fulfilled\n\t */\n\tmodule.exports = function dispatchRequest(config) {\n\t  throwIfCancellationRequested(config);\n\t\n\t  // Support baseURL config\n\t  if (config.baseURL && !isAbsoluteURL(config.url)) {\n\t    config.url = combineURLs(config.baseURL, config.url);\n\t  }\n\t\n\t  // Ensure headers exist\n\t  config.headers = config.headers || {};\n\t\n\t  // Transform request data\n\t  config.data = transformData(\n\t    config.data,\n\t    config.headers,\n\t    config.transformRequest\n\t  );\n\t\n\t  // Flatten headers\n\t  config.headers = utils.merge(\n\t    config.headers.common || {},\n\t    config.headers[config.method] || {},\n\t    config.headers || {}\n\t  );\n\t\n\t  utils.forEach(\n\t    ['delete', 'get', 'head', 'post', 'put', 'patch', 'common'],\n\t    function cleanHeaderConfig(method) {\n\t      delete config.headers[method];\n\t    }\n\t  );\n\t\n\t  var adapter = config.adapter || defaults.adapter;\n\t\n\t  return adapter(config).then(function onAdapterResolution(response) {\n\t    throwIfCancellationRequested(config);\n\t\n\t    // Transform response data\n\t    response.data = transformData(\n\t      response.data,\n\t      response.headers,\n\t      config.transformResponse\n\t    );\n\t\n\t    return response;\n\t  }, function onAdapterRejection(reason) {\n\t    if (!isCancel(reason)) {\n\t      throwIfCancellationRequested(config);\n\t\n\t      // Transform response data\n\t      if (reason && reason.response) {\n\t        reason.response.data = transformData(\n\t          reason.response.data,\n\t          reason.response.headers,\n\t          config.transformResponse\n\t        );\n\t      }\n\t    }\n\t\n\t    return Promise.reject(reason);\n\t  });\n\t};\n\n\n/***/ }),\n/* 18 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar utils = __webpack_require__(2);\n\t\n\t/**\n\t * Transform the data for a request or a response\n\t *\n\t * @param {Object|String} data The data to be transformed\n\t * @param {Array} headers The headers for the request or response\n\t * @param {Array|Function} fns A single function or Array of functions\n\t * @returns {*} The resulting transformed data\n\t */\n\tmodule.exports = function transformData(data, headers, fns) {\n\t  /*eslint no-param-reassign:0*/\n\t  utils.forEach(fns, function transform(fn) {\n\t    data = fn(data, headers);\n\t  });\n\t\n\t  return data;\n\t};\n\n\n/***/ }),\n/* 19 */\n/***/ (function(module, exports) {\n\t\n\tmodule.exports = function isCancel(value) {\n\t  return !!(value && value.__CANCEL__);\n\t};\n\n\n/***/ }),\n/* 20 */\n/***/ (function(module, exports) {\n\t\n\t/**\n\t * Determines whether the specified URL is absolute\n\t *\n\t * @param {string} url The URL to test\n\t * @returns {boolean} True if the specified URL is absolute, otherwise false\n\t */\n\tmodule.exports = function isAbsoluteURL(url) {\n\t  // A URL is considered absolute if it begins with \"<scheme>://\" or \"//\" (protocol-relative URL).\n\t  // RFC 3986 defines scheme name as a sequence of characters beginning with a letter and followed\n\t  // by any combination of letters, digits, plus, period, or hyphen.\n\t  return /^([a-z][a-z\\d\\+\\-\\.]*:)?\\/\\//i.test(url);\n\t};\n\n\n/***/ }),\n/* 21 */\n/***/ (function(module, exports) {\n\t\n\t/**\n\t * Creates a new URL by combining the specified URLs\n\t *\n\t * @param {string} baseURL The base URL\n\t * @param {string} relativeURL The relative URL\n\t * @returns {string} The combined URL\n\t */\n\tmodule.exports = function combineURLs(baseURL, relativeURL) {\n\t  return relativeURL\n\t    ? baseURL.replace(/\\/+$/, '') + '/' + relativeURL.replace(/^\\/+/, '')\n\t    : baseURL;\n\t};\n\n\n/***/ }),\n/* 22 */\n/***/ (function(module, exports) {\n\t\n\t/**\n\t * A `Cancel` is an object that is thrown when an operation is canceled.\n\t *\n\t * @class\n\t * @param {string=} message The message.\n\t */\n\tfunction Cancel(message) {\n\t  this.message = message;\n\t}\n\t\n\tCancel.prototype.toString = function toString() {\n\t  return 'Cancel' + (this.message ? ': ' + this.message : '');\n\t};\n\t\n\tCancel.prototype.__CANCEL__ = true;\n\t\n\tmodule.exports = Cancel;\n\n\n/***/ }),\n/* 23 */\n/***/ (function(module, exports, __webpack_require__) {\n\t\n\tvar Cancel = __webpack_require__(22);\n\t\n\t/**\n\t * A `CancelToken` is an object that can be used to request cancellation of an operation.\n\t *\n\t * @class\n\t * @param {Function} executor The executor function.\n\t */\n\tfunction CancelToken(executor) {\n\t  if (typeof executor !== 'function') {\n\t    throw new TypeError('executor must be a function.');\n\t  }\n\t\n\t  var resolvePromise;\n\t  this.promise = new Promise(function promiseExecutor(resolve) {\n\t    resolvePromise = resolve;\n\t  });\n\t\n\t  var token = this;\n\t  executor(function cancel(message) {\n\t    if (token.reason) {\n\t      // Cancellation has already been requested\n\t      return;\n\t    }\n\t\n\t    token.reason = new Cancel(message);\n\t    resolvePromise(token.reason);\n\t  });\n\t}\n\t\n\t/**\n\t * Throws a `Cancel` if cancellation has been requested.\n\t */\n\tCancelToken.prototype.throwIfRequested = function throwIfRequested() {\n\t  if (this.reason) {\n\t    throw this.reason;\n\t  }\n\t};\n\t\n\t/**\n\t * Returns an object that contains a new `CancelToken` and a function that, when called,\n\t * cancels the `CancelToken`.\n\t */\n\tCancelToken.source = function source() {\n\t  var cancel;\n\t  var token = new CancelToken(function executor(c) {\n\t    cancel = c;\n\t  });\n\t  return {\n\t    token: token,\n\t    cancel: cancel\n\t  };\n\t};\n\t\n\tmodule.exports = CancelToken;\n\n\n/***/ }),\n/* 24 */\n/***/ (function(module, exports) {\n\t\n\t/**\n\t * Syntactic sugar for invoking a function and expanding an array for arguments.\n\t *\n\t * Common use case would be to use `Function.prototype.apply`.\n\t *\n\t *  ```js\n\t *  function f(x, y, z) {}\n\t *  var args = [1, 2, 3];\n\t *  f.apply(null, args);\n\t *  ```\n\t *\n\t * With `spread` this example can be re-written.\n\t *\n\t *  ```js\n\t *  spread(function(x, y, z) {})([1, 2, 3]);\n\t *  ```\n\t *\n\t * @param {Function} callback\n\t * @returns {Function}\n\t */\n\tmodule.exports = function spread(callback) {\n\t  return function wrap(arr) {\n\t    return callback.apply(null, arr);\n\t  };\n\t};\n\n\n/***/ })\n/******/ ])\n});\n\n});\n\n/**\r\n * @File   : HTTP.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 2018/9/27 下午11:23:59\r\n * @Description:\r\n */\r\n/**\r\n * 提供基本的HTTP请求能力。\r\n */\r\nvar HTTP = /** @class */ (function () {\r\n    function HTTP() {\r\n    }\r\n    HTTP.get = axios.get;\r\n    HTTP.post = axios.post;\r\n    HTTP.delete = axios.delete;\r\n    HTTP.put = axios.put;\r\n    HTTP.patch = axios.patch;\r\n    HTTP.request = axios.request;\r\n    return HTTP;\r\n}());\n\n/**\r\n * 判断一个实例是否为`AtlasLoader`。\r\n */\r\nfunction isAtlasLoader(value) {\r\n    return value.isAtlasLoader;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isBase64(url) {\r\n    return /^data:(.+?);base64,/.test(url);\r\n}\r\n/**\r\n * @hidden\r\n */\r\nfunction isAbsolute(url) {\r\n    return url[0] === '/' || /^(http|https):\\/\\//.test(url);\r\n}\r\n/**\r\n * 图集加载器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar AtlasLoader = /** @class */ (function (_super) {\r\n    __extends(AtlasLoader, _super);\r\n    function AtlasLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isAtlasLoader = true;\r\n        return _this;\r\n    }\r\n    AtlasLoader.prototype.load = function (entity, callbacks) {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var meta_1, url, fileName, image_1, error_1;\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        _a.trys.push([0, 2, , 3]);\r\n                        return [4 /*yield*/, HTTP.get(entity.url)];\r\n                    case 1:\r\n                        meta_1 = (_a.sent()).data;\r\n                        if (!meta_1) {\r\n                            throw new Error(\"Load resource error: \" + entity.name);\r\n                        }\r\n                        callbacks.onLoading(entity, .1);\r\n                        url = meta_1.meta.image;\r\n                        if (!isAbsolute(url) && !isBase64(url)) {\r\n                            fileName = entity.url.split('/').pop();\r\n                            url = \"\" + entity.url.replace(fileName, '') + meta_1.meta.image;\r\n                        }\r\n                        image_1 = document.createElement('img');\r\n                        image_1.onload = function () {\r\n                            image_1.onerror = null;\r\n                            image_1.onabort = null;\r\n                            image_1.onload = null;\r\n                            if (entity.canceled) {\r\n                                return;\r\n                            }\r\n                            entity.result = new AtlasManager({\r\n                                image: image_1,\r\n                                frames: meta_1.frames,\r\n                                meta: meta_1.meta\r\n                            }, entity.updatable || false);\r\n                            callbacks.onLoaded(entity);\r\n                        };\r\n                        image_1.onerror = function () {\r\n                            callbacks.onError(entity, new Error(\"Error when loading \" + entity.name));\r\n                        };\r\n                        image_1.crossOrigin = (entity.crossOrigin || false) ? 'Anonymous' : '';\r\n                        image_1.src = url;\r\n                        return [3 /*break*/, 3];\r\n                    case 2:\r\n                        error_1 = _a.sent();\r\n                        callbacks.onError(entity, error_1);\r\n                        return [3 /*break*/, 3];\r\n                    case 3: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * **尚未实现**。\r\n     */\r\n    AtlasLoader.prototype.instantiate = function (entity, options) {\r\n        throw new Error('Not implemented !');\r\n    };\r\n    /**\r\n     * 释放资源时将会调用，用于自定义释放逻辑。\r\n     */\r\n    AtlasLoader.prototype.release = function (entity) {\r\n        entity.result.destroy();\r\n    };\r\n    AtlasLoader.EXTENSIONS = ['.atlas'];\r\n    AtlasLoader = __decorate([\r\n        SClass({ className: 'AtlasLoader' })\r\n    ], AtlasLoader);\r\n    return AtlasLoader;\r\n}(ResourceLoader));\n\n/**\r\n * 判断一个实例是否为`EventTrigger`。\r\n */\r\nfunction isEventTrigger(value) {\r\n    return value.isEventTrigger;\r\n}\r\n/**\r\n * 事件触发器类。触发器用于在事件管理器[EventManager](../eventmanager)注册事件时，添加特殊的自动分发功能。\r\n * 你可以继承此基类来派生自己的触发器，之后触发器便会自动得完成一些特殊事件的分发工作，比如HID（用户输入）。\r\n * 详细例子请看[CustomTrigger](../../example/event/custom-trigger)。\r\n *\r\n * @template TEvent 此触发器对应的事件参数类型。\r\n * @noInheritDoc\r\n */\r\nvar EventTrigger = /** @class */ (function (_super) {\r\n    __extends(EventTrigger, _super);\r\n    /**\r\n     * 一般不需要自己调用。\r\n     */\r\n    function EventTrigger(type, eventManager, objHasGame) {\r\n        if (objHasGame === void 0) { objHasGame = null; }\r\n        var _this = _super.call(this) || this;\r\n        _this.isEventTrigger = true;\r\n        /**\r\n         * 此触发器是否要在每一次事件触发时立即分发，如果不，怎会先缓存之后在每一帧更新之前统一分发。\r\n         */\r\n        _this.autoFlush = true;\r\n        _this._type = null;\r\n        _this._eventManager = null;\r\n        _this._paused = true;\r\n        _this._objHasGame = null;\r\n        /**\r\n         * **不要自己调用！！**\r\n         *\r\n         * @hidden\r\n         */\r\n        _this.trigger = function (event) {\r\n            try {\r\n                _this.onTrigger(event);\r\n            }\r\n            catch (error) {\r\n                throwException(error, _this);\r\n            }\r\n            return _this;\r\n        };\r\n        _this._type = new SName(type);\r\n        _this._eventManager = eventManager;\r\n        _this._objHasGame = objHasGame;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(EventTrigger.prototype, \"paused\", {\r\n        /**\r\n         * 该触发器是否已暂停触发。\r\n         */\r\n        get: function () {\r\n            return this._paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(EventTrigger.prototype, \"parent\", {\r\n        /**\r\n         * 获取自身的父级实例引用，一般不需要自己使用。\r\n         */\r\n        get: function () {\r\n            return this._eventManager;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 获取游戏实例引用。\r\n     */\r\n    EventTrigger.prototype.getGame = function () {\r\n        return this._objHasGame.getGame();\r\n    };\r\n    /**\r\n     * 生命周期，触发器开始运作时调用，你可以在这里初始化你的触发器。\r\n     * 比如`window.addEventListener(eventName, this.trigger);`。\r\n     */\r\n    EventTrigger.prototype.onBegin = function () {\r\n    };\r\n    /**\r\n     * 生命周期，触发器停止运作时调用，你可以在这里释放你的触发器。\r\n     */\r\n    EventTrigger.prototype.onPause = function () {\r\n    };\r\n    /**\r\n     * 生命周期，触发器被触发前调用，你可以在这里。\r\n     * 注意别忘了调用`super.onTrigger`来保证默认行为。\r\n     */\r\n    EventTrigger.prototype.onTrigger = function (event) {\r\n        this._eventManager.trigger(this._type.value, event, this.autoFlush);\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    EventTrigger.prototype.begin = function () {\r\n        this._paused = false;\r\n        try {\r\n            this.onBegin();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    EventTrigger.prototype.pause = function () {\r\n        this._paused = true;\r\n        try {\r\n            this.onPause();\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    EventTrigger.prototype.destroy = function () {\r\n        this.pause();\r\n    };\r\n    EventTrigger = __decorate([\r\n        SClass({ className: 'EventTrigger', classType: 'EventTrigger' })\r\n    ], EventTrigger);\r\n    return EventTrigger;\r\n}(SObject));\n\n/**\r\n * @hidden\r\n */\r\nfunction createKeyboardTrigger(className, eventName) {\r\n    var KeyBoardEventTrigger = /** @class */ (function (_super) {\r\n        __extends(KeyBoardEventTrigger, _super);\r\n        function KeyBoardEventTrigger() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.isKeyBoardEventTrigger = true;\r\n            _this.autoFlush = false;\r\n            return _this;\r\n        }\r\n        KeyBoardEventTrigger.prototype.onBegin = function () {\r\n            window.addEventListener(eventName, this.trigger);\r\n        };\r\n        KeyBoardEventTrigger.prototype.onTrigger = function (event) {\r\n            if (className !== 'KeyDownTrigger') {\r\n                event.preventDefault();\r\n            }\r\n            event.stopPropagation();\r\n            _super.prototype.onTrigger.call(this, event);\r\n        };\r\n        KeyBoardEventTrigger.prototype.onPause = function () {\r\n            window.removeEventListener(eventName, this.trigger);\r\n        };\r\n        KeyBoardEventTrigger = __decorate([\r\n            SClass({ className: className })\r\n        ], KeyBoardEventTrigger);\r\n        return KeyBoardEventTrigger;\r\n    }(EventTrigger));\r\n    return KeyBoardEventTrigger;\r\n}\r\nvar KeyDownTrigger = createKeyboardTrigger('KeyDownTrigger', 'keydown');\r\nvar KeyPressTrigger = createKeyboardTrigger('KeyPressTrigger', 'keypress');\r\nvar KeyUpTrigger = createKeyboardTrigger('KeyUpTrigger', 'keyup');\n\n/**\r\n * @hidden\r\n */\r\nfunction createTouchTrigger(className, eventName) {\r\n    var TouchEventTrigger = /** @class */ (function (_super) {\r\n        __extends(TouchEventTrigger, _super);\r\n        function TouchEventTrigger() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.isTouchEventTrigger = true;\r\n            _this.autoFlush = false;\r\n            return _this;\r\n        }\r\n        TouchEventTrigger_1 = TouchEventTrigger;\r\n        TouchEventTrigger.prototype.onBegin = function () {\r\n            this.getGame().canvas.addEventListener(eventName, this.trigger);\r\n        };\r\n        TouchEventTrigger.prototype.onTrigger = function (event) {\r\n            if (TouchEventTrigger_1.needPreventDefault) {\r\n                event.preventDefault();\r\n            }\r\n            if (TouchEventTrigger_1.needStopPropagation) {\r\n                event.stopPropagation();\r\n            }\r\n            _super.prototype.onTrigger.call(this, event);\r\n        };\r\n        TouchEventTrigger.prototype.onPause = function () {\r\n            this.getGame().canvas.removeEventListener(eventName, this.trigger);\r\n        };\r\n        var TouchEventTrigger_1;\r\n        TouchEventTrigger.needPreventDefault = true;\r\n        TouchEventTrigger.needStopPropagation = true;\r\n        TouchEventTrigger = TouchEventTrigger_1 = __decorate([\r\n            SClass({ className: className })\r\n        ], TouchEventTrigger);\r\n        return TouchEventTrigger;\r\n    }(EventTrigger));\r\n    return TouchEventTrigger;\r\n}\r\nvar TouchStartTrigger = createTouchTrigger('TouchStartTrigger', 'touchstart');\r\nvar TouchEndTrigger = createTouchTrigger('TouchEndTrigger', 'touchend');\r\nvar TouchMoveTrigger = createTouchTrigger('TouchMoveTrigger', 'touchmove');\r\nvar TouchCancelTrigger = createTouchTrigger('TouchCancelTrigger', 'touchcancel');\n\n/**\r\n * @hidden\r\n */\r\nfunction createMouseTrigger(className, eventName) {\r\n    var MouseEventTrigger = /** @class */ (function (_super) {\r\n        __extends(MouseEventTrigger, _super);\r\n        function MouseEventTrigger() {\r\n            var _this = _super !== null && _super.apply(this, arguments) || this;\r\n            _this.isMouseEventTrigger = true;\r\n            _this.autoFlush = false;\r\n            return _this;\r\n        }\r\n        MouseEventTrigger.prototype.onBegin = function () {\r\n            this.getGame().canvas.addEventListener(eventName, this.trigger);\r\n        };\r\n        MouseEventTrigger.prototype.onTrigger = function (event) {\r\n            event.preventDefault();\r\n            event.stopPropagation();\r\n            _super.prototype.onTrigger.call(this, event);\r\n        };\r\n        MouseEventTrigger.prototype.onPause = function () {\r\n            this.getGame().canvas.removeEventListener(eventName, this.trigger);\r\n        };\r\n        MouseEventTrigger = __decorate([\r\n            SClass({ className: className })\r\n        ], MouseEventTrigger);\r\n        return MouseEventTrigger;\r\n    }(EventTrigger));\r\n    return MouseEventTrigger;\r\n}\r\nvar MouseClickTrigger = createMouseTrigger('MouseClickTrigger', 'click');\r\nvar MouseDownTrigger = createMouseTrigger('MouseDownTrigger', 'mousedown');\r\nvar MouseUpTrigger = createMouseTrigger('MouseUpTrigger', 'mouseup');\r\nvar MouseEnterTrigger = createMouseTrigger('MouseEnterTrigger', 'mouseenter');\r\nvar MouseLeaveTrigger = createMouseTrigger('MouseLeaveTrigger', 'mouseleave');\r\nvar MouseMoveTrigger = createMouseTrigger('MouseMoveTrigger', 'mousemove');\r\nvar MouseOutTrigger = createMouseTrigger('MouseOutTrigger', 'mouseout');\r\nvar MouseOverTrigger = createMouseTrigger('MouseOverTrigger', 'mouseover');\r\nvar MouseWheelTrigger = createMouseTrigger('MouseWheelTrigger', 'mousewheel');\r\nvar WheelTrigger = createMouseTrigger('WheelTrigger', 'wheel');\r\nvar ContextMenuTrigger = createMouseTrigger('ContextMenuTrigger', 'contextmenu');\n\n/**\r\n * 窗口大小改变时的触发器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar WindowResizeTrigger = /** @class */ (function (_super) {\r\n    __extends(WindowResizeTrigger, _super);\r\n    function WindowResizeTrigger() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isMouseEventTrigger = true;\r\n        _this.autoFlush = false;\r\n        return _this;\r\n    }\r\n    WindowResizeTrigger.prototype.onBegin = function () {\r\n        window.addEventListener('resize', this.trigger);\r\n    };\r\n    WindowResizeTrigger.prototype.onPause = function () {\r\n        window.removeEventListener('resize', this.trigger);\r\n    };\r\n    WindowResizeTrigger = __decorate([\r\n        SClass({ className: 'WindowResizeTrigger' })\r\n    ], WindowResizeTrigger);\r\n    return WindowResizeTrigger;\r\n}(EventTrigger));\n\n/**\r\n * 判断一个实例是否为`Player`。\r\n */\r\nfunction isPlayer(value) {\r\n    return value.isPlayer;\r\n}\r\n/**\r\n * 玩家类，用于管理玩家的逻辑。\r\n * 一般不直接用于控制实例，而是使用其在`World`中的代理`PlayerControllerActor`。\r\n * 可以对齐进行继承扩展，来达到一种自顶向下的设计理念，详见[Player](../../guide/player)。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar Player = /** @class */ (function (_super) {\r\n    __extends(Player, _super);\r\n    function Player(name, game) {\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isPlayer = true;\r\n        _this._game = game;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Player.prototype, \"parent\", {\r\n        /**\r\n         * 父级为Game。\r\n         */\r\n        get: function () {\r\n            return this._game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Player.prototype, \"controller\", {\r\n        /**\r\n         * 直接获取无类型的控制器实例引用，建议使用`getController`替代。\r\n         */\r\n        get: function () {\r\n            return this._controller;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Player.prototype, \"state\", {\r\n        /**\r\n         * 直接获取无类型的状态实例引用，建议使用`getState`替代。\r\n         */\r\n        get: function () {\r\n            return this._controller.state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，在实例创建后触发。\r\n     */\r\n    Player.prototype.onInit = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在实例获取到控制器的所有权时触发。\r\n     */\r\n    Player.prototype.onSwitchController = function (controller) {\r\n    };\r\n    /**\r\n     * 生命周期，在实例释放控制器的所有权时触发。\r\n     */\r\n    Player.prototype.onReleaseController = function (controller) {\r\n    };\r\n    /**\r\n     * 生命周期，在每一帧更新时触发。\r\n     */\r\n    Player.prototype.onUpdate = function (delta) {\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在Game中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Player.prototype.onError = function (error, details) {\r\n    };\r\n    /**\r\n     * 切换自身在World中代理的Controller。\r\n     */\r\n    Player.prototype.switchController = function (controller) {\r\n        if (controller.player) {\r\n            throw new BreakGuardException(this, \"Controller \" + controller.name + \" already owned by player \" + controller.parent.name + \" !\");\r\n        }\r\n        this._controller = controller;\r\n        controller._player = this;\r\n        try {\r\n            this.onSwitchController(controller);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 释放当前自身在World中代理的Controller。\r\n     */\r\n    Player.prototype.releaseController = function () {\r\n        try {\r\n            this.onReleaseController(this._controller);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        if (this._controller) {\r\n            this._controller._player = null;\r\n        }\r\n        this._controller = null;\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取当前自身在World中代理的Controller。\r\n     */\r\n    Player.prototype.getController = function () {\r\n        return this._controller;\r\n    };\r\n    /**\r\n     * 获取当前自身在World中代理的Controller的状态。\r\n     */\r\n    Player.prototype.getState = function () {\r\n        return this._controller.getState();\r\n    };\r\n    /**\r\n     * 获取当前`Game`实例。\r\n     *\r\n     * @template IGameState 当前游戏状态管理器的类型。\r\n     */\r\n    Player.prototype.getGame = function () {\r\n        return this._game;\r\n    };\r\n    /**\r\n     * 获取当前`World`实例。\r\n     *\r\n     * @template IWorldState 当前世界状态管理器的类型。\r\n     */\r\n    Player.prototype.getWorld = function () {\r\n        return this._game.world;\r\n    };\r\n    /**\r\n     * 获取当前`Level`实例。\r\n     *\r\n     * @template ILevelState 当前关卡状态管理器的类型。\r\n     */\r\n    Player.prototype.getLevel = function () {\r\n        return this._game.level;\r\n    };\r\n    /**\r\n     * 仅在初始化了物理引擎之后，用于获取当前物理世界`PhysicWorld`实例。\r\n     * 如何使用物理引擎请见**Guide**和**Demo**。\r\n     */\r\n    Player.prototype.getPhysicWorld = function () {\r\n        return this._game.world.physicWorld;\r\n    };\r\n    /**\r\n     * **不要自行调用！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Player.prototype.update = function (delta) {\r\n        try {\r\n            this.onUpdate(delta);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n    };\r\n    /**\r\n     * **不要自行调用！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Player.prototype.destroy = function () {\r\n        if (this._controller) {\r\n            this._controller._player = null;\r\n        }\r\n        this._controller = null;\r\n        this._game = null;\r\n        _super.prototype.destroy.call(this);\r\n    };\r\n    Player = __decorate([\r\n        SClass({ className: 'Player' })\r\n    ], Player);\r\n    return Player;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`InfoActor`。\r\n */\r\nfunction isInfoActor(value) {\r\n    return value.isInfoActor;\r\n}\r\n/**\r\n * 信息管理Actor基类。单纯的书记官，不放入场景内，仅仅作为信息的记录者。\r\n * 一般不直接使用，而是使用其派生类。\r\n *\r\n * @template IOptionTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n * @template TRootComponent 根组件类型。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar InfoActor = /** @class */ (function (_super) {\r\n    __extends(InfoActor, _super);\r\n    function InfoActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isInfoActor = true;\r\n        /**\r\n         * 更新优先级，只可在派生时指定，不可在初始化后的运行时修改！\r\n         */\r\n        _this.updatePriority = InfoActor_1.UPDATE_PRIORITY.Others;\r\n        return _this;\r\n    }\r\n    InfoActor_1 = InfoActor;\r\n    var InfoActor_1;\r\n    /**\r\n     * 默认的更新优先级。\r\n     *\r\n     * @member System 约定占用1000 ~ 2000\r\n     * @member GameMode 约定占用2000 ~ 3000\r\n     * @member LevelScript 约定占用3000 ~ 4000\r\n     * @member State 约定占用4000 ~ 5000\r\n     * @member Others 其他，默认直接追加到最后\r\n     */\r\n    InfoActor.UPDATE_PRIORITY = {\r\n        System: 1000,\r\n        GameMode: 2000,\r\n        LevelScript: 3000,\r\n        State: 4000,\r\n        Others: -1\r\n    };\r\n    InfoActor = InfoActor_1 = __decorate([\r\n        SClass({ className: 'InfoActor' })\r\n    ], InfoActor);\r\n    return InfoActor;\r\n}(Actor));\n\n/**\r\n * 判断一个实例是否为`StateActor`。\r\n */\r\nfunction isStateActor(value) {\r\n    return value.isStateActor;\r\n}\r\n/**\r\n * 状态管理Actor类。记录一些状态，比如`Game`所用的`GameState`、`World`所用的`WorldState`。\r\n *\r\n * @template IOptionTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar StateActor = /** @class */ (function (_super) {\r\n    __extends(StateActor, _super);\r\n    function StateActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isStateActor = true;\r\n        _this.updatePriority = InfoActor.UPDATE_PRIORITY.State;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 自定义复制接口，你可以定制改写它。\r\n     */\r\n    StateActor.prototype.copy = function (state) {\r\n        if (!state) {\r\n            return;\r\n        }\r\n        return this;\r\n    };\r\n    StateActor = __decorate([\r\n        SClass({ className: 'StateActor' })\r\n    ], StateActor);\r\n    return StateActor;\r\n}(InfoActor));\n\n/**\r\n * 判断一个实例是否为`SystemActor`。\r\n */\r\nfunction isSystemActor(value) {\r\n    return value.isSystemActor;\r\n}\r\n/**\r\n * 系统Actor基类，派生一些系统类，比如物理引擎管理、声音系统等全局规则型Actor，它们在更新队列的最先端。\r\n *\r\n * @template IOptionTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SystemActor = /** @class */ (function (_super) {\r\n    __extends(SystemActor, _super);\r\n    function SystemActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSystemActor = true;\r\n        _this.updatePriority = InfoActor.UPDATE_PRIORITY.System;\r\n        return _this;\r\n    }\r\n    SystemActor = __decorate([\r\n        SClass({ className: 'SystemActor' })\r\n    ], SystemActor);\r\n    return SystemActor;\r\n}(InfoActor));\n\n/**\r\n * 物理系统Actor，负责更新物理世界。\r\n *\r\n * @hidden\r\n * @noInheritDoc\r\n */\r\nvar PhysicSystemActor = /** @class */ (function (_super) {\r\n    __extends(PhysicSystemActor, _super);\r\n    function PhysicSystemActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPhysicSystemActor = true;\r\n        return _this;\r\n    }\r\n    PhysicSystemActor.prototype.onUpdate = function (delta) {\r\n        var world = this.getWorld();\r\n        if (world && world.physicWorld) {\r\n            world.physicWorld.update(delta);\r\n        }\r\n    };\r\n    PhysicSystemActor = __decorate([\r\n        SClass({ className: 'PhysicSystemActor' })\r\n    ], PhysicSystemActor);\r\n    return PhysicSystemActor;\r\n}(SystemActor));\n\n/**\r\n * 判断一个实例是否为`CubeTextureLoader`。\r\n */\r\nfunction isCubeTextureLoader(value) {\r\n    return value.isCubeTextureLoader;\r\n}\r\n/**\r\n * @hidden\r\n */\r\nvar loader$1 = new Hilo3d$2.CubeTextureLoader();\r\n/**\r\n * 纹理加载器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CubeTextureLoader = /** @class */ (function (_super) {\r\n    __extends(CubeTextureLoader, _super);\r\n    function CubeTextureLoader() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isCubeTextureLoader = true;\r\n        return _this;\r\n    }\r\n    CubeTextureLoader.prototype.load = function (entity, callbacks) {\r\n        var url = entity.url, images = entity.images;\r\n        var baseUrl = (!url || url[url.length - 1] === '/') ? entity.url : entity.url + '/';\r\n        loader$1.load({\r\n            left: baseUrl + images.left,\r\n            right: baseUrl + images.right,\r\n            front: baseUrl + images.front,\r\n            back: baseUrl + images.back,\r\n            top: baseUrl + images.top,\r\n            bottom: baseUrl + images.bottom,\r\n            crossOrigin: entity.crossOrigin || false,\r\n            uv: entity.uv || 0,\r\n            flipY: entity.flipY,\r\n            format: entity.format || Constants.RGB,\r\n            internalFormat: entity.internalFormat || Constants.RGB,\r\n            isImageCanRelease: entity.isImageCanRelease\r\n        })\r\n            .then(function (result) {\r\n            entity.result = result;\r\n            callbacks.onLoaded(entity);\r\n        })\r\n            .catch(function (error) { return callbacks.onError(entity, error); });\r\n    };\r\n    /**\r\n     * 释放资源时将会调用，用于自定义释放逻辑。\r\n     */\r\n    CubeTextureLoader.prototype.release = function (entity) {\r\n        entity.result.destroy();\r\n    };\r\n    CubeTextureLoader = __decorate([\r\n        SClass({ className: 'CubeTextureLoader' })\r\n    ], CubeTextureLoader);\r\n    return CubeTextureLoader;\r\n}(ResourceLoader));\n\n/**\r\n * 判断一个实例是否为`Game`。\r\n */\r\nfunction isGame(value) {\r\n    return value.isGame;\r\n}\r\n/**\r\n * 游戏类，整个Game逻辑中实际的顶层类，将作为一个单例存在于整个Game中，通常使用`getGame`获取。\r\n *\r\n * @template IState Game的状态Actor类型，用于存储整个Game的全局状态。\r\n * @noInheritDoc\r\n */\r\nvar Game = /** @class */ (function (_super) {\r\n    __extends(Game, _super);\r\n    /**\r\n     * @param StateClass 游戏全局状态实例的类\r\n     * @param initState 游戏全局状态实例的初始值，若存在，将在初始化时从它clone\r\n     */\r\n    function Game(name, options, StateClass, initState) {\r\n        if (StateClass === void 0) { StateClass = StateActor; }\r\n        if (initState === void 0) { initState = null; }\r\n        var _this = _super.call(this, name) || this;\r\n        _this.isGame = true;\r\n        /**\r\n         * 当前的一些设备信息。\r\n         */\r\n        _this.deviceInfo = {\r\n            touchable: !!(window && ('ontouchstart' in window))\r\n        };\r\n        _this._engine = null;\r\n        _this._resource = null;\r\n        _this._event = null;\r\n        _this._hid = null;\r\n        _this._worldsMeta = {};\r\n        _this._defaultWorldName = null;\r\n        _this._world = null;\r\n        _this._actors = new SArray();\r\n        _this._actorsForUpdate = new SArray();\r\n        _this._actorsNeedUpdate = false;\r\n        _this._actorsPriorities = [];\r\n        _this._actorsPriorityCount = {};\r\n        _this._players = new SMap();\r\n        _this._defaultPlayer = null;\r\n        _this._paused = true;\r\n        _this._hiloStage = null;\r\n        _this._initState = initState;\r\n        _this._hiloStage = new Hilo3d$2.Stage(options);\r\n        _this._hiloStage.needCallChildUpdate = false;\r\n        _this._resource = new ResourceManager(_this);\r\n        _this._event = new EventManager(_this);\r\n        _this._hid = new EventManager(_this);\r\n        _this._state = _this.addActor('game-state', StateClass);\r\n        _this._state.copy(_this._initState);\r\n        _this.canvas.style.width = '';\r\n        _this.canvas.style.height = '';\r\n        _this.initEvents();\r\n        _this.initLoaders(options);\r\n        _this.initSystems();\r\n        try {\r\n            _this.onInit();\r\n        }\r\n        catch (error) {\r\n            throwException(error, _this);\r\n        }\r\n        _this._event.trigger('GameDidInit', { game: _this });\r\n        return _this;\r\n    }\r\n    Object.defineProperty(Game.prototype, \"state\", {\r\n        /**\r\n         * Game状态Actor实例引用。\r\n         */\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"event\", {\r\n        /**\r\n         * Game全局事件管理器实例引用。\r\n         * 默认事件列表见[IGlobalDefaultEvents](../interfaces/iglobaldefaultevents`)。\r\n         */\r\n        get: function () {\r\n            return this._event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"hid\", {\r\n        /**\r\n         * Game全局HID管理器全局实例引用。\r\n         * 这实际上是一个特化过的事件管理器，默认事件列表见[IGlobalHIDDefaultEvents](../interfaces/iglobalhiddefaultevents`)。\r\n         */\r\n        get: function () {\r\n            return this._hid;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"fps\", {\r\n        /**\r\n         * 当前Game锁帧帧率。\r\n         */\r\n        get: function () {\r\n            return this._engine.options.fps;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"paused\", {\r\n        /**\r\n         * 当前游戏是否处于暂停状态。\r\n         */\r\n        get: function () {\r\n            return this._paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"parent\", {\r\n        /**\r\n         * Game的父级引擎实例引用。\r\n         */\r\n        get: function () {\r\n            return this._engine;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"game\", {\r\n        /**\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"world\", {\r\n        /**\r\n         * 当前`World`实例引用。一般不直接使用，而是用`actor.getWorld()`或`component.getWorld`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._world;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"level\", {\r\n        /**\r\n         * 当前`Level`实例引用。一般不直接使用，而是用`actor.getLevel()`或`component.getLevel`，提供更好的泛型类型推断。\r\n         */\r\n        get: function () {\r\n            return this._world.level;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"players\", {\r\n        /**\r\n         * 当前的玩家列表，要结合玩家系统，详见[Player](./player)。\r\n         */\r\n        get: function () {\r\n            return this._players;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"actors\", {\r\n        /**\r\n         * 当前`Game`实例下的所有Actor列表，注意列表中的`Actor`必须为`InfoActor`，单纯负责逻辑而没有`transform`。\r\n         * 如果你需要实际上可视的Actor的列表，请参考`world.actors`。\r\n         */\r\n        get: function () {\r\n            return this._actors;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"resource\", {\r\n        /**\r\n         * Game的全局资源管理器实例引用，用于加载和管理所有的Game资源。\r\n         */\r\n        get: function () {\r\n            return this._resource;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"ticker\", {\r\n        /**\r\n         * Game的全局Ticker，来自`Engine`类，所有Game共用。\r\n         */\r\n        get: function () {\r\n            return this._engine.ticker;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"canvas\", {\r\n        /**\r\n         * 当前的`canvas`实例引用。\r\n         */\r\n        get: function () {\r\n            return this._hiloStage.canvas;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"screenWidth\", {\r\n        /**\r\n         * 当前视口的实际像素宽度。\r\n         */\r\n        get: function () {\r\n            return this.canvas.offsetWidth;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"screenHeight\", {\r\n        /**\r\n         * 当前视口的实际像素高度。\r\n         */\r\n        get: function () {\r\n            return this.canvas.offsetHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"bound\", {\r\n        /**\r\n         * 当前视口的实际边界属性。\r\n         */\r\n        get: function () {\r\n            return this.canvas.getBoundingClientRect();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"screenAspect\", {\r\n        /**\r\n         * 当前视口实际的纵横比。\r\n         */\r\n        get: function () {\r\n            var _a = this.canvas, offsetWidth = _a.offsetWidth, offsetHeight = _a.offsetHeight;\r\n            return offsetWidth / offsetHeight;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"env\", {\r\n        /**\r\n         * 当前运行环境，一般为`development`或`production`。\r\n         */\r\n        get: function () {\r\n            return Debug.env;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"devMode\", {\r\n        /**\r\n         * `env`不为`production`时，判定为开发环境。\r\n         */\r\n        get: function () {\r\n            return Debug.devMode;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"renderer\", {\r\n        /**\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._hiloStage.renderer;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(Game.prototype, \"hiloStage\", {\r\n        /**\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._hiloStage;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    Game.prototype.getGame = function () {\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取全局事件管理器引用。\r\n     */\r\n    Game.prototype.getEvent = function () {\r\n        return this._event;\r\n    };\r\n    /**\r\n     * 获取全局HID管理器引用。\r\n     */\r\n    Game.prototype.getHID = function () {\r\n        return this._hid;\r\n    };\r\n    /**\r\n     * 获取全局资源管理器引用。\r\n     */\r\n    Game.prototype.getResource = function () {\r\n        return this._resource;\r\n    };\r\n    /**\r\n     * 设定特定渲染配置。\r\n     */\r\n    Game.prototype.setOption = function (key, value) {\r\n        this._hiloStage.renderer[key] = value;\r\n        this._initState[key] = value;\r\n    };\r\n    /**\r\n     * 获取特定渲染配置。\r\n     */\r\n    Game.prototype.getOption = function (key) {\r\n        return this._initState[key];\r\n    };\r\n    /**\r\n     * 生命周期，在Game初始化时被触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onInit = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在Game被添加到引擎成功后被触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onAdd = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在Game启动后被处罚。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onStart = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在Game被暂停前触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onPause = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在Game被唤醒后触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onResume = function () {\r\n    };\r\n    /**\r\n     * 生命周期，用于错误边界处理。将在Game中大部分可预知错误发生时被调用（通常是生命周期中的非异步错误）。\r\n     * 错误将会根据一定的路径向上传递，一直到`Engine`的层次，你可以在确保完美处理了问题后返回`true`来通知引擎不再向上传递。\r\n     * 当然你也可以将自定义的一些错误加入错误边界机制中，详见[Exception](../../guide/exception)。\r\n     */\r\n    Game.prototype.onError = function (error, details) {\r\n    };\r\n    /**\r\n     * 生命周期，在Game每一帧更新时被触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onUpdate = function (delta) {\r\n    };\r\n    /**\r\n     * 生命周期，在Game销毁时被触发。\r\n     * 大部分Game生命周期都有其对应的全局方法，建议在`game.event`中去监听使用。\r\n     */\r\n    Game.prototype.onDestroy = function () {\r\n    };\r\n    /**\r\n     * 向Game类添加一个`World`。\r\n     *\r\n     * @param GameMode 承载World逻辑的Actor，需继承自`GameModeActor`，此World所有的Level都将共有这一个GameMode。\r\n     * @param PersistentLevelScript World至少有一个默认的Level，在添加World时必须指定一个入口Level。\r\n     * @param isDefault 此World是否是游戏默认的World，在游戏开始前至少有一个默认的World。\r\n     */\r\n    Game.prototype.addWorld = function (name, GameMode, PersistentLevelScript, isDefault) {\r\n        if (isDefault === void 0) { isDefault = false; }\r\n        this._worldsMeta[name] = {\r\n            GameMode: GameMode,\r\n            levels: {\r\n                persistent: {\r\n                    Script: PersistentLevelScript\r\n                }\r\n            }\r\n        };\r\n        if (isDefault || Object.keys(this._worldsMeta).length < 2) {\r\n            this._defaultWorldName = name;\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 从Game类中移除一个`World`。\r\n     *\r\n     * 注意不能移除当前正在运作的World。\r\n     */\r\n    Game.prototype.removeWorld = function (name) {\r\n        if (this._world.name.equalsTo(name)) {\r\n            throw new BreakGuardException(this, \"World \" + name + \" is running could not be removed !\");\r\n        }\r\n        this._world.destroy();\r\n        delete this._worldsMeta[name];\r\n        return this;\r\n    };\r\n    /**\r\n     * 切换当前正在运行的`World`。\r\n     *\r\n     * @param initState 如果需要，指定初始化状态，将会被clone，传`null`则没有效果。\r\n     * @param needInheritActors 是否需要从上一个World继承Actors。\r\n     */\r\n    Game.prototype.switchWorld = function (name, initState, needInheritActors) {\r\n        if (initState === void 0) { initState = null; }\r\n        if (needInheritActors === void 0) { needInheritActors = false; }\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            var inheritActors, oldWorld, _a, GameMode, levels;\r\n            return __generator(this, function (_b) {\r\n                switch (_b.label) {\r\n                    case 0:\r\n                        if (!this._worldsMeta[name]) {\r\n                            throw new MissingMemberException(this, 'World', name, this);\r\n                        }\r\n                        oldWorld = this._world;\r\n                        // todo: inherit actors from pre world\r\n                        if (oldWorld) {\r\n                            inheritActors = oldWorld.destroy(!needInheritActors);\r\n                        }\r\n                        _a = this._worldsMeta[name], GameMode = _a.GameMode, levels = _a.levels;\r\n                        this._world = new World(name, GameMode, levels, this);\r\n                        return [4 /*yield*/, this._world.init(initState)];\r\n                    case 1:\r\n                        _b.sent();\r\n                        if (!(inheritActors && needInheritActors)) return [3 /*break*/, 3];\r\n                        return [4 /*yield*/, this._world.switchLevel('persistent', null, inheritActors)];\r\n                    case 2:\r\n                        _b.sent();\r\n                        return [3 /*break*/, 5];\r\n                    case 3: return [4 /*yield*/, this.switchLevel('persistent')];\r\n                    case 4:\r\n                        _b.sent();\r\n                        _b.label = 5;\r\n                    case 5: return [2 /*return*/];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 向指定World添加一个`Level`。\r\n     *\r\n     * @param Script 承载Level逻辑的Actor，需继承自`LevelScriptActor`。\r\n     */\r\n    Game.prototype.addLevel = function (worldName, levelName, Script) {\r\n        if (!this._worldsMeta[worldName]) {\r\n            throw new MissingMemberException(this, 'World', worldName, this);\r\n        }\r\n        if (this._worldsMeta[worldName].levels[levelName]) {\r\n            throw new MemberConflictException(this, \"Level of world \" + worldName, levelName, this);\r\n        }\r\n        this._worldsMeta[worldName].levels[levelName] = { Script: Script };\r\n        return this;\r\n    };\r\n    /**\r\n     * 从指定World中移除一个`Level`。\r\n     */\r\n    Game.prototype.removeLevel = function (worldName, levelName) {\r\n        if (!this._worldsMeta[worldName]) {\r\n            return;\r\n        }\r\n        if (this._world.name.equalsTo(worldName) && this.level.name.equalsTo(levelName)) {\r\n            throw new BreakGuardException(this, \"Level \" + worldName + \" in world \" + this._world.name + \" is running could not be removed !\");\r\n        }\r\n        delete this._worldsMeta[worldName].levels[levelName];\r\n        return this;\r\n    };\r\n    /**\r\n     * 切换当前World中运行的`Level`。\r\n     * 注意Level之间的actors是会默认进入继承逻辑的。\r\n     */\r\n    Game.prototype.switchLevel = function (name, initState) {\r\n        if (initState === void 0) { initState = null; }\r\n        return this._world.switchLevel(name, initState);\r\n    };\r\n    /**\r\n     * 通过指定的InfoActor类`ActorClass`和初始化参数`initOptions`，向Game中添加一个actor。\r\n     * 注意继承自`SceneActor`或根组件为`SceneComponent`的Actor应当被添加到`World`中，而不是`Game`中。\r\n     */\r\n    Game.prototype.addActor = function (name, ActorClass, initOptions) {\r\n        var actor = new ActorClass(name, this, initOptions);\r\n        if (this.devMode) {\r\n            try {\r\n                actor.verifyAdding(initOptions);\r\n            }\r\n            catch (error) {\r\n                throwException(error, actor);\r\n                return;\r\n            }\r\n        }\r\n        actor.initialized();\r\n        var updatePriority = actor.updatePriority;\r\n        var priorities = this._actorsPriorities;\r\n        var priorityCount = this._actorsPriorityCount;\r\n        var count = priorityCount[updatePriority];\r\n        if (updatePriority === InfoActor.UPDATE_PRIORITY.Others) {\r\n            this._actors.add(actor);\r\n        }\r\n        else {\r\n            var length_1 = priorities.length;\r\n            var index = 0;\r\n            for (var i = 0; i < length_1; i += 1) {\r\n                var p = priorities[i];\r\n                if (updatePriority < p) {\r\n                    break;\r\n                }\r\n                index += priorityCount[p];\r\n            }\r\n            if (count === undefined) {\r\n                count = 0;\r\n                priorities.push(updatePriority);\r\n                /**\r\n                 * @todo: change to insert sorting?\r\n                 */\r\n                priorities.sort();\r\n            }\r\n            priorityCount[updatePriority] = count + 1;\r\n            this._actors.insert(index, actor);\r\n        }\r\n        actor._parent = this;\r\n        actor.added();\r\n        this._actorsNeedUpdate = true;\r\n        return actor;\r\n    };\r\n    /**\r\n     * 从Game中移除一个actor。\r\n     */\r\n    Game.prototype.removeActor = function (actor) {\r\n        actor.destroy();\r\n        actor._parent = null;\r\n        this._actors.remove(actor);\r\n        var updatePriority = actor.updatePriority;\r\n        var priorities = this._actorsPriorities;\r\n        var priorityCount = this._actorsPriorityCount;\r\n        var count = priorityCount[updatePriority];\r\n        if (updatePriority !== InfoActor.UPDATE_PRIORITY.Others) {\r\n            count -= 1;\r\n        }\r\n        if (count === 0) {\r\n            delete priorityCount[count];\r\n            priorities.splice(priorities.indexOf(updatePriority), 1);\r\n        }\r\n        this._actorsNeedUpdate = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 通过指定的玩家类`PlayerClass`，向Game中创建一个Player。\r\n     * 要结合玩家系统，详见[Player](./player)。\r\n     */\r\n    Game.prototype.createPlayer = function (name, PlayerClass, isDefault) {\r\n        if (isDefault === void 0) { isDefault = false; }\r\n        if (PlayerClass) {\r\n            this._players.set(name, new PlayerClass(name, this));\r\n        }\r\n        else {\r\n            this._players.set(name, new Player(name, this));\r\n        }\r\n        if (isDefault || this._players.empty) {\r\n            this._defaultPlayer = name;\r\n        }\r\n        return this._players.get(name);\r\n    };\r\n    /**\r\n     * 获取一个指定的Player实例引用。\r\n     */\r\n    Game.prototype.getPlayer = function (name) {\r\n        if (!name && this._defaultPlayer) {\r\n            name = this._defaultPlayer;\r\n        }\r\n        return this._players.get(name);\r\n    };\r\n    /**\r\n     * 移除一个指定的Player。\r\n     */\r\n    Game.prototype.removePlayer = function (name) {\r\n        var player = this._players.remove(name);\r\n        player.releaseController();\r\n        return this;\r\n    };\r\n    /**\r\n     * 清空Player列表。\r\n     */\r\n    Game.prototype.clearPlayers = function () {\r\n        this._players.forEach(function (player) {\r\n            player.releaseController();\r\n        });\r\n        this._players.clear();\r\n        return this;\r\n    };\r\n    Game.prototype.initLoaders = function (options) {\r\n        this._resource.register('GlTF', GlTFLoader);\r\n        this._resource.register('Image', ImageLoader);\r\n        this._resource.register('Texture', TextureLoader);\r\n        this._resource.register('CubeTexture', CubeTextureLoader);\r\n        this._resource.register('Atlas', AtlasLoader);\r\n        if (options.amcMemPages) {\r\n            GlTFLoader.GET_EXTENSION_HANDLER('ALI_amc_mesh_compression').memPages = options.amcMemPages;\r\n        }\r\n    };\r\n    Game.prototype.initEvents = function () {\r\n        var _this = this;\r\n        this._hid.register('MouseClick', MouseClickTrigger);\r\n        this._hid.register('MouseDown', MouseDownTrigger);\r\n        this._hid.register('MouseEnter', MouseEnterTrigger);\r\n        this._hid.register('MouseLeave', MouseLeaveTrigger);\r\n        this._hid.register('MouseMove', MouseMoveTrigger);\r\n        this._hid.register('MouseOut', MouseOutTrigger);\r\n        this._hid.register('MouseOver', MouseOverTrigger);\r\n        this._hid.register('MouseUp', MouseUpTrigger);\r\n        this._hid.register('MouseWheel', MouseWheelTrigger);\r\n        this._hid.register('Wheel', WheelTrigger);\r\n        this._hid.register('ContextMenu', ContextMenuTrigger);\r\n        this._hid.register('KeyDown', KeyDownTrigger);\r\n        this._hid.register('KeyUp', KeyUpTrigger);\r\n        this._hid.register('KeyPress', KeyPressTrigger);\r\n        this._hid.register('TouchStart', TouchStartTrigger);\r\n        this._hid.register('TouchEnd', TouchEndTrigger);\r\n        this._hid.register('TouchMove', TouchMoveTrigger);\r\n        this._hid.register('TouchCancel', TouchCancelTrigger);\r\n        this._event.register('Resize', WindowResizeTrigger);\r\n        this._event.register('GameDidInit');\r\n        this._event.register('GameDidStart');\r\n        this._event.register('GameWillPause');\r\n        this._event.register('GameDidResume');\r\n        this._event.register('GameWillDestroy');\r\n        this._event.register('WorldDidInit');\r\n        this._event.register('WorldDidCreatePlayers');\r\n        this._event.register('WorldWillDestroy');\r\n        this._event.register('LevelDidInit');\r\n        this._event.register('LevelWillPreload');\r\n        this._event.register('LevelIsPreloading');\r\n        this._event.register('LevelDidPreload');\r\n        this._event.register('LevelDidCreateActors');\r\n        this._event.register('LevelWillDestroy');\r\n        this._event.register('WebglContextLost');\r\n        this._event.register('WebglContextRestored');\r\n        this._event.register('MainRendererWillStart');\r\n        this._event.register('MainRendererIsCleared');\r\n        this._event.register('MainRendererIsFinished');\r\n        this._hiloStage.renderer.on('webglContextLost', function () { return _this._event.trigger('WebglContextLost'); });\r\n        this._hiloStage.renderer.on('webglContextRestored', function () { return _this._event.trigger('WebglContextRestored'); });\r\n        this._hiloStage.renderer.on('beforeRenderScene', function () { return _this._event.trigger('MainRendererIsCleared'); });\r\n        this.event.add('Resize', function () { return _this.resize(); });\r\n    };\r\n    Game.prototype.initSystems = function () {\r\n        this.game.addActor('physicSystem', PhysicSystemActor);\r\n    };\r\n    /**\r\n     * 重置画布容器尺寸。\r\n     */\r\n    Game.prototype.resize = function (bound) {\r\n        var _this = this;\r\n        bound = bound || this.bound;\r\n        var width = bound.width, height = bound.height;\r\n        var _a = this._hiloStage, pixelRatio = _a.pixelRatio, renderer = _a.renderer;\r\n        this._hiloStage.width = width;\r\n        this._hiloStage.height = height;\r\n        renderer.resize(width * pixelRatio, height * pixelRatio, true);\r\n        if (this.world) {\r\n            setTimeout(function () { return _this.world.resizeMainCamera(); }, 0);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 启动这个游戏。\r\n     */\r\n    Game.prototype.start = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                switch (_a.label) {\r\n                    case 0:\r\n                        if (!this._defaultWorldName) {\r\n                            throw new UnmetRequireException(this, 'A default world must be specified !');\r\n                        }\r\n                        this.resize();\r\n                        return [4 /*yield*/, this.switchWorld(this._defaultWorldName)];\r\n                    case 1:\r\n                        _a.sent();\r\n                        // destroyed\r\n                        if (!this._engine) {\r\n                            return [2 /*return*/, this];\r\n                        }\r\n                        this._engine.startGame(this);\r\n                        this._paused = false;\r\n                        this._event.trigger('GameDidStart', { game: this });\r\n                        return [2 /*return*/, this];\r\n                }\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 暂停这个游戏。\r\n     */\r\n    Game.prototype.pause = function () {\r\n        if (this._paused) {\r\n            return;\r\n        }\r\n        this._event.trigger('GameWillPause', { game: this });\r\n        this._engine.pauseGame(this);\r\n        this._paused = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 唤醒这个游戏。\r\n     */\r\n    Game.prototype.resume = function () {\r\n        if (!this._paused) {\r\n            return;\r\n        }\r\n        this._engine.resumeGame(this);\r\n        this._paused = false;\r\n        this._event.trigger('GameDidResume', { game: this });\r\n        return this;\r\n    };\r\n    /**\r\n     * 销毁这个游戏。\r\n     */\r\n    Game.prototype.destroy = function () {\r\n        _super.prototype.destroy.call(this);\r\n        this._paused = true;\r\n        this._event.trigger('GameWillDestroy', { game: this });\r\n        this._engine.destroyGame(this);\r\n        this._engine = null;\r\n        this._hid.destroy();\r\n        this._event.destroy();\r\n        this._world.destroy();\r\n        this.removeActor(this._state);\r\n        this._actors.forEach(function (actor) { return actor.destroy(); });\r\n        this._actors.clear();\r\n        this._hiloStage.destroy();\r\n        this._resource.destroy();\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    Game.prototype.update = function (delta) {\r\n        this._hid.flushAll();\r\n        this._event.flushAll();\r\n        try {\r\n            this.onUpdate(delta);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        if (this._actorsNeedUpdate) {\r\n            this._actorsForUpdate.copy(this._actors);\r\n            this._actorsNeedUpdate = false;\r\n        }\r\n        this._actorsForUpdate.forEach(function (actor) { return actor.update(delta); });\r\n        this._players.forEach(function (player) { return player.update(delta); });\r\n        if (this.world) {\r\n            this.world.update(delta);\r\n        }\r\n    };\r\n    Game = __decorate([\r\n        SClass({ className: 'Game', classType: 'Game' })\r\n    ], Game);\r\n    return Game;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`GameModeActor`。\r\n */\r\nfunction isGameModeActor(value) {\r\n    return value.isGameModeActor;\r\n}\r\n/**\r\n * 游戏玩法逻辑Actor类。此类承载着一个`World`的整体玩法逻辑，适用于其下的所有`Level`。\r\n *\r\n * @template IWorldState 世界状态参数类型。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar GameModeActor = /** @class */ (function (_super) {\r\n    __extends(GameModeActor, _super);\r\n    function GameModeActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isGameModeActor = true;\r\n        _this.updatePriority = InfoActor.UPDATE_PRIORITY.GameMode;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(GameModeActor.prototype, \"parent\", {\r\n        /**\r\n         * 此实例的父级实际指向`Game`。\r\n         */\r\n        get: function () {\r\n            return this._game;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(GameModeActor.prototype, \"state\", {\r\n        /**\r\n         * 获取当前`World`的状态。\r\n         */\r\n        get: function () {\r\n            return this.getWorld().state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 一个特殊的生命周期，在`onAdd`之后触发，只有在此生命周期内，你可以**执行阻塞的异步逻辑**。\r\n     * 这个生命周期一般用于用户登录、获取异步状态等逻辑，谨慎使用！\r\n     */\r\n    GameModeActor.prototype.onLogin = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 生命周期，在`onLogin`之后触发。\r\n     * 用于创建游戏玩家`Player`，默认会创建一个名为`'player'`的玩家。\r\n     */\r\n    GameModeActor.prototype.onCreatePlayers = function () {\r\n        this._game.createPlayer('player', null, true);\r\n    };\r\n    /**\r\n     * 生命周期，在`onDestroy`之后触发。\r\n     * 用于销毁玩家，默认不执行销毁，即保留玩家。\r\n     */\r\n    GameModeActor.prototype.onDestroyPlayers = function () {\r\n    };\r\n    /**\r\n     * 指定一个状态类，在此类所从属的`World`实例化时，会由其生成默认的`WorldState`实例。\r\n     */\r\n    GameModeActor.WorldStateClass = StateActor;\r\n    GameModeActor = __decorate([\r\n        SClass({ className: 'GameModeActor' })\r\n    ], GameModeActor);\r\n    return GameModeActor;\r\n}(InfoActor));\n\n/**\r\n * 判断一个实例是否为`LevelScriptActor`。\r\n */\r\nfunction isLevelScriptActor(value) {\r\n    return value.isLevelScriptActor;\r\n}\r\n/**\r\n * 游戏关卡逻辑Actor类。此类承载着一个`Level`的具体逻辑。\r\n *\r\n * @template ILevelState 关卡状态参数类型。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar LevelScriptActor = /** @class */ (function (_super) {\r\n    __extends(LevelScriptActor, _super);\r\n    function LevelScriptActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isLevelScriptActor = true;\r\n        _this.updatePriority = InfoActor.UPDATE_PRIORITY.LevelScript;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(LevelScriptActor.prototype, \"parent\", {\r\n        /**\r\n         * 此实例的父级实际指向`World`。\r\n         */\r\n        get: function () {\r\n            return this._game.world;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(LevelScriptActor.prototype, \"state\", {\r\n        /**\r\n         * 获取当前`Level`的状态。\r\n         */\r\n        get: function () {\r\n            return this.getLevel().state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 一个特殊的生命周期，在`onAdd`之后触发，只有在此生命周期内，你可以**执行阻塞的异步逻辑**。\r\n     * 这个生命周期一般用于用户登录、获取异步状态等逻辑，谨慎使用！\r\n     */\r\n    LevelScriptActor.prototype.onLogin = function () {\r\n        return __awaiter(this, void 0, void 0, function () {\r\n            return __generator(this, function (_a) {\r\n                return [2 /*return*/];\r\n            });\r\n        });\r\n    };\r\n    /**\r\n     * 生命周期，在`onLogin`之后触发。\r\n     * 这个生命周期用于关卡资源初始化，你也可以在这里直接创建一些Actor用于加载动画等。\r\n     */\r\n    LevelScriptActor.prototype.onPreload = function () {\r\n    };\r\n    /**\r\n     * 生命周期，在`onPreload`之后、每一次资源加载进度更新时触发。\r\n     * 你可以在这里更新你的家在进度。\r\n     */\r\n    LevelScriptActor.prototype.onLoading = function (state) {\r\n    };\r\n    /**\r\n     * 生命周期，在`onLoading`结束之后触发。\r\n     * 到了这个生命周期，所有的资源已经加载完毕就位，你可以执行实际上场景的创建了。\r\n     */\r\n    LevelScriptActor.prototype.onCreate = function () {\r\n    };\r\n    /**\r\n     * 指定一个状态类，在此类所从属的`Level`实例化时，会由其生成默认的`LevelState`实例。\r\n     */\r\n    LevelScriptActor.LevelStateClass = StateActor;\r\n    LevelScriptActor = __decorate([\r\n        SClass({ className: 'LevelScriptActor' })\r\n    ], LevelScriptActor);\r\n    return LevelScriptActor;\r\n}(InfoActor));\n\n/**\r\n * 判断一个实例是否为`Timer`。\r\n */\r\nfunction isTimerActor(value) {\r\n    return value.isTimerActor;\r\n}\r\n/**\r\n * 定时器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar TimerActor = /** @class */ (function (_super) {\r\n    __extends(TimerActor, _super);\r\n    function TimerActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isTimerActor = true;\r\n        _this._state = {\r\n            times: 0,\r\n            timeStep: 0,\r\n            current: 0\r\n        };\r\n        _this._delta = 0;\r\n        _this._paused = false;\r\n        _this._stopped = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TimerActor.prototype, \"event\", {\r\n        /**\r\n         * Timer的事件管理器。\r\n         *\r\n         * ```ts\r\n         * EventManager<{\r\n         *  Start: ITimerState;\r\n         *  Pause: ITimerState;\r\n         *  Resume: ITimerState;\r\n         *  Step: ITimerState;\r\n         *  End: ITimerState;\r\n         * }>\r\n         * ```\r\n         *\r\n         * [ITimerState](../interfaces/itimerstate)\r\n         */\r\n        get: function () {\r\n            return this._root.event;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 初始化，继承请先`super.onInit()`。\r\n     */\r\n    TimerActor.prototype.onInit = function () {\r\n        this.event.register('Start');\r\n        this.event.register('Pause');\r\n        this.event.register('Resume');\r\n        this.event.register('Step');\r\n        this.event.register('End');\r\n    };\r\n    /**\r\n     * 每帧更新，继承请先`super.onUpdate()`。\r\n     */\r\n    TimerActor.prototype.onUpdate = function (delta) {\r\n        if (this._stopped) {\r\n            this._delta = 0;\r\n            return;\r\n        }\r\n        if (this._delta < this._state.timeStep) {\r\n            this._delta += delta;\r\n            return;\r\n        }\r\n        this._delta = 0;\r\n        if (this._state.current === this._state.times) {\r\n            this.stop();\r\n            return;\r\n        }\r\n        this._state.current += 1;\r\n        this.event.trigger('Step', this._state);\r\n    };\r\n    /**\r\n     * 启动Timer。\r\n     *\r\n     * @param times 此次倒计时总步数。\r\n     * @param timeStep 此次倒计每次步长。\r\n     */\r\n    TimerActor.prototype.start = function (times, timeStep) {\r\n        this._state.times = times;\r\n        this._state.timeStep = timeStep;\r\n        this._state.current = 0;\r\n        this.event.trigger('Start', this._state);\r\n        this._paused = false;\r\n        this._stopped = false;\r\n        return this;\r\n    };\r\n    /**\r\n     * 暂停Timer。\r\n     */\r\n    TimerActor.prototype.pause = function () {\r\n        if (this._paused || this._stopped) {\r\n            return;\r\n        }\r\n        this._paused = true;\r\n        this.event.trigger('Pause', this._state);\r\n        return this;\r\n    };\r\n    /**\r\n     * 唤醒Timer。\r\n     */\r\n    TimerActor.prototype.resume = function () {\r\n        if (this._stopped || !this._paused) {\r\n            return;\r\n        }\r\n        this._delta = 0;\r\n        this.event.trigger('Resume', this._state);\r\n        this._paused = false;\r\n        return this;\r\n    };\r\n    /**\r\n     * 停止Timer。\r\n     */\r\n    TimerActor.prototype.stop = function () {\r\n        this._stopped = true;\r\n        this.event.trigger('End', this._state);\r\n        return this;\r\n    };\r\n    TimerActor = __decorate([\r\n        SClass({ className: 'Timer', classType: 'Timer' })\r\n    ], TimerActor);\r\n    return TimerActor;\r\n}(InfoActor));\n\n/**\r\n * Sein.js封装的用于存储`SObject`实例的特殊Set容器。\r\n * 通过实例的`uuid`表征唯一性。\r\n *\r\n * @template T 存储的实例的类型。\r\n */\r\nvar SSet = /** @class */ (function (_super) {\r\n    __extends(SSet, _super);\r\n    function SSet() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this._table = {};\r\n        return _this;\r\n    }\r\n    /**\r\n     * 添加一个实例到SArray中。\r\n     */\r\n    SSet.prototype.add = function (item) {\r\n        if (this._table[item.uuid]) {\r\n            return;\r\n        }\r\n        this.addItem(item);\r\n        this._table[item.uuid] = item;\r\n        return this;\r\n    };\r\n    /**\r\n     * 从容器中移除一个实例。\r\n     */\r\n    SSet.prototype.remove = function (item) {\r\n        if (!this._table[item.uuid]) {\r\n            return;\r\n        }\r\n        this.removeItem(item);\r\n        delete this._table[item.uuid];\r\n        return this;\r\n    };\r\n    /**\r\n     * 清空所有存储的实例。\r\n     */\r\n    SSet.prototype.clear = function () {\r\n        _super.prototype.clear.call(this);\r\n        this._table = {};\r\n        return this;\r\n    };\r\n    /**\r\n     * 从一个基本的数组实例初始化SIterable。\r\n     */\r\n    SSet.prototype.fromArray = function (array) {\r\n        this.clear();\r\n        var length = array.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            this.add(array[index]);\r\n        }\r\n        return this;\r\n    };\r\n    return SSet;\r\n}(SIterable));\n\n/**\r\n * 判断一个实例是否为`TypeConflictException`。\r\n */\r\nfunction isTypeConflictException(value) {\r\n    return value.isTypeConflictException;\r\n}\r\n/**\r\n * 类型冲突异常。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar TypeConflictException = /** @class */ (function (_super) {\r\n    __extends(TypeConflictException, _super);\r\n    /**\r\n     * 构建异常。\r\n     *\r\n     * @param member 成员实例。\r\n     * @param requireType 需求的类型。\r\n     * @param object 触发异常的实例。\r\n     * @param message 追加信息。\r\n     */\r\n    function TypeConflictException(member, requireType, object, message) {\r\n        if (message === void 0) { message = ''; }\r\n        var _this = _super.call(this, 'TypeConflict', object, \"Type of \\\"\" + member.name + \"\\\" is \\\"\" + member.classType + \"\\\", but type \\\"\" + requireType + \"\\\" is required. \\\"\" + parent.name + \"\\\". \" + message) || this;\r\n        _this.isTypeConflictException = true;\r\n        return _this;\r\n    }\r\n    return TypeConflictException;\r\n}(BaseException));\n\n/**\r\n * 判断一个实例是否为`ControllerActor`。\r\n */\r\nfunction isControllerActor(value) {\r\n    return value.isControllerActor;\r\n}\r\n/**\r\n * 控制器类，作为`World`中棋子SceneActor的抽象逻辑控制代理。\r\n * 一般不直接使用，而是使用其派生类`PlayerControllerActor`和`AIControllerActor`。\r\n * 和玩家系统有关，详见[Player](./player)。\r\n *\r\n * @template IState 指定状态的类型。\r\n * @template IActor 指定允许控制的Actor的类型。\r\n * @noInheritDoc\r\n */\r\nvar ControllerActor = /** @class */ (function (_super) {\r\n    __extends(ControllerActor, _super);\r\n    function ControllerActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isControllerActor = true;\r\n        _this._follow = false;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(ControllerActor.prototype, \"actor\", {\r\n        /**\r\n         * 获取当前控制的actor。\r\n         */\r\n        get: function () {\r\n            return this._actor;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(ControllerActor.prototype, \"state\", {\r\n        /**\r\n         * 获取当前关联的状态。\r\n         */\r\n        get: function () {\r\n            return this._state;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 生命周期，将在获得了一个actor的控制权时呗触发。\r\n     */\r\n    ControllerActor.prototype.onPossesActor = function (actor) {\r\n    };\r\n    /**\r\n     * 生命周期，将在失去了一个actor的控制权时呗触发。\r\n     */\r\n    ControllerActor.prototype.onDisPossesActor = function (actor) {\r\n    };\r\n    /**\r\n     * 控制一个actor。\r\n     */\r\n    ControllerActor.prototype.possessActor = function (actor) {\r\n        if (this._actor) {\r\n            throw new BreakGuardException(this, \"Controller \" + this.name + \" already has actor \" + this.actor.name + \" !\");\r\n        }\r\n        if (actor._controller) {\r\n            throw new BreakGuardException(this, \"Actor \" + actor.name + \" already controlled by controller \" + actor.getController().name + \" !\");\r\n        }\r\n        this._actor = actor;\r\n        this._actor._controller = this;\r\n        try {\r\n            this.onPossesActor(actor);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 解除一个actor的控制。\r\n     *\r\n     * @param transferTo 如果存在，将当前控制的actor的控制权移交。\r\n     */\r\n    ControllerActor.prototype.dispossessActor = function (transferTo) {\r\n        try {\r\n            this.onDisPossesActor(this._actor);\r\n        }\r\n        catch (error) {\r\n            throwException(error, this);\r\n        }\r\n        if (this._actor) {\r\n            this._actor.controller = null;\r\n        }\r\n        this._actor = null;\r\n        if (transferTo) {\r\n            transferTo.possessActor(this);\r\n        }\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取当前控制的actor，可用于类型推断。\r\n     */\r\n    ControllerActor.prototype.getActor = function () {\r\n        return this._actor;\r\n    };\r\n    ControllerActor.prototype.switchState = function (state) {\r\n        if (state.controller) {\r\n            state.controller._state = null;\r\n        }\r\n        this._state = state;\r\n        state._controller = this;\r\n        return this;\r\n    };\r\n    /**\r\n     * 获取当前关联的状态，可用于类型推断。\r\n     */\r\n    ControllerActor.prototype.getState = function () {\r\n        return this._state;\r\n    };\r\n    /**\r\n     * 跟随actor，由于ControllerActor自身也是`SceneActor`，所以其自己也有`transform`。\r\n     * 你可以给其添加一个摄像机组件来达成一些有意思的玩法。\r\n     */\r\n    ControllerActor.prototype.followActor = function () {\r\n        this._follow = true;\r\n        return this;\r\n    };\r\n    /**\r\n     * 取消跟随`Actor`。\r\n     */\r\n    ControllerActor.prototype.unFollowActor = function () {\r\n        this._follow = false;\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    ControllerActor.prototype.added = function () {\r\n        _super.prototype.added.call(this);\r\n        var initState = this._initOptions;\r\n        if (initState.state) {\r\n            this.switchState(initState.state);\r\n        }\r\n        if (initState.actor) {\r\n            this.possessActor(initState.actor);\r\n        }\r\n        this._follow = !!initState.followActor;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    ControllerActor.prototype.update = function (delta) {\r\n        _super.prototype.update.call(this, delta);\r\n        if (this._follow && this._actor) {\r\n            this.transform.matrix.copy(this._actor.transform.matrix);\r\n        }\r\n    };\r\n    ControllerActor = __decorate([\r\n        SClass({ className: 'ControllerActor', classType: 'Controller' })\r\n    ], ControllerActor);\r\n    return ControllerActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`PlayerControllerActor`。\r\n */\r\nfunction isPlayerControllerActor(value) {\r\n    return value.isPlayerControllerActor;\r\n}\r\n/**\r\n * 玩家控制器类，区别于AI控制器，和玩家系统有关，详见[Player](./player)。\r\n *\r\n * @template IState 指定状态的类型。\r\n * @template IActor 指定允许控制的Actor的类型。\r\n * @noInheritDoc\r\n */\r\nvar PlayerControllerActor = /** @class */ (function (_super) {\r\n    __extends(PlayerControllerActor, _super);\r\n    function PlayerControllerActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPlayerControllerActor = true;\r\n        _this.persistent = true;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(PlayerControllerActor.prototype, \"player\", {\r\n        /**\r\n         * 获取当前拥有自身的玩家。\r\n         */\r\n        get: function () {\r\n            return this._player;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 设置当前拥有自身的玩家。\r\n     */\r\n    PlayerControllerActor.prototype.setPlayer = function (player) {\r\n        player.switchController(this);\r\n        return this;\r\n    };\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    PlayerControllerActor.prototype.onDestroy = function () {\r\n        if (this._player) {\r\n            this._player.releaseController();\r\n        }\r\n        _super.prototype.onDestroy.call(this);\r\n    };\r\n    PlayerControllerActor = __decorate([\r\n        SClass({ className: 'PlayerControllerActor' })\r\n    ], PlayerControllerActor);\r\n    return PlayerControllerActor;\r\n}(ControllerActor));\n\n/**\r\n * 判断一个实例是否为`PlayerStateActor`。\r\n */\r\nfunction isPlayerStateActor(value) {\r\n    return value.isPlayerStateActor;\r\n}\r\n/**\r\n * 用户状态类，可被`ControllerActor`关联。\r\n * 和玩家系统有关，详见[Player](./player)。\r\n *\r\n * @template IOptionTypes 初始化参数类型。\r\n * @noInheritDoc\r\n */\r\nvar PlayerStateActor = /** @class */ (function (_super) {\r\n    __extends(PlayerStateActor, _super);\r\n    function PlayerStateActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPlayerStateActor = true;\r\n        return _this;\r\n    }\r\n    /**\r\n     * 获取当前关联的Controller。\r\n     */\r\n    PlayerStateActor.prototype.getController = function () {\r\n        return this._controller;\r\n    };\r\n    PlayerStateActor = __decorate([\r\n        SClass({ className: 'PlayerStateActor' })\r\n    ], PlayerStateActor);\r\n    return PlayerStateActor;\r\n}(StateActor));\n\n/**\r\n * 判断一个实例是否为`AIControllerActor`。\r\n */\r\nfunction isAIControllerActor(value) {\r\n    return value.isAIControllerActor;\r\n}\r\n/**\r\n * AI控制器类，区别于玩家控制器，完全由代码逻辑控制。\r\n * 和玩家系统有关，详见[Player](./player)。\r\n *\r\n * @template IState 指定状态的类型。\r\n * @template IActor 指定允许控制的Actor的类型。\r\n * @noInheritDoc\r\n */\r\nvar AIControllerActor = /** @class */ (function (_super) {\r\n    __extends(AIControllerActor, _super);\r\n    function AIControllerActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isAIControllerActor = true;\r\n        return _this;\r\n        // todo: 添加默认行为树\r\n    }\r\n    AIControllerActor = __decorate([\r\n        SClass({ className: 'AIControllerActor' })\r\n    ], AIControllerActor);\r\n    return AIControllerActor;\r\n}(ControllerActor));\n\n/**\r\n * 判断一个实例是否为`Fog`。\r\n */\r\nfunction isFog(value) {\r\n    return value.isFog;\r\n}\r\nvar Fog = /** @class */ (function (_super) {\r\n    __extends(Fog, _super);\r\n    function Fog() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Fog;\r\n}(Hilo3d$2.Fog));\n\n/**\r\n * 判断一个实例是否为`FrameBuffer`。\r\n */\r\nfunction isFrameBuffer(value) {\r\n    return value.isFramebuffer;\r\n}\r\n/**\r\n * FrameBuffer。可以作为渲染的目标对象。\r\n */\r\nvar FrameBuffer = /** @class */ (function (_super) {\r\n    __extends(FrameBuffer, _super);\r\n    function FrameBuffer(game, options) {\r\n        return _super.call(this, game.renderer, options) || this;\r\n    }\r\n    return FrameBuffer;\r\n}(Hilo3d$2.Framebuffer));\n\n/**\r\n * 判断一个实例是否为`RenderSystemActor`。\r\n */\r\nfunction isRenderSystemActor(value) {\r\n    return value.isRenderSystemActor;\r\n}\r\n/**\r\n * 渲染系统，可以用于精确控制整个渲染流程，达到需要多个PASS的渲染的效果（例如镜面、后处理等等）。\r\n *\r\n * 实例请见[进阶渲染](../../example/render/advance)。\r\n */\r\nvar RenderSystemActor = /** @class */ (function (_super) {\r\n    __extends(RenderSystemActor, _super);\r\n    function RenderSystemActor() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isRenderSystemActor = true;\r\n        _this.handlePreRender = function () { return _this.onPreRender(_this._initOptions); };\r\n        _this.handlePostClear = function () { return _this.onPostClear(_this._initOptions); };\r\n        _this.handlePostRender = function () { return _this.onPostRender(_this._initOptions); };\r\n        return _this;\r\n    }\r\n    /**\r\n     * 初始化，继承请先调用`super.onInit`。\r\n     */\r\n    RenderSystemActor.prototype.onInit = function (initOptions) {\r\n        this.bindEvents();\r\n    };\r\n    /**\r\n     * 取消链接，将会暂时让功能失效，继承请先调用`super.onUnLink`。\r\n     */\r\n    RenderSystemActor.prototype.onUnLink = function () {\r\n        this.unBindEvents();\r\n    };\r\n    /**\r\n     * 取消链接，将会让功能恢复，继承请先调用`super.onReLink`。\r\n     */\r\n    RenderSystemActor.prototype.onReLink = function () {\r\n        this.bindEvents();\r\n    };\r\n    /**\r\n     * 在整个世界中的所有物体被默认渲染前触发。\r\n     * **注意不要在这里切换主相机！**\r\n     */\r\n    RenderSystemActor.prototype.onPreRender = function (initOptions) {\r\n    };\r\n    /**\r\n     * 在整个画面被`Clear`后触发。\r\n     * 如果想默认渲染到`Renderer`内置的`Frame`或者插入一些类似于手机相机的画面等，可以在这里完成。\r\n     * **注意不要在这里修改任何图层！也不要在这里切换主相机！**\r\n     */\r\n    RenderSystemActor.prototype.onPostClear = function (initOptions) {\r\n    };\r\n    /**\r\n     * 在整个所有的模型被默认渲染到屏幕后触发。\r\n     * **注意不要在这里切换主相机！**\r\n     */\r\n    RenderSystemActor.prototype.onPostRender = function (initOptions) {\r\n    };\r\n    /**\r\n     * 销毁逻辑，继承请先调用`super.onDestroy`。\r\n     */\r\n    RenderSystemActor.prototype.onDestroy = function () {\r\n        this.unBindEvents();\r\n    };\r\n    RenderSystemActor.prototype.bindEvents = function () {\r\n        var game = this.getGame();\r\n        game.event.add('MainRendererWillStart', this.handlePreRender);\r\n        game.event.add('MainRendererIsCleared', this.handlePostClear);\r\n        game.event.add('MainRendererIsFinished', this.handlePostRender);\r\n    };\r\n    RenderSystemActor.prototype.unBindEvents = function () {\r\n        var game = this.getGame();\r\n        game.event.remove('MainRendererWillStart', this.handlePreRender);\r\n        game.event.remove('MainRendererIsCleared', this.handlePostClear);\r\n        game.event.remove('MainRendererIsFinished', this.handlePostRender);\r\n    };\r\n    RenderSystemActor = __decorate([\r\n        SClass({ className: 'RenderSystemActor' })\r\n    ], RenderSystemActor);\r\n    return RenderSystemActor;\r\n}(SystemActor));\n\nvar VertexArrayObject = /** @class */ (function (_super) {\r\n    __extends(VertexArrayObject, _super);\r\n    function VertexArrayObject() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return VertexArrayObject;\r\n}(Hilo3d$2.VertexArrayObject));\n\nvar Program = /** @class */ (function (_super) {\r\n    __extends(Program, _super);\r\n    function Program() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Program;\r\n}(Hilo3d$2.Program));\n\n/**\r\n * @File   : GLCapabilities.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 6/10/2019, 10:40:17 PM\r\n * @Description:\r\n */\r\nvar GLCapabilities = Hilo3d$2.capabilities;\n\n/**\r\n * @File   : GLExtensions.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 6/10/2019, 10:40:59 PM\r\n * @Description:\r\n */\r\nvar GLExtensions = Hilo3d$2.extensions;\n\nvar Buffer = /** @class */ (function (_super) {\r\n    __extends(Buffer, _super);\r\n    function Buffer() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Buffer;\r\n}(Hilo3d$2.Buffer));\n\n/**\r\n * 判断一个实例是否为`BSPBoxComponent`。\r\n */\r\nfunction isBSPBoxComponent(value) {\r\n    return value.isBSPBoxComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPBoxActor`。\r\n */\r\nfunction isBSPBoxActor(value) {\r\n    return isSceneActor(value) && isBSPBoxComponent(value.root);\r\n}\r\n/**\r\n * 基础立方体。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPBoxComponent = /** @class */ (function (_super) {\r\n    __extends(BSPBoxComponent, _super);\r\n    function BSPBoxComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPBoxComponent = true;\r\n        return _this;\r\n    }\r\n    BSPBoxComponent.prototype.convertState = function (initState) {\r\n        var width = initState.width, height = initState.height, depth = initState.depth, widthSegments = initState.widthSegments, heightSegments = initState.heightSegments, depthSegments = initState.depthSegments, others = __rest(initState, [\"width\", \"height\", \"depth\", \"widthSegments\", \"heightSegments\", \"depthSegments\"]);\r\n        var result = others;\r\n        result.geometry = new BoxGeometry(initState);\r\n        return result;\r\n    };\r\n    BSPBoxComponent = __decorate([\r\n        SClass({ className: 'BSPBoxComponent' })\r\n    ], BSPBoxComponent);\r\n    return BSPBoxComponent;\r\n}(BSPComponent));\n\n/**\r\n * 判断一个实例是否为`PlaneGeometry`。\r\n */\r\nfunction isPlaneGeometry(value) {\r\n    return value.isPlaneGeometry;\r\n}\r\nvar PlaneGeometry = /** @class */ (function (_super) {\r\n    __extends(PlaneGeometry, _super);\r\n    function PlaneGeometry() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return PlaneGeometry;\r\n}(Hilo3d$2.PlaneGeometry));\n\n/**\r\n * 判断一个实例是否为`BSPPlaneComponent`。\r\n */\r\nfunction isBSPPlaneComponent(value) {\r\n    return value.isBSPPlaneComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPPlaneActor`。\r\n */\r\nfunction isBSPPlaneActor(value) {\r\n    return isSceneActor(value) && isBSPPlaneComponent(value.root);\r\n}\r\n/**\r\n * 基础平面。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPPlaneComponent = /** @class */ (function (_super) {\r\n    __extends(BSPPlaneComponent, _super);\r\n    function BSPPlaneComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPPlaneComponent = true;\r\n        return _this;\r\n    }\r\n    BSPPlaneComponent.prototype.convertState = function (initState) {\r\n        var width = initState.width, height = initState.height, widthSegments = initState.widthSegments, heightSegments = initState.heightSegments, others = __rest(initState, [\"width\", \"height\", \"widthSegments\", \"heightSegments\"]);\r\n        var result = others;\r\n        result.geometry = new PlaneGeometry(initState);\r\n        return result;\r\n    };\r\n    BSPPlaneComponent = __decorate([\r\n        SClass({ className: 'BSPPlaneComponent' })\r\n    ], BSPPlaneComponent);\r\n    return BSPPlaneComponent;\r\n}(BSPComponent));\n\n/**\r\n * 判断一个实例是否为`BSPSphereComponent`。\r\n */\r\nfunction isBSPSphereComponent(value) {\r\n    return value.isBSPSphereComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPSphereActor`。\r\n */\r\nfunction isBSPSphereActor(value) {\r\n    return isSceneActor(value) && isBSPSphereComponent(value.root);\r\n}\r\n/**\r\n * 基础球体。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPSphereComponent = /** @class */ (function (_super) {\r\n    __extends(BSPSphereComponent, _super);\r\n    function BSPSphereComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPSphereComponent = true;\r\n        return _this;\r\n    }\r\n    BSPSphereComponent.prototype.convertState = function (initState) {\r\n        var radius = initState.radius, widthSegments = initState.widthSegments, heightSegments = initState.heightSegments, others = __rest(initState, [\"radius\", \"widthSegments\", \"heightSegments\"]);\r\n        var result = others;\r\n        result.geometry = new SphereGeometry(initState);\r\n        return result;\r\n    };\r\n    BSPSphereComponent = __decorate([\r\n        SClass({ className: 'BSPSphereComponent' })\r\n    ], BSPSphereComponent);\r\n    return BSPSphereComponent;\r\n}(BSPComponent));\n\n/**\r\n * 判断一个实例是否为`Geometry`。\r\n */\r\nfunction isGeometry(value) {\r\n    return value.isGeometry;\r\n}\r\nvar Geometry = /** @class */ (function (_super) {\r\n    __extends(Geometry, _super);\r\n    function Geometry() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Geometry;\r\n}(Hilo3d$2.Geometry));\n\n/**\r\n * 判断一个实例是否为`GeometryData`。\r\n */\r\nfunction isGeometryData(value) {\r\n    return value.isGeometryData;\r\n}\r\nvar GeometryData = /** @class */ (function (_super) {\r\n    __extends(GeometryData, _super);\r\n    function GeometryData(data, size, params) {\r\n        return _super.call(this, data, size, params) || this;\r\n    }\r\n    return GeometryData;\r\n}(Hilo3d$2.GeometryData));\n\n/**\r\n * 判断一个实例是否为`CylinderGeometry`。\r\n */\r\nfunction isCylinderGeometry(value) {\r\n    return value.isCylinderGeometry;\r\n}\r\n/**\r\n * 圆柱几何体。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CylinderGeometry = /** @class */ (function (_super) {\r\n    __extends(CylinderGeometry, _super);\r\n    function CylinderGeometry(params) {\r\n        var _this = _super.call(this, params) || this;\r\n        _this.isCylinderGeometry = true;\r\n        _this.className = 'CylinderGeometry';\r\n        _this._options = {\r\n            radiusTop: 1,\r\n            radiusBottom: 1,\r\n            height: 1,\r\n            radialSegments: 8,\r\n            heightSegments: 1,\r\n            openEnded: false,\r\n            thetaStart: 0,\r\n            thetaLength: Math.PI * 2\r\n        };\r\n        Object.assign(_this._options, params);\r\n        _this.build();\r\n        return _this;\r\n    }\r\n    /* tslint:disable */\r\n    CylinderGeometry.prototype.build = function () {\r\n        var _a = this._options, radiusTop = _a.radiusTop, radiusBottom = _a.radiusBottom, height = _a.height, radialSegments = _a.radialSegments, heightSegments = _a.heightSegments, openEnded = _a.openEnded, thetaStart = _a.thetaStart, thetaLength = _a.thetaLength;\r\n        var indices = [];\r\n        var vertices = [];\r\n        var normals = [];\r\n        var uvs = [];\r\n        var index = 0;\r\n        var indexArray = [];\r\n        var halfHeight = height / 2;\r\n        generateTorso();\r\n        if (openEnded === false) {\r\n            if (radiusTop > 0) {\r\n                generateCap(true);\r\n            }\r\n            if (radiusBottom > 0) {\r\n                generateCap(false);\r\n            }\r\n        }\r\n        this.vertices = new GeometryData(new Float32Array(vertices), 3, null);\r\n        this.indices = new GeometryData(new Uint16Array(indices), 1, null);\r\n        this.uvs = new GeometryData(new Float32Array(uvs), 2, null);\r\n        this.normals = new GeometryData(new Float32Array(normals), 3, null);\r\n        function generateTorso() {\r\n            var x;\r\n            var y;\r\n            var normal = new Vector3();\r\n            var vertex = new Vector3();\r\n            // this will be used to calculate the normal\r\n            var slope = (radiusBottom - radiusTop) / height;\r\n            // generate vertices, normals and uvs\r\n            for (y = 0; y <= heightSegments; y++) {\r\n                var indexRow = [];\r\n                var v = y / heightSegments;\r\n                // calculate the radius of the current row\r\n                var radius = v * (radiusBottom - radiusTop) + radiusTop;\r\n                for (x = 0; x <= radialSegments; x++) {\r\n                    var u = x / radialSegments;\r\n                    var theta = u * thetaLength + thetaStart;\r\n                    var sinTheta = Math.sin(theta);\r\n                    var cosTheta = Math.cos(theta);\r\n                    // vertex\r\n                    vertex.x = radius * sinTheta;\r\n                    vertex.y = -v * height + halfHeight;\r\n                    vertex.z = radius * cosTheta;\r\n                    vertices.push(vertex.x, vertex.y, vertex.z);\r\n                    // normal\r\n                    normal.set(sinTheta, slope, cosTheta).normalize();\r\n                    normals.push(normal.x, normal.y, normal.z);\r\n                    // uv\r\n                    uvs.push(u, 1 - v);\r\n                    // save index of vertex in respective row\r\n                    indexRow.push(index++);\r\n                }\r\n                // now save vertices of the row in our index array\r\n                indexArray.push(indexRow);\r\n            }\r\n            // generate indices\r\n            for (x = 0; x < radialSegments; x++) {\r\n                for (y = 0; y < heightSegments; y++) {\r\n                    // we use the index array to access the correct indices\r\n                    var a = indexArray[y][x];\r\n                    var b = indexArray[y + 1][x];\r\n                    var c = indexArray[y + 1][x + 1];\r\n                    var d = indexArray[y][x + 1];\r\n                    // faces\r\n                    indices.push(a, b, d);\r\n                    indices.push(b, c, d);\r\n                }\r\n            }\r\n        }\r\n        function generateCap(top) {\r\n            var x;\r\n            var centerIndexStart;\r\n            var centerIndexEnd;\r\n            var uv = new Vector2();\r\n            var vertex = new Vector3();\r\n            var radius = (top === true) ? radiusTop : radiusBottom;\r\n            var sign = (top === true) ? 1 : -1;\r\n            // save the index of the first center vertex\r\n            centerIndexStart = index;\r\n            // first we generate the center vertex data of the cap.\r\n            // because the geometry needs one set of uvs per face,\r\n            // we must generate a center vertex per face/segment\r\n            for (x = 1; x <= radialSegments; x++) {\r\n                // vertex\r\n                vertices.push(0, halfHeight * sign, 0);\r\n                // normal\r\n                normals.push(0, sign, 0);\r\n                // uv\r\n                uvs.push(0.5, 0.5);\r\n                // increase index\r\n                index++;\r\n            }\r\n            // save the index of the last center vertex\r\n            centerIndexEnd = index;\r\n            // now we generate the surrounding vertices, normals and uvs\r\n            for (x = 0; x <= radialSegments; x++) {\r\n                var u = x / radialSegments;\r\n                var theta = u * thetaLength + thetaStart;\r\n                var cosTheta = Math.cos(theta);\r\n                var sinTheta = Math.sin(theta);\r\n                // vertex\r\n                vertex.x = radius * sinTheta;\r\n                vertex.y = halfHeight * sign;\r\n                vertex.z = radius * cosTheta;\r\n                vertices.push(vertex.x, vertex.y, vertex.z);\r\n                // normal\r\n                normals.push(0, sign, 0);\r\n                // uv\r\n                uv.x = (cosTheta * 0.5) + 0.5;\r\n                uv.y = (sinTheta * 0.5 * sign) + 0.5;\r\n                uvs.push(uv.x, uv.y);\r\n                // increase index\r\n                index++;\r\n            }\r\n            // generate indices\r\n            for (x = 0; x < radialSegments; x++) {\r\n                var c = centerIndexStart + x;\r\n                var i = centerIndexEnd + x;\r\n                if (top === true) {\r\n                    // face top\r\n                    indices.push(i, i + 1, c);\r\n                }\r\n                else {\r\n                    // face bottom\r\n                    indices.push(i + 1, i, c);\r\n                }\r\n            }\r\n        }\r\n    };\r\n    return CylinderGeometry;\r\n}(Geometry));\n\n/**\r\n * 判断一个实例是否为`BSPCylinderComponent`。\r\n */\r\nfunction isBSPCylinderComponent(value) {\r\n    return value.isBSPCylinderComponent;\r\n}\r\n/**\r\n * 判断一个实例是否为`BSPCylinderActor`。\r\n */\r\nfunction isBSPCylinderActor(value) {\r\n    return isSceneActor(value) && isBSPCylinderComponent(value.root);\r\n}\r\n/**\r\n * 基础圆柱体。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPCylinderComponent = /** @class */ (function (_super) {\r\n    __extends(BSPCylinderComponent, _super);\r\n    function BSPCylinderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isBSPCylinderComponent = true;\r\n        return _this;\r\n    }\r\n    BSPCylinderComponent.prototype.convertState = function (initState) {\r\n        var radiusTop = initState.radiusTop, radiusBottom = initState.radiusBottom, height = initState.height, radialSegments = initState.radialSegments, heightSegments = initState.heightSegments, openEnded = initState.openEnded, thetaStart = initState.thetaStart, thetaLength = initState.thetaLength, others = __rest(initState, [\"radiusTop\", \"radiusBottom\", \"height\", \"radialSegments\", \"heightSegments\", \"openEnded\", \"thetaStart\", \"thetaLength\"]);\r\n        var result = others;\r\n        result.geometry = new CylinderGeometry(initState);\r\n        return result;\r\n    };\r\n    BSPCylinderComponent = __decorate([\r\n        SClass({ className: 'BSPCylinderComponent' })\r\n    ], BSPCylinderComponent);\r\n    return BSPCylinderComponent;\r\n}(BSPComponent));\n\n/**\r\n * [BSPBoxComponent](../bspboxcomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPBoxActor = /** @class */ (function (_super) {\r\n    __extends(BSPBoxActor, _super);\r\n    function BSPBoxActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BSPBoxActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', BSPBoxComponent, options);\r\n    };\r\n    BSPBoxActor = __decorate([\r\n        SClass({ className: 'BSPBoxActor' })\r\n    ], BSPBoxActor);\r\n    return BSPBoxActor;\r\n}(SceneActor));\n\n/**\r\n * [BSPCylinderComponent](../bspcylindercomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPCylinderActor = /** @class */ (function (_super) {\r\n    __extends(BSPCylinderActor, _super);\r\n    function BSPCylinderActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BSPCylinderActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', BSPCylinderComponent, options);\r\n    };\r\n    BSPCylinderActor = __decorate([\r\n        SClass({ className: 'BSPCylinderActor' })\r\n    ], BSPCylinderActor);\r\n    return BSPCylinderActor;\r\n}(SceneActor));\n\n/**\r\n * [BSPPlaneComponent](../bspplanecomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPPlaneActor = /** @class */ (function (_super) {\r\n    __extends(BSPPlaneActor, _super);\r\n    function BSPPlaneActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BSPPlaneActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', BSPPlaneComponent, options);\r\n    };\r\n    BSPPlaneActor = __decorate([\r\n        SClass({ className: 'BSPPlaneActor' })\r\n    ], BSPPlaneActor);\r\n    return BSPPlaneActor;\r\n}(SceneActor));\n\n/**\r\n * [BSPSphereComponent](../bspspherecomponent)的一个包装容器。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BSPSphereActor = /** @class */ (function (_super) {\r\n    __extends(BSPSphereActor, _super);\r\n    function BSPSphereActor() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BSPSphereActor.prototype.onCreateRoot = function (options) {\r\n        return this.addComponent('root', BSPSphereComponent, options);\r\n    };\r\n    BSPSphereActor = __decorate([\r\n        SClass({ className: 'BSPSphereActor' })\r\n    ], BSPSphereActor);\r\n    return BSPSphereActor;\r\n}(SceneActor));\n\n/**\r\n * 判断一个实例是否为`CubeTexture`。\r\n */\r\nfunction isCubeTexture(value) {\r\n    return value.isCubeTexture;\r\n}\r\nvar CubeTexture = /** @class */ (function (_super) {\r\n    __extends(CubeTexture, _super);\r\n    function CubeTexture() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return CubeTexture;\r\n}(Hilo3d$2.CubeTexture));\n\n/**\r\n * 判断一个实例是否为`DataTexture`。\r\n */\r\nfunction isDataTexture(value) {\r\n    return value.isDataTexture;\r\n}\r\nvar DataTexture = /** @class */ (function (_super) {\r\n    __extends(DataTexture, _super);\r\n    function DataTexture() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return DataTexture;\r\n}(Hilo3d$2.DataTexture));\n\n/**\r\n * 判断一个实例是否为`DynamicTexture`。\r\n */\r\nfunction isDynamicTexture(value) {\r\n    return value.isDynamicTexture;\r\n}\r\n/**\r\n * 动态纹理类。\r\n *\r\n * @template IDynamicTextureOptions 动态纹理的初始化参数类型。\r\n * @noInheritDoc\r\n */\r\nvar DynamicTexture = /** @class */ (function (_super) {\r\n    __extends(DynamicTexture, _super);\r\n    function DynamicTexture(options) {\r\n        var _this = _super.call(this, options) || this;\r\n        _this.isDynamicTexture = true;\r\n        _this.image = _this._canvas = document.createElement('canvas');\r\n        _this._canvas.width = options.width;\r\n        _this._canvas.height = options.height;\r\n        _this._context = _this._canvas.getContext('2d');\r\n        var needUpdate = _this.onInit(_this._context, options);\r\n        _this.needUpdate = needUpdate === false ? false : true;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(DynamicTexture.prototype, \"context\", {\r\n        get: function () {\r\n            return this._context;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 纹理初始化时调用的函数，你可以在这里通过canvas初始化绘制你的贴图。\r\n     * 通过返回值来决定是否要更新buffer，返回`false`不更新，默认更新。\r\n     */\r\n    DynamicTexture.prototype.onInit = function (context, initOptions) {\r\n        return false;\r\n    };\r\n    /**\r\n     * 纹理在每次被绘制时调用的函数，你可以在这里通过canvas绘制你的纹理。\r\n     * 通过返回值来决定是否要更新buffer，返回`false`不更新，默认更新。\r\n     */\r\n    DynamicTexture.prototype.onDraw = function (context) {\r\n        return false;\r\n    };\r\n    /**\r\n     * 触发绘制回调。\r\n     */\r\n    DynamicTexture.prototype.draw = function () {\r\n        var needUpdate = this.onDraw(this._context);\r\n        this.needUpdate = needUpdate === false ? false : true;\r\n    };\r\n    return DynamicTexture;\r\n}(Texture));\n\n/**\r\n * 判断一个实例是否为`Material`。\r\n */\r\nfunction isMaterial(value) {\r\n    return value.isMaterial;\r\n}\r\n/**\r\n * **材质基类，不要直接使用！想自定义请使用`RawShaderMaterial`**\r\n */\r\nvar Material = /** @class */ (function (_super) {\r\n    __extends(Material, _super);\r\n    function Material() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Material;\r\n}(Hilo3d$2.Material));\r\nHilo3d$2.Material.prototype.getUniform = function getUniform(key) {\r\n    /* tslint:disable-next-line */\r\n    var self = this;\r\n    return {\r\n        get value() {\r\n            return self[key];\r\n        },\r\n        set value(v) {\r\n            self.setUniform(key, v);\r\n        }\r\n    };\r\n};\r\nHilo3d$2.Material.prototype.setUniform = function setUniform(key, value) {\r\n    this[key] = value;\r\n    return this;\r\n};\r\nHilo3d$2.Material.prototype.changeUniform = function changeUniform(key, handler) {\r\n    this[key] = handler(this[key]);\r\n    return this;\r\n};\n\nvar _this = undefined;\r\n/**\r\n * 判断一个实例是否为`BasicMaterial`。\r\n */\r\nfunction isBasicMaterial(value) {\r\n    return value.isBasicMaterial;\r\n}\r\nvar BasicMaterial = /** @class */ (function (_super) {\r\n    __extends(BasicMaterial, _super);\r\n    function BasicMaterial() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return BasicMaterial;\r\n}(Hilo3d$2.BasicMaterial));\r\n/**\r\n * @hidden\r\n */\r\nfunction GlTFBasicMaterial(_a) {\r\n    var uniforms = _a.uniforms, options = _a.options, opts = __rest(_a, [\"uniforms\", \"options\"]);\r\n    var lt = uniforms.lightType.value;\r\n    var lightType = lt === 0 ? 'NONE' : lt === 1 ? 'PHONE' : lt === 2 ? 'BLINN-PHONE' : 'LAMBERT';\r\n    return new BasicMaterial(__assign({ lightType: lightType, diffuse: (uniforms.u_diffuseMap || uniforms.u_diffuse || {}).value, ambient: (uniforms.u_ambientMap || {}).value, specular: (uniforms.u_specularMap || uniforms.u_specular || {}).value, normalMap: (uniforms.u_normalMap || {}).value, normalMapScale: (uniforms.u_normalMapScale || {}).value, emission: (uniforms.u_emissionMap || uniforms.u_emission || {}).value, shininess: (uniforms.u_shininess || {}).value, reflectivity: (uniforms.u_reflectivity || {}).value, refractivity: (uniforms.u_refractivity || {}).value, refractRatio: (uniforms.u_refractRatio || {}).value }, opts));\r\n}\r\n/**\r\n * @hidden\r\n */\r\nBasicMaterial.prototype.initCommonOptions = function (options) {\r\n    if (options.alphaMode) {\r\n        switch (options.alphaMode) {\r\n            case 'BLEND':\r\n                _this.transparent = true;\r\n                _this.blend = true;\r\n                break;\r\n            case 'MASK':\r\n                if ('alphaCutoff' in options) {\r\n                    _this.alphaCutoff = options.alphaCutoff;\r\n                }\r\n                else {\r\n                    _this.alphaCutoff = 0.5;\r\n                }\r\n                break;\r\n            case 'OPAQUE':\r\n            default:\r\n                _this.ignoreTranparent = true;\r\n                break;\r\n        }\r\n    }\r\n    if (options.doubleSided) {\r\n        _this.side = Constants.FRONT_AND_BACK;\r\n    }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nBasicMaterial.CLASS_NAME = new SName('BasicMaterial');\r\n/**\r\n * @hidden\r\n */\r\nMetaSMaterials['BasicMaterial'] = GlTFBasicMaterial;\n\nfunction isGeometryMaterial(value) {\r\n    return value.isGeometryMaterial;\r\n}\r\nvar GeometryMaterial = /** @class */ (function (_super) {\r\n    __extends(GeometryMaterial, _super);\r\n    function GeometryMaterial() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return GeometryMaterial;\r\n}(Hilo3d$2.GeometryMaterial));\n\n/**\r\n * 判断一个实例是否为`ShaderChunk`。\r\n */\r\nfunction isShaderChunk(value) {\r\n    return value.isShaderChuck;\r\n}\r\n/**\r\n * Shader材质块类，可用于shader复用，快速拼接效果。\r\n * 详细使用间[Material](../../guide/material)。\r\n *\r\n * @template IOptions 初始化参数类型。\r\n * @noInheritDoc\r\n */\r\nvar ShaderChunk = /** @class */ (function () {\r\n    /**\r\n     * 构造器。\r\n     *\r\n     * @param isMain 此chuck是否做为材质的最终输出。\r\n     */\r\n    function ShaderChunk(name, options, isMain) {\r\n        if (isMain === void 0) { isMain = false; }\r\n        this.name = name;\r\n        this.isMain = isMain;\r\n        this.isShaderChuck = true;\r\n        /**\r\n         * 顶点着色器函数入口名称，若指定并使用了`MixChunkChuck`，则会在最后的shader中调用。\r\n         */\r\n        this.vsEntryName = '';\r\n        /**\r\n         * 片段着色器主函数入口名称，若指定并使用了`MixChunkChuck`，则会在最后的shader中调用。\r\n         */\r\n        this.fsEntryName = '';\r\n        /**\r\n         * 此chuck主函数是否拥有顶点着色器的输出。\r\n         */\r\n        this.hasVsOut = false;\r\n        /**\r\n         * 此chuck主函数是否拥有片段着色器的输出。\r\n         */\r\n        this.hasFsOut = false;\r\n        this.requiredAttributes = [];\r\n        this.requiredUniforms = [];\r\n        this.attributes = {};\r\n        this.uniforms = {};\r\n        this.defines = '';\r\n        this.vs = { header: '', main: '' };\r\n        this.fs = { header: '', main: '' };\r\n        this.onInit(name, options);\r\n    }\r\n    /**\r\n     * 生命周期，将在chuck初始化的时候被调用。\r\n     */\r\n    ShaderChunk.prototype.onInit = function (name, options) {\r\n    };\r\n    return ShaderChunk;\r\n}());\n\n/**\r\n * @hidden\r\n */\r\nvar defines = [\r\n    Hilo3d$2.Shader.shaders['chunk/baseDefine.glsl'],\r\n    '#define HILO_HAS_NORMAL 1',\r\n    '#define HILO_HAS_TEXCOORD0 1',\r\n    '#define HILO_HAS_TEXCOORD1 1'\r\n].join('\\n');\r\n/**\r\n * @hidden\r\n */\r\nvar attributes = {\r\n    a_position: 'POSITION',\r\n    a_normal: 'NORMAL',\r\n    a_tangent: 'TANGENT',\r\n    a_texcoord0: 'TEXCOORD_0',\r\n    a_texcoord1: 'TEXCOORD_1',\r\n    a_color: 'COLOR_0',\r\n    a_skinIndices: 'SKININDICES',\r\n    a_skinWeights: 'SKINWEIGHTS'\r\n};\r\n['POSITION', 'NORMAL', 'TANGENT'].forEach(function (name) {\r\n    var camelName = name.slice(0, 1) + name.slice(1).toLowerCase();\r\n    for (var i = 0; i < 8; i += 1) {\r\n        attributes['a_morph' + camelName + i] = ('MORPH' + name + i);\r\n    }\r\n});\r\n/**\r\n * @hidden\r\n */\r\nvar uniforms = {\r\n    u_normalMatrix: 'MODELVIEWINVERSETRANSPOSE',\r\n    u_modelViewMatrix: 'MODELVIEW',\r\n    u_modelViewProjectionMatrix: 'MODELVIEWPROJECTION',\r\n    u_logDepth: 'LOGDEPTH',\r\n    // light\r\n    u_ambientLightsColor: 'AMBIENTLIGHTSCOLOR',\r\n    u_directionalLightsColor: 'DIRECTIONALLIGHTSCOLOR',\r\n    u_directionalLightsInfo: 'DIRECTIONALLIGHTSINFO',\r\n    u_directionalLightsShadowMap: 'DIRECTIONALLIGHTSSHADOWMAP',\r\n    u_directionalLightsShadowMapSize: 'DIRECTIONALLIGHTSSHADOWMAPSIZE',\r\n    u_directionalLightsShadowBias: 'DIRECTIONALLIGHTSSHADOWBIAS',\r\n    u_directionalLightSpaceMatrix: 'DIRECTIONALLIGHTSPACEMATRIX',\r\n    u_pointLightsPos: 'POINTLIGHTSPOS',\r\n    u_pointLightsColor: 'POINTLIGHTSCOLOR',\r\n    u_pointLightsInfo: 'POINTLIGHTSINFO',\r\n    u_pointLightsShadowBias: 'POINTLIGHTSSHADOWBIAS',\r\n    u_pointLightsShadowMap: 'POINTLIGHTSSHADOWMAP',\r\n    u_pointLightSpaceMatrix: 'POINTLIGHTSPACEMATRIX',\r\n    u_pointLightCamera: 'POINTLIGHTCAMERA',\r\n    u_spotLightsPos: 'SPOTLIGHTSPOS',\r\n    u_spotLightsDir: 'SPOTLIGHTSDIR',\r\n    u_spotLightsColor: 'SPOTLIGHTSCOLOR',\r\n    u_spotLightsCutoffs: 'SPOTLIGHTSCUTOFFS',\r\n    u_spotLightsInfo: 'SPOTLIGHTSINFO',\r\n    u_spotLightsShadowMap: 'SPOTLIGHTSSHADOWMAP',\r\n    u_spotLightsShadowMapSize: 'SPOTLIGHTSSHADOWMAPSIZE',\r\n    u_spotLightsShadowBias: 'SPOTLIGHTSSHADOWBIAS',\r\n    u_spotLightSpaceMatrix: 'SPOTLIGHTSPACEMATRIX',\r\n    u_areaLightsPos: 'AREALIGHTSPOS',\r\n    u_areaLightsColor: 'AREALIGHTSCOLOR',\r\n    u_areaLightsWidth: 'AREALIGHTSWIDTH',\r\n    u_areaLightsHeight: 'AREALIGHTSHEIGHT',\r\n    u_areaLightsLtcTexture1: 'AREALIGHTSLTCTEXTURE1',\r\n    u_areaLightsLtcTexture2: 'AREALIGHTSLTCTEXTURE2',\r\n    // joint\r\n    u_jointMat: 'JOINTMATRIX',\r\n    u_jointMatTexture: 'JOINTMATRIXTEXTURE',\r\n    u_jointMatTextureSize: 'JOINTMATRIXTEXTURESIZE',\r\n    // quantization\r\n    u_positionDecodeMat: 'POSITIONDECODEMAT',\r\n    u_normalDecodeMat: 'NORMALDECODEMAT',\r\n    u_uvDecodeMat: 'UVDECODEMAT',\r\n    u_uv1DecodeMat: 'UV1DECODEMAT',\r\n    // morph\r\n    u_morphWeights: 'MORPHWEIGHTS',\r\n    u_normalMapScale: 'NORMALMAPSCALE',\r\n    u_emission: 'EMISSION',\r\n    u_transparency: 'TRANSPARENCY',\r\n    // uv matrix\r\n    u_uvMatrix: 'UVMATRIX_0',\r\n    u_uvMatrix1: 'UVMATRIX_1',\r\n    // other info\r\n    u_fogColor: 'FOGCOLOR',\r\n    u_fogInfo: 'FOGINFO',\r\n    u_alphaCutoff: 'ALPHACUTOFF',\r\n    u_exposure: 'EXPOSURE',\r\n    u_gammaFactor: 'GAMMAFACTOR'\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar vs = {\r\n    header: [\r\n        Hilo3d$2.Shader.shaders['chunk/extensions.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/precision.vert'],\r\n        'attribute vec3 a_position;',\r\n        'uniform mat4 u_modelViewProjectionMatrix;',\r\n        Hilo3d$2.Shader.shaders['chunk/unQuantize.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/joint.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/uv.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/normal.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/lightFog.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/morph.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/color.vert'],\r\n        Hilo3d$2.Shader.shaders['chunk/logDepth.vert']\r\n    ].join('\\n'),\r\n    main: ''\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar fs = {\r\n    header: [\r\n        Hilo3d$2.Shader.shaders['chunk/extensions.frag'],\r\n        Hilo3d$2.Shader.shaders['chunk/precision.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/color.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/uv.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/normal.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/lightFog.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/light.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/transparency.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/fog.frag'],\r\n        Hilo3d$2.Shader.shaders['./chunk/logDepth.frag']\r\n    ].join('\\n'),\r\n    main: ''\r\n};\r\n/**\r\n * 基础材质定义，用于指定一些基础的材质变量。\r\n * `ShaderMaterial`就在`RawShaderMaterial`基础上用到了这个chuck。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar BasicDefinitionChunk = /** @class */ (function (_super) {\r\n    __extends(BasicDefinitionChunk, _super);\r\n    function BasicDefinitionChunk() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    BasicDefinitionChunk.prototype.onInit = function () {\r\n        this.attributes = attributes;\r\n        this.uniforms = uniforms;\r\n        this.defines = defines;\r\n        this.vs = vs;\r\n        this.fs = fs;\r\n    };\r\n    return BasicDefinitionChunk;\r\n}(ShaderChunk));\n\n/**\r\n * 判断一个实例是否为`ShaderMaterial`。\r\n */\r\nfunction isShaderMaterial(value) {\r\n    return value.isShaderMaterial;\r\n}\r\n/**\r\n * 自定义材质类，在`RawShaderMaterial`基础上增加了基本的`attributes`和`uniforms`定义。\r\n * 基础的定义请见[BasicDefinitionChunk](../basicdefinitionchunk)\r\n *\r\n * @noInheritDoc\r\n */\r\nvar ShaderMaterial = /** @class */ (function (_super) {\r\n    __extends(ShaderMaterial, _super);\r\n    function ShaderMaterial(options) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isShaderMaterial = true;\r\n        options.chunks = options.chunks || [];\r\n        options.chunks.splice(0, 0, new BasicDefinitionChunk('basicDefinition'));\r\n        _this.init(options);\r\n        return _this;\r\n    }\r\n    ShaderMaterial = __decorate([\r\n        SMaterial({ className: 'ShaderMaterial' })\r\n    ], ShaderMaterial);\r\n    return ShaderMaterial;\r\n}(RawShaderMaterial));\n\n/**\r\n * @hidden\r\n */\r\nvar requiredAttributes = [\r\n    'a_position',\r\n    'a_normal',\r\n    'a_texcoord0'\r\n];\r\n/**\r\n * @hidden\r\n */\r\nvar requiredUniforms = [\r\n    'u_normalMatrix',\r\n    'u_viewVector'\r\n];\r\n/**\r\n * @hidden\r\n */\r\nvar uniforms$1 = {\r\n    u_fresnelC: { value: 1 },\r\n    u_fresnelP: { value: 1 },\r\n    u_fresnelColor: { value: new Color(1, 1, 1, 1) }\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar vs$1 = {\r\n    header: \"\\nuniform vec3 u_viewVector;\\nuniform float u_fresnelC;\\nuniform float u_fresnelP;\\n\\nvarying vec2 v_fresnelUv;\\nvarying float v_fresnelIntensity;\\n\",\r\n    main: \"\\nvoid fresnelEffect() {\\nvec3 v_normal = normalize(u_normalMatrix * a_normal);\\nvec3 v_view = normalize(u_normalMatrix * u_viewVector);\\n\\nv_fresnelIntensity = pow(u_fresnelC - dot(v_normal, v_view), u_fresnelP);\\nv_fresnelUv = a_texcoord0;\\n}  \\n\"\r\n};\r\n/**\r\n * @hidden\r\n */\r\nvar fs$1 = {\r\n    header: \"\\nuniform vec4 u_fresnelColor;\\n\\nvarying float v_fresnelIntensity;\\nvarying vec2 v_fresnelUv;\\n\",\r\n    main: \"\\nvec4 fresnelEffect() {\\nvec4 glow = u_fresnelColor * v_fresnelIntensity;\\n\\nreturn glow;\\n}  \\n\"\r\n};\r\n/**\r\n * 菲涅尔效应chuck。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar FresnelEffectChuck = /** @class */ (function (_super) {\r\n    __extends(FresnelEffectChuck, _super);\r\n    function FresnelEffectChuck() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.vsEntryName = 'fresnelEffect';\r\n        _this.fsEntryName = 'fresnelEffect';\r\n        _this.hasVsOut = false;\r\n        _this.hasFsOut = true;\r\n        return _this;\r\n    }\r\n    FresnelEffectChuck.prototype.onInit = function () {\r\n        this.requiredAttributes = requiredAttributes;\r\n        this.requiredUniforms = requiredUniforms;\r\n        this.uniforms = uniforms$1;\r\n        this.vs = vs$1;\r\n        this.fs = fs$1;\r\n    };\r\n    return FresnelEffectChuck;\r\n}(ShaderChunk));\n\n/**\r\n * 混合多个chuck的chuck，可以作为一个材质最终的输出。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar MixChunksChunk = /** @class */ (function (_super) {\r\n    __extends(MixChunksChunk, _super);\r\n    function MixChunksChunk() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.hasVsOut = true;\r\n        _this.hasFsOut = true;\r\n        return _this;\r\n    }\r\n    MixChunksChunk.prototype.onInit = function (name, options) {\r\n        var chunks = options.chunks, _a = options.vsWeights, vsWeights = _a === void 0 ? {} : _a, _b = options.fsWeights, fsWeights = _b === void 0 ? {} : _b;\r\n        var vsRes = [];\r\n        var fsRes = [];\r\n        if (name) {\r\n            this.vsEntryName = this.fsEntryName = name;\r\n        }\r\n        else {\r\n            this.vsEntryName = this.fsEntryName = 'mixChunks';\r\n        }\r\n        this.vs.main = this.fs.main = \"vec4 \" + this.vsEntryName + \"() {\\n\";\r\n        var length = options.chunks.length;\r\n        for (var index = 0; index < length; index += 1) {\r\n            var chuck = chunks[index];\r\n            if (chuck.vsEntryName) {\r\n                if (chuck.hasVsOut) {\r\n                    var weight = vsWeights[chuck.name] || 0;\r\n                    var weightName = \"u_\" + chuck.vsEntryName + \"VsWeight\";\r\n                    var resName = chuck.vsEntryName + \"Res\";\r\n                    vsRes.push(resName);\r\n                    this.vs.main += \"vec4 \" + resName + \" = \" + chuck.vsEntryName + \"() * \" + weightName + \";\\n\";\r\n                    this.uniforms[weightName] = { value: weight };\r\n                    this.vs.header += \"uniform float \" + weightName + \";\\n\";\r\n                }\r\n                else {\r\n                    this.vs.main += chuck.vsEntryName + \"();\\n\";\r\n                }\r\n            }\r\n            if (chuck.fsEntryName) {\r\n                if (chuck.hasFsOut) {\r\n                    var weight = fsWeights[chuck.name] || 0;\r\n                    var weightName = \"u_\" + chuck.fsEntryName + \"FsWeight\";\r\n                    var resName = chuck.fsEntryName + \"Res\";\r\n                    fsRes.push(resName);\r\n                    this.fs.main += \"vec4 \" + resName + \" = \" + chuck.fsEntryName + \"() * \" + weightName + \";\\n\";\r\n                    this.uniforms[weightName] = { value: weight };\r\n                    this.fs.header += \"uniform float \" + weightName + \";\\n\";\r\n                }\r\n                else {\r\n                    this.fs.main += chuck.fsEntryName + \"();\\n\";\r\n                }\r\n            }\r\n        }\r\n        this.vs.main += 'return ' + vsRes.join(' + ') + ';\\n}';\r\n        this.fs.main += 'return ' + fsRes.join(' + ') + ';\\n}';\r\n    };\r\n    return MixChunksChunk;\r\n}(ShaderChunk));\n\n/**\r\n * @File   : index.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 11/21/2018, 11:33:39 AM\r\n * @Description:\r\n */\r\nvar shaderChunks = {\r\n    BasicDefinitionChunk: BasicDefinitionChunk,\r\n    FresnelEffectChuck: FresnelEffectChuck,\r\n    MixChunksChunk: MixChunksChunk\r\n};\n\n/**\r\n * @File   : Semantic.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 4/2/2019, 8:24:52 PM\r\n * @Description:\r\n */\r\nvar S = Hilo3d$2.semantic;\r\nS.register = function (semantic, object) {\r\n    if (S[semantic]) {\r\n        throw new Error(\"Sematic \" + semantic + \" has already existed !\");\r\n    }\r\n    S[semantic] = object;\r\n};\r\nS.get = function (semantic) {\r\n    return S[semantic];\r\n};\r\nS.unregister = function (semantic) {\r\n    if (S[semantic]) {\r\n        delete S[semantic];\r\n    }\r\n};\r\nvar Semantic = S;\r\nvar SpriteMVP = {\r\n    _mvp: new Matrix4(),\r\n    get: function (mesh, material) {\r\n        var mainCamera = material.game.world.mainCamera;\r\n        var mvp = SpriteMVP._mvp;\r\n        mvp.copy(mesh.worldMatrix);\r\n        if (material.isBillboard) {\r\n            mvp.fromRotationTranslationScale(mainCamera.quaternion, mvp.getTranslation(), mvp.getScaling());\r\n        }\r\n        mvp.premultiply(mainCamera.viewProjectionMatrix);\r\n        return mvp.elements;\r\n    }\r\n};\r\nSemantic.register('SPRITEMODELVIEWPROJECTION', SpriteMVP);\n\n/**\r\n * 骨架类。\r\n */\r\nvar Skeleton = /** @class */ (function (_super) {\r\n    __extends(Skeleton, _super);\r\n    function Skeleton() {\r\n        return _super !== null && _super.apply(this, arguments) || this;\r\n    }\r\n    return Skeleton;\r\n}(Hilo3d$2.Skeleton));\n\n/**\r\n * 判断一个实例是否为`SpriteAnimation`。\r\n */\r\nfunction isSpriteAnimation(value) {\r\n    return value.isSpriteAnimation;\r\n}\r\n/**\r\n * 2D精灵动画类，用于管理2D精灵动画的播放。根据初始化参数的不同，拥有两种模式。\r\n * 一种是基于帧序列的，指定单元尺寸和空隙以及帧数队列来进行播放。\r\n * 另一种是基于图集Atlas的，指定帧名队列来进行播放。\r\n *\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpriteAnimation = /** @class */ (function (_super) {\r\n    __extends(SpriteAnimation, _super);\r\n    function SpriteAnimation() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSpriteAnimation = true;\r\n        _this._paused = true;\r\n        _this._delta = 0;\r\n        _this.handleElementEnd = function () {\r\n            _this.handleEnd(_this, _this.actor);\r\n        };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(SpriteAnimation.prototype, \"duration\", {\r\n        /**\r\n         * 获取当前播放总时长。\r\n         */\r\n        get: function () {\r\n            return this._length * 1000 / (this._fps || this.parent.getGame().fps);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteAnimation.prototype, \"frameCount\", {\r\n        /**\r\n         * 获取当前播放总帧数。\r\n         */\r\n        get: function () {\r\n            return this._length;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteAnimation.prototype, \"currentFrame\", {\r\n        /**\r\n         * 获取当前播放帧。\r\n         */\r\n        get: function () {\r\n            return this._current;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(SpriteAnimation.prototype, \"currentTime\", {\r\n        /**\r\n         * 获取当前播放时间。\r\n         */\r\n        get: function () {\r\n            return this._current * 1000 / (this._fps || this.parent.getGame().fps);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onInit = function (initState) {\r\n        var component = this._component = this.actor.findComponentByName(initState.componentName || 'root');\r\n        if (!component.isSpriteComponent) {\r\n            throw new TypeConflictException(component, 'SpriteComponent', this);\r\n        }\r\n        this._fps = initState.fps;\r\n        var atlas = this._atlas = initState.atlas || component.atlas;\r\n        this._frames = initState.frameNames;\r\n        if (!initState.frameNames) {\r\n            this._frames = Object.keys(atlas.frames);\r\n        }\r\n        this._length = this._frames.length;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onPlay = function (loopCount) {\r\n        this._current = 0;\r\n        this._delta = 0;\r\n        this._paused = false;\r\n        this._component.atlas = this._atlas;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onPause = function () {\r\n        this._paused = true;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onResume = function () {\r\n        this._paused = false;\r\n        this._delta = 0;\r\n        this._component.atlas = this._atlas;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onStop = function () {\r\n        this._current = 0;\r\n        this._paused = true;\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    SpriteAnimation.prototype.onUpdate = function (delta) {\r\n        if (this._paused) {\r\n            return;\r\n        }\r\n        var fps = this._fps || this.parent.getGame().fps;\r\n        if (this._delta < 1000 / fps) {\r\n            this._delta += delta;\r\n            return;\r\n        }\r\n        else {\r\n            this._delta = 0;\r\n        }\r\n        this._component.setFrame(this._frames[this._current]);\r\n        this._current += 1;\r\n        if (this._current === this._length) {\r\n            this.stop();\r\n            this.handleElementEnd();\r\n        }\r\n    };\r\n    SpriteAnimation = __decorate([\r\n        SClass({ className: 'SpriteAnimation' })\r\n    ], SpriteAnimation);\r\n    return SpriteAnimation;\r\n}(Animation));\n\n/**\r\n * 判断一个实例是否为`TweenAnimation`。\r\n */\r\nfunction isTweenAnimation(value) {\r\n    return value.isTweenAnimation;\r\n}\r\n/**\r\n * 模型动画类，用于存储模型动画。\r\n * 一般在模型实例化时已经自动生成，不需要自己初始化。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar TweenAnimation = /** @class */ (function (_super) {\r\n    __extends(TweenAnimation, _super);\r\n    function TweenAnimation() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isTweenAnimation = true;\r\n        _this.handleElementPause = function () {\r\n            _this.pause();\r\n        };\r\n        _this.handleElementResume = function () {\r\n            _this.resume();\r\n        };\r\n        _this.handleComplete = function () {\r\n            _this.handleEnd(_this, _this.actor);\r\n        };\r\n        return _this;\r\n    }\r\n    Object.defineProperty(TweenAnimation.prototype, \"currentTime\", {\r\n        /**\r\n         * 获取当前播放时间。\r\n         */\r\n        get: function () {\r\n            return this._tween.time;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TweenAnimation.prototype, \"duration\", {\r\n        /**\r\n         * 获取当前播放总时长。\r\n         */\r\n        get: function () {\r\n            return this._tween.duration;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(TweenAnimation.prototype, \"paused\", {\r\n        /**\r\n         * 获取当前是否处于暂停状态。\r\n         */\r\n        get: function () {\r\n            return this._tween.paused;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onInit = function (_a) {\r\n        var create = _a.create;\r\n        this._tween = create(this.handleComplete);\r\n        this._tween.stop();\r\n        this.getGame().event.add('GameWillPause', this.handleElementPause);\r\n        this.getGame().event.add('GameDidResume', this.handleElementResume);\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onPlay = function (loopCount) {\r\n        this._tween.start();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onPause = function () {\r\n        this._tween.pause();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onResume = function () {\r\n        this._tween.resume();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onStop = function () {\r\n        this._tween.stop();\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    TweenAnimation.prototype.onDestroy = function () {\r\n        this.stop();\r\n        this.getGame().event.remove('GameWillPause', this.handleElementPause);\r\n        this.getGame().event.remove('GameDidResume', this.handleElementResume);\r\n    };\r\n    TweenAnimation = __decorate([\r\n        SClass({ className: 'TweenAnimation' })\r\n    ], TweenAnimation);\r\n    return TweenAnimation;\r\n}(Animation));\n\n/**\r\n * 判断一个实例是否为`CombineAnimation`。\r\n */\r\nfunction isCombineAnimation(value) {\r\n    return value.isCombineAnimation;\r\n}\r\n/**\r\n * 组合动画类，可以并行播放多个动画，结束以最后一个结束的为准。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CombineAnimation = /** @class */ (function (_super) {\r\n    __extends(CombineAnimation, _super);\r\n    function CombineAnimation() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isCombineAnimation = true;\r\n        _this._count = 0;\r\n        _this._length = 0;\r\n        _this.handleElementEnd = function () {\r\n            _this._count += 1;\r\n            if (_this._count === _this._length) {\r\n                _this.handleEnd(_this, _this.actor);\r\n            }\r\n        };\r\n        return _this;\r\n    }\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onInit = function (options) {\r\n        this._animations = options.animations;\r\n        this._length = this._animations.length;\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            var animation = this._animations[index];\r\n            animation.handleEnd = this.handleElementEnd;\r\n            animation.animator = this.animator;\r\n            animation.initialize();\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onPlay = function (loopCount) {\r\n        this._count = 0;\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].play(loopCount);\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onPause = function () {\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].pause();\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onResume = function () {\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].resume();\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onStop = function () {\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].stop();\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onUpdate = function (delta) {\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].onUpdate(delta);\r\n        }\r\n    };\r\n    /**\r\n     * @hidden\r\n     */\r\n    CombineAnimation.prototype.onDestroy = function () {\r\n        for (var index = 0; index < this._length; index += 1) {\r\n            this._animations[index].destroy();\r\n        }\r\n    };\r\n    CombineAnimation = __decorate([\r\n        SClass({ className: 'CombineAnimation' })\r\n    ], CombineAnimation);\r\n    return CombineAnimation;\r\n}(Animation));\n\n/**\r\n * @hidden\r\n */\r\nfunction bfs(parent, func) {\r\n    var children = parent.findComponentsByClass(ChildActorComponent);\r\n    var length = children.length;\r\n    var tmp = [];\r\n    for (var i = 0; i < length; i += 1) {\r\n        var actor = children[i].actor;\r\n        if (func(actor)) {\r\n            return;\r\n        }\r\n        Array.prototype.push.apply(tmp, actor.findComponentsByClass(ChildActorComponent));\r\n        if (i === length - 1) {\r\n            children = tmp;\r\n            length = children.length;\r\n            i = 0;\r\n            tmp = [];\r\n        }\r\n    }\r\n}\r\n/**\r\n * 迭代`parent`下的所有`actors`。\r\n *\r\n * @param func 迭代回调函数，若返回`true`，则立即停止迭代，用于性能优化。\r\n */\r\nfunction iterateActors(parent, func) {\r\n    if (isActor(parent)) {\r\n        bfs(parent, func);\r\n        return;\r\n    }\r\n    parent.actors.forEach(func);\r\n}\r\n/**\r\n * 迭代`parent`下的所有名字为`name`的`actors`。\r\n *\r\n * @param func 迭代回调函数，若返回`true`，则立即停止迭代，用于性能优化。\r\n */\r\nfunction iterateActorsByName(parent, name, func) {\r\n    iterateActors(parent, function (actor) {\r\n        if (!actor.name.equalsTo(name)) {\r\n            return false;\r\n        }\r\n        return func(actor);\r\n    });\r\n}\r\n/**\r\n * 迭代`parent`下的所有标签为`tag`的`actors`。\r\n *\r\n * @param func 迭代回调函数，若返回`true`，则立即停止迭代，用于性能优化。\r\n */\r\nfunction iterateActorsByTag(parent, tag, func) {\r\n    iterateActors(parent, function (actor) {\r\n        if (!actor.tag.equalsTo(tag)) {\r\n            return false;\r\n        }\r\n        return func(actor);\r\n    });\r\n}\r\n/**\r\n * **暂时没用。**\r\n * 迭代`parent`下的所有类的类型为`classType`的`actors`。\r\n *\r\n * @param func 迭代回调函数，若返回`true`，则立即停止迭代，用于性能优化。\r\n */\r\nfunction iterateActorsByClassType(parent, classType, func) {\r\n    iterateActors(parent, function (actor) {\r\n        if (!actor.classType.equalsTo(classType)) {\r\n            return false;\r\n        }\r\n        return func(actor);\r\n    });\r\n}\r\n/**\r\n * 迭代`parent`下的所有类型为`Class`的`actors`。\r\n *\r\n * @param func 迭代回调函数，若返回`true`，则立即停止迭代，用于性能优化。\r\n */\r\nfunction iterateActorsByClass(parent, Class, func) {\r\n    iterateActors(parent, function (actor) {\r\n        if (!actor.className.equalsTo(Class.CLASS_NAME)) {\r\n            return false;\r\n        }\r\n        return func(actor);\r\n    });\r\n}\n\n/**\r\n * 基于cannon.js的物理世界类，完成了CANNON到Sein.js的物理引擎的桥接。\r\n * **一般情况下你并不需要直接操作这个实例，而是使用刚体和碰撞体组件！**\r\n * CANNON的工程（魔改过的）请见这里：[https://github.com/dtysky/cannon.js](https://github.com/dtysky/cannon.js)，可以使用`npm i cannon-dtysky`获取。\r\n * 详细使用请见[Physic](../../guide/physic)。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CannonPhysicWorld = /** @class */ (function (_super) {\r\n    __extends(CannonPhysicWorld, _super);\r\n    /**\r\n     * 构造器。\r\n     *\r\n     * @param Cannon CANNON模块引用`Cannon`。\r\n     * @param gravity 世界重力。\r\n     * @param iterations 迭代次数。\r\n     */\r\n    function CannonPhysicWorld(Cannon, gravity, iterations) {\r\n        if (gravity === void 0) { gravity = new Vector3(0, -9.81, 0); }\r\n        if (iterations === void 0) { iterations = 10; }\r\n        var _this = _super.call(this, 'SeinCannonPhysicWorld') || this;\r\n        _this.isPhysicWorld = true;\r\n        _this.isCannonPhysicWorld = true;\r\n        _this._fixedTimeStep = 1 / 60;\r\n        _this._physicsMaterials = [];\r\n        if (!Cannon) {\r\n            throw new UnmetRequireException(_this, 'The newest version Cannonjs is required ! Goto \"https://github.com/dtysky/cannon.js/tree/master/build\" get it !');\r\n        }\r\n        _this.CANNON = Cannon;\r\n        _this._world = new _this.CANNON.World();\r\n        _this._world.broadphase = new _this.CANNON.NaiveBroadphase();\r\n        _this._world.solver.iterations = iterations;\r\n        _this._world.gravity.set(gravity.x, gravity.y, gravity.z);\r\n        _this._ray = new _this.CANNON.Ray();\r\n        _this._rayResult = new _this.CANNON.RaycastResult();\r\n        return _this;\r\n    }\r\n    Object.defineProperty(CannonPhysicWorld.prototype, \"timeStep\", {\r\n        /**\r\n         * 获取固定步长（秒）。\r\n         */\r\n        get: function () {\r\n            return this._fixedTimeStep;\r\n        },\r\n        /**\r\n         * 设置固定步长（秒）。\r\n         */\r\n        set: function (value) {\r\n            this._fixedTimeStep = value;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(CannonPhysicWorld.prototype, \"gravity\", {\r\n        /**\r\n         * 获取重力。\r\n         */\r\n        get: function () {\r\n            var _a = this._world.gravity, x = _a.x, y = _a.y, z = _a.z;\r\n            return new Vector3(x, y, z);\r\n        },\r\n        /**\r\n         * 设置重力。\r\n         */\r\n        set: function (gravity) {\r\n            this._world.gravity.set(gravity.x, gravity.y, gravity.z);\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 启用高级碰撞事件，这可以让你拥有对碰撞更细致的控制，但会有一些性能损耗。\r\n     */\r\n    CannonPhysicWorld.prototype.initContactEvents = function () {\r\n        this._world.addEventListener('beginContact', function (args) {\r\n            if (!args.bodyA || !args.bodyB) {\r\n                return;\r\n            }\r\n            if (args.bodyA.component.valid) {\r\n                args.bodyA.component.handleBodyEnter(args.bodyA.component, args.bodyB.component);\r\n            }\r\n            if (args.bodyB.component.valid) {\r\n                args.bodyB.component.handleBodyEnter(args.bodyB.component, args.bodyA.component);\r\n            }\r\n        });\r\n        this._world.addEventListener('endContact', function (args) {\r\n            if (!args.bodyA || !args.bodyB) {\r\n                return;\r\n            }\r\n            if (args.bodyA.component.valid) {\r\n                args.bodyA.component.handleBodyLeave(args.bodyA.component, args.bodyB.component);\r\n            }\r\n            if (args.bodyB.component.valid) {\r\n                args.bodyB.component.handleBodyLeave(args.bodyB.component, args.bodyA.component);\r\n            }\r\n        });\r\n        this._world.addEventListener('beginShapeContact', function (args) {\r\n            if (!args.bodyA || !args.bodyB) {\r\n                return;\r\n            }\r\n            if (args.bodyA.component.valid) {\r\n                args.bodyA.component.handleColliderEnter(args.bodyA.component, args.bodyB.component, args.shapeA.component, args.shapeB.component);\r\n            }\r\n            if (args.bodyB.component.valid) {\r\n                args.bodyB.component.handleColliderEnter(args.bodyB.component, args.bodyA.component, args.shapeB.component, args.shapeA.component);\r\n            }\r\n        });\r\n        this._world.addEventListener('endShapeContact', function (args) {\r\n            if (!args.bodyA || !args.bodyB) {\r\n                return;\r\n            }\r\n            if (args.bodyA.component.valid) {\r\n                args.bodyA.component.handleColliderLeave(args.bodyA.component, args.bodyB.component, args.shapeA.component, args.shapeB.component);\r\n            }\r\n            if (args.bodyB.component.valid) {\r\n                args.bodyB.component.handleColliderLeave(args.bodyB.component, args.bodyA.component, args.shapeB.component, args.shapeA.component);\r\n            }\r\n        });\r\n    };\r\n    /**\r\n     * 设置重力。\r\n     */\r\n    CannonPhysicWorld.prototype.setGravity = function (gravity) {\r\n        this._world.gravity.x = gravity.x;\r\n        this._world.gravity.y = gravity.y;\r\n        this._world.gravity.z = gravity.z;\r\n        return this;\r\n    };\r\n    /**\r\n     * **不要自己调用！！**\r\n     *\r\n     * @hidden\r\n     */\r\n    CannonPhysicWorld.prototype.update = function (delta, components) {\r\n        if (delta === void 0) { delta = 0; }\r\n        this._world.step(this._fixedTimeStep, delta, 3);\r\n    };\r\n    /**\r\n     * 添加脉冲力。\r\n     */\r\n    CannonPhysicWorld.prototype.applyImpulse = function (component, force, contactPoint) {\r\n        var worldPoint = new this.CANNON.Vec3(contactPoint.x, contactPoint.y, contactPoint.z);\r\n        var impulse = new this.CANNON.Vec3(force.x, force.y, force.z);\r\n        component.rigidBody.applyImpulse(impulse, worldPoint);\r\n    };\r\n    /**\r\n     * 添加力。\r\n     */\r\n    CannonPhysicWorld.prototype.applyForce = function (component, force, contactPoint) {\r\n        var worldPoint = new this.CANNON.Vec3(contactPoint.x, contactPoint.y, contactPoint.z);\r\n        var impulse = new this.CANNON.Vec3(force.x, force.y, force.z);\r\n        component.rigidBody.applyForce(impulse, worldPoint);\r\n    };\r\n    /**\r\n     * 拾取操作。\r\n     */\r\n    CannonPhysicWorld.prototype.pick = function (from, to, onPick, origOptions) {\r\n        var _this = this;\r\n        if (origOptions === void 0) { origOptions = {}; }\r\n        var options = __assign({}, origOptions);\r\n        this._ray.from.copy(from);\r\n        this._ray.to.copy(to);\r\n        this._ray.checkCollisionResponse = options.checkCollisionResponse === true ? true : false;\r\n        switch (options.mode) {\r\n            case EPickMode.All:\r\n                options.mode = this.CANNON.Ray.ALL;\r\n                break;\r\n            case EPickMode.Any:\r\n                options.mode = this.CANNON.Ray.ANY;\r\n                break;\r\n            case EPickMode.Closest:\r\n                options.mode = this.CANNON.Ray.CLOSEST;\r\n            default:\r\n                options.mode = this.CANNON.Ray.CLOSEST;\r\n                break;\r\n        }\r\n        options.skipBackfaces = options.skipBackfaces === false ? false : true;\r\n        options.result = this._rayResult;\r\n        var result = [];\r\n        options.callback = function () {\r\n            var _a = _this._rayResult, body = _a.body, shape = _a.shape, distance = _a.distance, hitPointWorld = _a.hitPointWorld;\r\n            if (!body.component.valid) {\r\n                return;\r\n            }\r\n            result.push({ rigidBody: body.component, collider: shape.component, actor: body.component.getOwner(), distance: distance, point: new Vector3(hitPointWorld.x, hitPointWorld.y, hitPointWorld.z) });\r\n        };\r\n        if (options.bodies) {\r\n            options.bodies = options.bodies.map(function (body) { return body.rigidBody; });\r\n        }\r\n        var hit = this._ray.intersectWorld(this._world, options);\r\n        if (hit) {\r\n            if (options.mode === EPickMode.CLOSEST) {\r\n                var _a = this._rayResult, body = _a.body, shape = _a.shape, distance = _a.distance, hitPointWorld = _a.hitPointWorld;\r\n                result.push({ rigidBody: body.component, collider: shape.component, actor: body.component.getOwner(), distance: distance, point: new Vector3(hitPointWorld.x, hitPointWorld.y, hitPointWorld.z) });\r\n            }\r\n        }\r\n        onPick(result);\r\n        return hit;\r\n    };\r\n    /**\r\n     * 创建一个刚体。\r\n     */\r\n    CannonPhysicWorld.prototype.createRigidBody = function (component, options) {\r\n        var material = this.addMaterial(\"mat-\" + component.uuid, options.friction, options.restitution);\r\n        var bodyCreationObject = {\r\n            mass: options.mass,\r\n            material: material\r\n        };\r\n        for (var key in options.nativeOptions) {\r\n            bodyCreationObject[key] = options.nativeOptions[key];\r\n        }\r\n        var rigidBody = new this.CANNON.Body(bodyCreationObject);\r\n        rigidBody.component = component;\r\n        var _a = component.getCurrentTransform(), position = _a[0], rotation = _a[1], scale = _a[2];\r\n        this.setBodyTransform(rigidBody, position, rotation, scale);\r\n        rigidBody.updateMassProperties();\r\n        rigidBody.updateBoundingRadius();\r\n        if (Debug.devMode) {\r\n            this.checkNest(component);\r\n        }\r\n        this._world.addBody(rigidBody);\r\n        return rigidBody;\r\n    };\r\n    /**\r\n     * 暂时使得刚体失去效应，可以用`enableRigidBody`恢复。\r\n     */\r\n    CannonPhysicWorld.prototype.disableRigidBody = function (component) {\r\n        this._world.remove(component.rigidBody);\r\n    };\r\n    /**\r\n     * 使得一个暂时失去效应的刚体恢复。\r\n     */\r\n    CannonPhysicWorld.prototype.enableRigidBody = function (component) {\r\n        this._world.add(component.rigidBody);\r\n    };\r\n    /**\r\n     * 在开发环境下，检测是否有物理嵌套。\r\n     */\r\n    CannonPhysicWorld.prototype.checkNest = function (component) {\r\n        var actor = component.getOwner();\r\n        var parent = actor.parent;\r\n        while (parent) {\r\n            if (parent.rigidBody) {\r\n                Debug.warn('You should never have a parent and child \"none isTrigger and 0 mass\" rigidBody together', actor, parent);\r\n                break;\r\n            }\r\n            parent = parent.parent;\r\n        }\r\n        bfs(actor, function (child) {\r\n            if (child.rigidBody) {\r\n                Debug.warn('You should never have a parent and child \"none isTrigger and 0 mass\" rigidBody together', actor, child);\r\n                return false;\r\n            }\r\n            return true;\r\n        });\r\n    };\r\n    /**\r\n     * 初始化基本事件。\r\n     */\r\n    CannonPhysicWorld.prototype.initEvents = function (component) {\r\n        this._world.addEventListener('preStep', component.handleBeforeStep);\r\n        this._world.addEventListener('postStep', component.handleAfterStep);\r\n        component.rigidBody.addEventListener('collide', component.handleCollision);\r\n    };\r\n    /**\r\n     * 移除一个刚体。\r\n     */\r\n    CannonPhysicWorld.prototype.removeRigidBody = function (component) {\r\n        this._world.removeEventListener('preStep', component.handleBeforeStep);\r\n        this._world.removeEventListener('postStep', component.handleAfterStep);\r\n        component.rigidBody.removeEventListener('collision', component.handleCollision);\r\n        this._world.remove(component.rigidBody);\r\n    };\r\n    /**\r\n     * 清空物理世界。\r\n     */\r\n    CannonPhysicWorld.prototype.clear = function () {\r\n        this._world._listeners.preStep = [];\r\n        this._world._listeners.postStep = [];\r\n        this._world.bodies = [];\r\n    };\r\n    CannonPhysicWorld.prototype.createJoint = function (rigidBody, component, params) {\r\n        var type = params.type, options = params.options;\r\n        var actor = options.actor, data = __rest(options, [\"actor\"]);\r\n        var mainBody = rigidBody.rigidBody;\r\n        var connectedBody = actor.rigidBody.rigidBody;\r\n        var constraint;\r\n        switch (type) {\r\n            case EJointType.Hinge:\r\n                constraint = new this.CANNON.HingeConstraint(mainBody, connectedBody, data);\r\n                break;\r\n            case EJointType.Distance:\r\n                constraint = new this.CANNON.DistanceConstraint(mainBody, connectedBody, data.distance, data.maxForce);\r\n                break;\r\n            case EJointType.Spring:\r\n                constraint = new this.CANNON.Spring(mainBody, connectedBody, data);\r\n                break;\r\n            case EJointType.Lock:\r\n                constraint = new this.CANNON.LockConstraint(mainBody, connectedBody, data);\r\n                break;\r\n            case EJointType.PointToPoint:\r\n            default:\r\n                constraint = new this.CANNON.PointToPointConstraint(mainBody, data.pivotA, connectedBody, data.pivotB, data.maxForce);\r\n                break;\r\n        }\r\n        constraint.collideConnected = !!data.collideConnected;\r\n        constraint.wakeUpBodies = !!data.wakeUpBodies;\r\n        constraint.component = constraint;\r\n        //don't add spring as constraint, as it is not one.\r\n        if (type !== EJointType.Spring) {\r\n            this._world.addConstraint(constraint);\r\n        }\r\n        else {\r\n            rigidBody.event.add('AfterStep', component.applyForce);\r\n        }\r\n        return constraint;\r\n    };\r\n    CannonPhysicWorld.prototype.removeJoint = function (rigidBody, component) {\r\n        if (component.type !== EJointType.Spring) {\r\n            this._world.removeConstraint(component.joint);\r\n        }\r\n        else {\r\n            rigidBody.event.remove('AfterStep', component.applyForce);\r\n        }\r\n    };\r\n    CannonPhysicWorld.prototype.enableJoint = function (component) {\r\n        component.joint.enable();\r\n    };\r\n    CannonPhysicWorld.prototype.disableJoint = function (component) {\r\n        component.joint.disable();\r\n    };\r\n    CannonPhysicWorld.prototype.addMaterial = function (name, friction, restitution) {\r\n        var index;\r\n        var mat;\r\n        for (index = 0; index < this._physicsMaterials.length; index += 1) {\r\n            mat = this._physicsMaterials[index];\r\n            if (mat.friction === friction && mat.restitution === restitution) {\r\n                return mat;\r\n            }\r\n        }\r\n        var currentMat = new this.CANNON.Material(name);\r\n        currentMat.friction = friction;\r\n        currentMat.restitution = restitution;\r\n        this._physicsMaterials.push(currentMat);\r\n        return currentMat;\r\n    };\r\n    /**\r\n     * 创建碰撞体。\r\n     */\r\n    CannonPhysicWorld.prototype.createCollider = function (bodyComp, colliderComp, params) {\r\n        var _a, _b;\r\n        var shape;\r\n        switch (params.type) {\r\n            case EColliderType.Sphere:\r\n                shape = new this.CANNON.Sphere(params.options.radius);\r\n                break;\r\n            case EColliderType.Cylinder:\r\n                shape = new this.CANNON.Cylinder(params.options.radiusTop, params.options.radiusBottom, params.options.height, params.options.numSegments);\r\n                break;\r\n            case EColliderType.Box:\r\n                shape = new this.CANNON.Box(new this.CANNON.Vec3(params.options.size[0] / 2, params.options.size[1] / 2, params.options.size[2] / 2));\r\n                break;\r\n            case EColliderType.Plane:\r\n                Debug.warn('Attention, PlaneCollider might not behave as you expect. Consider using BoxCollider instead');\r\n                shape = new this.CANNON.Plane();\r\n                break;\r\n        }\r\n        var _c = params.options, offset = _c.offset, quaternion = _c.quaternion, isTrigger = _c.isTrigger;\r\n        var rigidBody = bodyComp.rigidBody;\r\n        offset = offset || [0, 0, 0];\r\n        quaternion = quaternion || [0, 0, 0, 1];\r\n        isTrigger = isTrigger || false;\r\n        rigidBody.addShape(shape, new ((_a = this.CANNON.Vec3).bind.apply(_a, __spreadArrays([void 0], offset)))(), new ((_b = this.CANNON.Quaternion).bind.apply(_b, __spreadArrays([void 0], quaternion)))());\r\n        shape.collisionResponse = !isTrigger;\r\n        shape.component = colliderComp;\r\n        return shape;\r\n    };\r\n    /**\r\n     * 移除碰撞体。\r\n     */\r\n    CannonPhysicWorld.prototype.removeCollider = function (rigidBodyComp, colliderComp) {\r\n        var rigidBody = rigidBodyComp.rigidBody;\r\n        var collider = colliderComp.collider;\r\n        var index = rigidBody.shapes.indexOf(collider);\r\n        rigidBody.shapes.splice(index, 1);\r\n        rigidBody.shapeOffsets.splice(index, 1);\r\n        rigidBody.shapeOrientations.splice(index, 1);\r\n    };\r\n    // private _createHeightmap(object: IPhysicsEnabledObject, pointDepth?: number) {\r\n    //   const pos = <FloatArray>(object.getVerticesData(VertexBuffer.PositionKind));\r\n    //   let transform = object.computeWorldMatrix(true);\r\n    //   // convert rawVerts to object space\r\n    //   const temp = new Array<number>();\r\n    //   const index: number;\r\n    //   for (index = 0; index < pos.length; index += 3) {\r\n    //     Vector3.TransformCoordinates(Vector3.FromArray(pos, index), transform).toArray(temp, index);\r\n    //   }\r\n    //   pos = temp;\r\n    //   const matrix = new Array<Array<any>>();\r\n    //   //For now pointDepth will not be used and will be automatically calculated.\r\n    //   //Future reference - try and find the best place to add a reference to the pointDepth constiable.\r\n    //   const arraySize = pointDepth || ~~(Math.sqrt(pos.length / 3) - 1);\r\n    //   let boundingInfo = object.getBoundingInfo();\r\n    //   const dim = Math.min(boundingInfo.boundingBox.extendSizeWorld.x, boundingInfo.boundingBox.extendSizeWorld.y);\r\n    //   const minY = boundingInfo.boundingBox.extendSizeWorld.z;\r\n    //   const elementSize = dim * 2 / arraySize;\r\n    //   for (const i = 0; i < pos.length; i = i + 3) {\r\n    //     const x = Math.round((pos[i + 0]) / elementSize + arraySize / 2);\r\n    //     const z = Math.round(((pos[i + 1]) / elementSize - arraySize / 2) * -1);\r\n    //     const y = -pos[i + 2] + minY;\r\n    //     if (!matrix[x]) {\r\n    //       matrix[x] = [];\r\n    //     }\r\n    //     if (!matrix[x][z]) {\r\n    //       matrix[x][z] = y;\r\n    //     }\r\n    //     matrix[x][z] = Math.max(y, matrix[x][z]);\r\n    //   }\r\n    //   for (const x = 0; x <= arraySize; ++x) {\r\n    //     if (!matrix[x]) {\r\n    //       const loc = 1;\r\n    //       while (!matrix[(x + loc) % arraySize]) {\r\n    //         loc++;\r\n    //       }\r\n    //       matrix[x] = matrix[(x + loc) % arraySize].slice();\r\n    //       //console.log(\"missing x\", x);\r\n    //     }\r\n    //     for (const z = 0; z <= arraySize; ++z) {\r\n    //       if (!matrix[x][z]) {\r\n    //         const loc = 1;\r\n    //         const newValue;\r\n    //         while (newValue === undefined) {\r\n    //           newValue = matrix[x][(z + loc++) % arraySize];\r\n    //         }\r\n    //         matrix[x][z] = newValue;\r\n    //       }\r\n    //     }\r\n    //   }\r\n    //   const shape = new this.CANNON.Heightfield(matrix, {\r\n    //     elementSize: elementSize\r\n    //   });\r\n    //   //For future reference, needed for body transformation\r\n    //   shape.minY = minY;\r\n    //   return shape;\r\n    // }\r\n    /**\r\n     * 设置某个刚体的父级Actor的`transform`。\r\n     */\r\n    CannonPhysicWorld.prototype.setRootTransform = function (component) {\r\n        var transform = component.getOwner().transform;\r\n        var _a = component.rigidBody, position = _a.position, quaternion = _a.quaternion;\r\n        transform.setPosition(position.x, position.y, position.z);\r\n        transform.setQuaternion(quaternion.x, quaternion.y, quaternion.z, quaternion.w);\r\n    };\r\n    /**\r\n     * 设置某个刚体的`transform`。\r\n     */\r\n    CannonPhysicWorld.prototype.setRigidBodyTransform = function (component, newPosition, newRotation, \r\n    // only for sphere, box, cylinder\r\n    newScale) {\r\n        this.setBodyTransform(component.rigidBody, newPosition, newRotation, newScale);\r\n    };\r\n    CannonPhysicWorld.prototype.setBodyTransform = function (body, newPosition, newRotation, newScale) {\r\n        var _this = this;\r\n        if (newPosition) {\r\n            body.position.copy(newPosition);\r\n        }\r\n        if (newRotation) {\r\n            body.quaternion.copy(newRotation);\r\n        }\r\n        if (newScale && body.shapes) {\r\n            body.shapes.forEach(function (collider, index) {\r\n                _this.setColliderScale(collider.component, body.component, newScale, index);\r\n            });\r\n        }\r\n    };\r\n    CannonPhysicWorld.prototype.setColliderTransform = function (component, \r\n    // note: position and rotation not working in current time\r\n    newPosition, newRotation, \r\n    // only for sphere, box, capsule\r\n    newScale) {\r\n        if (!component) {\r\n            return;\r\n        }\r\n        var collider = component.collider;\r\n        var rigidBody = component.getOwner().rigidBody;\r\n        var index = rigidBody.rigidBody.shapes.indexOf(collider);\r\n        if (newScale) {\r\n            this.setColliderScale(component, rigidBody, newScale, index);\r\n        }\r\n        // if want to change qrientation, change the shapeOrientations and rigidBody.updateBoundingRadius\r\n        rigidBody.needUpdateCollider = true;\r\n    };\r\n    CannonPhysicWorld.prototype.setColliderScale = function (component, rigidBodyComp, newScale, index) {\r\n        var collider = component.collider;\r\n        var options = component.initState;\r\n        // todo: better scale for multiple collider\r\n        switch (component.type) {\r\n            case EColliderType.Box:\r\n                collider.halfExtents.set(options.size[0] / 2 * newScale.x, options.size[1] / 2 * newScale.y, options.size[2] / 2 * newScale.z);\r\n                break;\r\n            case EColliderType.Sphere:\r\n                collider.radius = options.radius * newScale.x;\r\n                break;\r\n        }\r\n        if (component.type !== EColliderType.Sphere) {\r\n            collider.updateConvexPolyhedronRepresentation();\r\n        }\r\n        var offset = options.offset;\r\n        if (offset[0] !== 0 || offset[1] !== 0 || offset[2] !== 0) {\r\n            var off = rigidBodyComp.rigidBody.shapeOffsets[index];\r\n            off.x = offset[0] * newScale.x;\r\n            off.y = offset[1] * newScale.y;\r\n            off.z = -offset[2] * newScale.z;\r\n        }\r\n    };\r\n    /**\r\n     * 强制更新包围盒。\r\n     */\r\n    CannonPhysicWorld.prototype.updateBounding = function (component) {\r\n        component.rigidBody.updateMassProperties();\r\n        component.rigidBody.updateBoundingRadius();\r\n    };\r\n    /**\r\n     * 设置线速度。\r\n     */\r\n    CannonPhysicWorld.prototype.setLinearVelocity = function (component, velocity) {\r\n        component.rigidBody.velocity.copy(velocity);\r\n    };\r\n    /**\r\n     * 设置角速度。\r\n     */\r\n    CannonPhysicWorld.prototype.setAngularVelocity = function (component, velocity) {\r\n        component.rigidBody.angularVelocity.copy(velocity);\r\n    };\r\n    /**\r\n     * 获取线速度。\r\n     */\r\n    CannonPhysicWorld.prototype.getLinearVelocity = function (component) {\r\n        var v = component.rigidBody.velocity;\r\n        if (!v) {\r\n            return null;\r\n        }\r\n        return new Vector3(v.x, v.y, v.z);\r\n    };\r\n    /**\r\n     * 获取角速度。\r\n     */\r\n    CannonPhysicWorld.prototype.getAngularVelocity = function (component) {\r\n        var v = component.rigidBody.angularVelocity;\r\n        if (!v) {\r\n            return null;\r\n        }\r\n        return new Vector3(v.x, v.y, v.z);\r\n    };\r\n    /**\r\n     * 设置重力。\r\n     */\r\n    CannonPhysicWorld.prototype.setBodyMass = function (component, mass) {\r\n        component.rigidBody.mass = mass;\r\n        if (!component.physicStatic && mass > 0) {\r\n            this.setBodyType(component, ERigidBodyType.Dynamic);\r\n        }\r\n        component.rigidBody.updateMassProperties();\r\n    };\r\n    /**\r\n     * 获取重力。\r\n     */\r\n    CannonPhysicWorld.prototype.getBodyMass = function (component) {\r\n        return component.rigidBody.mass;\r\n    };\r\n    /**\r\n     * 设置filterGroup，一个32bits的整数，用于给刚体分组。\r\n     */\r\n    CannonPhysicWorld.prototype.setFilterGroup = function (component, group) {\r\n        component.rigidBody.collisionFilterGroup = group;\r\n    };\r\n    /**\r\n     * 获取filterGroup。\r\n     */\r\n    CannonPhysicWorld.prototype.getFilterGroup = function (component) {\r\n        return component.rigidBody.collisionFilterGroup;\r\n    };\r\n    /**\r\n     * 设置filterMask，一个32bits的整数，用于给分组后的刚体设置碰撞对象范围。\r\n     */\r\n    CannonPhysicWorld.prototype.setFilterMask = function (component, mask) {\r\n        component.rigidBody.collisionFilterMask = mask;\r\n    };\r\n    /**\r\n     * 获取filterMask。\r\n     */\r\n    CannonPhysicWorld.prototype.getFilterMask = function (component) {\r\n        return component.rigidBody.collisionFilterMask;\r\n    };\r\n    /**\r\n     * 设置刚体摩擦力。\r\n     */\r\n    CannonPhysicWorld.prototype.getBodyFriction = function (component) {\r\n        return component.rigidBody.material.friction;\r\n    };\r\n    /**\r\n     * 获取刚体摩擦力。\r\n     */\r\n    CannonPhysicWorld.prototype.setBodyFriction = function (component, friction) {\r\n        component.rigidBody.material.friction = friction;\r\n    };\r\n    /**\r\n     * 获取刚体弹性系数。\r\n     */\r\n    CannonPhysicWorld.prototype.getBodyRestitution = function (component) {\r\n        return component.rigidBody.material.restitution;\r\n    };\r\n    /**\r\n     * 设置刚体弹性系数。\r\n     */\r\n    CannonPhysicWorld.prototype.setBodyRestitution = function (component, restitution) {\r\n        component.rigidBody.material.restitution = restitution;\r\n    };\r\n    /**\r\n     * 使刚体进入睡眠状态，不会触发任何碰撞事件，但可以正确响应拾取操作。\r\n     */\r\n    CannonPhysicWorld.prototype.sleepBody = function (component) {\r\n        component.rigidBody.sleep();\r\n    };\r\n    /**\r\n     * 唤醒刚体。\r\n     */\r\n    CannonPhysicWorld.prototype.wakeUpBody = function (component) {\r\n        component.rigidBody.wakeUp();\r\n    };\r\n    /**\r\n     * 设置刚体类型。\r\n     */\r\n    CannonPhysicWorld.prototype.setBodyType = function (component, type) {\r\n        component.rigidBody.type = type;\r\n    };\r\n    /**\r\n     * 设置碰撞体为触发器。\r\n     */\r\n    CannonPhysicWorld.prototype.setColliderIsTrigger = function (component, isTrigger) {\r\n        component.collider.collisionResponse = !isTrigger;\r\n    };\r\n    /**\r\n     * 获取碰撞体是否为触发器。\r\n     */\r\n    CannonPhysicWorld.prototype.getColliderIsTrigger = function (component) {\r\n        return !component.collider.collisionResponse;\r\n    };\r\n    CannonPhysicWorld = __decorate([\r\n        SClass({ className: 'CannonPhysicWorld', classType: 'PhysicWorld' })\r\n    ], CannonPhysicWorld);\r\n    return CannonPhysicWorld;\r\n}(SObject));\n\n/**\r\n * 判断一个实例是否为`CylinderColliderComponent`。\r\n */\r\nfunction isCylinderColliderComponent(value) {\r\n    return value.isCylinderColliderComponent;\r\n}\r\n/**\r\n * 圆柱碰撞体，不太常用。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar CylinderColliderComponent = /** @class */ (function (_super) {\r\n    __extends(CylinderColliderComponent, _super);\r\n    function CylinderColliderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isCylinderColliderComponent = true;\r\n        _this._type = EColliderType.Cylinder;\r\n        return _this;\r\n    }\r\n    CylinderColliderComponent.prototype.getDefaultOptions = function () {\r\n        return null;\r\n    };\r\n    CylinderColliderComponent = __decorate([\r\n        SClass({ className: 'CylinderColliderComponent', classType: 'Collider' })\r\n    ], CylinderColliderComponent);\r\n    return CylinderColliderComponent;\r\n}(ColliderComponent));\n\n/**\r\n * 判断一个实例是否为`PlaneColliderComponent`。\r\n */\r\nfunction isPlaneColliderComponent(value) {\r\n    return value.isPlaneColliderComponent;\r\n}\r\n/**\r\n * 平面碰撞体，不建议使用。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PlaneColliderComponent = /** @class */ (function (_super) {\r\n    __extends(PlaneColliderComponent, _super);\r\n    function PlaneColliderComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPlaneColliderComponent = true;\r\n        _this._type = EColliderType.Plane;\r\n        return _this;\r\n    }\r\n    PlaneColliderComponent.prototype.getDefaultOptions = function () {\r\n        return null;\r\n    };\r\n    PlaneColliderComponent = __decorate([\r\n        SClass({ className: 'PlaneColliderComponent', classType: 'Collider' })\r\n    ], PlaneColliderComponent);\r\n    return PlaneColliderComponent;\r\n}(ColliderComponent));\n\n/**\r\n * 判断一个实例是否为`JointComponent`。\r\n */\r\nfunction isJointComponent(value) {\r\n    return value.isJointComponent;\r\n}\r\n/**\r\n * 铰链组件基类。一般不自己使用，而是交由继承的类实现多态。\r\n *\r\n * @template IStateTypes 初始化参数类型，一般交由由继承的类定义实现多态。\r\n * @noInheritDoc\r\n */\r\nvar JointComponent = /** @class */ (function (_super) {\r\n    __extends(JointComponent, _super);\r\n    function JointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isJointComponent = true;\r\n        _this._type = EJointType.PointToPoint;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(JointComponent.prototype, \"joint\", {\r\n        /**\r\n         * 获取物理世界的铰链，不要自己操作。\r\n         *\r\n         * @hidden\r\n         */\r\n        get: function () {\r\n            return this._joint;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(JointComponent.prototype, \"type\", {\r\n        /**\r\n         * 获取铰链类型。\r\n         */\r\n        get: function () {\r\n            return this._type;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    Object.defineProperty(JointComponent.prototype, \"initState\", {\r\n        /**\r\n         * 获取初始化参数实例引用。\r\n         */\r\n        get: function () {\r\n            return this._initState;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 开发环境下，验证可添加性。\r\n     */\r\n    JointComponent.prototype.verifyAdding = function (initState) {\r\n        var rigidBody = this._owner.rigidBody;\r\n        if (!rigidBody || !initState.actor.rigidBody) {\r\n            throw new BreakGuardException(this, 'RigidBodyComponent must be added to self or other actor before adding JointComponent !');\r\n        }\r\n    };\r\n    /**\r\n     * 添加到世界，继承请先`super.onAdd()`。\r\n     */\r\n    JointComponent.prototype.onAdd = function (initState) {\r\n        var rigidBody = this._owner.rigidBody;\r\n        var options = this._initState = initState;\r\n        this._joint = this.getPhysicWorld().createJoint(rigidBody, this, { type: this._type, options: options });\r\n    };\r\n    /**\r\n     * 禁用关节。\r\n     */\r\n    JointComponent.prototype.disable = function () {\r\n        this.getPhysicWorld().disableJoint(this);\r\n    };\r\n    /**\r\n     * 启用关节。\r\n     */\r\n    JointComponent.prototype.enable = function () {\r\n        this.getPhysicWorld().enableJoint(this);\r\n    };\r\n    // public updateEquations() {\r\n    // }\r\n    /**\r\n     * 销毁，继承请先`super.onDestroy()`。\r\n     */\r\n    JointComponent.prototype.onDestroy = function () {\r\n        var _this = this;\r\n        var physicWorld = this.getPhysicWorld();\r\n        setTimeout(function () {\r\n            if (_this._owner && _this._owner.rigidBody) {\r\n                physicWorld.removeJoint(_this._owner.rigidBody, _this);\r\n            }\r\n        }, 0);\r\n    };\r\n    JointComponent = __decorate([\r\n        SClass({ className: 'JointComponent' })\r\n    ], JointComponent);\r\n    return JointComponent;\r\n}(Component));\n\n/**\r\n * 判断一个实例是否为`PointToPointJointComponent`。\r\n */\r\nfunction isPointToPointJointComponent(value) {\r\n    return value.isPointToPointJointComponent;\r\n}\r\n/**\r\n * 点对点约束关节。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PointToPointJointComponent = /** @class */ (function (_super) {\r\n    __extends(PointToPointJointComponent, _super);\r\n    function PointToPointJointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isPointToPointJointComponent = true;\r\n        _this._type = EJointType.PointToPoint;\r\n        return _this;\r\n    }\r\n    PointToPointJointComponent = __decorate([\r\n        SClass({ className: 'PointToPointJointComponent', classType: 'Collider' })\r\n    ], PointToPointJointComponent);\r\n    return PointToPointJointComponent;\r\n}(JointComponent));\n\n/**\r\n * 判断一个实例是否为`DistanceJointComponent`。\r\n */\r\nfunction isDistanceJointComponent(value) {\r\n    return value.isDistanceJointComponent;\r\n}\r\n/**\r\n * 距离约束关节。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar DistanceJointComponent = /** @class */ (function (_super) {\r\n    __extends(DistanceJointComponent, _super);\r\n    function DistanceJointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isDistanceJointComponent = true;\r\n        _this._type = EJointType.Distance;\r\n        return _this;\r\n    }\r\n    DistanceJointComponent = __decorate([\r\n        SClass({ className: 'DistanceJointComponent', classType: 'Collider' })\r\n    ], DistanceJointComponent);\r\n    return DistanceJointComponent;\r\n}(JointComponent));\n\n/**\r\n * 判断一个实例是否为`HingeJointComponent`。\r\n */\r\nfunction isHingeJointComponent(value) {\r\n    return value.isHingeJointComponent;\r\n}\r\n/**\r\n * 铰链关节。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar HingeJointComponent = /** @class */ (function (_super) {\r\n    __extends(HingeJointComponent, _super);\r\n    function HingeJointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isHingeJointComponent = true;\r\n        _this._type = EJointType.Hinge;\r\n        return _this;\r\n    }\r\n    HingeJointComponent = __decorate([\r\n        SClass({ className: 'HingeJointComponent', classType: 'Collider' })\r\n    ], HingeJointComponent);\r\n    return HingeJointComponent;\r\n}(JointComponent));\n\n/**\r\n * 判断一个实例是否为`LockJointComponent`。\r\n */\r\nfunction isLockJointComponent(value) {\r\n    return value.isLockJointComponent;\r\n}\r\n/**\r\n * 锁定约束关节。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar LockJointComponent = /** @class */ (function (_super) {\r\n    __extends(LockJointComponent, _super);\r\n    function LockJointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isLockJointComponent = true;\r\n        _this._type = EJointType.Lock;\r\n        return _this;\r\n    }\r\n    LockJointComponent = __decorate([\r\n        SClass({ className: 'LockJointComponent', classType: 'Collider' })\r\n    ], LockJointComponent);\r\n    return LockJointComponent;\r\n}(JointComponent));\n\n/**\r\n * 判断一个实例是否为`SpringJointComponent`。\r\n */\r\nfunction isSpringJointComponent(value) {\r\n    return value.isSpringJointComponent;\r\n}\r\n/**\r\n * 弹簧关节。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar SpringJointComponent = /** @class */ (function (_super) {\r\n    __extends(SpringJointComponent, _super);\r\n    function SpringJointComponent() {\r\n        var _this = _super !== null && _super.apply(this, arguments) || this;\r\n        _this.isSpringJointComponent = true;\r\n        _this._type = EJointType.Spring;\r\n        /**\r\n         * **不要自己使用！**应用弹簧力。\r\n         */\r\n        _this.applyForce = function () {\r\n            _this._joint.applyForce;\r\n        };\r\n        return _this;\r\n    }\r\n    SpringJointComponent = __decorate([\r\n        SClass({ className: 'SpringJointComponent', classType: 'Collider' })\r\n    ], SpringJointComponent);\r\n    return SpringJointComponent;\r\n}(JointComponent));\n\n/**\r\n * 判断一个实例是否为`PhysicPicker`。\r\n */\r\nfunction isPhysicPicker(value) {\r\n    return value.isPhysicPicker;\r\n}\r\n/**\r\n * 物理拾取器，用于拾取已经挂载了刚体和碰撞体的Actor。\r\n *\r\n * @noInheritDoc\r\n */\r\nvar PhysicPicker = /** @class */ (function (_super) {\r\n    __extends(PhysicPicker, _super);\r\n    function PhysicPicker(game) {\r\n        var _this = _super.call(this) || this;\r\n        _this.isPhysicPicker = true;\r\n        _this._active = false;\r\n        _this._tmpTo = new Vector3();\r\n        _this._tmpFrom = new Vector3();\r\n        _this.handleMouse = function (event) {\r\n            var _a = _this._game.bound, left = _a.left, top = _a.top;\r\n            _this._tmpX = event.clientX - left;\r\n            _this._tmpY = event.clientY - top;\r\n            _this.pick(_this._tmpX, _this._tmpY);\r\n        };\r\n        _this.handleTouch = function (event) {\r\n            var touch = event.changedTouches[0];\r\n            if (!touch) {\r\n                return;\r\n            }\r\n            var _a = _this._game.bound, left = _a.left, top = _a.top;\r\n            _this._tmpX = touch.clientX - left;\r\n            _this._tmpY = touch.clientY - top;\r\n            _this.pick(_this._tmpX, _this._tmpY);\r\n        };\r\n        _this.onPick = function (results) {\r\n            if (_this._options.filter) {\r\n                results = _this._options.filter(results);\r\n            }\r\n            results.forEach(function (result) {\r\n                result.rigidBody.handlePick(result);\r\n            });\r\n        };\r\n        _this._game = game;\r\n        return _this;\r\n    }\r\n    Object.defineProperty(PhysicPicker.prototype, \"options\", {\r\n        /**\r\n         * 获取当前配置，你可以随时修改它。\r\n         */\r\n        get: function () {\r\n            return this._options;\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    /**\r\n     * 开启拾取功能，你可以通过选项来设定不同模式。\r\n     */\r\n    PhysicPicker.prototype.enablePicking = function (options) {\r\n        if (!this._game.world.physicWorld) {\r\n            throw new UnmetRequireException(this, 'Physic world is required for enable physic picking !');\r\n        }\r\n        if (this._active) {\r\n            return;\r\n        }\r\n        this._options = options || {};\r\n        this._options.type = this._options.type || 'down';\r\n        this._active = true;\r\n        if (this._options.type === 'up') {\r\n            this._game.hid.add('MouseUp', this.handleMouse);\r\n            this._game.hid.add('TouchEnd', this.handleTouch);\r\n        }\r\n        else if (this._options.type === 'down') {\r\n            this._game.hid.add('MouseDown', this.handleMouse);\r\n            this._game.hid.add('TouchStart', this.handleTouch);\r\n        }\r\n    };\r\n    /**\r\n     * 关闭拾取功能。\r\n     */\r\n    PhysicPicker.prototype.disablePicking = function () {\r\n        if (!this._game.world.physicWorld) {\r\n            throw new UnmetRequireException(this, 'Physic world is required for enable physic picking !');\r\n        }\r\n        if (this._options.type === 'up') {\r\n            this._game.hid.remove('MouseUp', this.handleMouse);\r\n            this._game.hid.remove('TouchEnd', this.handleTouch);\r\n        }\r\n        else if (this._options.type === 'down') {\r\n            this._game.hid.remove('MouseDown', this.handleMouse);\r\n            this._game.hid.remove('TouchStart', this.handleTouch);\r\n        }\r\n    };\r\n    /**\r\n     * 通过屏幕空间的`x`和`y`触发一次拾取。\r\n     * 这通常用于开发者想自定义拾取模式的时候，即`options.type === 'custom'`。\r\n     */\r\n    PhysicPicker.prototype.pick = function (x, y) {\r\n        var _a = this._game, screenWidth = _a.screenWidth, screenHeight = _a.screenHeight;\r\n        var physicWorld = this._game.world.physicWorld;\r\n        var camera = this._game.world.mainCamera;\r\n        if (!camera) {\r\n            Debug.warn('Can not pick, world has no camera now !');\r\n            return;\r\n        }\r\n        camera.generateRay(x, y, screenWidth, screenHeight, this._tmpFrom, this._tmpTo, this._options.rayLength);\r\n        physicWorld.pick(this._tmpFrom, this._tmpTo, this.onPick, this._options);\r\n    };\r\n    PhysicPicker = __decorate([\r\n        SClass({ className: 'PhysicPicker' })\r\n    ], PhysicPicker);\r\n    return PhysicPicker;\r\n}(SObject));\n\n/**\r\n * 通过筛选函数`filter`查找`parent`下的首个`actor`。\r\n *\r\n * @param filter 筛选函数，若返回`true`。\r\n */\r\nfunction findActorByFilter(parent, filter) {\r\n    var result = null;\r\n    iterateActors(parent, function (actor) {\r\n        if (filter(actor)) {\r\n            result = actor;\r\n            return true;\r\n        }\r\n        return false;\r\n    });\r\n    return result;\r\n}\r\n/**\r\n * 通过删选函数`filter`查找`parent`下的所有`actor`。\r\n *\r\n * @param filter 筛选函数。\r\n * @param stopFinding 停止测试函数，若返回`true`，则立即查找，用于性能优化。\r\n */\r\nfunction findActorsByFilter(parent, filter, stopFinding) {\r\n    var result = [];\r\n    iterateActors(parent, function (actor) {\r\n        if (filter(actor)) {\r\n            result.push(actor);\r\n        }\r\n        if (stopFinding && stopFinding(actor, result)) {\r\n            return true;\r\n        }\r\n    });\r\n    return result;\r\n}\r\n/**\r\n * 通过名字`name`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByName(parent, name) {\r\n    return findActorByFilter(parent, function (actor) { return actor.name.equalsTo(name); });\r\n}\r\n/**\r\n * 通过名字路径`namePath`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByNamePath(p, namePath) {\r\n    var length = namePath.length;\r\n    var parent;\r\n    if (isGame(p)) {\r\n        parent = p.actors.findByName(namePath[0]);\r\n    }\r\n    else if (isWorld(p)) {\r\n        parent = p.actors.findByName(namePath[0]);\r\n    }\r\n    else {\r\n        parent = p;\r\n    }\r\n    if (!parent) {\r\n        return null;\r\n    }\r\n    if (length === 1) {\r\n        return parent;\r\n    }\r\n    namePath.splice(0, 1);\r\n    length -= 1;\r\n    if (length === 0) {\r\n        return null;\r\n    }\r\n    var current = parent;\r\n    var name;\r\n    for (var index = 0; index < length; index += 1) {\r\n        name = namePath[index];\r\n        bfs(current, function (actor) {\r\n            if (actor.name.equalsTo(name)) {\r\n                current = actor;\r\n                return true;\r\n            }\r\n            current = null;\r\n            return false;\r\n        });\r\n        if (!current) {\r\n            return null;\r\n        }\r\n    }\r\n    if (current === parent) {\r\n        return null;\r\n    }\r\n    return current;\r\n}\r\n/**\r\n * 通过名称`name`查找`parent`下的所有`actor`。\r\n *\r\n * @param stopFinding 停止测试函数，若返回`true`，则立即查找，用于性能优化。\r\n */\r\nfunction findActorsByName(parent, name, stopFinding) {\r\n    return findActorsByFilter(parent, function (actor) { return actor.name.equalsTo(name); }, stopFinding);\r\n}\r\n/**\r\n * 通过标签`tag`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByTag(parent, tag) {\r\n    return findActorByFilter(parent, function (actor) { return actor.tag.equalsTo(tag); });\r\n}\r\n/**\r\n * 通过标签`tag`查找`parent`下的所有`actor`。\r\n *\r\n * @param stopFinding 停止测试函数，若返回`true`，则立即查找，用于性能优化。\r\n */\r\nfunction findActorsByTag(parent, tag, stopFinding) {\r\n    return findActorsByFilter(parent, function (actor) { return actor.tag.equalsTo(tag); }, stopFinding);\r\n}\r\n/**\r\n * 通过位移ID`uuid`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByUUID(parent, uuid) {\r\n    return findActorByFilter(parent, function (actor) { return actor.uuid === uuid; });\r\n}\r\n/**\r\n * 通过类的类型`className`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByClassName(parent, className) {\r\n    return findActorByFilter(parent, function (actor) { return actor.className.equalsTo(className); });\r\n}\r\n/**\r\n * 通过类的类型`className`查找`parent`下的所有`actor`。\r\n *\r\n * @param stopFinding 停止测试函数，若返回`true`，则立即查找，用于性能优化。\r\n */\r\nfunction findActorsByClassName(parent, className, stopFinding) {\r\n    return findActorsByFilter(parent, function (actor) { return actor.className.equalsTo(className); }, stopFinding);\r\n}\r\n/**\r\n * 通过类型`Class`查找`parent`下的首个`actor`。\r\n */\r\nfunction findActorByClass(parent, Class) {\r\n    return findActorByFilter(parent, function (actor) { return actor.className.equalsTo(Class.CLASS_NAME); });\r\n}\r\n/**\r\n * 通过类型`Class`查找`parent`下的所有`actor`。\r\n *\r\n * @param stopFinding 停止测试函数，若返回`true`，则立即查找，用于性能优化。\r\n */\r\nfunction findActorsByClass(parent, Class, stopFinding) {\r\n    return findActorsByFilter(parent, function (actor) { return actor.className.equalsTo(Class.CLASS_NAME); }, stopFinding);\r\n}\n\n/**\r\n * @File   : ContextSupports.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 12/10/2019, 1:13:06 PM\r\n * @Description:\r\n */\r\nvar ContextSupportsClass = /** @class */ (function () {\r\n    function ContextSupportsClass() {\r\n    }\r\n    Object.defineProperty(ContextSupportsClass.prototype, \"isWebGLSupport\", {\r\n        get: function () {\r\n            return Hilo3d$2.WebGLSupport.get();\r\n        },\r\n        enumerable: false,\r\n        configurable: true\r\n    });\r\n    return ContextSupportsClass;\r\n}());\r\nvar ContextSupports = new ContextSupportsClass();\n\n/**\r\n * @File   : index.ts\r\n * @Author : dtysky (dtysky@outlook.com)\r\n * @Date   : 2018-7-28 13:54:12\r\n * @Description:\r\n */\r\nvar version = '1.5.17';\r\nvar author = 'Tianyu Dai <dtysky@outlook.com>';\r\n/* tslint:disable-line */\r\nconsole.log(\"Sein.js verison: \" + version);\r\nif (typeof window !== 'undefined' && !window['Sein']) {\r\n    window['Sein'] = module.exports;\r\n}\n\n\n\n/* WEBPACK VAR INJECTION */}.call(this, __webpack_require__(/*! ./../../_process@0.11.10@process/browser.js */ \"./node_modules/_process@0.11.10@process/browser.js\"), __webpack_require__(/*! ./../../_webpack@4.44.2@webpack/buildin/global.js */ \"./node_modules/_webpack@4.44.2@webpack/buildin/global.js\"), __webpack_require__(/*! ./../../_webpack@4.44.2@webpack/buildin/harmony-module.js */ \"./node_modules/_webpack@4.44.2@webpack/buildin/harmony-module.js\")(module)))\n\n//# sourceURL=webpack:///./node_modules/_seinjs@1.5.17@seinjs/lib/seinjs.es.js?");

/***/ }),

/***/ "./node_modules/_webpack@4.44.2@webpack/buildin/global.js":
/*!***********************************!*\
  !*** (webpack)/buildin/global.js ***!
  \***********************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("var g;\n\n// This works in non-strict mode\ng = (function() {\n\treturn this;\n})();\n\ntry {\n\t// This works if eval is allowed (see CSP)\n\tg = g || new Function(\"return this\")();\n} catch (e) {\n\t// This works if the window reference is available\n\tif (typeof window === \"object\") g = window;\n}\n\n// g can still be undefined, but nothing to do about it...\n// We return undefined, instead of nothing here, so it's\n// easier to handle this case. if(!global) { ...}\n\nmodule.exports = g;\n\n\n//# sourceURL=webpack:///(webpack)/buildin/global.js?");

/***/ }),

/***/ "./node_modules/_webpack@4.44.2@webpack/buildin/harmony-module.js":
/*!*******************************************!*\
  !*** (webpack)/buildin/harmony-module.js ***!
  \*******************************************/
/*! no static exports found */
/***/ (function(module, exports) {

eval("module.exports = function(originalModule) {\n\tif (!originalModule.webpackPolyfill) {\n\t\tvar module = Object.create(originalModule);\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"exports\", {\n\t\t\tenumerable: true\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n\n//# sourceURL=webpack:///(webpack)/buildin/harmony-module.js?");

/***/ }),

/***/ "./src/hilo-test.js":
/*!**************************!*\
  !*** ./src/hilo-test.js ***!
  \**************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var hilojs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! hilojs */ \"./node_modules/_hilojs@2.0.2@hilojs/hilo-standalone.js\");\n/* harmony import */ var hilojs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(hilojs__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var _ticker__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! ./ticker */ \"./src/ticker.js\");\n\n\n\nconsole.log(`Hilo version: ${hilojs__WEBPACK_IMPORTED_MODULE_0__[\"version\"]}`);\nconst stage = new hilojs__WEBPACK_IMPORTED_MODULE_0__[\"Stage\"]({\n    container:document.querySelector('#hiloContainer'),\n    width: innerWidth,\n    height: innerHeight\n});\n\nconst text = new hilojs__WEBPACK_IMPORTED_MODULE_0__[\"Text\"]({\n    text:'hilojs',\n    font:'48px arial',\n    color: '#96f',\n    textAlign:'center',\n    textVAlign:'middle',\n    y: 160\n}).addTo(stage);\n\nhilojs__WEBPACK_IMPORTED_MODULE_0__[\"Tween\"].fromTo(text, {\n    x: innerWidth * 0.5 - 140,\n    rotation: 360\n}, {\n    x:innerWidth * 0.5 + 140 \n}, {\n    duration: 2000,\n    loop: true,\n    reverse: true,\n    ease: hilojs__WEBPACK_IMPORTED_MODULE_0__[\"Ease\"].Quad.EaseInOut\n});\n\n_ticker__WEBPACK_IMPORTED_MODULE_1__[\"default\"].addTick(stage);\n\n//# sourceURL=webpack:///./src/hilo-test.js?");

/***/ }),

/***/ "./src/hilo3d-test.js":
/*!****************************!*\
  !*** ./src/hilo3d-test.js ***!
  \****************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var hilo3d__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! hilo3d */ \"./node_modules/_hilo3d@1.15.15@hilo3d/build/Hilo3d.js\");\n/* harmony import */ var hilo3d__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(hilo3d__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var hilo3d_examples_js_OrbitControls__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! hilo3d/examples/js/OrbitControls */ \"./node_modules/_hilo3d@1.15.15@hilo3d/examples/js/OrbitControls.js\");\n/* harmony import */ var hilo3d_examples_js_OrbitControls__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(hilo3d_examples_js_OrbitControls__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var _ticker__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! ./ticker */ \"./src/ticker.js\");\n\n\n\n\nconst camera = new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"PerspectiveCamera\"]({\n    aspect: innerWidth / innerHeight,\n    z: 4\n});\n\nconst stage = new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Stage\"]({\n    container: document.querySelector('#hilo3dContainer'),\n    camera: camera,\n    width: innerWidth,\n    height: innerHeight\n});\n\nconst mesh = new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Mesh\"]({\n    geometry: new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"BoxGeometry\"](),\n    material: new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"PBRMaterial\"]({\n        baseColor:new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Color\"](0.832, 0.119, 0.093)\n    }),\n    onUpdate:function() {\n        this.rotationY += 1;\n        this.rotationX += 1;\n    }\n}).addTo(stage);\n\nstage.addChild(new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"AmbientLight\"]({\n    color: new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Color\"](1, 1, 1),\n    amount: .5\n})).addChild(new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"DirectionalLight\"]({\n    color: new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Color\"](1, 1, 1),\n    amount: 5,\n    direction: new hilo3d__WEBPACK_IMPORTED_MODULE_0__[\"Vector3\"](-1.3, -0.8, 0)\n}));\n\n_ticker__WEBPACK_IMPORTED_MODULE_2__[\"default\"].addTick(stage);\n\nconst orbitControls = new hilo3d_examples_js_OrbitControls__WEBPACK_IMPORTED_MODULE_1__(stage, {\n    isLockMove: true,\n    isLockZ: true\n});\n\n//# sourceURL=webpack:///./src/hilo3d-test.js?");

/***/ }),

/***/ "./src/sein-test.js":
/*!**************************!*\
  !*** ./src/sein-test.js ***!
  \**************************/
/*! no exports provided */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var seinjs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! seinjs */ \"./node_modules/_seinjs@1.5.17@seinjs/lib/seinjs.es.js\");\n\n\n//# sourceURL=webpack:///./src/sein-test.js?");

/***/ }),

/***/ "./src/ticker.js":
/*!***********************!*\
  !*** ./src/ticker.js ***!
  \***********************/
/*! exports provided: default */
/***/ (function(module, __webpack_exports__, __webpack_require__) {

"use strict";
eval("__webpack_require__.r(__webpack_exports__);\n/* harmony import */ var hilojs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! hilojs */ \"./node_modules/_hilojs@2.0.2@hilojs/hilo-standalone.js\");\n/* harmony import */ var hilojs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(hilojs__WEBPACK_IMPORTED_MODULE_0__);\n\n\nconst ticker = new hilojs__WEBPACK_IMPORTED_MODULE_0__[\"Ticker\"](60);\nticker.addTick(hilojs__WEBPACK_IMPORTED_MODULE_0__[\"Tween\"]);\nticker.start();\n\n/* harmony default export */ __webpack_exports__[\"default\"] = (ticker);\n\n//# sourceURL=webpack:///./src/ticker.js?");

/***/ })

/******/ });